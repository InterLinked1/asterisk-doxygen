<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_pubsub.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_pubsub.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &lt;pjsip_simple.h&gt;</code><br />
<code>#include &lt;pjlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dc/d33/mwi_8h_source.html">asterisk/mwi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html">asterisk/res_pjsip_pubsub.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d90/linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/db6/datastore_8h_source.html">asterisk/datastore.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d1d/uuid_8h_source.html">asterisk/uuid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">asterisk/taskprocessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d00/sched_8h_source.html">asterisk/sched.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d45/manager_8h_source.html">asterisk/manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db0/cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d5c/res__pjsip__private_8h_source.html">res_pjsip/include/res_pjsip_private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/dc3/res__pjsip__presence__xml_8h_source.html">asterisk/res_pjsip_presence_xml.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_pubsub.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d88/res__pjsip__pubsub_8c__incl.png" border="0" usemap="#res__pjsip__pubsub_8c" alt=""/></div>
<map name="res__pjsip__pubsub_8c" id="res__pjsip__pubsub_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="209,87,293,114"/>
<area shape="rect" id="node15" href="../../dc/d33/mwi_8h.html" title="Asterisk MWI API. " alt="" coords="482,87,595,114"/>
<area shape="rect" id="node22" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1251,475,1386,502"/>
<area shape="rect" id="node23" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="2570,557,2721,584"/>
<area shape="rect" id="node25" href="../../dc/db0/res__pjsip__pubsub_8h.html" title="asterisk/res_pjsip\l_pubsub.h" alt="" coords="2939,468,3071,509"/>
<area shape="rect" id="node26" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="685,169,821,196"/>
<area shape="rect" id="node27" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="2838,319,2989,345"/>
<area shape="rect" id="node28" href="../../dd/d1d/uuid_8h.html" title="Universally unique identifier support. " alt="" coords="1204,244,1319,271"/>
<area shape="rect" id="node29" href="../../d0/d1e/taskprocessor_8h.html" title="An API for managing task processing threads that can be shared across modules. " alt="" coords="1281,87,1458,114"/>
<area shape="rect" id="node30" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="1833,244,1959,271"/>
<area shape="rect" id="node31" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="1919,87,2063,114"/>
<area shape="rect" id="node44" href="../../de/d47/callerid_8h.html" title="CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr..." alt="" coords="3165,87,3299,114"/>
<area shape="rect" id="node46" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="2843,244,2989,271"/>
<area shape="rect" id="node47" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="1020,319,1121,345"/>
<area shape="rect" id="node48" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="897,244,1010,271"/>
<area shape="rect" id="node49" href="../../d7/d5c/res__pjsip__private_8h.html" title="res_pjsip/include/res\l_pjsip_private.h" alt="" coords="619,80,770,121"/>
<area shape="rect" id="node50" href="../../d5/dc3/res__pjsip__presence__xml_8h.html" title="asterisk/res_pjsip\l_presence_xml.h" alt="" coords="3323,80,3455,121"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="5,169,160,196"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="591,557,729,584"/>
<area shape="rect" id="node11" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="235,169,370,196"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="9,244,156,271"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1141,707,1283,733"/>
<area shape="rect" id="node16" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="780,319,895,345"/>
<area shape="rect" id="node24" href="../../d1/d96/stasis__state_8h.html" title="Stasis State API. " alt="" coords="395,169,560,196"/>
<area shape="rect" id="node17" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="2464,393,2603,420"/>
<area shape="rect" id="node18" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1867,632,1981,659"/>
<area shape="rect" id="node19" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1771,393,1928,420"/>
<area shape="rect" id="node21" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="867,393,997,420"/>
<area shape="rect" id="node20" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="1861,475,1987,502"/>
<area shape="rect" id="node34" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2571,244,2717,271"/>
<area shape="rect" id="node35" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="2231,244,2369,271"/>
<area shape="rect" id="node36" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="2086,319,2237,345"/>
<area shape="rect" id="node37" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="1355,169,1488,196"/>
<area shape="rect" id="node38" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="2651,169,2787,196"/>
<area shape="rect" id="node39" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="2507,169,2627,196"/>
<area shape="rect" id="node40" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="1715,169,1871,196"/>
<area shape="rect" id="node41" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1896,169,2085,196"/>
<area shape="rect" id="node42" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1613,244,1808,271"/>
<area shape="rect" id="node43" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="1546,393,1681,420"/>
<area shape="rect" id="node45" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="3167,169,3297,196"/>
</map>
</div>
</div>
<p><a href="../../d8/dca/res__pjsip__pubsub_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing a SIP publication.  <a href="../../d4/da6/structast__sip__publication.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing a publication resource.  <a href="../../d2/d91/structast__sip__publication__resource.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing a "virtual" SIP subscription.  <a href="../../db/d02/structast__sip__subscription.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de0/structbody__generators.html">body_generators</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/de8/structbody__part.html">body_part</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A multipart body part and meta-information.  <a href="../../d2/de8/structbody__part.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/structbody__supplements.html">body_supplements</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/df6/structcli__sub__complete__parms.html">cli_sub_complete_parms</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4c/structpersistence__recreate__data.html">persistence_recreate_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dd0/structresource__list.html">resource_list</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resource list configuration item.  <a href="../../df/dd0/structresource__list.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A resource tree.  <a href="../../d9/d6a/structresource__tree.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d4c/structsimple__message__summary.html">simple_message_summary</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A tree of SIP subscriptions.  <a href="../../d0/dd7/structsip__subscription__tree.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure used for persisting an inbound subscription.  <a href="../../d9/df9/structsubscription__persistence.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dab/structsubscriptions.html">subscriptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d14/structtree__node.html">tree_node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A node for a resource tree.  <a href="../../d6/d14/structtree__node.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a703b9f7d4c89444b70c00353c864765c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a703b9f7d4c89444b70c00353c864765c">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a>&#160;&#160;&#160;&quot;PJSIPShowSubscriptionsInbound&quot;</td></tr>
<tr class="separator:a703b9f7d4c89444b70c00353c864765c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e6251ec7546725dcb5cc72bf6b60ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a75e6251ec7546725dcb5cc72bf6b60ce">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a>&#160;&#160;&#160;&quot;PJSIPShowSubscriptionsOutbound&quot;</td></tr>
<tr class="separator:a75e6251ec7546725dcb5cc72bf6b60ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e71457156b5ee3447f3a7bd2877e28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0e71457156b5ee3447f3a7bd2877e28">CLI_LIST_SUB_FORMAT_ENTRY</a>&#160;&#160;&#160;&quot;%-30.30s %-30.30s %6d %s\n&quot;</td></tr>
<tr class="separator:ae0e71457156b5ee3447f3a7bd2877e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abed51420cb87ea551279a07f2c502a37"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abed51420cb87ea551279a07f2c502a37">CLI_LIST_SUB_FORMAT_HEADER</a>&#160;&#160;&#160;&quot;%-30.30s %-30.30s %6.6s %s\n&quot;</td></tr>
<tr class="separator:abed51420cb87ea551279a07f2c502a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025e1fa7b644cd3de8f0f7fe4ab42100"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a025e1fa7b644cd3de8f0f7fe4ab42100">CLI_SHOW_SUB_FORMAT_ENTRY</a></td></tr>
<tr class="separator:a025e1fa7b644cd3de8f0f7fe4ab42100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da91e964cff994ce0e57b494316b043"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2da91e964cff994ce0e57b494316b043">CLI_SHOW_SUB_FORMAT_HEADER</a></td></tr>
<tr class="separator:a2da91e964cff994ce0e57b494316b043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fcd37b99a8eafd0aa1c961d8736f88"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a>&#160;&#160;&#160;53</td></tr>
<tr class="memdesc:a39fcd37b99a8eafd0aa1c961d8736f88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of buckets for subscription datastore.  <a href="#a39fcd37b99a8eafd0aa1c961d8736f88">More...</a><br /></td></tr>
<tr class="separator:a39fcd37b99a8eafd0aa1c961d8736f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc353f33f479f252b0cea51d55afc7ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#afc353f33f479f252b0cea51d55afc7ca">DEFAULT_EXPIRES</a>&#160;&#160;&#160;3600</td></tr>
<tr class="memdesc:afc353f33f479f252b0cea51d55afc7ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default expiration for subscriptions.  <a href="#afc353f33f479f252b0cea51d55afc7ca">More...</a><br /></td></tr>
<tr class="separator:afc353f33f479f252b0cea51d55afc7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d530a1f675151206b5929a37a882fe2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a>&#160;&#160;&#160;3600</td></tr>
<tr class="memdesc:a4d530a1f675151206b5929a37a882fe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default expiration time for PUBLISH if one is not specified.  <a href="#a4d530a1f675151206b5929a37a882fe2">More...</a><br /></td></tr>
<tr class="separator:a4d530a1f675151206b5929a37a882fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46e524af59f26e0f0825b21acf9ea886"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a46e524af59f26e0f0825b21acf9ea886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab95c1bf11412f8e2a82ddd0eb69ad4a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab95c1bf11412f8e2a82ddd0eb69ad4a4">MOD_DATA_MSG</a>&#160;&#160;&#160;&quot;sub_msg&quot;</td></tr>
<tr class="separator:ab95c1bf11412f8e2a82ddd0eb69ad4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ab4b2e3c02b132f457ec3e61d5d47d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a>&#160;&#160;&#160;&quot;sub_persistence&quot;</td></tr>
<tr class="separator:ad9ab4b2e3c02b132f457ec3e61d5d47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2ea661eb5491432e647c3070aa78a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b2ea661eb5491432e647c3070aa78a7">PUBLICATIONS_BUCKETS</a>&#160;&#160;&#160;37</td></tr>
<tr class="memdesc:a7b2ea661eb5491432e647c3070aa78a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of buckets for publications (on a per handler)  <a href="#a7b2ea661eb5491432e647c3070aa78a7">More...</a><br /></td></tr>
<tr class="separator:a7b2ea661eb5491432e647c3070aa78a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f5d6a140ec019c5cf145f0d78a946a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f5d6a140ec019c5cf145f0d78a946a5">RESOURCE_LIST_INIT_SIZE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a7f5d6a140ec019c5cf145f0d78a946a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a0b174b002a4e991ef8c08f17118f8cd5"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a>) (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, void *arg)</td></tr>
<tr class="separator:a0b174b002a4e991ef8c08f17118f8cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a36292f9aacdecd44efe47fa591beb400"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400">sip_persistence_update_type</a> { <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a> = 0, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240">SUBSCRIPTION_PERSISTENCE_REFRESHED</a>
 }</td></tr>
<tr class="separator:a36292f9aacdecd44efe47fa591beb400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ecd8494df028dc44c95b90848ad311"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a> { <br />
&#160;&#160;<a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>, 
<a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>, 
<a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a>, 
<a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a>, 
<br />
&#160;&#160;<a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a>, 
<br />
&#160;&#160;<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a>
<br />
 }<tr class="memdesc:a42ecd8494df028dc44c95b90848ad311"><td class="mdescLeft">&#160;</td><td class="mdescRight">The types of PUBLISH messages defined in RFC 3903.  <a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a42ecd8494df028dc44c95b90848ad311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386166c75f00c0b4d1878e3a6d666e89"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89">sip_subscription_tree_state</a> { <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a> = 0, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, 
<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a>
 }<tr class="memdesc:a386166c75f00c0b4d1878e3a6d666e89"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state of the subscription tree.  <a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a386166c75f00c0b4d1878e3a6d666e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ccf20fa81744533ad45801f7f1a3b6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac9ccf20fa81744533ad45801f7f1a3b6">add_rlmi_resource</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, pj_xml_node *rlmi, const pjsip_generic_string_hdr *cid, const char *resource_name, const pjsip_sip_uri *resource_uri, pjsip_evsub_state <a class="el" href="../../d4/d88/structstate.html">state</a>)</td></tr>
<tr class="memdesc:ac9ccf20fa81744533ad45801f7f1a3b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a resource XML element to an RLMI body.  <a href="#ac9ccf20fa81744533ad45801f7f1a3b6">More...</a><br /></td></tr>
<tr class="separator:ac9ccf20fa81744533ad45801f7f1a3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ebc5adf3564428c0201cff2376dd187"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8ebc5adf3564428c0201cff2376dd187">add_subscription</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *obj)</td></tr>
<tr class="separator:a8ebc5adf3564428c0201cff2376dd187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5314d6fbf19f6f10073f1d4e0787e957"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d2/de8/structbody__part.html">body_part</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5314d6fbf19f6f10073f1d4e0787e957">allocate_body_part</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a5314d6fbf19f6f10073f1d4e0787e957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize a body part structure.  <a href="#a5314d6fbf19f6f10073f1d4e0787e957">More...</a><br /></td></tr>
<tr class="separator:a5314d6fbf19f6f10073f1d4e0787e957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa70a279b186df17b611eabf8164c396c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa70a279b186df17b611eabf8164c396c">allocate_subscription</a> (const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *resource, struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *tree)</td></tr>
<tr class="separator:aa70a279b186df17b611eabf8164c396c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae855491c1f2f6714df5daa3fd69a10df"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae855491c1f2f6714df5daa3fd69a10df">allocate_subscription_tree</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:ae855491c1f2f6714df5daa3fd69a10df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a204519f08566a8c5fb4711168cad11e3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a204519f08566a8c5fb4711168cad11e3">allocate_tdata_buffer</a> (pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:a204519f08566a8c5fb4711168cad11e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-allocate a buffer for the transmission.  <a href="#a204519f08566a8c5fb4711168cad11e3">More...</a><br /></td></tr>
<tr class="separator:a204519f08566a8c5fb4711168cad11e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c56a35e1b346bd629dd4caf6a52f03"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a22c56a35e1b346bd629dd4caf6a52f03">ami_show_resource_lists</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:a22c56a35e1b346bd629dd4caf6a52f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a675152b3c3f0536dbb1f624fc840fba1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a675152b3c3f0536dbb1f624fc840fba1">ami_show_subscriptions_inbound</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:a675152b3c3f0536dbb1f624fc840fba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53732c2137fa94234dd28ed05de1a282"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a53732c2137fa94234dd28ed05de1a282">ami_show_subscriptions_outbound</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:a53732c2137fa94234dd28ed05de1a282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98dd8da033568491b0241453b2cf34a2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a98dd8da033568491b0241453b2cf34a2">ami_subscription_detail</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> *ami, const char *<a class="el" href="../../df/d7d/structevent.html">event</a>)</td></tr>
<tr class="separator:a98dd8da033568491b0241453b2cf34a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9321a33ad3bd557f07e777bcdd6afb79"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9321a33ad3bd557f07e777bcdd6afb79">ami_subscription_detail_inbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a9321a33ad3bd557f07e777bcdd6afb79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add921b3c03175e428a304fbd820c584a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#add921b3c03175e428a304fbd820c584a">ami_subscription_detail_outbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:add921b3c03175e428a304fbd820c584a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c45ac14fca8a0ed83e33e45856a5199"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9c45ac14fca8a0ed83e33e45856a5199">apply_list_configuration</a> (struct <a class="el" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="el" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>)</td></tr>
<tr class="separator:a9c45ac14fca8a0ed83e33e45856a5199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc803ec5ffc0029b9be176cc090f135"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#adcc803ec5ffc0029b9be176cc090f135">ast_sip_create_subscription</a> (const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, const char *resource)</td></tr>
<tr class="memdesc:adcc803ec5ffc0029b9be176cc090f135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new <a class="el" href="../../db/d02/structast__sip__subscription.html" title="Structure representing a &quot;virtual&quot; SIP subscription. ">ast_sip_subscription</a> structure.  <a href="#adcc803ec5ffc0029b9be176cc090f135">More...</a><br /></td></tr>
<tr class="separator:adcc803ec5ffc0029b9be176cc090f135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd01cccb44e52e8c576785903382206"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aefd01cccb44e52e8c576785903382206">ast_sip_publication_add_datastore</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication, struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr class="memdesc:aefd01cccb44e52e8c576785903382206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a datastore to a SIP publication.  <a href="#aefd01cccb44e52e8c576785903382206">More...</a><br /></td></tr>
<tr class="separator:aefd01cccb44e52e8c576785903382206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69501f479a8ea3b0d1b6c4b8439e03c9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a69501f479a8ea3b0d1b6c4b8439e03c9">ast_sip_publication_get_datastore</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a69501f479a8ea3b0d1b6c4b8439e03c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a publication datastore.  <a href="#a69501f479a8ea3b0d1b6c4b8439e03c9">More...</a><br /></td></tr>
<tr class="separator:a69501f479a8ea3b0d1b6c4b8439e03c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ca8ca978fb48dc5a57ce618b36c0b5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa8ca8ca978fb48dc5a57ce618b36c0b5">ast_sip_publication_get_datastores</a> (const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication)</td></tr>
<tr class="memdesc:aa8ca8ca978fb48dc5a57ce618b36c0b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the datastores container for a publication.  <a href="#aa8ca8ca978fb48dc5a57ce618b36c0b5">More...</a><br /></td></tr>
<tr class="separator:aa8ca8ca978fb48dc5a57ce618b36c0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf23ea14cf21cc35810a043bed318bb6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#adf23ea14cf21cc35810a043bed318bb6">ast_sip_publication_get_endpoint</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub)</td></tr>
<tr class="memdesc:adf23ea14cf21cc35810a043bed318bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a publication, get the associated endpoint.  <a href="#adf23ea14cf21cc35810a043bed318bb6">More...</a><br /></td></tr>
<tr class="separator:adf23ea14cf21cc35810a043bed318bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada9f3d03df5f52f4aeb09f6d952f46de"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ada9f3d03df5f52f4aeb09f6d952f46de">ast_sip_publication_get_event_configuration</a> (const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub)</td></tr>
<tr class="memdesc:ada9f3d03df5f52f4aeb09f6d952f46de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a publication, get the configuration name for the event type in use.  <a href="#ada9f3d03df5f52f4aeb09f6d952f46de">More...</a><br /></td></tr>
<tr class="separator:ada9f3d03df5f52f4aeb09f6d952f46de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1dd2ba4db4cb10f5d1813886503bd96"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac1dd2ba4db4cb10f5d1813886503bd96">ast_sip_publication_get_resource</a> (const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub)</td></tr>
<tr class="memdesc:ac1dd2ba4db4cb10f5d1813886503bd96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a publication, get the resource the publication is to.  <a href="#ac1dd2ba4db4cb10f5d1813886503bd96">More...</a><br /></td></tr>
<tr class="separator:ac1dd2ba4db4cb10f5d1813886503bd96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c370a28e03a8dc64e6b1cf9f277194"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a60c370a28e03a8dc64e6b1cf9f277194">ast_sip_publication_remove_datastore</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a60c370a28e03a8dc64e6b1cf9f277194"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a publication datastore from the publication.  <a href="#a60c370a28e03a8dc64e6b1cf9f277194">More...</a><br /></td></tr>
<tr class="separator:a60c370a28e03a8dc64e6b1cf9f277194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b78cda3768f8f485e1ad46d6fcb765"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa3b78cda3768f8f485e1ad46d6fcb765">ast_sip_pubsub_generate_body_content</a> (const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *subtype, struct <a class="el" href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a> *data, struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr class="memdesc:aa3b78cda3768f8f485e1ad46d6fcb765"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate body content for a PUBLISH or NOTIFY.  <a href="#aa3b78cda3768f8f485e1ad46d6fcb765">More...</a><br /></td></tr>
<tr class="separator:aa3b78cda3768f8f485e1ad46d6fcb765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94f5c5d378799e218956c0804cbfb1e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa94f5c5d378799e218956c0804cbfb1e">ast_sip_pubsub_has_eventlist_support</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:aa94f5c5d378799e218956c0804cbfb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the rdata has a Supported header containing 'eventlist'.  <a href="#aa94f5c5d378799e218956c0804cbfb1e">More...</a><br /></td></tr>
<tr class="separator:aa94f5c5d378799e218956c0804cbfb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0030d8d5c2b988a0f7e7968a66180dd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac0030d8d5c2b988a0f7e7968a66180dd">ast_sip_pubsub_is_body_generator_registered</a> (const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *subtype)</td></tr>
<tr class="memdesc:ac0030d8d5c2b988a0f7e7968a66180dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is a body generator registered for the given type/subtype.  <a href="#ac0030d8d5c2b988a0f7e7968a66180dd">More...</a><br /></td></tr>
<tr class="separator:ac0030d8d5c2b988a0f7e7968a66180dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d089a744841fa628f7dc8f09d70db04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8d089a744841fa628f7dc8f09d70db04">ast_sip_pubsub_register_body_generator</a> (struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="el" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>)</td></tr>
<tr class="memdesc:a8d089a744841fa628f7dc8f09d70db04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a body generator with the pubsub core.  <a href="#a8d089a744841fa628f7dc8f09d70db04">More...</a><br /></td></tr>
<tr class="separator:a8d089a744841fa628f7dc8f09d70db04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc1e17b0488075e8ea7d40085d502e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5cc1e17b0488075e8ea7d40085d502e1">ast_sip_pubsub_register_body_supplement</a> (struct <a class="el" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *supplement)</td></tr>
<tr class="memdesc:a5cc1e17b0488075e8ea7d40085d502e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a body generator with the pubsub core.  <a href="#a5cc1e17b0488075e8ea7d40085d502e1">More...</a><br /></td></tr>
<tr class="separator:a5cc1e17b0488075e8ea7d40085d502e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d7c1042170155672514fbb16ce46eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a22d7c1042170155672514fbb16ce46eb">ast_sip_pubsub_unregister_body_generator</a> (struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="el" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>)</td></tr>
<tr class="memdesc:a22d7c1042170155672514fbb16ce46eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a body generator with the pubsub core.  <a href="#a22d7c1042170155672514fbb16ce46eb">More...</a><br /></td></tr>
<tr class="separator:a22d7c1042170155672514fbb16ce46eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be73952bf96122adf824dbbc26caa1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2be73952bf96122adf824dbbc26caa1c">ast_sip_pubsub_unregister_body_supplement</a> (struct <a class="el" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *supplement)</td></tr>
<tr class="memdesc:a2be73952bf96122adf824dbbc26caa1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a body generator with the pubsub core.  <a href="#a2be73952bf96122adf824dbbc26caa1c">More...</a><br /></td></tr>
<tr class="separator:a2be73952bf96122adf824dbbc26caa1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d30548053458724404f5c041483cfa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a14d30548053458724404f5c041483cfa">ast_sip_register_publish_handler</a> (struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:a14d30548053458724404f5c041483cfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a publish handler.  <a href="#a14d30548053458724404f5c041483cfa">More...</a><br /></td></tr>
<tr class="separator:a14d30548053458724404f5c041483cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250d91ea4fba33dd520804c8a47e795a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a250d91ea4fba33dd520804c8a47e795a">ast_sip_register_subscription_handler</a> (struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:a250d91ea4fba33dd520804c8a47e795a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a subscription handler.  <a href="#a250d91ea4fba33dd520804c8a47e795a">More...</a><br /></td></tr>
<tr class="separator:a250d91ea4fba33dd520804c8a47e795a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68314dedb48b2799a693d3a090ae038b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a68314dedb48b2799a693d3a090ae038b">ast_sip_subscription_add_datastore</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription, struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr class="memdesc:a68314dedb48b2799a693d3a090ae038b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a datastore to a SIP subscription.  <a href="#a68314dedb48b2799a693d3a090ae038b">More...</a><br /></td></tr>
<tr class="separator:a68314dedb48b2799a693d3a090ae038b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d3ad3f5c55c026e22e1103686227ae0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5d3ad3f5c55c026e22e1103686227ae0">ast_sip_subscription_alloc_datastore</a> (const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *info, const char *uid)</td></tr>
<tr class="memdesc:a5d3ad3f5c55c026e22e1103686227ae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a>  <a href="#a5d3ad3f5c55c026e22e1103686227ae0">More...</a><br /></td></tr>
<tr class="separator:a5d3ad3f5c55c026e22e1103686227ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb393c5880be9a3a3ddeccfc998452b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bb393c5880be9a3a3ddeccfc998452b">ast_sip_subscription_destroy</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a3bb393c5880be9a3a3ddeccfc998452b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alert the pubsub core that the subscription is ready for destruction.  <a href="#a3bb393c5880be9a3a3ddeccfc998452b">More...</a><br /></td></tr>
<tr class="separator:a3bb393c5880be9a3a3ddeccfc998452b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c54dc5f481da88392b1ec7149385613"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a5c54dc5f481da88392b1ec7149385613"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the body subtype used for this subscription.  <a href="#a5c54dc5f481da88392b1ec7149385613">More...</a><br /></td></tr>
<tr class="separator:a5c54dc5f481da88392b1ec7149385613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2294ee18e05ee676e083133058243909"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a2294ee18e05ee676e083133058243909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the body type used for this subscription.  <a href="#a2294ee18e05ee676e083133058243909">More...</a><br /></td></tr>
<tr class="separator:a2294ee18e05ee676e083133058243909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ad2231cd4e17cd5a713f0c7cea20da4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5ad2231cd4e17cd5a713f0c7cea20da4">ast_sip_subscription_get_datastore</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a5ad2231cd4e17cd5a713f0c7cea20da4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a subscription datastore.  <a href="#a5ad2231cd4e17cd5a713f0c7cea20da4">More...</a><br /></td></tr>
<tr class="separator:a5ad2231cd4e17cd5a713f0c7cea20da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd22eade3d3a1bfce2d9acf505d34b1a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd22eade3d3a1bfce2d9acf505d34b1a">ast_sip_subscription_get_datastores</a> (const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription)</td></tr>
<tr class="memdesc:acd22eade3d3a1bfce2d9acf505d34b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the datastores container for a subscription.  <a href="#acd22eade3d3a1bfce2d9acf505d34b1a">More...</a><br /></td></tr>
<tr class="separator:acd22eade3d3a1bfce2d9acf505d34b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6471e6d6f4563ef5fb93343180fea40"><td class="memItemLeft" align="right" valign="top">pjsip_dialog *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa6471e6d6f4563ef5fb93343180fea40">ast_sip_subscription_get_dialog</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:aa6471e6d6f4563ef5fb93343180fea40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pjsip dialog that is associated with this subscription.  <a href="#aa6471e6d6f4563ef5fb93343180fea40">More...</a><br /></td></tr>
<tr class="separator:aa6471e6d6f4563ef5fb93343180fea40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce1c0cc1320bb801480d0929266d08f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abce1c0cc1320bb801480d0929266d08f">ast_sip_subscription_get_endpoint</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:abce1c0cc1320bb801480d0929266d08f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the endpoint that is associated with this subscription.  <a href="#abce1c0cc1320bb801480d0929266d08f">More...</a><br /></td></tr>
<tr class="separator:abce1c0cc1320bb801480d0929266d08f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4034b13c08bafa4bff82854bcc0ce135"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4034b13c08bafa4bff82854bcc0ce135">ast_sip_subscription_get_header</a> (const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, const char *<a class="el" href="../../d5/d65/structheader.html">header</a>)</td></tr>
<tr class="memdesc:a4034b13c08bafa4bff82854bcc0ce135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a header value for a subscription.  <a href="#a4034b13c08bafa4bff82854bcc0ce135">More...</a><br /></td></tr>
<tr class="separator:a4034b13c08bafa4bff82854bcc0ce135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb411f16e0fee4036a22b354164b43a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aeb411f16e0fee4036a22b354164b43a6">ast_sip_subscription_get_local_uri</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size_t size)</td></tr>
<tr class="memdesc:aeb411f16e0fee4036a22b354164b43a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the local URI for this subscription.  <a href="#aeb411f16e0fee4036a22b354164b43a6">More...</a><br /></td></tr>
<tr class="separator:aeb411f16e0fee4036a22b354164b43a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14c963f858de2e8b9bcd86c1a127b2d"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac14c963f858de2e8b9bcd86c1a127b2d">ast_sip_subscription_get_persistence_data</a> (const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription)</td></tr>
<tr class="memdesc:ac14c963f858de2e8b9bcd86c1a127b2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve persistence data for a subscription.  <a href="#ac14c963f858de2e8b9bcd86c1a127b2d">More...</a><br /></td></tr>
<tr class="separator:ac14c963f858de2e8b9bcd86c1a127b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb53b1ca63b4b97b4b3fa8721274ee9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0cb53b1ca63b4b97b4b3fa8721274ee9">ast_sip_subscription_get_remote_uri</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size_t size)</td></tr>
<tr class="memdesc:a0cb53b1ca63b4b97b4b3fa8721274ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrive the remote URI for this subscription.  <a href="#a0cb53b1ca63b4b97b4b3fa8721274ee9">More...</a><br /></td></tr>
<tr class="separator:a0cb53b1ca63b4b97b4b3fa8721274ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d7ed3f8785ad9d9aa3fc090d983c45d"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d7ed3f8785ad9d9aa3fc090d983c45d">ast_sip_subscription_get_resource_name</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a2d7ed3f8785ad9d9aa3fc090d983c45d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of the subscribed resource.  <a href="#a2d7ed3f8785ad9d9aa3fc090d983c45d">More...</a><br /></td></tr>
<tr class="separator:a2d7ed3f8785ad9d9aa3fc090d983c45d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81489602b194ea87cae6470409bee3b5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a81489602b194ea87cae6470409bee3b5">ast_sip_subscription_get_serializer</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a81489602b194ea87cae6470409bee3b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the serializer for the subscription.  <a href="#a81489602b194ea87cae6470409bee3b5">More...</a><br /></td></tr>
<tr class="separator:a81489602b194ea87cae6470409bee3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79792c0d3a54f779754479075e3c80b3"><td class="memItemLeft" align="right" valign="top">pjsip_sip_uri *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a79792c0d3a54f779754479075e3c80b3">ast_sip_subscription_get_sip_uri</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a79792c0d3a54f779754479075e3c80b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the local sip uri for this subscription.  <a href="#a79792c0d3a54f779754479075e3c80b3">More...</a><br /></td></tr>
<tr class="separator:a79792c0d3a54f779754479075e3c80b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae741d1ec08fd26b810d24514e510dad8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae741d1ec08fd26b810d24514e510dad8">ast_sip_subscription_is_terminated</a> (const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:ae741d1ec08fd26b810d24514e510dad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get whether the subscription has been terminated or not.  <a href="#ae741d1ec08fd26b810d24514e510dad8">More...</a><br /></td></tr>
<tr class="separator:ae741d1ec08fd26b810d24514e510dad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0f67be0ca6ad54e4eba8d4aa029faf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5b0f67be0ca6ad54e4eba8d4aa029faf">ast_sip_subscription_notify</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a> *<a class="el" href="../../d4/d18/structnotify__data.html">notify_data</a>, int terminate)</td></tr>
<tr class="memdesc:a5b0f67be0ca6ad54e4eba8d4aa029faf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify a SIP subscription of a state change.  <a href="#a5b0f67be0ca6ad54e4eba8d4aa029faf">More...</a><br /></td></tr>
<tr class="separator:a5b0f67be0ca6ad54e4eba8d4aa029faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c257396060f400b0fba424730e7576e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3c257396060f400b0fba424730e7576e">ast_sip_subscription_remove_datastore</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a3c257396060f400b0fba424730e7576e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a subscription datastore from the subscription.  <a href="#a3c257396060f400b0fba424730e7576e">More...</a><br /></td></tr>
<tr class="separator:a3c257396060f400b0fba424730e7576e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823b9711e5de08ec19a03f1994c11b30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a823b9711e5de08ec19a03f1994c11b30">ast_sip_subscription_set_persistence_data</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *subscription, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *persistence_data)</td></tr>
<tr class="memdesc:a823b9711e5de08ec19a03f1994c11b30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set persistence data for a subscription.  <a href="#a823b9711e5de08ec19a03f1994c11b30">More...</a><br /></td></tr>
<tr class="separator:a823b9711e5de08ec19a03f1994c11b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b342a28c864a472dfff5ea27de8691"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a> (struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:a65b342a28c864a472dfff5ea27de8691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a publish handler.  <a href="#a65b342a28c864a472dfff5ea27de8691">More...</a><br /></td></tr>
<tr class="separator:a65b342a28c864a472dfff5ea27de8691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d299943a24f9857d3e847b83073d5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a16d299943a24f9857d3e847b83073d5d">ast_sip_unregister_subscription_handler</a> (struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:a16d299943a24f9857d3e847b83073d5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a subscription handler.  <a href="#a16d299943a24f9857d3e847b83073d5d">More...</a><br /></td></tr>
<tr class="separator:a16d299943a24f9857d3e847b83073d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354490007a46ab4f8bebe7d7211bf57c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a354490007a46ab4f8bebe7d7211bf57c">AST_TEST_DEFINE</a> (<a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a>)</td></tr>
<tr class="separator:a354490007a46ab4f8bebe7d7211bf57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4d24c551721c2fe38c64fbfd48de79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9a4d24c551721c2fe38c64fbfd48de79">AST_TEST_DEFINE</a> (complex_resource_tree)</td></tr>
<tr class="separator:a9a4d24c551721c2fe38c64fbfd48de79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ad2962bb10fb62debded8a39cc1e3fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1ad2962bb10fb62debded8a39cc1e3fa">AST_TEST_DEFINE</a> (bad_resource)</td></tr>
<tr class="separator:a1ad2962bb10fb62debded8a39cc1e3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a592d2ccf2b016dd3c962e6bc8eba77a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a592d2ccf2b016dd3c962e6bc8eba77a0">AST_TEST_DEFINE</a> (bad_branch)</td></tr>
<tr class="separator:a592d2ccf2b016dd3c962e6bc8eba77a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a390c1a18874b65665ec47829e6a94b7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a390c1a18874b65665ec47829e6a94b7b">AST_TEST_DEFINE</a> (duplicate_resource)</td></tr>
<tr class="separator:a390c1a18874b65665ec47829e6a94b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad25ce03cdf8ed99dfe8e66a3b3a3d0b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad25ce03cdf8ed99dfe8e66a3b3a3d0b6">AST_TEST_DEFINE</a> (loop)</td></tr>
<tr class="separator:ad25ce03cdf8ed99dfe8e66a3b3a3d0b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af570896c63f7cc45d4ed91f135f76340"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af570896c63f7cc45d4ed91f135f76340">AST_TEST_DEFINE</a> (bad_event)</td></tr>
<tr class="separator:af570896c63f7cc45d4ed91f135f76340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7db5b123e82a8da6f1ae6fc15aaace5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa7db5b123e82a8da6f1ae6fc15aaace5">AST_VECTOR</a> (resources, const char *)</td></tr>
<tr class="memdesc:aa7db5b123e82a8da6f1ae6fc15aaace5"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector of strings commonly used throughout this module.  <a href="#aa7db5b123e82a8da6f1ae6fc15aaace5">More...</a><br /></td></tr>
<tr class="separator:aa7db5b123e82a8da6f1ae6fc15aaace5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395edfd94277055d76e77c4a166bf8f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a395edfd94277055d76e77c4a166bf8f8">AST_VECTOR</a> (body_part_list, struct <a class="el" href="../../d2/de8/structbody__part.html">body_part</a> *)</td></tr>
<tr class="memdesc:a395edfd94277055d76e77c4a166bf8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type declaration for container of body part structures.  <a href="#a395edfd94277055d76e77c4a166bf8f8">More...</a><br /></td></tr>
<tr class="separator:a395edfd94277055d76e77c4a166bf8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dba366491005a78cb1b67070de74a6e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2dba366491005a78cb1b67070de74a6e">build_body_part</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct body_part_list *parts, unsigned int use_full_state)</td></tr>
<tr class="memdesc:a2dba366491005a78cb1b67070de74a6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a multipart body part for a subscribed resource.  <a href="#a2dba366491005a78cb1b67070de74a6e">More...</a><br /></td></tr>
<tr class="separator:a2dba366491005a78cb1b67070de74a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55abfb60c70c5e948521709e10e54492"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a55abfb60c70c5e948521709e10e54492">build_node_children</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *list, struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *parent, struct resources *visited)</td></tr>
<tr class="memdesc:a55abfb60c70c5e948521709e10e54492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build child nodes for a given parent.  <a href="#a55abfb60c70c5e948521709e10e54492">More...</a><br /></td></tr>
<tr class="separator:a55abfb60c70c5e948521709e10e54492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3707d69a8c25755d9fbe3f4d2ed80477"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *resource, struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *tree, int has_eventlist_support)</td></tr>
<tr class="memdesc:a3707d69a8c25755d9fbe3f4d2ed80477"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a resource tree.  <a href="#a3707d69a8c25755d9fbe3f4d2ed80477">More...</a><br /></td></tr>
<tr class="separator:a3707d69a8c25755d9fbe3f4d2ed80477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa1afb0a81eaeebda85dbb188f82df7"><td class="memItemLeft" align="right" valign="top">static pjsip_multipart_part *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0aa1afb0a81eaeebda85dbb188f82df7">build_rlmi_body</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct body_part_list *body_parts, unsigned int full_state)</td></tr>
<tr class="memdesc:a0aa1afb0a81eaeebda85dbb188f82df7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an RLMI body part for a multipart resource list body.  <a href="#a0aa1afb0a81eaeebda85dbb188f82df7">More...</a><br /></td></tr>
<tr class="separator:a0aa1afb0a81eaeebda85dbb188f82df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6654da48a7765b0c5957be5c282ea6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *<a class="el" href="../../d5/da1/structnode.html">node</a>, const char **resources, size_t num_resources)</td></tr>
<tr class="memdesc:a2a6654da48a7765b0c5957be5c282ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the integrity of a tree node against a set of resources.  <a href="#a2a6654da48a7765b0c5957be5c282ea6">More...</a><br /></td></tr>
<tr class="separator:a2a6654da48a7765b0c5957be5c282ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a0d1004e7965d66f03d5a12645e81b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a> (struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *list)</td></tr>
<tr class="memdesc:a30a0d1004e7965d66f03d5a12645e81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">RAII callback to destroy a resource list.  <a href="#a30a0d1004e7965d66f03d5a12645e81b">More...</a><br /></td></tr>
<tr class="separator:a30a0d1004e7965d66f03d5a12645e81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47e4246289d04b68202052414c219922"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e4246289d04b68202052414c219922">cli_complete_subscription_callid</a> (struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</td></tr>
<tr class="separator:a47e4246289d04b68202052414c219922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1659843ab11cf04649f5a03657943bb8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1659843ab11cf04649f5a03657943bb8">cli_complete_subscription_common</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../d7/df6/structcli__sub__complete__parms.html">cli_sub_complete_parms</a> *<a class="el" href="../../d9/d53/pbx__hangup__handler_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>)</td></tr>
<tr class="separator:a1659843ab11cf04649f5a03657943bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb94c33681f975e62c71f1e970f7dae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aebb94c33681f975e62c71f1e970f7dae">cli_complete_subscription_inbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:aebb94c33681f975e62c71f1e970f7dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba86604727a1f14973496013df1884e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3ba86604727a1f14973496013df1884e">cli_complete_subscription_outbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a3ba86604727a1f14973496013df1884e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4732f846f9b6cda02dea380f561ea76a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4732f846f9b6cda02dea380f561ea76a">cli_list_subscriptions_detail</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *<a class="el" href="../../d9/d53/pbx__hangup__handler_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>)</td></tr>
<tr class="separator:a4732f846f9b6cda02dea380f561ea76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae4f7e71c1e215af22111048af6ab93"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#adae4f7e71c1e215af22111048af6ab93">cli_list_subscriptions_inbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:adae4f7e71c1e215af22111048af6ab93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636cc42bbb2d876178e506f54bf1d05f"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a636cc42bbb2d876178e506f54bf1d05f">cli_list_subscriptions_inout</a> (struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</td></tr>
<tr class="separator:a636cc42bbb2d876178e506f54bf1d05f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b81ad8c54b40786d415a17d1fe9ff7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a67b81ad8c54b40786d415a17d1fe9ff7">cli_list_subscriptions_outbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a67b81ad8c54b40786d415a17d1fe9ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8d7453ec67a6a31fa80feffc283128"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acf8d7453ec67a6a31fa80feffc283128">cli_show_subscription_common</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *<a class="el" href="../../d9/d53/pbx__hangup__handler_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>)</td></tr>
<tr class="separator:acf8d7453ec67a6a31fa80feffc283128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66473fb602c745c3dfa226d1c47f425f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a66473fb602c745c3dfa226d1c47f425f">cli_show_subscription_inbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a66473fb602c745c3dfa226d1c47f425f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a440b205b153f5b7fa6e0be3eb82ef"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8a440b205b153f5b7fa6e0be3eb82ef">cli_show_subscription_inout</a> (struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</td></tr>
<tr class="separator:ad8a440b205b153f5b7fa6e0be3eb82ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539e82113ed22c70c9f62f4d45f15b67"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a539e82113ed22c70c9f62f4d45f15b67">cli_show_subscription_outbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a539e82113ed22c70c9f62f4d45f15b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a082c4ba2ff2ee9753efd0875b7cfaec3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a082c4ba2ff2ee9753efd0875b7cfaec3">cli_show_subscriptions_detail</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *<a class="el" href="../../d9/d53/pbx__hangup__handler_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>)</td></tr>
<tr class="separator:a082c4ba2ff2ee9753efd0875b7cfaec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f7ab75ea44a7eb7527943b70a742fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a89f7ab75ea44a7eb7527943b70a742fc">cli_show_subscriptions_inbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a89f7ab75ea44a7eb7527943b70a742fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1bd467902006e27be217191f4f6c793"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad1bd467902006e27be217191f4f6c793">cli_show_subscriptions_inout</a> (struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</td></tr>
<tr class="separator:ad1bd467902006e27be217191f4f6c793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a161e2b74b0b3b249c8c9e3ba8bb782ae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a161e2b74b0b3b249c8c9e3ba8bb782ae">cli_show_subscriptions_outbound</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, void *arg)</td></tr>
<tr class="separator:a161e2b74b0b3b249c8c9e3ba8bb782ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23418ae9f5ca7a907263b50b7dcc323d"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree)</td></tr>
<tr class="separator:a23418ae9f5ca7a907263b50b7dcc323d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac79436df96e320a3107e5e8dfb3e9720"><td class="memItemLeft" align="right" valign="top">static pjsip_msg_body *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac79436df96e320a3107e5e8dfb3e9720">create_multipart_body</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:ac79436df96e320a3107e5e8dfb3e9720"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and initialize the PJSIP multipart body structure for a resource list subscription.  <a href="#ac79436df96e320a3107e5e8dfb3e9720">More...</a><br /></td></tr>
<tr class="separator:ac79436df96e320a3107e5e8dfb3e9720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad353ed8aab9f1e54ccf8d2e89a96bcac"><td class="memItemLeft" align="right" valign="top">static pjsip_require_hdr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:ad353ed8aab9f1e54ccf8d2e89a96bcac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shortcut method to create a Require: eventlist header.  <a href="#ad353ed8aab9f1e54ccf8d2e89a96bcac">More...</a><br /></td></tr>
<tr class="separator:ad353ed8aab9f1e54ccf8d2e89a96bcac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31880cde88a125b5079ac946cc352603"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, const char *list_name, const char *<a class="el" href="../../df/d7d/structevent.html">event</a>, const char **resources, size_t num_resources)</td></tr>
<tr class="memdesc:a31880cde88a125b5079ac946cc352603"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate a resource list, store it in sorcery, and set its details  <a href="#a31880cde88a125b5079ac946cc352603">More...</a><br /></td></tr>
<tr class="separator:a31880cde88a125b5079ac946cc352603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a006316bcef76ef13dc1cc99560fbaa86"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a006316bcef76ef13dc1cc99560fbaa86">create_subscription_tree</a> (const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata, const char *resource, struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="el" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>, struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *tree, pj_status_t *dlg_status, struct <a class="el" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence)</td></tr>
<tr class="memdesc:a006316bcef76ef13dc1cc99560fbaa86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a subscription tree based on a resource tree.  <a href="#a006316bcef76ef13dc1cc99560fbaa86">More...</a><br /></td></tr>
<tr class="separator:a006316bcef76ef13dc1cc99560fbaa86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45e6800f846deafb7b108ee3107b22a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad45e6800f846deafb7b108ee3107b22a">create_virtual_subscriptions</a> (const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *resource, struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="el" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>, struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *tree, struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *current)</td></tr>
<tr class="memdesc:ad45e6800f846deafb7b108ee3107b22a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a tree of virtual subscriptions based on a resource tree node.  <a href="#ad45e6800f846deafb7b108ee3107b22a">More...</a><br /></td></tr>
<tr class="separator:ad45e6800f846deafb7b108ee3107b22a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcc2b6e9a594e068ec58be82446b15fa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:abcc2b6e9a594e068ec58be82446b15fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c090850897d5a72420ff3446fe74440"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8c090850897d5a72420ff3446fe74440">destroy_subscriptions</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *root)</td></tr>
<tr class="separator:a8c090850897d5a72420ff3446fe74440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c0e99b92215cdc4a96b439c108cd0a"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad4c0e99b92215cdc4a96b439c108cd0a">determine_sip_publish_type</a> (pjsip_rx_data *rdata, pjsip_generic_string_hdr *etag_hdr, unsigned int *expires, int *entity_id)</td></tr>
<tr class="separator:ad4c0e99b92215cdc4a96b439c108cd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e5c81dbce6f5db2f91dbe92689ec2f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a37e5c81dbce6f5db2f91dbe92689ec2f">exceptional_accept</a> (const pj_str_t *accept)</td></tr>
<tr class="memdesc:a37e5c81dbce6f5db2f91dbe92689ec2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the Accept header from the SUBSCRIBE in the list of exceptions?  <a href="#a37e5c81dbce6f5db2f91dbe92689ec2f">More...</a><br /></td></tr>
<tr class="separator:a37e5c81dbce6f5db2f91dbe92689ec2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa43549aaa8be02c39bd1e405f44d27f1"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa43549aaa8be02c39bd1e405f44d27f1">find_body_generator</a> (char accept[<a class="el" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a>][64], size_t num_accept, const char *body_type)</td></tr>
<tr class="separator:aa43549aaa8be02c39bd1e405f44d27f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495d318729babacd6785c241fcdf845a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a495d318729babacd6785c241fcdf845a">find_body_generator_accept</a> (const char *accept)</td></tr>
<tr class="separator:a495d318729babacd6785c241fcdf845a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df18a3e8742e6bd4e6917b459c4c82d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a> (const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *subtype)</td></tr>
<tr class="separator:a5df18a3e8742e6bd4e6917b459c4c82d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0a8fc757c1fb1e064887580d4ba1ea"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3d0a8fc757c1fb1e064887580d4ba1ea">find_body_generator_type_subtype_nolock</a> (const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *subtype)</td></tr>
<tr class="separator:a3d0a8fc757c1fb1e064887580d4ba1ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a5833004176713878b9cbf3c311ec0"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a52a5833004176713878b9cbf3c311ec0">find_pub_handler</a> (const char *<a class="el" href="../../df/d7d/structevent.html">event</a>)</td></tr>
<tr class="separator:a52a5833004176713878b9cbf3c311ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219baab2a37a17e4922d696be2e07cca"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a219baab2a37a17e4922d696be2e07cca">find_sub_handler_for_event_name</a> (const char *event_name)</td></tr>
<tr class="separator:a219baab2a37a17e4922d696be2e07cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac952acea83472c9c285fe203a5b62ce3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a> (<a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a> on_subscription, void *arg)</td></tr>
<tr class="separator:ac952acea83472c9c285fe203a5b62ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf48fac09e3299c24b6f72f438c421f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4cf48fac09e3299c24b6f72f438c421f">format_ami_resource_lists</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:a4cf48fac09e3299c24b6f72f438c421f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90eeb90b815577ed6bee36f8278a6e73"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a90eeb90b815577ed6bee36f8278a6e73">free_body_parts</a> (struct body_part_list *parts)</td></tr>
<tr class="memdesc:a90eeb90b815577ed6bee36f8278a6e73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a list of body parts.  <a href="#a90eeb90b815577ed6bee36f8278a6e73">More...</a><br /></td></tr>
<tr class="separator:a90eeb90b815577ed6bee36f8278a6e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b691f0bc6a8c56d55095fa30cef4e47"><td class="memItemLeft" align="right" valign="top">static pjsip_generic_string_hdr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b691f0bc6a8c56d55095fa30cef4e47">generate_content_id_hdr</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a7b691f0bc6a8c56d55095fa30cef4e47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a Content-ID header.  <a href="#a7b691f0bc6a8c56d55095fa30cef4e47">More...</a><br /></td></tr>
<tr class="separator:a7b691f0bc6a8c56d55095fa30cef4e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19dd0f9dd8ac29890f8e90159ca7fb78"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a19dd0f9dd8ac29890f8e90159ca7fb78">generate_initial_notify</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:a19dd0f9dd8ac29890f8e90159ca7fb78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa801068c5728800b602dc19ecbe1b3cf"><td class="memItemLeft" align="right" valign="top">static pjsip_msg_body *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa801068c5728800b602dc19ecbe1b3cf">generate_list_body</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, unsigned int force_full_state)</td></tr>
<tr class="memdesc:aa801068c5728800b602dc19ecbe1b3cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a resource list body for NOTIFY requests.  <a href="#aa801068c5728800b602dc19ecbe1b3cf">More...</a><br /></td></tr>
<tr class="separator:aa801068c5728800b602dc19ecbe1b3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6f294a1dd6e02f90699c6862c8ff37"><td class="memItemLeft" align="right" valign="top">static pjsip_msg_body *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abe6f294a1dd6e02f90699c6862c8ff37">generate_notify_body</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *root, unsigned int force_full_state)</td></tr>
<tr class="memdesc:abe6f294a1dd6e02f90699c6862c8ff37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the body for a NOTIFY request.  <a href="#abe6f294a1dd6e02f90699c6862c8ff37">More...</a><br /></td></tr>
<tr class="separator:abe6f294a1dd6e02f90699c6862c8ff37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d439528eda8c1d3b35a443170e745d0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d439528eda8c1d3b35a443170e745d0">have_visited</a> (const char *resource, struct resources *visited)</td></tr>
<tr class="memdesc:a7d439528eda8c1d3b35a443170e745d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if this resource has been visited already.  <a href="#a7d439528eda8c1d3b35a443170e745d0">More...</a><br /></td></tr>
<tr class="separator:a7d439528eda8c1d3b35a443170e745d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673b72409d496c2975c04f5d44f8a277"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a> (void)</td></tr>
<tr class="separator:a673b72409d496c2975c04f5d44f8a277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb194881d03c561cd60d0c88f82c7478"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acb194881d03c561cd60d0c88f82c7478">initial_notify_task</a> (void *obj)</td></tr>
<tr class="separator:acb194881d03c561cd60d0c88f82c7478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb174e25bbf05213be145675e5e2c37f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abb174e25bbf05213be145675e5e2c37f">item_in_vector</a> (const struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *list, const char *<a class="el" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>)</td></tr>
<tr class="separator:abb174e25bbf05213be145675e5e2c37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a6f87906d88cf1f915a7598309a3f0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa1a6f87906d88cf1f915a7598309a3f0">list_item_handler</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:aa1a6f87906d88cf1f915a7598309a3f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04aa9b3ab93170dc00535e2deaa5c86"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa04aa9b3ab93170dc00535e2deaa5c86">list_item_to_str</a> (const void *obj, const intptr_t *<a class="el" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, char **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:aa04aa9b3ab93170dc00535e2deaa5c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2ec9c29cf673a20f527615e5acb98b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6a2ec9c29cf673a20f527615e5acb98b">parse_simple_message_summary</a> (char *body, struct <a class="el" href="../../d0/d4c/structsimple__message__summary.html">simple_message_summary</a> *summary)</td></tr>
<tr class="separator:a6a2ec9c29cf673a20f527615e5acb98b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa312ad955e7ad6a9dff13667be04c7f7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa312ad955e7ad6a9dff13667be04c7f7">persistence_endpoint_str2struct</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:aa312ad955e7ad6a9dff13667be04c7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56c0f161f100c005d4c95b26ca3f7d7d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a56c0f161f100c005d4c95b26ca3f7d7d">persistence_endpoint_struct2str</a> (const void *obj, const intptr_t *<a class="el" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, char **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:a56c0f161f100c005d4c95b26ca3f7d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae837565412b034de817b534fa2a7136"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aae837565412b034de817b534fa2a7136">persistence_expires_str2struct</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:aae837565412b034de817b534fa2a7136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946b1f58e8ead34101e6fc012088140a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a946b1f58e8ead34101e6fc012088140a">persistence_expires_struct2str</a> (const void *obj, const intptr_t *<a class="el" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, char **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:a946b1f58e8ead34101e6fc012088140a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dcc5a2234d92546bbeeead95aa648ec"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8dcc5a2234d92546bbeeead95aa648ec">persistence_generator_data_str2struct</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:a8dcc5a2234d92546bbeeead95aa648ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad276d9178ef9aad7e0d9ad2fbd52744d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad276d9178ef9aad7e0d9ad2fbd52744d">persistence_generator_data_struct2str</a> (const void *obj, const intptr_t *<a class="el" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, char **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:ad276d9178ef9aad7e0d9ad2fbd52744d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac028869908c724f84c3a1cee520315c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aac028869908c724f84c3a1cee520315c">persistence_tag_str2struct</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:aac028869908c724f84c3a1cee520315c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4305e5102dec63e8bbb9175dbab630e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac4305e5102dec63e8bbb9175dbab630e">persistence_tag_struct2str</a> (const void *obj, const intptr_t *<a class="el" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, char **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:ac4305e5102dec63e8bbb9175dbab630e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2474471fcc9b7191d508cf1b407417"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abb2474471fcc9b7191d508cf1b407417">populate_list</a> (struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *list, const char *<a class="el" href="../../df/d7d/structevent.html">event</a>, const char **resources, size_t num_resources)</td></tr>
<tr class="memdesc:abb2474471fcc9b7191d508cf1b407417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set properties on an allocated resource list.  <a href="#abb2474471fcc9b7191d508cf1b407417">More...</a><br /></td></tr>
<tr class="separator:abb2474471fcc9b7191d508cf1b407417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34bc405d2cc3c85aa8d449185c3569d6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a34bc405d2cc3c85aa8d449185c3569d6">publication_cmp_fn</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:a34bc405d2cc3c85aa8d449185c3569d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e99216a3b9def7b033ec0404e4140f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af9e99216a3b9def7b033ec0404e4140f">publication_destroy_fn</a> (void *obj)</td></tr>
<tr class="memdesc:af9e99216a3b9def7b033ec0404e4140f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal destructor for publications.  <a href="#af9e99216a3b9def7b033ec0404e4140f">More...</a><br /></td></tr>
<tr class="separator:af9e99216a3b9def7b033ec0404e4140f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267cc6529937f4689c804fb39976a823"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a267cc6529937f4689c804fb39976a823">publication_hash_fn</a> (const void *obj, const int flags)</td></tr>
<tr class="separator:a267cc6529937f4689c804fb39976a823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24c7cae87fc8a55c3a59bbf69cf7352"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab24c7cae87fc8a55c3a59bbf69cf7352">publication_resource_alloc</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:ab24c7cae87fc8a55c3a59bbf69cf7352"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocator for publication resource.  <a href="#ab24c7cae87fc8a55c3a59bbf69cf7352">More...</a><br /></td></tr>
<tr class="separator:ab24c7cae87fc8a55c3a59bbf69cf7352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad470e06c57059377443112a2012ec8bd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad470e06c57059377443112a2012ec8bd">publication_resource_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:ad470e06c57059377443112a2012ec8bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for publication resource.  <a href="#ad470e06c57059377443112a2012ec8bd">More...</a><br /></td></tr>
<tr class="separator:ad470e06c57059377443112a2012ec8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6d5815066f000bab8aa2aa43611f6c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#adb6d5815066f000bab8aa2aa43611f6c">publish_add_handler</a> (struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="separator:adb6d5815066f000bab8aa2aa43611f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93eb8c4f7adc89002faae30ba3b1da7d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a93eb8c4f7adc89002faae30ba3b1da7d">publish_expire</a> (const void *data)</td></tr>
<tr class="separator:a93eb8c4f7adc89002faae30ba3b1da7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5faf819b36c09254d66835d498e6e0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aaf5faf819b36c09254d66835d498e6e0">publish_expire_callback</a> (void *data)</td></tr>
<tr class="separator:aaf5faf819b36c09254d66835d498e6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abefb888baf6382d9f1a1266d24e21648"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abefb888baf6382d9f1a1266d24e21648">publish_request_initial</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata, struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="separator:abefb888baf6382d9f1a1266d24e21648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26689d72ab3ff9ce0e56c26fdc6dfd4b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a26689d72ab3ff9ce0e56c26fdc6dfd4b">pubsub_on_client_refresh</a> (pjsip_evsub *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:a26689d72ab3ff9ce0e56c26fdc6dfd4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edd9dcca7f3caf9af7a4af20ab64868"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9edd9dcca7f3caf9af7a4af20ab64868">pubsub_on_evsub_state</a> (pjsip_evsub *evsub, pjsip_event *<a class="el" href="../../df/d7d/structevent.html">event</a>)</td></tr>
<tr class="memdesc:a9edd9dcca7f3caf9af7a4af20ab64868"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback sequence for subscription terminate:  <a href="#a9edd9dcca7f3caf9af7a4af20ab64868">More...</a><br /></td></tr>
<tr class="separator:a9edd9dcca7f3caf9af7a4af20ab64868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b603dda9cf0a3354575494f0d4f9f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31b603dda9cf0a3354575494f0d4f9f9">pubsub_on_refresh_timeout</a> (void *userdata)</td></tr>
<tr class="separator:a31b603dda9cf0a3354575494f0d4f9f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9982efe78ddb41fc54368049fe7ecdfc"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9982efe78ddb41fc54368049fe7ecdfc">pubsub_on_rx_mwi_notify_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a9982efe78ddb41fc54368049fe7ecdfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f60cf5b4683fabadff63143ef959f2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac9f60cf5b4683fabadff63143ef959f2">pubsub_on_rx_notify</a> (pjsip_evsub *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, pjsip_rx_data *rdata, int *p_st_code, pj_str_t **p_st_text, pjsip_hdr *res_hdr, pjsip_msg_body **p_body)</td></tr>
<tr class="separator:ac9f60cf5b4683fabadff63143ef959f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba712df013e1be0394a2c2943a595376"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aba712df013e1be0394a2c2943a595376">pubsub_on_rx_notify_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:aba712df013e1be0394a2c2943a595376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dba55f11df69f28d19d9125e3995334"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4dba55f11df69f28d19d9125e3995334">pubsub_on_rx_publish_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a4dba55f11df69f28d19d9125e3995334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6a1ab8c6d5f63fbcc96ea70e0160cf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8f6a1ab8c6d5f63fbcc96ea70e0160cf">pubsub_on_rx_refresh</a> (pjsip_evsub *evsub, pjsip_rx_data *rdata, int *p_st_code, pj_str_t **p_st_text, pjsip_hdr *res_hdr, pjsip_msg_body **p_body)</td></tr>
<tr class="memdesc:a8f6a1ab8c6d5f63fbcc96ea70e0160cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called whenever an in-dialog SUBSCRIBE is received.  <a href="#a8f6a1ab8c6d5f63fbcc96ea70e0160cf">More...</a><br /></td></tr>
<tr class="separator:a8f6a1ab8c6d5f63fbcc96ea70e0160cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8deba4f5b210a282252f719b1a245029"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8deba4f5b210a282252f719b1a245029">pubsub_on_rx_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:a8deba4f5b210a282252f719b1a245029"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque structure representing an RFC 3265 SIP subscription.  <a href="#a8deba4f5b210a282252f719b1a245029">More...</a><br /></td></tr>
<tr class="separator:a8deba4f5b210a282252f719b1a245029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd8fc16260b8a617c3d028b66745d5ad"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd8fc16260b8a617c3d028b66745d5ad">pubsub_on_rx_subscribe_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:acd8fc16260b8a617c3d028b66745d5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3815d56063e28c51b863c26e6b3a49c9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3815d56063e28c51b863c26e6b3a49c9">pubsub_on_server_timeout</a> (pjsip_evsub *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:a3815d56063e28c51b863c26e6b3a49c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55772a6ad10b532f9ae2085ceb0c3942"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a55772a6ad10b532f9ae2085ceb0c3942">remove_subscription</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *obj)</td></tr>
<tr class="separator:a55772a6ad10b532f9ae2085ceb0c3942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64671fa6b889a9d62d646f3ab90cc775"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a64671fa6b889a9d62d646f3ab90cc775">resource_endpoint_handler</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:a64671fa6b889a9d62d646f3ab90cc775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3906226af7019edcf94ef2ce356dc7cf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3906226af7019edcf94ef2ce356dc7cf">resource_event_handler</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:a3906226af7019edcf94ef2ce356dc7cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae30488231b97f5060ccc10743e7a3a64"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae30488231b97f5060ccc10743e7a3a64">resource_list_alloc</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="separator:ae30488231b97f5060ccc10743e7a3a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ad88468ddb5b0d4e26b7406133bd8a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a28ad88468ddb5b0d4e26b7406133bd8a">resource_list_apply_handler</a> (const struct <a class="el" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="el" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>, void *obj)</td></tr>
<tr class="separator:a28ad88468ddb5b0d4e26b7406133bd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1dea1f3f371c8b1e033627343f74457"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab1dea1f3f371c8b1e033627343f74457">resource_list_destructor</a> (void *obj)</td></tr>
<tr class="separator:ab1dea1f3f371c8b1e033627343f74457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2de2a2c7ba7a0a16d4632b56af96fa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a> (struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *tree)</td></tr>
<tr class="memdesc:aca2de2a2c7ba7a0a16d4632b56af96fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a resource tree.  <a href="#aca2de2a2c7ba7a0a16d4632b56af96fa">More...</a><br /></td></tr>
<tr class="separator:aca2de2a2c7ba7a0a16d4632b56af96fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e6d67f6d539b39fd0ebe7171d480ca"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a93e6d67f6d539b39fd0ebe7171d480ca">retrieve_resource_list</a> (const char *resource, const char *<a class="el" href="../../df/d7d/structevent.html">event</a>)</td></tr>
<tr class="memdesc:a93e6d67f6d539b39fd0ebe7171d480ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for retrieving a resource list for a given event.  <a href="#a93e6d67f6d539b39fd0ebe7171d480ca">More...</a><br /></td></tr>
<tr class="separator:a93e6d67f6d539b39fd0ebe7171d480ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474bbe394cad0178cf128a36a312ca62"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a474bbe394cad0178cf128a36a312ca62">rlmi_clone_data</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const void *data, unsigned <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="separator:a474bbe394cad0178cf128a36a312ca62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a786140dcdee30f86fc9a661c515982bb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a786140dcdee30f86fc9a661c515982bb">rlmi_print_body</a> (struct pjsip_msg_body *msg_body, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, pj_size_t size)</td></tr>
<tr class="separator:a786140dcdee30f86fc9a661c515982bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef69ae2e93f18a3a6cc53e4759b332f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7ef69ae2e93f18a3a6cc53e4759b332f">sched_cb</a> (const void *data)</td></tr>
<tr class="separator:a7ef69ae2e93f18a3a6cc53e4759b332f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a312601e694a9ca811601375d4e33d8df"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a312601e694a9ca811601375d4e33d8df">schedule_notification</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree)</td></tr>
<tr class="separator:a312601e694a9ca811601375d4e33d8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b3391cb48972f432118c4ca2eeb3063"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, unsigned int force_full_state)</td></tr>
<tr class="memdesc:a8b3391cb48972f432118c4ca2eeb3063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a NOTIFY request to a subscriber.  <a href="#a8b3391cb48972f432118c4ca2eeb3063">More...</a><br /></td></tr>
<tr class="separator:a8b3391cb48972f432118c4ca2eeb3063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45317a8f9762fa3b934c723df1367336"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a45317a8f9762fa3b934c723df1367336">serialized_pubsub_on_client_refresh</a> (void *userdata)</td></tr>
<tr class="separator:a45317a8f9762fa3b934c723df1367336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfb18b697fd27c2c465c9d7182e9d82"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bfb18b697fd27c2c465c9d7182e9d82">serialized_pubsub_on_refresh_timeout</a> (void *userdata)</td></tr>
<tr class="separator:a3bfb18b697fd27c2c465c9d7182e9d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9568af1e66909dc6d642070e02b1a0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3e9568af1e66909dc6d642070e02b1a0">serialized_send_notify</a> (void *userdata)</td></tr>
<tr class="separator:a3e9568af1e66909dc6d642070e02b1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c5bddecd1c2126c026728ca98750b0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8c5bddecd1c2126c026728ca98750b0">set_state_terminated</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:ad8c5bddecd1c2126c026728ca98750b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b5a301995d607923de2caddcdcdb62"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a52b5a301995d607923de2caddcdcdb62">shutdown_subscriptions</a> (struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="separator:a52b5a301995d607923de2caddcdcdb62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8fd4e13f8412f935f22b1df916b55a3"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab8fd4e13f8412f935f22b1df916b55a3">sip_create_publication</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata, const char *resource, const char *event_configuration_name)</td></tr>
<tr class="separator:ab8fd4e13f8412f935f22b1df916b55a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20aeeed556614ef809787fb4f04de0fb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a20aeeed556614ef809787fb4f04de0fb">sip_publication_respond</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, int status_code, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a20aeeed556614ef809787fb4f04de0fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace14e2a3214654b0c1d15c05ba2bdb89"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ace14e2a3214654b0c1d15c05ba2bdb89">sip_subscription_accept</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, pjsip_rx_data *rdata, int response)</td></tr>
<tr class="separator:ace14e2a3214654b0c1d15c05ba2bdb89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4bf9f7f4557d02712ea86b10e5d6891"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae4bf9f7f4557d02712ea86b10e5d6891">sip_subscription_send_request</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:ae4bf9f7f4557d02712ea86b10e5d6891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0461ac441d662c000ef9408ab9dd01c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0461ac441d662c000ef9408ab9dd01c">sip_subscription_to_ami</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</td></tr>
<tr class="separator:ae0461ac441d662c000ef9408ab9dd01c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa8f8f5e7bf978b9bc6c710d3b3e437"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7fa8f8f5e7bf978b9bc6c710d3b3e437">sub_add_handler</a> (struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="separator:a7fa8f8f5e7bf978b9bc6c710d3b3e437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ea33c1531c67d7002776939ec80b2b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a45ea33c1531c67d7002776939ec80b2b">sub_persistence_recreate</a> (void *obj)</td></tr>
<tr class="separator:a45ea33c1531c67d7002776939ec80b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d4ca6324c97d4c2a957dea2aa74c27b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d4ca6324c97d4c2a957dea2aa74c27b">sub_tree_subscription_terminate_cb</a> (void *data)</td></tr>
<tr class="separator:a2d4ca6324c97d4c2a957dea2aa74c27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf46a87a277bf64c6230f9f2237906f8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a> (void *data)</td></tr>
<tr class="separator:abf46a87a277bf64c6230f9f2237906f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57976fae525316e955e6163f943db90"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af57976fae525316e955e6163f943db90">subscription_get_generator_from_rdata</a> (pjsip_rx_data *rdata, const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:af57976fae525316e955e6163f943db90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a body generator using the Accept header of an rdata message.  <a href="#af57976fae525316e955e6163f943db90">More...</a><br /></td></tr>
<tr class="separator:af57976fae525316e955e6163f943db90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f99a19e99580b4339e386220c2d9f6"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a97f99a19e99580b4339e386220c2d9f6">subscription_get_handler_from_rdata</a> (pjsip_rx_data *rdata, const char *endpoint)</td></tr>
<tr class="memdesc:a97f99a19e99580b4339e386220c2d9f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a handler using the Event header of an rdata message.  <a href="#a97f99a19e99580b4339e386220c2d9f6">More...</a><br /></td></tr>
<tr class="separator:a97f99a19e99580b4339e386220c2d9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae323533f795e111d13b1d7b9a3d1d973"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae323533f795e111d13b1d7b9a3d1d973">subscription_persistence_alloc</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:ae323533f795e111d13b1d7b9a3d1d973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocator for subscription persistence.  <a href="#ae323533f795e111d13b1d7b9a3d1d973">More...</a><br /></td></tr>
<tr class="separator:ae323533f795e111d13b1d7b9a3d1d973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a4fae74e9482fb6c95acb3d653a182"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a00a4fae74e9482fb6c95acb3d653a182">subscription_persistence_create</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree)</td></tr>
<tr class="memdesc:a00a4fae74e9482fb6c95acb3d653a182"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which creates initial persistence information of a subscription in sorcery.  <a href="#a00a4fae74e9482fb6c95acb3d653a182">More...</a><br /></td></tr>
<tr class="separator:a00a4fae74e9482fb6c95acb3d653a182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e6ba3b3b049c415ad3056467cc846c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae5e6ba3b3b049c415ad3056467cc846c">subscription_persistence_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:ae5e6ba3b3b049c415ad3056467cc846c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for subscription persistence.  <a href="#ae5e6ba3b3b049c415ad3056467cc846c">More...</a><br /></td></tr>
<tr class="separator:ae5e6ba3b3b049c415ad3056467cc846c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62bbbfecf4068411d7fa11225c91055"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac62bbbfecf4068411d7fa11225c91055">subscription_persistence_event_cb</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:ac62bbbfecf4068411d7fa11225c91055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event callback which fires subscription persistence recreation when the system is fully booted.  <a href="#ac62bbbfecf4068411d7fa11225c91055">More...</a><br /></td></tr>
<tr class="separator:ac62bbbfecf4068411d7fa11225c91055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8ac5e3b2ce24bb0441ca5c30fa783c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e8ac5e3b2ce24bb0441ca5c30fa783c">subscription_persistence_load</a> (void *data)</td></tr>
<tr class="memdesc:a0e8ac5e3b2ce24bb0441ca5c30fa783c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which loads and recreates persisted subscriptions upon startup when the system is fully booted.  <a href="#a0e8ac5e3b2ce24bb0441ca5c30fa783c">More...</a><br /></td></tr>
<tr class="separator:a0e8ac5e3b2ce24bb0441ca5c30fa783c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e4842b1807e5e2d33bfda094c83f84d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e4842b1807e5e2d33bfda094c83f84d">subscription_persistence_recreate</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="memdesc:a0e4842b1807e5e2d33bfda094c83f84d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to perform the actual recreation of a subscription.  <a href="#a0e4842b1807e5e2d33bfda094c83f84d">More...</a><br /></td></tr>
<tr class="separator:a0e4842b1807e5e2d33bfda094c83f84d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace626897b8057471bc8f06b3e91e16c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aace626897b8057471bc8f06b3e91e16c">subscription_persistence_remove</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree)</td></tr>
<tr class="memdesc:aace626897b8057471bc8f06b3e91e16c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which removes persistence of a subscription from sorcery.  <a href="#aace626897b8057471bc8f06b3e91e16c">More...</a><br /></td></tr>
<tr class="separator:aace626897b8057471bc8f06b3e91e16c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37c67d3e45723f0b0aaf21dd9e2d605"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, pjsip_rx_data *rdata, enum <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400">sip_persistence_update_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:ab37c67d3e45723f0b0aaf21dd9e2d605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which updates persistence information of a subscription in sorcery.  <a href="#ab37c67d3e45723f0b0aaf21dd9e2d605">More...</a><br /></td></tr>
<tr class="separator:ab37c67d3e45723f0b0aaf21dd9e2d605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc8db1e0ce416bc7a5a05275db0cb8a7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acc8db1e0ce416bc7a5a05275db0cb8a7">subscription_setup_dialog</a> (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree, pjsip_dialog *dlg)</td></tr>
<tr class="separator:acc8db1e0ce416bc7a5a05275db0cb8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c2af54560a8245eef9bd323c2f758b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a05c2af54560a8245eef9bd323c2f758b">subscription_tree_destructor</a> (void *obj)</td></tr>
<tr class="separator:a05c2af54560a8245eef9bd323c2f758b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e1ece55fdcfb0290b5cac07b1d463a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a91e1ece55fdcfb0290b5cac07b1d463a">subscription_unreference_dialog</a> (void *obj)</td></tr>
<tr class="separator:a91e1ece55fdcfb0290b5cac07b1d463a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2353e3034a3cbd98dcc94740a7d5f8c1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2353e3034a3cbd98dcc94740a7d5f8c1">test_new_subscribe</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, const char *resource)</td></tr>
<tr class="memdesc:a2353e3034a3cbd98dcc94740a7d5f8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">new_subscribe callback for unit tests  <a href="#a2353e3034a3cbd98dcc94740a7d5f8c1">More...</a><br /></td></tr>
<tr class="separator:a2353e3034a3cbd98dcc94740a7d5f8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd2ddc65db04f4a50bb9fe68a197b167"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a> (struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *tree)</td></tr>
<tr class="memdesc:acd2ddc65db04f4a50bb9fe68a197b167"><td class="mdescLeft">&#160;</td><td class="mdescRight">RAII_VAR callback to destroy an allocated resource tree.  <a href="#acd2ddc65db04f4a50bb9fe68a197b167">More...</a><br /></td></tr>
<tr class="separator:acd2ddc65db04f4a50bb9fe68a197b167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba83183b8ab9dfd5b4ce87ddafc78a1"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a> (const char *resource, struct resources *visited, unsigned int full_state)</td></tr>
<tr class="memdesc:adba83183b8ab9dfd5b4ce87ddafc78a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a tree node.  <a href="#adba83183b8ab9dfd5b4ce87ddafc78a1">More...</a><br /></td></tr>
<tr class="separator:adba83183b8ab9dfd5b4ce87ddafc78a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8324717cc2207dbde31f177aa7ac0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a> (struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *<a class="el" href="../../d5/da1/structnode.html">node</a>)</td></tr>
<tr class="memdesc:aab8324717cc2207dbde31f177aa7ac0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for a tree node.  <a href="#aab8324717cc2207dbde31f177aa7ac0f">More...</a><br /></td></tr>
<tr class="separator:aab8324717cc2207dbde31f177aa7ac0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP <a class="el" href="../../df/d7d/structevent.html">event</a> resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND, .requires = &quot;res_pjsip&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83103f48a2651972c0fc351bfd701bb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af83103f48a2651972c0fc351bfd701bb">accept_exceptions</a> []</td></tr>
<tr class="memdesc:af83103f48a2651972c0fc351bfd701bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept headers that are exceptions to the rule.  <a href="#af83103f48a2651972c0fc351bfd701bb">More...</a><br /></td></tr>
<tr class="separator:af83103f48a2651972c0fc351bfd701bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83aef050497f83116afc025b7acf19e3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a83aef050497f83116afc025b7acf19e3">bad_resources</a> []</td></tr>
<tr class="memdesc:a83aef050497f83116afc025b7acf19e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">"bad" resources  <a href="#a83aef050497f83116afc025b7acf19e3">More...</a><br /></td></tr>
<tr class="separator:a83aef050497f83116afc025b7acf19e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a158e31d31a846c1902563332f8ecb64d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/de0/structbody__generators.html">body_generators</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a158e31d31a846c1902563332f8ecb64d">body_generators</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:a158e31d31a846c1902563332f8ecb64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25de5dc4e2dde9c20c8a352172b10f0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/d90/structbody__supplements.html">body_supplements</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af25de5dc4e2dde9c20c8a352172b10f0">body_supplements</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:af25de5dc4e2dde9c20c8a352172b10f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1959d38582b0da24d4d42766cf13ade8"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a> []</td></tr>
<tr class="separator:a1959d38582b0da24d4d42766cf13ade8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47e7031430a4ba4c21aac39b482ffd82"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e7031430a4ba4c21aac39b482ffd82">esc_etag_counter</a></td></tr>
<tr class="separator:a47e7031430a4ba4c21aac39b482ffd82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c1f2dfc743e57aadd39d0be4b97e97"><td class="memItemLeft" align="right" valign="top">const pjsip_method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad7c1f2dfc743e57aadd39d0be4b97e97">pjsip_publish_method</a></td></tr>
<tr class="memdesc:ad7c1f2dfc743e57aadd39d0be4b97e97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defined method for PUBLISH.  <a href="#ad7c1f2dfc743e57aadd39d0be4b97e97">More...</a><br /></td></tr>
<tr class="separator:ad7c1f2dfc743e57aadd39d0be4b97e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e97ffc390b7710e0c89d5816fb65a0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad3e97ffc390b7710e0c89d5816fb65a0">publish_handlers</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:ad3e97ffc390b7710e0c89d5816fb65a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d62301cf52b6bc6d7b66cea60bee8cc"><td class="memItemLeft" align="right" valign="top">static pjsip_evsub_user&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d62301cf52b6bc6d7b66cea60bee8cc">pubsub_cb</a></td></tr>
<tr class="separator:a7d62301cf52b6bc6d7b66cea60bee8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f71e2a3aca3dcf8077d9c7edcb34325"><td class="memItemLeft" align="right" valign="top">static struct pjsip_module&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></td></tr>
<tr class="separator:a7f71e2a3aca3dcf8077d9c7edcb34325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae55303c463ee7d4709335ae3311c3826"><td class="memItemLeft" align="right" valign="top">static pjsip_media_type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae55303c463ee7d4709335ae3311c3826">rlmi_media_type</a></td></tr>
<tr class="separator:ae55303c463ee7d4709335ae3311c3826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361b448e9abcfc301602a2573a662d3c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a361b448e9abcfc301602a2573a662d3c">sched</a></td></tr>
<tr class="memdesc:a361b448e9abcfc301602a2573a662d3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scheduler used for automatically expiring publications.  <a href="#a361b448e9abcfc301602a2573a662d3c">More...</a><br /></td></tr>
<tr class="separator:a361b448e9abcfc301602a2573a662d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59dad57f47cf8401042d4ecd0b861e5"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#af59dad57f47cf8401042d4ecd0b861e5">sip_subscription_roles_map</a> []</td></tr>
<tr class="separator:af59dad57f47cf8401042d4ecd0b861e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abffbee599d833b446686d5213d80e4"><td class="memItemLeft" align="right" valign="top">static const pj_str_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4abffbee599d833b446686d5213d80e4">str_event_name</a> = { &quot;Event&quot;, 5 }</td></tr>
<tr class="separator:a4abffbee599d833b446686d5213d80e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba01bbffb64da676cd5176bb1d918b9"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a> []</td></tr>
<tr class="separator:a6ba01bbffb64da676cd5176bb1d918b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabdcafbd71c14ff0214432de08b762f2"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aabdcafbd71c14ff0214432de08b762f2">subscription_handlers</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:aabdcafbd71c14ff0214432de08b762f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa999be067508220af90f555956ae7ff"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../df/dab/structsubscriptions.html">subscriptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#aaa999be067508220af90f555956ae7ff">subscriptions</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:aaa999be067508220af90f555956ae7ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99619cb1fc467541615fc8d043d39643"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></td></tr>
<tr class="memdesc:a99619cb1fc467541615fc8d043d39643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscription handler for unit tests.  <a href="#a99619cb1fc467541615fc8d043d39643">More...</a><br /></td></tr>
<tr class="separator:a99619cb1fc467541615fc8d043d39643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ec9e1a5bbe250daa4df389a6127b83"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/d5b/structast__sip__notifier.html">ast_sip_notifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a10ec9e1a5bbe250daa4df389a6127b83">test_notifier</a></td></tr>
<tr class="memdesc:a10ec9e1a5bbe250daa4df389a6127b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscription notifier for unit tests.  <a href="#a10ec9e1a5bbe250daa4df389a6127b83">More...</a><br /></td></tr>
<tr class="separator:a10ec9e1a5bbe250daa4df389a6127b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a703b9f7d4c89444b70c00353c864765c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a703b9f7d4c89444b70c00353c864765c">&#9670;&nbsp;</a></span>AMI_SHOW_SUBSCRIPTIONS_INBOUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AMI_SHOW_SUBSCRIPTIONS_INBOUND&#160;&#160;&#160;&quot;PJSIPShowSubscriptionsInbound&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04135">4135</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">unload_module()</a>.</p>

</div>
</div>
<a id="a75e6251ec7546725dcb5cc72bf6b60ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e6251ec7546725dcb5cc72bf6b60ce">&#9670;&nbsp;</a></span>AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AMI_SHOW_SUBSCRIPTIONS_OUTBOUND&#160;&#160;&#160;&quot;PJSIPShowSubscriptionsOutbound&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04136">4136</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">unload_module()</a>.</p>

</div>
</div>
<a id="ae0e71457156b5ee3447f3a7bd2877e28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e71457156b5ee3447f3a7bd2877e28">&#9670;&nbsp;</a></span>CLI_LIST_SUB_FORMAT_ENTRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLI_LIST_SUB_FORMAT_ENTRY&#160;&#160;&#160;&quot;%-30.30s %-30.30s %6d %s\n&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04522">4522</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">cli_list_subscriptions_detail()</a>.</p>

</div>
</div>
<a id="abed51420cb87ea551279a07f2c502a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abed51420cb87ea551279a07f2c502a37">&#9670;&nbsp;</a></span>CLI_LIST_SUB_FORMAT_HEADER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLI_LIST_SUB_FORMAT_HEADER&#160;&#160;&#160;&quot;%-30.30s %-30.30s %6.6s %s\n&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04521">4521</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">cli_list_subscriptions_inout()</a>.</p>

</div>
</div>
<a id="a025e1fa7b644cd3de8f0f7fe4ab42100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025e1fa7b644cd3de8f0f7fe4ab42100">&#9670;&nbsp;</a></span>CLI_SHOW_SUB_FORMAT_ENTRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLI_SHOW_SUB_FORMAT_ENTRY</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="stringliteral">&quot;Endpoint: %s/%s\n&quot;</span> \</div><div class="line">   <span class="stringliteral">&quot;Resource: %s/%s\n&quot;</span> \</div><div class="line">   <span class="stringliteral">&quot;  Expiry: %8d  %s\n\n&quot;</span></div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04379">4379</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">cli_show_subscriptions_detail()</a>.</p>

</div>
</div>
<a id="a2da91e964cff994ce0e57b494316b043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2da91e964cff994ce0e57b494316b043">&#9670;&nbsp;</a></span>CLI_SHOW_SUB_FORMAT_HEADER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLI_SHOW_SUB_FORMAT_HEADER</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="stringliteral">&quot;Endpoint: &lt;Endpoint/Caller-ID.............................................&gt;\n&quot;</span> \</div><div class="line">   <span class="stringliteral">&quot;Resource: &lt;Resource/Event.................................................&gt;\n&quot;</span> \</div><div class="line">   <span class="stringliteral">&quot;  Expiry: &lt;Expiry&gt;  &lt;Call-id..............................................&gt;\n&quot;</span> \</div><div class="line">   <span class="stringliteral">&quot;===========================================================================\n\n&quot;</span></div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04374">4374</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">cli_show_subscriptions_inout()</a>.</p>

</div>
</div>
<a id="a39fcd37b99a8eafd0aa1c961d8736f88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fcd37b99a8eafd0aa1c961d8736f88">&#9670;&nbsp;</a></span>DATASTORE_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATASTORE_BUCKETS&#160;&#160;&#160;53</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of buckets for subscription datastore. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00250">250</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="afc353f33f479f252b0cea51d55afc7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc353f33f479f252b0cea51d55afc7ca">&#9670;&nbsp;</a></span>DEFAULT_EXPIRES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_EXPIRES&#160;&#160;&#160;3600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default expiration for subscriptions. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00253">253</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02777">ast_sip_register_subscription_handler()</a>.</p>

</div>
</div>
<a id="a4d530a1f675151206b5929a37a882fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d530a1f675151206b5929a37a882fe2">&#9670;&nbsp;</a></span>DEFAULT_PUBLISH_EXPIRES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_PUBLISH_EXPIRES&#160;&#160;&#160;3600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default expiration time for PUBLISH if one is not specified. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">247</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03102">determine_sip_publish_type()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">sip_create_publication()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>.</p>

</div>
</div>
<a id="a46e524af59f26e0f0825b21acf9ea886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46e524af59f26e0f0825b21acf9ea886">&#9670;&nbsp;</a></span>MAX_REGEX_ERROR_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_REGEX_ERROR_LEN&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04138">4138</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">cli_list_subscriptions_inout()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">cli_show_subscriptions_inout()</a>.</p>

</div>
</div>
<a id="ab95c1bf11412f8e2a82ddd0eb69ad4a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab95c1bf11412f8e2a82ddd0eb69ad4a4">&#9670;&nbsp;</a></span>MOD_DATA_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOD_DATA_MSG&#160;&#160;&#160;&quot;sub_msg&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00236">236</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01854">ast_sip_subscription_get_header()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>

</div>
</div>
<a id="ad9ab4b2e3c02b132f457ec3e61d5d47d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ab4b2e3c02b132f457ec3e61d5d47d">&#9670;&nbsp;</a></span>MOD_DATA_PERSISTENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOD_DATA_PERSISTENCE&#160;&#160;&#160;&quot;sub_persistence&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">235</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">sip_subscription_accept()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>

</div>
</div>
<a id="a7b2ea661eb5491432e647c3070aa78a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2ea661eb5491432e647c3070aa78a7">&#9670;&nbsp;</a></span>PUBLICATIONS_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PUBLICATIONS_BUCKETS&#160;&#160;&#160;37</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of buckets for publications (on a per handler) </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00244">244</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">ast_sip_register_publish_handler()</a>.</p>

</div>
</div>
<a id="a7f5d6a140ec019c5cf145f0d78a946a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f5d6a140ec019c5cf145f0d78a946a5">&#9670;&nbsp;</a></span>RESOURCE_LIST_INIT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESOURCE_LIST_INIT_SIZE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04750">4750</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04764">resource_list_alloc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a0b174b002a4e991ef8c08f17118f8cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b174b002a4e991ef8c08f17118f8cd5">&#9670;&nbsp;</a></span>on_subscription_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* on_subscription_t) (struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, void *arg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01798">1798</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a36292f9aacdecd44efe47fa591beb400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36292f9aacdecd44efe47fa591beb400">&#9670;&nbsp;</a></span>sip_persistence_update_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400">sip_persistence_update_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2"></a>SUBSCRIPTION_PERSISTENCE_SEND_REQUEST&#160;</td><td class="fielddoc"><p>Called from send request </p>
</td></tr>
<tr><td class="fieldname"><a id="a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3"></a>SUBSCRIPTION_PERSISTENCE_CREATED&#160;</td><td class="fielddoc"><p>Subscription created from initial client request </p>
</td></tr>
<tr><td class="fieldname"><a id="a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2"></a>SUBSCRIPTION_PERSISTENCE_RECREATED&#160;</td><td class="fielddoc"><p>Subscription recreated by asterisk on startup </p>
</td></tr>
<tr><td class="fieldname"><a id="a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240"></a>SUBSCRIPTION_PERSISTENCE_REFRESHED&#160;</td><td class="fielddoc"><p>Subscription created from client refresh </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00523">523</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                 {<span class="comment"></span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">   /*! Called from send request */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">   /*! Subscription created from initial client request */</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a>,<span class="comment"></span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">   /*! Subscription recreated by asterisk on startup */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a>,<span class="comment"></span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">   /*! Subscription created from client refresh */</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240">SUBSCRIPTION_PERSISTENCE_REFRESHED</a>,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;};</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00527">res_pjsip_pubsub.c:527</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240">SUBSCRIPTION_PERSISTENCE_REFRESHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00531">res_pjsip_pubsub.c:531</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00525">res_pjsip_pubsub.c:525</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00529">res_pjsip_pubsub.c:529</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42ecd8494df028dc44c95b90848ad311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ecd8494df028dc44c95b90848ad311">&#9670;&nbsp;</a></span>sip_publish_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The types of PUBLISH messages defined in RFC 3903. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008"></a>SIP_PUBLISH_UNKNOWN&#160;</td><td class="fielddoc"><p>Unknown. </p>
<p>This actually is not defined in RFC 3903. We use this as a constant to indicate that an incoming PUBLISH does not fit into any of the other categories and is thus invalid. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623"></a>SIP_PUBLISH_INITIAL&#160;</td><td class="fielddoc"><p>Initial. </p>
<p>The first PUBLISH sent. This will contain a non-zero Expires header as well as a body that indicates the current state of the endpoint that has sent the message. The initial PUBLISH is the only type of PUBLISH to not contain a Sip-If-Match header in it. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69"></a>SIP_PUBLISH_REFRESH&#160;</td><td class="fielddoc"><p>Refresh. </p>
<p>Used to keep a published state from expiring. This will contain a non-zero Expires header but no body since its purpose is not to update state. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519"></a>SIP_PUBLISH_MODIFY&#160;</td><td class="fielddoc"><p>Modify. </p>
<p>Used to change state from its previous value. This will contain a body updating the published state. May or may not contain an Expires header. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9"></a>SIP_PUBLISH_REMOVE&#160;</td><td class="fielddoc"><p>Remove. </p>
<p>Used to remove published state from an ESC. This will contain an Expires header set to 0 and likely no body. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008"></a>SIP_PUBLISH_UNKNOWN&#160;</td><td class="fielddoc"><p>Unknown. </p>
<p>This actually is not defined in RFC 3903. We use this as a constant to indicate that an incoming PUBLISH does not fit into any of the other categories and is thus invalid. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623"></a>SIP_PUBLISH_INITIAL&#160;</td><td class="fielddoc"><p>Initial. </p>
<p>The first PUBLISH sent. This will contain a non-zero Expires header as well as a body that indicates the current state of the endpoint that has sent the message. The initial PUBLISH is the only type of PUBLISH to not contain a Sip-If-Match header in it. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69"></a>SIP_PUBLISH_REFRESH&#160;</td><td class="fielddoc"><p>Refresh. </p>
<p>Used to keep a published state from expiring. This will contain a non-zero Expires header but no body since its purpose is not to update state. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519"></a>SIP_PUBLISH_MODIFY&#160;</td><td class="fielddoc"><p>Modify. </p>
<p>Used to change state from its previous value. This will contain a body updating the published state. May or may not contain an Expires header. </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9"></a>SIP_PUBLISH_REMOVE&#160;</td><td class="fielddoc"><p>Remove. </p>
<p>Used to remove published state from an ESC. This will contain an Expires header set to 0 and likely no body. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00265">265</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                      {<span class="comment"></span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    * \brief Unknown</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    * \details</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    * This actually is not defined in RFC 3903. We use this as a constant</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">    * to indicate that an incoming PUBLISH does not fit into any of the</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">    * other categories and is thus invalid.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    * \brief Initial</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">    * \details</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">    * The first PUBLISH sent. This will contain a non-zero Expires header</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    * as well as a body that indicates the current state of the endpoint</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    * that has sent the message. The initial PUBLISH is the only type</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    * of PUBLISH to not contain a Sip-If-Match header in it.</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    * \brief Refresh</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    * \details</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    * Used to keep a published state from expiring. This will contain a</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    * non-zero Expires header but no body since its purpose is not to</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    * update state.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a>,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    * \brief Modify</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    * \details</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    * Used to change state from its previous value. This will contain</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    * a body updating the published state. May or may not contain an</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    * Expires header.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a>,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    * \brief Remove</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    * \details</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    * Used to remove published state from an ESC. This will contain</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    * an Expires header set to 0 and likely no body.</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;};</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a></div><div class="ttdoc">Unknown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00274">res_pjsip_pubsub.c:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a></div><div class="ttdoc">Refresh. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00295">res_pjsip_pubsub.c:295</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a></div><div class="ttdoc">Modify. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00305">res_pjsip_pubsub.c:305</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a></div><div class="ttdoc">Initial. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00285">res_pjsip_pubsub.c:285</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a></div><div class="ttdoc">Remove. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00314">res_pjsip_pubsub.c:314</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a386166c75f00c0b4d1878e3a6d666e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386166c75f00c0b4d1878e3a6d666e89">&#9670;&nbsp;</a></span>sip_subscription_tree_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89">sip_subscription_tree_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The state of the subscription tree. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"></a>SIP_SUB_TREE_NORMAL&#160;</td><td class="fielddoc"><p>Normal operation </p>
</td></tr>
<tr><td class="fieldname"><a id="a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"></a>SIP_SUB_TREE_TERMINATE_PENDING&#160;</td><td class="fielddoc"><p>A terminate has been requested by Asterisk, the client, or pjproject </p>
</td></tr>
<tr><td class="fieldname"><a id="a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"></a>SIP_SUB_TREE_TERMINATE_IN_PROGRESS&#160;</td><td class="fielddoc"><p>The terminate is in progress </p>
</td></tr>
<tr><td class="fieldname"><a id="a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab"></a>SIP_SUB_TREE_TERMINATED&#160;</td><td class="fielddoc"><p>The terminate process has finished and the subscription tree is no longer valid </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00404">404</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                 {<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">   /*! Normal operation */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">   /*! A terminate has been requested by Asterisk, the client, or pjproject */</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>,<span class="comment"></span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">   /*! The terminate is in progress */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>,<span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">   /*! The terminate process has finished and the subscription tree is no longer valid */</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a>,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;};</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">res_pjsip_pubsub.c:406</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00412">res_pjsip_pubsub.c:412</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">res_pjsip_pubsub.c:408</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05714">5714</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05714">5714</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="ac9ccf20fa81744533ad45801f7f1a3b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ccf20fa81744533ad45801f7f1a3b6">&#9670;&nbsp;</a></span>add_rlmi_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_rlmi_resource </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_xml_node *&#160;</td>
          <td class="paramname"><em>rlmi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_generic_string_hdr *&#160;</td>
          <td class="paramname"><em>cid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_sip_uri *&#160;</td>
          <td class="paramname"><em>resource_uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_evsub_state&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a resource XML element to an RLMI body. </p>
<p>Each resource element represents a subscribed resource in the list. This function currently will unconditionally add an instance element to each created resource element. Instance elements refer to later parts in the multipart body.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>PJLIB allocation pool </td></tr>
    <tr><td class="paramname">cid</td><td>Content-ID header of the resource </td></tr>
    <tr><td class="paramname">resource_name</td><td>Name of the resource </td></tr>
    <tr><td class="paramname">resource_uri</td><td>URI of the resource </td></tr>
    <tr><td class="paramname">state</td><td>State of the subscribed resource </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02029">2029</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d48/strings_8c_source.html#l00227">ast_generate_random_string()</a>, <a class="el" href="../../db/d6b/presence__xml_8c_source.html#l00140">ast_sip_presence_xml_create_attr()</a>, <a class="el" href="../../db/d6b/presence__xml_8c_source.html#l00152">ast_sip_presence_xml_create_node()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">cid_name</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;{</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   <span class="keyword">static</span> pj_str_t <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a> = { <span class="stringliteral">&quot;cid&quot;</span>, 3 };</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;   pj_xml_node *resource;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;   pj_xml_node *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;   pj_xml_node *instance;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   pj_xml_attr *cid_attr;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   <span class="keywordtype">char</span> <span class="keywordtype">id</span>[6];</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   <span class="keywordtype">char</span> uri[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   <span class="comment">/* This creates a string representing the Content-ID without the enclosing &lt; &gt; */</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;   <span class="keyword">const</span> pj_str_t cid_stripped = {</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      .ptr = cid-&gt;hvalue.ptr + 1,</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      .slen = cid-&gt;hvalue.slen - 2,</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;   };</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   resource = <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;resource&quot;</span>);</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   name = <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, resource, <span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   instance = <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, resource, <span class="stringliteral">&quot;instance&quot;</span>);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   pjsip_uri_print(PJSIP_URI_IN_CONTACT_HDR, resource_uri, uri, <span class="keyword">sizeof</span>(uri));</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, resource, <span class="stringliteral">&quot;uri&quot;</span>, uri);</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;name-&gt;content, resource_name);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a>(<span class="keywordtype">id</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">id</span>));</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, instance, <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, instance, <span class="stringliteral">&quot;state&quot;</span>,</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;         <a class="code" href="../../d4/d88/structstate.html">state</a> == PJSIP_EVSUB_STATE_TERMINATED ? <span class="stringliteral">&quot;terminated&quot;</span> : <span class="stringliteral">&quot;active&quot;</span>);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   <span class="comment">/* Use the PJLIB-util XML library directly here since we are using a</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">    * pj_str_t</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   cid_attr = pj_xml_attr_new(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;cid_name, &amp;cid_stripped);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   pj_xml_add_attr(instance, cid_attr);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;}</div><div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="res__pjsip__presence__xml_8h_html_af60a5851382ce5f434b07fdefc194cbe"><div class="ttname"><a href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a></div><div class="ttdeci">pj_xml_attr * ast_sip_presence_xml_create_attr(pj_pool_t *pool, pj_xml_node *node, const char *name, const char *value)</div><div class="ttdoc">Create XML attribute. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6b/presence__xml_8c_source.html#l00140">presence_xml.c:140</a></div></div>
<div class="ttc" id="strings_8h_html_ab2c8e1bf4b2b01a1ffabf882774907bb"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a></div><div class="ttdeci">char * ast_generate_random_string(char *buf, size_t size)</div><div class="ttdoc">Create a pseudo-random string of a fixed length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00227">strings.c:227</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="res__pjsip__presence__xml_8h_html_ae8b2b2ccfe3099ff401bad55c2820f98"><div class="ttname"><a href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a></div><div class="ttdeci">pj_xml_node * ast_sip_presence_xml_create_node(pj_pool_t *pool, pj_xml_node *parent, const char *name)</div><div class="ttdoc">Create XML node. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6b/presence__xml_8c_source.html#l00152">presence_xml.c:152</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_ade5a89f9bee15a492c760ec1765a292d"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a></div><div class="ttdeci">static char cid_name[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">chan_mgcp.c:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ebc5adf3564428c0201cff2376dd187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ebc5adf3564428c0201cff2376dd187">&#9670;&nbsp;</a></span>add_subscription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_subscription </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01175">1175</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00740">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, and <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">ast_sip_create_subscription()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>, obj, next);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structsubscriptions_html"><div class="ttname"><a href="../../df/dab/structsubscriptions.html">subscriptions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00534">res_pjsip_pubsub.c:534</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5314d6fbf19f6f10073f1d4e0787e957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5314d6fbf19f6f10073f1d4e0787e957">&#9670;&nbsp;</a></span>allocate_body_part()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d2/de8/structbody__part.html">body_part</a>* allocate_body_part </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate and initialize a body part structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>PJLIB allocation pool </td></tr>
    <tr><td class="paramname">sub</td><td>Subscription representing a subscribed resource </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02233">2233</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">body_part::cid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02107">generate_content_id_hdr()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02084">body_part::resource</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02088">body_part::state</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02086">body_part::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02258">build_body_part()</a>.</p>
<div class="fragment"><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;{</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/de8/structbody__part.html">body_part</a> *bp;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;   bp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*bp));</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;   <span class="keywordflow">if</span> (!bp) {</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;   }</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">cid</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b691f0bc6a8c56d55095fa30cef4e47">generate_content_id_hdr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, sub);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a97b7ef5a69a288651ec0d5acbe75d36d">resource</a> = sub-&gt;resource;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a06eab984618d6a85fadc73dfb41f5c69">state</a> = sub-&gt;subscription_state;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#ac43e5728c2093e52e8a06774ab68afe2">uri</a> = sub-&gt;uri;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   <span class="keywordflow">return</span> bp;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;}</div><div class="ttc" id="structbody__part_html"><div class="ttname"><a href="../../d2/de8/structbody__part.html">body_part</a></div><div class="ttdoc">A multipart body part and meta-information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02080">res_pjsip_pubsub.c:2080</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="structbody__part_html_a97b7ef5a69a288651ec0d5acbe75d36d"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97b7ef5a69a288651ec0d5acbe75d36d">body_part::resource</a></div><div class="ttdeci">const char * resource</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02084">res_pjsip_pubsub.c:2084</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structbody__part_html_ac43e5728c2093e52e8a06774ab68afe2"><div class="ttname"><a href="../../d2/de8/structbody__part.html#ac43e5728c2093e52e8a06774ab68afe2">body_part::uri</a></div><div class="ttdeci">pjsip_sip_uri * uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02086">res_pjsip_pubsub.c:2086</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structbody__part_html_a97f61ce218f9876fc092948fe744b2bc"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">body_part::cid</a></div><div class="ttdeci">pjsip_generic_string_hdr * cid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">res_pjsip_pubsub.c:2082</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7b691f0bc6a8c56d55095fa30cef4e47"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b691f0bc6a8c56d55095fa30cef4e47">generate_content_id_hdr</a></div><div class="ttdeci">static pjsip_generic_string_hdr * generate_content_id_hdr(pj_pool_t *pool, const struct ast_sip_subscription *sub)</div><div class="ttdoc">Create a Content-ID header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02107">res_pjsip_pubsub.c:2107</a></div></div>
<div class="ttc" id="structbody__part_html_a06eab984618d6a85fadc73dfb41f5c69"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a06eab984618d6a85fadc73dfb41f5c69">body_part::state</a></div><div class="ttdeci">pjsip_evsub_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02088">res_pjsip_pubsub.c:2088</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa70a279b186df17b611eabf8164c396c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa70a279b186df17b611eabf8164c396c">&#9670;&nbsp;</a></span>allocate_subscription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a>* allocate_subscription </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">1233</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00095">ast_datastores_alloc()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">destroy_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">subscription_persistence::generator_data</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">ast_sip_create_subscription()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">create_virtual_subscriptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;{</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   pjsip_sip_uri *contact_uri;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   sub = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*sub) + strlen(resource) + 1);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   strcpy(sub-&gt;resource, resource); <span class="comment">/* Safe */</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a> = <a class="code" href="../../d9/db6/datastore_8h.html#afa0c7f9c8f98470441ff8e9b3e8f34cc">ast_datastores_alloc</a>();</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a>(sub);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;   }</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   sub-&gt;body_text = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;body_text) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a>(sub);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   sub-&gt;uri = pjsip_sip_uri_create(tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;pool, PJ_FALSE);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   contact_uri = pjsip_uri_get_uri(tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;local.contact-&gt;uri);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   pjsip_sip_uri_assign(tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;pool, sub-&gt;uri, contact_uri);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;   pj_strdup2(tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;pool, &amp;sub-&gt;uri-&gt;user, resource);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   <span class="comment">/* If there is any persistence information available for this subscription that was persisted</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">    * then make it available so that the NOTIFY has the correct state.</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a> &amp;&amp; tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>) {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      sub-&gt;persistence_data = <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>, resource));</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a> = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   sub-&gt;subscription_state = PJSIP_EVSUB_STATE_ACTIVE;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;   sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(tree);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="datastore_8h_html_afa0c7f9c8f98470441ff8e9b3e8f34cc"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#afa0c7f9c8f98470441ff8e9b3e8f34cc">ast_datastores_alloc</a></div><div class="ttdeci">struct ao2_container * ast_datastores_alloc(void)</div><div class="ttdoc">Allocate a specialized data stores container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00095">datastore.c:95</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structast__sip__subscription_html"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></div><div class="ttdoc">Structure representing a &quot;virtual&quot; SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00477">res_pjsip_pubsub.c:477</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abcc2b6e9a594e068ec58be82446b15fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a></div><div class="ttdeci">static void destroy_subscription(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">res_pjsip_pubsub.c:1201</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a1805e05b0976bcd4f821f92c0206cba0"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">subscription_persistence::generator_data</a></div><div class="ttdeci">struct ast_json * generator_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">res_pjsip_pubsub.c:398</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae855491c1f2f6714df5daa3fd69a10df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae855491c1f2f6714df5daa3fd69a10df">&#9670;&nbsp;</a></span>allocate_subscription_tree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a>* allocate_subscription_tree </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">1405</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00443">ast_module_ref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">ast_sip_create_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">ast_sip_get_distributor_serializer()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01295">ast_taskprocessor_build_name()</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00060">AST_TASKPROCESSOR_MAX_NAME</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">sip_subscription_tree::notify_sched_id</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">subscription_tree_destructor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">ast_sip_create_subscription()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;{</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   sub_tree = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span> *sub_tree, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a05c2af54560a8245eef9bd323c2f758b">subscription_tree_destructor</a>);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   <span class="keywordflow">if</span> (!sub_tree) {</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   <span class="keywordflow">if</span> (rdata) {</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">       * We must continue using the serializer that the original</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">       * SUBSCRIBE came in on for the dialog.  There may be</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">       * retransmissions already enqueued in the original</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">       * serializer that can result in reentrancy and message</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">       * sequencing problems.</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a>(rdata);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordtype">char</span> tps_name[<a class="code" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a> + 1];</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="comment">/* Create name with seq number appended. */</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a>(tps_name, <span class="keyword">sizeof</span>(tps_name), <span class="stringliteral">&quot;pjsip/pubsub/%s&quot;</span>,</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a>(tps_name);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;   }</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>) {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(endpoint);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">notify_sched_id</a> = -1;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;   <span class="keywordflow">return</span> sub_tree;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a05c2af54560a8245eef9bd323c2f758b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a05c2af54560a8245eef9bd323c2f758b">subscription_tree_destructor</a></div><div class="ttdeci">static void subscription_tree_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">res_pjsip_pubsub.c:1367</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ab47623e207bf2cdd0edfa613d91894e5"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a></div><div class="ttdeci">void ast_taskprocessor_build_name(char *buf, unsigned int size, const char *format,...)</div><div class="ttdoc">Build a taskprocessor name with a sequence number on the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01295">taskprocessor.c:1295</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_adf4c5a237767eb6db5b1db41ccdfc689"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_MAX_NAME</div><div class="ttdoc">Suggested maximum taskprocessor name length (less null terminator). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00060">taskprocessor.h:60</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d5cc626722f9dee721868da7dc58a40"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">sip_subscription_tree::notify_sched_id</a></div><div class="ttdeci">int notify_sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">res_pjsip_pubsub.c:447</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gad57aa0b914fbd6adbf8ee2fe176e1fb1"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer(const char *name)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05133">res_pjsip.c:5133</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga506c31bc071963fa7ef3ed517fa0a533"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_get_distributor_serializer(pjsip_rx_data *rdata)</div><div class="ttdoc">Determine the distributor serializer for the SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">pjsip_distributor.c:448</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="module_8h_html_a8dea6491bedba471fc44574d76438577"><div class="ttname"><a href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a></div><div class="ttdeci">#define ast_module_ref(mod)</div><div class="ttdoc">Hold a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00443">module.h:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a204519f08566a8c5fb4711168cad11e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a204519f08566a8c5fb4711168cad11e3">&#9670;&nbsp;</a></span>allocate_tdata_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int allocate_tdata_buffer </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pre-allocate a buffer for the transmission. </p>
<p>Typically, we let PJSIP do this step for us when we send a request. PJSIP's buffer allocation algorithm is to allocate a buffer of PJSIP_MAX_PKT_LEN bytes and attempt to write the packet to the allocated buffer. If the buffer is too small to hold the packet, then we get told the message is too long to be sent.</p>
<p>When dealing with SIP NOTIFY, especially with RLS, it is possible to exceed PJSIP_MAX_PKT_LEN. Rather than accepting the limitation imposed on us by default, we instead take the strategy of pre-allocating the buffer, testing for ourselves if the message will fit, and resizing the buffer as required.</p>
<p>The limit we impose is double that of the maximum packet length.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tdata</td><td>The tdata onto which to allocate a buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>The message is too large </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01967">1967</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01989">sip_subscription_send_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;{</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   <span class="keywordtype">int</span> buf_size;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;   <span class="keywordtype">int</span> size = -1;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   <span class="keywordflow">for</span> (buf_size = PJSIP_MAX_PKT_LEN; size == -1 &amp;&amp; buf_size &lt; (PJSIP_MAX_PKT_LEN * 2); buf_size *= 2) {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      buf = pj_pool_alloc(tdata-&gt;pool, buf_size);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      size = pjsip_msg_print(tdata-&gt;msg, buf, buf_size);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   }</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <span class="keywordflow">if</span> (size == -1) {</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   tdata-&gt;buf.start = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   tdata-&gt;buf.cur = tdata-&gt;buf.start;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   tdata-&gt;buf.end = tdata-&gt;buf.start + buf_size;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22c56a35e1b346bd629dd4caf6a52f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22c56a35e1b346bd629dd4caf6a52f03">&#9670;&nbsp;</a></span>ami_show_resource_lists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_show_resource_lists </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04112">4112</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00034">ao2_container_count()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00123">AST_RETRIEVE_FLAG_ALL</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00120">AST_RETRIEVE_FLAG_MULTIPLE</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01897">ast_sorcery_retrieve_by_fields()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02747">ast_sip_ami::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04090">format_ami_resource_lists()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02741">ast_sip_ami::m</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02739">ast_sip_ami::s</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;{</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> ami = { .<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a> = <a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, .m = <a class="code" href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">m</a>, .action_id = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>), };</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *lists;</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   lists = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;resource_list&quot;</span>,</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;   <span class="keywordflow">if</span> (!lists || !<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(lists)) {</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No resource lists found\n&quot;</span>);</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;   }</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;A listing of resource lists follows, presented as ResourceListDetail events&quot;</span>,</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(lists, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4cf48fac09e3299c24b6f72f438c421f">format_ami_resource_lists</a>, &amp;ami);</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;ResourceListDetailComplete&quot;</span>, ami.<a class="code" href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">ast_sip_ami::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02747">res_pjsip.h:2747</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ac0506a88d121327118c7346baa303a9e"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">ast_sip_ami::m</a></div><div class="ttdeci">const struct message * m</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02741">res_pjsip.h:2741</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structast__sip__ami_html"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a></div><div class="ttdoc">AMI variable container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02737">res_pjsip.h:2737</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4cf48fac09e3299c24b6f72f438c421f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4cf48fac09e3299c24b6f72f438c421f">format_ami_resource_lists</a></div><div class="ttdeci">static int format_ami_resource_lists(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04090">res_pjsip_pubsub.c:4090</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a></div><div class="ttdoc">Perform no matching, return all objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00123">sorcery.h:123</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a></div><div class="ttdoc">Return all matching objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00120">sorcery.h:120</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="sorcery_8h_html_aaa9cd237841a70862001f580b23212c9"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_fields(const struct ast_sorcery *sorcery, const char *type, unsigned int flags, struct ast_variable *fields)</div><div class="ttdoc">Retrieve an object or multiple objects using specific fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01897">sorcery.c:1897</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a675152b3c3f0536dbb1f624fc840fba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a675152b3c3f0536dbb1f624fc840fba1">&#9670;&nbsp;</a></span>ami_show_subscriptions_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_show_subscriptions_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04062">4062</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04050">ami_subscription_detail_inbound()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02747">ast_sip_ami::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02741">ast_sip_ami::m</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02739">ast_sip_ami::s</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;{</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> ami = { .<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a> = <a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, .m = <a class="code" href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">m</a>, .action_id = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>), };</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Following are Events for each inbound Subscription&quot;</span>,</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9321a33ad3bd557f07e777bcdd6afb79">ami_subscription_detail_inbound</a>, &amp;ami);</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;InboundSubscriptionDetailComplete&quot;</span>, ami.<a class="code" href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a9321a33ad3bd557f07e777bcdd6afb79"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a9321a33ad3bd557f07e777bcdd6afb79">ami_subscription_detail_inbound</a></div><div class="ttdeci">static int ami_subscription_detail_inbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04050">res_pjsip_pubsub.c:4050</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">ast_sip_ami::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02747">res_pjsip.h:2747</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ac0506a88d121327118c7346baa303a9e"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">ast_sip_ami::m</a></div><div class="ttdeci">const struct message * m</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02741">res_pjsip.h:2741</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="structast__sip__ami_html"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a></div><div class="ttdoc">AMI variable container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02737">res_pjsip.h:2737</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53732c2137fa94234dd28ed05de1a282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53732c2137fa94234dd28ed05de1a282">&#9670;&nbsp;</a></span>ami_show_subscriptions_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_show_subscriptions_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04076">4076</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04056">ami_subscription_detail_outbound()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02747">ast_sip_ami::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02741">ast_sip_ami::m</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02739">ast_sip_ami::s</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;{</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> ami = { .<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a> = <a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, .m = <a class="code" href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">m</a>, .action_id = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>), };</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Following are Events for each outbound Subscription&quot;</span>,</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#add921b3c03175e428a304fbd820c584a">ami_subscription_detail_outbound</a>, &amp;ami);</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;OutboundSubscriptionDetailComplete&quot;</span>, ami.<a class="code" href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;}</div><div class="ttc" id="structast__sip__ami_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">ast_sip_ami::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02747">res_pjsip.h:2747</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ac0506a88d121327118c7346baa303a9e"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">ast_sip_ami::m</a></div><div class="ttdeci">const struct message * m</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02741">res_pjsip.h:2741</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="structast__sip__ami_html"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a></div><div class="ttdoc">AMI variable container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02737">res_pjsip.h:2737</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_add921b3c03175e428a304fbd820c584a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#add921b3c03175e428a304fbd820c584a">ami_subscription_detail_outbound</a></div><div class="ttdeci">static int ami_subscription_detail_outbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04056">res_pjsip_pubsub.c:4056</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98dd8da033568491b0241453b2cf34a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98dd8da033568491b0241453b2cf34a2">&#9670;&nbsp;</a></span>ami_subscription_detail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_subscription_detail </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> *&#160;</td>
          <td class="paramname"><em>ami</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">4031</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01584">ast_sip_create_ami_event()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03080">astman_append()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02747">ast_sip_ami::count</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02739">ast_sip_ami::s</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">sip_subscription_to_ami()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04050">ami_subscription_detail_inbound()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04056">ami_subscription_detail_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;{</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   buf = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>, ami);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;   }</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0461ac441d662c000ef9408ab9dd01c">sip_subscription_to_ami</a>(sub_tree, &amp;buf);</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(ami-&gt;<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;   ++ami-&gt;<a class="code" href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;}</div><div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">ast_sip_ami::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02747">res_pjsip.h:2747</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae0461ac441d662c000ef9408ab9dd01c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0461ac441d662c000ef9408ab9dd01c">sip_subscription_to_ami</a></div><div class="ttdeci">static void sip_subscription_to_ami(struct sip_subscription_tree *sub_tree, struct ast_str **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">res_pjsip_pubsub.c:1820</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5b63b1eceb879f2cf0e23f356040737a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a></div><div class="ttdeci">struct ast_str * ast_sip_create_ami_event(const char *event, struct ast_sip_ami *ami)</div><div class="ttdoc">Creates a string to store AMI event data in. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l01584">pjsip_configuration.c:1584</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9321a33ad3bd557f07e777bcdd6afb79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9321a33ad3bd557f07e777bcdd6afb79">&#9670;&nbsp;</a></span>ami_subscription_detail_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_subscription_detail_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04050">4050</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">ami_subscription_detail()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04062">ami_show_subscriptions_inbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;{</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a> ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a98dd8da033568491b0241453b2cf34a2">ami_subscription_detail</a>(</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      sub_tree, arg, <span class="stringliteral">&quot;InboundSubscriptionDetail&quot;</span>) : 0;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a98dd8da033568491b0241453b2cf34a2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a98dd8da033568491b0241453b2cf34a2">ami_subscription_detail</a></div><div class="ttdeci">static int ami_subscription_detail(struct sip_subscription_tree *sub_tree, struct ast_sip_ami *ami, const char *event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">res_pjsip_pubsub.c:4031</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add921b3c03175e428a304fbd820c584a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add921b3c03175e428a304fbd820c584a">&#9670;&nbsp;</a></span>ami_subscription_detail_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ami_subscription_detail_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04056">4056</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">ami_subscription_detail()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">AST_SIP_SUBSCRIBER</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04076">ami_show_subscriptions_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;{</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a> ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a98dd8da033568491b0241453b2cf34a2">ami_subscription_detail</a>(</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      sub_tree, arg, <span class="stringliteral">&quot;OutboundSubscriptionDetail&quot;</span>) : 0;</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a98dd8da033568491b0241453b2cf34a2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a98dd8da033568491b0241453b2cf34a2">ami_subscription_detail</a></div><div class="ttdeci">static int ami_subscription_detail(struct sip_subscription_tree *sub_tree, struct ast_sip_ami *ami, const char *event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">res_pjsip_pubsub.c:4031</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c45ac14fca8a0ed83e33e45856a5199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c45ac14fca8a0ed83e33e45856a5199">&#9670;&nbsp;</a></span>apply_list_configuration()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int apply_list_configuration </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *&#160;</td>
          <td class="paramname"><em>sorcery</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">4857</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00477">ast_sorcery_apply_default</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00955">ast_sorcery_object_field_register</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l01005">ast_sorcery_object_field_register_custom</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00838">ast_sorcery_object_register</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01442">ast_sorcery_reload_object()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00835">CHARFLDSET</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00332">resource_list::full_state</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04794">list_item_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04821">list_item_to_str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00334">resource_list::notification_batch_interval</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00294">OPT_BOOL_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00330">OPT_CHAR_ARRAY_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00399">OPT_NOOP_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00459">OPT_UINT_T</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04764">resource_list_alloc()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04838">resource_list_apply_handler()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;{</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;config&quot;</span>,</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;         <span class="stringliteral">&quot;pjsip.conf,criteria=type=resource_list&quot;</span>);</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae30488231b97f5060ccc10743e7a3a64">resource_list_alloc</a>,</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;            <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a28ad88468ddb5b0d4e26b7406133bd8a">resource_list_apply_handler</a>)) {</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;   }</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;         <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a>, 0, 0);</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;event&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;         <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a>, <a class="code" href="../../df/d7d/structevent.html">event</a>));</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;full_state&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>,</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;         <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a>, full_state));</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;notification_batch_interval&quot;</span>,</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;         <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a>, notification_batch_interval));</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>, <span class="stringliteral">&quot;list_item&quot;</span>,</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;         <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa1a6f87906d88cf1f915a7598309a3f0">list_item_handler</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa04aa9b3ab93170dc00535e2deaa5c86">list_item_to_str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(sorcery, <span class="stringliteral">&quot;resource_list&quot;</span>);</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;}</div><div class="ttc" id="config__options_8h_html_a5a18d813ca848db340644212d89aac1a"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a></div><div class="ttdeci">#define CHARFLDSET(type, field)</div><div class="ttdoc">A helper macro to pass the appropriate arguments to aco_option_register for OPT_CHAR_ARRAY_T. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00835">config_options.h:835</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a></div><div class="ttdoc">Type for a default handler that should do nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00399">config_options.h:399</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae30488231b97f5060ccc10743e7a3a64"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae30488231b97f5060ccc10743e7a3a64">resource_list_alloc</a></div><div class="ttdeci">static void * resource_list_alloc(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04764">res_pjsip_pubsub.c:4764</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a></div><div class="ttdoc">Type for default option handler for character array strings. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00330">config_options.h:330</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a></div><div class="ttdoc">Type for default option handler for unsigned integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00459">config_options.h:459</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa04aa9b3ab93170dc00535e2deaa5c86"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa04aa9b3ab93170dc00535e2deaa5c86">list_item_to_str</a></div><div class="ttdeci">static int list_item_to_str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04821">res_pjsip_pubsub.c:4821</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00294">config_options.h:294</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa1a6f87906d88cf1f915a7598309a3f0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa1a6f87906d88cf1f915a7598309a3f0">list_item_handler</a></div><div class="ttdeci">static int list_item_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04794">res_pjsip_pubsub.c:4794</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a28ad88468ddb5b0d4e26b7406133bd8a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a28ad88468ddb5b0d4e26b7406133bd8a">resource_list_apply_handler</a></div><div class="ttdeci">static int resource_list_apply_handler(const struct ast_sorcery *sorcery, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04838">res_pjsip_pubsub.c:4838</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05714">5714</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="adcc803ec5ffc0029b9be176cc090f135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc803ec5ffc0029b9be176cc090f135">&#9670;&nbsp;</a></span>ast_sip_create_subscription()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a>* ast_sip_create_subscription </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new <a class="el" href="../../db/d02/structast__sip__subscription.html" title="Structure representing a &quot;virtual&quot; SIP subscription. ">ast_sip_subscription</a> structure. </p>
<p>When a subscriber wishes to create a subscription, it may call this function to allocate resources and to send the initial SUBSCRIBE out.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscriber</td><td>The subscriber that is making the request. </td></tr>
    <tr><td class="paramname">endpoint</td><td>The endpoint to whome the SUBSCRIBE will be sent. </td></tr>
    <tr><td class="paramname">resource</td><td>The resource to place in the SUBSCRIBE's Request-URI. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">1868</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01175">add_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">allocate_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04028">ast_sip_create_dialog_uac()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00304">ast_sip_location_retrieve_contact_from_aor_list()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00549">pubsub_cb</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">subscription_setup_dialog()</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>
<div class="fragment"><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;{</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="code" href="../../d9/d03/structcontact.html">contact</a>;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   pj_str_t <a class="code" href="../../df/d7d/structevent.html">event</a>;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   pjsip_evsub *evsub;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;   sub_tree = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae855491c1f2f6714df5daa3fd69a10df">allocate_subscription_tree</a>(endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;   <span class="keywordflow">if</span> (!sub_tree) {</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;   }</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;   sub = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa70a279b186df17b611eabf8164c396c">allocate_subscription</a>(handler, resource, sub_tree);</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;   contact = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a>(endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;   <span class="keywordflow">if</span> (!contact || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>)) {</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No contacts configured for endpoint %s. Unable to create SIP subsription\n&quot;</span>,</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   }</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   dlg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a>(endpoint, contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   <span class="keywordflow">if</span> (!dlg) {</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create dialog for SIP subscription\n&quot;</span>);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   }</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   pj_cstr(&amp;event, handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;   pjsip_evsub_create_uac(dlg, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d62301cf52b6bc6d7b66cea60bee8cc">pubsub_cb</a>, &amp;event, 0, &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acc8db1e0ce416bc7a5a05275db0cb8a7">subscription_setup_dialog</a>(sub_tree, dlg);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   evsub = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   <span class="keywordflow">if</span> (pjsip_evsub_initiate(evsub, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      pjsip_evsub_send_request(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, tdata);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <span class="comment">/* pjsip_evsub_terminate will result in pubsub_on_evsub_state,</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">       * being called and terminating the subscription. Therefore, we don&#39;t</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">       * need to decrease the reference count of sub here.</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      pjsip_evsub_terminate(evsub, PJ_TRUE);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;   }</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8ebc5adf3564428c0201cff2376dd187">add_subscription</a>(sub_tree);</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a8ebc5adf3564428c0201cff2376dd187"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8ebc5adf3564428c0201cff2376dd187">add_subscription</a></div><div class="ttdeci">static void add_subscription(struct sip_subscription_tree *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01175">res_pjsip_pubsub.c:1175</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7d62301cf52b6bc6d7b66cea60bee8cc"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d62301cf52b6bc6d7b66cea60bee8cc">pubsub_cb</a></div><div class="ttdeci">static pjsip_evsub_user pubsub_cb</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00549">res_pjsip_pubsub.c:549</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a00fd98f03df089bd6aa358f941ae0dcd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a></div><div class="ttdeci">struct ast_sip_contact * ast_sip_location_retrieve_contact_from_aor_list(const char *aor_list)</div><div class="ttdoc">Retrieve the first bound contact from a list of AORs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00304">location.c:304</a></div></div>
<div class="ttc" id="structast__sip__subscription_html"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></div><div class="ttdoc">Structure representing a &quot;virtual&quot; SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00477">res_pjsip_pubsub.c:477</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acc8db1e0ce416bc7a5a05275db0cb8a7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acc8db1e0ce416bc7a5a05275db0cb8a7">subscription_setup_dialog</a></div><div class="ttdeci">static void subscription_setup_dialog(struct sip_subscription_tree *sub_tree, pjsip_dialog *dlg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">res_pjsip_pubsub.c:1396</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa70a279b186df17b611eabf8164c396c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa70a279b186df17b611eabf8164c396c">allocate_subscription</a></div><div class="ttdeci">static struct ast_sip_subscription * allocate_subscription(const struct ast_sip_subscription_handler *handler, const char *resource, struct sip_subscription_tree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">res_pjsip_pubsub.c:1233</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a681ca1bf74a943a8009a5c2ad6894831"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a></div><div class="ttdeci">pjsip_dialog * ast_sip_create_dialog_uac(const struct ast_sip_endpoint *endpoint, const char *aor_name, const char *request_user)</div><div class="ttdoc">General purpose method for creating a UAC dialog with an endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04028">res_pjsip.c:4028</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae855491c1f2f6714df5daa3fd69a10df"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae855491c1f2f6714df5daa3fd69a10df">allocate_subscription_tree</a></div><div class="ttdeci">static struct sip_subscription_tree * allocate_subscription_tree(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">res_pjsip_pubsub.c:1405</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefd01cccb44e52e8c576785903382206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefd01cccb44e52e8c576785903382206">&#9670;&nbsp;</a></span>ast_sip_publication_add_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_publication_add_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>publication</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td>
          <td class="paramname"><em>datastore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a datastore to a SIP publication. </p>
<p>Note that SIP uses reference counted datastores. The datastore passed into this function must have been allocated using <a class="el" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc()</a> or there will be serious problems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publication</td><td>The publication to add the datastore to </td></tr>
    <tr><td class="paramname">datastore</td><td>The datastore to be added to the subscription </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02649">2649</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00101">ast_datastores_add()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>.</p>
<div class="fragment"><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;{</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/db6/datastore_8h.html#a267b2996c54061f82ff1c5be72bbc731">ast_datastores_add</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, datastore);</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;}</div><div class="ttc" id="datastore_8h_html_a267b2996c54061f82ff1c5be72bbc731"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a267b2996c54061f82ff1c5be72bbc731">ast_datastores_add</a></div><div class="ttdeci">int ast_datastores_add(struct ao2_container *datastores, struct ast_datastore *datastore)</div><div class="ttdoc">Add a data store to a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00101">datastore.c:101</a></div></div>
<div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a69501f479a8ea3b0d1b6c4b8439e03c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69501f479a8ea3b0d1b6c4b8439e03c9">&#9670;&nbsp;</a></span>ast_sip_publication_get_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_publication_get_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>publication</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a publication datastore. </p>
<p>The datastore retrieved will have its reference count incremented. When the caller is done with the datastore, the reference counted needs to be decremented using <a class="el" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publication</td><td>The publication from which to retrieve the datastore </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to find the specified datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The specified datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02654">2654</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00119">ast_datastores_find()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>.</p>
<div class="fragment"><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;{</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/db6/datastore_8h.html#a3e5e18520733ba3dc58c1e218ab5541b">ast_datastores_find</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;}</div><div class="ttc" id="datastore_8h_html_a3e5e18520733ba3dc58c1e218ab5541b"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a3e5e18520733ba3dc58c1e218ab5541b">ast_datastores_find</a></div><div class="ttdeci">struct ast_datastore * ast_datastores_find(struct ao2_container *datastores, const char *name)</div><div class="ttdoc">Find a data store in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00119">datastore.c:119</a></div></div>
<div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8ca8ca978fb48dc5a57ce618b36c0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ca8ca978fb48dc5a57ce618b36c0b5">&#9670;&nbsp;</a></span>ast_sip_publication_get_datastores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* ast_sip_publication_get_datastores </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>publication</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the datastores container for a publication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publication</td><td>The publication to get the datastores container from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>datastores container not present </td></tr>
    <tr><td class="paramname">non-NULL</td><td>datastores container</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The container is NOT returned with reference count bumped</dd></dl>
<dl class="section since"><dt>Since</dt><dd>14.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02664">2664</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>.</p>
<div class="fragment"><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;{</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;   <span class="keywordflow">return</span> publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adf23ea14cf21cc35810a043bed318bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf23ea14cf21cc35810a043bed318bb6">&#9670;&nbsp;</a></span>ast_sip_publication_get_endpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* ast_sip_publication_get_endpoint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a publication, get the associated endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>The publication </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The associated endpoint </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03420">3420</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">ast_sip_publication::endpoint</a>.</p>
<div class="fragment"><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;{</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;   <span class="keywordflow">return</span> pub-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_publication::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdoc">The endpoint with which the subscription is communicating. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">res_pjsip_pubsub.c:353</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada9f3d03df5f52f4aeb09f6d952f46de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada9f3d03df5f52f4aeb09f6d952f46de">&#9670;&nbsp;</a></span>ast_sip_publication_get_event_configuration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_publication_get_event_configuration </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a publication, get the configuration name for the event type in use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>The publication </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The configuration name </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03430">3430</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00361">ast_sip_publication::event_configuration_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00594">asterisk_publication_devicestate_state_change()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00685">asterisk_publication_mwi_state_change()</a>.</p>
<div class="fragment"><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;{</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   <span class="keywordflow">return</span> pub-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">event_configuration_name</a>;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_a6aae576152b40374b43f81349aecc739"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">ast_sip_publication::event_configuration_name</a></div><div class="ttdeci">char * event_configuration_name</div><div class="ttdoc">The name of the event type configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00361">res_pjsip_pubsub.c:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1dd2ba4db4cb10f5d1813886503bd96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1dd2ba4db4cb10f5d1813886503bd96">&#9670;&nbsp;</a></span>ast_sip_publication_get_resource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_publication_get_resource </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a publication, get the resource the publication is to. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>The publication </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resource </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03425">3425</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">ast_sip_publication::resource</a>.</p>
<div class="fragment"><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;{</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;   <span class="keywordflow">return</span> pub-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">resource</a>;</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_add9403c2dd81e949c8c4aa872eabdcc7"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">ast_sip_publication::resource</a></div><div class="ttdeci">char * resource</div><div class="ttdoc">The resource the publication is to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">res_pjsip_pubsub.c:359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60c370a28e03a8dc64e6b1cf9f277194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c370a28e03a8dc64e6b1cf9f277194">&#9670;&nbsp;</a></span>ast_sip_publication_remove_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_publication_remove_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>publication</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a publication datastore from the publication. </p>
<p>This operation may cause the datastore's <a class="el" href="../../da/dfd/gsm__destroy_8c.html#aafde19f7d36ca163a143579c1b125b6d">free()</a> callback to be called if the reference count reaches zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publication</td><td>The publication to remove the datastore from </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to remove </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02659">2659</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00114">ast_datastores_remove()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>.</p>
<div class="fragment"><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;{</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;   <a class="code" href="../../d9/db6/datastore_8h.html#a126dac1c8ced6e9cf905430e88f35396">ast_datastores_remove</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="datastore_8h_html_a126dac1c8ced6e9cf905430e88f35396"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a126dac1c8ced6e9cf905430e88f35396">ast_datastores_remove</a></div><div class="ttdeci">void ast_datastores_remove(struct ao2_container *datastores, const char *name)</div><div class="ttdoc">Remove a data store from a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00114">datastore.c:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3b78cda3768f8f485e1ad46d6fcb765"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b78cda3768f8f485e1ad46d6fcb765">&#9670;&nbsp;</a></span>ast_sip_pubsub_generate_body_content()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_pubsub_generate_body_content </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>content_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>content_subtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate body content for a PUBLISH or NOTIFY. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 This function takes a pre-allocated body and calls into registered body generators in order to fill in the body with appropriate details. The primary body generator will be called first, followed by the supplementary body generators</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">content_type</td><td>The content type of the body </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">content_subtype</td><td>The content subtype of the body </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data</td><td>The data associated with body generation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">str</td><td>The string representation of the generated body </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">non-zero</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">3519</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00617">ast_sip_pubsub_body_generator::allocate_body</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00243">ast_sip_body_data::body_data</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00241">ast_sip_body_data::body_type</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00603">ast_sip_pubsub_body_generator::body_type</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00645">ast_sip_pubsub_body_generator::destroy_body</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">find_body_generator_type_subtype()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00629">ast_sip_pubsub_body_generator::generate_body_content</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00359">generator</a>, <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00666">ast_sip_pubsub_body_supplement::subtype</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00679">ast_sip_pubsub_body_supplement::supplement_body</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00636">ast_sip_pubsub_body_generator::to_string</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">ast_sip_pubsub_body_generator::type</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00661">ast_sip_pubsub_body_supplement::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">ast_sip_subscription_notify()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00619">exten_state_publisher_cb()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">generate_initial_notify()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00371">send_unsolicited_mwi_notify_to_contact()</a>.</p>
<div class="fragment"><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;{</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *supplement;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>;</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;   <span class="keywordtype">void</span> *body;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;   generator = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;   <span class="keywordflow">if</span> (!generator) {</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to find a body generator for %s/%s\n&quot;</span>,</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;            <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;   }</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;   <span class="keywordflow">if</span> (strcmp(data-&gt;<a class="code" href="../../d1/de8/structast__sip__body__data.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>)) {</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s/%s body generator does not accept the type of data provided\n&quot;</span>,</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;         <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;   }</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;   body = generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a385739136e77ae600f5bf6f00bcfebb9">allocate_body</a>(data-&gt;<a class="code" href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">body_data</a>);</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;   <span class="keywordflow">if</span> (!body) {</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s/%s body generator could not to allocate a body\n&quot;</span>,</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;         <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;   }</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;   <span class="keywordflow">if</span> (generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#ae9df1ad90af9f1ce1a581f295ef305a5">generate_body_content</a>(body, data-&gt;<a class="code" href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">body_data</a>)) {</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      res = -1;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;   }</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>, supplement, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>) {</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      <span class="keywordflow">if</span> (!strcmp(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, supplement-&gt;<a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>) &amp;&amp;</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            !strcmp(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>, supplement-&gt;<a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>)) {</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;         res = supplement-&gt;<a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a2d404fadf2a8afa26742b1cd27bd50cd">supplement_body</a>(body, data-&gt;<a class="code" href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">body_data</a>);</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;         <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;         }</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      }</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;   }</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a01fdd40c6cfdff735455dee9436346d6">to_string</a>(body, str);</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;   }</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;   <span class="keywordflow">if</span> (generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a3b12361a3bb7b12cc7729927503209cb">destroy_body</a>) {</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a3b12361a3bb7b12cc7729927503209cb">destroy_body</a>(body);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;   }</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;}</div><div class="ttc" id="structast__sip__pubsub__body__generator_html_a01fdd40c6cfdff735455dee9436346d6"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a01fdd40c6cfdff735455dee9436346d6">ast_sip_pubsub_body_generator::to_string</a></div><div class="ttdeci">void(* to_string)(void *body, struct ast_str **str)</div><div class="ttdoc">Convert the body to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00636">res_pjsip_pubsub.h:636</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_pubsub_body_generator::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00603">res_pjsip_pubsub.h:603</a></div></div>
<div class="ttc" id="structast__sip__body__data_html_a086f833f6f250c98d7bcd80f9a573d06"><div class="ttname"><a href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">ast_sip_body_data::body_data</a></div><div class="ttdeci">void * body_data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00243">res_pjsip_pubsub.h:243</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__supplement_html"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a></div><div class="ttdoc">Body supplement. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00656">res_pjsip_pubsub.h:656</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_generator::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">res_pjsip_pubsub.h:596</a></div></div>
<div class="ttc" id="structast__sip__body__data_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../d1/de8/structast__sip__body__data.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_body_data::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00241">res_pjsip_pubsub.h:241</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__supplement_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_supplement::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00661">res_pjsip_pubsub.h:661</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__supplement_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_supplement::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00666">res_pjsip_pubsub.h:666</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a385739136e77ae600f5bf6f00bcfebb9"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a385739136e77ae600f5bf6f00bcfebb9">ast_sip_pubsub_body_generator::allocate_body</a></div><div class="ttdeci">void *(* allocate_body)(void *data)</div><div class="ttdoc">allocate body structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00617">res_pjsip_pubsub.h:617</a></div></div>
<div class="ttc" id="structbody__supplements_html"><div class="ttname"><a href="../../d5/d90/structbody__supplements.html">body_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00537">res_pjsip_pubsub.c:537</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5df18a3e8742e6bd4e6917b459c4c82d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_type_subtype(const char *type, const char *subtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">res_pjsip_pubsub.c:2839</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_af820db3728fdeafb6d1c8ff284ea6cc5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator::@306 list</div></div>
<div class="ttc" id="app__fax_8c_html_a36aeb2eb01afb248bad64a309d743636"><div class="ttname"><a href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a></div><div class="ttdeci">static struct ast_generator generator</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dde/app__fax_8c_source.html#l00359">app_fax.c:359</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a3b12361a3bb7b12cc7729927503209cb"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a3b12361a3bb7b12cc7729927503209cb">ast_sip_pubsub_body_generator::destroy_body</a></div><div class="ttdeci">void(* destroy_body)(void *body)</div><div class="ttdoc">Deallocate resources created for the body. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00645">res_pjsip_pubsub.h:645</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__supplement_html_a2d404fadf2a8afa26742b1cd27bd50cd"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a2d404fadf2a8afa26742b1cd27bd50cd">ast_sip_pubsub_body_supplement::supplement_body</a></div><div class="ttdeci">int(* supplement_body)(void *body, void *data)</div><div class="ttdoc">Add additional content to a SIP request body. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00679">res_pjsip_pubsub.h:679</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_ae9df1ad90af9f1ce1a581f295ef305a5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#ae9df1ad90af9f1ce1a581f295ef305a5">ast_sip_pubsub_body_generator::generate_body_content</a></div><div class="ttdeci">int(* generate_body_content)(void *body, void *data)</div><div class="ttdoc">Add content to the body of a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00629">res_pjsip_pubsub.h:629</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa94f5c5d378799e218956c0804cbfb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa94f5c5d378799e218956c0804cbfb1e">&#9670;&nbsp;</a></span>ast_sip_pubsub_has_eventlist_support()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_sip_pubsub_has_eventlist_support </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the rdata has a Supported header containing 'eventlist'. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>rdata has an eventlist containing supported header </td></tr>
    <tr><td class="paramname">0</td><td>rdata doesn't have an eventlist containing supported header </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00866">866</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00894">while()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   pjsip_supported_hdr *supported_header = (pjsip_supported_hdr *) &amp;rdata-&gt;msg_info.msg-&gt;hdr;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a> ((supported_header = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_SUPPORTED, supported_header-&gt;next))) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; supported_header-&gt;count; i++) {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;         <span class="keywordflow">if</span> (!pj_stricmp2(&amp;supported_header-&gt;values[i], <span class="stringliteral">&quot;eventlist&quot;</span>)) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div><div class="ttc" id="ast__expr2f_8c_html_a8fdafe3be7e00ce3d4f0cb50a9a5eb39"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a></div><div class="ttdeci">while(1)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00894">ast_expr2f.c:894</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0030d8d5c2b988a0f7e7968a66180dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0030d8d5c2b988a0f7e7968a66180dd">&#9670;&nbsp;</a></span>ast_sip_pubsub_is_body_generator_registered()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_pubsub_is_body_generator_registered </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is a body generator registered for the given type/subtype. </p>
<dl class="section since"><dt>Since</dt><dd>14.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The content type of the body </td></tr>
    <tr><td class="paramname">subtype</td><td>The content subtype of the body</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>In "plain/text", "plain" is the type and "text" is the subtype.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-zero</td><td>if a generator is registered. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03435">3435</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">find_body_generator_type_subtype()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00837">publisher_start()</a>.</p>
<div class="fragment"><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;{</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   <span class="keywordflow">return</span> !!<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5df18a3e8742e6bd4e6917b459c4c82d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_type_subtype(const char *type, const char *subtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">res_pjsip_pubsub.c:2839</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d089a744841fa628f7dc8f09d70db04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d089a744841fa628f7dc8f09d70db04">&#9670;&nbsp;</a></span>ast_sip_pubsub_register_body_generator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_pubsub_register_body_generator </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td>
          <td class="paramname"><em>generator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a body generator with the pubsub core. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 This may fail if an attempt is made to register a primary body supplement for a given content type if a primary body supplement for that content type has already been registered.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">generator</td><td>Body generator to register </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03440">3440</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00710">AST_LIST_INSERT_HEAD</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02825">find_body_generator_type_subtype_nolock()</a>, <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">ast_sip_pubsub_body_generator::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00312">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;{</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *existing;</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   pj_str_t accept;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;   pj_size_t accept_len;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;   existing = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3d0a8fc757c1fb1e064887580d4ba1ea">find_body_generator_type_subtype_nolock</a>(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;   <span class="keywordflow">if</span> (existing) {</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;A body generator for %s/%s is already registered.\n&quot;</span>,</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;         generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   }</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>, generator, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>);</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;   <span class="comment">/* Lengths of type and subtype plus a slash. */</span></div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;   accept_len = strlen(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>) + strlen(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>) + 1;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;   <span class="comment">/* Add room for null terminator that sprintf() will set. */</span></div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;   pj_strset(&amp;accept, <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(accept_len + 1), accept_len);</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   sprintf((<span class="keywordtype">char</span> *) pj_strbuf(&amp;accept), <span class="stringliteral">&quot;%s/%s&quot;</span>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);<span class="comment">/* Safe */</span></div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;   pjsip_endpt_add_capability(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>,</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;         PJSIP_H_ACCEPT, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, &amp;accept);</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a3d0a8fc757c1fb1e064887580d4ba1ea"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3d0a8fc757c1fb1e064887580d4ba1ea">find_body_generator_type_subtype_nolock</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_type_subtype_nolock(const char *type, const char *subtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02825">res_pjsip_pubsub.c:2825</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_generator::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">res_pjsip_pubsub.h:596</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structbody__generators_html"><div class="ttname"><a href="../../dd/de0/structbody__generators.html">body_generators</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00536">res_pjsip_pubsub.c:536</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_af820db3728fdeafb6d1c8ff284ea6cc5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator::@306 list</div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa2ded2af046bb513f77056c27c083307"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_LIST_INSERT_HEAD(head, elm, field)</div><div class="ttdoc">Inserts a list entry at the head of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00710">linkedlists.h:710</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cc1e17b0488075e8ea7d40085d502e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cc1e17b0488075e8ea7d40085d502e1">&#9670;&nbsp;</a></span>ast_sip_pubsub_register_body_supplement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_pubsub_register_body_supplement </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *&#160;</td>
          <td class="paramname"><em>supplement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a body generator with the pubsub core. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 This may fail if an attempt is made to register a primary body supplement for a given content type if a primary body supplement for that content type has already been registered.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">generator</td><td>Body generator to register </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03485">3485</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00740">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d45/res__pjsip__pidf__digium__body__supplement_8c_source.html#l00098">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;{</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>, supplement, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structbody__supplements_html"><div class="ttname"><a href="../../d5/d90/structbody__supplements.html">body_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00537">res_pjsip_pubsub.c:537</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_af820db3728fdeafb6d1c8ff284ea6cc5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator::@306 list</div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22d7c1042170155672514fbb16ce46eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d7c1042170155672514fbb16ce46eb">&#9670;&nbsp;</a></span>ast_sip_pubsub_unregister_body_generator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_pubsub_unregister_body_generator </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td>
          <td class="paramname"><em>generator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a body generator with the pubsub core. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">generator</td><td>Body generator to unregister </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03470">3470</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00321">unload_module()</a>, and <a class="el" href="../../de/d6f/res__pjsip__xpidf__body__generator_8c_source.html#l00143">unregister_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;{</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *iter;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>, iter, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>) {</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;      <span class="keywordflow">if</span> (iter == generator) {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>);</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      }</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;   }</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;}</div><div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structbody__generators_html"><div class="ttname"><a href="../../dd/de0/structbody__generators.html">body_generators</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00536">res_pjsip_pubsub.c:536</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_af820db3728fdeafb6d1c8ff284ea6cc5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator::@306 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2be73952bf96122adf824dbbc26caa1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be73952bf96122adf824dbbc26caa1c">&#9670;&nbsp;</a></span>ast_sip_pubsub_unregister_body_supplement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_pubsub_unregister_body_supplement </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *&#160;</td>
          <td class="paramname"><em>supplement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a body generator with the pubsub core. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">generator</td><td>Body generator to unregister </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03494">3494</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a50233821a9d3db6ae3c8b16d85bffe86">ast_sip_pubsub_body_supplement::list</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d45/res__pjsip__pidf__digium__body__supplement_8c_source.html#l00106">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;{</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a> *iter;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>, iter, <a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a50233821a9d3db6ae3c8b16d85bffe86">list</a>) {</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;      <span class="keywordflow">if</span> (iter == supplement) {</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a50233821a9d3db6ae3c8b16d85bffe86">list</a>);</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      }</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;   }</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d90/structbody__supplements.html">body_supplements</a>);</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;}</div><div class="ttc" id="structast__sip__pubsub__body__supplement_html"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html">ast_sip_pubsub_body_supplement</a></div><div class="ttdoc">Body supplement. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00656">res_pjsip_pubsub.h:656</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structbody__supplements_html"><div class="ttname"><a href="../../d5/d90/structbody__supplements.html">body_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00537">res_pjsip_pubsub.c:537</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__supplement_html_a50233821a9d3db6ae3c8b16d85bffe86"><div class="ttname"><a href="../../d7/d72/structast__sip__pubsub__body__supplement.html#a50233821a9d3db6ae3c8b16d85bffe86">ast_sip_pubsub_body_supplement::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_supplement::@307 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14d30548053458724404f5c041483cfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d30548053458724404f5c041483cfa">&#9670;&nbsp;</a></span>ast_sip_register_publish_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_register_publish_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a publish handler. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Handler was registered successfully </td></tr>
    <tr><td class="paramname">non-zero</td><td>Handler was not registered successfully </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">2718</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">ast_sip_publish_handler::event_name</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02701">publication_cmp_fn()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02693">publication_hash_fn()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">ast_sip_publish_handler::publications</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00244">PUBLICATIONS_BUCKETS</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02711">publish_add_handler()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;{</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>)) {</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No event package specified for publish handler. Cannot register\n&quot;</span>);</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;   }</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b2ea661eb5491432e647c3070aa78a7">PUBLICATIONS_BUCKETS</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a267cc6529937f4689c804fb39976a823">publication_hash_fn</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a34bc405d2cc3c85aa8d449185c3569d6">publication_cmp_fn</a>);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   <span class="keywordflow">if</span> (!handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a>) {</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not allocate publications container for event &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;         handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;   }</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adb6d5815066f000bab8aa2aa43611f6c">publish_add_handler</a>(handler);</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;}</div><div class="ttc" id="structast__sip__publish__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_publish_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdoc">The name of the event this handler deals with. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">res_pjsip_pubsub.h:51</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7b2ea661eb5491432e647c3070aa78a7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b2ea661eb5491432e647c3070aa78a7">PUBLICATIONS_BUCKETS</a></div><div class="ttdeci">#define PUBLICATIONS_BUCKETS</div><div class="ttdoc">Number of buckets for publications (on a per handler) </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00244">res_pjsip_pubsub.c:244</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_adb6d5815066f000bab8aa2aa43611f6c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#adb6d5815066f000bab8aa2aa43611f6c">publish_add_handler</a></div><div class="ttdeci">static void publish_add_handler(struct ast_sip_publish_handler *handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02711">res_pjsip_pubsub.c:2711</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a267cc6529937f4689c804fb39976a823"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a267cc6529937f4689c804fb39976a823">publication_hash_fn</a></div><div class="ttdeci">static int publication_hash_fn(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02693">res_pjsip_pubsub.c:2693</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a34bc405d2cc3c85aa8d449185c3569d6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a34bc405d2cc3c85aa8d449185c3569d6">publication_cmp_fn</a></div><div class="ttdeci">static int publication_cmp_fn(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02701">res_pjsip_pubsub.c:2701</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_aac80748c488a3724f6ab7e1ef4b73530"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">ast_sip_publish_handler::publications</a></div><div class="ttdeci">struct ao2_container * publications</div><div class="ttdoc">Publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">res_pjsip_pubsub.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a250d91ea4fba33dd520804c8a47e795a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250d91ea4fba33dd520804c8a47e795a">&#9670;&nbsp;</a></span>ast_sip_register_subscription_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_register_subscription_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a subscription handler. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Handler was registered successfully </td></tr>
    <tr><td class="paramname">non-zero</td><td>Handler was not registered successfully </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02777">2777</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00320">ast_sip_subscription_handler::accept</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00219">AST_SIP_MAX_ACCEPT</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00253">DEFAULT_EXPIRES</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">find_sub_handler_for_event_name()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02756">sub_add_handler()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00960">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;{</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;   pj_str_t <a class="code" href="../../df/d7d/structevent.html">event</a>;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;   pj_str_t accept[<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a>] = { {0, }, };</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *existing;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;   <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>)) {</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No event package specified for subscription handler. Cannot register\n&quot;</span>);</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;   }</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;   existing = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a219baab2a37a17e4922d696be2e07cca">find_sub_handler_for_event_name</a>(handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;   <span class="keywordflow">if</span> (existing) {</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;         <span class="stringliteral">&quot;Unable to register subscription handler for event %s.  A handler is already registered\n&quot;</span>,</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;         handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   }</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a> &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a37cb3e0e7b0966a69f790d8d182d8cd0">accept</a>[i]); ++i) {</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      pj_cstr(&amp;accept[i], handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a37cb3e0e7b0966a69f790d8d182d8cd0">accept</a>[i]);</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;   }</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   pj_cstr(&amp;event, handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;   pjsip_evsub_register_pkg(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>, &amp;event, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#afc353f33f479f252b0cea51d55afc7ca">DEFAULT_EXPIRES</a>, i, accept);</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7fa8f8f5e7bf978b9bc6c710d3b3e437">sub_add_handler</a>(handler);</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a37cb3e0e7b0966a69f790d8d182d8cd0"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a37cb3e0e7b0966a69f790d8d182d8cd0">ast_sip_subscription_handler::accept</a></div><div class="ttdeci">const char * accept[AST_SIP_MAX_ACCEPT]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00320">res_pjsip_pubsub.h:320</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_afc353f33f479f252b0cea51d55afc7ca"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#afc353f33f479f252b0cea51d55afc7ca">DEFAULT_EXPIRES</a></div><div class="ttdeci">#define DEFAULT_EXPIRES</div><div class="ttdoc">Default expiration for subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00253">res_pjsip_pubsub.c:253</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7fa8f8f5e7bf978b9bc6c710d3b3e437"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7fa8f8f5e7bf978b9bc6c710d3b3e437">sub_add_handler</a></div><div class="ttdeci">static void sub_add_handler(struct ast_sip_subscription_handler *handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02756">res_pjsip_pubsub.c:2756</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a1521854cc25592b7f8a58a4bed55ac6d"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a></div><div class="ttdeci">#define AST_SIP_MAX_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00219">res_pjsip_pubsub.h:219</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a219baab2a37a17e4922d696be2e07cca"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a219baab2a37a17e4922d696be2e07cca">find_sub_handler_for_event_name</a></div><div class="ttdeci">static struct ast_sip_subscription_handler * find_sub_handler_for_event_name(const char *event_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">res_pjsip_pubsub.c:2763</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a68314dedb48b2799a693d3a090ae038b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68314dedb48b2799a693d3a090ae038b">&#9670;&nbsp;</a></span>ast_sip_subscription_add_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_subscription_add_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td>
          <td class="paramname"><em>datastore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a datastore to a SIP subscription. </p>
<p>Note that SIP uses reference counted datastores. The datastore passed into this function must have been allocated using <a class="el" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc()</a> or there will be serious problems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The ssubscription to add the datastore to </td></tr>
    <tr><td class="paramname">datastore</td><td>The datastore to be added to the subscription </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02629">2629</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00101">ast_datastores_add()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00369">add_datastore()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00640">add_mwi_datastore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;{</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/db6/datastore_8h.html#a267b2996c54061f82ff1c5be72bbc731">ast_datastores_add</a>(subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, datastore);</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;}</div><div class="ttc" id="datastore_8h_html_a267b2996c54061f82ff1c5be72bbc731"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a267b2996c54061f82ff1c5be72bbc731">ast_datastores_add</a></div><div class="ttdeci">int ast_datastores_add(struct ao2_container *datastores, struct ast_datastore *datastore)</div><div class="ttdoc">Add a data store to a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00101">datastore.c:101</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d3ad3f5c55c026e22e1103686227ae0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d3ad3f5c55c026e22e1103686227ae0">&#9670;&nbsp;</a></span>ast_sip_subscription_alloc_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_subscription_alloc_datastore </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> </p>
<p>There are two major differences between this and <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> 1) This allocates a refcounted object 2) This will fill in a uid if one is not provided</p>
<p>DO NOT call <a class="el" href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14" title="Free a data store object. ">ast_datastore_free()</a> on a datastore allocated in this way since that function will attempt to free the datastore rather than play nicely with its refcount.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>Callbacks for datastore </td></tr>
    <tr><td class="paramname">uid</td><td>Identifier for datastore </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to allocate datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly allocated datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02624">2624</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00138">ast_datastores_alloc_datastore()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00369">add_datastore()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00640">add_mwi_datastore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;{</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/db6/datastore_8h.html#a65b31a9e32e3dad540c98ed2ee36e828">ast_datastores_alloc_datastore</a>(info, uid);</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;}</div><div class="ttc" id="datastore_8h_html_a65b31a9e32e3dad540c98ed2ee36e828"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a65b31a9e32e3dad540c98ed2ee36e828">ast_datastores_alloc_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_datastores_alloc_datastore(const struct ast_datastore_info *info, const char *uid)</div><div class="ttdoc">Allocate a datastore for use with the datastores container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00138">datastore.c:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bb393c5880be9a3a3ddeccfc998452b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bb393c5880be9a3a3ddeccfc998452b">&#9670;&nbsp;</a></span>ast_sip_subscription_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_subscription_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alert the pubsub core that the subscription is ready for destruction. </p>
<dl class="section since"><dt>Since</dt><dd>13.6.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription that is complete </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01389">1389</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00170">exten_state_subscription_destructor()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00219">mwi_subscription_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;{</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Removing subscription %p &#39;%s-&gt;%s&#39; reference to subscription tree %p\n&quot;</span>,</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      sub, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>), sub-&gt;resource, sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c54dc5f481da88392b1ec7149385613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c54dc5f481da88392b1ec7149385613">&#9670;&nbsp;</a></span>ast_sip_subscription_get_body_subtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_subscription_get_body_subtype </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the body subtype used for this subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">3514</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">ast_sip_subscription::body_generator</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">ast_sip_subscription_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">generate_initial_notify()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;{</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">body_generator</a>-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>;</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a4b57472ac293cbff3de8eb58471771f0"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">ast_sip_subscription::body_generator</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator * body_generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">res_pjsip_pubsub.c:485</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2294ee18e05ee676e083133058243909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2294ee18e05ee676e083133058243909">&#9670;&nbsp;</a></span>ast_sip_subscription_get_body_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_subscription_get_body_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the body type used for this subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">3509</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">ast_sip_subscription::body_generator</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">ast_sip_pubsub_body_generator::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">ast_sip_subscription_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">generate_initial_notify()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;{</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">body_generator</a>-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>;</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;}</div><div class="ttc" id="structast__sip__pubsub__body__generator_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_generator::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">res_pjsip_pubsub.h:596</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4b57472ac293cbff3de8eb58471771f0"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">ast_sip_subscription::body_generator</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator * body_generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">res_pjsip_pubsub.c:485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ad2231cd4e17cd5a713f0c7cea20da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ad2231cd4e17cd5a713f0c7cea20da4">&#9670;&nbsp;</a></span>ast_sip_subscription_get_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_subscription_get_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a subscription datastore. </p>
<p>The datastore retrieved will have its reference count incremented. When the caller is done with the datastore, the reference counted needs to be decremented using <a class="el" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The subscription from which to retrieve the datastore </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to find the specified datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The specified datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02634">2634</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00119">ast_datastores_find()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00389">get_exten_state_sub()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01042">mwi_get_notify_data()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00587">mwi_subscription_shutdown()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01097">mwi_to_ami()</a>.</p>
<div class="fragment"><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;{</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/db6/datastore_8h.html#a3e5e18520733ba3dc58c1e218ab5541b">ast_datastores_find</a>(subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;}</div><div class="ttc" id="datastore_8h_html_a3e5e18520733ba3dc58c1e218ab5541b"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a3e5e18520733ba3dc58c1e218ab5541b">ast_datastores_find</a></div><div class="ttdeci">struct ast_datastore * ast_datastores_find(struct ao2_container *datastores, const char *name)</div><div class="ttdoc">Find a data store in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00119">datastore.c:119</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd22eade3d3a1bfce2d9acf505d34b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd22eade3d3a1bfce2d9acf505d34b1a">&#9670;&nbsp;</a></span>ast_sip_subscription_get_datastores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* ast_sip_subscription_get_datastores </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the datastores container for a subscription. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The subscription to get the datastores container from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>datastores container not present </td></tr>
    <tr><td class="paramname">non-NULL</td><td>datastores container</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The container is NOT returned with reference count bumped</dd></dl>
<dl class="section since"><dt>Since</dt><dd>14.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02644">2644</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00251">alloc_notify_task_data()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00482">exten_state_data_alloc()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00288">notify_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;{</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;   <span class="keywordflow">return</span> subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6471e6d6f4563ef5fb93343180fea40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6471e6d6f4563ef5fb93343180fea40">&#9670;&nbsp;</a></span>ast_sip_subscription_get_dialog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_dialog* ast_sip_subscription_get_dialog </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the pjsip dialog that is associated with this subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Could not get dialog </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The dialog </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01930">1930</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00093">dialog_info_generate_body_content()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01042">mwi_get_notify_data()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00538">send_mwi_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;{</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abce1c0cc1320bb801480d0929266d08f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abce1c0cc1320bb801480d0929266d08f">&#9670;&nbsp;</a></span>ast_sip_subscription_get_endpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* ast_sip_subscription_get_endpoint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the endpoint that is associated with this subscription. </p>
<p>This function will increase the reference count of the endpoint. Be sure to release the reference to it when you are finished with the endpoint.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Could not get endpoint </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The endpoint </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01936">1936</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00093">dialog_info_generate_body_content()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01042">mwi_get_notify_data()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01005">mwi_subscription_established()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00538">send_mwi_notify()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00427">subscription_established()</a>.</p>
<div class="fragment"><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;{</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4034b13c08bafa4bff82854bcc0ce135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4034b13c08bafa4bff82854bcc0ce135">&#9670;&nbsp;</a></span>ast_sip_subscription_get_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ast_sip_subscription_get_header </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>header</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a header value for a subscription. </p>
<p>For notifiers, the headers of the inbound SUBSCRIBE that started the dialog are stored on the subscription. This method allows access to the header. The return is the same as pjsip_msg_find_hdr_by_name(), meaning that it is dependent on the header being searched for.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription to search in. </td></tr>
    <tr><td class="paramname">header</td><td>The name of the header to search for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The discovered header, or NULL if the header cannot be found. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01854">1854</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02638">ast_sip_mod_data_get</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00236">MOD_DATA_MSG</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00179">get_user_agent()</a>.</p>
<div class="fragment"><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;{</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   pjsip_msg *msg;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   pj_str_t <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;   dlg = sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   msg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a>(dlg-&gt;mod_data, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab95c1bf11412f8e2a82ddd0eb69ad4a4">MOD_DATA_MSG</a>);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   pj_cstr(&amp;name, <a class="code" href="../../d5/d65/structheader.html">header</a>);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   <span class="keywordflow">return</span> pjsip_msg_find_hdr_by_name(msg, &amp;name, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aad194ead974937834375b0ac8d37a7c2"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a></div><div class="ttdeci">#define ast_sip_mod_data_get(mod_data, id, key)</div><div class="ttdoc">Using the dictionary stored in mod_data array at a given id, retrieve the value associated with the g...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02638">res_pjsip.h:2638</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structheader_html"><div class="ttname"><a href="../../d5/d65/structheader.html">header</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d73/pjsip__global__headers_8c_source.html#l00047">pjsip_global_headers.c:47</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab95c1bf11412f8e2a82ddd0eb69ad4a4"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab95c1bf11412f8e2a82ddd0eb69ad4a4">MOD_DATA_MSG</a></div><div class="ttdeci">#define MOD_DATA_MSG</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00236">res_pjsip_pubsub.c:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb411f16e0fee4036a22b354164b43a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb411f16e0fee4036a22b354164b43a6">&#9670;&nbsp;</a></span>ast_sip_subscription_get_local_uri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_subscription_get_local_uri </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the local URI for this subscription. </p>
<p>This is the local URI of the subscribed resource.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sub</td><td>The subscription </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>The buffer into which to store the URI. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">size</td><td>The size of the buffer. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02578">2578</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00482">exten_state_data_alloc()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00288">notify_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;{</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   pjsip_uri_print(PJSIP_URI_IN_CONTACT_HDR, sub-&gt;uri, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac14c963f858de2e8b9bcd86c1a127b2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14c963f858de2e8b9bcd86c1a127b2d">&#9670;&nbsp;</a></span>ast_sip_subscription_get_persistence_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* ast_sip_subscription_get_persistence_data </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve persistence data for a subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.31.0 </dd>
<dd>
16.8.0 </dd>
<dd>
17.2.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The subscription to retrieve persistence data from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02686">2686</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00093">dialog_info_generate_body_content()</a>.</p>
<div class="fragment"><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;{</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   <span class="keywordflow">return</span> subscription-&gt;persistence_data;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a0cb53b1ca63b4b97b4b3fa8721274ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb53b1ca63b4b97b4b3fa8721274ee9">&#9670;&nbsp;</a></span>ast_sip_subscription_get_remote_uri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_subscription_get_remote_uri </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrive the remote URI for this subscription. </p>
<p>This is the remote URI as determined by the underlying SIP dialog.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sub</td><td>The subscription </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>The buffer into which to store the URI. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">size</td><td>The size of the buffer. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02583">2583</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00482">exten_state_data_alloc()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00288">notify_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;{</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;   pjsip_sip_uri *uri;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   dlg = sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;   uri = pjsip_uri_get_uri(dlg-&gt;remote.info-&gt;uri);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;   <span class="keywordflow">if</span> (pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, uri, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size) &lt; 0) {</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;   }</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d7ed3f8785ad9d9aa3fc090d983c45d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d7ed3f8785ad9d9aa3fc090d983c45d">&#9670;&nbsp;</a></span>ast_sip_subscription_get_resource_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_subscription_get_resource_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of the subscribed resource. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02596">2596</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01042">mwi_get_notify_data()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01005">mwi_subscription_established()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01182">remove_subscription()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00538">send_mwi_notify()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00427">subscription_established()</a>.</p>
<div class="fragment"><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;{</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   <span class="keywordflow">return</span> sub-&gt;resource;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a81489602b194ea87cae6470409bee3b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81489602b194ea87cae6470409bee3b5">&#9670;&nbsp;</a></span>ast_sip_subscription_get_serializer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_sip_subscription_get_serializer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the serializer for the subscription. </p>
<p>Tasks that originate outside of a SIP servant thread should get the serializer and push the task to the serializer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The subscription's serializer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01942">1942</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00210">exten_state_subscription_alloc()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01142">send_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;{</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79792c0d3a54f779754479075e3c80b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79792c0d3a54f779754479075e3c80b3">&#9670;&nbsp;</a></span>ast_sip_subscription_get_sip_uri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_sip_uri* ast_sip_subscription_get_sip_uri </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the local sip uri for this subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<p>This is the local sip URI of the subscribed resource.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Could not get uri </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The local pjsip_sip_uri </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02573">2573</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01042">mwi_get_notify_data()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00538">send_mwi_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;{</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;   <span class="keywordflow">return</span> sub-&gt;uri;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ae741d1ec08fd26b810d24514e510dad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae741d1ec08fd26b810d24514e510dad8">&#9670;&nbsp;</a></span>ast_sip_subscription_is_terminated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_subscription_is_terminated </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get whether the subscription has been terminated or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>not terminated. </td></tr>
    <tr><td class="paramname">1</td><td>terminated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.4.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02601">2601</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00288">notify_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;{</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   <span class="keywordflow">return</span> sub-&gt;subscription_state == PJSIP_EVSUB_STATE_TERMINATED ? 1 : 0;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a5b0f67be0ca6ad54e4eba8d4aa029faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0f67be0ca6ad54e4eba8d4aa029faf">&#9670;&nbsp;</a></span>ast_sip_subscription_notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_subscription_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a> *&#160;</td>
          <td class="paramname"><em>notify_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>terminate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notify a SIP subscription of a state change. </p>
<p>This tells the pubsub core that the state of a subscribed resource has changed. The pubsub core will generate an appropriate NOTIFY request to send to the subscriber.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>The subscription on which a state change is occurring. </td></tr>
    <tr><td class="paramname"><a class="el" href="../../d4/d18/structnotify__data.html">notify_data</a></td><td>Event package-specific data used to create the NOTIFY body. </td></tr>
    <tr><td class="paramname">terminate</td><td>True if this NOTIFY is intended to terminate the subscription. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">non-zero</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">2529</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">ast_sip_pubsub_generate_body_content()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">ast_sip_subscription_get_body_subtype()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">ast_sip_subscription_get_body_type()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">sip_subscription_tree::notification_batch_interval</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02512">schedule_notification()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">SIP_SUB_TREE_NORMAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">SIP_SUB_TREE_TERMINATE_PENDING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00288">notify_task()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00538">send_mwi_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;{</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   pjsip_dialog *dlg = sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;   pjsip_dlg_inc_lock(dlg);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> != <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>) {</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   }</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa3b78cda3768f8f485e1ad46d6fcb765">ast_sip_pubsub_generate_body_content</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a>(sub),</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a>(sub), notify_data, &amp;sub-&gt;body_text)) {</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   }</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;   sub-&gt;body_changed = 1;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   <span class="keywordflow">if</span> (terminate) {</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      sub-&gt;subscription_state = PJSIP_EVSUB_STATE_TERMINATED;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   }</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">notification_batch_interval</a>) {</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      res = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a312601e694a9ca811601375d4e33d8df">schedule_notification</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>);</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <span class="comment">/* See the note in pubsub_on_rx_refresh() for why sub-&gt;tree is refbumped here */</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>, +1);</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      <span class="keywordflow">if</span> (terminate) {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;         sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      }</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      res = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>, 0);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(terminate ? <span class="stringliteral">&quot;SUBSCRIPTION_TERMINATED&quot;</span> : <span class="stringliteral">&quot;SUBSCRIPTION_STATE_CHANGED&quot;</span>,</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;            <span class="stringliteral">&quot;Resource: %s&quot;</span>,</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource);</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>, -1);</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;   }</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">res_pjsip_pubsub.c:406</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a312601e694a9ca811601375d4e33d8df"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a312601e694a9ca811601375d4e33d8df">schedule_notification</a></div><div class="ttdeci">static int schedule_notification(struct sip_subscription_tree *sub_tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02512">res_pjsip_pubsub.c:2512</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5c54dc5f481da88392b1ec7149385613"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_subtype(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body subtype used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">res_pjsip_pubsub.c:3514</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa3b78cda3768f8f485e1ad46d6fcb765"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa3b78cda3768f8f485e1ad46d6fcb765">ast_sip_pubsub_generate_body_content</a></div><div class="ttdeci">int ast_sip_pubsub_generate_body_content(const char *type, const char *subtype, struct ast_sip_body_data *data, struct ast_str **str)</div><div class="ttdoc">Generate body content for a PUBLISH or NOTIFY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">res_pjsip_pubsub.c:3519</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2294ee18e05ee676e083133058243909"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_type(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body type used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">res_pjsip_pubsub.c:3509</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8b3391cb48972f432118c4ca2eeb3063"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a></div><div class="ttdeci">static int send_notify(struct sip_subscription_tree *sub_tree, unsigned int force_full_state)</div><div class="ttdoc">Send a NOTIFY request to a subscriber. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">res_pjsip_pubsub.c:2425</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac90516981222dda0270465a33483f2b4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">sip_subscription_tree::notification_batch_interval</a></div><div class="ttdeci">unsigned int notification_batch_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">res_pjsip_pubsub.c:445</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">res_pjsip_pubsub.c:408</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c257396060f400b0fba424730e7576e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c257396060f400b0fba424730e7576e">&#9670;&nbsp;</a></span>ast_sip_subscription_remove_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_subscription_remove_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a subscription datastore from the subscription. </p>
<p>This operation may cause the datastore's <a class="el" href="../../da/dfd/gsm__destroy_8c.html#aafde19f7d36ca163a143579c1b125b6d">free()</a> callback to be called if the reference count reaches zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The subscription to remove the datastore from </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to remove </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02639">2639</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00114">ast_datastores_remove()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01005">mwi_subscription_established()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00587">mwi_subscription_shutdown()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00398">subscription_shutdown()</a>.</p>
<div class="fragment"><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;{</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;   <a class="code" href="../../d9/db6/datastore_8h.html#a126dac1c8ced6e9cf905430e88f35396">ast_datastores_remove</a>(subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="datastore_8h_html_a126dac1c8ced6e9cf905430e88f35396"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a126dac1c8ced6e9cf905430e88f35396">ast_datastores_remove</a></div><div class="ttdeci">void ast_datastores_remove(struct ao2_container *datastores, const char *name)</div><div class="ttdoc">Remove a data store from a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00114">datastore.c:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a823b9711e5de08ec19a03f1994c11b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a823b9711e5de08ec19a03f1994c11b30">&#9670;&nbsp;</a></span>ast_sip_subscription_set_persistence_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_subscription_set_persistence_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>persistence_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set persistence data for a subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.31.0 </dd>
<dd>
16.8.0 </dd>
<dd>
17.2.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>The subscription to set persistence data on </td></tr>
    <tr><td class="paramname">persistence_data</td><td>The persistence data to set</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This steals the reference to persistence_data </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02669">2669</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d98/json_8c_source.html#l00389">ast_json_object_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">subscription_persistence::generator_data</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d81/res__pjsip__dialog__info__body__generator_8c_source.html#l00093">dialog_info_generate_body_content()</a>.</p>
<div class="fragment"><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;{</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(subscription-&gt;persistence_data);</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;   subscription-&gt;persistence_data = persistence_data;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;   <span class="keywordflow">if</span> (subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>) {</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <span class="keywordflow">if</span> (!subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>) {</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;         subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a> = <a class="code" href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a>();</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;         <span class="keywordflow">if</span> (!subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>) {</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;         }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      }</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(subscription-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>, subscription-&gt;resource,</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(persistence_data));</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   }</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="json_8h_html_a5892d6cd943e00556180fcf15d30788e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a></div><div class="ttdeci">struct ast_json * ast_json_object_create(void)</div><div class="ttdoc">Create a new JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00389">json.c:389</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a1805e05b0976bcd4f821f92c0206cba0"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">subscription_persistence::generator_data</a></div><div class="ttdeci">struct ast_json * generator_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">res_pjsip_pubsub.c:398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a65b342a28c864a472dfff5ea27de8691"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b342a28c864a472dfff5ea27de8691">&#9670;&nbsp;</a></span>ast_sip_unregister_publish_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_unregister_publish_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a publish handler. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02738">2738</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00569">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00090">ast_sip_publish_handler::next</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">ast_sip_publish_handler::publications</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00925">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;{</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *iter;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>, iter, <a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#a6ad12c15b9231aec95e53a632ff79a56">next</a>) {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="keywordflow">if</span> (handler == iter) {</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#a6ad12c15b9231aec95e53a632ff79a56">next</a>);</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a>);</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      }</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   }</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structpublish__handlers_html"><div class="ttname"><a href="../../df/d3c/structpublish__handlers.html">publish_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02691">res_pjsip_pubsub.c:2691</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_a6ad12c15b9231aec95e53a632ff79a56"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#a6ad12c15b9231aec95e53a632ff79a56">ast_sip_publish_handler::next</a></div><div class="ttdeci">struct ast_sip_publish_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00090">res_pjsip_pubsub.h:90</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a></div><div class="ttdoc">Callbacks that publication handlers will define. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00049">res_pjsip_pubsub.h:49</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_aac80748c488a3724f6ab7e1ef4b73530"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">ast_sip_publish_handler::publications</a></div><div class="ttdeci">struct ao2_container * publications</div><div class="ttdoc">Publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">res_pjsip_pubsub.h:54</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16d299943a24f9857d3e847b83073d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d299943a24f9857d3e847b83073d5d">&#9670;&nbsp;</a></span>ast_sip_unregister_subscription_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_unregister_subscription_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a subscription handler. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02810">2810</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00569">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00340">ast_sip_subscription_handler::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00942">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;{</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *iter;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>, iter, <a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a2e4aa60e677c95983d44693bd69bc1be">next</a>) {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="keywordflow">if</span> (handler == iter) {</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a2e4aa60e677c95983d44693bd69bc1be">next</a>);</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      }</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   }</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;}</div><div class="ttc" id="structsubscription__handlers_html"><div class="ttname"><a href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02754">res_pjsip_pubsub.c:2754</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a2e4aa60e677c95983d44693bd69bc1be"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a2e4aa60e677c95983d44693bd69bc1be">ast_sip_subscription_handler::next</a></div><div class="ttdeci">struct ast_sip_subscription_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00340">res_pjsip_pubsub.h:340</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a354490007a46ab4f8bebe7d7211bf57c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a354490007a46ab4f8bebe7d7211bf57c">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[1/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">5078</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">check_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;{</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources[] = {</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;   };</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resource_tree&quot;</span>;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Basic resource tree integrity check&quot;</span>;</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;         <span class="stringliteral">&quot;Create a resource list and ensure that our attempt to build a tree works as expected.&quot;</span>;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;   }</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;   }</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;   list = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources));</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;   }</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;   }</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;   }</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, tree-&gt;root, resources, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources))) {</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;   }</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2a6654da48a7765b0c5957be5c282ea6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a></div><div class="ttdeci">static int check_node(struct ast_test *test, struct tree_node *node, const char **resources, size_t num_resources)</div><div class="ttdoc">Check the integrity of a tree node against a set of resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">res_pjsip_pubsub.c:5022</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a4d24c551721c2fe38c64fbfd48de79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4d24c551721c2fe38c64fbfd48de79">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[2/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">complex_resource_tree&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05131">5131</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">check_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;{</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_1[] = {</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      <span class="stringliteral">&quot;dwarves&quot;</span>,</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;   };</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_2[] = {</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;      <span class="stringliteral">&quot;happy&quot;</span>,</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;      <span class="stringliteral">&quot;grumpy&quot;</span>,</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;      <span class="stringliteral">&quot;doc&quot;</span>,</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;      <span class="stringliteral">&quot;bashful&quot;</span>,</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      <span class="stringliteral">&quot;dopey&quot;</span>,</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      <span class="stringliteral">&quot;sneezy&quot;</span>,</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;      <span class="stringliteral">&quot;sleepy&quot;</span>,</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;   };</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d14/structtree__node.html">tree_node</a> *<a class="code" href="../../d5/da1/structnode.html">node</a>;</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;complex_resource_tree&quot;</span>;</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Complex resource tree integrity check&quot;</span>;</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;         <span class="stringliteral">&quot;Create a complex resource list and ensure that our attempt to build a tree works as expected.&quot;</span>;</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;   }</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;   }</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;   list_1 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1));</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;   <span class="keywordflow">if</span> (!list_1) {</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;   }</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;   list_2 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;dwarves&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2));</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;   <span class="keywordflow">if</span> (!list_2) {</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;   }</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;   }</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;   }</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;   node = tree-&gt;root;</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, node, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1))) {</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;   }</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;   <span class="comment">/* The embedded list is at index 3 in the root node&#39;s children */</span></div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;   node = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;node-&gt;children, 3);</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, node, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2))) {</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;   }</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;}</div><div class="ttc" id="structnode_html"><div class="ttname"><a href="../../d5/da1/structnode.html">node</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2b/test__heap_8c_source.html#l00038">test_heap.c:38</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structtree__node_html"><div class="ttname"><a href="../../d6/d14/structtree__node.html">tree_node</a></div><div class="ttdoc">A node for a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00888">res_pjsip_pubsub.c:888</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2a6654da48a7765b0c5957be5c282ea6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a></div><div class="ttdeci">static int check_node(struct ast_test *test, struct tree_node *node, const char **resources, size_t num_resources)</div><div class="ttdoc">Check the integrity of a tree node against a set of resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">res_pjsip_pubsub.c:5022</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ad2962bb10fb62debded8a39cc1e3fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ad2962bb10fb62debded8a39cc1e3fa">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[3/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">bad_resource&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05208">5208</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">check_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;{</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources[] = {</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;      <span class="stringliteral">&quot;coconut&quot;</span>, <span class="comment">/* A &quot;bad&quot; resource */</span></div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;   };</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;bad_resource&quot;</span>;</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Ensure bad resources do not end up in the tree&quot;</span>;</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;         <span class="stringliteral">&quot;Create a resource list with a single bad resource. Ensure the bad resource does not end up in the tree.&quot;</span>;</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;   }</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;   }</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;   list = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources));</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;   }</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;   }</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;   }</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;   <span class="comment">/* We check against all but the final resource since we expect it not to be in the tree */</span></div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, tree-&gt;root, resources, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources) - 1)) {</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;   }</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2a6654da48a7765b0c5957be5c282ea6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a></div><div class="ttdeci">static int check_node(struct ast_test *test, struct tree_node *node, const char **resources, size_t num_resources)</div><div class="ttdoc">Check the integrity of a tree node against a set of resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">res_pjsip_pubsub.c:5022</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a592d2ccf2b016dd3c962e6bc8eba77a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a592d2ccf2b016dd3c962e6bc8eba77a0">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[4/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">bad_branch&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05264">5264</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">check_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;{</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_1[] = {</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      <span class="stringliteral">&quot;gross&quot;</span>,</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;   };</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;   <span class="comment">/* This list has nothing but bad resources */</span></div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_2[] = {</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;      <span class="stringliteral">&quot;coconut&quot;</span>,</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;      <span class="stringliteral">&quot;cilantro&quot;</span>,</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      <span class="stringliteral">&quot;olive&quot;</span>,</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;      <span class="stringliteral">&quot;cheese&quot;</span>,</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;   };</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;bad_branch&quot;</span>;</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Ensure bad branches are pruned from the tree&quot;</span>;</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;         <span class="stringliteral">&quot;Create a resource list that makes a tree with an entire branch of bad resources.\n&quot;</span></div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;         <span class="stringliteral">&quot;Ensure the bad branch is pruned from the tree.&quot;</span>;</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;   }</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;   }</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;   list_1 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1));</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;   <span class="keywordflow">if</span> (!list_1) {</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;   }</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;   list_2 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;gross&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2));</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;   <span class="keywordflow">if</span> (!list_2) {</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;   }</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;   }</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;   }</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;   <span class="comment">/* We check against all but the final resource of the list since the entire branch should</span></div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;<span class="comment">    * be pruned from the tree</span></div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, tree-&gt;root, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1) - 1)) {</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;   }</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2a6654da48a7765b0c5957be5c282ea6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a></div><div class="ttdeci">static int check_node(struct ast_test *test, struct tree_node *node, const char **resources, size_t num_resources)</div><div class="ttdoc">Check the integrity of a tree node against a set of resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">res_pjsip_pubsub.c:5022</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a390c1a18874b65665ec47829e6a94b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a390c1a18874b65665ec47829e6a94b7b">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[5/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">duplicate_resource&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05335">5335</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">check_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;{</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_1[] = {</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      <span class="stringliteral">&quot;ducks&quot;</span>,</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;   };</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_2[] = {</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;      <span class="stringliteral">&quot;donald&quot;</span>,</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      <span class="stringliteral">&quot;daisy&quot;</span>,</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;      <span class="stringliteral">&quot;scrooge&quot;</span>,</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;   };</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d14/structtree__node.html">tree_node</a> *<a class="code" href="../../d5/da1/structnode.html">node</a>;</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;duplicate_resource&quot;</span>;</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Ensure duplicated resources do not end up in the tree&quot;</span>;</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;         <span class="stringliteral">&quot;Create a resource list with a single duplicated resource. Ensure the duplicated resource does not end up in the tree.&quot;</span>;</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;   }</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;   }</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;   list_1 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1));</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;   <span class="keywordflow">if</span> (!list_1) {</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;   }</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;   list_2 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;ducks&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2));</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;   <span class="keywordflow">if</span> (!list_2) {</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;   }</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;   }</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;   }</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;   node = tree-&gt;root;</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;   <span class="comment">/* This node should have &quot;huey&quot; and &quot;ducks&quot;. &quot;dewey&quot; and &quot;louie&quot; should not</span></div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="comment">    * be present since they were found in the &quot;ducks&quot; list.</span></div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, node, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1) - 2)) {</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;   }</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;   <span class="comment">/* This node should have &quot;donald&quot;, &quot;daisy&quot;, &quot;scrooge&quot;, &quot;dewey&quot;, and &quot;louie&quot;.</span></div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;<span class="comment">    * &quot;huey&quot; is not here since that was already encountered in the parent list</span></div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;   node = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;node-&gt;children, 1);</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, node, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2) - 1)) {</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;   }</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;}</div><div class="ttc" id="structnode_html"><div class="ttname"><a href="../../d5/da1/structnode.html">node</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2b/test__heap_8c_source.html#l00038">test_heap.c:38</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structtree__node_html"><div class="ttname"><a href="../../d6/d14/structtree__node.html">tree_node</a></div><div class="ttdoc">A node for a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00888">res_pjsip_pubsub.c:888</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2a6654da48a7765b0c5957be5c282ea6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2a6654da48a7765b0c5957be5c282ea6">check_node</a></div><div class="ttdeci">static int check_node(struct ast_test *test, struct tree_node *node, const char **resources, size_t num_resources)</div><div class="ttdoc">Check the integrity of a tree node against a set of resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">res_pjsip_pubsub.c:5022</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad25ce03cdf8ed99dfe8e66a3b3a3d0b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad25ce03cdf8ed99dfe8e66a3b3a3d0b6">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[6/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">loop&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05416">5416</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;{</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list_2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_1[] = {</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      <span class="stringliteral">&quot;derp&quot;</span>,</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;   };</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources_2[] = {</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      <span class="stringliteral">&quot;herp&quot;</span>,</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;   };</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;loop&quot;</span>;</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test that loops are properly detected.&quot;</span>;</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;         <span class="stringliteral">&quot;Create two resource lists that refer to each other. Ensure that attempting to build a tree\n&quot;</span></div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;         <span class="stringliteral">&quot;results in an empty tree.&quot;</span>;</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;   }</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;   }</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;   list_1 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;herp&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_1, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_1));</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;   <span class="keywordflow">if</span> (!list_1) {</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;   }</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;   list_2 = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;derp&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>, resources_2, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources_2));</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;   <span class="keywordflow">if</span> (!list_2) {</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;   }</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;herp&quot;</span>, tree, 1);</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;   <span class="keywordflow">if</span> (resp == 200) {</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;   }</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af570896c63f7cc45d4ed91f135f76340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af570896c63f7cc45d4ed91f135f76340">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[7/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">bad_event&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05467">5467</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">ineligible_configuration()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;{</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>);</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *, tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a>);</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *resources[] = {</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      <span class="stringliteral">&quot;huey&quot;</span>,</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;      <span class="stringliteral">&quot;dewey&quot;</span>,</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;      <span class="stringliteral">&quot;louie&quot;</span>,</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;   };</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;bad_event&quot;</span>;</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_pubsub/&quot;</span>;</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Ensure that list with wrong event specified is not retrieved&quot;</span>;</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;         <span class="stringliteral">&quot;Create a simple resource list for event &#39;tsetse&#39;. Ensure that trying to retrieve the list for event &#39;test&#39; fails.&quot;</span>;</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;   }</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a>()) {</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Ineligible configuration for this test. Please add a &quot;</span></div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;            <span class="stringliteral">&quot;&#39;res_pjsip_pubsub&#39; section to sorcery.conf, and set &#39;resource_list=memory&#39;\n&quot;</span>);</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;   }</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;   list = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;tsetse&quot;</span>, resources, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resources));</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;   }</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;   tree = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tree));</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;   <span class="comment">/* Since the test_handler is for event &quot;test&quot;, this should not build a list, but</span></div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="comment">    * instead result in a single resource being created, called &quot;foo&quot;</span></div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a>, <span class="stringliteral">&quot;foo&quot;</span>, tree, 1);</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;   <span class="keywordflow">if</span> (resp != 200) {</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected response %d when building resource tree\n&quot;</span>, resp);</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;   }</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;root) {</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resource tree has no root\n&quot;</span>);</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;   }</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;   <span class="keywordflow">if</span> (strcmp(tree-&gt;root-&gt;resource, <span class="stringliteral">&quot;foo&quot;</span>)) {</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected resource %s found in tree\n&quot;</span>, tree-&gt;root-&gt;resource);</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;   }</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a31880cde88a125b5079ac946cc352603"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31880cde88a125b5079ac946cc352603">create_resource_list</a></div><div class="ttdeci">static struct resource_list * create_resource_list(struct ast_test *test, const char *list_name, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">allocate a resource list, store it in sorcery, and set its details </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">res_pjsip_pubsub.c:4983</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a99619cb1fc467541615fc8d043d39643"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a99619cb1fc467541615fc8d043d39643">test_handler</a></div><div class="ttdeci">struct ast_sip_subscription_handler test_handler</div><div class="ttdoc">Subscription handler for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">res_pjsip_pubsub.c:4927</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a673b72409d496c2975c04f5d44f8a277"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a673b72409d496c2975c04f5d44f8a277">ineligible_configuration</a></div><div class="ttdeci">static int ineligible_configuration(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">res_pjsip_pubsub.c:5053</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd2ddc65db04f4a50bb9fe68a197b167"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd2ddc65db04f4a50bb9fe68a197b167">test_resource_tree_destroy</a></div><div class="ttdeci">static void test_resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">RAII_VAR callback to destroy an allocated resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">res_pjsip_pubsub.c:5047</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7db5b123e82a8da6f1ae6fc15aaace5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7db5b123e82a8da6f1ae6fc15aaace5">&#9670;&nbsp;</a></span>AST_VECTOR() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_VECTOR </td>
          <td>(</td>
          <td class="paramtype">resources&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A vector of strings commonly used throughout this module. </p>

</div>
</div>
<a id="a395edfd94277055d76e77c4a166bf8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a395edfd94277055d76e77c4a166bf8f8">&#9670;&nbsp;</a></span>AST_VECTOR() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_VECTOR </td>
          <td>(</td>
          <td class="paramtype">body_part_list&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/de8/structbody__part.html">body_part</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type declaration for container of body part structures. </p>

</div>
</div>
<a id="a2dba366491005a78cb1b67070de74a6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dba366491005a78cb1b67070de74a6e">&#9670;&nbsp;</a></span>build_body_part()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void build_body_part </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct body_part_list *&#160;</td>
          <td class="paramname"><em>parts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>use_full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a multipart body part for a subscribed resource. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>PJLIB allocation pool </td></tr>
    <tr><td class="paramname">sub</td><td>The subscription representing a subscribed resource </td></tr>
    <tr><td class="paramname">parts</td><td>A vector of parts to append the created part to. </td></tr>
    <tr><td class="paramname">use_full_state</td><td>Unused locally, but may be passed to other functions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02258">2258</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02233">allocate_body_part()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">body_part::cid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">body_part::part</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">generate_list_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;{</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/de8/structbody__part.html">body_part</a> *bp;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;   pjsip_msg_body *body;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;   bp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5314d6fbf19f6f10073f1d4e0787e957">allocate_body_part</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, sub);</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   <span class="keywordflow">if</span> (!bp) {</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   }</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;   body = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abe6f294a1dd6e02f90699c6862c8ff37">generate_notify_body</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, sub, use_full_state);</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;   <span class="keywordflow">if</span> (!body) {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="comment">/* Partial state was requested and the resource has not changed state */</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(bp);</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   }</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">part</a> = pjsip_multipart_create_part(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">part</a>-&gt;body = body;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;   pj_list_insert_before(&amp;bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">part</a>-&gt;hdr, bp-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">cid</a>);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(parts, bp)) {</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(bp);</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   }</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;}</div><div class="ttc" id="structbody__part_html"><div class="ttname"><a href="../../d2/de8/structbody__part.html">body_part</a></div><div class="ttdoc">A multipart body part and meta-information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02080">res_pjsip_pubsub.c:2080</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5314d6fbf19f6f10073f1d4e0787e957"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5314d6fbf19f6f10073f1d4e0787e957">allocate_body_part</a></div><div class="ttdeci">static struct body_part * allocate_body_part(pj_pool_t *pool, const struct ast_sip_subscription *sub)</div><div class="ttdoc">Allocate and initialize a body part structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02233">res_pjsip_pubsub.c:2233</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abe6f294a1dd6e02f90699c6862c8ff37"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abe6f294a1dd6e02f90699c6862c8ff37">generate_notify_body</a></div><div class="ttdeci">static pjsip_msg_body * generate_notify_body(pj_pool_t *pool, struct ast_sip_subscription *root, unsigned int force_full_state)</div><div class="ttdoc">Create the body for a NOTIFY request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">res_pjsip_pubsub.c:2371</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structbody__part_html_a97f61ce218f9876fc092948fe744b2bc"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">body_part::cid</a></div><div class="ttdeci">pjsip_generic_string_hdr * cid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">res_pjsip_pubsub.c:2082</a></div></div>
<div class="ttc" id="structbody__part_html_ac56343f0ae7d83d16f23924f1f828149"><div class="ttname"><a href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">body_part::part</a></div><div class="ttdeci">pjsip_multipart_part * part</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">res_pjsip_pubsub.c:2090</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55abfb60c70c5e948521709e10e54492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55abfb60c70c5e948521709e10e54492">&#9670;&nbsp;</a></span>build_node_children()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void build_node_children </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct resources *&#160;</td>
          <td class="paramname"><em>visited</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build child nodes for a given parent. </p>
<p>This iterates through the items on a resource list and creates tree nodes for each one. The tree nodes created are children of the supplied parent node. If an item in the resource list is itself a list, then this function is called recursively to provide children for the new node.</p>
<p>If an item in a resource list is not a list, then the supplied subscription handler is called into as if a new SUBSCRIBE for the list item were presented. The handler's response is used to determine if the node can be added to the tree or not.</p>
<p>If a parent node ends up having no child nodes added under it, then the parent node is pruned from the tree.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that sent the inbound SUBSCRIBE. </td></tr>
    <tr><td class="paramname">handler</td><td>The subscription handler for leaf nodes in the tree. </td></tr>
    <tr><td class="paramname">list</td><td>The configured resource list from which the child node is being built. </td></tr>
    <tr><td class="paramname">parent</td><td>The parent node for these children. </td></tr>
    <tr><td class="paramname">visited</td><td>The resources that have already been visited. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">1021</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00332">resource_list::full_state</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00987">have_visited()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00270">ast_sip_notifier::new_subscribe</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">ast_sip_subscription_handler::notifier</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00902">retrieve_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00934">tree_node_alloc()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">tree_node_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;{</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>); ++i) {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d6/d14/structtree__node.html">tree_node</a> *current;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *child_list;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *resource = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, i);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d439528eda8c1d3b35a443170e745d0">have_visited</a>(resource, visited)) {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Already visited resource %s. Avoiding duplicate resource or potential loop.\n&quot;</span>, resource);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      child_list = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a93e6d67f6d539b39fd0ebe7171d480ca">retrieve_resource_list</a>(resource, list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (!child_list) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;         <span class="keywordtype">int</span> resp = handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>-&gt;<a class="code" href="../../d1/d5b/structast__sip__notifier.html#a0772d90dd533f5d4d50dccaad8817843">new_subscribe</a>(endpoint, resource);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         <span class="keywordflow">if</span> (PJSIP_IS_STATUS_IN_CLASS(resp, 200)) {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            current = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a>(resource, visited, 0);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="keywordflow">if</span> (!current) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                  <span class="stringliteral">&quot;Subscription to leaf resource %s was successful, but encountered allocation error afterwards\n&quot;</span>,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                  resource);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            }</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Subscription to leaf resource %s resulted in success. Adding to parent %s\n&quot;</span>,</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                  resource, parent-&gt;resource);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;parent-&gt;children, current)) {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;               <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a>(current);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Subscription to leaf resource %s resulted in error response %d\n&quot;</span>,</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                  resource, resp);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Resource %s (child of %s) is a list\n&quot;</span>, resource, parent-&gt;resource);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         current = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a>(resource, visited, child_list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a4ec2ed8bfc8538671089fc04bb4710bb">full_state</a>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;         <span class="keywordflow">if</span> (!current) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Cannot build children of resource %s due to allocation failure\n&quot;</span>, resource);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a55abfb60c70c5e948521709e10e54492">build_node_children</a>(endpoint, handler, child_list, current, visited);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;current-&gt;children) &gt; 0) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;List %s had no successful children.\n&quot;</span>, resource);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;parent-&gt;children, current)) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;               <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a>(current);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;List %s had successful children. Adding to parent %s\n&quot;</span>,</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                  resource, parent-&gt;resource);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a>(current);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;         }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(child_list);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_adba83183b8ab9dfd5b4ce87ddafc78a1"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a></div><div class="ttdeci">static struct tree_node * tree_node_alloc(const char *resource, struct resources *visited, unsigned int full_state)</div><div class="ttdoc">Allocate a tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00934">res_pjsip_pubsub.c:934</a></div></div>
<div class="ttc" id="structresource__list_html_a5053da7047dfe40d67229c5dbc361f8b"><div class="ttname"><a href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">resource_list::event</a></div><div class="ttdeci">char event[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">res_pjsip_pubsub.c:328</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a55abfb60c70c5e948521709e10e54492"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a55abfb60c70c5e948521709e10e54492">build_node_children</a></div><div class="ttdeci">static void build_node_children(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, struct resource_list *list, struct tree_node *parent, struct resources *visited)</div><div class="ttdoc">Build child nodes for a given parent. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">res_pjsip_pubsub.c:1021</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a06762434263891503f1fe196fd2cf613"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">ast_sip_subscription_handler::notifier</a></div><div class="ttdeci">struct ast_sip_notifier * notifier</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">res_pjsip_pubsub.h:339</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a93e6d67f6d539b39fd0ebe7171d480ca"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a93e6d67f6d539b39fd0ebe7171d480ca">retrieve_resource_list</a></div><div class="ttdeci">static struct resource_list * retrieve_resource_list(const char *resource, const char *event)</div><div class="ttdoc">Helper function for retrieving a resource list for a given event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00902">res_pjsip_pubsub.c:902</a></div></div>
<div class="ttc" id="structtree__node_html"><div class="ttname"><a href="../../d6/d14/structtree__node.html">tree_node</a></div><div class="ttdoc">A node for a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00888">res_pjsip_pubsub.c:888</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__notifier_html_a0772d90dd533f5d4d50dccaad8817843"><div class="ttname"><a href="../../d1/d5b/structast__sip__notifier.html#a0772d90dd533f5d4d50dccaad8817843">ast_sip_notifier::new_subscribe</a></div><div class="ttdeci">int(* new_subscribe)(struct ast_sip_endpoint *endpoint, const char *resource)</div><div class="ttdoc">Called when a SUBSCRIBE arrives attempting to establish a new subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00270">res_pjsip_pubsub.h:270</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7d439528eda8c1d3b35a443170e745d0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d439528eda8c1d3b35a443170e745d0">have_visited</a></div><div class="ttdeci">static int have_visited(const char *resource, struct resources *visited)</div><div class="ttdoc">Determine if this resource has been visited already. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00987">res_pjsip_pubsub.c:987</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structresource__list_html_a4ec2ed8bfc8538671089fc04bb4710bb"><div class="ttname"><a href="../../df/dd0/structresource__list.html#a4ec2ed8bfc8538671089fc04bb4710bb">resource_list::full_state</a></div><div class="ttdeci">unsigned int full_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00332">res_pjsip_pubsub.c:332</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aab8324717cc2207dbde31f177aa7ac0f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a></div><div class="ttdeci">static void tree_node_destroy(struct tree_node *node)</div><div class="ttdoc">Destructor for a tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">res_pjsip_pubsub.c:965</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3707d69a8c25755d9fbe3f4d2ed80477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3707d69a8c25755d9fbe3f4d2ed80477">&#9670;&nbsp;</a></span>build_resource_tree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_resource_tree </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>has_eventlist_support</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build a resource tree. </p>
<p>This function builds a resource tree based on the requested resource in a SUBSCRIBE request.</p>
<p>This function also creates a container that has all resources that have been visited during creation of the tree, whether those resources resulted in a tree node being created or not. Keeping this container of visited resources allows for misconfigurations such as loops in the tree or duplicated resources to be detected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that sent the SUBSCRIBE request. </td></tr>
    <tr><td class="paramname">handler</td><td>The subscription handler for leaf nodes in the tree. </td></tr>
    <tr><td class="paramname">resource</td><td>The resource requested in the SUBSCRIBE request. </td></tr>
    <tr><td class="paramname">tree</td><td>The tree that is to be built. </td></tr>
    <tr><td class="paramname">has_eventlist_support</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">200-299</td><td>Successfully subscribed to at least one resource. </td></tr>
    <tr><td class="paramname">300-699</td><td>Failure to subscribe to requested resource. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">1135</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">build_node_children()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00270">ast_sip_notifier::new_subscribe</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01097">resource_tree::notification_batch_interval</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">ast_sip_subscription_handler::notifier</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00902">retrieve_resource_list()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">resource_tree::root</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00934">tree_node_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *, list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <span class="keyword">struct </span>resources visited;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   <span class="keywordflow">if</span> (!has_eventlist_support || !(list = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a93e6d67f6d539b39fd0ebe7171d480ca">retrieve_resource_list</a>(resource, handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>))) {</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Subscription &#39;%s-&gt;%s&#39; is not to a list\n&quot;</span>,</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), resource);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a>(resource, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">if</span> (!tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;         <span class="keywordflow">return</span> 500;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">return</span> handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>-&gt;<a class="code" href="../../d1/d5b/structast__sip__notifier.html#a0772d90dd533f5d4d50dccaad8817843">new_subscribe</a>(endpoint, resource);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Subscription &#39;%s-&gt;%s&#39; is a list\n&quot;</span>,</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), resource);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;visited, <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;items))) {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">return</span> 500;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a>(resource, &amp;visited, list-&gt;full_state);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <span class="keywordflow">if</span> (!tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;visited);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">return</span> 500;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#ac90516981222dda0270465a33483f2b4">notification_batch_interval</a> = list-&gt;notification_batch_interval;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a55abfb60c70c5e948521709e10e54492">build_node_children</a>(endpoint, handler, list, tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>, &amp;visited);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;visited);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>-&gt;children) &gt; 0) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">return</span> 200;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordflow">return</span> 500;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_adba83183b8ab9dfd5b4ce87ddafc78a1"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#adba83183b8ab9dfd5b4ce87ddafc78a1">tree_node_alloc</a></div><div class="ttdeci">static struct tree_node * tree_node_alloc(const char *resource, struct resources *visited, unsigned int full_state)</div><div class="ttdoc">Allocate a tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00934">res_pjsip_pubsub.c:934</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a55abfb60c70c5e948521709e10e54492"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a55abfb60c70c5e948521709e10e54492">build_node_children</a></div><div class="ttdeci">static void build_node_children(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, struct resource_list *list, struct tree_node *parent, struct resources *visited)</div><div class="ttdoc">Build child nodes for a given parent. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">res_pjsip_pubsub.c:1021</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a06762434263891503f1fe196fd2cf613"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">ast_sip_subscription_handler::notifier</a></div><div class="ttdeci">struct ast_sip_notifier * notifier</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">res_pjsip_pubsub.h:339</a></div></div>
<div class="ttc" id="structresource__tree_html_a2dce9d43da01d556f3a1d694d03a40a9"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">resource_tree::root</a></div><div class="ttdeci">struct tree_node * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">res_pjsip_pubsub.c:1096</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a93e6d67f6d539b39fd0ebe7171d480ca"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a93e6d67f6d539b39fd0ebe7171d480ca">retrieve_resource_list</a></div><div class="ttdeci">static struct resource_list * retrieve_resource_list(const char *resource, const char *event)</div><div class="ttdoc">Helper function for retrieving a resource list for a given event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00902">res_pjsip_pubsub.c:902</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="structresource__tree_html_ac90516981222dda0270465a33483f2b4"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html#ac90516981222dda0270465a33483f2b4">resource_tree::notification_batch_interval</a></div><div class="ttdeci">unsigned int notification_batch_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01097">res_pjsip_pubsub.c:1097</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__notifier_html_a0772d90dd533f5d4d50dccaad8817843"><div class="ttname"><a href="../../d1/d5b/structast__sip__notifier.html#a0772d90dd533f5d4d50dccaad8817843">ast_sip_notifier::new_subscribe</a></div><div class="ttdeci">int(* new_subscribe)(struct ast_sip_endpoint *endpoint, const char *resource)</div><div class="ttdoc">Called when a SUBSCRIBE arrives attempting to establish a new subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00270">res_pjsip_pubsub.h:270</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0aa1afb0a81eaeebda85dbb188f82df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aa1afb0a81eaeebda85dbb188f82df7">&#9670;&nbsp;</a></span>build_rlmi_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_multipart_part* build_rlmi_body </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct body_part_list *&#160;</td>
          <td class="paramname"><em>body_parts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create an RLMI body part for a multipart resource list body. </p>
<p>RLMI (Resource list meta information) is a special body type that lists the subscribed resources and tells subscribers the number of subscribed resources and what other body parts are in the multipart body. The RLMI body also has a version number that a subscriber can use to ensure that the locally-stored state corresponds to server state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The allocation pool </td></tr>
    <tr><td class="paramname">sub</td><td>The subscription representing the subscribed resource list </td></tr>
    <tr><td class="paramname">body_parts</td><td>A container of body parts that RLMI will refer to </td></tr>
    <tr><td class="paramname">full_state</td><td>Indicates whether this is a full or partial state notification </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The multipart part representing the RLMI body </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">2162</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02029">add_rlmi_resource()</a>, <a class="el" href="../../db/d6b/presence__xml_8c_source.html#l00140">ast_sip_presence_xml_create_attr()</a>, <a class="el" href="../../db/d6b/presence__xml_8c_source.html#l00152">ast_sip_presence_xml_create_node()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02578">ast_sip_subscription_get_local_uri()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02596">ast_sip_subscription_get_resource_name()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">body_part::cid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02107">generate_content_id_hdr()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">body_part::part</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">pool</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02084">body_part::resource</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02140">rlmi_clone_data()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00539">rlmi_media_type</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02127">rlmi_print_body()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02088">body_part::state</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02086">body_part::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">generate_list_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;{</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   pj_xml_node *rlmi;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;   pj_xml_node *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;   pjsip_multipart_part *rlmi_part;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;   <span class="keywordtype">char</span> version_str[32];</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;   <span class="keywordtype">char</span> uri[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;   pjsip_generic_string_hdr *cid;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;   rlmi = <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;list&quot;</span>);</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;xmlns&quot;</span>, <span class="stringliteral">&quot;urn:ietf:params:xml:ns:rlmi&quot;</span>);</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aeb411f16e0fee4036a22b354164b43a6">ast_sip_subscription_get_local_uri</a>(sub, uri, <span class="keyword">sizeof</span>(uri));</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;uri&quot;</span>, uri);</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;   snprintf(version_str, <span class="keyword">sizeof</span>(version_str), <span class="stringliteral">&quot;%u&quot;</span>, sub-&gt;version++);</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;version&quot;</span>, version_str);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;   <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;fullState&quot;</span>, full_state ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;   name = <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, <span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;name-&gt;content, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d7ed3f8785ad9d9aa3fc090d983c45d">ast_sip_subscription_get_resource_name</a>(sub));</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(body_parts); ++i) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d2/de8/structbody__part.html">body_part</a> *<a class="code" href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">part</a> = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(body_parts, i);</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac9ccf20fa81744533ad45801f7f1a3b6">add_rlmi_resource</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi, part-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">cid</a>, part-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a97b7ef5a69a288651ec0d5acbe75d36d">resource</a>, part-&gt;<a class="code" href="../../d2/de8/structbody__part.html#ac43e5728c2093e52e8a06774ab68afe2">uri</a>, part-&gt;<a class="code" href="../../d2/de8/structbody__part.html#a06eab984618d6a85fadc73dfb41f5c69">state</a>);</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;   }</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   rlmi_part = pjsip_multipart_create_part(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>);</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   rlmi_part-&gt;body = PJ_POOL_ZALLOC_T(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, pjsip_msg_body);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   pjsip_media_type_cp(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;rlmi_part-&gt;body-&gt;content_type, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae55303c463ee7d4709335ae3311c3826">rlmi_media_type</a>);</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   rlmi_part-&gt;body-&gt;data = pj_xml_clone(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi);</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   rlmi_part-&gt;body-&gt;clone_data = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a474bbe394cad0178cf128a36a312ca62">rlmi_clone_data</a>;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;   rlmi_part-&gt;body-&gt;print_body = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a786140dcdee30f86fc9a661c515982bb">rlmi_print_body</a>;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;   cid = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b691f0bc6a8c56d55095fa30cef4e47">generate_content_id_hdr</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, sub);</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   pj_list_insert_before(&amp;rlmi_part-&gt;hdr, cid);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;   <span class="keywordflow">return</span> rlmi_part;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_ae55303c463ee7d4709335ae3311c3826"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae55303c463ee7d4709335ae3311c3826">rlmi_media_type</a></div><div class="ttdeci">static pjsip_media_type rlmi_media_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00539">res_pjsip_pubsub.c:539</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a786140dcdee30f86fc9a661c515982bb"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a786140dcdee30f86fc9a661c515982bb">rlmi_print_body</a></div><div class="ttdeci">static int rlmi_print_body(struct pjsip_msg_body *msg_body, char *buf, pj_size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02127">res_pjsip_pubsub.c:2127</a></div></div>
<div class="ttc" id="structbody__part_html"><div class="ttname"><a href="../../d2/de8/structbody__part.html">body_part</a></div><div class="ttdoc">A multipart body part and meta-information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02080">res_pjsip_pubsub.c:2080</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="res__pjsip__presence__xml_8h_html_af60a5851382ce5f434b07fdefc194cbe"><div class="ttname"><a href="../../d5/dc3/res__pjsip__presence__xml_8h.html#af60a5851382ce5f434b07fdefc194cbe">ast_sip_presence_xml_create_attr</a></div><div class="ttdeci">pj_xml_attr * ast_sip_presence_xml_create_attr(pj_pool_t *pool, pj_xml_node *node, const char *name, const char *value)</div><div class="ttdoc">Create XML attribute. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6b/presence__xml_8c_source.html#l00140">presence_xml.c:140</a></div></div>
<div class="ttc" id="structbody__part_html_a97b7ef5a69a288651ec0d5acbe75d36d"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97b7ef5a69a288651ec0d5acbe75d36d">body_part::resource</a></div><div class="ttdeci">const char * resource</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02084">res_pjsip_pubsub.c:2084</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac9ccf20fa81744533ad45801f7f1a3b6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac9ccf20fa81744533ad45801f7f1a3b6">add_rlmi_resource</a></div><div class="ttdeci">static void add_rlmi_resource(pj_pool_t *pool, pj_xml_node *rlmi, const pjsip_generic_string_hdr *cid, const char *resource_name, const pjsip_sip_uri *resource_uri, pjsip_evsub_state state)</div><div class="ttdoc">Add a resource XML element to an RLMI body. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02029">res_pjsip_pubsub.c:2029</a></div></div>
<div class="ttc" id="structbody__part_html_ac43e5728c2093e52e8a06774ab68afe2"><div class="ttname"><a href="../../d2/de8/structbody__part.html#ac43e5728c2093e52e8a06774ab68afe2">body_part::uri</a></div><div class="ttdeci">pjsip_sip_uri * uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02086">res_pjsip_pubsub.c:2086</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aeb411f16e0fee4036a22b354164b43a6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aeb411f16e0fee4036a22b354164b43a6">ast_sip_subscription_get_local_uri</a></div><div class="ttdeci">void ast_sip_subscription_get_local_uri(struct ast_sip_subscription *sub, char *buf, size_t size)</div><div class="ttdoc">Retrieve the local URI for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02578">res_pjsip_pubsub.c:2578</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2d7ed3f8785ad9d9aa3fc090d983c45d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d7ed3f8785ad9d9aa3fc090d983c45d">ast_sip_subscription_get_resource_name</a></div><div class="ttdeci">const char * ast_sip_subscription_get_resource_name(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the name of the subscribed resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02596">res_pjsip_pubsub.c:2596</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structbody__part_html_a97f61ce218f9876fc092948fe744b2bc"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">body_part::cid</a></div><div class="ttdeci">pjsip_generic_string_hdr * cid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">res_pjsip_pubsub.c:2082</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a474bbe394cad0178cf128a36a312ca62"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a474bbe394cad0178cf128a36a312ca62">rlmi_clone_data</a></div><div class="ttdeci">static void * rlmi_clone_data(pj_pool_t *pool, const void *data, unsigned len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02140">res_pjsip_pubsub.c:2140</a></div></div>
<div class="ttc" id="res__pjsip__presence__xml_8h_html_ae8b2b2ccfe3099ff401bad55c2820f98"><div class="ttname"><a href="../../d5/dc3/res__pjsip__presence__xml_8h.html#ae8b2b2ccfe3099ff401bad55c2820f98">ast_sip_presence_xml_create_node</a></div><div class="ttdeci">pj_xml_node * ast_sip_presence_xml_create_node(pj_pool_t *pool, pj_xml_node *parent, const char *name)</div><div class="ttdoc">Create XML node. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6b/presence__xml_8c_source.html#l00152">presence_xml.c:152</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structbody__part_html_ac56343f0ae7d83d16f23924f1f828149"><div class="ttname"><a href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">body_part::part</a></div><div class="ttdeci">pjsip_multipart_part * part</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">res_pjsip_pubsub.c:2090</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7b691f0bc6a8c56d55095fa30cef4e47"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7b691f0bc6a8c56d55095fa30cef4e47">generate_content_id_hdr</a></div><div class="ttdeci">static pjsip_generic_string_hdr * generate_content_id_hdr(pj_pool_t *pool, const struct ast_sip_subscription *sub)</div><div class="ttdoc">Create a Content-ID header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02107">res_pjsip_pubsub.c:2107</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structbody__part_html_a06eab984618d6a85fadc73dfb41f5c69"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a06eab984618d6a85fadc73dfb41f5c69">body_part::state</a></div><div class="ttdeci">pjsip_evsub_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02088">res_pjsip_pubsub.c:2088</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a6654da48a7765b0c5957be5c282ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a6654da48a7765b0c5957be5c282ea6">&#9670;&nbsp;</a></span>check_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_node </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check the integrity of a tree node against a set of resources. </p>
<p>The tree node's resources must be in the same order as the resources in the supplied resources array. Because of this constraint, tests can misrepresent the size of the resources array as being smaller than it really is if resources at the end of the array should not be present in the tree node.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test</td><td>The unit test. Used for printing status messages. </td></tr>
    <tr><td class="paramname">node</td><td>The constructed tree node whose integrity is under question. </td></tr>
    <tr><td class="paramname">resources</td><td>Array of expected resource values </td></tr>
    <tr><td class="paramname">num_resources</td><td>The number of resources to check in the array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05022">5022</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;{</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;node-&gt;children) != num_resources) {</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected number of resources in tree. Expected %zu, got %zu\n&quot;</span>,</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;            num_resources, <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;node-&gt;children));</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;   }</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; num_resources; ++i) {</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;      <span class="keywordflow">if</span> (strcmp(resources[i], <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;node-&gt;children, i)-&gt;resource)) {</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Mismatched resources. Expected &#39;%s&#39; but got &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;               resources[i], <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;node-&gt;children, i)-&gt;resource);</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      }</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;   }</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;}</div><div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30a0d1004e7965d66f03d5a12645e81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a0d1004e7965d66f03d5a12645e81b">&#9670;&nbsp;</a></span>cleanup_resource_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cleanup_resource_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td>
          <td class="paramname"><em>list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RAII callback to destroy a resource list. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">4962</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, and <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;{</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;   }</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), list);</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(list);</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;}</div><div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47e4246289d04b68202052414c219922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47e4246289d04b68202052414c219922">&#9670;&nbsp;</a></span>cli_complete_subscription_callid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* cli_complete_subscription_callid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">4193</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">a</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04153">cli_sub_complete_parms::a</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00161">ast_cli_args::argv</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04155">cli_sub_complete_parms::callid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04181">cli_complete_subscription_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04187">cli_complete_subscription_outbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00164">ast_cli_args::pos</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04157">cli_sub_complete_parms::which</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00163">ast_cli_args::word</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04156">cli_sub_complete_parms::wordlen</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">cli_show_subscription_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;{</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/df6/structcli__sub__complete__parms.html">cli_sub_complete_parms</a> <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a> on_subscription;</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> != 4) {</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;   }</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;inbound&quot;</span>)) {</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aebb94c33681f975e62c71f1e970f7dae">cli_complete_subscription_inbound</a>;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;outbound&quot;</span>)) {</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3ba86604727a1f14973496013df1884e">cli_complete_subscription_outbound</a>;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;      <span class="comment">/* Should never get here */</span></div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;   }</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.a = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.callid = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.wordlen = strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.which = 0;</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(on_subscription, &amp;<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>);</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.callid;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0b174b002a4e991ef8c08f17118f8cd5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a></div><div class="ttdeci">int(* on_subscription_t)(struct sip_subscription_tree *sub, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01798">res_pjsip_pubsub.c:1798</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_ab04b09a194737700c43608ca6de2d1c9"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a></div><div class="ttdeci">static struct ast_cli_entry cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d52/codec__dahdi_8c_source.html#l00265">codec_dahdi.c:265</a></div></div>
<div class="ttc" id="structcli__sub__complete__parms_html"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html">cli_sub_complete_parms</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04152">res_pjsip_pubsub.c:4152</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3ba86604727a1f14973496013df1884e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3ba86604727a1f14973496013df1884e">cli_complete_subscription_outbound</a></div><div class="ttdeci">static int cli_complete_subscription_outbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04187">res_pjsip_pubsub.c:4187</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aebb94c33681f975e62c71f1e970f7dae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aebb94c33681f975e62c71f1e970f7dae">cli_complete_subscription_inbound</a></div><div class="ttdeci">static int cli_complete_subscription_inbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04181">res_pjsip_pubsub.c:4181</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1659843ab11cf04649f5a03657943bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1659843ab11cf04649f5a03657943bb8">&#9670;&nbsp;</a></span>cli_complete_subscription_common()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_complete_subscription_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/df6/structcli__sub__complete__parms.html">cli_sub_complete_parms</a> *&#160;</td>
          <td class="paramname"><em>cli</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04160">4160</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04153">cli_sub_complete_parms::a</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04155">cli_sub_complete_parms::callid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00165">ast_cli_args::n</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04157">cli_sub_complete_parms::which</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00163">ast_cli_args::word</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04156">cli_sub_complete_parms::wordlen</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04181">cli_complete_subscription_inbound()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04187">cli_complete_subscription_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;{</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;   pj_str_t *<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">callid</a>;</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;   }</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;   callid = &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id;</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;   <span class="keywordflow">if</span> (cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af5adbe0a37846b3aacae6d358a1e57aa">wordlen</a> &lt;= pj_strlen(callid)</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;      &amp;&amp; !strncasecmp(cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, pj_strbuf(callid), cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af5adbe0a37846b3aacae6d358a1e57aa">wordlen</a>)</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      &amp;&amp; (++cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#aa2a4dae2a14de4093826005f9bdfd3bb">which</a> &gt; cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>)) {</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">callid</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(pj_strlen(callid) + 1);</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <span class="keywordflow">if</span> (cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">callid</a>) {</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(cli-&gt;<a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">callid</a>, callid, pj_strlen(callid) + 1);</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      }</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;   }</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;}</div><div class="ttc" id="structcli__sub__complete__parms_html_ae19846dd61ed50eb0d30e3b8bb915a8f"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">cli_sub_complete_parms::a</a></div><div class="ttdeci">struct ast_cli_args * a</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04153">res_pjsip_pubsub.c:4153</a></div></div>
<div class="ttc" id="structcli__sub__complete__parms_html_af5adbe0a37846b3aacae6d358a1e57aa"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html#af5adbe0a37846b3aacae6d358a1e57aa">cli_sub_complete_parms::wordlen</a></div><div class="ttdeci">int wordlen</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04156">res_pjsip_pubsub.c:4156</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="structcli__sub__complete__parms_html_aa2a4dae2a14de4093826005f9bdfd3bb"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html#aa2a4dae2a14de4093826005f9bdfd3bb">cli_sub_complete_parms::which</a></div><div class="ttdeci">int which</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04157">res_pjsip_pubsub.c:4157</a></div></div>
<div class="ttc" id="structast__cli__args_html_acfc02ec89670db29251fda6a66602ce2"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">ast_cli_args::n</a></div><div class="ttdeci">const int n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00165">cli.h:165</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="structcli__sub__complete__parms_html_af86c4ab2ba7f7fd632482bb08625be1a"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">cli_sub_complete_parms::callid</a></div><div class="ttdeci">char * callid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04155">res_pjsip_pubsub.c:4155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebb94c33681f975e62c71f1e970f7dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebb94c33681f975e62c71f1e970f7dae">&#9670;&nbsp;</a></span>cli_complete_subscription_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_complete_subscription_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04181">4181</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04160">cli_complete_subscription_common()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">cli_complete_subscription_callid()</a>.</p>
<div class="fragment"><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;{</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1659843ab11cf04649f5a03657943bb8">cli_complete_subscription_common</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a1659843ab11cf04649f5a03657943bb8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a1659843ab11cf04649f5a03657943bb8">cli_complete_subscription_common</a></div><div class="ttdeci">static int cli_complete_subscription_common(struct sip_subscription_tree *sub_tree, struct cli_sub_complete_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04160">res_pjsip_pubsub.c:4160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ba86604727a1f14973496013df1884e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba86604727a1f14973496013df1884e">&#9670;&nbsp;</a></span>cli_complete_subscription_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_complete_subscription_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04187">4187</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">AST_SIP_SUBSCRIBER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04160">cli_complete_subscription_common()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">cli_complete_subscription_callid()</a>.</p>
<div class="fragment"><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;{</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1659843ab11cf04649f5a03657943bb8">cli_complete_subscription_common</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a1659843ab11cf04649f5a03657943bb8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a1659843ab11cf04649f5a03657943bb8">cli_complete_subscription_common</a></div><div class="ttdeci">static int cli_complete_subscription_common(struct sip_subscription_tree *sub_tree, struct cli_sub_complete_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04160">res_pjsip_pubsub.c:4160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4732f846f9b6cda02dea380f561ea76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4732f846f9b6cda02dea380f561ea76a">&#9670;&nbsp;</a></span>cli_list_subscriptions_detail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_list_subscriptions_detail </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *&#160;</td>
          <td class="paramname"><em>cli</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">4524</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04522">CLI_LIST_SUB_FORMAT_ENTRY</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">cli_subscription_expiry()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">cli_sub_parms::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">cli_sub_parms::like</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00629">ast_sip_endpoint_id_configuration::self</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04568">cli_list_subscriptions_inbound()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04574">cli_list_subscriptions_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;{</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;   <span class="keywordtype">char</span> ep_cid_buf[50];</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;   <span class="keywordtype">char</span> res_evt_buf[50];</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">callid</a>[256];</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;   <span class="comment">/* Endpoint/CID column */</span></div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;   snprintf(ep_cid_buf, <span class="keyword">sizeof</span>(ep_cid_buf), <span class="stringliteral">&quot;%s/%s&quot;</span>,</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>),</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>,</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>,</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;            sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>)));</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;   <span class="comment">/* Resource/Event column */</span></div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;   snprintf(res_evt_buf, <span class="keyword">sizeof</span>(res_evt_buf), <span class="stringliteral">&quot;%s/%s&quot;</span>,</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource,</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;   <span class="comment">/* Call-id column */</span></div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(callid, &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id, <span class="keyword">sizeof</span>(callid));</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(callid, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>, <span class="keyword">sizeof</span>(callid));</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;   }</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>, 0, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0e71457156b5ee3447f3a7bd2877e28">CLI_LIST_SUB_FORMAT_ENTRY</a>,</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;      ep_cid_buf,</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;      res_evt_buf,</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a>(sub_tree),</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;      callid);</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <span class="keywordflow">if</span> (cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>) {</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;      <span class="keywordflow">if</span> (regexec(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>), 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;         <span class="comment">/* Output line did not match the regex */</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;      }</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;   }</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>));</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;   ++cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;}</div><div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae0e71457156b5ee3447f3a7bd2877e28"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0e71457156b5ee3447f3a7bd2877e28">CLI_LIST_SUB_FORMAT_ENTRY</a></div><div class="ttdeci">#define CLI_LIST_SUB_FORMAT_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04522">res_pjsip_pubsub.c:4522</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_ae19846dd61ed50eb0d30e3b8bb915a8f"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">cli_sub_parms::a</a></div><div class="ttdeci">struct ast_cli_args * a</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">res_pjsip_pubsub.c:4144</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#ad43c3812e6d13e0518d9f8b8f463ffcf">cli_sub_parms::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">res_pjsip_pubsub.c:4149</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a417ed811ee3ebdee5d550c986daacfa5"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">cli_sub_parms::like</a></div><div class="ttdeci">regex_t * like</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">res_pjsip_pubsub.c:4148</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a179b9758f096dc75be612d5f4e5f07cc"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">ast_sip_endpoint_id_configuration::self</a></div><div class="ttdeci">struct ast_party_id self</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00629">res_pjsip.h:629</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structcli__sub__complete__parms_html_af86c4ab2ba7f7fd632482bb08625be1a"><div class="ttname"><a href="../../d7/df6/structcli__sub__complete__parms.html#af86c4ab2ba7f7fd632482bb08625be1a">cli_sub_complete_parms::callid</a></div><div class="ttdeci">char * callid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04155">res_pjsip_pubsub.c:4155</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a179323e4f813eab2843f39bbe6efd65e"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">cli_sub_parms::buf</a></div><div class="ttdeci">struct ast_str * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">res_pjsip_pubsub.c:4146</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a23418ae9f5ca7a907263b50b7dcc323d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a></div><div class="ttdeci">static unsigned int cli_subscription_expiry(struct sip_subscription_tree *sub_tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">res_pjsip_pubsub.c:4221</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adae4f7e71c1e215af22111048af6ab93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adae4f7e71c1e215af22111048af6ab93">&#9670;&nbsp;</a></span>cli_list_subscriptions_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_list_subscriptions_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04568">4568</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">cli_list_subscriptions_detail()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">cli_list_subscriptions_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;{</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4732f846f9b6cda02dea380f561ea76a">cli_list_subscriptions_detail</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4732f846f9b6cda02dea380f561ea76a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4732f846f9b6cda02dea380f561ea76a">cli_list_subscriptions_detail</a></div><div class="ttdeci">static int cli_list_subscriptions_detail(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">res_pjsip_pubsub.c:4524</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a636cc42bbb2d876178e506f54bf1d05f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636cc42bbb2d876178e506f54bf1d05f">&#9670;&nbsp;</a></span>cli_list_subscriptions_inout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* cli_list_subscriptions_inout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">4580</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">a</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00160">ast_cli_args::argc</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00161">ast_cli_args::argv</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00046">CLI_FAILURE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00153">CLI_GENERATE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00152">CLI_INIT</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04521">CLI_LIST_SUB_FORMAT_HEADER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04568">cli_list_subscriptions_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04574">cli_list_subscriptions_outbound()</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00045">CLI_SHOWUSAGE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00044">CLI_SUCCESS</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00186">ast_cli_entry::command</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">cli_sub_parms::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">cli_sub_parms::e</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">cli_sub_parms::like</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04138">MAX_REGEX_ERROR_LEN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00948">regex()</a>, and <a class="el" href="../../dc/db0/cli_8h_source.html#l00177">ast_cli_entry::usage</a>.</p>
<div class="fragment"><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;{</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a> on_subscription;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>;</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;   regex_t <a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>;</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>;</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip list subscriptions {inbound|outbound} [like]&quot;</span>;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;               <span class="stringliteral">&quot;   pjsip list subscriptions inbound [like &lt;regex&gt;]\n&quot;</span></div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;               <span class="stringliteral">&quot;      List active inbound subscriptions\n&quot;</span></div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;               <span class="stringliteral">&quot;   pjsip list subscriptions outbound [like &lt;regex&gt;]\n&quot;</span></div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;               <span class="stringliteral">&quot;      List active outbound subscriptions\n&quot;</span></div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;               <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;               <span class="stringliteral">&quot;   The regex selects output lines that match.\n&quot;</span>;</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;   }</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6) {</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;   }</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;inbound&quot;</span>)) {</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#adae4f7e71c1e215af22111048af6ab93">cli_list_subscriptions_inbound</a>;</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;outbound&quot;</span>)) {</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a67b81ad8c54b40786d415a17d1fe9ff7">cli_list_subscriptions_outbound</a>;</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;      <span class="comment">/* Should never get here */</span></div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;   }</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 6) {</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;      <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;      <span class="keywordflow">if</span> (strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;like&quot;</span>)) {</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      }</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;      <span class="comment">/* Setup regular expression */</span></div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;      memset(&amp;like, 0, <span class="keyword">sizeof</span>(like));</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like = &amp;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;      regex = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5];</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;      rc = regcomp(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like, regex, REG_EXTENDED | REG_NOSUB);</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;      <span class="keywordflow">if</span> (rc) {</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;         <span class="keywordtype">char</span> *regerr = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a>);</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;         regerror(rc, <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like, regerr, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a>);</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Regular expression &#39;%s&#39; failed to compile: %s\n&quot;</span>,</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;            regex, regerr);</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      }</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      regex = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;   }</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.a = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.e = <a class="code" href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">e</a>;</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.count = 0;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(256);</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf) {</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like) {</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;         regfree(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like);</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      }</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;   }</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abed51420cb87ea551279a07f2c502a37">CLI_LIST_SUB_FORMAT_HEADER</a>,</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;      <span class="stringliteral">&quot;Endpoint/CLI&quot;</span>, <span class="stringliteral">&quot;Resource/Event&quot;</span>, <span class="stringliteral">&quot;Expiry&quot;</span>, <span class="stringliteral">&quot;Call-id&quot;</span>);</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(on_subscription, &amp;<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>);</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\n%d active subscriptions%s%s%s\n&quot;</span>,</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.count,</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;      regex ? <span class="stringliteral">&quot; matched \&quot;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      regex ?: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;      regex ? <span class="stringliteral">&quot;\&quot;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf);</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like) {</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;      regfree(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like);</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;   }</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;}</div><div class="ttc" id="structcli__sub__parms_html_a883e4c7acb41c38b2fc01a0d80ed83ec"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">cli_sub_parms::e</a></div><div class="ttdeci">struct ast_cli_entry * e</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">res_pjsip_pubsub.c:4142</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abed51420cb87ea551279a07f2c502a37"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abed51420cb87ea551279a07f2c502a37">CLI_LIST_SUB_FORMAT_HEADER</a></div><div class="ttdeci">#define CLI_LIST_SUB_FORMAT_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04521">res_pjsip_pubsub.c:4521</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a67b81ad8c54b40786d415a17d1fe9ff7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a67b81ad8c54b40786d415a17d1fe9ff7">cli_list_subscriptions_outbound</a></div><div class="ttdeci">static int cli_list_subscriptions_outbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04574">res_pjsip_pubsub.c:4574</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a46e524af59f26e0f0825b21acf9ea886"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a></div><div class="ttdeci">#define MAX_REGEX_ERROR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04138">res_pjsip_pubsub.c:4138</a></div></div>
<div class="ttc" id="structcli__sub__parms_html"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04140">res_pjsip_pubsub.c:4140</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0b174b002a4e991ef8c08f17118f8cd5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a></div><div class="ttdeci">int(* on_subscription_t)(struct sip_subscription_tree *sub, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01798">res_pjsip_pubsub.c:1798</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_ab04b09a194737700c43608ca6de2d1c9"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a></div><div class="ttdeci">static struct ast_cli_entry cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d52/codec__dahdi_8c_source.html#l00265">codec_dahdi.c:265</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="cli_8h_html_ae47751901c430ebb833e59291a5e0b3f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a></div><div class="ttdeci">#define CLI_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00046">cli.h:46</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="func__strings_8c_html_a1b62eb9e3ebf087509f4301aa6336931"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a></div><div class="ttdeci">static int regex(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00948">func_strings.c:948</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a417ed811ee3ebdee5d550c986daacfa5"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">cli_sub_parms::like</a></div><div class="ttdeci">regex_t * like</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">res_pjsip_pubsub.c:4148</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_adae4f7e71c1e215af22111048af6ab93"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#adae4f7e71c1e215af22111048af6ab93">cli_list_subscriptions_inbound</a></div><div class="ttdeci">static int cli_list_subscriptions_inbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04568">res_pjsip_pubsub.c:4568</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67b81ad8c54b40786d415a17d1fe9ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b81ad8c54b40786d415a17d1fe9ff7">&#9670;&nbsp;</a></span>cli_list_subscriptions_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_list_subscriptions_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04574">4574</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">AST_SIP_SUBSCRIBER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">cli_list_subscriptions_detail()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">cli_list_subscriptions_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;{</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4732f846f9b6cda02dea380f561ea76a">cli_list_subscriptions_detail</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4732f846f9b6cda02dea380f561ea76a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4732f846f9b6cda02dea380f561ea76a">cli_list_subscriptions_detail</a></div><div class="ttdeci">static int cli_list_subscriptions_detail(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">res_pjsip_pubsub.c:4524</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf8d7453ec67a6a31fa80feffc283128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8d7453ec67a6a31fa80feffc283128">&#9670;&nbsp;</a></span>cli_show_subscription_common()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscription_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *&#160;</td>
          <td class="paramname"><em>cli</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">4235</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00663">ast_str_update()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04155">cli_sub_complete_parms::callid</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">cli_subscription_expiry()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00868">if()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">sip_subscription_to_ami()</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04322">cli_show_subscription_inbound()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04328">cli_show_subscription_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;{</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *callid = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>;<span class="comment">/* Member repurposed to pass in callid */</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;   pj_str_t *sub_callid;</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;   <span class="keywordtype">char</span> *src;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;   <span class="keywordtype">char</span> *dest;</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;   <span class="keywordtype">char</span> *key;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;   <span class="keywordtype">char</span> *value_end;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;   <span class="keywordtype">int</span> key_len;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;   <span class="keywordtype">int</span> key_filler_width;</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;   <span class="keywordtype">int</span> value_len;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;   <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;   }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   sub_callid = &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;   <span class="keywordflow">if</span> (pj_strcmp2(sub_callid, callid)) {</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;   }</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;   <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(512);</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>) {</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;   }</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;      <span class="stringliteral">&quot;%-20s: %s\n&quot;</span></div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      <span class="stringliteral">&quot;===========================================================================\n&quot;</span>,</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      <span class="stringliteral">&quot;ParameterName&quot;</span>, <span class="stringliteral">&quot;ParameterValue&quot;</span>);</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, 0, <span class="stringliteral">&quot;Resource: %s\n&quot;</span>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource);</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, 0, <span class="stringliteral">&quot;Event: %s\n&quot;</span>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, 0, <span class="stringliteral">&quot;Expiry: %u\n&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a>(sub_tree));</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0461ac441d662c000ef9408ab9dd01c">sip_subscription_to_ami</a>(sub_tree, &amp;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;   <span class="comment">/* Convert AMI \r\n to \n line terminators. */</span></div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;   src = strchr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>), <span class="charliteral">&#39;\r&#39;</span>);</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;   <span class="keywordflow">if</span> (src) {</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;      dest = src;</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      ++src;</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      <span class="keywordflow">while</span> (*src) {</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;         <span class="keywordflow">if</span> (*src == <span class="charliteral">&#39;\r&#39;</span>) {</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;            ++src;</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;         }</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;         *dest++ = *src++;</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;      }</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      *dest = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa64825674476f476402283fe4bd7ee51">ast_str_update</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;   }</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;   <span class="comment">/* Reformat AMI key value pairs to pretty columns */</span></div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;   key = <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;      <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = strchr(key, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>) {</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;      }</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      value_end = strchr(<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      <span class="keywordflow">if</span> (!value_end) {</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      }</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      <span class="comment">/* Calculate field lengths */</span></div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      key_len = <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> - key;</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      key_filler_width = 20 - key_len;</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;      <span class="keywordflow">if</span> (key_filler_width &lt; 0) {</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;         key_filler_width = 0;</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;      }</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;      value_len = value_end - <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%.*s%*s%.*s\n&quot;</span>,</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;         key_len, key, key_filler_width, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;         value_len, value);</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;      key = value_end + 1;</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;   } <span class="keywordflow">while</span> (*key);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a33e91cd0cef6786e9e3a27ac67707207"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a></div><div class="ttdeci">if(!yyg-&gt;yy_init)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00868">ast_expr2f.c:868</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae0461ac441d662c000ef9408ab9dd01c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae0461ac441d662c000ef9408ab9dd01c">sip_subscription_to_ami</a></div><div class="ttdeci">static void sip_subscription_to_ami(struct sip_subscription_tree *sub_tree, struct ast_str **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">res_pjsip_pubsub.c:1820</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_ae19846dd61ed50eb0d30e3b8bb915a8f"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">cli_sub_parms::a</a></div><div class="ttdeci">struct ast_cli_args * a</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">res_pjsip_pubsub.c:4144</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="strings_8h_html_aa64825674476f476402283fe4bd7ee51"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa64825674476f476402283fe4bd7ee51">ast_str_update</a></div><div class="ttdeci">void ast_str_update(struct ast_str *buf)</div><div class="ttdoc">Update the length of the buffer, after using ast_str merely as a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00663">strings.h:663</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a179323e4f813eab2843f39bbe6efd65e"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">cli_sub_parms::buf</a></div><div class="ttdeci">struct ast_str * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">res_pjsip_pubsub.c:4146</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a23418ae9f5ca7a907263b50b7dcc323d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a></div><div class="ttdeci">static unsigned int cli_subscription_expiry(struct sip_subscription_tree *sub_tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">res_pjsip_pubsub.c:4221</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66473fb602c745c3dfa226d1c47f425f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66473fb602c745c3dfa226d1c47f425f">&#9670;&nbsp;</a></span>cli_show_subscription_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscription_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04322">4322</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">cli_show_subscription_common()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">cli_show_subscription_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;{</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acf8d7453ec67a6a31fa80feffc283128">cli_show_subscription_common</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acf8d7453ec67a6a31fa80feffc283128"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acf8d7453ec67a6a31fa80feffc283128">cli_show_subscription_common</a></div><div class="ttdeci">static int cli_show_subscription_common(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">res_pjsip_pubsub.c:4235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8a440b205b153f5b7fa6e0be3eb82ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a440b205b153f5b7fa6e0be3eb82ef">&#9670;&nbsp;</a></span>cli_show_subscription_inout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* cli_show_subscription_inout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">4334</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">a</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00160">ast_cli_args::argc</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00161">ast_cli_args::argv</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">cli_complete_subscription_callid()</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00153">CLI_GENERATE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00152">CLI_INIT</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04322">cli_show_subscription_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04328">cli_show_subscription_outbound()</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00045">CLI_SHOWUSAGE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00044">CLI_SUCCESS</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00186">ast_cli_entry::command</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">cli_sub_parms::e</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../dc/db0/cli_8h_source.html#l00177">ast_cli_entry::usage</a>.</p>
<div class="fragment"><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;{</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a> on_subscription;</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip show subscription {inbound|outbound}&quot;</span>;</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;               <span class="stringliteral">&quot;   pjsip show subscription inbound &lt;call-id&gt;\n&quot;</span></div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;               <span class="stringliteral">&quot;   pjsip show subscription outbound &lt;call-id&gt;\n&quot;</span></div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;               <span class="stringliteral">&quot;      Show active subscription with the dialog call-id\n&quot;</span>;</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e4246289d04b68202052414c219922">cli_complete_subscription_callid</a>(a);</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;   }</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 5) {</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;   }</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;inbound&quot;</span>)) {</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a66473fb602c745c3dfa226d1c47f425f">cli_show_subscription_inbound</a>;</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;outbound&quot;</span>)) {</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a539e82113ed22c70c9f62f4d45f15b67">cli_show_subscription_outbound</a>;</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      <span class="comment">/* Should never get here */</span></div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;   }</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;   <span class="comment">/* Find the subscription with the specified call-id */</span></div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.a = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.e = <a class="code" href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">e</a>;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf = (<span class="keywordtype">void</span> *) a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4];<span class="comment">/* Repurpose the buf member to pass in callid */</span></div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(on_subscription, &amp;<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>);</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;}</div><div class="ttc" id="structcli__sub__parms_html_a883e4c7acb41c38b2fc01a0d80ed83ec"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">cli_sub_parms::e</a></div><div class="ttdeci">struct ast_cli_entry * e</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">res_pjsip_pubsub.c:4142</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structcli__sub__parms_html"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04140">res_pjsip_pubsub.c:4140</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0b174b002a4e991ef8c08f17118f8cd5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a></div><div class="ttdeci">int(* on_subscription_t)(struct sip_subscription_tree *sub, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01798">res_pjsip_pubsub.c:1798</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_ab04b09a194737700c43608ca6de2d1c9"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a></div><div class="ttdeci">static struct ast_cli_entry cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d52/codec__dahdi_8c_source.html#l00265">codec_dahdi.c:265</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a47e4246289d04b68202052414c219922"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e4246289d04b68202052414c219922">cli_complete_subscription_callid</a></div><div class="ttdeci">static char * cli_complete_subscription_callid(struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">res_pjsip_pubsub.c:4193</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a539e82113ed22c70c9f62f4d45f15b67"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a539e82113ed22c70c9f62f4d45f15b67">cli_show_subscription_outbound</a></div><div class="ttdeci">static int cli_show_subscription_outbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04328">res_pjsip_pubsub.c:4328</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a66473fb602c745c3dfa226d1c47f425f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a66473fb602c745c3dfa226d1c47f425f">cli_show_subscription_inbound</a></div><div class="ttdeci">static int cli_show_subscription_inbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04322">res_pjsip_pubsub.c:4322</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a539e82113ed22c70c9f62f4d45f15b67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a539e82113ed22c70c9f62f4d45f15b67">&#9670;&nbsp;</a></span>cli_show_subscription_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscription_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04328">4328</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">AST_SIP_SUBSCRIBER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">cli_show_subscription_common()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">cli_show_subscription_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;{</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acf8d7453ec67a6a31fa80feffc283128">cli_show_subscription_common</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acf8d7453ec67a6a31fa80feffc283128"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acf8d7453ec67a6a31fa80feffc283128">cli_show_subscription_common</a></div><div class="ttdeci">static int cli_show_subscription_common(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">res_pjsip_pubsub.c:4235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a082c4ba2ff2ee9753efd0875b7cfaec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082c4ba2ff2ee9753efd0875b7cfaec3">&#9670;&nbsp;</a></span>cli_show_subscriptions_detail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscriptions_detail </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> *&#160;</td>
          <td class="paramname"><em>cli</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">4384</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../dc/dd5/callerid_8c_source.html#l01073">ast_callerid_merge()</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04379">CLI_SHOW_SUB_FORMAT_ENTRY</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">cli_subscription_expiry()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">cli_sub_parms::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">cli_sub_parms::like</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00629">ast_sip_endpoint_id_configuration::self</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04421">cli_show_subscriptions_inbound()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04427">cli_show_subscriptions_outbound()</a>.</p>
<div class="fragment"><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;{</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;   <span class="keywordtype">char</span> caller_id[256];</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;   <span class="keywordtype">char</span> callid[256];</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;   <a class="code" href="../../de/d47/callerid_8h.html#a1c25633b1ed63682c95ec613d7cbe559">ast_callerid_merge</a>(caller_id, <span class="keyword">sizeof</span>(caller_id),</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>,</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;         sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>,</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;         sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>);</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="comment">/* Call-id */</span></div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(callid, &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id, <span class="keyword">sizeof</span>(callid));</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(callid, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>, <span class="keyword">sizeof</span>(callid));</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;   }</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>, 0, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a025e1fa7b644cd3de8f0f7fe4ab42100">CLI_SHOW_SUB_FORMAT_ENTRY</a>,</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>), caller_id,</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>,</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a>(sub_tree), callid);</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;   <span class="keywordflow">if</span> (cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>) {</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      <span class="keywordflow">if</span> (regexec(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>), 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;         <span class="comment">/* Output line did not match the regex */</span></div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      }</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;   }</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">a</a>-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">buf</a>));</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;   ++cli-&gt;<a class="code" href="../../dc/d55/structcli__sub__parms.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;}</div><div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a025e1fa7b644cd3de8f0f7fe4ab42100"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a025e1fa7b644cd3de8f0f7fe4ab42100">CLI_SHOW_SUB_FORMAT_ENTRY</a></div><div class="ttdeci">#define CLI_SHOW_SUB_FORMAT_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04379">res_pjsip_pubsub.c:4379</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="callerid_8h_html_a1c25633b1ed63682c95ec613d7cbe559"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a1c25633b1ed63682c95ec613d7cbe559">ast_callerid_merge</a></div><div class="ttdeci">char * ast_callerid_merge(char *buf, int bufsiz, const char *name, const char *num, const char *unknown)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01073">callerid.c:1073</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_ae19846dd61ed50eb0d30e3b8bb915a8f"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#ae19846dd61ed50eb0d30e3b8bb915a8f">cli_sub_parms::a</a></div><div class="ttdeci">struct ast_cli_args * a</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">res_pjsip_pubsub.c:4144</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#ad43c3812e6d13e0518d9f8b8f463ffcf">cli_sub_parms::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">res_pjsip_pubsub.c:4149</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a417ed811ee3ebdee5d550c986daacfa5"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">cli_sub_parms::like</a></div><div class="ttdeci">regex_t * like</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">res_pjsip_pubsub.c:4148</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a179b9758f096dc75be612d5f4e5f07cc"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">ast_sip_endpoint_id_configuration::self</a></div><div class="ttdeci">struct ast_party_id self</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00629">res_pjsip.h:629</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a179323e4f813eab2843f39bbe6efd65e"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a179323e4f813eab2843f39bbe6efd65e">cli_sub_parms::buf</a></div><div class="ttdeci">struct ast_str * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">res_pjsip_pubsub.c:4146</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a23418ae9f5ca7a907263b50b7dcc323d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a23418ae9f5ca7a907263b50b7dcc323d">cli_subscription_expiry</a></div><div class="ttdeci">static unsigned int cli_subscription_expiry(struct sip_subscription_tree *sub_tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">res_pjsip_pubsub.c:4221</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a89f7ab75ea44a7eb7527943b70a742fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f7ab75ea44a7eb7527943b70a742fc">&#9670;&nbsp;</a></span>cli_show_subscriptions_inbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscriptions_inbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04421">4421</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">cli_show_subscriptions_detail()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">cli_show_subscriptions_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;{</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a082c4ba2ff2ee9753efd0875b7cfaec3">cli_show_subscriptions_detail</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a082c4ba2ff2ee9753efd0875b7cfaec3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a082c4ba2ff2ee9753efd0875b7cfaec3">cli_show_subscriptions_detail</a></div><div class="ttdeci">static int cli_show_subscriptions_detail(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">res_pjsip_pubsub.c:4384</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1bd467902006e27be217191f4f6c793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1bd467902006e27be217191f4f6c793">&#9670;&nbsp;</a></span>cli_show_subscriptions_inout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* cli_show_subscriptions_inout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">4433</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">a</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04144">cli_sub_parms::a</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00160">ast_cli_args::argc</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00161">ast_cli_args::argv</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04146">cli_sub_parms::buf</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00046">CLI_FAILURE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00153">CLI_GENERATE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00152">CLI_INIT</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04374">CLI_SHOW_SUB_FORMAT_HEADER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04421">cli_show_subscriptions_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04427">cli_show_subscriptions_outbound()</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00045">CLI_SHOWUSAGE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00044">CLI_SUCCESS</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00186">ast_cli_entry::command</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04149">cli_sub_parms::count</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">cli_sub_parms::e</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">for_each_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">cli_sub_parms::like</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04138">MAX_REGEX_ERROR_LEN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00948">regex()</a>, and <a class="el" href="../../dc/db0/cli_8h_source.html#l00177">ast_cli_entry::usage</a>.</p>
<div class="fragment"><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;{</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a> on_subscription;</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a> <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>;</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;   regex_t <a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>;</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>;</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip show subscriptions {inbound|outbound} [like]&quot;</span>;</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;               <span class="stringliteral">&quot;   pjsip show subscriptions inbound [like &lt;regex&gt;]\n&quot;</span></div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;               <span class="stringliteral">&quot;      Show active inbound subscriptions\n&quot;</span></div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;               <span class="stringliteral">&quot;   pjsip show subscriptions outbound [like &lt;regex&gt;]\n&quot;</span></div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;               <span class="stringliteral">&quot;      Show active outbound subscriptions\n&quot;</span></div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;               <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;               <span class="stringliteral">&quot;   The regex selects a subscriptions output that matches.\n&quot;</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;               <span class="stringliteral">&quot;   i.e.,  All output lines for a subscription are checked\n&quot;</span></div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;               <span class="stringliteral">&quot;   as a block by the regex.\n&quot;</span>;</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;   }</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6) {</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;   }</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;inbound&quot;</span>)) {</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a89f7ab75ea44a7eb7527943b70a742fc">cli_show_subscriptions_inbound</a>;</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;outbound&quot;</span>)) {</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      on_subscription = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a161e2b74b0b3b249c8c9e3ba8bb782ae">cli_show_subscriptions_outbound</a>;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      <span class="comment">/* Should never get here */</span></div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;   }</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 6) {</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      <span class="keywordflow">if</span> (strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;like&quot;</span>)) {</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      }</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      <span class="comment">/* Setup regular expression */</span></div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;      memset(&amp;like, 0, <span class="keyword">sizeof</span>(like));</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like = &amp;<a class="code" href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">like</a>;</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      regex = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5];</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;      rc = regcomp(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like, regex, REG_EXTENDED | REG_NOSUB);</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      <span class="keywordflow">if</span> (rc) {</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;         <span class="keywordtype">char</span> *regerr = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a>);</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;         regerror(rc, <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like, regerr, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a>);</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Regular expression &#39;%s&#39; failed to compile: %s\n&quot;</span>,</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;            regex, regerr);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;      }</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      regex = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;   }</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.a = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.e = <a class="code" href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">e</a>;</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.count = 0;</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(256);</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf) {</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like) {</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;         regfree(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like);</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;      }</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;   }</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2da91e964cff994ce0e57b494316b043">CLI_SHOW_SUB_FORMAT_HEADER</a>);</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a>(on_subscription, &amp;<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>);</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%d active subscriptions%s%s%s\n&quot;</span>,</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.count,</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      regex ? <span class="stringliteral">&quot; matched \&quot;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      regex ?: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      regex ? <span class="stringliteral">&quot;\&quot;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.buf);</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like) {</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      regfree(<a class="code" href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a>.like);</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;   }</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;}</div><div class="ttc" id="structcli__sub__parms_html_a883e4c7acb41c38b2fc01a0d80ed83ec"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a883e4c7acb41c38b2fc01a0d80ed83ec">cli_sub_parms::e</a></div><div class="ttdeci">struct ast_cli_entry * e</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04142">res_pjsip_pubsub.c:4142</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a161e2b74b0b3b249c8c9e3ba8bb782ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a161e2b74b0b3b249c8c9e3ba8bb782ae">cli_show_subscriptions_outbound</a></div><div class="ttdeci">static int cli_show_subscriptions_outbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04427">res_pjsip_pubsub.c:4427</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a46e524af59f26e0f0825b21acf9ea886"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a46e524af59f26e0f0825b21acf9ea886">MAX_REGEX_ERROR_LEN</a></div><div class="ttdeci">#define MAX_REGEX_ERROR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04138">res_pjsip_pubsub.c:4138</a></div></div>
<div class="ttc" id="structcli__sub__parms_html"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html">cli_sub_parms</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04140">res_pjsip_pubsub.c:4140</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac952acea83472c9c285fe203a5b62ce3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac952acea83472c9c285fe203a5b62ce3">for_each_subscription</a></div><div class="ttdeci">static int for_each_subscription(on_subscription_t on_subscription, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">res_pjsip_pubsub.c:1800</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2da91e964cff994ce0e57b494316b043"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2da91e964cff994ce0e57b494316b043">CLI_SHOW_SUB_FORMAT_HEADER</a></div><div class="ttdeci">#define CLI_SHOW_SUB_FORMAT_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04374">res_pjsip_pubsub.c:4374</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0b174b002a4e991ef8c08f17118f8cd5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a></div><div class="ttdeci">int(* on_subscription_t)(struct sip_subscription_tree *sub, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01798">res_pjsip_pubsub.c:1798</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_ab04b09a194737700c43608ca6de2d1c9"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#ab04b09a194737700c43608ca6de2d1c9">cli</a></div><div class="ttdeci">static struct ast_cli_entry cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d52/codec__dahdi_8c_source.html#l00265">codec_dahdi.c:265</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="cli_8h_html_ae47751901c430ebb833e59291a5e0b3f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a></div><div class="ttdeci">#define CLI_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00046">cli.h:46</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="func__strings_8c_html_a1b62eb9e3ebf087509f4301aa6336931"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a></div><div class="ttdeci">static int regex(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00948">func_strings.c:948</a></div></div>
<div class="ttc" id="structcli__sub__parms_html_a417ed811ee3ebdee5d550c986daacfa5"><div class="ttname"><a href="../../dc/d55/structcli__sub__parms.html#a417ed811ee3ebdee5d550c986daacfa5">cli_sub_parms::like</a></div><div class="ttdeci">regex_t * like</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04148">res_pjsip_pubsub.c:4148</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a89f7ab75ea44a7eb7527943b70a742fc"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a89f7ab75ea44a7eb7527943b70a742fc">cli_show_subscriptions_inbound</a></div><div class="ttdeci">static int cli_show_subscriptions_inbound(struct sip_subscription_tree *sub_tree, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04421">res_pjsip_pubsub.c:4421</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a161e2b74b0b3b249c8c9e3ba8bb782ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a161e2b74b0b3b249c8c9e3ba8bb782ae">&#9670;&nbsp;</a></span>cli_show_subscriptions_outbound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cli_show_subscriptions_outbound </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04427">4427</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">AST_SIP_SUBSCRIBER</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">cli_show_subscriptions_detail()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">cli_show_subscriptions_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;{</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;   <span class="keywordflow">return</span> sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> == <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;      ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a082c4ba2ff2ee9753efd0875b7cfaec3">cli_show_subscriptions_detail</a>(sub_tree, arg) : 0;</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a082c4ba2ff2ee9753efd0875b7cfaec3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a082c4ba2ff2ee9753efd0875b7cfaec3">cli_show_subscriptions_detail</a></div><div class="ttdeci">static int cli_show_subscriptions_detail(struct sip_subscription_tree *sub_tree, struct cli_sub_parms *cli)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">res_pjsip_pubsub.c:4384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23418ae9f5ca7a907263b50b7dcc323d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23418ae9f5ca7a907263b50b7dcc323d">&#9670;&nbsp;</a></span>cli_subscription_expiry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int cli_subscription_expiry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04221">4221</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04524">cli_list_subscriptions_detail()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">cli_show_subscription_common()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04384">cli_show_subscriptions_detail()</a>.</p>
<div class="fragment"><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;{</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;   <span class="keywordtype">int</span> expiry;</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;   expiry = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a></div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      ? <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>, <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>()) / 1000</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      : 0;</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;   <span class="keywordflow">if</span> (expiry &lt; 0) {</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="comment">/* Subscription expired */</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;      expiry = 0;</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;   }</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;   <span class="keywordflow">return</span> expiry;</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;}</div><div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac79436df96e320a3107e5e8dfb3e9720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac79436df96e320a3107e5e8dfb3e9720">&#9670;&nbsp;</a></span>create_multipart_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_msg_body* create_multipart_body </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create and initialize the PJSIP multipart body structure for a resource list subscription. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The multipart message body </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02291">2291</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d48/strings_8c_source.html#l00227">ast_generate_random_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">generate_list_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;{</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;   pjsip_media_type <a class="code" href="../../d1/d94/sip_8h.html#a99c5ff7e5199a13ca4884062b413d68f">media_type</a>;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;   pjsip_param *media_type_param;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;   <span class="keywordtype">char</span> boundary[6];</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   pj_str_t pj_boundary;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   pjsip_media_type_init2(&amp;media_type, <span class="stringliteral">&quot;multipart&quot;</span>, <span class="stringliteral">&quot;related&quot;</span>);</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   media_type_param = pj_pool_alloc(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, <span class="keyword">sizeof</span>(*media_type_param));</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   pj_list_init(media_type_param);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;media_type_param-&gt;name, <span class="stringliteral">&quot;type&quot;</span>);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;media_type_param-&gt;value, <span class="stringliteral">&quot;\&quot;application/rlmi+xml\&quot;&quot;</span>);</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;   pj_list_insert_before(&amp;media_type.param, media_type_param);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;   pj_cstr(&amp;pj_boundary, <a class="code" href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a>(boundary, <span class="keyword">sizeof</span>(boundary)));</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;   <span class="keywordflow">return</span> pjsip_multipart_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;media_type, &amp;pj_boundary);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;}</div><div class="ttc" id="sip_8h_html_a99c5ff7e5199a13ca4884062b413d68f"><div class="ttname"><a href="../../d1/d94/sip_8h.html#a99c5ff7e5199a13ca4884062b413d68f">media_type</a></div><div class="ttdeci">media_type</div><div class="ttdoc">Media types generate different &quot;dummy answers&quot; for not accepting the offer of a media stream...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/sip_8h_source.html#l00489">sip.h:489</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="strings_8h_html_ab2c8e1bf4b2b01a1ffabf882774907bb"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a></div><div class="ttdeci">char * ast_generate_random_string(char *buf, size_t size)</div><div class="ttdoc">Create a pseudo-random string of a fixed length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00227">strings.c:227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad353ed8aab9f1e54ccf8d2e89a96bcac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad353ed8aab9f1e54ccf8d2e89a96bcac">&#9670;&nbsp;</a></span>create_require_eventlist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_require_hdr* create_require_eventlist </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shortcut method to create a Require: eventlist header. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">2404</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">sip_subscription_accept()</a>.</p>
<div class="fragment"><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;{</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   pjsip_require_hdr *require;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   require = pjsip_require_hdr_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;require-&gt;values[0], <span class="stringliteral">&quot;eventlist&quot;</span>);</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;   require-&gt;count = 1;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;   <span class="keywordflow">return</span> require;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;}</div><div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31880cde88a125b5079ac946cc352603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31880cde88a125b5079ac946cc352603">&#9670;&nbsp;</a></span>create_resource_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a>* create_resource_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>list_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>allocate a resource list, store it in sorcery, and set its details </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test</td><td>The unit test. Used for logging status messages. </td></tr>
    <tr><td class="paramname">list_name</td><td>The name of the list to create. </td></tr>
    <tr><td class="paramname">event</td><td>The event the list services </td></tr>
    <tr><td class="paramname">resources</td><td>Array of resources to apply to the list </td></tr>
    <tr><td class="paramname">num_resources</td><td>The number of resources in the array </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to allocate or populate list </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The created list </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">4983</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01744">ast_sorcery_alloc()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">cleanup_resource_list()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04942">populate_list()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;{</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list;</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;   list = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;resource_list&quot;</span>, list_name);</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Could not allocate resource list in sorcery\n&quot;</span>);</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;   }</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), list)) {</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Could not store the resource list in sorcery\n&quot;</span>);</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(list);</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;   }</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abb2474471fcc9b7191d508cf1b407417">populate_list</a>(list, <a class="code" href="../../df/d7d/structevent.html">event</a>, resources, num_resources)) {</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Could not add resources to the resource list\n&quot;</span>);</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a>(list);</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;   }</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;   <span class="keywordflow">return</span> list;</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;}</div><div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a30a0d1004e7965d66f03d5a12645e81b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a30a0d1004e7965d66f03d5a12645e81b">cleanup_resource_list</a></div><div class="ttdeci">static void cleanup_resource_list(struct resource_list *list)</div><div class="ttdoc">RAII callback to destroy a resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04962">res_pjsip_pubsub.c:4962</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abb2474471fcc9b7191d508cf1b407417"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abb2474471fcc9b7191d508cf1b407417">populate_list</a></div><div class="ttdeci">static int populate_list(struct resource_list *list, const char *event, const char **resources, size_t num_resources)</div><div class="ttdoc">Set properties on an allocated resource list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04942">res_pjsip_pubsub.c:4942</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a006316bcef76ef13dc1cc99560fbaa86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a006316bcef76ef13dc1cc99560fbaa86">&#9670;&nbsp;</a></span>create_subscription_tree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a>* create_subscription_tree </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td>
          <td class="paramname"><em>generator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_status_t *&#160;</td>
          <td class="paramname"><em>dlg_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *&#160;</td>
          <td class="paramname"><em>persistence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a subscription tree based on a resource tree. </p>
<p>Using the previously-determined valid resources in the provided resource tree, a corresponding tree of ast_sip_subscriptions are created. The root of the subscription tree is a real subscription, and the rest in the tree are virtual subscriptions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The handler to use for leaf subscriptions </td></tr>
    <tr><td class="paramname">endpoint</td><td>The endpoint that sent the SUBSCRIBE request </td></tr>
    <tr><td class="paramname">rdata</td><td>The SUBSCRIBE content </td></tr>
    <tr><td class="paramname">resource</td><td>The requested resource in the SUBSCRIBE request </td></tr>
    <tr><td class="paramname">generator</td><td>The body generator to use in leaf subscriptions </td></tr>
    <tr><td class="paramname">tree</td><td>The resource tree on which the subscription tree is based </td></tr>
    <tr><td class="paramname">dlg_status[out]</td><td>The result of attempting to create a dialog.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Could not create the subscription tree </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The root of the created subscription tree </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">1465</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01175">add_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04249">ast_sip_create_dialog_uas_locked()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02638">ast_sip_mod_data_get</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02670">ast_sip_mod_data_set</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">AST_SIP_NOTIFIER</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">create_virtual_subscriptions()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00388">subscription_persistence::cseq</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">sip_subscription_tree::is_list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00236">MOD_DATA_MSG</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">MOD_DATA_PERSISTENCE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">sip_subscription_tree::notification_batch_interval</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01097">resource_tree::notification_batch_interval</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00549">pubsub_cb</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">resource_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">subscription_setup_dialog()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;{</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   pjsip_dialog *<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   sub_tree = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae855491c1f2f6714df5daa3fd69a10df">allocate_subscription_tree</a>(endpoint, rdata);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;   <span class="keywordflow">if</span> (!sub_tree) {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      *dlg_status = PJ_ENOMEM;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a> = <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a>;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   dlg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9d885d67aea1a6b3419ea96692cd2527">ast_sip_create_dialog_uas_locked</a>(endpoint, rdata, dlg_status);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;   <span class="keywordflow">if</span> (!dlg) {</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <span class="keywordflow">if</span> (*dlg_status != PJ_EEXISTS) {</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create dialog for SIP subscription\n&quot;</span>);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      }</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   persistence = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a>(rdata-&gt;endpt_info.mod_data,</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a>);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <span class="keywordflow">if</span> (persistence) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">/* Update the created dialog with the persisted information */</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      pjsip_ua_unregister_dlg(pjsip_ua_instance(), dlg);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      pj_strdup2(dlg-&gt;pool, &amp;dlg-&gt;local.info-&gt;tag, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      dlg-&gt;local.tag_hval = pj_hash_calc_tolower(0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;dlg-&gt;local.info-&gt;tag);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      pjsip_ua_register_dlg(pjsip_ua_instance(), dlg);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      dlg-&gt;local.cseq = persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#aa6f63c8aefae8e2f51a65f61d724aacf">cseq</a>;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   pjsip_evsub_create_uas(dlg, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d62301cf52b6bc6d7b66cea60bee8cc">pubsub_cb</a>, rdata, 0, &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acc8db1e0ce416bc7a5a05275db0cb8a7">subscription_setup_dialog</a>(sub_tree, dlg);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">    * The evsub and subscription setup both add dialog refs, so the dialog ref that</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">    * was added when the dialog was created (see ast_sip_create_dialog_uas_lock) can</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">    * now be removed. The lock should no longer be needed so can be removed too.</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;   pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_EVSUB_GRP_LOCK</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   pjsip_evsub_add_ref(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a>(dlg-&gt;pool, dlg-&gt;mod_data, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab95c1bf11412f8e2a82ddd0eb69ad4a4">MOD_DATA_MSG</a>,</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;         pjsip_msg_clone(dlg-&gt;pool, rdata-&gt;msg_info.msg));</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">notification_batch_interval</a> = tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#ac90516981222dda0270465a33483f2b4">notification_batch_interval</a>;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   <span class="comment">/* Persistence information needs to be available for all the subscriptions */</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(persistence);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad45e6800f846deafb7b108ee3107b22a">create_virtual_subscriptions</a>(handler, resource, generator, sub_tree, tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;children) &gt; 0) {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">is_list</a> = 1;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;   }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8ebc5adf3564428c0201cff2376dd187">add_subscription</a>(sub_tree);</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;   <span class="keywordflow">return</span> sub_tree;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8ebc5adf3564428c0201cff2376dd187"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8ebc5adf3564428c0201cff2376dd187">add_subscription</a></div><div class="ttdeci">static void add_subscription(struct sip_subscription_tree *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01175">res_pjsip_pubsub.c:1175</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structresource__tree_html_a2dce9d43da01d556f3a1d694d03a40a9"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">resource_tree::root</a></div><div class="ttdeci">struct tree_node * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">res_pjsip_pubsub.c:1096</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7d62301cf52b6bc6d7b66cea60bee8cc"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7d62301cf52b6bc6d7b66cea60bee8cc">pubsub_cb</a></div><div class="ttdeci">static pjsip_evsub_user pubsub_cb</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00549">res_pjsip_pubsub.c:549</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9e1f9ef9caffc6fcf306dbf678ecc747"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">sip_subscription_tree::is_list</a></div><div class="ttdeci">int is_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">res_pjsip_pubsub.c:453</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="structresource__tree_html_ac90516981222dda0270465a33483f2b4"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html#ac90516981222dda0270465a33483f2b4">resource_tree::notification_batch_interval</a></div><div class="ttdeci">unsigned int notification_batch_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01097">res_pjsip_pubsub.c:1097</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9937f98867d28da0cc0e8590d9c9ffa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a></div><div class="ttdeci">#define ast_sip_mod_data_set(pool, mod_data, id, key, val)</div><div class="ttdoc">Utilizing a mod_data array for a given id, set the value associated with the given key...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02670">res_pjsip.h:2670</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_aa6f63c8aefae8e2f51a65f61d724aacf"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#aa6f63c8aefae8e2f51a65f61d724aacf">subscription_persistence::cseq</a></div><div class="ttdeci">unsigned int cseq</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00388">res_pjsip_pubsub.c:388</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aad194ead974937834375b0ac8d37a7c2"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a></div><div class="ttdeci">#define ast_sip_mod_data_get(mod_data, id, key)</div><div class="ttdoc">Using the dictionary stored in mod_data array at a given id, retrieve the value associated with the g...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02638">res_pjsip.h:2638</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acc8db1e0ce416bc7a5a05275db0cb8a7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acc8db1e0ce416bc7a5a05275db0cb8a7">subscription_setup_dialog</a></div><div class="ttdeci">static void subscription_setup_dialog(struct sip_subscription_tree *sub_tree, pjsip_dialog *dlg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">res_pjsip_pubsub.c:1396</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9d885d67aea1a6b3419ea96692cd2527"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9d885d67aea1a6b3419ea96692cd2527">ast_sip_create_dialog_uas_locked</a></div><div class="ttdeci">pjsip_dialog * ast_sip_create_dialog_uas_locked(const struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, pj_status_t *status)</div><div class="ttdoc">General purpose method for creating a UAS dialog with an endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04249">res_pjsip.c:4249</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad45e6800f846deafb7b108ee3107b22a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad45e6800f846deafb7b108ee3107b22a">create_virtual_subscriptions</a></div><div class="ttdeci">static struct ast_sip_subscription * create_virtual_subscriptions(const struct ast_sip_subscription_handler *handler, const char *resource, struct ast_sip_pubsub_body_generator *generator, struct sip_subscription_tree *tree, struct tree_node *current)</div><div class="ttdoc">Create a tree of virtual subscriptions based on a resource tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">res_pjsip_pubsub.c:1286</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac90516981222dda0270465a33483f2b4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">sip_subscription_tree::notification_batch_interval</a></div><div class="ttdeci">unsigned int notification_batch_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">res_pjsip_pubsub.c:445</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad9ab4b2e3c02b132f457ec3e61d5d47d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a></div><div class="ttdeci">#define MOD_DATA_PERSISTENCE</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">res_pjsip_pubsub.c:235</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae855491c1f2f6714df5daa3fd69a10df"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae855491c1f2f6714df5daa3fd69a10df">allocate_subscription_tree</a></div><div class="ttdeci">static struct sip_subscription_tree * allocate_subscription_tree(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">res_pjsip_pubsub.c:1405</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab95c1bf11412f8e2a82ddd0eb69ad4a4"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab95c1bf11412f8e2a82ddd0eb69ad4a4">MOD_DATA_MSG</a></div><div class="ttdeci">#define MOD_DATA_MSG</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00236">res_pjsip_pubsub.c:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad45e6800f846deafb7b108ee3107b22a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad45e6800f846deafb7b108ee3107b22a">&#9670;&nbsp;</a></span>create_virtual_subscriptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a>* create_virtual_subscriptions </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *&#160;</td>
          <td class="paramname"><em>generator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *&#160;</td>
          <td class="paramname"><em>current</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a tree of virtual subscriptions based on a resource tree node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The handler to supply to leaf subscriptions. </td></tr>
    <tr><td class="paramname">resource</td><td>The requested resource for this subscription. </td></tr>
    <tr><td class="paramname">generator</td><td>Body generator to use for leaf subscriptions. </td></tr>
    <tr><td class="paramname">tree</td><td>The root of the subscription tree. </td></tr>
    <tr><td class="paramname">current</td><td>The tree node that corresponds to the subscription being created. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">1286</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">allocate_subscription()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">ast_sip_subscription::body_generator</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">destroy_subscription()</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00359">generator</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;{</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   sub = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa70a279b186df17b611eabf8164c396c">allocate_subscription</a>(handler, resource, tree);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   sub-&gt;full_state = current-&gt;full_state;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">body_generator</a> = <a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;sub-&gt;children, <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;current-&gt;children));</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;current-&gt;children); ++i) {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *child;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d6/d14/structtree__node.html">tree_node</a> *child_node = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;current-&gt;children, i);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      child = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad45e6800f846deafb7b108ee3107b22a">create_virtual_subscriptions</a>(handler, child_node-&gt;resource, generator,</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            tree, child_node);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">if</span> (!child) {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Child subscription to resource %s could not be created\n&quot;</span>,</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;               child_node-&gt;resource);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;sub-&gt;children, child)) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Child subscription to resource %s could not be appended\n&quot;</span>,</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;               child_node-&gt;resource);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a>(child);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;         <span class="comment">/* Have to release tree here too because a ref was added</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">          * to child that destroy_subscription() doesn&#39;t release. */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(tree);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   }</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structtree__node_html"><div class="ttname"><a href="../../d6/d14/structtree__node.html">tree_node</a></div><div class="ttdoc">A node for a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00888">res_pjsip_pubsub.c:888</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4b57472ac293cbff3de8eb58471771f0"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4b57472ac293cbff3de8eb58471771f0">ast_sip_subscription::body_generator</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator * body_generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00485">res_pjsip_pubsub.c:485</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="structast__sip__subscription_html"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></div><div class="ttdoc">Structure representing a &quot;virtual&quot; SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00477">res_pjsip_pubsub.c:477</a></div></div>
<div class="ttc" id="app__fax_8c_html_a36aeb2eb01afb248bad64a309d743636"><div class="ttname"><a href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a></div><div class="ttdeci">static struct ast_generator generator</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dde/app__fax_8c_source.html#l00359">app_fax.c:359</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad45e6800f846deafb7b108ee3107b22a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad45e6800f846deafb7b108ee3107b22a">create_virtual_subscriptions</a></div><div class="ttdeci">static struct ast_sip_subscription * create_virtual_subscriptions(const struct ast_sip_subscription_handler *handler, const char *resource, struct ast_sip_pubsub_body_generator *generator, struct sip_subscription_tree *tree, struct tree_node *current)</div><div class="ttdoc">Create a tree of virtual subscriptions based on a resource tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">res_pjsip_pubsub.c:1286</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa70a279b186df17b611eabf8164c396c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa70a279b186df17b611eabf8164c396c">allocate_subscription</a></div><div class="ttdeci">static struct ast_sip_subscription * allocate_subscription(const struct ast_sip_subscription_handler *handler, const char *resource, struct sip_subscription_tree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">res_pjsip_pubsub.c:1233</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abcc2b6e9a594e068ec58be82446b15fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a></div><div class="ttdeci">static void destroy_subscription(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">res_pjsip_pubsub.c:1201</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abcc2b6e9a594e068ec58be82446b15fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcc2b6e9a594e068ec58be82446b15fa">&#9670;&nbsp;</a></span>destroy_subscription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void destroy_subscription </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">1201</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">ast_sip_subscription::datastores</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">ast_sip_subscription::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01233">allocate_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01286">create_virtual_subscriptions()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01215">destroy_subscriptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;{</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Destroying SIP subscription from &#39;%s-&gt;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a> &amp;&amp; sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> ? <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) : <span class="stringliteral">&quot;Unknown&quot;</span>,</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      sub-&gt;resource);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub-&gt;body_text);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;sub-&gt;children);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(sub-&gt;persistence_data);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a1f889c1c1ee1ab4174d6b34771d6951d"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a1f889c1c1ee1ab4174d6b34771d6951d">ast_sip_subscription::tree</a></div><div class="ttdeci">struct sip_subscription_tree * tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00483">res_pjsip_pubsub.c:483</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_subscription::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00479">res_pjsip_pubsub.c:479</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c090850897d5a72420ff3446fe74440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c090850897d5a72420ff3446fe74440">&#9670;&nbsp;</a></span>destroy_subscriptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void destroy_subscriptions </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>root</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01215">1215</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">destroy_subscription()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">subscription_tree_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;{</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   <span class="keywordflow">if</span> (!root) {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;root-&gt;children); ++i) {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *child;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      child = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;root-&gt;children, i);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8c090850897d5a72420ff3446fe74440">destroy_subscriptions</a>(child);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a>(root);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a8c090850897d5a72420ff3446fe74440"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8c090850897d5a72420ff3446fe74440">destroy_subscriptions</a></div><div class="ttdeci">static void destroy_subscriptions(struct ast_sip_subscription *root)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01215">res_pjsip_pubsub.c:1215</a></div></div>
<div class="ttc" id="structast__sip__subscription_html"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></div><div class="ttdoc">Structure representing a &quot;virtual&quot; SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00477">res_pjsip_pubsub.c:477</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abcc2b6e9a594e068ec58be82446b15fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abcc2b6e9a594e068ec58be82446b15fa">destroy_subscription</a></div><div class="ttdeci">static void destroy_subscription(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01201">res_pjsip_pubsub.c:1201</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4c0e99b92215cdc4a96b439c108cd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c0e99b92215cdc4a96b439c108cd0a">&#9670;&nbsp;</a></span>determine_sip_publish_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a> determine_sip_publish_type </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_generic_string_hdr *&#160;</td>
          <td class="paramname"><em>etag_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>expires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>entity_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03102">3102</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">DEFAULT_PUBLISH_EXPIRES</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00285">SIP_PUBLISH_INITIAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00305">SIP_PUBLISH_MODIFY</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00295">SIP_PUBLISH_REFRESH</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00314">SIP_PUBLISH_REMOVE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00274">SIP_PUBLISH_UNKNOWN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;{</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   pjsip_expires_hdr *expires_hdr = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_EXPIRES, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   <span class="keywordflow">if</span> (etag_hdr) {</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordtype">char</span> etag[pj_strlen(&amp;etag_hdr-&gt;hvalue) + 1];</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(etag, &amp;etag_hdr-&gt;hvalue, <span class="keyword">sizeof</span>(etag));</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      <span class="keywordflow">if</span> (sscanf(etag, <span class="stringliteral">&quot;%30d&quot;</span>, entity_id) != 1) {</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      }</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;   }</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;   *expires = expires_hdr ? expires_hdr-&gt;ivalue : <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a>;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;   <span class="keywordflow">if</span> (!(*expires)) {</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a>;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!etag_hdr &amp;&amp; rdata-&gt;msg_info.msg-&gt;body) {</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (etag_hdr &amp;&amp; !rdata-&gt;msg_info.msg-&gt;body) {</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a>;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (etag_hdr &amp;&amp; rdata-&gt;msg_info.msg-&gt;body) {</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;   }</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a4d530a1f675151206b5929a37a882fe2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a></div><div class="ttdeci">#define DEFAULT_PUBLISH_EXPIRES</div><div class="ttdoc">Default expiration time for PUBLISH if one is not specified. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">res_pjsip_pubsub.c:247</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a></div><div class="ttdoc">Unknown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00274">res_pjsip_pubsub.c:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a></div><div class="ttdoc">Refresh. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00295">res_pjsip_pubsub.c:295</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a></div><div class="ttdoc">Modify. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00305">res_pjsip_pubsub.c:305</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a></div><div class="ttdoc">Initial. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00285">res_pjsip_pubsub.c:285</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a></div><div class="ttdoc">Remove. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00314">res_pjsip_pubsub.c:314</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37e5c81dbce6f5db2f91dbe92689ec2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e5c81dbce6f5db2f91dbe92689ec2f">&#9670;&nbsp;</a></span>exceptional_accept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int exceptional_accept </td>
          <td>(</td>
          <td class="paramtype">const pj_str_t *&#160;</td>
          <td class="paramname"><em>accept</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the Accept header from the SUBSCRIBE in the list of exceptions? </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>This Accept header value is an exception to the rule. </td></tr>
    <tr><td class="paramname">0</td><td>This Accept header is not an exception to the rule. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00817">817</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00806">accept_exceptions</a>, and <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">subscription_get_generator_from_rdata()</a>.</p>
<div class="fragment"><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;{</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af83103f48a2651972c0fc351bfd701bb">accept_exceptions</a>); ++i) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> (!pj_strcmp2(accept, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af83103f48a2651972c0fc351bfd701bb">accept_exceptions</a>[i])) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_af83103f48a2651972c0fc351bfd701bb"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#af83103f48a2651972c0fc351bfd701bb">accept_exceptions</a></div><div class="ttdeci">const char * accept_exceptions[]</div><div class="ttdoc">Accept headers that are exceptions to the rule. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00806">res_pjsip_pubsub.c:806</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa43549aaa8be02c39bd1e405f44d27f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa43549aaa8be02c39bd1e405f44d27f1">&#9670;&nbsp;</a></span>find_body_generator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> * find_body_generator </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>accept</em>[AST_SIP_MAX_ACCEPT][64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_accept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>body_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02862">2862</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00603">ast_sip_pubsub_body_generator::body_type</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02849">find_body_generator_accept()</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00359">generator</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">ast_sip_pubsub_body_generator::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">subscription_get_generator_from_rdata()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">subscription_persistence_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;{</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; num_accept; ++i) {</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      generator = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a495d318729babacd6785c241fcdf845a">find_body_generator_accept</a>(accept[i]);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordflow">if</span> (generator) {</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Body generator %p found for accept type %s\n&quot;</span>, generator, accept[i]);</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;         <span class="keywordflow">if</span> (strcmp(generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>)) {</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Body generator &#39;%s/%s&#39;(%p) does not accept the type of data this event generates\n&quot;</span>,</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                  generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, generator-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>, generator);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;            generator = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;         }</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;No body generator found for accept type %s\n&quot;</span>, accept[i]);</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      }</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;   }</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;}</div><div class="ttc" id="structast__sip__pubsub__body__generator_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_pubsub_body_generator::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00603">res_pjsip_pubsub.h:603</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_generator::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">res_pjsip_pubsub.h:596</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a495d318729babacd6785c241fcdf845a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a495d318729babacd6785c241fcdf845a">find_body_generator_accept</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_accept(const char *accept)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02849">res_pjsip_pubsub.c:2849</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
<div class="ttc" id="app__fax_8c_html_a36aeb2eb01afb248bad64a309d743636"><div class="ttname"><a href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a></div><div class="ttdeci">static struct ast_generator generator</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dde/app__fax_8c_source.html#l00359">app_fax.c:359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a495d318729babacd6785c241fcdf845a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495d318729babacd6785c241fcdf845a">&#9670;&nbsp;</a></span>find_body_generator_accept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a>* find_body_generator_accept </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>accept</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02849">2849</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">find_body_generator_type_subtype()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02862">find_body_generator()</a>.</p>
<div class="fragment"><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;{</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   <span class="keywordtype">char</span> *accept_copy = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(accept);</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a> = accept_copy;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;subtype, <span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(type) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(subtype)) {</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;   }</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a>(type, subtype);</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5df18a3e8742e6bd4e6917b459c4c82d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5df18a3e8742e6bd4e6917b459c4c82d">find_body_generator_type_subtype</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_type_subtype(const char *type, const char *subtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">res_pjsip_pubsub.c:2839</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5df18a3e8742e6bd4e6917b459c4c82d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5df18a3e8742e6bd4e6917b459c4c82d">&#9670;&nbsp;</a></span>find_body_generator_type_subtype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a>* find_body_generator_type_subtype </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">2839</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02825">find_body_generator_type_subtype_nolock()</a>, and <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00297">gen</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">ast_sip_pubsub_generate_body_content()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03435">ast_sip_pubsub_is_body_generator_registered()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02849">find_body_generator_accept()</a>.</p>
<div class="fragment"><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;{</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a>;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   gen = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3d0a8fc757c1fb1e064887580d4ba1ea">find_body_generator_type_subtype_nolock</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>);</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a>;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3d0a8fc757c1fb1e064887580d4ba1ea"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3d0a8fc757c1fb1e064887580d4ba1ea">find_body_generator_type_subtype_nolock</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator_type_subtype_nolock(const char *type, const char *subtype)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02825">res_pjsip_pubsub.c:2825</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structbody__generators_html"><div class="ttname"><a href="../../dd/de0/structbody__generators.html">body_generators</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00536">res_pjsip_pubsub.c:536</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="app__externalivr_8c_html_abe143f1bae4445e9b3798e1dec3bda60"><div class="ttname"><a href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a></div><div class="ttdeci">static struct ast_generator gen</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/app__externalivr_8c_source.html#l00297">app_externalivr.c:297</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d0a8fc757c1fb1e064887580d4ba1ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d0a8fc757c1fb1e064887580d4ba1ea">&#9670;&nbsp;</a></span>find_body_generator_type_subtype_nolock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a>* find_body_generator_type_subtype_nolock </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02825">2825</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00297">gen</a>, <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">ast_sip_pubsub_body_generator::subtype</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">ast_sip_pubsub_body_generator::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03440">ast_sip_pubsub_register_body_generator()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02839">find_body_generator_type_subtype()</a>.</p>
<div class="fragment"><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;{</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a>;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/de0/structbody__generators.html">body_generators</a>, gen, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">list</a>) {</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">if</span> (!strcmp(gen-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;         &amp;&amp; !strcmp(gen-&gt;<a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>, <a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a>)) {</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      }</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;   }</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a>;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_pubsub_body_generator::type</a></div><div class="ttdeci">const char * type</div><div class="ttdoc">Content type In &quot;plain/text&quot;, &quot;plain&quot; is the type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00596">res_pjsip_pubsub.h:596</a></div></div>
<div class="ttc" id="structbody__generators_html"><div class="ttname"><a href="../../dd/de0/structbody__generators.html">body_generators</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00536">res_pjsip_pubsub.c:536</a></div></div>
<div class="ttc" id="app__externalivr_8c_html_abe143f1bae4445e9b3798e1dec3bda60"><div class="ttname"><a href="../../de/d26/app__externalivr_8c.html#abe143f1bae4445e9b3798e1dec3bda60">gen</a></div><div class="ttdeci">static struct ast_generator gen</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/app__externalivr_8c_source.html#l00297">app_externalivr.c:297</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_pubsub_body_generator::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdoc">Content subtype In &quot;plain/text&quot;, &quot;text&quot; is the subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00601">res_pjsip_pubsub.h:601</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html_af820db3728fdeafb6d1c8ff284ea6cc5"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html#af820db3728fdeafb6d1c8ff284ea6cc5">ast_sip_pubsub_body_generator::list</a></div><div class="ttdeci">struct ast_sip_pubsub_body_generator::@306 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52a5833004176713878b9cbf3c311ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a5833004176713878b9cbf3c311ec0">&#9670;&nbsp;</a></span>find_pub_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a>* find_pub_handler </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03084">3084</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">ast_sip_publish_handler::event_name</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00090">ast_sip_publish_handler::next</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;{</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *iter = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>, iter, <a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#a6ad12c15b9231aec95e53a632ff79a56">next</a>) {</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <span class="keywordflow">if</span> (strcmp(<a class="code" href="../../df/d7d/structevent.html">event</a>, iter-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>)) {</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Event %s does not match %s\n&quot;</span>, <a class="code" href="../../df/d7d/structevent.html">event</a>, iter-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      }</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Event name match: %s = %s\n&quot;</span>, <a class="code" href="../../df/d7d/structevent.html">event</a>, iter-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;   }</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   <span class="keywordflow">return</span> iter;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;}</div><div class="ttc" id="structast__sip__publish__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_publish_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdoc">The name of the event this handler deals with. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">res_pjsip_pubsub.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structpublish__handlers_html"><div class="ttname"><a href="../../df/d3c/structpublish__handlers.html">publish_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02691">res_pjsip_pubsub.c:2691</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_a6ad12c15b9231aec95e53a632ff79a56"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#a6ad12c15b9231aec95e53a632ff79a56">ast_sip_publish_handler::next</a></div><div class="ttdeci">struct ast_sip_publish_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00090">res_pjsip_pubsub.h:90</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a></div><div class="ttdoc">Callbacks that publication handlers will define. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00049">res_pjsip_pubsub.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a219baab2a37a17e4922d696be2e07cca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a219baab2a37a17e4922d696be2e07cca">&#9670;&nbsp;</a></span>find_sub_handler_for_event_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> * find_sub_handler_for_event_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">2763</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00340">ast_sip_subscription_handler::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02777">ast_sip_register_subscription_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">subscription_get_handler_from_rdata()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">subscription_persistence_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;{</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *iter;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>, iter, <a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a2e4aa60e677c95983d44693bd69bc1be">next</a>) {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      <span class="keywordflow">if</span> (!strcmp(iter-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>, <a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>)) {</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;   }</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;   <span class="keywordflow">return</span> iter;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;}</div><div class="ttc" id="structsubscription__handlers_html"><div class="ttname"><a href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02754">res_pjsip_pubsub.c:2754</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a2e4aa60e677c95983d44693bd69bc1be"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a2e4aa60e677c95983d44693bd69bc1be">ast_sip_subscription_handler::next</a></div><div class="ttdeci">struct ast_sip_subscription_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00340">res_pjsip_pubsub.h:340</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac952acea83472c9c285fe203a5b62ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac952acea83472c9c285fe203a5b62ce3">&#9670;&nbsp;</a></span>for_each_subscription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int for_each_subscription </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0b174b002a4e991ef8c08f17118f8cd5">on_subscription_t</a>&#160;</td>
          <td class="paramname"><em>on_subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01800">1800</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00455">sip_subscription_tree::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04062">ami_show_subscriptions_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04076">ami_show_subscriptions_outbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04193">cli_complete_subscription_callid()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">cli_list_subscriptions_inout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">cli_show_subscription_inout()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">cli_show_subscriptions_inout()</a>.</p>
<div class="fragment"><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;{</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <span class="keywordtype">int</span> num = 0;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *i;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <span class="keywordflow">if</span> (!on_subscription) {</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">return</span> num;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>, i, <a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8f1e0d0bf78f07ba5cd5825726b20eb8">next</a>) {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">if</span> (on_subscription(i, arg)) {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      }</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      ++num;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <span class="keywordflow">return</span> num;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structsubscriptions_html"><div class="ttname"><a href="../../df/dab/structsubscriptions.html">subscriptions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00534">res_pjsip_pubsub.c:534</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a8f1e0d0bf78f07ba5cd5825726b20eb8"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a8f1e0d0bf78f07ba5cd5825726b20eb8">sip_subscription_tree::next</a></div><div class="ttdeci">struct sip_subscription_tree * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00455">res_pjsip_pubsub.c:455</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4cf48fac09e3299c24b6f72f438c421f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cf48fac09e3299c24b6f72f438c421f">&#9670;&nbsp;</a></span>format_ami_resource_lists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int format_ami_resource_lists </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04090">4090</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02745">ast_sip_ami::arg</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01584">ast_sip_create_ami_event()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01609">ast_sip_sorcery_object_to_ami()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03080">astman_append()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02747">ast_sip_ami::count</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02739">ast_sip_ami::s</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04112">ami_show_resource_lists()</a>.</p>
<div class="fragment"><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;{</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list = obj;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> *ami = <a class="code" href="../../d4/d2f/structast__sip__ami.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>;</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   buf = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a>(<span class="stringliteral">&quot;ResourceListDetail&quot;</span>, ami);</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;   }</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab105b4d8cca635ce7aeed34c4543ab54">ast_sip_sorcery_object_to_ami</a>(list, &amp;buf)) {</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;   }</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(ami-&gt;<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   ++ami-&gt;<a class="code" href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;}</div><div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ad43c3812e6d13e0518d9f8b8f463ffcf">ast_sip_ami::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02747">res_pjsip.h:2747</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a9ce2ec4812a92cb6ab39f6e81e9173a9"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">ast_sip_ami::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02745">res_pjsip.h:2745</a></div></div>
<div class="ttc" id="structast__sip__ami_html"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a></div><div class="ttdoc">AMI variable container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02737">res_pjsip.h:2737</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5b63b1eceb879f2cf0e23f356040737a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a></div><div class="ttdeci">struct ast_str * ast_sip_create_ami_event(const char *event, struct ast_sip_ami *ami)</div><div class="ttdoc">Creates a string to store AMI event data in. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l01584">pjsip_configuration.c:1584</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab105b4d8cca635ce7aeed34c4543ab54"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab105b4d8cca635ce7aeed34c4543ab54">ast_sip_sorcery_object_to_ami</a></div><div class="ttdeci">int ast_sip_sorcery_object_to_ami(const void *obj, struct ast_str **buf)</div><div class="ttdoc">Converts a sorcery object to a string of object properties. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l01609">pjsip_configuration.c:1609</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90eeb90b815577ed6bee36f8278a6e73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90eeb90b815577ed6bee36f8278a6e73">&#9670;&nbsp;</a></span>free_body_parts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_body_parts </td>
          <td>(</td>
          <td class="paramtype">struct body_part_list *&#160;</td>
          <td class="paramname"><em>parts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy a list of body parts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parts</td><td>The container of parts to destroy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02215">2215</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">body_part::part</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">generate_list_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;{</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(parts); ++i) {</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/de8/structbody__part.html">body_part</a> *<a class="code" href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">part</a> = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(parts, i);</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(part);</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;   }</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(parts);</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structbody__part_html"><div class="ttname"><a href="../../d2/de8/structbody__part.html">body_part</a></div><div class="ttdoc">A multipart body part and meta-information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02080">res_pjsip_pubsub.c:2080</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structbody__part_html_ac56343f0ae7d83d16f23924f1f828149"><div class="ttname"><a href="../../d2/de8/structbody__part.html#ac56343f0ae7d83d16f23924f1f828149">body_part::part</a></div><div class="ttdeci">pjsip_multipart_part * part</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02090">res_pjsip_pubsub.c:2090</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b691f0bc6a8c56d55095fa30cef4e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b691f0bc6a8c56d55095fa30cef4e47">&#9670;&nbsp;</a></span>generate_content_id_hdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_generic_string_hdr* generate_content_id_hdr </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a Content-ID header. </p>
<p>Content-ID headers are required by RFC2387 for multipart/related bodies. They serve as identifiers for each part of the multipart body.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>PJLIB allocation pool </td></tr>
    <tr><td class="paramname">sub</td><td>Subscription to a resource </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02107">2107</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d48/strings_8c_source.html#l00227">ast_generate_random_string()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">cid_name</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02233">allocate_body_part()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;{</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a> = { <span class="stringliteral">&quot;Content-ID&quot;</span>, 10 };</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;   pjsip_generic_string_hdr *<a class="code" href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">cid</a>;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;   <span class="keywordtype">char</span> <span class="keywordtype">id</span>[6];</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;   <span class="keywordtype">size_t</span> alloc_size;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   pj_str_t cid_value;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <span class="comment">/* &#39;&lt;&#39; + &#39;@&#39; + &#39;&gt;&#39; = 3. pj_str_t does not require a null-terminator */</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;   alloc_size = <span class="keyword">sizeof</span>(<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>) + pj_strlen(&amp;sub-&gt;uri-&gt;host) + 3;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;   cid_value.ptr = pj_pool_alloc(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, alloc_size);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;   cid_value.slen = sprintf(cid_value.ptr, <span class="stringliteral">&quot;&lt;%s@%.*s&gt;&quot;</span>,</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a>(<span class="keywordtype">id</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">id</span>)),</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;         (<span class="keywordtype">int</span>) pj_strlen(&amp;sub-&gt;uri-&gt;host), pj_strbuf(&amp;sub-&gt;uri-&gt;host));</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   cid = pjsip_generic_string_hdr_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;cid_name, &amp;cid_value);</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">cid</a>;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div><div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="strings_8h_html_ab2c8e1bf4b2b01a1ffabf882774907bb"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a></div><div class="ttdeci">char * ast_generate_random_string(char *buf, size_t size)</div><div class="ttdoc">Create a pseudo-random string of a fixed length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00227">strings.c:227</a></div></div>
<div class="ttc" id="structbody__part_html_a97f61ce218f9876fc092948fe744b2bc"><div class="ttname"><a href="../../d2/de8/structbody__part.html#a97f61ce218f9876fc092948fe744b2bc">body_part::cid</a></div><div class="ttdeci">pjsip_generic_string_hdr * cid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02082">res_pjsip_pubsub.c:2082</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_ade5a89f9bee15a492c760ec1765a292d"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a></div><div class="ttdeci">static char cid_name[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">chan_mgcp.c:165</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19dd0f9dd8ac29890f8e90159ca7fb78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19dd0f9dd8ac29890f8e90159ca7fb78">&#9670;&nbsp;</a></span>generate_initial_notify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int generate_initial_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">2887</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">ast_sip_pubsub_generate_body_content()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">ast_sip_subscription_get_body_subtype()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">ast_sip_subscription_get_body_type()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00243">ast_sip_body_data::body_data</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00241">ast_sip_body_data::body_type</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00318">ast_sip_subscription_handler::body_type</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00294">ast_sip_notifier::get_notify_data</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">ast_sip_subscription_handler::notifier</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00284">ast_sip_notifier::subscription_established</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;{</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../d4/d18/structnotify__data.html">notify_data</a>;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a> data = {</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;      .<a class="code" href="../../d1/de8/structast__sip__body__data.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a> = sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>,</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;   };</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children) &gt; 0) {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children); ++i) {</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a19dd0f9dd8ac29890f8e90159ca7fb78">generate_initial_notify</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;sub-&gt;children, i))) {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;         }</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;      }</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;   }</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;   <span class="comment">/* We notify subscription establishment only on the tree leaves. */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>-&gt;<a class="code" href="../../d1/d5b/structast__sip__notifier.html#ae3f8912b4a41553688ad665f170c6a91">subscription_established</a>(sub)) {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;   }</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;   notify_data = sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>-&gt;<a class="code" href="../../d1/d5b/structast__sip__notifier.html#ac400184f8d9f71baaaf9d294d33c1ca8">get_notify_data</a>(sub);</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;   <span class="keywordflow">if</span> (!notify_data) {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   }</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;   data.<a class="code" href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">body_data</a> = notify_data;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;   res = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa3b78cda3768f8f485e1ad46d6fcb765">ast_sip_pubsub_generate_body_content</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a>(sub),</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a>(sub), &amp;data, &amp;sub-&gt;body_text);</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(notify_data);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;}</div><div class="ttc" id="structast__sip__notifier_html_ac400184f8d9f71baaaf9d294d33c1ca8"><div class="ttname"><a href="../../d1/d5b/structast__sip__notifier.html#ac400184f8d9f71baaaf9d294d33c1ca8">ast_sip_notifier::get_notify_data</a></div><div class="ttdeci">void *(* get_notify_data)(struct ast_sip_subscription *sub)</div><div class="ttdoc">Supply data needed to create a NOTIFY body. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00294">res_pjsip_pubsub.h:294</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a19dd0f9dd8ac29890f8e90159ca7fb78"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a19dd0f9dd8ac29890f8e90159ca7fb78">generate_initial_notify</a></div><div class="ttdeci">static int generate_initial_notify(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">res_pjsip_pubsub.c:2887</a></div></div>
<div class="ttc" id="structast__sip__body__data_html_a086f833f6f250c98d7bcd80f9a573d06"><div class="ttname"><a href="../../d1/de8/structast__sip__body__data.html#a086f833f6f250c98d7bcd80f9a573d06">ast_sip_body_data::body_data</a></div><div class="ttdeci">void * body_data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00243">res_pjsip_pubsub.h:243</a></div></div>
<div class="ttc" id="structast__sip__body__data_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../d1/de8/structast__sip__body__data.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_body_data::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00241">res_pjsip_pubsub.h:241</a></div></div>
<div class="ttc" id="structast__sip__body__data_html"><div class="ttname"><a href="../../d1/de8/structast__sip__body__data.html">ast_sip_body_data</a></div><div class="ttdoc">Data used to create bodies for NOTIFY/PUBLISH requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00239">res_pjsip_pubsub.h:239</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a06762434263891503f1fe196fd2cf613"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">ast_sip_subscription_handler::notifier</a></div><div class="ttdeci">struct ast_sip_notifier * notifier</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">res_pjsip_pubsub.h:339</a></div></div>
<div class="ttc" id="structnotify__data_html"><div class="ttname"><a href="../../d4/d18/structnotify__data.html">notify_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d41/res__pjsip__notify_8c_source.html#l00266">res_pjsip_notify.c:266</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5c54dc5f481da88392b1ec7149385613"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_subtype(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body subtype used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">res_pjsip_pubsub.c:3514</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structast__sip__notifier_html_ae3f8912b4a41553688ad665f170c6a91"><div class="ttname"><a href="../../d1/d5b/structast__sip__notifier.html#ae3f8912b4a41553688ad665f170c6a91">ast_sip_notifier::subscription_established</a></div><div class="ttdeci">int(* subscription_established)(struct ast_sip_subscription *sub)</div><div class="ttdoc">Called when an inbound subscription has been accepted. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00284">res_pjsip_pubsub.h:284</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa3b78cda3768f8f485e1ad46d6fcb765"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa3b78cda3768f8f485e1ad46d6fcb765">ast_sip_pubsub_generate_body_content</a></div><div class="ttdeci">int ast_sip_pubsub_generate_body_content(const char *type, const char *subtype, struct ast_sip_body_data *data, struct ast_str **str)</div><div class="ttdoc">Generate body content for a PUBLISH or NOTIFY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03519">res_pjsip_pubsub.c:3519</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2294ee18e05ee676e083133058243909"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_type(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body type used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">res_pjsip_pubsub.c:3509</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_subscription_handler::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00318">res_pjsip_pubsub.h:318</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa801068c5728800b602dc19ecbe1b3cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa801068c5728800b602dc19ecbe1b3cf">&#9670;&nbsp;</a></span>generate_list_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_msg_body* generate_list_body </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>force_full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a resource list body for NOTIFY requests. </p>
<p>Resource list bodies are multipart/related bodies. The first part of the multipart body is an RLMI body that describes the rest of the parts to come. The other parts of the body convey state of individual subscribed resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>PJLIB allocation pool </td></tr>
    <tr><td class="paramname">sub</td><td>Subscription details from which to generate body </td></tr>
    <tr><td class="paramname">force_full_state</td><td>If true, ignore resource list settings and send a full state notification </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The generated multipart/related body </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">2324</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02258">build_body_part()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02291">create_multipart_body()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02215">free_body_parts()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;{</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;   pjsip_multipart_part *rlmi_part;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;   pjsip_msg_body *multipart;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;   <span class="keyword">struct </span>body_part_list body_parts;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> use_full_state = force_full_state ? 1 : sub-&gt;full_state;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;body_parts, <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children))) {</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;   }</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children); ++i) {</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2dba366491005a78cb1b67070de74a6e">build_body_part</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;sub-&gt;children, i), &amp;body_parts, use_full_state);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;   }</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;   <span class="comment">/* This can happen if issuing partial state and no children of the list have changed state */</span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;body_parts) == 0) {</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a90eeb90b815577ed6bee36f8278a6e73">free_body_parts</a>(&amp;body_parts);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;   }</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;   multipart = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac79436df96e320a3107e5e8dfb3e9720">create_multipart_body</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;   rlmi_part = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0aa1afb0a81eaeebda85dbb188f82df7">build_rlmi_body</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, sub, &amp;body_parts, use_full_state);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;   <span class="keywordflow">if</span> (!rlmi_part) {</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a90eeb90b815577ed6bee36f8278a6e73">free_body_parts</a>(&amp;body_parts);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   }</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;   pjsip_multipart_add_part(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, multipart, rlmi_part);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;body_parts); ++i) {</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      pjsip_multipart_add_part(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, multipart, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;body_parts, i)-&gt;part);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;   }</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a90eeb90b815577ed6bee36f8278a6e73">free_body_parts</a>(&amp;body_parts);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;   <span class="keywordflow">return</span> multipart;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a2dba366491005a78cb1b67070de74a6e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2dba366491005a78cb1b67070de74a6e">build_body_part</a></div><div class="ttdeci">static void build_body_part(pj_pool_t *pool, struct ast_sip_subscription *sub, struct body_part_list *parts, unsigned int use_full_state)</div><div class="ttdoc">Create a multipart body part for a subscribed resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02258">res_pjsip_pubsub.c:2258</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0aa1afb0a81eaeebda85dbb188f82df7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0aa1afb0a81eaeebda85dbb188f82df7">build_rlmi_body</a></div><div class="ttdeci">static pjsip_multipart_part * build_rlmi_body(pj_pool_t *pool, struct ast_sip_subscription *sub, struct body_part_list *body_parts, unsigned int full_state)</div><div class="ttdoc">Create an RLMI body part for a multipart resource list body. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">res_pjsip_pubsub.c:2162</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac79436df96e320a3107e5e8dfb3e9720"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac79436df96e320a3107e5e8dfb3e9720">create_multipart_body</a></div><div class="ttdeci">static pjsip_msg_body * create_multipart_body(pj_pool_t *pool)</div><div class="ttdoc">Create and initialize the PJSIP multipart body structure for a resource list subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02291">res_pjsip_pubsub.c:2291</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a90eeb90b815577ed6bee36f8278a6e73"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a90eeb90b815577ed6bee36f8278a6e73">free_body_parts</a></div><div class="ttdeci">static void free_body_parts(struct body_part_list *parts)</div><div class="ttdoc">Destroy a list of body parts. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02215">res_pjsip_pubsub.c:2215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe6f294a1dd6e02f90699c6862c8ff37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe6f294a1dd6e02f90699c6862c8ff37">&#9670;&nbsp;</a></span>generate_notify_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_msg_body * generate_notify_body </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>force_full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create the body for a NOTIFY request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The pool used for allocations </td></tr>
    <tr><td class="paramname">root</td><td>The root of the subscription tree </td></tr>
    <tr><td class="paramname">force_full_state</td><td>If true, ignore resource list settings and send a full state notification </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">2371</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">ast_sip_subscription_get_body_subtype()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">ast_sip_subscription_get_body_type()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">generate_list_body()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01508">text</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02258">build_body_part()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;{</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   pjsip_msg_body *body;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;root-&gt;children) == 0) {</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keywordflow">if</span> (force_full_state || root-&gt;body_changed) {</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;         <span class="comment">/* Not a list. We&#39;ve already generated the body and saved it on the subscription.</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">          * Use that directly.</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;         pj_str_t <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;         pj_str_t subtype;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;         pj_str_t <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;         pj_cstr(&amp;type, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a>(root));</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;         pj_cstr(&amp;subtype, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a>(root));</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;         pj_cstr(&amp;text, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(root-&gt;body_text));</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;         body = pjsip_msg_body_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;type, &amp;subtype, &amp;text);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;         root-&gt;body_changed = 0;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;         body = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      body = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa801068c5728800b602dc19ecbe1b3cf">generate_list_body</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, root, force_full_state);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;   }</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;   <span class="keywordflow">return</span> body;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a5c54dc5f481da88392b1ec7149385613"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a5c54dc5f481da88392b1ec7149385613">ast_sip_subscription_get_body_subtype</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_subtype(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body subtype used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03514">res_pjsip_pubsub.c:3514</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2294ee18e05ee676e083133058243909"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2294ee18e05ee676e083133058243909">ast_sip_subscription_get_body_type</a></div><div class="ttdeci">const char * ast_sip_subscription_get_body_type(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the body type used for this subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03509">res_pjsip_pubsub.c:3509</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa801068c5728800b602dc19ecbe1b3cf"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa801068c5728800b602dc19ecbe1b3cf">generate_list_body</a></div><div class="ttdeci">static pjsip_msg_body * generate_list_body(pj_pool_t *pool, struct ast_sip_subscription *sub, unsigned int force_full_state)</div><div class="ttdoc">Create a resource list body for NOTIFY requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02324">res_pjsip_pubsub.c:2324</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d439528eda8c1d3b35a443170e745d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d439528eda8c1d3b35a443170e745d0">&#9670;&nbsp;</a></span>have_visited()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int have_visited </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct resources *&#160;</td>
          <td class="paramname"><em>visited</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if this resource has been visited already. </p>
<p>See <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a> for more information</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>The resource currently being visited </td></tr>
    <tr><td class="paramname">visited</td><td>The resources that have previously been visited </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00987">987</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">build_node_children()</a>.</p>
<div class="fragment"><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;{</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(visited); ++i) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">if</span> (!strcmp(resource, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(visited, i))) {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div><div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a673b72409d496c2975c04f5d44f8a277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673b72409d496c2975c04f5d44f8a277">&#9670;&nbsp;</a></span>ineligible_configuration()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ineligible_configuration </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05053">5053</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01290">ast_config_destroy()</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">ast_config_load</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/d9d/main_2config_8c_source.html#l00694">ast_variable_retrieve()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;{</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> <a class="code" href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = {0,};</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;   config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<span class="stringliteral">&quot;sorcery.conf&quot;</span>, flags);</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;   }</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;   value = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(config, <span class="stringliteral">&quot;res_pjsip_pubsub&quot;</span>, <span class="stringliteral">&quot;resource_list&quot;</span>);</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value)) {</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;   }</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;   <span class="keywordflow">if</span> (strcasecmp(value, <span class="stringliteral">&quot;memory&quot;</span>) &amp;&amp; strcasecmp(value, <span class="stringliteral">&quot;astdb&quot;</span>)) {</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;   }</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structast__flags_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">ast_flags::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00200">utils.h:200</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0a07ddd6bbcf44485e01c14c96109482"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a></div><div class="ttdeci">#define ast_config_load(filename, flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">include/asterisk/config.h:179</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a9ff7aa27ae5f1a980bcf81f91cd6e470"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a></div><div class="ttdeci">const char * ast_variable_retrieve(struct ast_config *config, const char *category, const char *variable)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00694">main/config.c:694</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb194881d03c561cd60d0c88f82c7478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb194881d03c561cd60d0c88f82c7478">&#9670;&nbsp;</a></span>initial_notify_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int initial_notify_task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">2929</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01801">AST_SIP_SCHED_TASK_DATA_AO2</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01778">AST_SIP_SCHED_TASK_FIXED</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00415">ast_sip_schedule_task()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">sip_subscription_tree::expiration_task</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">initial_notify_data::expires</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">generate_initial_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00063">PJSIP_EXPIRES_NOT_SPECIFIED</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">initial_notify_data::sub_tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;{</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a> *ind = obj;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a19dd0f9dd8ac29890f8e90159ca7fb78">generate_initial_notify</a>(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>)) {</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      pjsip_evsub_terminate(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a>(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>, 1);</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;SUBSCRIPTION_ESTABLISHED&quot;</span>,</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;         <span class="stringliteral">&quot;Resource: %s&quot;</span>,</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource);</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   }</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;   <span class="keywordflow">if</span> (ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">expires</a> != <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acd4517938f2afe11a1c6f372e28090a5">PJSIP_EXPIRES_NOT_SPECIFIED</a>) {</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(strlen(<span class="stringliteral">&quot;-&gt;/ &quot;</span>) +</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;         strlen(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>) +</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;         strlen(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource) +</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;         strlen(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>) +</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id.slen + 1);</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      sprintf(name, <span class="stringliteral">&quot;%s-&gt;%s/%s %.*s&quot;</span>, ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>,</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource, ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>,</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;         (<span class="keywordtype">int</span>)ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id.slen, ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id.ptr);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Scheduling timer: %s\n&quot;</span>, name);</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a> = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga47a9130b20e7724a51d5eeebbc0a516b">ast_sip_schedule_task</a>(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>,</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">expires</a> * 1000, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31b603dda9cf0a3354575494f0d4f9f9">pubsub_on_refresh_timeout</a>, name,</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>, <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212">AST_SIP_SCHED_TASK_FIXED</a> | <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a>);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      <span class="keywordflow">if</span> (!ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>) {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create expiration timer of %d seconds for %s\n&quot;</span>,</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;            ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">expires</a>, name);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      }</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;   }</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a>, -1);</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ind);</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a19dd0f9dd8ac29890f8e90159ca7fb78"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a19dd0f9dd8ac29890f8e90159ca7fb78">generate_initial_notify</a></div><div class="ttdeci">static int generate_initial_notify(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">res_pjsip_pubsub.c:2887</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a06552650d7ef9108d5744ee3f3fff264"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">initial_notify_data::expires</a></div><div class="ttdeci">unsigned int expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">res_pjsip_pubsub.c:1536</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212">AST_SIP_SCHED_TASK_FIXED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01778">res_pjsip.h:1778</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga47a9130b20e7724a51d5eeebbc0a516b"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga47a9130b20e7724a51d5eeebbc0a516b">ast_sip_schedule_task</a></div><div class="ttdeci">struct ast_sip_sched_task * ast_sip_schedule_task(struct ast_taskprocessor *serializer, int interval, ast_sip_task sip_task, const char *name, void *task_data, enum ast_sip_scheduler_task_flags flags)</div><div class="ttdoc">Schedule a task to run in the res_pjsip thread pool. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00415">pjsip_scheduler.c:415</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a31b603dda9cf0a3354575494f0d4f9f9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31b603dda9cf0a3354575494f0d4f9f9">pubsub_on_refresh_timeout</a></div><div class="ttdeci">static int pubsub_on_refresh_timeout(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">res_pjsip_pubsub.c:3859</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structinitial__notify__data_html"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01534">res_pjsip_pubsub.c:1534</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8b3391cb48972f432118c4ca2eeb3063"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a></div><div class="ttdeci">static int send_notify(struct sip_subscription_tree *sub_tree, unsigned int force_full_state)</div><div class="ttdoc">Send a NOTIFY request to a subscriber. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">res_pjsip_pubsub.c:2425</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_subscription_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">res_pjsip_pubsub.h:316</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_afc1efa41dfd583546f0fb620d85bbef8"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">sip_subscription_tree::expiration_task</a></div><div class="ttdeci">struct ast_sip_sched_task * expiration_task</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">res_pjsip_pubsub.c:462</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a3b20a602cda3a7726e79738d006c5518"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">initial_notify_data::sub_tree</a></div><div class="ttdeci">struct sip_subscription_tree * sub_tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">res_pjsip_pubsub.c:1535</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_acd4517938f2afe11a1c6f372e28090a5"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#acd4517938f2afe11a1c6f372e28090a5">PJSIP_EXPIRES_NOT_SPECIFIED</a></div><div class="ttdeci">#define PJSIP_EXPIRES_NOT_SPECIFIED</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00063">res_pjsip.h:63</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01801">res_pjsip.h:1801</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb174e25bbf05213be145675e5e2c37f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb174e25bbf05213be145675e5e2c37f">&#9670;&nbsp;</a></span>item_in_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int item_in_vector </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04781">4781</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04794">list_item_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;{</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>); ++i) {</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      <span class="keywordflow">if</span> (!strcmp(<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, i))) {</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      }</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;   }</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;}</div><div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1a6f87906d88cf1f915a7598309a3f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a6f87906d88cf1f915a7598309a3f0">&#9670;&nbsp;</a></span>list_item_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int list_item_handler </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04794">4794</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00219">ast_strip()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d8/d4f/test__config_8c_source.html#l01463">item</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04781">item_in_vector()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">apply_list_configuration()</a>.</p>
<div class="fragment"><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;{</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list = obj;</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;   <span class="keywordflow">while</span> ((item = <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(<a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;items, <span class="stringliteral">&quot;,&quot;</span>)))) {</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(item)) {</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;      }</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abb174e25bbf05213be145675e5e2c37f">item_in_vector</a>(list, item)) {</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Ignoring duplicated list item &#39;%s&#39;\n&quot;</span>, item);</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      }</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;      item = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(item);</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      <span class="keywordflow">if</span> (!item || <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, item)) {</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(item);</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      }</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;   }</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="strings_8h_html_ac92713b8d07a45720b2664be70810e55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a></div><div class="ttdeci">char * ast_strip(char *s)</div><div class="ttdoc">Strip leading/trailing whitespace from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00219">strings.h:219</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abb174e25bbf05213be145675e5e2c37f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abb174e25bbf05213be145675e5e2c37f">item_in_vector</a></div><div class="ttdeci">static int item_in_vector(const struct resource_list *list, const char *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04781">res_pjsip_pubsub.c:4781</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa04aa9b3ab93170dc00535e2deaa5c86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04aa9b3ab93170dc00535e2deaa5c86">&#9670;&nbsp;</a></span>list_item_to_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int list_item_to_str </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const intptr_t *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04821">4821</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00738">ast_str_truncate()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>, and <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00147">str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">apply_list_configuration()</a>.</p>
<div class="fragment"><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;{</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list = obj;</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(32);</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>); ++i) {</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;str, 0, <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, i));</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;   }</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;   <span class="comment">/* Chop off trailing comma */</span></div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a0b9c195ff2235f7670358e1e37cf6b8d">ast_str_truncate</a>(str, -1);</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;   *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(str));</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(str);</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="strings_8h_html_a0b9c195ff2235f7670358e1e37cf6b8d"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a0b9c195ff2235f7670358e1e37cf6b8d">ast_str_truncate</a></div><div class="ttdeci">char * ast_str_truncate(struct ast_str *buf, ssize_t len)</div><div class="ttdoc">Truncates the enclosed string to the given length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00738">strings.h:738</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">5560</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04112">ami_show_resource_lists()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04062">ami_show_subscriptions_inbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04135">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04076">ami_show_subscriptions_outbound()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04136">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">apply_list_configuration()</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00265">ast_cli_register_multiple</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l01720">ast_manager_get_topic()</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00186">ast_manager_register_xml</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00464">ast_module_shutdown_ref</a>, <a class="el" href="../../d7/d5b/options_8h_source.html#l00058">AST_OPT_FLAG_FULLY_BOOTED</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00061">ast_options</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00236">ast_sched_context_create()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00269">ast_sched_context_destroy()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00195">ast_sched_start_thread()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03315">ast_sip_register_service()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00456">ast_sorcery_apply_config</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00477">ast_sorcery_apply_default</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00955">ast_sorcery_object_field_register</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l01005">ast_sorcery_object_field_register_custom</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01160">ast_sorcery_object_fields_register()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00838">ast_sorcery_object_register</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01442">ast_sorcery_reload_object()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00835">CHARFLDSET</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00071">EVENT_FLAG_SYSTEM</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00330">OPT_CHAR_ARRAY_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00399">OPT_NOOP_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00459">OPT_UINT_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00481">OPT_YESNO_T</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04673">persistence_endpoint_str2struct()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04681">persistence_endpoint_struct2str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04738">persistence_expires_str2struct()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04744">persistence_expires_struct2str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04705">persistence_generator_data_str2struct()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04718">persistence_generator_data_struct2str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04689">persistence_tag_str2struct()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04697">persistence_tag_struct2str()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00567">publication_resource_alloc()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05526">resource_endpoint_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05536">resource_event_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00539">rlmi_media_type</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>, <a class="el" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c_source.html#l00126">sorcery</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00682">stasis_subscribe_pool</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00631">subscription_persistence_alloc()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">subscription_persistence_load()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;{</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t str_PUBLISH = { <span class="stringliteral">&quot;PUBLISH&quot;</span>, 7 };</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;   sorcery = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>();</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d0/da0/structsched.html">sched</a> = <a class="code" href="../../d7/d00/sched_8h.html#a5baecc149aeabdbef9b3ed6780c1c4a6">ast_sched_context_create</a>())) {</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not create scheduler for publication expiration\n&quot;</span>);</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;   }</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/d00/sched_8h.html#a8ae97d1549b62cfbfc78bd92efe48005">ast_sched_start_thread</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>)) {</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not start scheduler thread for publication expiration\n&quot;</span>);</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;   }</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a>(sorcery, <span class="stringliteral">&quot;res_pjsip_pubsub&quot;</span>);</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;astdb&quot;</span>, <span class="stringliteral">&quot;subscription_persistence&quot;</span>);</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae323533f795e111d13b1d7b9a3d1d973">subscription_persistence_alloc</a>,</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not register subscription persistence object support\n&quot;</span>);</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;   }</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;packet&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 0,</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, packet));</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;src_name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 0,</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, src_name));</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;src_port&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0,</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, src_port));</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;transport_key&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 0,</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, transport_key));</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;local_name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 0,</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, local_name));</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;local_port&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0,</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, local_port));</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;cseq&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0,</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, cseq));</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;endpoint&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa312ad955e7ad6a9dff13667be04c7f7">persistence_endpoint_str2struct</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a56c0f161f100c005d4c95b26ca3f7d7d">persistence_endpoint_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aac028869908c724f84c3a1cee520315c">persistence_tag_str2struct</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac4305e5102dec63e8bbb9175dbab630e">persistence_tag_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;expires&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aae837565412b034de817b534fa2a7136">persistence_expires_str2struct</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a946b1f58e8ead34101e6fc012088140a">persistence_expires_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;contact_uri&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a>, 0,</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, contact_uri));</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;prune_on_boot&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2">OPT_YESNO_T</a>, 1,</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>, prune_on_boot));</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <span class="stringliteral">&quot;generator_data&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8dcc5a2234d92546bbeeead95aa648ec">persistence_generator_data_str2struct</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad276d9178ef9aad7e0d9ad2fbd52744d">persistence_generator_data_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9c45ac14fca8a0ed83e33e45856a5199">apply_list_configuration</a>(sorcery)) {</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;   }</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>, <span class="stringliteral">&quot;config&quot;</span>, <span class="stringliteral">&quot;pjsip.conf,criteria=type=inbound-publication&quot;</span>);</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab24c7cae87fc8a55c3a59bbf69cf7352">publication_resource_alloc</a>,</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not register subscription persistence object support\n&quot;</span>);</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;   }</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a>, 0, 0);</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>, <span class="stringliteral">&quot;endpoint&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a64671fa6b889a9d62d646f3ab90cc775">resource_endpoint_handler</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a1f0ff2b69990cd594471a830dea51f6c">ast_sorcery_object_fields_register</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>, <span class="stringliteral">&quot;^event_&quot;</span>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3906226af7019edcf94ef2ce356dc7cf">resource_event_handler</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(sorcery, <span class="stringliteral">&quot;inbound-publication&quot;</span>);</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a>(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>)) {</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not register pubsub service\n&quot;</span>);</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;   }</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;   <span class="keywordflow">if</span> (pjsip_evsub_init_module(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>()) != PJ_SUCCESS) {</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not initialize pjsip evsub module.\n&quot;</span>);</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>);</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;   }</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;   <span class="comment">/* Once pjsip_evsub_init_module succeeds we cannot unload.</span></div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;<span class="comment">    * Keep all module_load errors above this point. */</span></div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;   pjsip_media_type_init2(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae55303c463ee7d4709335ae3311c3826">rlmi_media_type</a>, <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;rlmi+xml&quot;</span>);</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;   pjsip_endpt_add_capability(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, PJSIP_H_ALLOW, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, &amp;str_PUBLISH);</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;<a class="code" href="../../d6/dd6/group__main__options.html#gaa5dba371db31dc4ebecdff7c929ff263">ast_options</a>, <a class="code" href="../../d6/dd6/group__main__options.html#gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680">AST_OPT_FLAG_FULLY_BOOTED</a>)) {</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e8ac5e3b2ce24bb0441ca5c30fa783c">subscription_persistence_load</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;      sub = <a class="code" href="../../dd/d79/stasis_8h.html#a597f7a30fe616c9f083a93ed168955ed">stasis_subscribe_pool</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a>(), <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ac62bbbfecf4068411d7fa11225c91055">subscription_persistence_event_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(sub, <a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>());</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(sub, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;   }</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a703b9f7d4c89444b70c00353c864765c">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>,</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;             <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a675152b3c3f0536dbb1f624fc840fba1">ami_show_subscriptions_inbound</a>);</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a75e6251ec7546725dcb5cc72bf6b60ce">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>,</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;             <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a53732c2137fa94234dd28ed05de1a282">ami_show_subscriptions_outbound</a>);</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;PJSIPShowResourceLists&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>,</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a22c56a35e1b346bd629dd4caf6a52f03">ami_show_resource_lists</a>);</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a>));</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(<a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a>);</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(complex_resource_tree);</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(bad_resource);</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(bad_branch);</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(duplicate_resource);</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(loop);</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(bad_event);</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;}</div><div class="ttc" id="sched_8h_html_a8ae97d1549b62cfbfc78bd92efe48005"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a8ae97d1549b62cfbfc78bd92efe48005">ast_sched_start_thread</a></div><div class="ttdeci">int ast_sched_start_thread(struct ast_sched_context *con)</div><div class="ttdoc">Start a thread for processing scheduler entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00195">sched.c:195</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a75e6251ec7546725dcb5cc72bf6b60ce"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a75e6251ec7546725dcb5cc72bf6b60ce">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a></div><div class="ttdeci">#define AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04136">res_pjsip_pubsub.c:4136</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae55303c463ee7d4709335ae3311c3826"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae55303c463ee7d4709335ae3311c3826">rlmi_media_type</a></div><div class="ttdeci">static pjsip_media_type rlmi_media_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00539">res_pjsip_pubsub.c:539</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8dcc5a2234d92546bbeeead95aa648ec"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8dcc5a2234d92546bbeeead95aa648ec">persistence_generator_data_str2struct</a></div><div class="ttdeci">static int persistence_generator_data_str2struct(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04705">res_pjsip_pubsub.c:4705</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a22c56a35e1b346bd629dd4caf6a52f03"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a22c56a35e1b346bd629dd4caf6a52f03">ami_show_resource_lists</a></div><div class="ttdeci">static int ami_show_resource_lists(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04112">res_pjsip_pubsub.c:4112</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a56c0f161f100c005d4c95b26ca3f7d7d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a56c0f161f100c005d4c95b26ca3f7d7d">persistence_endpoint_struct2str</a></div><div class="ttdeci">static int persistence_endpoint_struct2str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04681">res_pjsip_pubsub.c:4681</a></div></div>
<div class="ttc" id="structstasis__subscription_html"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00681">stasis.c:681</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab24c7cae87fc8a55c3a59bbf69cf7352"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab24c7cae87fc8a55c3a59bbf69cf7352">publication_resource_alloc</a></div><div class="ttdeci">static void * publication_resource_alloc(const char *name)</div><div class="ttdoc">Allocator for publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00567">res_pjsip_pubsub.c:567</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac62bbbfecf4068411d7fa11225c91055"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac62bbbfecf4068411d7fa11225c91055">subscription_persistence_event_cb</a></div><div class="ttdeci">static void subscription_persistence_event_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdoc">Event callback which fires subscription persistence recreation when the system is fully booted...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">res_pjsip_pubsub.c:1772</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="sorcery_8h_html_a1f0ff2b69990cd594471a830dea51f6c"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a1f0ff2b69990cd594471a830dea51f6c">ast_sorcery_object_fields_register</a></div><div class="ttdeci">int ast_sorcery_object_fields_register(struct ast_sorcery *sorcery, const char *type, const char *regex, aco_option_handler config_handler, sorcery_fields_handler sorcery_handler)</div><div class="ttdoc">Register a regex for multiple fields within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01160">sorcery.c:1160</a></div></div>
<div class="ttc" id="config__options_8h_html_a5a18d813ca848db340644212d89aac1a"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5a18d813ca848db340644212d89aac1a">CHARFLDSET</a></div><div class="ttdeci">#define CHARFLDSET(type, field)</div><div class="ttdoc">A helper macro to pass the appropriate arguments to aco_option_register for OPT_CHAR_ARRAY_T. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00835">config_options.h:835</a></div></div>
<div class="ttc" id="structast__sorcery_html"><div class="ttname"><a href="../../d2/d88/structast__sorcery.html">ast_sorcery</a></div><div class="ttdoc">Full structure for sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00230">sorcery.c:230</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a></div><div class="ttdoc">Type for a default handler that should do nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00399">config_options.h:399</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae323533f795e111d13b1d7b9a3d1d973"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae323533f795e111d13b1d7b9a3d1d973">subscription_persistence_alloc</a></div><div class="ttdeci">static void * subscription_persistence_alloc(const char *name)</div><div class="ttdoc">Allocator for subscription persistence. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00631">res_pjsip_pubsub.c:631</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ac4305e5102dec63e8bbb9175dbab630e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ac4305e5102dec63e8bbb9175dbab630e">persistence_tag_struct2str</a></div><div class="ttdeci">static int persistence_tag_struct2str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04697">res_pjsip_pubsub.c:4697</a></div></div>
<div class="ttc" id="sorcery_8h_html_a9db9fd1cf5ec967af2ad3a63c27e0233"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a></div><div class="ttdeci">#define ast_sorcery_apply_config(sorcery, name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00456">sorcery.h:456</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa312ad955e7ad6a9dff13667be04c7f7"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa312ad955e7ad6a9dff13667be04c7f7">persistence_endpoint_str2struct</a></div><div class="ttdeci">static int persistence_endpoint_str2struct(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04673">res_pjsip_pubsub.c:4673</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a9c45ac14fca8a0ed83e33e45856a5199"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a9c45ac14fca8a0ed83e33e45856a5199">apply_list_configuration</a></div><div class="ttdeci">static int apply_list_configuration(struct ast_sorcery *sorcery)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">res_pjsip_pubsub.c:4857</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a946b1f58e8ead34101e6fc012088140a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a946b1f58e8ead34101e6fc012088140a">persistence_expires_struct2str</a></div><div class="ttdeci">static int persistence_expires_struct2str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04744">res_pjsip_pubsub.c:4744</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a675152b3c3f0536dbb1f624fc840fba1"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a675152b3c3f0536dbb1f624fc840fba1">ami_show_subscriptions_inbound</a></div><div class="ttdeci">static int ami_show_subscriptions_inbound(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04062">res_pjsip_pubsub.c:4062</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a1959d38582b0da24d4d42766cf13ade8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a></div><div class="ttdeci">static struct ast_cli_entry cli_commands[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04667">res_pjsip_pubsub.c:4667</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a783aac0af1422c0e46356efd3c52d37a">OPT_CHAR_ARRAY_T</a></div><div class="ttdoc">Type for default option handler for character array strings. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00330">config_options.h:330</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2">OPT_YESNO_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00481">config_options.h:481</a></div></div>
<div class="ttc" id="manager_8h_html_a420f0f755e1c3378b45ca7f6f0669ffa"><div class="ttname"><a href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a></div><div class="ttdeci">#define EVENT_FLAG_SYSTEM</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00071">manager.h:71</a></div></div>
<div class="ttc" id="manager_8h_html_a8ae409b5ff584e42c30edcfe5837d85c"><div class="ttname"><a href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a></div><div class="ttdeci">struct stasis_message_type * ast_manager_get_generic_type(void)</div><div class="ttdoc">Get the stasis_message_type for generic messages. </div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a></div><div class="ttdoc">Type for default option handler for unsigned integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00459">config_options.h:459</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d923ef44f62dffc05178f762b88f084"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a></div><div class="ttdeci">int ast_sip_register_service(pjsip_module *module)</div><div class="ttdoc">Register a SIP service in Asterisk. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03315">res_pjsip.c:3315</a></div></div>
<div class="ttc" id="sched_8h_html_a5baecc149aeabdbef9b3ed6780c1c4a6"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a5baecc149aeabdbef9b3ed6780c1c4a6">ast_sched_context_create</a></div><div class="ttdeci">struct ast_sched_context * ast_sched_context_create(void)</div><div class="ttdoc">Create a scheduler context. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00236">sched.c:236</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aac028869908c724f84c3a1cee520315c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aac028869908c724f84c3a1cee520315c">persistence_tag_str2struct</a></div><div class="ttdeci">static int persistence_tag_str2struct(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04689">res_pjsip_pubsub.c:4689</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3906226af7019edcf94ef2ce356dc7cf"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3906226af7019edcf94ef2ce356dc7cf">resource_event_handler</a></div><div class="ttdeci">static int resource_event_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05536">res_pjsip_pubsub.c:5536</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="module_8h_html_a9967b09817639f2e15c3f074a60b6379"><div class="ttname"><a href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a></div><div class="ttdeci">#define ast_module_shutdown_ref(mod)</div><div class="ttdoc">Prevent unload of the module before shutdown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00464">module.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="stasis_8h_html_a597f7a30fe616c9f083a93ed168955ed"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a597f7a30fe616c9f083a93ed168955ed">stasis_subscribe_pool</a></div><div class="ttdeci">#define stasis_subscribe_pool(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00682">stasis.h:682</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0e8ac5e3b2ce24bb0441ca5c30fa783c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e8ac5e3b2ce24bb0441ca5c30fa783c">subscription_persistence_load</a></div><div class="ttdeci">static int subscription_persistence_load(void *data)</div><div class="ttdoc">Function which loads and recreates persisted subscriptions upon startup when the system is fully boot...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">res_pjsip_pubsub.c:1750</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga568aa1aff837fc0001279490a6d9b22f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a></div><div class="ttdeci">struct stasis_topic * ast_manager_get_topic(void)</div><div class="ttdoc">Get the Stasis Message Bus API topic for AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01720">manager.c:1720</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="group__main__options_html_gaa5dba371db31dc4ebecdff7c929ff263"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#gaa5dba371db31dc4ebecdff7c929ff263">ast_options</a></div><div class="ttdeci">struct ast_flags ast_options</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00061">options.c:61</a></div></div>
<div class="ttc" id="res__pjsip__phoneprov__provider_8c_html_a95eb520bdb1abcd2a70b1432d3ecbf4c"><div class="ttname"><a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a></div><div class="ttdeci">static struct ast_sorcery * sorcery</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c_source.html#l00126">res_pjsip_phoneprov_provider.c:126</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a703b9f7d4c89444b70c00353c864765c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a703b9f7d4c89444b70c00353c864765c">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a></div><div class="ttdeci">#define AMI_SHOW_SUBSCRIPTIONS_INBOUND</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04135">res_pjsip_pubsub.c:4135</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a15aa09d9084763cdd20b7467a4cd381a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a></div><div class="ttdeci">void ast_sip_unregister_service(pjsip_module *module)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03331">res_pjsip.c:3331</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aae837565412b034de817b534fa2a7136"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aae837565412b034de817b534fa2a7136">persistence_expires_str2struct</a></div><div class="ttdeci">static int persistence_expires_str2struct(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04738">res_pjsip_pubsub.c:4738</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a53732c2137fa94234dd28ed05de1a282"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a53732c2137fa94234dd28ed05de1a282">ami_show_subscriptions_outbound</a></div><div class="ttdeci">static int ami_show_subscriptions_outbound(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04076">res_pjsip_pubsub.c:4076</a></div></div>
<div class="ttc" id="group__main__options_html_gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680">AST_OPT_FLAG_FULLY_BOOTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5b/options_8h_source.html#l00058">options.h:58</a></div></div>
<div class="ttc" id="manager_8h_html_a5b63b8a8faede2d852e071e1f7b31c11"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a></div><div class="ttdeci">#define ast_manager_register_xml(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00186">manager.h:186</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad276d9178ef9aad7e0d9ad2fbd52744d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad276d9178ef9aad7e0d9ad2fbd52744d">persistence_generator_data_struct2str</a></div><div class="ttdeci">static int persistence_generator_data_struct2str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04718">res_pjsip_pubsub.c:4718</a></div></div>
<div class="ttc" id="sched_8h_html_a862f869d056628b38e09042f21b54413"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a></div><div class="ttdeci">void ast_sched_context_destroy(struct ast_sched_context *c)</div><div class="ttdoc">destroys a schedule context </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00269">sched.c:269</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a64671fa6b889a9d62d646f3ab90cc775"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a64671fa6b889a9d62d646f3ab90cc775">resource_endpoint_handler</a></div><div class="ttdeci">static int resource_endpoint_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05526">res_pjsip_pubsub.c:5526</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a2ec9c29cf673a20f527615e5acb98b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2ec9c29cf673a20f527615e5acb98b">&#9670;&nbsp;</a></span>parse_simple_message_summary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_simple_message_summary </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d4c/structsimple__message__summary.html">simple_message_summary</a> *&#160;</td>
          <td class="paramname"><em>summary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03585">3585</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d48/strings_8c_source.html#l00372">ast_read_line_from_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01268">ast_str_to_lower()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03582">simple_message_summary::message_account</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03578">simple_message_summary::voice_messages_new</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03579">simple_message_summary::voice_messages_old</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03580">simple_message_summary::voice_messages_urgent_new</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03581">simple_message_summary::voice_messages_urgent_old</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03614">pubsub_on_rx_mwi_notify_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;{</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;   <span class="keywordtype">char</span> *line;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;   <span class="keywordtype">char</span> *buffer;</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;   <span class="keywordtype">int</span> found_counts = 0;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(body) || !summary) {</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;   }</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;   buffer = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(body);</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;   memset(summary, 0, <span class="keyword">sizeof</span>(*summary));</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;   <span class="keywordflow">while</span> ((line = <a class="code" href="../../d6/d90/strings_8h.html#aec9fdc621b97dd7beac3e4a225d11bb6">ast_read_line_from_buffer</a>(&amp;buffer))) {</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      line = <a class="code" href="../../d6/d90/strings_8h.html#aa8ab574002a6eb04925efea4c2885059">ast_str_to_lower</a>(line);</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;voice-message: %d/%d (%d/%d)&quot;</span>,</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;         &amp;summary-&gt;<a class="code" href="../../d0/d4c/structsimple__message__summary.html#a001b7c3c0183b1012cffd3d9498cc384">voice_messages_new</a>, &amp;summary-&gt;<a class="code" href="../../d0/d4c/structsimple__message__summary.html#af13734b83debd190c047ecaa54d0bb7d">voice_messages_old</a>,</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;         &amp;summary-&gt;<a class="code" href="../../d0/d4c/structsimple__message__summary.html#ac4508933deca9dfd7e9d3f77922ded20">voice_messages_urgent_new</a>, &amp;summary-&gt;<a class="code" href="../../d0/d4c/structsimple__message__summary.html#a973a78773c52754ab9c429483ff9c84d">voice_messages_urgent_old</a>)) {</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;         found_counts = 1;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;         sscanf(line, <span class="stringliteral">&quot;message-account: %s&quot;</span>, summary-&gt;<a class="code" href="../../d0/d4c/structsimple__message__summary.html#abc5ed3ee3c85dccc50605477083d2e55">message_account</a>);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      }</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;   }</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;   <span class="keywordflow">return</span> !found_counts;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;}</div><div class="ttc" id="structsimple__message__summary_html_a001b7c3c0183b1012cffd3d9498cc384"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html#a001b7c3c0183b1012cffd3d9498cc384">simple_message_summary::voice_messages_new</a></div><div class="ttdeci">int voice_messages_new</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03578">res_pjsip_pubsub.c:3578</a></div></div>
<div class="ttc" id="structsimple__message__summary_html_abc5ed3ee3c85dccc50605477083d2e55"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html#abc5ed3ee3c85dccc50605477083d2e55">simple_message_summary::message_account</a></div><div class="ttdeci">char message_account[PJSIP_MAX_URL_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03582">res_pjsip_pubsub.c:3582</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structsimple__message__summary_html_ac4508933deca9dfd7e9d3f77922ded20"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html#ac4508933deca9dfd7e9d3f77922ded20">simple_message_summary::voice_messages_urgent_new</a></div><div class="ttdeci">int voice_messages_urgent_new</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03580">res_pjsip_pubsub.c:3580</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="structsimple__message__summary_html_af13734b83debd190c047ecaa54d0bb7d"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html#af13734b83debd190c047ecaa54d0bb7d">simple_message_summary::voice_messages_old</a></div><div class="ttdeci">int voice_messages_old</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03579">res_pjsip_pubsub.c:3579</a></div></div>
<div class="ttc" id="strings_8h_html_aa8ab574002a6eb04925efea4c2885059"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa8ab574002a6eb04925efea4c2885059">ast_str_to_lower</a></div><div class="ttdeci">static force_inline char * ast_str_to_lower(char *str)</div><div class="ttdoc">Convert a string to all lower-case. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01268">strings.h:1268</a></div></div>
<div class="ttc" id="structsimple__message__summary_html_a973a78773c52754ab9c429483ff9c84d"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html#a973a78773c52754ab9c429483ff9c84d">simple_message_summary::voice_messages_urgent_old</a></div><div class="ttdeci">int voice_messages_urgent_old</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03581">res_pjsip_pubsub.c:3581</a></div></div>
<div class="ttc" id="strings_8h_html_aec9fdc621b97dd7beac3e4a225d11bb6"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aec9fdc621b97dd7beac3e4a225d11bb6">ast_read_line_from_buffer</a></div><div class="ttdeci">char * ast_read_line_from_buffer(char **buffer)</div><div class="ttdoc">Read lines from a string buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00372">strings.c:372</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa312ad955e7ad6a9dff13667be04c7f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa312ad955e7ad6a9dff13667be04c7f7">&#9670;&nbsp;</a></span>persistence_endpoint_str2struct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_endpoint_str2struct </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04673">4673</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;{</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;   persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;}</div><div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56c0f161f100c005d4c95b26ca3f7d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56c0f161f100c005d4c95b26ca3f7d7d">&#9670;&nbsp;</a></span>persistence_endpoint_struct2str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_endpoint_struct2str </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const intptr_t *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04681">4681</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;{</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae837565412b034de817b534fa2a7136"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae837565412b034de817b534fa2a7136">&#9670;&nbsp;</a></span>persistence_expires_str2struct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_expires_str2struct </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04738">4738</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02171">ast_get_timeval()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00226">ast_tv()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;{</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#af96aa9b71c6ef0f2f75038669d950b31">ast_get_timeval</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>, <a class="code" href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a>(0, 0), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;}</div><div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_af96aa9b71c6ef0f2f75038669d950b31"><div class="ttname"><a href="../../d6/d90/strings_8h.html#af96aa9b71c6ef0f2f75038669d950b31">ast_get_timeval</a></div><div class="ttdeci">int ast_get_timeval(const char *src, struct timeval *tv, struct timeval _default, int *consumed)</div><div class="ttdoc">get values from config variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02171">main/utils.c:2171</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="time_8h_html_aebf04439f206cc509472ce4b6da48a5a"><div class="ttname"><a href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a></div><div class="ttdeci">struct timeval ast_tv(ast_time_t sec, ast_suseconds_t usec)</div><div class="ttdoc">Returns a timeval from sec, usec. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00226">time.h:226</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a946b1f58e8ead34101e6fc012088140a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946b1f58e8ead34101e6fc012088140a">&#9670;&nbsp;</a></span>persistence_expires_struct2str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_expires_struct2str </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const intptr_t *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04744">4744</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;{</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;   <span class="keywordflow">return</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="stringliteral">&quot;%ld&quot;</span>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec) &lt; 0) ? -1 : 0;</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dcc5a2234d92546bbeeead95aa648ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dcc5a2234d92546bbeeead95aa648ec">&#9670;&nbsp;</a></span>persistence_generator_data_str2struct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_generator_data_str2struct </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04705">4705</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d98/json_8c_source.html#l00546">ast_json_load_string()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">subscription_persistence::generator_data</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;{</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d96/structast__json__error.html">ast_json_error</a> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;   <span class="comment">/* We tolerate a failure of the JSON to load and instead start fresh, since this field</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment">    * originates from the persistence code and not a user.</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;   persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a> = <a class="code" href="../../d4/d05/json_8h.html#adca5179982d1f48df7127c123f15ce74">ast_json_load_string</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>);</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;}</div><div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="json_8h_html_adca5179982d1f48df7127c123f15ce74"><div class="ttname"><a href="../../d4/d05/json_8h.html#adca5179982d1f48df7127c123f15ce74">ast_json_load_string</a></div><div class="ttdeci">struct ast_json * ast_json_load_string(const char *input, struct ast_json_error *error)</div><div class="ttdoc">Parse null terminated string into a JSON object or array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00546">json.c:546</a></div></div>
<div class="ttc" id="structast__json__error_html"><div class="ttname"><a href="../../d0/d96/structast__json__error.html">ast_json_error</a></div><div class="ttdoc">JSON parsing error information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00829">json.h:829</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a4a9391ee88e57361b613c4c2fd2bf4aa"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a></div><div class="ttdeci">int error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00999">utils/frame.c:999</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a1805e05b0976bcd4f821f92c0206cba0"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">subscription_persistence::generator_data</a></div><div class="ttdeci">struct ast_json * generator_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">res_pjsip_pubsub.c:398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad276d9178ef9aad7e0d9ad2fbd52744d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad276d9178ef9aad7e0d9ad2fbd52744d">&#9670;&nbsp;</a></span>persistence_generator_data_struct2str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_generator_data_struct2str </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const intptr_t *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04718">4718</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d05/json_8h_source.html#l00763">ast_json_dump_string</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00052">ast_json_free()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">subscription_persistence::generator_data</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;{</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;   <span class="keywordflow">if</span> (!persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>) {</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;   }</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;   value = <a class="code" href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>);</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;   <span class="keywordflow">if</span> (!value) {</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;   }</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;   *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(value);</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a>(value);</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="json_8h_html_a38eea5afa847432f7c10af8e69fb013e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a></div><div class="ttdeci">void ast_json_free(void *p)</div><div class="ttdoc">Asterisk&amp;#39;s custom JSON allocator. Exposed for use by unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00052">json.c:52</a></div></div>
<div class="ttc" id="json_8h_html_a51a96b2baa67b671ac68a9fcaebbaeea"><div class="ttname"><a href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a></div><div class="ttdeci">#define ast_json_dump_string(root)</div><div class="ttdoc">Encode a JSON value to a compact string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00763">json.h:763</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a1805e05b0976bcd4f821f92c0206cba0"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">subscription_persistence::generator_data</a></div><div class="ttdeci">struct ast_json * generator_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">res_pjsip_pubsub.c:398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac028869908c724f84c3a1cee520315c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac028869908c724f84c3a1cee520315c">&#9670;&nbsp;</a></span>persistence_tag_str2struct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_tag_str2struct </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04689">4689</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;{</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;   persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;}</div><div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4305e5102dec63e8bbb9175dbab630e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4305e5102dec63e8bbb9175dbab630e">&#9670;&nbsp;</a></span>persistence_tag_struct2str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int persistence_tag_struct2str </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const intptr_t *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04697">4697</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;{</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb2474471fcc9b7191d508cf1b407417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2474471fcc9b7191d508cf1b407417">&#9670;&nbsp;</a></span>populate_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int populate_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set properties on an allocated resource list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">list</td><td>The list to set details on. </td></tr>
    <tr><td class="paramname">event</td><td>The list's event. </td></tr>
    <tr><td class="paramname">resources</td><td>Array of resources to add to the list. </td></tr>
    <tr><td class="paramname">num_resources</td><td>Number of resources in the array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">non-zero</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04942">4942</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04983">create_resource_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;{</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>, <a class="code" href="../../df/d7d/structevent.html">event</a>, <span class="keyword">sizeof</span>(list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>));</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; num_resources; ++i) {</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;      <span class="keywordtype">char</span> *resource = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(resources[i]);</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <span class="keywordflow">if</span> (!resource || <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, resource)) {</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(resource);</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;      }</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;   }</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;}</div><div class="ttc" id="structresource__list_html_a5053da7047dfe40d67229c5dbc361f8b"><div class="ttname"><a href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">resource_list::event</a></div><div class="ttdeci">char event[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">res_pjsip_pubsub.c:328</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34bc405d2cc3c85aa8d449185c3569d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34bc405d2cc3c85aa8d449185c3569d6">&#9670;&nbsp;</a></span>publication_cmp_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int publication_cmp_fn </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02701">2701</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01031">CMP_MATCH</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">ast_sip_publication::entity_tag</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">ast_sip_register_publish_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;{</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication1 = obj;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication2 = arg;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a> = arg;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;   <span class="keywordflow">return</span> (publication1-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a> == (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? *entity_tag : publication2-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a>) ?</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a> : 0);</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="structast__sip__publication_html_ae9dd8f0a26f1e5fdf7e5630d4dffadd3"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">ast_sip_publication::entity_tag</a></div><div class="ttdeci">int entity_tag</div><div class="ttdoc">Entity tag for the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">res_pjsip_pubsub.c:349</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9e99216a3b9def7b033ec0404e4140f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9e99216a3b9def7b033ec0404e4140f">&#9670;&nbsp;</a></span>publication_destroy_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void publication_destroy_fn </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal destructor for publications. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03133">3133</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00469">ast_module_unref</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">ast_sip_publication::endpoint</a>, and <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">sip_create_publication()</a>.</p>
<div class="fragment"><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;{</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication = obj;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Destroying SIP publication\n&quot;</span>);</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>);</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;}</div><div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_publication::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdoc">The endpoint with which the subscription is communicating. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">res_pjsip_pubsub.c:353</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a267cc6529937f4689c804fb39976a823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a267cc6529937f4689c804fb39976a823">&#9670;&nbsp;</a></span>publication_hash_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int publication_hash_fn </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02693">2693</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">ast_sip_publication::entity_tag</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">ast_sip_register_publish_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;{</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication = obj;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a> = obj;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   <span class="keywordflow">return</span> flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? *<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a> : publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a>;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="structast__sip__publication_html_ae9dd8f0a26f1e5fdf7e5630d4dffadd3"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">ast_sip_publication::entity_tag</a></div><div class="ttdeci">int entity_tag</div><div class="ttdoc">Entity tag for the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">res_pjsip_pubsub.c:349</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab24c7cae87fc8a55c3a59bbf69cf7352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab24c7cae87fc8a55c3a59bbf69cf7352">&#9670;&nbsp;</a></span>publication_resource_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* publication_resource_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocator for publication resource. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00567">567</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01728">ast_sorcery_generic_alloc()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00558">publication_resource_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;{</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a>), <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad470e06c57059377443112a2012ec8bd">publication_resource_destroy</a>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_ad470e06c57059377443112a2012ec8bd"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad470e06c57059377443112a2012ec8bd">publication_resource_destroy</a></div><div class="ttdeci">static void publication_resource_destroy(void *obj)</div><div class="ttdoc">Destructor for publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00558">res_pjsip_pubsub.c:558</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></div><div class="ttdoc">Structure representing a publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00509">res_pjsip_pubsub.c:509</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad470e06c57059377443112a2012ec8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad470e06c57059377443112a2012ec8bd">&#9670;&nbsp;</a></span>publication_resource_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void publication_resource_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for publication resource. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00558">558</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01263">ast_variables_destroy()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00513">ast_sip_publication_resource::endpoint</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00515">ast_sip_publication_resource::events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00567">publication_resource_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a> *resource = obj;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">events</a>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="include_2asterisk_2config_8h_html_adea5390496e5477192d86f340d512d04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a></div><div class="ttdeci">void ast_variables_destroy(struct ast_variable *var)</div><div class="ttdoc">Free variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01263">extconf.c:1263</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html#a6d2d1c31529bee906473fcabaffff34f">ast_sip_publication_resource::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdoc">Optional name of an endpoint that is only allowed to publish to this resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00513">res_pjsip_pubsub.c:513</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></div><div class="ttdoc">Structure representing a publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00509">res_pjsip_pubsub.c:509</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html_ad2ef61c498fc983f10336fd7b5876af7"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">ast_sip_publication_resource::events</a></div><div class="ttdeci">struct ast_variable * events</div><div class="ttdoc">Mapping for event types to configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00515">res_pjsip_pubsub.c:515</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb6d5815066f000bab8aa2aa43611f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6d5815066f000bab8aa2aa43611f6c">&#9670;&nbsp;</a></span>publish_add_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void publish_add_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02711">2711</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00740">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, and <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">ast_sip_register_publish_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;{</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>, handler, next);</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>);</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structpublish__handlers_html"><div class="ttname"><a href="../../df/d3c/structpublish__handlers.html">publish_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02691">res_pjsip_pubsub.c:2691</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93eb8c4f7adc89002faae30ba3b1da7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93eb8c4f7adc89002faae30ba3b1da7d">&#9670;&nbsp;</a></span>publish_expire()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int publish_expire </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03312">3312</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01598">ao2_unlink</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00351">ast_sip_publication::handler</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">ast_sip_publish_handler::publications</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03301">publish_expire_callback()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00357">ast_sip_publication::sched_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;{</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication = (<span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a>*)<a class="code" href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a2f64eb664f09b6d1dde7f4eed3f55862">handler</a>-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a>, publication);</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a5856afac1fb921f1d6a4eb1fe9412bc8">sched_id</a> = -1;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aaf5faf819b36c09254d66835d498e6e0">publish_expire_callback</a>, publication)) {</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publication);</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;   }</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_a9a3b4be1b9151b0369d7fca9911c7ecd"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">ast_sip_publication::data</a></div><div class="ttdeci">char data[0]</div><div class="ttdoc">Data containing the above. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00363">res_pjsip_pubsub.c:363</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aaf5faf819b36c09254d66835d498e6e0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aaf5faf819b36c09254d66835d498e6e0">publish_expire_callback</a></div><div class="ttdeci">static int publish_expire_callback(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03301">res_pjsip_pubsub.c:3301</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a2f64eb664f09b6d1dde7f4eed3f55862"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a2f64eb664f09b6d1dde7f4eed3f55862">ast_sip_publication::handler</a></div><div class="ttdeci">struct ast_sip_publish_handler * handler</div><div class="ttdoc">Handler for this publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00351">res_pjsip_pubsub.c:351</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_aac80748c488a3724f6ab7e1ef4b73530"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">ast_sip_publish_handler::publications</a></div><div class="ttdeci">struct ao2_container * publications</div><div class="ttdoc">Publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">res_pjsip_pubsub.h:54</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a5856afac1fb921f1d6a4eb1fe9412bc8"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a5856afac1fb921f1d6a4eb1fe9412bc8">ast_sip_publication::sched_id</a></div><div class="ttdeci">int sched_id</div><div class="ttdoc">Scheduled item for expiration of publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00357">res_pjsip_pubsub.c:357</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf5faf819b36c09254d66835d498e6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf5faf819b36c09254d66835d498e6e0">&#9670;&nbsp;</a></span>publish_expire_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int publish_expire_callback </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03301">3301</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03312">publish_expire()</a>.</p>
<div class="fragment"><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;{</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *, publication, <a class="code" href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;   <span class="keywordflow">if</span> (publication-&gt;handler-&gt;publish_expire) {</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      publication-&gt;handler-&gt;publish_expire(publication);</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   }</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_a9a3b4be1b9151b0369d7fca9911c7ecd"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">ast_sip_publication::data</a></div><div class="ttdeci">char data[0]</div><div class="ttdoc">Data containing the above. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00363">res_pjsip_pubsub.c:363</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abefb888baf6382d9f1a1266d24e21648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abefb888baf6382d9f1a1266d24e21648">&#9670;&nbsp;</a></span>publish_request_initial()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a>* publish_request_initial </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03214">3214</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00039">AST_SIP_PUBLISH_STATE_INITIALIZED</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">ast_sip_publish_handler::event_name</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00351">ast_sip_publication::handler</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">ast_variable::name</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00064">ast_sip_publish_handler::new_publication</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">ast_variable::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00088">ast_sip_publish_handler::publication_state_change</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">ast_sip_publication::resource</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">sip_create_publication()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">sip_publication_respond()</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;{</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   <span class="keywordtype">char</span> *resource_name;</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;   <span class="keywordtype">size_t</span> resource_size;</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a> *, <a class="code" href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">resource</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *event_configuration_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;   pjsip_uri *request_uri;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;   pjsip_sip_uri *request_uri_sip;</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;   request_uri = rdata-&gt;msg_info.msg-&gt;line.req.uri;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(request_uri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(request_uri)) {</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <span class="keywordtype">char</span> uri_str[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_REQ_URI, request_uri, uri_str, <span class="keyword">sizeof</span>(uri_str));</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Request URI &#39;%s&#39; is not a sip: or sips: URI.\n&quot;</span>, uri_str);</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 416, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;   }</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;   request_uri_sip = pjsip_uri_get_uri(request_uri);</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;   resource_size = pj_strlen(&amp;request_uri_sip-&gt;user) + 1;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;   resource_name = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(resource_size);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(resource_name, &amp;request_uri_sip-&gt;user, resource_size);</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">    * We may want to match without any user options getting</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">    * in the way.</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(resource_name);</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;   resource = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;inbound-publication&quot;</span>, resource_name);</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;   <span class="keywordflow">if</span> (!resource) {</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;No &#39;inbound-publication&#39; defined for resource &#39;%s&#39;\n&quot;</span>, resource_name);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 404, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;   }</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(resource-&gt;endpoint) &amp;&amp; strcmp(resource-&gt;endpoint, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint))) {</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Resource %s has a defined endpoint &#39;%s&#39;, but does not match endpoint &#39;%s&#39; that received the request\n&quot;</span>,</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;         resource_name, resource-&gt;endpoint, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 403, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;   }</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;   <span class="keywordflow">for</span> (event_configuration_name = resource-&gt;events; event_configuration_name; event_configuration_name = event_configuration_name-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      <span class="keywordflow">if</span> (!strcmp(event_configuration_name-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>)) {</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      }</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;   }</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;   <span class="keywordflow">if</span> (!event_configuration_name) {</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Event &#39;%s&#39; is not configured for &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>, resource_name);</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 404, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;   }</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   resp = handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#a3bcafa1a0d7e03921ef2883953be90ae">new_publication</a>(endpoint, resource_name, event_configuration_name-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_IS_STATUS_IN_CLASS(resp, 200)) {</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, resp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;   }</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;   publication = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab8fd4e13f8412f935f22b1df916b55a3">sip_create_publication</a>(endpoint, rdata, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(resource_name, <span class="stringliteral">&quot;&quot;</span>), event_configuration_name-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;   <span class="keywordflow">if</span> (!publication) {</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 503, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;   }</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a2f64eb664f09b6d1dde7f4eed3f55862">handler</a> = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;   <span class="keywordflow">if</span> (publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a2f64eb664f09b6d1dde7f4eed3f55862">handler</a>-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#af0ab5befc3e79fb52d28e243c8ac14e0">publication_state_change</a>(publication, rdata-&gt;msg_info.msg-&gt;body,</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;         <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562ab368f4beb502956f3544f351c116ade6">AST_SIP_PUBLISH_STATE_INITIALIZED</a>)) {</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publication);</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;   }</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a20aeeed556614ef809787fb4f04de0fb">sip_publication_respond</a>(publication, resp, rdata);</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;   <span class="keywordflow">return</span> publication;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;}</div><div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_publish_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdoc">The name of the event this handler deals with. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">res_pjsip_pubsub.h:51</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_a3bcafa1a0d7e03921ef2883953be90ae"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#a3bcafa1a0d7e03921ef2883953be90ae">ast_sip_publish_handler::new_publication</a></div><div class="ttdeci">int(* new_publication)(struct ast_sip_endpoint *endpoint, const char *resource, const char *event_configuration)</div><div class="ttdoc">Called when a PUBLISH to establish a new publication arrives. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00064">res_pjsip_pubsub.h:64</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_af0ab5befc3e79fb52d28e243c8ac14e0"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#af0ab5befc3e79fb52d28e243c8ac14e0">ast_sip_publish_handler::publication_state_change</a></div><div class="ttdeci">int(* publication_state_change)(struct ast_sip_publication *pub, pjsip_msg_body *body, enum ast_sip_publish_state state)</div><div class="ttdoc">Published resource has changed states. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00088">res_pjsip_pubsub.h:88</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a2f64eb664f09b6d1dde7f4eed3f55862"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a2f64eb664f09b6d1dde7f4eed3f55862">ast_sip_publication::handler</a></div><div class="ttdeci">struct ast_sip_publish_handler * handler</div><div class="ttdoc">Handler for this publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00351">res_pjsip_pubsub.c:351</a></div></div>
<div class="ttc" id="structast__sip__publication_html_add9403c2dd81e949c8c4aa872eabdcc7"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">ast_sip_publication::resource</a></div><div class="ttdeci">char * resource</div><div class="ttdoc">The resource the publication is to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">res_pjsip_pubsub.c:359</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a20aeeed556614ef809787fb4f04de0fb"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a20aeeed556614ef809787fb4f04de0fb">sip_publication_respond</a></div><div class="ttdeci">static int sip_publication_respond(struct ast_sip_publication *pub, int status_code, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">res_pjsip_pubsub.c:3179</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab8fd4e13f8412f935f22b1df916b55a3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab8fd4e13f8412f935f22b1df916b55a3">sip_create_publication</a></div><div class="ttdeci">static struct ast_sip_publication * sip_create_publication(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, const char *resource, const char *event_configuration_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">res_pjsip_pubsub.c:3145</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a0a56204d9bae50c4103725ef62aab562ab368f4beb502956f3544f351c116ade6"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562ab368f4beb502956f3544f351c116ade6">AST_SIP_PUBLISH_STATE_INITIALIZED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00039">res_pjsip_pubsub.h:39</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></div><div class="ttdoc">Structure representing a publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00509">res_pjsip_pubsub.c:509</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a26689d72ab3ff9ce0e56c26fdc6dfd4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26689d72ab3ff9ce0e56c26fdc6dfd4b">&#9670;&nbsp;</a></span>pubsub_on_client_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pubsub_on_client_refresh </td>
          <td>(</td>
          <td class="paramtype">pjsip_evsub *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03989">3989</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03969">serialized_pubsub_on_client_refresh()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>.</p>
<div class="fragment"><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;{</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;   <span class="keywordflow">if</span> (!(sub_tree = pjsip_evsub_get_mod_data(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id))) {</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;   }</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a45317a8f9762fa3b934c723df1367336">serialized_pubsub_on_client_refresh</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree))) {</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;   }</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a45317a8f9762fa3b934c723df1367336"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a45317a8f9762fa3b934c723df1367336">serialized_pubsub_on_client_refresh</a></div><div class="ttdeci">static int serialized_pubsub_on_client_refresh(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03969">res_pjsip_pubsub.c:3969</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9edd9dcca7f3caf9af7a4af20ab64868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9edd9dcca7f3caf9af7a4af20ab64868">&#9670;&nbsp;</a></span>pubsub_on_evsub_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pubsub_on_evsub_state </td>
          <td>(</td>
          <td class="paramtype">pjsip_evsub *&#160;</td>
          <td class="paramname"><em>evsub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback sequence for subscription terminate: </p>
<ul>
<li>Client initiated: pjproject receives SUBSCRIBE on the subscription's serializer thread calls pubsub_on_rx_refresh with dialog locked pubsub_on_rx_refresh sets TERMINATE_PENDING pushes serialized_pubsub_on_refresh_timeout returns to pjproject pjproject calls pubsub_on_evsub_state pubsub_evsub_set_state checks state == TERMINATE_IN_PROGRESS (no) ignore and return pjproject unlocks dialog serialized_pubsub_on_refresh_timeout starts (1) locks dialog checks state == TERMINATE_PENDING sets TERMINATE_IN_PROGRESS calls send_notify (2) send_notify ultimately calls pjsip_evsub_send_request pjsip_evsub_send_request calls evsub's set_state set_state calls pubsub_evsub_set_state pubsub_on_evsub_state checks state == TERMINATE_IN_PROGRESS removes the subscriptions cleans up references to evsub sets state = TERMINATED serialized_pubsub_on_refresh_timeout unlocks dialog</li>
<li>Subscription timer expires: pjproject timer expires locks dialog calls pubsub_on_server_timeout pubsub_on_server_timeout checks state == NORMAL sets TERMINATE_PENDING pushes serialized_pubsub_on_refresh_timeout returns to pjproject pjproject unlocks dialog serialized_pubsub_on_refresh_timeout starts See (1) Above</li>
<li>Transmission failure sending NOTIFY or error response from client pjproject transaction timer expires or non OK response pjproject locks dialog calls pubsub_on_evsub_state with event TSX_STATE pubsub_on_evsub_state checks event == TSX_STATE removes the subscriptions cleans up references to evsub sets state = TERMINATED pjproject unlocks dialog</li>
<li>ast_sip_subscription_notify is called checks state == NORMAL if not batched... sets TERMINATE_IN_PROGRESS (if terminate is requested) calls send_notify See (2) Above if batched... sets TERMINATE_PENDING schedules task scheduler runs sched_task sched_task pushes serialized_send_notify serialized_send_notify starts checks state &lt;= TERMINATE_PENDING if state == TERMINATE_PENDING set state = TERMINATE_IN_PROGRESS call send_notify See (2) Above</li>
</ul>
<p>PJSIP callback when underlying SIP subscription changes state</p>
<p>Although this function is called for every state change, we only care about the TERMINATED state, and only when we're actually processing the final notify (SIP_SUB_TREE_TERMINATE_IN_PROGRESS) OR when a transmission failure occurs (PJSIP_EVENT_TSX_STATE). In this case, we do all the subscription tree cleanup tasks and decrement the evsub reference. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">3807</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">ast_sip_dialog_set_endpoint()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">ast_sip_dialog_set_serializer()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">ast_sip_sched_task_cancel()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00334">ast_sip_sched_task_get_name()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">sip_subscription_tree::expiration_task</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01182">remove_subscription()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01328">shutdown_subscriptions()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">SIP_SUB_TREE_NORMAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00412">SIP_SUB_TREE_TERMINATED</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">sub_tree_state_description</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">subscription_persistence_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;{</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree =</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      pjsip_evsub_get_mod_data(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id);</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;evsub %p state %s event %s sub_tree %p sub_tree state %s\n&quot;</span>, <a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>,</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      pjsip_evsub_get_state_name(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>), pjsip_event_str(<a class="code" href="../../df/d7d/structevent.html">event</a>-&gt;type), sub_tree,</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      (sub_tree ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a>[sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a>] : <span class="stringliteral">&quot;UNKNOWN&quot;</span>));</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;   <span class="keywordflow">if</span> (!sub_tree || pjsip_evsub_get_state(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>) != PJSIP_EVSUB_STATE_TERMINATED) {</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;   }</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;   <span class="comment">/* It&#39;s easier to write this as what we WANT to process, then negate it. */</span></div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;   <span class="keywordflow">if</span> (!(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      || (<a class="code" href="../../df/d7d/structevent.html">event</a>-&gt;type == PJSIP_EVENT_TSX_STATE &amp;&amp; sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>)</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      )) {</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Do nothing.\n&quot;</span>);</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;   }</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>) {</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      <span class="keywordtype">char</span> task_name[256];</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga78b7691fb1bf1717a7961a68ceed5886">ast_sip_sched_task_get_name</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>, task_name, <span class="keyword">sizeof</span>(task_name));</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Cancelling timer: %s\n&quot;</span>, task_name);</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>);</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>);</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   }</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a55772a6ad10b532f9ae2085ceb0c3942">remove_subscription</a>(sub_tree);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;   pjsip_evsub_set_mod_data(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_EVSUB_GRP_LOCK</span></div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;   pjsip_evsub_dec_ref(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>);</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aace626897b8057471bc8f06b3e91e16c">subscription_persistence_remove</a>(sub_tree);</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a52b5a301995d607923de2caddcdcdb62">shutdown_subscriptions</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>);</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a>;</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;   <span class="comment">/* Remove evsub&#39;s reference to the sub_tree */</span></div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a55772a6ad10b532f9ae2085ceb0c3942"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a55772a6ad10b532f9ae2085ceb0c3942">remove_subscription</a></div><div class="ttdeci">static void remove_subscription(struct sip_subscription_tree *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01182">res_pjsip_pubsub.c:1182</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">res_pjsip_pubsub.c:406</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga74acadc4e87ea1cea9cdddba4734bccc"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a></div><div class="ttdeci">int ast_sip_sched_task_cancel(struct ast_sip_sched_task *schtd)</div><div class="ttdoc">Cancels the next invocation of a task. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">pjsip_scheduler.c:191</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga86c62fe22e3b7fb409c13ec7fd4fee2d"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a></div><div class="ttdeci">void ast_sip_dialog_set_serializer(pjsip_dialog *dlg, struct ast_taskprocessor *serializer)</div><div class="ttdoc">Set a serializer on a SIP dialog so requests and responses are automatically serialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">pjsip_distributor.c:266</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga6d8415024c851216fa63fbb94d0aadcf"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a></div><div class="ttdeci">void ast_sip_dialog_set_endpoint(pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint)</div><div class="ttdoc">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">pjsip_distributor.c:294</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a6ba01bbffb64da676cd5176bb1d918b9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a></div><div class="ttdeci">static char * sub_tree_state_description[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">res_pjsip_pubsub.c:415</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00412">res_pjsip_pubsub.c:412</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aace626897b8057471bc8f06b3e91e16c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aace626897b8057471bc8f06b3e91e16c">subscription_persistence_remove</a></div><div class="ttdeci">static void subscription_persistence_remove(struct sip_subscription_tree *sub_tree)</div><div class="ttdoc">Function which removes persistence of a subscription from sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">res_pjsip_pubsub.c:745</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_afc1efa41dfd583546f0fb620d85bbef8"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">sip_subscription_tree::expiration_task</a></div><div class="ttdeci">struct ast_sip_sched_task * expiration_task</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">res_pjsip_pubsub.c:462</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a52b5a301995d607923de2caddcdcdb62"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a52b5a301995d607923de2caddcdcdb62">shutdown_subscriptions</a></div><div class="ttdeci">static void shutdown_subscriptions(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01328">res_pjsip_pubsub.c:1328</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga78b7691fb1bf1717a7961a68ceed5886"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga78b7691fb1bf1717a7961a68ceed5886">ast_sip_sched_task_get_name</a></div><div class="ttdeci">int ast_sip_sched_task_get_name(struct ast_sip_sched_task *schtd, char *name, size_t maxlen)</div><div class="ttdoc">Gets the task name. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00334">pjsip_scheduler.c:334</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31b603dda9cf0a3354575494f0d4f9f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b603dda9cf0a3354575494f0d4f9f9">&#9670;&nbsp;</a></span>pubsub_on_refresh_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pubsub_on_refresh_timeout </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">3859</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03720">set_state_terminated()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">SIP_SUB_TREE_TERMINATE_PENDING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">sub_tree_state_description</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02887">generate_initial_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">serialized_pubsub_on_refresh_timeout()</a>.</p>
<div class="fragment"><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;{</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = userdata;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;   pjsip_dialog *<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;sub_tree %p sub_tree state %s\n&quot;</span>, sub_tree,</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      (sub_tree ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a>[sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a>] : <span class="stringliteral">&quot;UNKNOWN&quot;</span>));</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;   pjsip_dlg_inc_lock(dlg);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> &gt;= <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>) {</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;      pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;   }</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>) {</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>;</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8c5bddecd1c2126c026728ca98750b0">set_state_terminated</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>);</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;   }</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a>(sub_tree, 1);</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;subscription_state == PJSIP_EVSUB_STATE_TERMINATED ?</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            <span class="stringliteral">&quot;SUBSCRIPTION_TERMINATED&quot;</span> : <span class="stringliteral">&quot;SUBSCRIPTION_REFRESHED&quot;</span>,</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;            <span class="stringliteral">&quot;Resource: %s&quot;</span>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource);</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;   pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a6ba01bbffb64da676cd5176bb1d918b9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a></div><div class="ttdeci">static char * sub_tree_state_description[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">res_pjsip_pubsub.c:415</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8b3391cb48972f432118c4ca2eeb3063"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a></div><div class="ttdeci">static int send_notify(struct sip_subscription_tree *sub_tree, unsigned int force_full_state)</div><div class="ttdoc">Send a NOTIFY request to a subscriber. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">res_pjsip_pubsub.c:2425</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad8c5bddecd1c2126c026728ca98750b0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8c5bddecd1c2126c026728ca98750b0">set_state_terminated</a></div><div class="ttdeci">static void set_state_terminated(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03720">res_pjsip_pubsub.c:3720</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">res_pjsip_pubsub.c:408</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9982efe78ddb41fc54368049fe7ecdfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9982efe78ddb41fc54368049fe7ecdfc">&#9670;&nbsp;</a></span>pubsub_on_rx_mwi_notify_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t pubsub_on_rx_mwi_notify_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03614">3614</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../dc/d33/mwi_8h_source.html#l00380">ast_publish_mwi_state</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00116">context</a>, <a class="el" href="../../d6/d47/utils_2frame_8c_source.html#l00999">error()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">mailbox</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03582">simple_message_summary::message_account</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03585">parse_simple_message_summary()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03578">simple_message_summary::voice_messages_new</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03579">simple_message_summary::voice_messages_old</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03580">simple_message_summary::voice_messages_urgent_new</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03581">simple_message_summary::voice_messages_urgent_old</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03697">pubsub_on_rx_notify_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;{</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, <a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d4c/structsimple__message__summary.html">simple_message_summary</a> summary;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *endpoint_name;</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;   <span class="keywordtype">char</span> *atsign;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;   <span class="keywordtype">char</span> *body;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a>;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;   <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;   endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata);</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: Endpoint not found in rdata (%p)\n&quot;</span>, rdata);</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      rc = 404;</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;   }</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;   endpoint_name = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint);</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: Found endpoint: %s\n&quot;</span>, endpoint_name);</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(endpoint-&gt;incoming_mwi_mailbox)) {</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: No incoming mailbox specified for endpoint &#39;%s&#39;\n&quot;</span>, endpoint_name);</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PUBSUB_NO_INCOMING_MWI_MAILBOX&quot;</span>,</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;         <span class="stringliteral">&quot;Endpoint: %s&quot;</span>, endpoint_name);</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      rc = 404;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;   }</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;   mailbox = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(endpoint-&gt;incoming_mwi_mailbox);</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;   atsign = strchr(mailbox, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;   <span class="keywordflow">if</span> (!atsign) {</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: No &#39;@&#39; found in endpoint %s&#39;s incoming mailbox &#39;%s&#39;.  Can&#39;t parse context\n&quot;</span>,</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;         endpoint_name, endpoint-&gt;incoming_mwi_mailbox);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      rc = 404;</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;   }</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;   *atsign = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;   context = atsign + 1;</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;   body = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(rdata-&gt;msg_info.msg-&gt;body-&gt;len + 1);</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;   rdata-&gt;msg_info.msg-&gt;body-&gt;print_body(rdata-&gt;msg_info.msg-&gt;body, body,</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      rdata-&gt;msg_info.msg-&gt;body-&gt;len + 1);</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6a2ec9c29cf673a20f527615e5acb98b">parse_simple_message_summary</a>(body, &amp;summary) != 0) {</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: Endpoint: &#39;%s&#39; There was an issue getting message info from body &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), body);</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      rc = 404;</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;   }</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d33/mwi_8h.html#ae7328cd8d8b2120de46b1d2afac99f18">ast_publish_mwi_state</a>(mailbox, context,</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      summary.voice_messages_new, summary.voice_messages_old)) {</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Incoming MWI: Endpoint: &#39;%s&#39; Could not publish MWI to stasis.  &quot;</span></div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;         <span class="stringliteral">&quot;Mailbox: %s Message-Account: %s Voice-Messages: %d/%d (%d/%d)\n&quot;</span>,</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;         endpoint_name, endpoint-&gt;incoming_mwi_mailbox, summary.message_account,</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;         summary.voice_messages_new, summary.voice_messages_old,</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;         summary.voice_messages_urgent_new, summary.voice_messages_urgent_old);</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      rc = 404;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Incoming MWI: Endpoint: &#39;%s&#39; Mailbox: %s Message-Account: %s Voice-Messages: %d/%d (%d/%d)\n&quot;</span>,</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;         endpoint_name, endpoint-&gt;incoming_mwi_mailbox, summary.message_account,</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;         summary.voice_messages_new, summary.voice_messages_old,</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;         summary.voice_messages_urgent_new, summary.voice_messages_urgent_old);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PUBSUB_INCOMING_MWI_PUBLISH&quot;</span>,</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;         <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span></div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;         <span class="stringliteral">&quot;Mailbox: %s\r\n&quot;</span></div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;         <span class="stringliteral">&quot;MessageAccount: %s\r\n&quot;</span></div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;         <span class="stringliteral">&quot;VoiceMessagesNew: %d\r\n&quot;</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;         <span class="stringliteral">&quot;VoiceMessagesOld: %d\r\n&quot;</span></div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;         <span class="stringliteral">&quot;VoiceMessagesUrgentNew: %d\r\n&quot;</span></div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;         <span class="stringliteral">&quot;VoiceMessagesUrgentOld: %d&quot;</span>,</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;            endpoint_name, endpoint-&gt;incoming_mwi_mailbox, summary.message_account,</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            summary.voice_messages_new, summary.voice_messages_old,</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            summary.voice_messages_urgent_new, summary.voice_messages_urgent_old);</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      rc = 200;</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;   }</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>:</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;   pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, rc, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a6a2ec9c29cf673a20f527615e5acb98b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a6a2ec9c29cf673a20f527615e5acb98b">parse_simple_message_summary</a></div><div class="ttdeci">static int parse_simple_message_summary(char *body, struct simple_message_summary *summary)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03585">res_pjsip_pubsub.c:3585</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="mwi_8h_html_ae7328cd8d8b2120de46b1d2afac99f18"><div class="ttname"><a href="../../dc/d33/mwi_8h.html#ae7328cd8d8b2120de46b1d2afac99f18">ast_publish_mwi_state</a></div><div class="ttdeci">#define ast_publish_mwi_state(mailbox, context, new_msgs, old_msgs)</div><div class="ttdoc">Publish a MWI state update via stasis. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00380">mwi.h:380</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b49cafa2a3d359a2e865992f551874a"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a></div><div class="ttdeci">static char mailbox[AST_MAX_MAILBOX_UNIQUEID]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">chan_mgcp.c:204</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a4a9391ee88e57361b613c4c2fd2bf4aa"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a></div><div class="ttdeci">int error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00999">utils/frame.c:999</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="structsimple__message__summary_html"><div class="ttname"><a href="../../d0/d4c/structsimple__message__summary.html">simple_message_summary</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03576">res_pjsip_pubsub.c:3576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9f60cf5b4683fabadff63143ef959f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f60cf5b4683fabadff63143ef959f2">&#9670;&nbsp;</a></span>pubsub_on_rx_notify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pubsub_on_rx_notify </td>
          <td>(</td>
          <td class="paramtype">pjsip_evsub *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_st_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_str_t **&#160;</td>
          <td class="paramname"><em>p_st_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_hdr *&#160;</td>
          <td class="paramname"><em>res_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_msg_body **&#160;</td>
          <td class="paramname"><em>p_body</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03956">3956</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00311">ast_sip_subscriber::state_change</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00337">ast_sip_subscription_handler::subscriber</a>.</p>
<div class="fragment"><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;{</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;   <span class="keywordflow">if</span> (!(sub = pjsip_evsub_get_mod_data(evsub, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id))) {</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;   }</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;   sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aa63e03b2552c36d21f2bb7bffd26a06a">subscriber</a>-&gt;<a class="code" href="../../db/dd4/structast__sip__subscriber.html#a6cd23572cbfc2d0302ac6929a18a975b">state_change</a>(sub, rdata-&gt;msg_info.msg-&gt;body,</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;         pjsip_evsub_get_state(evsub));</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;}</div><div class="ttc" id="structast__sip__subscription__handler_html_aa63e03b2552c36d21f2bb7bffd26a06a"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aa63e03b2552c36d21f2bb7bffd26a06a">ast_sip_subscription_handler::subscriber</a></div><div class="ttdeci">struct ast_sip_subscriber * subscriber</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00337">res_pjsip_pubsub.h:337</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="structast__sip__subscription_html"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a></div><div class="ttdoc">Structure representing a &quot;virtual&quot; SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00477">res_pjsip_pubsub.c:477</a></div></div>
<div class="ttc" id="structast__sip__subscriber_html_a6cd23572cbfc2d0302ac6929a18a975b"><div class="ttname"><a href="../../db/dd4/structast__sip__subscriber.html#a6cd23572cbfc2d0302ac6929a18a975b">ast_sip_subscriber::state_change</a></div><div class="ttdeci">void(* state_change)(struct ast_sip_subscription *sub, pjsip_msg_body *body, enum pjsip_evsub_state state)</div><div class="ttdoc">A NOTIFY has been received. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00311">res_pjsip_pubsub.h:311</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba712df013e1be0394a2c2943a595376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba712df013e1be0394a2c2943a595376">&#9670;&nbsp;</a></span>pubsub_on_rx_notify_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t pubsub_on_rx_notify_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03697">3697</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05259">ast_sip_is_content_type()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03614">pubsub_on_rx_mwi_notify_request()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">pubsub_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;{</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;body &amp;&amp;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(&amp;rdata-&gt;msg_info.msg-&gt;body-&gt;content_type,</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                        <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;simple-message-summary&quot;</span>)) {</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a9982efe78ddb41fc54368049fe7ecdfc">pubsub_on_rx_mwi_notify_request</a>(rdata);</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;   }</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;   <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a9982efe78ddb41fc54368049fe7ecdfc"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a9982efe78ddb41fc54368049fe7ecdfc">pubsub_on_rx_mwi_notify_request</a></div><div class="ttdeci">static pj_bool_t pubsub_on_rx_mwi_notify_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03614">res_pjsip_pubsub.c:3614</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae47a39537fdf10ceba2fad9d9c380179"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a></div><div class="ttdeci">int ast_sip_is_content_type(pjsip_media_type *content_type, char *type, char *subtype)</div><div class="ttdoc">Checks if the given content type matches type/subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05259">res_pjsip.c:5259</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4dba55f11df69f28d19d9125e3995334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dba55f11df69f28d19d9125e3995334">&#9670;&nbsp;</a></span>pubsub_on_rx_publish_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t pubsub_on_rx_publish_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">3326</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00080">AST_SCHED_DEL_UNREF</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00150">AST_SCHED_REPLACE_UNREF</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00041">AST_SIP_PUBLISH_STATE_ACTIVE</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00043">AST_SIP_PUBLISH_STATE_TERMINATED</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03102">determine_sip_publish_type()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00340">esc_etag_counter</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03084">find_pub_handler()</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00088">ast_sip_publish_handler::publication_state_change</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">ast_sip_publish_handler::publications</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03312">publish_expire()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03214">publish_request_initial()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">sip_publication_respond()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00285">SIP_PUBLISH_INITIAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00305">SIP_PUBLISH_MODIFY</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00295">SIP_PUBLISH_REFRESH</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00314">SIP_PUBLISH_REMOVE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00274">SIP_PUBLISH_UNKNOWN</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00238">str_event_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">pubsub_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;{</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   pjsip_event_hdr *event_header;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;   <span class="keywordtype">char</span> <span class="keyword">event</span>[32];</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t str_sip_if_match = { <span class="stringliteral">&quot;SIP-If-Match&quot;</span>, 12 };</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   pjsip_generic_string_hdr *etag_hdr = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;str_sip_if_match, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a> publish_type;</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *, publication, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> expires = 0;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;   <span class="keywordtype">int</span> entity_id, response = 0;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;   endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata);</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(endpoint != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;   event_header = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4abffbee599d833b446686d5213d80e4">str_event_name</a>, rdata-&gt;msg_info.msg-&gt;hdr.next);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;   <span class="keywordflow">if</span> (!event_header) {</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Incoming PUBLISH request from %s with no Event header\n&quot;</span>,</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 489, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;   }</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>, &amp;event_header-&gt;event_type, <span class="keyword">sizeof</span>(<a class="code" href="../../df/d7d/structevent.html">event</a>));</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;   handler = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a52a5833004176713878b9cbf3c311ec0">find_pub_handler</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>);</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   <span class="keywordflow">if</span> (!handler) {</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No registered publish handler for event %s from %s\n&quot;</span>, <a class="code" href="../../df/d7d/structevent.html">event</a>,</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 489, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;   }</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;   publish_type = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad4c0e99b92215cdc4a96b439c108cd0a">determine_sip_publish_type</a>(rdata, etag_hdr, &amp;expires, &amp;entity_id);</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   <span class="comment">/* If this is not an initial publish ensure that a publication is present */</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <span class="keywordflow">if</span> ((publish_type != <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>) &amp;&amp; (publish_type != <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>)) {</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <span class="keywordflow">if</span> (!(publication = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a>, &amp;entity_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a>))) {</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;         <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t str_conditional_request_failed = { <span class="stringliteral">&quot;Conditional Request Failed&quot;</span>, 26 };</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 412, &amp;str_conditional_request_failed,</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;            <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;         <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      }</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      <span class="comment">/* Per the RFC every response has to have a new entity tag */</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      publication-&gt;entity_tag = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e7031430a4ba4c21aac39b482ffd82">esc_etag_counter</a>, +1);</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;      <span class="comment">/* Update the expires here so that the created responses will contain the correct value */</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      publication-&gt;expires = expires;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;   }</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   <span class="keywordflow">switch</span> (publish_type) {</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a>:</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;         publication = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abefb888baf6382d9f1a1266d24e21648">publish_request_initial</a>(endpoint, rdata, handler);</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a>:</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a>:</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;         <span class="keywordflow">if</span> (handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#af0ab5befc3e79fb52d28e243c8ac14e0">publication_state_change</a>(publication, rdata-&gt;msg_info.msg-&gt;body,</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                  <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562a5d64d62e9e58a0f155318ab2bc94ade3">AST_SIP_PUBLISH_STATE_ACTIVE</a>)) {</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            <span class="comment">/* If an error occurs we want to terminate the publication */</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            expires = 0;</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;         }</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;         response = 200;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a>:</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;         handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#af0ab5befc3e79fb52d28e243c8ac14e0">publication_state_change</a>(publication, rdata-&gt;msg_info.msg-&gt;body,</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;               <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562a797a8ff87d8dc4f37be06d27c0687352">AST_SIP_PUBLISH_STATE_TERMINATED</a>);</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;         response = 200;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a>:</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 400, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;   }</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;   <span class="keywordflow">if</span> (publication) {</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      <span class="keywordflow">if</span> (expires) {</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(handler-&gt;<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">publications</a>, publication);</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;         <a class="code" href="../../d7/d00/sched_8h.html#a2a9174d10a79bd233b8498a11201f681">AST_SCHED_REPLACE_UNREF</a>(publication-&gt;sched_id, <a class="code" href="../../d0/da0/structsched.html">sched</a>, expires * 1000, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a93eb8c4f7adc89002faae30ba3b1da7d">publish_expire</a>, publication,</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                  <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(_data, -1), <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publication, -1), <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publication, +1));</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;         <a class="code" href="../../d7/d00/sched_8h.html#a11e2d4283c11790a27a0f899dab00e93">AST_SCHED_DEL_UNREF</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>, publication-&gt;<a class="code" href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched_id</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publication, -1));</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      }</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;   }</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;   <span class="keywordflow">if</span> (response) {</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a20aeeed556614ef809787fb4f04de0fb">sip_publication_respond</a>(publication, response, rdata);</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;   }</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a52a5833004176713878b9cbf3c311ec0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a52a5833004176713878b9cbf3c311ec0">find_pub_handler</a></div><div class="ttdeci">static struct ast_sip_publish_handler * find_pub_handler(const char *event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03084">res_pjsip_pubsub.c:3084</a></div></div>
<div class="ttc" id="structsched_html_a93dd3716ed95f47290226a31c91530e2"><div class="ttname"><a href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched::sched_id</a></div><div class="ttdeci">struct sched_id * sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00079">sched.c:79</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a93eb8c4f7adc89002faae30ba3b1da7d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a93eb8c4f7adc89002faae30ba3b1da7d">publish_expire</a></div><div class="ttdeci">static int publish_expire(const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03312">res_pjsip_pubsub.c:3312</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="sched_8h_html_a11e2d4283c11790a27a0f899dab00e93"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a11e2d4283c11790a27a0f899dab00e93">AST_SCHED_DEL_UNREF</a></div><div class="ttdeci">#define AST_SCHED_DEL_UNREF(sched, id, refcall)</div><div class="ttdoc">schedule task to get deleted and call unref function </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00080">sched.h:80</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a0a56204d9bae50c4103725ef62aab562a5d64d62e9e58a0f155318ab2bc94ade3"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562a5d64d62e9e58a0f155318ab2bc94ade3">AST_SIP_PUBLISH_STATE_ACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00041">res_pjsip_pubsub.h:41</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a9b252001716803d21529f825433f4008">SIP_PUBLISH_UNKNOWN</a></div><div class="ttdoc">Unknown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00274">res_pjsip_pubsub.c:274</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a0a56204d9bae50c4103725ef62aab562a797a8ff87d8dc4f37be06d27c0687352"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562a797a8ff87d8dc4f37be06d27c0687352">AST_SIP_PUBLISH_STATE_TERMINATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00043">res_pjsip_pubsub.h:43</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a83a82444fd66df13a6196fe98cedff69">SIP_PUBLISH_REFRESH</a></div><div class="ttdoc">Refresh. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00295">res_pjsip_pubsub.c:295</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_af0ab5befc3e79fb52d28e243c8ac14e0"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#af0ab5befc3e79fb52d28e243c8ac14e0">ast_sip_publish_handler::publication_state_change</a></div><div class="ttdeci">int(* publication_state_change)(struct ast_sip_publication *pub, pjsip_msg_body *body, enum ast_sip_publish_state state)</div><div class="ttdoc">Published resource has changed states. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00088">res_pjsip_pubsub.h:88</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abefb888baf6382d9f1a1266d24e21648"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abefb888baf6382d9f1a1266d24e21648">publish_request_initial</a></div><div class="ttdeci">static struct ast_sip_publication * publish_request_initial(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, struct ast_sip_publish_handler *handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03214">res_pjsip_pubsub.c:3214</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad4c0e99b92215cdc4a96b439c108cd0a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad4c0e99b92215cdc4a96b439c108cd0a">determine_sip_publish_type</a></div><div class="ttdeci">static enum sip_publish_type determine_sip_publish_type(pjsip_rx_data *rdata, pjsip_generic_string_hdr *etag_hdr, unsigned int *expires, int *entity_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03102">res_pjsip_pubsub.c:3102</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a></div><div class="ttdoc">Callbacks that publication handlers will define. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00049">res_pjsip_pubsub.h:49</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a20aeeed556614ef809787fb4f04de0fb"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a20aeeed556614ef809787fb4f04de0fb">sip_publication_respond</a></div><div class="ttdeci">static int sip_publication_respond(struct ast_sip_publication *pub, int status_code, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">res_pjsip_pubsub.c:3179</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="sched_8h_html_a2a9174d10a79bd233b8498a11201f681"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a2a9174d10a79bd233b8498a11201f681">AST_SCHED_REPLACE_UNREF</a></div><div class="ttdeci">#define AST_SCHED_REPLACE_UNREF(id, sched, when, callback, data, unrefcall, addfailcall, refcall)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00150">sched.h:150</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311ad4fc06a713557a6d936557a69615d519">SIP_PUBLISH_MODIFY</a></div><div class="ttdoc">Modify. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00305">res_pjsip_pubsub.c:305</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="sip_8h_html_a42ecd8494df028dc44c95b90848ad311"><div class="ttname"><a href="../../d1/d94/sip_8h.html#a42ecd8494df028dc44c95b90848ad311">sip_publish_type</a></div><div class="ttdeci">sip_publish_type</div><div class="ttdoc">The types of PUBLISH messages defined in RFC 3903. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/sip_8h_source.html#l01562">sip.h:1562</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311aeb9d6241943fcb32f34ed3a12548c623">SIP_PUBLISH_INITIAL</a></div><div class="ttdoc">Initial. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00285">res_pjsip_pubsub.c:285</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a42ecd8494df028dc44c95b90848ad311a267332dc912cbca4f3e5ede0fd776ae9">SIP_PUBLISH_REMOVE</a></div><div class="ttdoc">Remove. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00314">res_pjsip_pubsub.c:314</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4abffbee599d833b446686d5213d80e4"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4abffbee599d833b446686d5213d80e4">str_event_name</a></div><div class="ttdeci">static const pj_str_t str_event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00238">res_pjsip_pubsub.c:238</a></div></div>
<div class="ttc" id="structast__sip__publish__handler_html_aac80748c488a3724f6ab7e1ef4b73530"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aac80748c488a3724f6ab7e1ef4b73530">ast_sip_publish_handler::publications</a></div><div class="ttdeci">struct ao2_container * publications</div><div class="ttdoc">Publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00054">res_pjsip_pubsub.h:54</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a47e7031430a4ba4c21aac39b482ffd82"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e7031430a4ba4c21aac39b482ffd82">esc_etag_counter</a></div><div class="ttdeci">static int esc_etag_counter</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00340">res_pjsip_pubsub.c:340</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f6a1ab8c6d5f63fbcc96ea70e0160cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f6a1ab8c6d5f63fbcc96ea70e0160cf">&#9670;&nbsp;</a></span>pubsub_on_rx_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pubsub_on_rx_refresh </td>
          <td>(</td>
          <td class="paramtype">pjsip_evsub *&#160;</td>
          <td class="paramname"><em>evsub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_st_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_str_t **&#160;</td>
          <td class="paramname"><em>p_st_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_hdr *&#160;</td>
          <td class="paramname"><em>res_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_msg_body **&#160;</td>
          <td class="paramname"><em>p_body</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called whenever an in-dialog SUBSCRIBE is received. </p>
<p>This includes both SUBSCRIBE requests that actually refresh the subscription as well as SUBSCRIBE requests that end the subscription.</p>
<p>In either case we push serialized_pubsub_on_refresh_timeout to send an appropriate NOTIFY request. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">3911</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">ast_sip_sched_task_cancel()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00334">ast_sip_sched_task_get_name()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">create_require_eventlist()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">sip_subscription_tree::expiration_task</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">sip_subscription_tree::is_list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">serialized_pubsub_on_refresh_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">SIP_SUB_TREE_NORMAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">SIP_SUB_TREE_TERMINATE_PENDING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">sub_tree_state_description</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00531">SUBSCRIPTION_PERSISTENCE_REFRESHED</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;{</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;   sub_tree = pjsip_evsub_get_mod_data(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id);</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;evsub %p sub_tree %p sub_tree state %s\n&quot;</span>, <a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, sub_tree,</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;      (sub_tree ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a>[sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a>] : <span class="stringliteral">&quot;UNKNOWN&quot;</span>));</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;   <span class="keywordflow">if</span> (!sub_tree || sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> != <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>) {</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;   }</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>) {</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      <span class="keywordtype">char</span> task_name[256];</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga78b7691fb1bf1717a7961a68ceed5886">ast_sip_sched_task_get_name</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>, task_name, <span class="keyword">sizeof</span>(task_name));</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Cancelling timer: %s\n&quot;</span>, task_name);</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>);</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a>);</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">expiration_task</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;   }</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;   <span class="comment">/* PJSIP will set the evsub&#39;s state to terminated before calling into this function</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">    * if the Expires value of the incoming SUBSCRIBE is 0.</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;   <span class="keywordflow">if</span> (pjsip_evsub_get_state(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>) == PJSIP_EVSUB_STATE_TERMINATED) {</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;   }</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a>(sub_tree, rdata, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240">SUBSCRIPTION_PERSISTENCE_REFRESHED</a>);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bfb18b697fd27c2c465c9d7182e9d82">serialized_pubsub_on_refresh_timeout</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree))) {</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;      <span class="comment">/* If we can&#39;t push the NOTIFY refreshing task...we&#39;ll just go with it. */</span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to push task to send NOTIFY.\n&quot;</span>);</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>;</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;   }</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">is_list</a>) {</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      pj_list_insert_before(res_hdr, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a>(rdata-&gt;tp_info.pool));</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;   }</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400ac38cc588801abf190a87dc6c4220b240">SUBSCRIPTION_PERSISTENCE_REFRESHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00531">res_pjsip_pubsub.c:531</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">res_pjsip_pubsub.c:406</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga74acadc4e87ea1cea9cdddba4734bccc"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a></div><div class="ttdeci">int ast_sip_sched_task_cancel(struct ast_sip_sched_task *schtd)</div><div class="ttdoc">Cancels the next invocation of a task. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">pjsip_scheduler.c:191</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9e1f9ef9caffc6fcf306dbf678ecc747"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">sip_subscription_tree::is_list</a></div><div class="ttdeci">int is_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">res_pjsip_pubsub.c:453</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad353ed8aab9f1e54ccf8d2e89a96bcac"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a></div><div class="ttdeci">static pjsip_require_hdr * create_require_eventlist(pj_pool_t *pool)</div><div class="ttdoc">Shortcut method to create a Require: eventlist header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">res_pjsip_pubsub.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a6ba01bbffb64da676cd5176bb1d918b9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a></div><div class="ttdeci">static char * sub_tree_state_description[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">res_pjsip_pubsub.c:415</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3bfb18b697fd27c2c465c9d7182e9d82"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bfb18b697fd27c2c465c9d7182e9d82">serialized_pubsub_on_refresh_timeout</a></div><div class="ttdeci">static int serialized_pubsub_on_refresh_timeout(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">res_pjsip_pubsub.c:3889</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab37c67d3e45723f0b0aaf21dd9e2d605"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a></div><div class="ttdeci">static void subscription_persistence_update(struct sip_subscription_tree *sub_tree, pjsip_rx_data *rdata, enum sip_persistence_update_type type)</div><div class="ttdoc">Function which updates persistence information of a subscription in sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">res_pjsip_pubsub.c:662</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_afc1efa41dfd583546f0fb620d85bbef8"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#afc1efa41dfd583546f0fb620d85bbef8">sip_subscription_tree::expiration_task</a></div><div class="ttdeci">struct ast_sip_sched_task * expiration_task</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00462">res_pjsip_pubsub.c:462</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga78b7691fb1bf1717a7961a68ceed5886"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga78b7691fb1bf1717a7961a68ceed5886">ast_sip_sched_task_get_name</a></div><div class="ttdeci">int ast_sip_sched_task_get_name(struct ast_sip_sched_task *schtd, char *name, size_t maxlen)</div><div class="ttdoc">Gets the task name. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00334">pjsip_scheduler.c:334</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">res_pjsip_pubsub.c:408</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8deba4f5b210a282252f719b1a245029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8deba4f5b210a282252f719b1a245029">&#9670;&nbsp;</a></span>pubsub_on_rx_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t pubsub_on_rx_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Opaque structure representing an RFC 3265 SIP subscription. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">3707</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00256">pjsip_publish_method</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03697">pubsub_on_rx_notify_request()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;{</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;   <span class="keywordflow">if</span> (!pjsip_method_cmp(&amp;rdata-&gt;msg_info.msg-&gt;line.req.method, pjsip_get_subscribe_method())) {</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acd8fc16260b8a617c3d028b66745d5ad">pubsub_on_rx_subscribe_request</a>(rdata);</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pjsip_method_cmp(&amp;rdata-&gt;msg_info.msg-&gt;line.req.method, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad7c1f2dfc743e57aadd39d0be4b97e97">pjsip_publish_method</a>)) {</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4dba55f11df69f28d19d9125e3995334">pubsub_on_rx_publish_request</a>(rdata);</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pjsip_method_cmp(&amp;rdata-&gt;msg_info.msg-&gt;line.req.method, &amp;pjsip_notify_method)) {</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aba712df013e1be0394a2c2943a595376">pubsub_on_rx_notify_request</a>(rdata);</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;   }</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;   <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a4dba55f11df69f28d19d9125e3995334"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4dba55f11df69f28d19d9125e3995334">pubsub_on_rx_publish_request</a></div><div class="ttdeci">static pj_bool_t pubsub_on_rx_publish_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">res_pjsip_pubsub.c:3326</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad7c1f2dfc743e57aadd39d0be4b97e97"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad7c1f2dfc743e57aadd39d0be4b97e97">pjsip_publish_method</a></div><div class="ttdeci">const pjsip_method pjsip_publish_method</div><div class="ttdoc">Defined method for PUBLISH. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00256">res_pjsip_pubsub.c:256</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acd8fc16260b8a617c3d028b66745d5ad"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acd8fc16260b8a617c3d028b66745d5ad">pubsub_on_rx_subscribe_request</a></div><div class="ttdeci">static pj_bool_t pubsub_on_rx_subscribe_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">res_pjsip_pubsub.c:2969</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aba712df013e1be0394a2c2943a595376"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aba712df013e1be0394a2c2943a595376">pubsub_on_rx_notify_request</a></div><div class="ttdeci">static pj_bool_t pubsub_on_rx_notify_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03697">res_pjsip_pubsub.c:3697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd8fc16260b8a617c3d028b66745d5ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8fc16260b8a617c3d028b66745d5ad">&#9670;&nbsp;</a></span>pubsub_on_rx_subscribe_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t pubsub_on_rx_subscribe_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">2969</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00866">ast_sip_pubsub_has_eventlist_support()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">initial_notify_data::expires</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00359">generator</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00063">PJSIP_EXPIRES_NOT_SPECIFIED</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">resource_tree_destroy()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">sip_subscription_accept()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">initial_notify_data::sub_tree</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">subscription_get_generator_from_rdata()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">subscription_get_handler_from_rdata()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00637">subscription_persistence_create()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00527">SUBSCRIPTION_PERSISTENCE_CREATED</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">pubsub_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;{</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   pjsip_expires_hdr *expires_header;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   <span class="keywordtype">char</span> *resource;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   pjsip_uri *request_uri;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   pjsip_sip_uri *request_uri_sip;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;   <span class="keywordtype">size_t</span> resource_size;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> tree;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   pj_status_t dlg_status;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;   endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(endpoint != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;   <span class="keywordflow">if</span> (!endpoint-&gt;subscription.allow) {</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Subscriptions not permitted for endpoint %s.\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 603, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;   }</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;   request_uri = rdata-&gt;msg_info.msg-&gt;line.req.uri;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(request_uri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(request_uri)) {</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <span class="keywordtype">char</span> uri_str[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_REQ_URI, request_uri, uri_str, <span class="keyword">sizeof</span>(uri_str));</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Request URI &#39;%s&#39; is not a sip: or sips: URI.\n&quot;</span>, uri_str);</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 416, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;   }</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;   request_uri_sip = pjsip_uri_get_uri(request_uri);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;   resource_size = pj_strlen(&amp;request_uri_sip-&gt;user) + 1;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   resource = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(resource_size);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(resource, &amp;request_uri_sip-&gt;user, resource_size);</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment">    * We may want to match without any user options getting</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="comment">    * in the way.</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(resource);</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   expires_header = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_EXPIRES, rdata-&gt;msg_info.msg-&gt;hdr.next);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;   <span class="keywordflow">if</span> (expires_header) {</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordflow">if</span> (expires_header-&gt;ivalue == 0) {</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Subscription request from endpoint %s rejected. Expiration of 0 is invalid\n&quot;</span>,</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 400, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      }</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <span class="keywordflow">if</span> (expires_header-&gt;ivalue &lt; endpoint-&gt;subscription.minexpiry) {</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Subscription expiration %d is too brief for endpoint %s. Minimum is %u\n&quot;</span>,</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            expires_header-&gt;ivalue, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), endpoint-&gt;subscription.minexpiry);</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 423, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;         <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      }</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;   }</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;   handler = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a97f99a19e99580b4339e386220c2d9f6">subscription_get_handler_from_rdata</a>(rdata, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   <span class="keywordflow">if</span> (!handler) {</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 489, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;   }</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   generator = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af57976fae525316e955e6163f943db90">subscription_get_generator_from_rdata</a>(rdata, handler);</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;   <span class="keywordflow">if</span> (!generator) {</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 489, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;   }</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;   memset(&amp;tree, 0, <span class="keyword">sizeof</span>(tree));</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(endpoint, handler, resource, &amp;tree,</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa94f5c5d378799e218956c0804cbfb1e">ast_sip_pubsub_has_eventlist_support</a>(rdata));</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_IS_STATUS_IN_CLASS(resp, 200)) {</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, resp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a>(&amp;tree);</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;   }</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;   sub_tree = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a006316bcef76ef13dc1cc99560fbaa86">create_subscription_tree</a>(handler, endpoint, rdata, resource, generator, &amp;tree, &amp;dlg_status, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;   <span class="keywordflow">if</span> (!sub_tree) {</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordflow">if</span> (dlg_status != PJ_EEXISTS) {</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      }</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a> *ind = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*ind));</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">if</span> (!ind) {</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;         pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a>(&amp;tree);</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;         <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      }</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree);</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      <span class="comment">/* Since this is a normal subscribe, pjproject takes care of the timer */</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;      ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">expires</a> = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acd4517938f2afe11a1c6f372e28090a5">PJSIP_EXPIRES_NOT_SPECIFIED</a>;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a00a4fae74e9482fb6c95acb3d653a182">subscription_persistence_create</a>(sub_tree);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a>(sub_tree, rdata, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a>);</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ace14e2a3214654b0c1d15c05ba2bdb89">sip_subscription_accept</a>(sub_tree, rdata, resp);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acb194881d03c561cd60d0c88f82c7478">initial_notify_task</a>, ind)) {</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;         pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ind);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      }</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;   }</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a>(&amp;tree);</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00527">res_pjsip_pubsub.c:527</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a06552650d7ef9108d5744ee3f3fff264"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">initial_notify_data::expires</a></div><div class="ttdeci">unsigned int expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">res_pjsip_pubsub.c:1536</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a00a4fae74e9482fb6c95acb3d653a182"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a00a4fae74e9482fb6c95acb3d653a182">subscription_persistence_create</a></div><div class="ttdeci">static struct subscription_persistence * subscription_persistence_create(struct sip_subscription_tree *sub_tree)</div><div class="ttdoc">Function which creates initial persistence information of a subscription in sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00637">res_pjsip_pubsub.c:637</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acb194881d03c561cd60d0c88f82c7478"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acb194881d03c561cd60d0c88f82c7478">initial_notify_task</a></div><div class="ttdeci">static int initial_notify_task(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">res_pjsip_pubsub.c:2929</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ace14e2a3214654b0c1d15c05ba2bdb89"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ace14e2a3214654b0c1d15c05ba2bdb89">sip_subscription_accept</a></div><div class="ttdeci">static int sip_subscription_accept(struct sip_subscription_tree *sub_tree, pjsip_rx_data *rdata, int response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">res_pjsip_pubsub.c:2606</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab37c67d3e45723f0b0aaf21dd9e2d605"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a></div><div class="ttdeci">static void subscription_persistence_update(struct sip_subscription_tree *sub_tree, pjsip_rx_data *rdata, enum sip_persistence_update_type type)</div><div class="ttdoc">Function which updates persistence information of a subscription in sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">res_pjsip_pubsub.c:662</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_af57976fae525316e955e6163f943db90"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#af57976fae525316e955e6163f943db90">subscription_get_generator_from_rdata</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * subscription_get_generator_from_rdata(pjsip_rx_data *rdata, const struct ast_sip_subscription_handler *handler)</div><div class="ttdoc">Retrieve a body generator using the Accept header of an rdata message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">res_pjsip_pubsub.c:831</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structinitial__notify__data_html"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01534">res_pjsip_pubsub.c:1534</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aca2de2a2c7ba7a0a16d4632b56af96fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a></div><div class="ttdeci">static void resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">Destroy a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">res_pjsip_pubsub.c:1109</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="app__fax_8c_html_a36aeb2eb01afb248bad64a309d743636"><div class="ttname"><a href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a></div><div class="ttdeci">static struct ast_generator generator</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dde/app__fax_8c_source.html#l00359">app_fax.c:359</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a97f99a19e99580b4339e386220c2d9f6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a97f99a19e99580b4339e386220c2d9f6">subscription_get_handler_from_rdata</a></div><div class="ttdeci">static struct ast_sip_subscription_handler * subscription_get_handler_from_rdata(pjsip_rx_data *rdata, const char *endpoint)</div><div class="ttdoc">Retrieve a handler using the Event header of an rdata message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">res_pjsip_pubsub.c:771</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a006316bcef76ef13dc1cc99560fbaa86"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a006316bcef76ef13dc1cc99560fbaa86">create_subscription_tree</a></div><div class="ttdeci">static struct sip_subscription_tree * create_subscription_tree(const struct ast_sip_subscription_handler *handler, struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, const char *resource, struct ast_sip_pubsub_body_generator *generator, struct resource_tree *tree, pj_status_t *dlg_status, struct subscription_persistence *persistence)</div><div class="ttdoc">Create a subscription tree based on a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">res_pjsip_pubsub.c:1465</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a3b20a602cda3a7726e79738d006c5518"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">initial_notify_data::sub_tree</a></div><div class="ttdeci">struct sip_subscription_tree * sub_tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">res_pjsip_pubsub.c:1535</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_acd4517938f2afe11a1c6f372e28090a5"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#acd4517938f2afe11a1c6f372e28090a5">PJSIP_EXPIRES_NOT_SPECIFIED</a></div><div class="ttdeci">#define PJSIP_EXPIRES_NOT_SPECIFIED</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00063">res_pjsip.h:63</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa94f5c5d378799e218956c0804cbfb1e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa94f5c5d378799e218956c0804cbfb1e">ast_sip_pubsub_has_eventlist_support</a></div><div class="ttdeci">static int ast_sip_pubsub_has_eventlist_support(pjsip_rx_data *rdata)</div><div class="ttdoc">Check if the rdata has a Supported header containing &amp;#39;eventlist&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00866">res_pjsip_pubsub.c:866</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3815d56063e28c51b863c26e6b3a49c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3815d56063e28c51b863c26e6b3a49c9">&#9670;&nbsp;</a></span>pubsub_on_server_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pubsub_on_server_timeout </td>
          <td>(</td>
          <td class="paramtype">pjsip_evsub *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04002">4002</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">serialized_pubsub_on_refresh_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">SIP_SUB_TREE_NORMAL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">SIP_SUB_TREE_TERMINATE_PENDING</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>.</p>
<div class="fragment"><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;{</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;   <span class="comment">/* PJSIP does not terminate the server timeout timer when a SUBSCRIBE</span></div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment">    * with Expires: 0 arrives to end a subscription, nor does it terminate</span></div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">    * this timer when we send a NOTIFY request in response to receiving such</span></div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment">    * a SUBSCRIBE. PJSIP does not stop the server timeout timer until the</span></div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="comment">    * NOTIFY transaction has finished (either through receiving a response</span></div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="comment">    * or through a transaction timeout).</span></div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="comment">    * Therefore, it is possible that we can be told that a server timeout</span></div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="comment">    * occurred after we already thought that the subscription had been</span></div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="comment">    * terminated. In such a case, we will have already removed the sub_tree</span></div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="comment">    * from the evsub&#39;s mod_data array.</span></div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;   sub_tree = pjsip_evsub_get_mod_data(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id);</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;   <span class="keywordflow">if</span> (!sub_tree || sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> != <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>) {</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;   }</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a>;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bfb18b697fd27c2c465c9d7182e9d82">serialized_pubsub_on_refresh_timeout</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree))) {</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a>;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;   }</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af7fea613b9dafd6f664eea50435fea4e">SIP_SUB_TREE_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00406">res_pjsip_pubsub.c:406</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3bfb18b697fd27c2c465c9d7182e9d82"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3bfb18b697fd27c2c465c9d7182e9d82">serialized_pubsub_on_refresh_timeout</a></div><div class="ttdeci">static int serialized_pubsub_on_refresh_timeout(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">res_pjsip_pubsub.c:3889</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a5ffbdb3ef21db1d83c5a508f5e3865ae">SIP_SUB_TREE_TERMINATE_PENDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00408">res_pjsip_pubsub.c:408</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55772a6ad10b532f9ae2085ceb0c3942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55772a6ad10b532f9ae2085ceb0c3942">&#9670;&nbsp;</a></span>remove_subscription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void remove_subscription </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01182">1182</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00569">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02596">ast_sip_subscription_get_resource_name()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00455">sip_subscription_tree::next</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>.</p>
<div class="fragment"><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;{</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *i;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>, i, <a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8f1e0d0bf78f07ba5cd5825726b20eb8">next</a>) {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span> (i == obj) {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8f1e0d0bf78f07ba5cd5825726b20eb8">next</a>);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Removing subscription &#39;%s-&gt;%s&#39; from list of subscriptions\n&quot;</span>,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;               <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(i-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>), <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d7ed3f8785ad9d9aa3fc090d983c45d">ast_sip_subscription_get_resource_name</a>(i-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;         }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/dab/structsubscriptions.html">subscriptions</a>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structsubscriptions_html"><div class="ttname"><a href="../../df/dab/structsubscriptions.html">subscriptions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00534">res_pjsip_pubsub.c:534</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a2d7ed3f8785ad9d9aa3fc090d983c45d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d7ed3f8785ad9d9aa3fc090d983c45d">ast_sip_subscription_get_resource_name</a></div><div class="ttdeci">const char * ast_sip_subscription_get_resource_name(struct ast_sip_subscription *sub)</div><div class="ttdoc">Get the name of the subscribed resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02596">res_pjsip_pubsub.c:2596</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a8f1e0d0bf78f07ba5cd5825726b20eb8"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a8f1e0d0bf78f07ba5cd5825726b20eb8">sip_subscription_tree::next</a></div><div class="ttdeci">struct sip_subscription_tree * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00455">res_pjsip_pubsub.c:455</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64671fa6b889a9d62d646f3ab90cc775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64671fa6b889a9d62d646f3ab90cc775">&#9670;&nbsp;</a></span>resource_endpoint_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int resource_endpoint_handler </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05526">5526</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00513">ast_sip_publication_resource::endpoint</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;{</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a> *resource = obj;</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;   resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;}</div><div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html#a6d2d1c31529bee906473fcabaffff34f">ast_sip_publication_resource::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdoc">Optional name of an endpoint that is only allowed to publish to this resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00513">res_pjsip_pubsub.c:513</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></div><div class="ttdoc">Structure representing a publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00509">res_pjsip_pubsub.c:509</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3906226af7019edcf94ef2ce356dc7cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3906226af7019edcf94ef2ce356dc7cf">&#9670;&nbsp;</a></span>resource_event_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int resource_event_handler </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05536">5536</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">ast_variable_new</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00515">ast_sip_publication_resource::events</a>, <a class="el" href="../../d8/d4f/test__config_8c_source.html#l01463">item</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">ast_variable::name</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">ast_variable::next</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;{</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a> *resource = obj;</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;   <span class="comment">/* The event configuration name starts with &#39;event_&#39; so skip past it to get the real name */</span></div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">event</span> = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> + 6;</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>)) {</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;   }</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;   item = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;   <span class="keywordflow">if</span> (!item) {</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;   }</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;   <span class="keywordflow">if</span> (resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">events</a>) {</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;      item-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a> = resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">events</a>;</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;   }</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;   resource-&gt;<a class="code" href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">events</a> = <a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;}</div><div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a66581086d34dfe7ea86b0644bacef239"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a></div><div class="ttdeci">#define ast_variable_new(name, value, filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">include/asterisk/config.h:914</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html">ast_sip_publication_resource</a></div><div class="ttdoc">Structure representing a publication resource. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00509">res_pjsip_pubsub.c:509</a></div></div>
<div class="ttc" id="structast__sip__publication__resource_html_ad2ef61c498fc983f10336fd7b5876af7"><div class="ttname"><a href="../../d2/d91/structast__sip__publication__resource.html#ad2ef61c498fc983f10336fd7b5876af7">ast_sip_publication_resource::events</a></div><div class="ttdeci">struct ast_variable * events</div><div class="ttdoc">Mapping for event types to configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00515">res_pjsip_pubsub.c:515</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae30488231b97f5060ccc10743e7a3a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae30488231b97f5060ccc10743e7a3a64">&#9670;&nbsp;</a></span>resource_list_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* resource_list_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04764">4764</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01728">ast_sorcery_generic_alloc()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04752">resource_list_destructor()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04750">RESOURCE_LIST_INIT_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">apply_list_configuration()</a>.</p>
<div class="fragment"><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;{</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list;</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;   list = <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(*list), <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab1dea1f3f371c8b1e033627343f74457">resource_list_destructor</a>);</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   }</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f5d6a140ec019c5cf145f0d78a946a5">RESOURCE_LIST_INIT_SIZE</a>)) {</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(list);</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;   }</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;   <span class="keywordflow">return</span> list;</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f5d6a140ec019c5cf145f0d78a946a5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f5d6a140ec019c5cf145f0d78a946a5">RESOURCE_LIST_INIT_SIZE</a></div><div class="ttdeci">#define RESOURCE_LIST_INIT_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04750">res_pjsip_pubsub.c:4750</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab1dea1f3f371c8b1e033627343f74457"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab1dea1f3f371c8b1e033627343f74457">resource_list_destructor</a></div><div class="ttdeci">static void resource_list_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04752">res_pjsip_pubsub.c:4752</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28ad88468ddb5b0d4e26b7406133bd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ad88468ddb5b0d4e26b7406133bd8a">&#9670;&nbsp;</a></span>resource_list_apply_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int resource_list_apply_handler </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *&#160;</td>
          <td class="paramname"><em>sorcery</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04838">4838</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04857">apply_list_configuration()</a>.</p>
<div class="fragment"><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;{</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list = obj;</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>)) {</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Resource list &#39;%s&#39; has no event set\n&quot;</span>,</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(list));</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;   }</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>) == 0) {</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Resource list &#39;%s&#39; has no list items\n&quot;</span>,</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(list));</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;   }</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;}</div><div class="ttc" id="structresource__list_html_a5053da7047dfe40d67229c5dbc361f8b"><div class="ttname"><a href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">resource_list::event</a></div><div class="ttdeci">char event[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">res_pjsip_pubsub.c:328</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1dea1f3f371c8b1e033627343f74457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1dea1f3f371c8b1e033627343f74457">&#9670;&nbsp;</a></span>resource_list_destructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void resource_list_destructor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04752">4752</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">resource_list::items</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04764">resource_list_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;{</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list = obj;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>); ++i) {</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">char</span> *) <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>, i));</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;   }</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">items</a>);</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structresource__list_html_aac996d1f40f0b3df21082fd7f1b5d953"><div class="ttname"><a href="../../df/dd0/structresource__list.html#aac996d1f40f0b3df21082fd7f1b5d953">resource_list::items</a></div><div class="ttdeci">struct resources items</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00330">res_pjsip_pubsub.c:330</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca2de2a2c7ba7a0a16d4632b56af96fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca2de2a2c7ba7a0a16d4632b56af96fa">&#9670;&nbsp;</a></span>resource_tree_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void resource_tree_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy a resource tree. </p>
<p>This function makes no assumptions about how the tree itself was allocated and does not attempt to free the tree itself. Callers of this function are responsible for freeing the tree.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tree</td><td>The tree to destroy. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">1109</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">resource_tree::root</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">tree_node_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">test_resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="keywordflow">if</span> (tree) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a>(tree-&gt;<a class="code" href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">root</a>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;}</div><div class="ttc" id="structresource__tree_html_a2dce9d43da01d556f3a1d694d03a40a9"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html#a2dce9d43da01d556f3a1d694d03a40a9">resource_tree::root</a></div><div class="ttdeci">struct tree_node * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01096">res_pjsip_pubsub.c:1096</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aab8324717cc2207dbde31f177aa7ac0f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a></div><div class="ttdeci">static void tree_node_destroy(struct tree_node *node)</div><div class="ttdoc">Destructor for a tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">res_pjsip_pubsub.c:965</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93e6d67f6d539b39fd0ebe7171d480ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e6d67f6d539b39fd0ebe7171d480ca">&#9670;&nbsp;</a></span>retrieve_resource_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dd0/structresource__list.html">resource_list</a>* retrieve_resource_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for retrieving a resource list for a given event. </p>
<p>This will retrieve a resource list that corresponds to the resource and event provided.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>The name of the resource list to retrieve </td></tr>
    <tr><td class="paramname">event</td><td>The expected event name on the resource list </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00902">902</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">resource_list::event</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">build_node_children()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dd0/structresource__list.html">resource_list</a> *list;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   list = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;resource_list&quot;</span>, resource);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">if</span> (!list) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordflow">if</span> (strcmp(list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>, <a class="code" href="../../df/d7d/structevent.html">event</a>)) {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Found resource list %s, but its event type (%s) does not match SUBSCRIBE&#39;s (%s)\n&quot;</span>,</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            resource, list-&gt;<a class="code" href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">event</a>, <a class="code" href="../../df/d7d/structevent.html">event</a>);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(list);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   <span class="keywordflow">return</span> list;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;}</div><div class="ttc" id="structresource__list_html_a5053da7047dfe40d67229c5dbc361f8b"><div class="ttname"><a href="../../df/dd0/structresource__list.html#a5053da7047dfe40d67229c5dbc361f8b">resource_list::event</a></div><div class="ttdeci">char event[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00328">res_pjsip_pubsub.c:328</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresource__list_html"><div class="ttname"><a href="../../df/dd0/structresource__list.html">resource_list</a></div><div class="ttdoc">Resource list configuration item. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00325">res_pjsip_pubsub.c:325</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a474bbe394cad0178cf128a36a312ca62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474bbe394cad0178cf128a36a312ca62">&#9670;&nbsp;</a></span>rlmi_clone_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* rlmi_clone_data </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02140">2140</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;{</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keyword">const</span> pj_xml_node *rlmi = data;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;   <span class="keywordflow">return</span> pj_xml_clone(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, rlmi);</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;}</div><div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a786140dcdee30f86fc9a661c515982bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a786140dcdee30f86fc9a661c515982bb">&#9670;&nbsp;</a></span>rlmi_print_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int rlmi_print_body </td>
          <td>(</td>
          <td class="paramtype">struct pjsip_msg_body *&#160;</td>
          <td class="paramname"><em>msg_body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02127">2127</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/dc3/res__pjsip__presence__xml_8h_source.html#l00036">AST_PJSIP_XML_PROLOG_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>.</p>
<div class="fragment"><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;{</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   <span class="keywordtype">int</span> num_printed;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;   pj_xml_node *rlmi = msg_body-&gt;data;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   num_printed = pj_xml_print(rlmi, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size, PJ_TRUE);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;   <span class="keywordflow">if</span> (num_printed &lt;= <a class="code" href="../../d5/dc3/res__pjsip__presence__xml_8h.html#a2249425f7ecf2dce721526ea4760a41c">AST_PJSIP_XML_PROLOG_LEN</a>) {</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   }</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;   <span class="keywordflow">return</span> num_printed;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="res__pjsip__presence__xml_8h_html_a2249425f7ecf2dce721526ea4760a41c"><div class="ttname"><a href="../../d5/dc3/res__pjsip__presence__xml_8h.html#a2249425f7ecf2dce721526ea4760a41c">AST_PJSIP_XML_PROLOG_LEN</a></div><div class="ttdeci">#define AST_PJSIP_XML_PROLOG_LEN</div><div class="ttdoc">Length of the XML prolog when printing presence or other XML in PJSIP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc3/res__pjsip__presence__xml_8h_source.html#l00036">res_pjsip_presence_xml.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ef69ae2e93f18a3a6cc53e4759b332f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef69ae2e93f18a3a6cc53e4759b332f">&#9670;&nbsp;</a></span>sched_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sched_cb </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02500">2500</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02462">serialized_send_notify()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02512">schedule_notification()</a>.</p>
<div class="fragment"><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;{</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = (<span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *) data;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   <span class="comment">/* We don&#39;t need to bump the refcount of sub_tree since we bumped it when scheduling this task */</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3e9568af1e66909dc6d642070e02b1a0">serialized_send_notify</a>, sub_tree)) {</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   }</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a3e9568af1e66909dc6d642070e02b1a0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3e9568af1e66909dc6d642070e02b1a0">serialized_send_notify</a></div><div class="ttdeci">static int serialized_send_notify(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02462">res_pjsip_pubsub.c:2462</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a312601e694a9ca811601375d4e33d8df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a312601e694a9ca811601375d4e33d8df">&#9670;&nbsp;</a></span>schedule_notification()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int schedule_notification </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02512">2512</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">sip_subscription_tree::notification_batch_interval</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">sip_subscription_tree::notify_sched_id</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02500">sched_cb()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">sip_subscription_tree::send_scheduled_notify</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">ast_sip_subscription_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;{</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   <span class="comment">/* There&#39;s already a notification scheduled */</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">notify_sched_id</a> &gt; -1) {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   }</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">send_scheduled_notify</a> = 1;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">notify_sched_id</a> = <a class="code" href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">notification_batch_interval</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7ef69ae2e93f18a3a6cc53e4759b332f">sched_cb</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree));</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">notify_sched_id</a> &lt; 0) {</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   }</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7ef69ae2e93f18a3a6cc53e4759b332f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7ef69ae2e93f18a3a6cc53e4759b332f">sched_cb</a></div><div class="ttdeci">static int sched_cb(const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02500">res_pjsip_pubsub.c:2500</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d5cc626722f9dee721868da7dc58a40"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">sip_subscription_tree::notify_sched_id</a></div><div class="ttdeci">int notify_sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">res_pjsip_pubsub.c:447</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="sched_8h_html_a7a43dcf8be6b2ed7f96f3867fbcb4082"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a></div><div class="ttdeci">int ast_sched_add(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data) attribute_warn_unused_result</div><div class="ttdoc">Adds a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00565">sched.c:565</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a8fe140462b79206a7c20a771dace07e1"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">sip_subscription_tree::send_scheduled_notify</a></div><div class="ttdeci">unsigned int send_scheduled_notify</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">res_pjsip_pubsub.c:449</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac90516981222dda0270465a33483f2b4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac90516981222dda0270465a33483f2b4">sip_subscription_tree::notification_batch_interval</a></div><div class="ttdeci">unsigned int notification_batch_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00445">res_pjsip_pubsub.c:445</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b3391cb48972f432118c4ca2eeb3063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b3391cb48972f432118c4ca2eeb3063">&#9670;&nbsp;</a></span>send_notify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int send_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>force_full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a NOTIFY request to a subscriber. </p>
<dl class="section pre"><dt>Precondition</dt><dd>sub_tree-&gt;dlg is locked</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_tree</td><td>The subscription tree representing the subscription </td></tr>
    <tr><td class="paramname">force_full_state</td><td>If true, ignore resource list settings and send full resource list state. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">non-zero</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">2425</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">create_require_eventlist()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">generate_notify_body()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">sip_subscription_tree::is_list</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">sip_subscription_tree::send_scheduled_notify</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01989">sip_subscription_send_request()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02529">ast_sip_subscription_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02462">serialized_send_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;{</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   pjsip_evsub *<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a> = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      &amp;&amp; sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;subscription_state == PJSIP_EVSUB_STATE_TERMINATED</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      &amp;&amp; sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>) {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;   }</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   <span class="keywordflow">if</span> (pjsip_evsub_notify(evsub, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;subscription_state,</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   }</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   tdata-&gt;msg-&gt;body = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abe6f294a1dd6e02f90699c6862c8ff37">generate_notify_body</a>(tdata-&gt;pool, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>, force_full_state);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;   <span class="keywordflow">if</span> (!tdata-&gt;msg-&gt;body) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;   }</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">is_list</a>) {</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      pjsip_require_hdr *require = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a>(tdata-&gt;pool);</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *) require);</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;   }</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae4bf9f7f4557d02712ea86b10e5d6891">sip_subscription_send_request</a>(sub_tree, tdata)) {</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="comment">/* do not call pjsip_tx_data_dec_ref(tdata). The pjsip_dlg_send_request deletes the message on error */</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   }</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">send_scheduled_notify</a> = 0;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9e1f9ef9caffc6fcf306dbf678ecc747"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">sip_subscription_tree::is_list</a></div><div class="ttdeci">int is_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">res_pjsip_pubsub.c:453</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad353ed8aab9f1e54ccf8d2e89a96bcac"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a></div><div class="ttdeci">static pjsip_require_hdr * create_require_eventlist(pj_pool_t *pool)</div><div class="ttdoc">Shortcut method to create a Require: eventlist header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">res_pjsip_pubsub.c:2404</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abe6f294a1dd6e02f90699c6862c8ff37"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abe6f294a1dd6e02f90699c6862c8ff37">generate_notify_body</a></div><div class="ttdeci">static pjsip_msg_body * generate_notify_body(pj_pool_t *pool, struct ast_sip_subscription *root, unsigned int force_full_state)</div><div class="ttdoc">Create the body for a NOTIFY request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02371">res_pjsip_pubsub.c:2371</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ae4bf9f7f4557d02712ea86b10e5d6891"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae4bf9f7f4557d02712ea86b10e5d6891">sip_subscription_send_request</a></div><div class="ttdeci">static int sip_subscription_send_request(struct sip_subscription_tree *sub_tree, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01989">res_pjsip_pubsub.c:1989</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a8fe140462b79206a7c20a771dace07e1"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">sip_subscription_tree::send_scheduled_notify</a></div><div class="ttdeci">unsigned int send_scheduled_notify</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">res_pjsip_pubsub.c:449</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45317a8f9762fa3b934c723df1367336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45317a8f9762fa3b934c723df1367336">&#9670;&nbsp;</a></span>serialized_pubsub_on_client_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int serialized_pubsub_on_client_refresh </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03969">3969</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03989">pubsub_on_client_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;{</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = userdata;</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>) {</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;   }</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;   <span class="keywordflow">if</span> (pjsip_evsub_initiate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      pjsip_evsub_send_request(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, tdata);</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;   }</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bfb18b697fd27c2c465c9d7182e9d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bfb18b697fd27c2c465c9d7182e9d82">&#9670;&nbsp;</a></span>serialized_pubsub_on_refresh_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int serialized_pubsub_on_refresh_timeout </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">3889</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">sub_tree_state_description</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04002">pubsub_on_server_timeout()</a>.</p>
<div class="fragment"><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;{</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = userdata;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;sub_tree %p sub_tree state %s\n&quot;</span>, sub_tree,</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      (sub_tree ? <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a>[sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a>] : <span class="stringliteral">&quot;UNKNOWN&quot;</span>));</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a31b603dda9cf0a3354575494f0d4f9f9">pubsub_on_refresh_timeout</a>(userdata);</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a6ba01bbffb64da676cd5176bb1d918b9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a6ba01bbffb64da676cd5176bb1d918b9">sub_tree_state_description</a></div><div class="ttdeci">static char * sub_tree_state_description[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">res_pjsip_pubsub.c:415</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a31b603dda9cf0a3354575494f0d4f9f9"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a31b603dda9cf0a3354575494f0d4f9f9">pubsub_on_refresh_timeout</a></div><div class="ttdeci">static int pubsub_on_refresh_timeout(void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">res_pjsip_pubsub.c:3859</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e9568af1e66909dc6d642070e02b1a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9568af1e66909dc6d642070e02b1a0">&#9670;&nbsp;</a></span>serialized_send_notify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int serialized_send_notify </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02462">2462</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">sip_subscription_tree::notify_sched_id</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">sip_subscription_tree::send_scheduled_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00412">SIP_SUB_TREE_TERMINATED</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02500">sched_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;{</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = userdata;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;   pjsip_dialog *<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;   pjsip_dlg_inc_lock(dlg);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   <span class="comment">/* It&#39;s possible that between when the notification was scheduled</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment">    * and now a new SUBSCRIBE arrived requiring full state to be</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="comment">    * sent out in an immediate NOTIFY. It&#39;s also possible that we&#39;re</span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment">    * already processing a terminate.  If that has happened, we need to</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="comment">    * bail out here instead of sending the batched NOTIFY.</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> &gt;= <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      || !sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">send_scheduled_notify</a>) {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   }</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;subscription_state == PJSIP_EVSUB_STATE_TERMINATED) {</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;   }</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a>(sub_tree, 0);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;         ? <span class="stringliteral">&quot;SUBSCRIPTION_TERMINATED&quot;</span> : <span class="stringliteral">&quot;SUBSCRIPTION_STATE_CHANGED&quot;</span>,</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <span class="stringliteral">&quot;Resource: %s&quot;</span>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">notify_sched_id</a> = -1;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree);</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d5cc626722f9dee721868da7dc58a40"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d5cc626722f9dee721868da7dc58a40">sip_subscription_tree::notify_sched_id</a></div><div class="ttdeci">int notify_sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00447">res_pjsip_pubsub.c:447</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89a68663ef66af50c315fec11f61bc226ab">SIP_SUB_TREE_TERMINATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00412">res_pjsip_pubsub.c:412</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8b3391cb48972f432118c4ca2eeb3063"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8b3391cb48972f432118c4ca2eeb3063">send_notify</a></div><div class="ttdeci">static int send_notify(struct sip_subscription_tree *sub_tree, unsigned int force_full_state)</div><div class="ttdoc">Send a NOTIFY request to a subscriber. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">res_pjsip_pubsub.c:2425</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a8fe140462b79206a7c20a771dace07e1"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a8fe140462b79206a7c20a771dace07e1">sip_subscription_tree::send_scheduled_notify</a></div><div class="ttdeci">unsigned int send_scheduled_notify</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00449">res_pjsip_pubsub.c:449</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8c5bddecd1c2126c026728ca98750b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c5bddecd1c2126c026728ca98750b0">&#9670;&nbsp;</a></span>set_state_terminated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_state_terminated </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03720">3720</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>.</p>
<div class="fragment"><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;{</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;   sub-&gt;subscription_state = PJSIP_EVSUB_STATE_TERMINATED;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children); ++i) {</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8c5bddecd1c2126c026728ca98750b0">set_state_terminated</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;sub-&gt;children, i));</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;   }</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;}</div><div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad8c5bddecd1c2126c026728ca98750b0"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8c5bddecd1c2126c026728ca98750b0">set_state_terminated</a></div><div class="ttdeci">static void set_state_terminated(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03720">res_pjsip_pubsub.c:3720</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52b5a301995d607923de2caddcdcdb62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b5a301995d607923de2caddcdcdb62">&#9670;&nbsp;</a></span>shutdown_subscriptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void shutdown_subscriptions </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d02/structast__sip__subscription.html">ast_sip_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01328">1328</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00328">ast_sip_subscription_handler::subscription_shutdown</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>.</p>
<div class="fragment"><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;{</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   }</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children) &gt; 0) {</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;sub-&gt;children); ++i) {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a52b5a301995d607923de2caddcdcdb62">shutdown_subscriptions</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;sub-&gt;children, i));</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   <span class="comment">/* We notify subscription shutdown only on the tree leaves. */</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aafe0a2289a5de4ddc780067899f70eaa">subscription_shutdown</a>) {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      sub-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#aafe0a2289a5de4ddc780067899f70eaa">subscription_shutdown</a>(sub);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;}</div><div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a52b5a301995d607923de2caddcdcdb62"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a52b5a301995d607923de2caddcdcdb62">shutdown_subscriptions</a></div><div class="ttdeci">static void shutdown_subscriptions(struct ast_sip_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01328">res_pjsip_pubsub.c:1328</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_aafe0a2289a5de4ddc780067899f70eaa"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#aafe0a2289a5de4ddc780067899f70eaa">ast_sip_subscription_handler::subscription_shutdown</a></div><div class="ttdeci">void(* subscription_shutdown)(struct ast_sip_subscription *subscription)</div><div class="ttdoc">Called when a subscription is to be destroyed. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00328">res_pjsip_pubsub.h:328</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8fd4e13f8412f935f22b1df916b55a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8fd4e13f8412f935f22b1df916b55a3">&#9670;&nbsp;</a></span>sip_create_publication()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a>* sip_create_publication </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event_configuration_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">3145</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../d7/d7a/datastore_8c_source.html#l00095">ast_datastores_alloc()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00443">ast_module_ref</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00363">ast_sip_publication::data</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">ast_sip_publication::datastores</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">DEFAULT_PUBLISH_EXPIRES</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">ast_sip_publication::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">ast_sip_publication::entity_tag</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00340">esc_etag_counter</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00361">ast_sip_publication::event_configuration_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00355">ast_sip_publication::expires</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03133">publication_destroy_fn()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">ast_sip_publication::resource</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00357">ast_sip_publication::sched_id</a>, and <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03214">publish_request_initial()</a>.</p>
<div class="fragment"><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;{</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *publication;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   pjsip_expires_hdr *expires_hdr = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_EXPIRES, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   <span class="keywordtype">size_t</span> resource_len = strlen(<a class="code" href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">resource</a>) + 1, event_configuration_name_len = strlen(<a class="code" href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">event_configuration_name</a>) + 1;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <span class="keywordtype">char</span> *dst;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(endpoint != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;   <span class="keywordflow">if</span> (!(publication = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*publication) + resource_len + event_configuration_name_len, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af9e99216a3b9def7b033ec0404e4140f">publication_destroy_fn</a>))) {</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   }</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;   <span class="keywordflow">if</span> (!(publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">datastores</a> = <a class="code" href="../../d9/db6/datastore_8h.html#afa0c7f9c8f98470441ff8e9b3e8f34cc">ast_datastores_alloc</a>())) {</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publication, -1);</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;   }</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e7031430a4ba4c21aac39b482ffd82">esc_etag_counter</a>, +1);</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(endpoint, +1);</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> = <a class="code" href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a06552650d7ef9108d5744ee3f3fff264">expires</a> = expires_hdr ? expires_hdr-&gt;ivalue : <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a>;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a5856afac1fb921f1d6a4eb1fe9412bc8">sched_id</a> = -1;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   dst = publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">resource</a> = strcpy(dst, <a class="code" href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">resource</a>);</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   dst += resource_len;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   publication-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">event_configuration_name</a> = strcpy(dst, <a class="code" href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">event_configuration_name</a>);</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   <span class="keywordflow">return</span> publication;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;}</div><div class="ttc" id="structast__sip__publication_html_a9a3b4be1b9151b0369d7fca9911c7ecd"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a9a3b4be1b9151b0369d7fca9911c7ecd">ast_sip_publication::data</a></div><div class="ttdeci">char data[0]</div><div class="ttdoc">Data containing the above. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00363">res_pjsip_pubsub.c:363</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_af9e99216a3b9def7b033ec0404e4140f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#af9e99216a3b9def7b033ec0404e4140f">publication_destroy_fn</a></div><div class="ttdeci">static void publication_destroy_fn(void *obj)</div><div class="ttdoc">Internal destructor for publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03133">res_pjsip_pubsub.c:3133</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4d530a1f675151206b5929a37a882fe2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a></div><div class="ttdeci">#define DEFAULT_PUBLISH_EXPIRES</div><div class="ttdoc">Default expiration time for PUBLISH if one is not specified. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">res_pjsip_pubsub.c:247</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="datastore_8h_html_afa0c7f9c8f98470441ff8e9b3e8f34cc"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#afa0c7f9c8f98470441ff8e9b3e8f34cc">ast_datastores_alloc</a></div><div class="ttdeci">struct ao2_container * ast_datastores_alloc(void)</div><div class="ttdoc">Allocate a specialized data stores container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00095">datastore.c:95</a></div></div>
<div class="ttc" id="structast__sip__publication_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_publication::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00347">res_pjsip_pubsub.c:347</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a06552650d7ef9108d5744ee3f3fff264"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a06552650d7ef9108d5744ee3f3fff264">ast_sip_publication::expires</a></div><div class="ttdeci">unsigned int expires</div><div class="ttdoc">Expiration time of the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00355">res_pjsip_pubsub.c:355</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a6aae576152b40374b43f81349aecc739"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a6aae576152b40374b43f81349aecc739">ast_sip_publication::event_configuration_name</a></div><div class="ttdeci">char * event_configuration_name</div><div class="ttdoc">The name of the event type configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00361">res_pjsip_pubsub.c:361</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structast__sip__publication_html_add9403c2dd81e949c8c4aa872eabdcc7"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#add9403c2dd81e949c8c4aa872eabdcc7">ast_sip_publication::resource</a></div><div class="ttdeci">char * resource</div><div class="ttdoc">The resource the publication is to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00359">res_pjsip_pubsub.c:359</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_publication::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdoc">The endpoint with which the subscription is communicating. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00353">res_pjsip_pubsub.c:353</a></div></div>
<div class="ttc" id="structast__sip__publication_html"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a></div><div class="ttdoc">Structure representing a SIP publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00345">res_pjsip_pubsub.c:345</a></div></div>
<div class="ttc" id="structast__sip__publication_html_ae9dd8f0a26f1e5fdf7e5630d4dffadd3"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">ast_sip_publication::entity_tag</a></div><div class="ttdeci">int entity_tag</div><div class="ttdoc">Entity tag for the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">res_pjsip_pubsub.c:349</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a5856afac1fb921f1d6a4eb1fe9412bc8"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a5856afac1fb921f1d6a4eb1fe9412bc8">ast_sip_publication::sched_id</a></div><div class="ttdeci">int sched_id</div><div class="ttdoc">Scheduled item for expiration of publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00357">res_pjsip_pubsub.c:357</a></div></div>
<div class="ttc" id="module_8h_html_a8dea6491bedba471fc44574d76438577"><div class="ttname"><a href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a></div><div class="ttdeci">#define ast_module_ref(mod)</div><div class="ttdoc">Hold a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00443">module.h:443</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a47e7031430a4ba4c21aac39b482ffd82"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a47e7031430a4ba4c21aac39b482ffd82">esc_etag_counter</a></div><div class="ttdeci">static int esc_etag_counter</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00340">res_pjsip_pubsub.c:340</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20aeeed556614ef809787fb4f04de0fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20aeeed556614ef809787fb4f04de0fb">&#9670;&nbsp;</a></span>sip_publication_respond()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_publication_respond </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">3179</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05063">ast_sip_add_header()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">ast_sip_publication::entity_tag</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00355">ast_sip_publication::expires</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03214">publish_request_initial()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;{</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;   pjsip_transaction *tsx;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;   <span class="keywordflow">if</span> (pjsip_endpt_create_response(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, status_code, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;   }</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;   <span class="keywordflow">if</span> (PJSIP_IS_STATUS_IN_CLASS(status_code, 200)) {</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[30];</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;%d&quot;</span>, pub-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">entity_tag</a>);</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a>(tdata, <span class="stringliteral">&quot;SIP-ETag&quot;</span>, buf);</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;%d&quot;</span>, pub-&gt;<a class="code" href="../../d4/da6/structast__sip__publication.html#a06552650d7ef9108d5744ee3f3fff264">expires</a>);</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a>(tdata, <span class="stringliteral">&quot;Expires&quot;</span>, buf);</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;   }</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;   <span class="keywordflow">if</span> (pjsip_tsx_create_uas(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>, rdata, &amp;tsx) != PJ_SUCCESS) {</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   }</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;   pjsip_tsx_recv_msg(tsx, rdata);</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   <span class="keywordflow">if</span> (pjsip_tsx_send_msg(tsx, tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;   }</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_acef4d0aef5bdc92f0b6b188e48f2e90f"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a></div><div class="ttdeci">int ast_sip_add_header(pjsip_tx_data *tdata, const char *name, const char *value)</div><div class="ttdoc">Add a header to an outbound SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05063">res_pjsip.c:5063</a></div></div>
<div class="ttc" id="structast__sip__publication_html_a06552650d7ef9108d5744ee3f3fff264"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#a06552650d7ef9108d5744ee3f3fff264">ast_sip_publication::expires</a></div><div class="ttdeci">unsigned int expires</div><div class="ttdoc">Expiration time of the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00355">res_pjsip_pubsub.c:355</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="structast__sip__publication_html_ae9dd8f0a26f1e5fdf7e5630d4dffadd3"><div class="ttname"><a href="../../d4/da6/structast__sip__publication.html#ae9dd8f0a26f1e5fdf7e5630d4dffadd3">ast_sip_publication::entity_tag</a></div><div class="ttdeci">int entity_tag</div><div class="ttdoc">Entity tag for the publication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00349">res_pjsip_pubsub.c:349</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace14e2a3214654b0c1d15c05ba2bdb89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace14e2a3214654b0c1d15c05ba2bdb89">&#9670;&nbsp;</a></span>sip_subscription_accept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_subscription_accept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">2606</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02638">ast_sip_mod_data_get</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">create_require_eventlist()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">sip_subscription_tree::is_list</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">MOD_DATA_PERSISTENCE</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;{</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   pjsip_hdr res_hdr;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;   <span class="comment">/* If this is a persistence recreation the subscription has already been accepted */</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a>(rdata-&gt;endpt_info.mod_data, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a>)) {</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;   }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;   pj_list_init(&amp;res_hdr);</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">is_list</a>) {</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="comment">/* If subscribing to a list, our response has to have a Require: eventlist header in it */</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      pj_list_insert_before(&amp;res_hdr, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a>(rdata-&gt;tp_info.pool));</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   }</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;   <span class="keywordflow">return</span> pjsip_evsub_accept(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, rdata, response, &amp;res_hdr) == PJ_SUCCESS ? 0 : -1;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9e1f9ef9caffc6fcf306dbf678ecc747"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9e1f9ef9caffc6fcf306dbf678ecc747">sip_subscription_tree::is_list</a></div><div class="ttdeci">int is_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00453">res_pjsip_pubsub.c:453</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad353ed8aab9f1e54ccf8d2e89a96bcac"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad353ed8aab9f1e54ccf8d2e89a96bcac">create_require_eventlist</a></div><div class="ttdeci">static pjsip_require_hdr * create_require_eventlist(pj_pool_t *pool)</div><div class="ttdoc">Shortcut method to create a Require: eventlist header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02404">res_pjsip_pubsub.c:2404</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aad194ead974937834375b0ac8d37a7c2"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a></div><div class="ttdeci">#define ast_sip_mod_data_get(mod_data, id, key)</div><div class="ttdoc">Using the dictionary stored in mod_data array at a given id, retrieve the value associated with the g...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02638">res_pjsip.h:2638</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad9ab4b2e3c02b132f457ec3e61d5d47d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a></div><div class="ttdeci">#define MOD_DATA_PERSISTENCE</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">res_pjsip_pubsub.c:235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4bf9f7f4557d02712ea86b10e5d6891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4bf9f7f4557d02712ea86b10e5d6891">&#9670;&nbsp;</a></span>sip_subscription_send_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_subscription_send_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01989">1989</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01967">allocate_tdata_buffer()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00525">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02425">send_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;{</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   pjsip_evsub *evsub = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a204519f08566a8c5fb4711168cad11e3">allocate_tdata_buffer</a>(tdata)) {</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;SIP request %s is too large to send.\n&quot;</span>, tdata-&gt;info);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   }</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;   res = pjsip_evsub_send_request(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, tdata);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a>(sub_tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a>);</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;SUBSCRIPTION_STATE_SET&quot;</span>,</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="stringliteral">&quot;StateText: %s\r\n&quot;</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span>,</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      pjsip_evsub_get_state_name(evsub),</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;   <span class="keywordflow">return</span> (res == PJ_SUCCESS ? 0 : -1);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a56de5c438e2a53b13eb3ba4310d58ae2">SUBSCRIPTION_PERSISTENCE_SEND_REQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00525">res_pjsip_pubsub.c:525</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab37c67d3e45723f0b0aaf21dd9e2d605"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a></div><div class="ttdeci">static void subscription_persistence_update(struct sip_subscription_tree *sub_tree, pjsip_rx_data *rdata, enum sip_persistence_update_type type)</div><div class="ttdoc">Function which updates persistence information of a subscription in sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">res_pjsip_pubsub.c:662</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a204519f08566a8c5fb4711168cad11e3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a204519f08566a8c5fb4711168cad11e3">allocate_tdata_buffer</a></div><div class="ttdeci">static int allocate_tdata_buffer(pjsip_tx_data *tdata)</div><div class="ttdoc">Pre-allocate a buffer for the transmission. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01967">res_pjsip_pubsub.c:1967</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0461ac441d662c000ef9408ab9dd01c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0461ac441d662c000ef9408ab9dd01c">&#9670;&nbsp;</a></span>sip_subscription_to_ami()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sip_subscription_to_ami </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">1820</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/dd5/callerid_8c_source.html#l01073">ast_callerid_merge()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">ast_sip_subscription::handler</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">sip_subscription_tree::role</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00629">ast_sip_endpoint_id_configuration::self</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00518">sip_subscription_roles_map</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00147">str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00335">ast_sip_subscription_handler::to_ami</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04031">ami_subscription_detail()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04235">cli_show_subscription_common()</a>.</p>
<div class="fragment"><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;{</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>[256];</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html">ast_sip_endpoint_id_configuration</a> *<span class="keywordtype">id</span> = &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;Role: %s\r\n&quot;</span>,</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;             <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af59dad57f47cf8401042d4ecd0b861e5">sip_subscription_roles_map</a>[sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">role</a>]);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span>,</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;             <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>));</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(str, &amp;sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>-&gt;call_id-&gt;id, <span class="keyword">sizeof</span>(str));</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(str, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>, <span class="keyword">sizeof</span>(str));</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   }</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;Callid: %s\r\n&quot;</span>, str);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;State: %s\r\n&quot;</span>, pjsip_evsub_get_state_name(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>));</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   <a class="code" href="../../de/d47/callerid_8h.html#a1c25633b1ed63682c95ec613d7cbe559">ast_callerid_merge</a>(str, <span class="keyword">sizeof</span>(str),</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(id-&gt;<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, id-&gt;<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(id-&gt;<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, id-&gt;<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            <span class="stringliteral">&quot;Unknown&quot;</span>);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;Callerid: %s\r\n&quot;</span>, str);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   <span class="comment">/* XXX This needs to be done recursively for lists */</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a2cdc6ead7e87bb0cd7c01b2445b0f60d">to_ami</a>) {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;<a class="code" href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">handler</a>-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a2cdc6ead7e87bb0cd7c01b2445b0f60d">to_ami</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>, buf);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   }</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;}</div><div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html">ast_sip_endpoint_id_configuration</a></div><div class="ttdoc">Party identification options for endpoints. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00628">res_pjsip.h:628</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_af59dad57f47cf8401042d4ecd0b861e5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#af59dad57f47cf8401042d4ecd0b861e5">sip_subscription_roles_map</a></div><div class="ttdeci">static const char * sip_subscription_roles_map[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00518">res_pjsip_pubsub.c:518</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a2cdc6ead7e87bb0cd7c01b2445b0f60d"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a2cdc6ead7e87bb0cd7c01b2445b0f60d">ast_sip_subscription_handler::to_ami</a></div><div class="ttdeci">void(* to_ami)(struct ast_sip_subscription *sub, struct ast_str **buf)</div><div class="ttdoc">Converts the subscriber to AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00335">res_pjsip_pubsub.h:335</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a50c22c2e37da046bc68c646d2599a937"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a50c22c2e37da046bc68c646d2599a937">sip_subscription_tree::role</a></div><div class="ttdeci">enum ast_sip_subscription_role role</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00437">res_pjsip_pubsub.c:437</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="callerid_8h_html_a1c25633b1ed63682c95ec613d7cbe559"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a1c25633b1ed63682c95ec613d7cbe559">ast_callerid_merge</a></div><div class="ttdeci">char * ast_callerid_merge(char *buf, int bufsiz, const char *name, const char *num, const char *unknown)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01073">callerid.c:1073</a></div></div>
<div class="ttc" id="structast__sip__subscription_html_a4d9a6ec93b26e05758324e9708e7b5a9"><div class="ttname"><a href="../../db/d02/structast__sip__subscription.html#a4d9a6ec93b26e05758324e9708e7b5a9">ast_sip_subscription::handler</a></div><div class="ttdeci">const struct ast_sip_subscription_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00481">res_pjsip_pubsub.c:481</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a179b9758f096dc75be612d5f4e5f07cc"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">ast_sip_endpoint_id_configuration::self</a></div><div class="ttdeci">struct ast_party_id self</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00629">res_pjsip.h:629</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7fa8f8f5e7bf978b9bc6c710d3b3e437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa8f8f5e7bf978b9bc6c710d3b3e437">&#9670;&nbsp;</a></span>sub_add_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sub_add_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02756">2756</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00740">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00090">ast_sip_publish_handler::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02777">ast_sip_register_subscription_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;{</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>, handler, next);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;}</div><div class="ttc" id="structsubscription__handlers_html"><div class="ttname"><a href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02754">res_pjsip_pubsub.c:2754</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45ea33c1531c67d7002776939ec80b2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ea33c1531c67d7002776939ec80b2b">&#9670;&nbsp;</a></span>sub_persistence_recreate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sub_persistence_recreate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">1556</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02670">ast_sip_mod_data_set</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00866">ast_sip_pubsub_has_eventlist_support()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d6/d47/utils_2frame_8c_source.html#l00999">error()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">initial_notify_data::expires</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00359">generator</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">MOD_DATA_PERSISTENCE</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">ast_sip_subscription_handler::notifier</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01544">persistence_recreate_data::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01545">persistence_recreate_data::rdata</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">resource_tree_destroy()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">initial_notify_data::sub_tree</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">subscription_get_generator_from_rdata()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">subscription_get_handler_from_rdata()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00529">SUBSCRIPTION_PERSISTENCE_RECREATED</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">subscription_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;{</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d4c/structpersistence__recreate__data.html">persistence_recreate_data</a> *recreate_data = obj;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = recreate_data-&gt;<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;   pjsip_rx_data *rdata = recreate_data-&gt;<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a> *<a class="code" href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a>;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;   <span class="keywordtype">char</span> *resource;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;   pjsip_sip_uri *request_uri;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;   <span class="keywordtype">size_t</span> resource_size;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;   <span class="keywordtype">int</span> resp;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a> tree;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   pjsip_expires_hdr *expires_header;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   int64_t expires;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   request_uri = pjsip_uri_get_uri(rdata-&gt;msg_info.msg-&gt;line.req.uri);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;   resource_size = pj_strlen(&amp;request_uri-&gt;user) + 1;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   resource = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(resource_size);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(resource, &amp;request_uri-&gt;user, resource_size);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">    * We may want to match without any user options getting</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">    * in the way.</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(resource);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;   handler = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a97f99a19e99580b4339e386220c2d9f6">subscription_get_handler_from_rdata</a>(rdata, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <span class="keywordflow">if</span> (!handler || !handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>) {</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Could not get subscription handler.\n&quot;</span>,</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;   }</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   generator = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#af57976fae525316e955e6163f943db90">subscription_get_generator_from_rdata</a>(rdata, handler);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;   <span class="keywordflow">if</span> (!generator) {</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Body generator not available.\n&quot;</span>,</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   }</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a>(rdata-&gt;tp_info.pool, rdata-&gt;endpt_info.mod_data,</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a>, persistence);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;   <span class="comment">/* Getting the endpoint may take some time that can affect the expiration. */</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   endpoint = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;endpoint&quot;</span>,</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: The endpoint was not found\n&quot;</span>,</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   }</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;   <span class="comment">/* Update the expiration header with the new expiration */</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;   expires_header = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_EXPIRES,</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      rdata-&gt;msg_info.msg-&gt;hdr.next);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;   <span class="keywordflow">if</span> (!expires_header) {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      expires_header = pjsip_expires_hdr_create(rdata-&gt;tp_info.pool, 0);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">if</span> (!expires_header) {</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Could not update expires header.\n&quot;</span>,</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(endpoint, -1);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      }</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      pjsip_msg_add_hdr(rdata-&gt;msg_info.msg, (pjsip_hdr *) expires_header);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;   }</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   expires = (<a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>, <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>()) / 1000);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   <span class="keywordflow">if</span> (expires &lt;= 0) {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="comment">/* The subscription expired since we started recreating the subscription. */</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Expired subscription retrived from persistent store &#39;%s&#39; %s\n&quot;</span>,</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(endpoint, -1);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;   }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;   expires_header-&gt;ivalue = expires;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   memset(&amp;tree, 0, <span class="keyword">sizeof</span>(tree));</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;   resp = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a>(endpoint, handler, resource, &amp;tree,</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa94f5c5d378799e218956c0804cbfb1e">ast_sip_pubsub_has_eventlist_support</a>(rdata));</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   <span class="keywordflow">if</span> (PJSIP_IS_STATUS_IN_CLASS(resp, 200)) {</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      pj_status_t dlg_status;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      sub_tree = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a006316bcef76ef13dc1cc99560fbaa86">create_subscription_tree</a>(handler, endpoint, rdata, resource, generator,</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;         &amp;tree, &amp;dlg_status, persistence);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="keywordflow">if</span> (!sub_tree) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;         <span class="keywordflow">if</span> (dlg_status != PJ_EEXISTS) {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Could not create subscription tree.\n&quot;</span>,</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;               persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;         }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a> *ind = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*ind));</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;         <span class="keywordflow">if</span> (!ind) {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;         }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">sub_tree</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(sub_tree);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         ind-&gt;<a class="code" href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">expires</a> = expires_header-&gt;ivalue;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a>(sub_tree, rdata, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a>);</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#acb194881d03c561cd60d0c88f82c7478">initial_notify_task</a>, ind)) {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="comment">/* Could not send initial subscribe NOTIFY */</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ind);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;         }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   }</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>:</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a>(&amp;tree);</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(endpoint, -1);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a06552650d7ef9108d5744ee3f3fff264"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a06552650d7ef9108d5744ee3f3fff264">initial_notify_data::expires</a></div><div class="ttdeci">unsigned int expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01536">res_pjsip_pubsub.c:1536</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structast__sip__pubsub__body__generator_html"><div class="ttname"><a href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a></div><div class="ttdoc">Pubsub body generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00591">res_pjsip_pubsub.h:591</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_acb194881d03c561cd60d0c88f82c7478"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#acb194881d03c561cd60d0c88f82c7478">initial_notify_task</a></div><div class="ttdeci">static int initial_notify_task(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">res_pjsip_pubsub.c:2929</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a06762434263891503f1fe196fd2cf613"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">ast_sip_subscription_handler::notifier</a></div><div class="ttdeci">struct ast_sip_notifier * notifier</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">res_pjsip_pubsub.h:339</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ab37c67d3e45723f0b0aaf21dd9e2d605"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ab37c67d3e45723f0b0aaf21dd9e2d605">subscription_persistence_update</a></div><div class="ttdeci">static void subscription_persistence_update(struct sip_subscription_tree *sub_tree, pjsip_rx_data *rdata, enum sip_persistence_update_type type)</div><div class="ttdoc">Function which updates persistence information of a subscription in sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">res_pjsip_pubsub.c:662</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9937f98867d28da0cc0e8590d9c9ffa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a></div><div class="ttdeci">#define ast_sip_mod_data_set(pool, mod_data, id, key, val)</div><div class="ttdoc">Utilizing a mod_data array for a given id, set the value associated with the given key...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02670">res_pjsip.h:2670</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_af57976fae525316e955e6163f943db90"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#af57976fae525316e955e6163f943db90">subscription_get_generator_from_rdata</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * subscription_get_generator_from_rdata(pjsip_rx_data *rdata, const struct ast_sip_subscription_handler *handler)</div><div class="ttdoc">Retrieve a body generator using the Accept header of an rdata message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">res_pjsip_pubsub.c:831</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">persistence_recreate_data::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01545">res_pjsip_pubsub.c:1545</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structinitial__notify__data_html"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html">initial_notify_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01534">res_pjsip_pubsub.c:1534</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aca2de2a2c7ba7a0a16d4632b56af96fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a></div><div class="ttdeci">static void resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">Destroy a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">res_pjsip_pubsub.c:1109</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00529">res_pjsip_pubsub.c:529</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="app__fax_8c_html_a36aeb2eb01afb248bad64a309d743636"><div class="ttname"><a href="../../df/dde/app__fax_8c.html#a36aeb2eb01afb248bad64a309d743636">generator</a></div><div class="ttdeci">static struct ast_generator generator</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dde/app__fax_8c_source.html#l00359">app_fax.c:359</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a97f99a19e99580b4339e386220c2d9f6"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a97f99a19e99580b4339e386220c2d9f6">subscription_get_handler_from_rdata</a></div><div class="ttdeci">static struct ast_sip_subscription_handler * subscription_get_handler_from_rdata(pjsip_rx_data *rdata, const char *endpoint)</div><div class="ttdoc">Retrieve a handler using the Event header of an rdata message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">res_pjsip_pubsub.c:771</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a3707d69a8c25755d9fbe3f4d2ed80477"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a></div><div class="ttdeci">static int build_resource_tree(struct ast_sip_endpoint *endpoint, const struct ast_sip_subscription_handler *handler, const char *resource, struct resource_tree *tree, int has_eventlist_support)</div><div class="ttdoc">Build a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">res_pjsip_pubsub.c:1135</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence_recreate_data::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01544">res_pjsip_pubsub.c:1544</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a006316bcef76ef13dc1cc99560fbaa86"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a006316bcef76ef13dc1cc99560fbaa86">create_subscription_tree</a></div><div class="ttdeci">static struct sip_subscription_tree * create_subscription_tree(const struct ast_sip_subscription_handler *handler, struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, const char *resource, struct ast_sip_pubsub_body_generator *generator, struct resource_tree *tree, pj_status_t *dlg_status, struct subscription_persistence *persistence)</div><div class="ttdoc">Create a subscription tree based on a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">res_pjsip_pubsub.c:1465</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structinitial__notify__data_html_a3b20a602cda3a7726e79738d006c5518"><div class="ttname"><a href="../../df/dbb/structinitial__notify__data.html#a3b20a602cda3a7726e79738d006c5518">initial_notify_data::sub_tree</a></div><div class="ttdeci">struct sip_subscription_tree * sub_tree</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01535">res_pjsip_pubsub.c:1535</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a4a9391ee88e57361b613c4c2fd2bf4aa"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a></div><div class="ttdeci">int error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00999">utils/frame.c:999</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad9ab4b2e3c02b132f457ec3e61d5d47d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad9ab4b2e3c02b132f457ec3e61d5d47d">MOD_DATA_PERSISTENCE</a></div><div class="ttdeci">#define MOD_DATA_PERSISTENCE</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00235">res_pjsip_pubsub.c:235</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa94f5c5d378799e218956c0804cbfb1e"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa94f5c5d378799e218956c0804cbfb1e">ast_sip_pubsub_has_eventlist_support</a></div><div class="ttdeci">static int ast_sip_pubsub_has_eventlist_support(pjsip_rx_data *rdata)</div><div class="ttdoc">Check if the rdata has a Supported header containing &amp;#39;eventlist&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00866">res_pjsip_pubsub.c:866</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html">persistence_recreate_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01543">res_pjsip_pubsub.c:1543</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d4ca6324c97d4c2a957dea2aa74c27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d4ca6324c97d4c2a957dea2aa74c27b">&#9670;&nbsp;</a></span>sub_tree_subscription_terminate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sub_tree_subscription_terminate_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00572">572</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">subscription_persistence::prune_on_boot</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">sip_subscription_tree::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">sub_tree_transport_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = data;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">/* Something else already terminated the subscription. */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Transport destroyed.  Removing subscription &#39;%s-&gt;%s&#39;  prune on boot: %d\n&quot;</span>,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">state</a> = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   pjsip_evsub_terminate(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, PJ_TRUE);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a08e0b4a94cab7d431f1717d53d619447"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">subscription_persistence::prune_on_boot</a></div><div class="ttdeci">int prune_on_boot</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">res_pjsip_pubsub.c:396</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9765def6b392c5f0f2eabbf976174b5a"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9765def6b392c5f0f2eabbf976174b5a">sip_subscription_tree::state</a></div><div class="ttdeci">enum sip_subscription_tree_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00457">res_pjsip_pubsub.c:457</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a386166c75f00c0b4d1878e3a6d666e89af9b5de443ecb1dc5781aff2a03502ca5">SIP_SUB_TREE_TERMINATE_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00410">res_pjsip_pubsub.c:410</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf46a87a277bf64c6230f9f2237906f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf46a87a277bf64c6230f9f2237906f8">&#9670;&nbsp;</a></span>sub_tree_transport_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sub_tree_transport_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">603</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00572">sub_tree_subscription_terminate_cb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">subscription_persistence_remove()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">subscription_persistence_update()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = data;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">    * Push off the subscription termination to the serializer to</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">    * avoid deadlock.  Another thread could be trying to send a</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">    * message on the subscription that can deadlock with this</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">    * thread.</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, +1);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d4ca6324c97d4c2a957dea2aa74c27b">sub_tree_subscription_terminate_cb</a>,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      sub_tree)) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree, -1);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a2d4ca6324c97d4c2a957dea2aa74c27b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2d4ca6324c97d4c2a957dea2aa74c27b">sub_tree_subscription_terminate_cb</a></div><div class="ttdeci">static int sub_tree_subscription_terminate_cb(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00572">res_pjsip_pubsub.c:572</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af57976fae525316e955e6163f943db90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57976fae525316e955e6163f943db90">&#9670;&nbsp;</a></span>subscription_get_generator_from_rdata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../df/dc3/structast__sip__pubsub__body__generator.html">ast_sip_pubsub_body_generator</a>* subscription_get_generator_from_rdata </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve a body generator using the Accept header of an rdata message. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00831">831</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00219">AST_SIP_MAX_ACCEPT</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00318">ast_sip_subscription_handler::body_type</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00255">ast_sip_notifier::default_accept</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00817">exceptional_accept()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02862">find_body_generator()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">ast_sip_subscription_handler::notifier</a>, and <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00894">while()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;{</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   pjsip_accept_hdr *accept_header = (pjsip_accept_hdr *) &amp;rdata-&gt;msg_info.msg-&gt;hdr;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <span class="keywordtype">char</span> accept[<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a>][64];</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="keywordtype">size_t</span> num_accept_headers = 0;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a> ((accept_header = pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_ACCEPT, accept_header-&gt;next)) &amp;&amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      (num_accept_headers &lt; <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a>)) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; accept_header-&gt;count &amp;&amp; num_accept_headers &lt; <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a>; ++i) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a37e5c81dbce6f5db2f91dbe92689ec2f">exceptional_accept</a>(&amp;accept_header-&gt;values[i])) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(accept[num_accept_headers], &amp;accept_header-&gt;values[i], <span class="keyword">sizeof</span>(accept[num_accept_headers]));</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            ++num_accept_headers;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   <span class="keywordflow">if</span> (num_accept_headers == 0) {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">/* If a SUBSCRIBE contains no Accept headers, then we must assume that</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">       * the default accept type for the event package is to be used.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(accept[0], handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">notifier</a>-&gt;<a class="code" href="../../d1/d5b/structast__sip__notifier.html#ad1e64b1a6297045eb98ac47f56591b0f">default_accept</a>, <span class="keyword">sizeof</span>(accept[0]));</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      num_accept_headers = 1;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aa43549aaa8be02c39bd1e405f44d27f1">find_body_generator</a>(accept, num_accept_headers, handler-&gt;<a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html#a35514bc6335d541353cf54c7146e8ce5">body_type</a>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;}</div><div class="ttc" id="structast__sip__subscription__handler_html_a06762434263891503f1fe196fd2cf613"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a06762434263891503f1fe196fd2cf613">ast_sip_subscription_handler::notifier</a></div><div class="ttdeci">struct ast_sip_notifier * notifier</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00339">res_pjsip_pubsub.h:339</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a37e5c81dbce6f5db2f91dbe92689ec2f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a37e5c81dbce6f5db2f91dbe92689ec2f">exceptional_accept</a></div><div class="ttdeci">static int exceptional_accept(const pj_str_t *accept)</div><div class="ttdoc">Is the Accept header from the SUBSCRIBE in the list of exceptions? </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00817">res_pjsip_pubsub.c:817</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a8fdafe3be7e00ce3d4f0cb50a9a5eb39"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a></div><div class="ttdeci">while(1)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00894">ast_expr2f.c:894</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a1521854cc25592b7f8a58a4bed55ac6d"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a1521854cc25592b7f8a58a4bed55ac6d">AST_SIP_MAX_ACCEPT</a></div><div class="ttdeci">#define AST_SIP_MAX_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00219">res_pjsip_pubsub.h:219</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html_a35514bc6335d541353cf54c7146e8ce5"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html#a35514bc6335d541353cf54c7146e8ce5">ast_sip_subscription_handler::body_type</a></div><div class="ttdeci">const char * body_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00318">res_pjsip_pubsub.h:318</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aa43549aaa8be02c39bd1e405f44d27f1"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aa43549aaa8be02c39bd1e405f44d27f1">find_body_generator</a></div><div class="ttdeci">static struct ast_sip_pubsub_body_generator * find_body_generator(char accept[AST_SIP_MAX_ACCEPT][64], size_t num_accept, const char *body_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02862">res_pjsip_pubsub.c:2862</a></div></div>
<div class="ttc" id="structast__sip__notifier_html_ad1e64b1a6297045eb98ac47f56591b0f"><div class="ttname"><a href="../../d1/d5b/structast__sip__notifier.html#ad1e64b1a6297045eb98ac47f56591b0f">ast_sip_notifier::default_accept</a></div><div class="ttdeci">const char * default_accept</div><div class="ttdoc">Default body type defined for the event package this notifier handles. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00255">res_pjsip_pubsub.h:255</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97f99a19e99580b4339e386220c2d9f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f99a19e99580b4339e386220c2d9f6">&#9670;&nbsp;</a></span>subscription_get_handler_from_rdata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a>* subscription_get_handler_from_rdata </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve a handler using the Event header of an rdata message. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">771</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">find_sub_handler_for_event_name()</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00238">str_event_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;{</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   pjsip_event_hdr *event_header;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="keywordtype">char</span> <span class="keyword">event</span>[32];</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   event_header = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4abffbee599d833b446686d5213d80e4">str_event_name</a>, rdata-&gt;msg_info.msg-&gt;hdr.next);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (!event_header) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Incoming SUBSCRIBE request from %s with no Event header\n&quot;</span>,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;         endpoint ? endpoint : <span class="stringliteral">&quot;Unknown&quot;</span>);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>, &amp;event_header-&gt;event_type, <span class="keyword">sizeof</span>(<a class="code" href="../../df/d7d/structevent.html">event</a>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   handler = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a219baab2a37a17e4922d696be2e07cca">find_sub_handler_for_event_name</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keywordflow">if</span> (!handler) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No registered subscribe handler for event %s from %s\n&quot;</span>, <a class="code" href="../../df/d7d/structevent.html">event</a>,</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;         endpoint ? endpoint : <span class="stringliteral">&quot;Unknown&quot;</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__subscription__handler_html"><div class="ttname"><a href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00314">res_pjsip_pubsub.h:314</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a219baab2a37a17e4922d696be2e07cca"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a219baab2a37a17e4922d696be2e07cca">find_sub_handler_for_event_name</a></div><div class="ttdeci">static struct ast_sip_subscription_handler * find_sub_handler_for_event_name(const char *event_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">res_pjsip_pubsub.c:2763</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4abffbee599d833b446686d5213d80e4"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4abffbee599d833b446686d5213d80e4">str_event_name</a></div><div class="ttdeci">static const pj_str_t str_event_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00238">res_pjsip_pubsub.c:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae323533f795e111d13b1d7b9a3d1d973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae323533f795e111d13b1d7b9a3d1d973">&#9670;&nbsp;</a></span>subscription_persistence_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* subscription_persistence_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocator for subscription persistence. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00631">631</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01728">ast_sorcery_generic_alloc()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00621">subscription_persistence_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>), <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ae5e6ba3b3b049c415ad3056467cc846c">subscription_persistence_destroy</a>);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_ae5e6ba3b3b049c415ad3056467cc846c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ae5e6ba3b3b049c415ad3056467cc846c">subscription_persistence_destroy</a></div><div class="ttdeci">static void subscription_persistence_destroy(void *obj)</div><div class="ttdoc">Destructor for subscription persistence. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00621">res_pjsip_pubsub.c:621</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00a4fae74e9482fb6c95acb3d653a182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a4fae74e9482fb6c95acb3d653a182">&#9670;&nbsp;</a></span>subscription_persistence_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a>* subscription_persistence_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which creates initial persistence information of a subscription in sorcery. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00637">637</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01744">ast_sorcery_alloc()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;{</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keywordtype">char</span> tag[PJ_GUID_STRING_LENGTH + 1];</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="comment">/* The id of this persistence object doesn&#39;t matter as we keep it on the subscription and don&#39;t need to</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">    * look it up by id at all.</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(),</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   pjsip_dialog *dlg = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="keywordflow">if</span> (!persistence) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>));</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(tag, &amp;dlg-&gt;local.info-&gt;tag, <span class="keyword">sizeof</span>(tag));</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(tag);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordflow">return</span> persistence;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5e6ba3b3b049c415ad3056467cc846c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e6ba3b3b049c415ad3056467cc846c">&#9670;&nbsp;</a></span>subscription_persistence_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_persistence_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for subscription persistence. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00621">621</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">subscription_persistence::generator_data</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00631">subscription_persistence_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;{</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">generator_data</a>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div><div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a1805e05b0976bcd4f821f92c0206cba0"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a1805e05b0976bcd4f821f92c0206cba0">subscription_persistence::generator_data</a></div><div class="ttdeci">struct ast_json * generator_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00398">res_pjsip_pubsub.c:398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac62bbbfecf4068411d7fa11225c91055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac62bbbfecf4068411d7fa11225c91055">&#9670;&nbsp;</a></span>subscription_persistence_event_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_persistence_event_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Event callback which fires subscription persistence recreation when the system is fully booted. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">1772</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d4/d05/json_8h_source.html#l01025">ast_json_payload::json</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">subscription_persistence_load()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;{</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *payload;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message) != <a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>()) {</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;   payload = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   type = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>, <span class="stringliteral">&quot;type&quot;</span>));</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   <span class="comment">/* This subscription only responds to the FullyBooted event so that all modules have been loaded when we</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment">    * recreate SIP subscriptions.</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   <span class="keywordflow">if</span> (strcmp(type, <span class="stringliteral">&quot;FullyBooted&quot;</span>)) {</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;   }</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;   <span class="comment">/* This has to be here so the subscription is recreated when the body generator is available */</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e8ac5e3b2ce24bb0441ca5c30fa783c">subscription_persistence_load</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;   <span class="comment">/* Once the system is fully booted we don&#39;t care anymore */</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a>(sub);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="structast__json__payload_html_a9cf488298469ae63ef947653d7ff9bab"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">ast_json_payload::json</a></div><div class="ttdeci">struct ast_json * json</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01025">json.h:1025</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="manager_8h_html_a8ae409b5ff584e42c30edcfe5837d85c"><div class="ttname"><a href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a></div><div class="ttdeci">struct stasis_message_type * ast_manager_get_generic_type(void)</div><div class="ttdoc">Get the stasis_message_type for generic messages. </div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0e8ac5e3b2ce24bb0441ca5c30fa783c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e8ac5e3b2ce24bb0441ca5c30fa783c">subscription_persistence_load</a></div><div class="ttdeci">static int subscription_persistence_load(void *data)</div><div class="ttdoc">Function which loads and recreates persisted subscriptions upon startup when the system is fully boot...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">res_pjsip_pubsub.c:1750</a></div></div>
<div class="ttc" id="stasis_8h_html_a3498301077e2005383f0d261c471388b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e8ac5e3b2ce24bb0441ca5c30fa783c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e8ac5e3b2ce24bb0441ca5c30fa783c">&#9670;&nbsp;</a></span>subscription_persistence_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int subscription_persistence_load </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which loads and recreates persisted subscriptions upon startup when the system is fully booted. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">1750</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00123">AST_RETRIEVE_FLAG_ALL</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00120">AST_RETRIEVE_FLAG_MULTIPLE</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01897">ast_sorcery_retrieve_by_fields()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">pool</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">subscription_persistence_recreate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;{</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *persisted_subscriptions = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(),</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="stringliteral">&quot;subscription_persistence&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   pj_pool_t *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   pool = pjsip_endpt_create_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), <span class="stringliteral">&quot;rtd%p&quot;</span>, PJSIP_POOL_RDATA_LEN,</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      PJSIP_POOL_RDATA_INC);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not create a memory pool for recreating SIP subscriptions\n&quot;</span>);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   }</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(persisted_subscriptions, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e4842b1807e5e2d33bfda094c83f84d">subscription_persistence_recreate</a>, pool);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;   pjsip_endpt_release_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), pool);</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(persisted_subscriptions, -1);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a></div><div class="ttdoc">Perform no matching, return all objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00123">sorcery.h:123</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a></div><div class="ttdoc">Return all matching objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00120">sorcery.h:120</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a0e4842b1807e5e2d33bfda094c83f84d"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a0e4842b1807e5e2d33bfda094c83f84d">subscription_persistence_recreate</a></div><div class="ttdeci">static int subscription_persistence_recreate(void *obj, void *arg, int flags)</div><div class="ttdoc">Callback function to perform the actual recreation of a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">res_pjsip_pubsub.c:1684</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_aaa9cd237841a70862001f580b23212c9"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_fields(const struct ast_sorcery *sorcery, const char *type, unsigned int flags, struct ast_variable *fields)</div><div class="ttdoc">Retrieve an object or multiple objects using specific fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01897">sorcery.c:1897</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e4842b1807e5e2d33bfda094c83f84d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e4842b1807e5e2d33bfda094c83f84d">&#9670;&nbsp;</a></span>subscription_persistence_recreate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int subscription_persistence_recreate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function to perform the actual recreation of a subscription. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">1684</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04271">ast_sip_create_rdata_with_contact()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">ast_sip_get_distributor_serializer()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05218">ast_sip_push_task_wait_serializer()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00394">subscription_persistence::contact_uri</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00384">subscription_persistence::local_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00386">subscription_persistence::local_port</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00376">subscription_persistence::packet</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01544">persistence_recreate_data::persistence</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">pool</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">subscription_persistence::prune_on_boot</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01545">persistence_recreate_data::rdata</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00378">subscription_persistence::src_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00380">subscription_persistence::src_port</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">subscription_persistence::tag</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00382">subscription_persistence::transport_key</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01750">subscription_persistence_load()</a>.</p>
<div class="fragment"><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;{</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a> *persistence = obj;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   pj_pool_t *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a> = arg;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="code" href="../../d9/d47/structserializer.html">serializer</a>;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   pjsip_rx_data rdata;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d4c/structpersistence__recreate__data.html">persistence_recreate_data</a> recreate_data;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   <span class="comment">/* If this subscription used a reliable transport it can&#39;t be reestablished so remove it */</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;   <span class="keywordflow">if</span> (persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a>) {</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Deleting subscription marked as &#39;prune&#39; from persistent store &#39;%s&#39; %s\n&quot;</span>,</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;   }</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   <span class="comment">/* If this subscription has already expired remove it */</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>, <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>()) &lt;= 0) {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Expired subscription retrived from persistent store &#39;%s&#39; %s\n&quot;</span>,</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">tag</a>);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   }</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;   memset(&amp;rdata, 0, <span class="keyword">sizeof</span>(rdata));</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;   pj_pool_reset(pool);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;   rdata.tp_info.pool = <a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#af7c7bb566c8c49dc6536269d0cb736a8">ast_sip_create_rdata_with_contact</a>(&amp;rdata, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">packet</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a22710c9f61c084ea3c72d16b9417ff6f">src_name</a>,</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a2d47efc2f2609185cf802853871de027">src_port</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a050353acc15d097365b7d63f33634d93">transport_key</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#ade656f40303348a90111082ae08708b1">local_name</a>,</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a009e2d58737d2223ce009dc0631e65dc">local_port</a>, persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a43edc8933583da8bdbbe4b62a6b0e008">contact_uri</a>)) {</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: The message could not be parsed\n&quot;</span>,</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;   }</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;   <span class="keywordflow">if</span> (rdata.msg_info.msg-&gt;type != PJSIP_REQUEST_MSG) {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Stored a SIP response instead of a request.\n&quot;</span>,</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   <span class="comment">/* Continue the remainder in the distributor serializer */</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   serializer = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a>(&amp;rdata);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;   <span class="keywordflow">if</span> (!serializer) {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Could not get distributor serializer.\n&quot;</span>,</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   recreate_data.persistence = <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;   recreate_data.rdata = &amp;<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a>(serializer, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a45ea33c1531c67d7002776939ec80b2b">sub_persistence_recreate</a>,</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      &amp;recreate_data)) {</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed recreating &#39;%s&#39; subscription: Could not continue under distributor serializer.\n&quot;</span>,</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;         persistence-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), persistence);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(serializer);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;}</div><div class="ttc" id="structsubscription__persistence_html_a08e0b4a94cab7d431f1717d53d619447"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">subscription_persistence::prune_on_boot</a></div><div class="ttdeci">int prune_on_boot</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">res_pjsip_pubsub.c:396</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_ade656f40303348a90111082ae08708b1"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#ade656f40303348a90111082ae08708b1">subscription_persistence::local_name</a></div><div class="ttdeci">char local_name[PJ_INET6_ADDRSTRLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00384">res_pjsip_pubsub.c:384</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsubscription__persistence_html"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html">subscription_persistence</a></div><div class="ttdoc">Structure used for persisting an inbound subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00370">res_pjsip_pubsub.c:370</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a8d5dbabe731f82e2db15cbf4dabbca93"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">subscription_persistence::packet</a></div><div class="ttdeci">char packet[PJSIP_MAX_PKT_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00376">res_pjsip_pubsub.c:376</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a2d47efc2f2609185cf802853871de027"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a2d47efc2f2609185cf802853871de027">subscription_persistence::src_port</a></div><div class="ttdeci">int src_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00380">res_pjsip_pubsub.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gac231880459dcf8feacf1bb272b60472a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a></div><div class="ttdeci">int ast_sip_push_task_wait_serializer(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to the serializer and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05218">res_pjsip.c:5218</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">persistence_recreate_data::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01545">res_pjsip_pubsub.c:1545</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a009e2d58737d2223ce009dc0631e65dc"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a009e2d58737d2223ce009dc0631e65dc">subscription_persistence::local_port</a></div><div class="ttdeci">int local_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00386">res_pjsip_pubsub.c:386</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence_recreate_data::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01544">res_pjsip_pubsub.c:1544</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a45ea33c1531c67d7002776939ec80b2b"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a45ea33c1531c67d7002776939ec80b2b">sub_persistence_recreate</a></div><div class="ttdeci">static int sub_persistence_recreate(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">res_pjsip_pubsub.c:1556</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a050353acc15d097365b7d63f33634d93"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a050353acc15d097365b7d63f33634d93">subscription_persistence::transport_key</a></div><div class="ttdeci">char transport_key[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00382">res_pjsip_pubsub.c:382</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga506c31bc071963fa7ef3ed517fa0a533"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_get_distributor_serializer(pjsip_rx_data *rdata)</div><div class="ttdoc">Determine the distributor serializer for the SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">pjsip_distributor.c:448</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_af7c7bb566c8c49dc6536269d0cb736a8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#af7c7bb566c8c49dc6536269d0cb736a8">ast_sip_create_rdata_with_contact</a></div><div class="ttdeci">int ast_sip_create_rdata_with_contact(pjsip_rx_data *rdata, char *packet, const char *src_name, int src_port, char *transport_type, const char *local_name, int local_port, const char *contact_uri)</div><div class="ttdoc">General purpose method for creating an rdata structure using specific information. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04271">res_pjsip.c:4271</a></div></div>
<div class="ttc" id="structserializer_html"><div class="ttname"><a href="../../d9/d47/structserializer.html">serializer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01315">threadpool.c:1315</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a43edc8933583da8bdbbe4b62a6b0e008"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a43edc8933583da8bdbbe4b62a6b0e008">subscription_persistence::contact_uri</a></div><div class="ttdeci">char contact_uri[PJSIP_MAX_URL_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00394">res_pjsip_pubsub.c:394</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a22710c9f61c084ea3c72d16b9417ff6f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a22710c9f61c084ea3c72d16b9417ff6f">subscription_persistence::src_name</a></div><div class="ttdeci">char src_name[PJ_INET6_ADDRSTRLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00378">res_pjsip_pubsub.c:378</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7bb5e40c10df6a41df64bda1f4bb3e26"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7bb5e40c10df6a41df64bda1f4bb3e26">subscription_persistence::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00390">res_pjsip_pubsub.c:390</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html">persistence_recreate_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01543">res_pjsip_pubsub.c:1543</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aace626897b8057471bc8f06b3e91e16c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aace626897b8057471bc8f06b3e91e16c">&#9670;&nbsp;</a></span>subscription_persistence_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_persistence_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which removes persistence of a subscription from sorcery. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00745">745</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00219">AST_SIP_MAX_ACCEPT</a>, <a class="el" href="../../d1/d94/pjsip__transport__events_8c_source.html#l00277">ast_sip_transport_monitor_unregister()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00603">ast_sip_pubsub_body_generator::body_type</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00316">ast_sip_subscription_handler::event_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02862">find_body_generator()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02763">find_sub_handler_for_event_name()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">subscription_persistence::prune_on_boot</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">sub_tree_transport_cb()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00466">sip_subscription_tree::transport</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>.</p>
<div class="fragment"><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;{</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a> &amp;&amp; sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">transport</a>) {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Unregistering transport monitor on %s &#39;%s-&gt;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;         sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">transport</a>-&gt;obj_name,</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;         sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> ? <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) : <span class="stringliteral">&quot;Unknown&quot;</span>,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;         sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a> ? sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource : <span class="stringliteral">&quot;Unknown&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5d73e049fbced1da4e3041d1656e0aa6">ast_sip_transport_monitor_unregister</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">transport</a>,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a>, sub_tree, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>, -1);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a08e0b4a94cab7d431f1717d53d619447"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">subscription_persistence::prune_on_boot</a></div><div class="ttdeci">int prune_on_boot</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">res_pjsip_pubsub.c:396</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a0cd500af1726295a50c6494772baaaec"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">sip_subscription_tree::transport</a></div><div class="ttdeci">pjsip_transport * transport</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00466">res_pjsip_pubsub.c:466</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abf46a87a277bf64c6230f9f2237906f8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a></div><div class="ttdeci">static void sub_tree_transport_cb(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">res_pjsip_pubsub.c:603</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5d73e049fbced1da4e3041d1656e0aa6"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5d73e049fbced1da4e3041d1656e0aa6">ast_sip_transport_monitor_unregister</a></div><div class="ttdeci">void ast_sip_transport_monitor_unregister(pjsip_transport *transport, ast_transport_monitor_shutdown_cb cb, void *data, ast_transport_monitor_data_matcher matches)</div><div class="ttdoc">Unregister a reliable transport shutdown monitor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00277">pjsip_transport_events.c:277</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab37c67d3e45723f0b0aaf21dd9e2d605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37c67d3e45723f0b0aaf21dd9e2d605">&#9670;&nbsp;</a></span>subscription_persistence_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_persistence_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400">sip_persistence_update_type</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which updates persistence information of a subscription in sorcery. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00662">662</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00238">ast_samp2tv()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d1/d94/pjsip__transport__events_8c_source.html#l00306">ast_sip_transport_monitor_register()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03723">ast_sip_will_uri_survive_restart()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02145">ast_sorcery_update()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l02283">ast_tvadd()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00394">subscription_persistence::contact_uri</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00388">subscription_persistence::cseq</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">DEFAULT_PUBLISH_EXPIRES</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">subscription_persistence::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">subscription_persistence::expires</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00384">subscription_persistence::local_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00386">subscription_persistence::local_port</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00226">MIN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00376">subscription_persistence::packet</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">sip_subscription_tree::persistence</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">subscription_persistence::prune_on_boot</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00378">subscription_persistence::src_name</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00380">subscription_persistence::src_port</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">sub_tree_transport_cb()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00527">SUBSCRIPTION_PERSISTENCE_CREATED</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00529">SUBSCRIPTION_PERSISTENCE_RECREATED</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00466">sip_subscription_tree::transport</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00382">subscription_persistence::transport_key</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01989">sip_subscription_send_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <span class="keywordflow">if</span> (!sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Updating persistence for &#39;%s-&gt;%s&#39;  prune on boot: %s\n&quot;</span>,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   dlg = sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#aa6f63c8aefae8e2f51a65f61d724aacf">cseq</a> = dlg-&gt;local.cseq;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> expires;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      pjsip_expires_hdr *expires_hdr = pjsip_msg_find_hdr(<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg, PJSIP_H_EXPIRES, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      pjsip_contact_hdr *contact_hdr = pjsip_msg_find_hdr(<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg, PJSIP_H_CONTACT, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      expires = expires_hdr ? expires_hdr-&gt;ivalue : <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a> = <a class="code" href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a>(expires, 1));</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">if</span> (contact_hdr) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;         <span class="keywordflow">if</span> (contact_hdr) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a>) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;               sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a> =</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                  !<a class="code" href="../../d7/d5c/res__pjsip__private_8h.html#ac73444851015b8a7be33534e4a7d2878">ast_sip_will_uri_survive_restart</a>(</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                     (pjsip_sip_uri *)pjsip_uri_get_uri(contact_hdr-&gt;uri),</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                     sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;               <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a>) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;adding transport monitor on %s for &#39;%s-&gt;%s&#39;  prune on boot: %d\n&quot;</span>,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                     <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;obj_name,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                     sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">endpoint</a>, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource,</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                     sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">prune_on_boot</a>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                  sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">transport</a> = <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                  <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aaee14820d45bd0be318822580b5a8b59">ast_sip_transport_monitor_register</a>(<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport,</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                     <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a>, sub_tree);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">                   * FYI: ast_sip_transport_monitor_register holds a reference to the sub_tree</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;               }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         pjsip_uri_print(PJSIP_URI_IN_CONTACT_HDR, contact_hdr-&gt;uri,</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;               sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a43edc8933583da8bdbbe4b62a6b0e008">contact_uri</a>, <span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a43edc8933583da8bdbbe4b62a6b0e008">contact_uri</a>));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Contact not updated due to missing contact header\n&quot;</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">/* When receiving a packet on an streaming transport, it&#39;s possible to receive more than one SIP</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">       * message at a time into the rdata-&gt;pkt_info.packet buffer. However, the rdata-&gt;msg_info.msg_buf</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">       * will always point to the proper SIP message that is to be processed. When updating subscription</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">       * persistence that is pulled from persistent storage, though, the rdata-&gt;pkt_info.packet will</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">       * only ever have a single SIP message on it, and so we base persistence on that.</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         || <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> == <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a>) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg_buf) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">packet</a>, <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg_buf,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                  <a class="code" href="../../d5/d60/utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">packet</a>), <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.len + 1));</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">packet</a>, <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.packet,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                  <span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">packet</a>));</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;         }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a22710c9f61c084ea3c72d16b9417ff6f">src_name</a>, <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_name,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a22710c9f61c084ea3c72d16b9417ff6f">src_name</a>));</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a2d47efc2f2609185cf802853871de027">src_port</a> = <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_port;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a050353acc15d097365b7d63f33634d93">transport_key</a>, <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;type_name,</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;         <span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a050353acc15d097365b7d63f33634d93">transport_key</a>));</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#ade656f40303348a90111082ae08708b1">local_name</a>, &amp;<a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;local_name.host,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;         <span class="keyword">sizeof</span>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#ade656f40303348a90111082ae08708b1">local_name</a>));</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>-&gt;<a class="code" href="../../d9/df9/structsubscription__persistence.html#a009e2d58737d2223ce009dc0631e65dc">local_port</a> = <a class="code" href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;local_name.port;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ab9184a8cdeb14537309e5e020948ecd3">ast_sorcery_update</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">persistence</a>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400a3ac2fdd9911335d820131a694972a2e3">SUBSCRIPTION_PERSISTENCE_CREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00527">res_pjsip_pubsub.c:527</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a08e0b4a94cab7d431f1717d53d619447"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a08e0b4a94cab7d431f1717d53d619447">subscription_persistence::prune_on_boot</a></div><div class="ttdeci">int prune_on_boot</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00396">res_pjsip_pubsub.c:396</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aaee14820d45bd0be318822580b5a8b59"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aaee14820d45bd0be318822580b5a8b59">ast_sip_transport_monitor_register</a></div><div class="ttdeci">enum ast_transport_monitor_reg ast_sip_transport_monitor_register(pjsip_transport *transport, ast_transport_monitor_shutdown_cb cb, void *ao2_data)</div><div class="ttdoc">Register a reliable transport shutdown monitor callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00306">pjsip_transport_events.c:306</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_ade656f40303348a90111082ae08708b1"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#ade656f40303348a90111082ae08708b1">subscription_persistence::local_name</a></div><div class="ttdeci">char local_name[PJ_INET6_ADDRSTRLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00384">res_pjsip_pubsub.c:384</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a6d2d1c31529bee906473fcabaffff34f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a6d2d1c31529bee906473fcabaffff34f">subscription_persistence::endpoint</a></div><div class="ttdeci">char * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00374">res_pjsip_pubsub.c:374</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a0cd500af1726295a50c6494772baaaec"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a0cd500af1726295a50c6494772baaaec">sip_subscription_tree::transport</a></div><div class="ttdeci">pjsip_transport * transport</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00466">res_pjsip_pubsub.c:466</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a7814e4900b15b2edc31554bbb7b61b3e">subscription_persistence::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00392">res_pjsip_pubsub.c:392</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a4d530a1f675151206b5929a37a882fe2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a4d530a1f675151206b5929a37a882fe2">DEFAULT_PUBLISH_EXPIRES</a></div><div class="ttdeci">#define DEFAULT_PUBLISH_EXPIRES</div><div class="ttdoc">Default expiration time for PUBLISH if one is not specified. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00247">res_pjsip_pubsub.c:247</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a8d5dbabe731f82e2db15cbf4dabbca93"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a8d5dbabe731f82e2db15cbf4dabbca93">subscription_persistence::packet</a></div><div class="ttdeci">char packet[PJSIP_MAX_PKT_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00376">res_pjsip_pubsub.c:376</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a21053f8b496f0b3ac0aee6f43d27adce"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a21053f8b496f0b3ac0aee6f43d27adce">sip_subscription_tree::persistence</a></div><div class="ttdeci">struct subscription_persistence * persistence</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00439">res_pjsip_pubsub.c:439</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a2d47efc2f2609185cf802853871de027"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a2d47efc2f2609185cf802853871de027">subscription_persistence::src_port</a></div><div class="ttdeci">int src_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00380">res_pjsip_pubsub.c:380</a></div></div>
<div class="ttc" id="utils_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00226">utils.h:226</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abf46a87a277bf64c6230f9f2237906f8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a></div><div class="ttdeci">static void sub_tree_transport_cb(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">res_pjsip_pubsub.c:603</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_aa6f63c8aefae8e2f51a65f61d724aacf"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#aa6f63c8aefae8e2f51a65f61d724aacf">subscription_persistence::cseq</a></div><div class="ttdeci">unsigned int cseq</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00388">res_pjsip_pubsub.c:388</a></div></div>
<div class="ttc" id="structpersistence__recreate__data_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../d4/d4c/structpersistence__recreate__data.html#a41249c16bd9cc17b36f3719debaf7a67">persistence_recreate_data::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01545">res_pjsip_pubsub.c:1545</a></div></div>
<div class="ttc" id="time_8h_html_a1d774df72e3dbb623475783e06ce4f61"><div class="ttname"><a href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a></div><div class="ttdeci">struct timeval ast_samp2tv(unsigned int _nsamp, unsigned int _rate)</div><div class="ttdoc">Returns a timeval corresponding to the duration of n samples at rate r. Useful to convert samples to ...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00238">time.h:238</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a36292f9aacdecd44efe47fa591beb400aff6b9c21e4f98d098c8bad80b822cdd2">SUBSCRIPTION_PERSISTENCE_RECREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00529">res_pjsip_pubsub.c:529</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a009e2d58737d2223ce009dc0631e65dc"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a009e2d58737d2223ce009dc0631e65dc">subscription_persistence::local_port</a></div><div class="ttdeci">int local_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00386">res_pjsip_pubsub.c:386</a></div></div>
<div class="ttc" id="time_8h_html_a97e1bb8fbd7a103212789e87e7ed6073"><div class="ttname"><a href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a></div><div class="ttdeci">struct timeval ast_tvadd(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the sum of two timevals a + b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02283">extconf.c:2283</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a050353acc15d097365b7d63f33634d93"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a050353acc15d097365b7d63f33634d93">subscription_persistence::transport_key</a></div><div class="ttdeci">char transport_key[32]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00382">res_pjsip_pubsub.c:382</a></div></div>
<div class="ttc" id="res__pjsip__private_8h_html_ac73444851015b8a7be33534e4a7d2878"><div class="ttname"><a href="../../d7/d5c/res__pjsip__private_8h.html#ac73444851015b8a7be33534e4a7d2878">ast_sip_will_uri_survive_restart</a></div><div class="ttdeci">int ast_sip_will_uri_survive_restart(pjsip_sip_uri *uri, struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03723">res_pjsip.c:3723</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a43edc8933583da8bdbbe4b62a6b0e008"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a43edc8933583da8bdbbe4b62a6b0e008">subscription_persistence::contact_uri</a></div><div class="ttdeci">char contact_uri[PJSIP_MAX_URL_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00394">res_pjsip_pubsub.c:394</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structsubscription__persistence_html_a22710c9f61c084ea3c72d16b9417ff6f"><div class="ttname"><a href="../../d9/df9/structsubscription__persistence.html#a22710c9f61c084ea3c72d16b9417ff6f">subscription_persistence::src_name</a></div><div class="ttdeci">char src_name[PJ_INET6_ADDRSTRLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00378">res_pjsip_pubsub.c:378</a></div></div>
<div class="ttc" id="sorcery_8h_html_ab9184a8cdeb14537309e5e020948ecd3"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ab9184a8cdeb14537309e5e020948ecd3">ast_sorcery_update</a></div><div class="ttdeci">int ast_sorcery_update(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Update an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02145">sorcery.c:2145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc8db1e0ce416bc7a5a05275db0cb8a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8db1e0ce416bc7a5a05275db0cb8a7">&#9670;&nbsp;</a></span>subscription_setup_dialog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_setup_dialog </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *&#160;</td>
          <td class="paramname"><em>sub_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">1396</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">ast_sip_dialog_set_endpoint()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">ast_sip_dialog_set_serializer()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">sip_subscription_tree::evsub</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">ast_sip_create_subscription()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;{</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = dlg;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a>(dlg, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a>(dlg, sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   pjsip_evsub_set_mod_data(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">evsub</a>, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>.id, sub_tree);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   pjsip_dlg_inc_session(dlg, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga86c62fe22e3b7fb409c13ec7fd4fee2d"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a></div><div class="ttdeci">void ast_sip_dialog_set_serializer(pjsip_dialog *dlg, struct ast_taskprocessor *serializer)</div><div class="ttdoc">Set a serializer on a SIP dialog so requests and responses are automatically serialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">pjsip_distributor.c:266</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga6d8415024c851216fa63fbb94d0aadcf"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a></div><div class="ttdeci">void ast_sip_dialog_set_endpoint(pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint)</div><div class="ttdoc">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">pjsip_distributor.c:294</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3990a4c9f559fbabfdfe3f6785246b3e"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3990a4c9f559fbabfdfe3f6785246b3e">sip_subscription_tree::evsub</a></div><div class="ttdeci">pjsip_evsub * evsub</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00441">res_pjsip_pubsub.c:441</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05c2af54560a8245eef9bd323c2f758b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05c2af54560a8245eef9bd323c2f758b">&#9670;&nbsp;</a></span>subscription_tree_destructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscription_tree_destructor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">1367</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00469">ast_module_unref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05204">ast_sip_push_task_wait_servant()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01215">destroy_subscriptions()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">sip_subscription_tree::endpoint</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">sip_subscription_tree::root</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">sip_subscription_tree::serializer</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01348">subscription_unreference_dialog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = obj;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Destroying subscription tree %p &#39;%s-&gt;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      sub_tree,</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> ? <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) : <span class="stringliteral">&quot;Unknown&quot;</span>,</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a> ? sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>-&gt;resource : <span class="stringliteral">&quot;Unknown&quot;</span>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8c090850897d5a72420ff3446fe74440">destroy_subscriptions</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">root</a>);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   <span class="keywordflow">if</span> (sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>) {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>,</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;         <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a91e1ece55fdcfb0290b5cac07b1d463a">subscription_unreference_dialog</a>, sub_tree);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;}</div><div class="ttc" id="structsip__subscription__tree_html_ac02d9f08d76f5be5e9c998ca541c05b9"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac02d9f08d76f5be5e9c998ca541c05b9">sip_subscription_tree::root</a></div><div class="ttdeci">struct ast_sip_subscription * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00451">res_pjsip_pubsub.c:451</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a3960205b2a4e7e012dc9f0eae1855f01">sip_subscription_tree::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00433">res_pjsip_pubsub.c:433</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gab8c82412fe0432a91d5c7985cfdf9b59"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a></div><div class="ttdeci">int ast_sip_push_task_wait_servant(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to SIP servants and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05204">res_pjsip.c:5204</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a91e1ece55fdcfb0290b5cac07b1d463a"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a91e1ece55fdcfb0290b5cac07b1d463a">subscription_unreference_dialog</a></div><div class="ttdeci">static int subscription_unreference_dialog(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01348">res_pjsip_pubsub.c:1348</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a8c090850897d5a72420ff3446fe74440"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8c090850897d5a72420ff3446fe74440">destroy_subscriptions</a></div><div class="ttdeci">static void destroy_subscriptions(struct ast_sip_subscription *root)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01215">res_pjsip_pubsub.c:1215</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#ac23e23ba60f358de78a893d537c0afa4">sip_subscription_tree::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00435">res_pjsip_pubsub.c:435</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91e1ece55fdcfb0290b5cac07b1d463a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91e1ece55fdcfb0290b5cac07b1d463a">&#9670;&nbsp;</a></span>subscription_unreference_dialog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int subscription_unreference_dialog </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01348">1348</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">sip_subscription_tree::dlg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">subscription_tree_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;{</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a> *sub_tree = obj;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   <span class="comment">/* This is why we keep the dialog on the subscription. When the subscription</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">    * is destroyed, there is no guarantee that the underlying dialog is ready</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">    * to be destroyed. Furthermore, there&#39;s no guarantee in the opposite direction</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">    * either. The dialog could be destroyed before our subscription is. We fix</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">    * this problem by keeping a reference to the dialog until it is time to</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">    * destroy the subscription. We need to have the dialog available when the</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">    * subscription is destroyed so that we can guarantee that our attempt to</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">    * remove the serializer will be successful.</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;   pjsip_dlg_dec_session(sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>, &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>);</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   sub_tree-&gt;<a class="code" href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html#a9d867cb404dff4c9d88a624e78a0e4d0">sip_subscription_tree::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00443">res_pjsip_pubsub.c:443</a></div></div>
<div class="ttc" id="structsip__subscription__tree_html"><div class="ttname"><a href="../../d0/dd7/structsip__subscription__tree.html">sip_subscription_tree</a></div><div class="ttdoc">A tree of SIP subscriptions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00431">res_pjsip_pubsub.c:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2353e3034a3cbd98dcc94740a7d5f8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2353e3034a3cbd98dcc94740a7d5f8c1">&#9670;&nbsp;</a></span>test_new_subscribe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_new_subscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>new_subscribe callback for unit tests </p>
<p>Will give a 200 OK response to any resource except the "bad" ones. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04901">4901</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04889">bad_resources</a>.</p>
<div class="fragment"><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;{</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a83aef050497f83116afc025b7acf19e3">bad_resources</a>); ++i) {</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">if</span> (!strcmp(resource, <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a83aef050497f83116afc025b7acf19e3">bad_resources</a>[i])) {</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;         <span class="keywordflow">return</span> 400;</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      }</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;   }</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;   <span class="keywordflow">return</span> 200;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a83aef050497f83116afc025b7acf19e3"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a83aef050497f83116afc025b7acf19e3">bad_resources</a></div><div class="ttdeci">const char * bad_resources[]</div><div class="ttdoc">&quot;bad&quot; resources </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04889">res_pjsip_pubsub.c:4889</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd2ddc65db04f4a50bb9fe68a197b167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd2ddc65db04f4a50bb9fe68a197b167">&#9670;&nbsp;</a></span>test_resource_tree_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_resource_tree_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d6a/structresource__tree.html">resource_tree</a> *&#160;</td>
          <td class="paramname"><em>tree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RAII_VAR callback to destroy an allocated resource tree. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05047">5047</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">resource_tree_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05078">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;{</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;   <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a>(tree);</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tree);</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_aca2de2a2c7ba7a0a16d4632b56af96fa"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aca2de2a2c7ba7a0a16d4632b56af96fa">resource_tree_destroy</a></div><div class="ttdeci">static void resource_tree_destroy(struct resource_tree *tree)</div><div class="ttdoc">Destroy a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">res_pjsip_pubsub.c:1109</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adba83183b8ab9dfd5b4ce87ddafc78a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba83183b8ab9dfd5b4ce87ddafc78a1">&#9670;&nbsp;</a></span>tree_node_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a>* tree_node_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct resources *&#160;</td>
          <td class="paramname"><em>visited</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>full_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate a tree node. </p>
<p>In addition to allocating and initializing the tree node, the node is also added to the vector of visited resources. See <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c.html#a3707d69a8c25755d9fbe3f4d2ed80477">build_resource_tree</a> for more information on the visited resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>The name of the resource for this tree node. </td></tr>
    <tr><td class="paramname">visited</td><td>The vector of resources that have been visited. </td></tr>
    <tr><td class="paramname">if</td><td>allocating a list, indicate whether full state is requested in notifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Allocation failure. </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The newly-allocated <a class="el" href="../../d6/d14/structtree__node.html" title="A node for a resource tree. ">tree_node</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00934">934</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00332">resource_list::full_state</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">build_node_children()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01135">build_resource_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;{</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d14/structtree__node.html">tree_node</a> *<a class="code" href="../../d5/da1/structnode.html">node</a>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   node = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*node) + strlen(resource) + 1);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <span class="keywordflow">if</span> (!node) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   strcpy(node-&gt;resource, resource);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;node-&gt;children, 4)) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(node);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   node-&gt;full_state = full_state;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="keywordflow">if</span> (visited) {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(visited, resource);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordflow">return</span> node;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div><div class="ttc" id="structnode_html"><div class="ttname"><a href="../../d5/da1/structnode.html">node</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2b/test__heap_8c_source.html#l00038">test_heap.c:38</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structtree__node_html"><div class="ttname"><a href="../../d6/d14/structtree__node.html">tree_node</a></div><div class="ttdoc">A node for a resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00888">res_pjsip_pubsub.c:888</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab8324717cc2207dbde31f177aa7ac0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab8324717cc2207dbde31f177aa7ac0f">&#9670;&nbsp;</a></span>tree_node_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tree_node_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d14/structtree__node.html">tree_node</a> *&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for a tree node. </p>
<p>This function calls recursively in order to destroy all nodes lower in the tree from the given node in addition to the node itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The node to destroy. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">965</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01021">build_node_children()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01109">resource_tree_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;{</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="keywordflow">if</span> (!node) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;node-&gt;children); ++i) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;node-&gt;children, i));</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;node-&gt;children);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(node);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_aab8324717cc2207dbde31f177aa7ac0f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#aab8324717cc2207dbde31f177aa7ac0f">tree_node_destroy</a></div><div class="ttdeci">static void tree_node_destroy(struct tree_node *node)</div><div class="ttdoc">Destructor for a tree node. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00965">res_pjsip_pubsub.c:965</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">5682</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04135">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04136">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00030">ast_cli_unregister_multiple()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l07258">ast_manager_unregister()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00316">AST_MODFLAG_GLOBAL_SYMBOLS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00326">AST_MODPRI_CHANNEL_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00269">ast_sched_context_destroy()</a>, <a class="el" href="../../d1/d94/pjsip__transport__events_8c_source.html#l00257">ast_sip_transport_monitor_unregister_all()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">pubsub_module</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">sub_tree_transport_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;{</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(<a class="code" href="../../d9/d6a/structresource__tree.html">resource_tree</a>);</div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(complex_resource_tree);</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(bad_resource);</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(bad_branch);</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(duplicate_resource);</div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(loop);</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(bad_event);</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7e419c29ebfb010ca04b7c189c207bbd">ast_sip_transport_monitor_unregister_all</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a>));</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a75e6251ec7546725dcb5cc72bf6b60ce">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a>);</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a703b9f7d4c89444b70c00353c864765c">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a>);</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;PJSIPShowResourceLists&quot;</span>);</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a>);</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/da0/structsched.html">sched</a>) {</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(<a class="code" href="../../d0/da0/structsched.html">sched</a>);</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;   }</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a75e6251ec7546725dcb5cc72bf6b60ce"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a75e6251ec7546725dcb5cc72bf6b60ce">AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</a></div><div class="ttdeci">#define AMI_SHOW_SUBSCRIPTIONS_OUTBOUND</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04136">res_pjsip_pubsub.c:4136</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a7f71e2a3aca3dcf8077d9c7edcb34325"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a7f71e2a3aca3dcf8077d9c7edcb34325">pubsub_module</a></div><div class="ttdeci">static struct pjsip_module pubsub_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">res_pjsip_pubsub.c:229</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a1959d38582b0da24d4d42766cf13ade8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a1959d38582b0da24d4d42766cf13ade8">cli_commands</a></div><div class="ttdeci">static struct ast_cli_entry cli_commands[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04667">res_pjsip_pubsub.c:4667</a></div></div>
<div class="ttc" id="structresource__tree_html"><div class="ttname"><a href="../../d9/d6a/structresource__tree.html">resource_tree</a></div><div class="ttdoc">A resource tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01095">res_pjsip_pubsub.c:1095</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_abf46a87a277bf64c6230f9f2237906f8"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#abf46a87a277bf64c6230f9f2237906f8">sub_tree_transport_cb</a></div><div class="ttdeci">static void sub_tree_transport_cb(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">res_pjsip_pubsub.c:603</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_a703b9f7d4c89444b70c00353c864765c"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a703b9f7d4c89444b70c00353c864765c">AMI_SHOW_SUBSCRIPTIONS_INBOUND</a></div><div class="ttdeci">#define AMI_SHOW_SUBSCRIPTIONS_INBOUND</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04135">res_pjsip_pubsub.c:4135</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a15aa09d9084763cdd20b7467a4cd381a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a></div><div class="ttdeci">void ast_sip_unregister_service(pjsip_module *module)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03331">res_pjsip.c:3331</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7e419c29ebfb010ca04b7c189c207bbd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7e419c29ebfb010ca04b7c189c207bbd">ast_sip_transport_monitor_unregister_all</a></div><div class="ttdeci">void ast_sip_transport_monitor_unregister_all(ast_transport_monitor_shutdown_cb cb, void *data, ast_transport_monitor_data_matcher matches)</div><div class="ttdoc">Unregister a transport shutdown monitor from all reliable transports. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00257">pjsip_transport_events.c:257</a></div></div>
<div class="ttc" id="sched_8h_html_a862f869d056628b38e09042f21b54413"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a></div><div class="ttdeci">void ast_sched_context_destroy(struct ast_sched_context *c)</div><div class="ttdoc">destroys a schedule context </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00269">sched.c:269</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP <a class="el" href="../../df/d7d/structevent.html">event</a> resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND, .requires = &quot;res_pjsip&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05714">5714</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="af83103f48a2651972c0fc351bfd701bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83103f48a2651972c0fc351bfd701bb">&#9670;&nbsp;</a></span>accept_exceptions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* accept_exceptions[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {</div><div class="line">   <span class="stringliteral">&quot;multipart/related&quot;</span>,</div><div class="line">   <span class="stringliteral">&quot;application/rlmi+xml&quot;</span>,</div><div class="line">}</div></div><!-- fragment -->
<p>Accept headers that are exceptions to the rule. </p>
<p>Typically, when a SUBSCRIBE arrives, we attempt to find a body generator that matches one of the Accept headers in the request. When subscribing to a single resource, this works great. However, when subscribing to a list, things work differently. Most Accept header values are fine, but there are a couple that are endemic to resource lists that need to be ignored when searching for a body generator to use for the individual resources of the subscription. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00806">806</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00817">exceptional_accept()</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05714">5714</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="a83aef050497f83116afc025b7acf19e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83aef050497f83116afc025b7acf19e3">&#9670;&nbsp;</a></span>bad_resources</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* bad_resources[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"bad" resources </p>
<p>These are resources that the test handler will reject subscriptions to. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04889">4889</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04901">test_new_subscribe()</a>.</p>

</div>
</div>
<a id="a158e31d31a846c1902563332f8ecb64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a158e31d31a846c1902563332f8ecb64d">&#9670;&nbsp;</a></span>body_generators</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/de0/structbody__generators.html">body_generators</a>   <a class="el" href="../../dd/de0/structbody__generators.html">body_generators</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af25de5dc4e2dde9c20c8a352172b10f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25de5dc4e2dde9c20c8a352172b10f0">&#9670;&nbsp;</a></span>body_supplements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/d90/structbody__supplements.html">body_supplements</a>   <a class="el" href="../../d5/d90/structbody__supplements.html">body_supplements</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1959d38582b0da24d4d42766cf13ade8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1959d38582b0da24d4d42766cf13ade8">&#9670;&nbsp;</a></span>cli_commands</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> cli_commands[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   { .handler =  <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a636cc42bbb2d876178e506f54bf1d05f">cli_list_subscriptions_inout</a> , .summary =  <span class="stringliteral">&quot;List active inbound/outbound subscriptions&quot;</span> ,},</div><div class="line">   { .handler =  <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8a440b205b153f5b7fa6e0be3eb82ef">cli_show_subscription_inout</a> , .summary =  <span class="stringliteral">&quot;Show active subscription details&quot;</span> ,},</div><div class="line">   { .handler =  <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#ad1bd467902006e27be217191f4f6c793">cli_show_subscriptions_inout</a> , .summary =  <span class="stringliteral">&quot;Show active inbound/outbound subscriptions&quot;</span> ,},</div><div class="line">}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a636cc42bbb2d876178e506f54bf1d05f"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a636cc42bbb2d876178e506f54bf1d05f">cli_list_subscriptions_inout</a></div><div class="ttdeci">static char * cli_list_subscriptions_inout(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04580">res_pjsip_pubsub.c:4580</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad1bd467902006e27be217191f4f6c793"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad1bd467902006e27be217191f4f6c793">cli_show_subscriptions_inout</a></div><div class="ttdeci">static char * cli_show_subscriptions_inout(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04433">res_pjsip_pubsub.c:4433</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8c_html_ad8a440b205b153f5b7fa6e0be3eb82ef"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#ad8a440b205b153f5b7fa6e0be3eb82ef">cli_show_subscription_inout</a></div><div class="ttdeci">static char * cli_show_subscription_inout(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04334">res_pjsip_pubsub.c:4334</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04667">4667</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="a47e7031430a4ba4c21aac39b482ffd82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47e7031430a4ba4c21aac39b482ffd82">&#9670;&nbsp;</a></span>esc_etag_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int esc_etag_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used to create new entity IDs by ESCs. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00340">340</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03145">sip_create_publication()</a>.</p>

</div>
</div>
<a id="ad7c1f2dfc743e57aadd39d0be4b97e97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c1f2dfc743e57aadd39d0be4b97e97">&#9670;&nbsp;</a></span>pjsip_publish_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const pjsip_method pjsip_publish_method</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">   PJSIP_OTHER_METHOD,</div><div class="line">   { <span class="stringliteral">&quot;PUBLISH&quot;</span>, 7 }</div><div class="line">}</div></div><!-- fragment -->
<p>Defined method for PUBLISH. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00256">256</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">pubsub_on_rx_request()</a>.</p>

</div>
</div>
<a id="ad3e97ffc390b7710e0c89d5816fb65a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e97ffc390b7710e0c89d5816fb65a0">&#9670;&nbsp;</a></span>publish_handlers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a>   <a class="el" href="../../df/d3c/structpublish__handlers.html">publish_handlers</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d62301cf52b6bc6d7b66cea60bee8cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d62301cf52b6bc6d7b66cea60bee8cc">&#9670;&nbsp;</a></span>pubsub_cb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_evsub_user pubsub_cb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00549">549</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01868">ast_sip_create_subscription()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>.</p>

</div>
</div>
<a id="a7f71e2a3aca3dcf8077d9c7edcb34325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f71e2a3aca3dcf8077d9c7edcb34325">&#9670;&nbsp;</a></span>pubsub_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct pjsip_module pubsub_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .name = { <span class="stringliteral">&quot;PubSub Module&quot;</span>, 13 },</div><div class="line">   .priority = PJSIP_MOD_PRIORITY_APPLICATION,</div><div class="line">   .on_rx_request = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a8deba4f5b210a282252f719b1a245029">pubsub_on_rx_request</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a8deba4f5b210a282252f719b1a245029"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a8deba4f5b210a282252f719b1a245029">pubsub_on_rx_request</a></div><div class="ttdeci">static pj_bool_t pubsub_on_rx_request(pjsip_rx_data *rdata)</div><div class="ttdoc">Opaque structure representing an RFC 3265 SIP subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03707">res_pjsip_pubsub.c:3707</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00229">229</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03440">ast_sip_pubsub_register_body_generator()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02777">ast_sip_register_subscription_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01854">ast_sip_subscription_get_header()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01465">create_subscription_tree()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03989">pubsub_on_client_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03956">pubsub_on_rx_notify()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04002">pubsub_on_server_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03179">sip_publication_respond()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02606">sip_subscription_accept()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">subscription_setup_dialog()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01348">subscription_unreference_dialog()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05682">unload_module()</a>.</p>

</div>
</div>
<a id="ae55303c463ee7d4709335ae3311c3826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae55303c463ee7d4709335ae3311c3826">&#9670;&nbsp;</a></span>rlmi_media_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_media_type rlmi_media_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00539">539</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02162">build_rlmi_body()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l05560">load_module()</a>.</p>

</div>
</div>
<a id="a361b448e9abcfc301602a2573a662d3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a361b448e9abcfc301602a2573a662d3c">&#9670;&nbsp;</a></span>sched</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a>* <a class="el" href="../../d0/da0/structsched.html">sched</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scheduler used for automatically expiring publications. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00241">241</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="af59dad57f47cf8401042d4ecd0b861e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59dad57f47cf8401042d4ecd0b861e5">&#9670;&nbsp;</a></span>sip_subscription_roles_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* sip_subscription_roles_map[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   [<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a>] = <span class="stringliteral">&quot;Subscriber&quot;</span>,</div><div class="line">   [<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a>] = <span class="stringliteral">&quot;Notifier&quot;</span></div><div class="line">}</div><div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20a3c10d5621e8e7278503d4ea4c13cedc1">AST_SIP_SUBSCRIBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00192">res_pjsip_pubsub.h:192</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a9b75abdc267ce4a677b7eaa67ead3c20ab72ff83a6adb7eae0bf918c8e3f5cf49">AST_SIP_NOTIFIER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00194">res_pjsip_pubsub.h:194</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00518">518</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01820">sip_subscription_to_ami()</a>.</p>

</div>
</div>
<a id="a4abffbee599d833b446686d5213d80e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4abffbee599d833b446686d5213d80e4">&#9670;&nbsp;</a></span>str_event_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const pj_str_t str_event_name = { &quot;Event&quot;, 5 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00238">238</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00771">subscription_get_handler_from_rdata()</a>.</p>

</div>
</div>
<a id="a6ba01bbffb64da676cd5176bb1d918b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba01bbffb64da676cd5176bb1d918b9">&#9670;&nbsp;</a></span>sub_tree_state_description</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* sub_tree_state_description[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00415">415</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03859">pubsub_on_refresh_timeout()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03889">serialized_pubsub_on_refresh_timeout()</a>.</p>

</div>
</div>
<a id="aabdcafbd71c14ff0214432de08b762f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabdcafbd71c14ff0214432de08b762f2">&#9670;&nbsp;</a></span>subscription_handlers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a>   <a class="el" href="../../d2/d1b/structsubscription__handlers.html">subscription_handlers</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaa999be067508220af90f555956ae7ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa999be067508220af90f555956ae7ff">&#9670;&nbsp;</a></span>subscriptions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/dab/structsubscriptions.html">subscriptions</a>   <a class="el" href="../../df/dab/structsubscriptions.html">subscriptions</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a99619cb1fc467541615fc8d043d39643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99619cb1fc467541615fc8d043d39643">&#9670;&nbsp;</a></span>test_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d6c/structast__sip__subscription__handler.html">ast_sip_subscription_handler</a> test_handler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .event_name = <span class="stringliteral">&quot;test&quot;</span>,</div><div class="line">   .notifier = &amp;<a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a10ec9e1a5bbe250daa4df389a6127b83">test_notifier</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a10ec9e1a5bbe250daa4df389a6127b83"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a10ec9e1a5bbe250daa4df389a6127b83">test_notifier</a></div><div class="ttdeci">struct ast_sip_notifier test_notifier</div><div class="ttdoc">Subscription notifier for unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04920">res_pjsip_pubsub.c:4920</a></div></div>
</div><!-- fragment -->
<p>Subscription handler for unit tests. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04927">4927</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
<a id="a10ec9e1a5bbe250daa4df389a6127b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ec9e1a5bbe250daa4df389a6127b83">&#9670;&nbsp;</a></span>test_notifier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/d5b/structast__sip__notifier.html">ast_sip_notifier</a> test_notifier</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .new_subscribe = <a class="code" href="../../d8/dca/res__pjsip__pubsub_8c.html#a2353e3034a3cbd98dcc94740a7d5f8c1">test_new_subscribe</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__pubsub_8c_html_a2353e3034a3cbd98dcc94740a7d5f8c1"><div class="ttname"><a href="../../d8/dca/res__pjsip__pubsub_8c.html#a2353e3034a3cbd98dcc94740a7d5f8c1">test_new_subscribe</a></div><div class="ttdeci">static int test_new_subscribe(struct ast_sip_endpoint *endpoint, const char *resource)</div><div class="ttdoc">new_subscribe callback for unit tests </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04901">res_pjsip_pubsub.c:4901</a></div></div>
</div><!-- fragment -->
<p>Subscription notifier for unit tests. </p>
<p>Since unit tests are only concerned with building a resource tree, only the new_subscribe callback needs to be defined. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04920">4920</a> of file <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html">res_pjsip_pubsub.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:33 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
