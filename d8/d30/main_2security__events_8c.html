<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: security_events.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main/security_events.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Security Event Reporting Helpers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d90/strings_8h_source.html">asterisk/strings.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">asterisk/network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d20/event_8h_source.html">asterisk/event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html">asterisk/security_events.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/df1/netsock2_8h_source.html">asterisk/netsock2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d79/stasis_8h_source.html">asterisk/stasis.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d05/json_8h_source.html">asterisk/json.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main/security_events.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/df0/main_2security__events_8c__incl.png" border="0" usemap="#security__events_8c" alt=""/></div>
<map name="security__events_8c" id="security__events_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="415,319,499,345"/>
<area shape="rect" id="node22" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1810,162,1925,189"/>
<area shape="rect" id="node23" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="2430,244,2569,271"/>
<area shape="rect" id="node39" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1437,244,1567,271"/>
<area shape="rect" id="node42" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1237,319,1372,345"/>
<area shape="rect" id="node43" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="2936,162,3060,189"/>
<area shape="rect" id="node45" href="../../d0/d29/include_2asterisk_2security__events_8h.html" title="Security Event Reporting API. " alt="" coords="2729,80,2917,107"/>
<area shape="rect" id="node47" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="3078,244,3225,271"/>
<area shape="rect" id="node48" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="2437,80,2562,107"/>
<area shape="rect" id="node49" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="2597,162,2711,189"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="814,543,969,569"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="851,393,988,420"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="5,393,140,420"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="818,617,965,644"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1417,468,1560,495"/>
<area shape="rect" id="node33" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1780,468,1843,495"/>
<area shape="rect" id="node35" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1747,393,1860,420"/>
<area shape="rect" id="node36" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="2068,468,2195,495"/>
<area shape="rect" id="node37" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1794,244,1941,271"/>
<area shape="rect" id="node38" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1937,393,2094,420"/>
<area shape="rect" id="node34" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1807,543,1954,569"/>
<area shape="rect" id="node41" href="../../dc/d7d/threadstorage_8h.html" title="Definitions to aid in the use of thread local storage. " alt="" coords="1810,319,1989,345"/>
<area shape="rect" id="node44" href="../../d6/d37/event__defs_8h.html" title="Generic event system. " alt="" coords="3249,244,3408,271"/>
<area shape="rect" id="node46" href="../../d7/dc2/security__events__defs_8h.html" title="Security Event Reporting Data Structures. " alt="" coords="2735,155,2911,196"/>
<area shape="rect" id="node50" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="2427,162,2572,189"/>
</map>
</div>
</div>
<p><a href="../../d8/d30/main_2security__events_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abb3526605166ab5a381901b534dc38f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#abb3526605166ab5a381901b534dc38f8">MAX_SECURITY_IES</a>&#160;&#160;&#160;12</td></tr>
<tr class="separator:abb3526605166ab5a381901b534dc38f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c3785547ffc72e1f78bb57299d9b72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a08c3785547ffc72e1f78bb57299d9b72">SEC_EVT_FIELD</a>(e,  field)&#160;&#160;&#160;(offsetof(struct ast_security_event_##e, field))</td></tr>
<tr class="separator:a08c3785547ffc72e1f78bb57299d9b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a52b7fae0b3110ff01e35a94fd3d2fd6c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6c">ie_required</a> { <a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a>, 
<a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a>, 
<a class="el" href="../../dd/d1e/res__security__log_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a>, 
<a class="el" href="../../dd/d1e/res__security__log_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a>
 }</td></tr>
<tr class="separator:a52b7fae0b3110ff01e35a94fd3d2fd6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae85091221f96a8c86952e8b74450724d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#ae85091221f96a8c86952e8b74450724d">add_ip_json_object</a> (struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json, enum <a class="el" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, const struct <a class="el" href="../../dd/dd8/structast__security__event__ip__addr.html">ast_security_event_ip_addr</a> *addr)</td></tr>
<tr class="separator:ae85091221f96a8c86952e8b74450724d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c55ca94e326b3bf5477d19497bccc9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#ad8c55ca94e326b3bf5477d19497bccc9">add_json_object</a> (struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json, const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *sec, const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *ie_type, enum <a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6c">ie_required</a> req)</td></tr>
<tr class="separator:ad8c55ca94e326b3bf5477d19497bccc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a301b8bb03b4e043ca137886b09a66d91"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a301b8bb03b4e043ca137886b09a66d91">alloc_security_event_json_object</a> (const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *sec)</td></tr>
<tr class="separator:a301b8bb03b4e043ca137886b09a66d91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d9cdbb9e331268fa885f20d78da95c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#aa8d9cdbb9e331268fa885f20d78da95c">append_event_str_from_json</a> (struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json, const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *ies)</td></tr>
<tr class="separator:aa8d9cdbb9e331268fa885f20d78da95c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacaf83011baee7b46b05bb4df8636c6d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#aacaf83011baee7b46b05bb4df8636c6d">append_event_str_single</a> (struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json, const enum <a class="el" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr class="separator:aacaf83011baee7b46b05bb4df8636c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of a security event sub-type.  <a href="#ab3449f999d03b45fc61e5f59f3cb40cb">More...</a><br /></td></tr>
<tr class="separator:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bea01160811d84a487584cd400f27c3"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:a0bea01160811d84a487584cd400f27c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of optional IEs for a given security event sub-type.  <a href="#a0bea01160811d84a487584cd400f27c3">More...</a><br /></td></tr>
<tr class="separator:a0bea01160811d84a487584cd400f27c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7b4c2b7d86562bf6204c636bed9d53"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:afd7b4c2b7d86562bf6204c636bed9d53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of required IEs for a given security event sub-type.  <a href="#afd7b4c2b7d86562bf6204c636bed9d53">More...</a><br /></td></tr>
<tr class="separator:afd7b4c2b7d86562bf6204c636bed9d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13dc3d123710d7519588d54c51f8170"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a> (const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *sec)</td></tr>
<tr class="memdesc:ae13dc3d123710d7519588d54c51f8170"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report a security event.  <a href="#ae13dc3d123710d7519588d54c51f8170">More...</a><br /></td></tr>
<tr class="separator:ae13dc3d123710d7519588d54c51f8170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a947bbf6fbc82e52e2a5f9231dcd786d9">ast_security_event_severity_get_name</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a> <a class="el" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a>)</td></tr>
<tr class="memdesc:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of a security event severity.  <a href="#a947bbf6fbc82e52e2a5f9231dcd786d9">More...</a><br /></td></tr>
<tr class="separator:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a2bfccbad0896b673d8eb936aa3c2caeb">ast_security_stasis_init</a> (void)</td></tr>
<tr class="memdesc:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes stasis topic/event types for <a class="el" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> and <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a88d718027e6e4abe11dcfe17bd267377">ast_security_event_type</a>  <a href="#a2bfccbad0896b673d8eb936aa3c2caeb">More...</a><br /></td></tr>
<tr class="separator:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db46f92449a8f63b954d776ebead63a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> (void)</td></tr>
<tr class="memdesc:a0db46f92449a8f63b954d776ebead63a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> which publishes messages for security related issues.  <a href="#a0db46f92449a8f63b954d776ebead63a">More...</a><br /></td></tr>
<tr class="separator:a0db46f92449a8f63b954d776ebead63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba1021cb8a3d9192cc1c43bf3cad5b7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="separator:a5ba1021cb8a3d9192cc1c43bf3cad5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af34b009cd52c662e28242426ec40a5da"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#af34b009cd52c662e28242426ec40a5da">handle_security_event</a> (const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *sec)</td></tr>
<tr class="separator:af34b009cd52c662e28242426ec40a5da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7acb37fa240fe2698e918017cfd3f385"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a7acb37fa240fe2698e918017cfd3f385">security_event_to_ami</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="separator:a7acb37fa240fe2698e918017cfd3f385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b79361f271d2cf30aa20efd91a50d53"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a1b79361f271d2cf30aa20efd91a50d53">security_event_to_ami_blob</a> (struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json)</td></tr>
<tr class="separator:a1b79361f271d2cf30aa20efd91a50d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b87e2db58f030de91b0ab1beea6a23"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a90b87e2db58f030de91b0ab1beea6a23">security_stasis_cleanup</a> (void)</td></tr>
<tr class="separator:a90b87e2db58f030de91b0ab1beea6a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1760a739d331792e5163abde85772d06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a1760a739d331792e5163abde85772d06">STASIS_MESSAGE_TYPE_DEFN</a> (<a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>,.<a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a>=<a class="el" href="../../d8/d30/main_2security__events_8c.html#a7acb37fa240fe2698e918017cfd3f385">security_event_to_ami</a>,)</td></tr>
<tr class="memdesc:a1760a739d331792e5163abde85772d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message type for security events.  <a href="#a1760a739d331792e5163abde85772d06">More...</a><br /></td></tr>
<tr class="separator:a1760a739d331792e5163abde85772d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a63a523f56955f20e85d90620dee621ca"><td class="memItemLeft" >struct {</td></tr>
<tr class="memitem:a8f8f80d37794cde9472343e4487ba3eb"><td class="memItemLeft" >&#160;&#160;&#160;const char *&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td></tr>
<tr class="separator:a8f8f80d37794cde9472343e4487ba3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4020d314f5654c6a3a5e49625b2ec1d2"><td class="memItemLeft" >&#160;&#160;&#160;struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#a4020d314f5654c6a3a5e49625b2ec1d2">optional_ies</a> [<a class="el" href="../../d8/d30/main_2security__events_8c.html#abb3526605166ab5a381901b534dc38f8">MAX_SECURITY_IES</a>]</td></tr>
<tr class="separator:a4020d314f5654c6a3a5e49625b2ec1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b076a042fb67f22773af4a58440dad"><td class="memItemLeft" >&#160;&#160;&#160;struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#a51b076a042fb67f22773af4a58440dad">required_ies</a> [<a class="el" href="../../d8/d30/main_2security__events_8c.html#abb3526605166ab5a381901b534dc38f8">MAX_SECURITY_IES</a>]</td></tr>
<tr class="separator:a51b076a042fb67f22773af4a58440dad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef9a4cc441833acc08cf8ac335d305a"><td class="memItemLeft" >&#160;&#160;&#160;enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a>&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a></td></tr>
<tr class="separator:adef9a4cc441833acc08cf8ac335d305a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd99bb05ca015e7d74448acb1deba7ca"><td class="memItemLeft" >&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#acd99bb05ca015e7d74448acb1deba7ca">version</a></td></tr>
<tr class="separator:acd99bb05ca015e7d74448acb1deba7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a523f56955f20e85d90620dee621ca"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a> [<a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>]</td></tr>
<tr class="separator:a63a523f56955f20e85d90620dee621ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab711dac609fd5d81b02fd54143d9ccf3"><td class="memItemLeft" align="right" valign="top">static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#ab711dac609fd5d81b02fd54143d9ccf3">SECURITY_EVENT_BUF_INIT_LEN</a> = 256</td></tr>
<tr class="separator:ab711dac609fd5d81b02fd54143d9ccf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063b8a49db9862da0d66dd336416fc5a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></td></tr>
<tr class="memdesc:a063b8a49db9862da0d66dd336416fc5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security Topic.  <a href="#a063b8a49db9862da0d66dd336416fc5a">More...</a><br /></td></tr>
<tr class="separator:a063b8a49db9862da0d66dd336416fc5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458cfcebc5862c24cebeadf96bd292f8"><td class="memItemLeft" >struct {</td></tr>
<tr class="memitem:adef9a4cc441833acc08cf8ac335d305a"><td class="memItemLeft" >&#160;&#160;&#160;enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a>&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a></td></tr>
<tr class="separator:adef9a4cc441833acc08cf8ac335d305a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25d6dc49269fa2003ac7c7fa6f13915"><td class="memItemLeft" >&#160;&#160;&#160;const char *&#160;&#160;&#160;<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></td></tr>
<tr class="separator:af25d6dc49269fa2003ac7c7fa6f13915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458cfcebc5862c24cebeadf96bd292f8"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a> []</td></tr>
<tr class="separator:a458cfcebc5862c24cebeadf96bd292f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security Event Reporting Helpers. </p>
<dl class="section author"><dt>Author</dt><dd>Russell Bryant <a href="#" onclick="location.href='mai'+'lto:'+'rus'+'se'+'ll@'+'di'+'giu'+'m.'+'com'; return false;">russe<span style="display: none;">.nosp@m.</span>ll@d<span style="display: none;">.nosp@m.</span>igium<span style="display: none;">.nosp@m.</span>.com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abb3526605166ab5a381901b534dc38f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb3526605166ab5a381901b534dc38f8">&#9670;&nbsp;</a></span>MAX_SECURITY_IES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SECURITY_IES&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00504">504</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
<a id="a08c3785547ffc72e1f78bb57299d9b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c3785547ffc72e1f78bb57299d9b72">&#9670;&nbsp;</a></span>SEC_EVT_FIELD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_EVT_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(offsetof(struct ast_security_event_##e, field))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a52b7fae0b3110ff01e35a94fd3d2fd6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b7fae0b3110ff01e35a94fd3d2fd6c">&#9670;&nbsp;</a></span>ie_required</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6c">ie_required</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674"></a>NOT_REQUIRED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154"></a>REQUIRED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674"></a>NOT_REQUIRED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154"></a>REQUIRED&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00937">937</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                 {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   <a class="code" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a>,</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <a class="code" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;};</div><div class="ttc" id="main_2security__events_8c_html_a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00938">main/security_events.c:938</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00939">main/security_events.c:939</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae85091221f96a8c86952e8b74450724d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae85091221f96a8c86952e8b74450724d">&#9670;&nbsp;</a></span>add_ip_json_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_ip_json_object </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&#160;</td>
          <td class="paramname"><em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../dd/dd8/structast__security__event__ip__addr.html">ast_security_event_ip_addr</a> *&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00924">924</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00142">ast_security_event_ip_addr::addr</a>, <a class="el" href="../../d0/deb/event_8c_source.html#l00208">ast_event_get_ie_type_name()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00661">ast_json_ipaddr()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, and <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00143">ast_security_event_ip_addr::transport</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">add_json_object()</a>.</p>
<div class="fragment"><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;{</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_ip;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   json_ip = <a class="code" href="../../d4/d05/json_8h.html#a7e0fa22845b836887bbfe3da888bbe62">ast_json_ipaddr</a>(addr-&gt;<a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">addr</a>, addr-&gt;<a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html#a18ef8361a140053e48aea019d86ab924">transport</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   <span class="keywordflow">if</span> (!json_ip) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type), json_ip);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div><div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="structast__security__event__ip__addr_html_a18ef8361a140053e48aea019d86ab924"><div class="ttname"><a href="../../dd/dd8/structast__security__event__ip__addr.html#a18ef8361a140053e48aea019d86ab924">ast_security_event_ip_addr::transport</a></div><div class="ttdeci">enum ast_transport transport</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00143">security_events_defs.h:143</a></div></div>
<div class="ttc" id="structast__security__event__ip__addr_html_a0be0dacaa0715a9c5f0f52a5fdd9186d"><div class="ttname"><a href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">ast_security_event_ip_addr::addr</a></div><div class="ttdeci">const struct ast_sockaddr * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00142">security_events_defs.h:142</a></div></div>
<div class="ttc" id="json_8h_html_a7e0fa22845b836887bbfe3da888bbe62"><div class="ttname"><a href="../../d4/d05/json_8h.html#a7e0fa22845b836887bbfe3da888bbe62">ast_json_ipaddr</a></div><div class="ttdeci">struct ast_json * ast_json_ipaddr(const struct ast_sockaddr *addr, enum ast_transport transport_type)</div><div class="ttdoc">Construct an IP address as JSON. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00661">json.c:661</a></div></div>
<div class="ttc" id="event_8h_html_a7c877c624fbb6f9091873b4739bc5a9c"><div class="ttname"><a href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a></div><div class="ttdeci">const char * ast_event_get_ie_type_name(enum ast_event_ie_type ie_type)</div><div class="ttdoc">Get the string representation of an information element type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/deb/event_8c_source.html#l00208">event.c:208</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8c55ca94e326b3bf5477d19497bccc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c55ca94e326b3bf5477d19497bccc9">&#9670;&nbsp;</a></span>add_json_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_json_object </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td>
          <td class="paramname"><em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6c">ie_required</a>&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">942</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00924">add_ip_json_object()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00142">ast_security_event_ip_addr::addr</a>, <a class="el" href="../../d0/deb/event_8c_source.html#l00208">ast_event_get_ie_type_name()</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00277">AST_EVENT_IE_ACCOUNT_ID</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00280">AST_EVENT_IE_ACL_NAME</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00295">AST_EVENT_IE_ATTEMPTED_TRANSPORT</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00286">AST_EVENT_IE_AUTH_METHOD</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00289">AST_EVENT_IE_CHALLENGE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00283">AST_EVENT_IE_EVENT_TV</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00274">AST_EVENT_IE_EVENT_VERSION</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00288">AST_EVENT_IE_EXPECTED_ADDR</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00291">AST_EVENT_IE_EXPECTED_RESPONSE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00281">AST_EVENT_IE_LOCAL_ADDR</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00276">AST_EVENT_IE_MODULE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00292">AST_EVENT_IE_RECEIVED_CHALLENGE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00293">AST_EVENT_IE_RECEIVED_HASH</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00282">AST_EVENT_IE_REMOTE_ADDR</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00285">AST_EVENT_IE_REQUEST_PARAMS</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00284">AST_EVENT_IE_REQUEST_TYPE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00290">AST_EVENT_IE_RESPONSE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00275">AST_EVENT_IE_SERVICE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00278">AST_EVENT_IE_SESSION_ID</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00279">AST_EVENT_IE_SESSION_TV</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00287">AST_EVENT_IE_SEVERITY</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00294">AST_EVENT_IE_USING_PASSWORD</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00283">ast_json_stringf()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00649">ast_json_timeval()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">ast_security_event_ie_type::ie_type</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00056">ast_security_event_ie_type::offset</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00865">str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>.</p>
<div class="fragment"><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;{</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <span class="keywordflow">switch</span> (ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>) {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498">AST_EVENT_IE_SERVICE</a>:</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a4dfae7424b11307d9792e90c060f42f1">AST_EVENT_IE_ACCOUNT_ID</a>:</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a50ec820d053b27c971696fcb9d3cf646">AST_EVENT_IE_SESSION_ID</a>:</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a2049edac260c7783112113e0c5a62515">AST_EVENT_IE_MODULE</a>:</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a69c53dc177ad41c097bd1ddade09d763">AST_EVENT_IE_ACL_NAME</a>:</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac2b99e4afe5317742c5dd2c0f23d01b3">AST_EVENT_IE_REQUEST_TYPE</a>:</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af0c9d4d19259543bd670778105f082f6">AST_EVENT_IE_REQUEST_PARAMS</a>:</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a6a1ec83e32b4487b8b3167f4a4aaf3a5">AST_EVENT_IE_AUTH_METHOD</a>:</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5587582d3bea90a234844ac28b605fbb">AST_EVENT_IE_CHALLENGE</a>:</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ae3f994c60f834039529cd1c87419c3e3">AST_EVENT_IE_RESPONSE</a>:</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac2c0a1748c0179318c431020327ac46f">AST_EVENT_IE_EXPECTED_RESPONSE</a>:</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ab916be055ed42418abd9926e73c20def">AST_EVENT_IE_RECEIVED_CHALLENGE</a>:</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5fa032e7ac02b5e666c74858624e7364">AST_EVENT_IE_RECEIVED_HASH</a>:</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a1ba9afe3c0f0edc7f44715ffedb7ce71">AST_EVENT_IE_ATTEMPTED_TRANSPORT</a>:</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_string;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      str = *((<span class="keyword">const</span> <span class="keywordtype">char</span> **)(((<span class="keyword">const</span> <span class="keywordtype">char</span> *) sec) + ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#aadb6d6eb83e646653a1402032e45dcab">offset</a>));</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> (req &amp;&amp; !str) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Required IE &#39;%d&#39; (%s) for security event &quot;</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;               <span class="stringliteral">&quot;type &#39;%u&#39; (%s) not present\n&quot;</span>, ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>,</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;               <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>),</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;               sec-&gt;event_type, <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(sec-&gt;event_type));</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;         res = -1;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">if</span> (!str) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      json_string = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(str);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> (!json_string) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         res = -1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      res = <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>), json_string);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1">AST_EVENT_IE_EVENT_VERSION</a>:</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491acb1b4d0a7b1dd641f79ea774a6acc485">AST_EVENT_IE_USING_PASSWORD</a>:</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_string;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      uint32_t <a class="code" href="../../d5/d85/structval.html">val</a>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      val = *((<span class="keyword">const</span> uint32_t *)(((<span class="keyword">const</span> <span class="keywordtype">char</span> *) sec) + ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#aadb6d6eb83e646653a1402032e45dcab">offset</a>));</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      json_string = <a class="code" href="../../d4/d05/json_8h.html#a7070193de404a995e829dd75e7b4460f">ast_json_stringf</a>(<span class="stringliteral">&quot;%u&quot;</span>, val);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">if</span> (!json_string) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;         res = -1;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      res = <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>), json_string);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5e8c5b9dc6ba68e04fed59b87b6a473e">AST_EVENT_IE_LOCAL_ADDR</a>:</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a15cb4d1b1764d003fdf0337ac5872be2">AST_EVENT_IE_REMOTE_ADDR</a>:</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac7cb1a81d6018d64f8c549813127b0e0">AST_EVENT_IE_EXPECTED_ADDR</a>:</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html">ast_security_event_ip_addr</a> *<a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">addr</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      addr = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html">ast_security_event_ip_addr</a> *)(((<span class="keyword">const</span> <span class="keywordtype">char</span> *) sec) + ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#aadb6d6eb83e646653a1402032e45dcab">offset</a>);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">if</span> (req &amp;&amp; !addr-&gt;<a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">addr</a>) {</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Required IE &#39;%d&#39; (%s) for security event &quot;</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;               <span class="stringliteral">&quot;type &#39;%u&#39; (%s) not present\n&quot;</span>, ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;               <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>),</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;               sec-&gt;event_type, <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(sec-&gt;event_type));</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;         res = -1;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">addr</a>) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;         res = <a class="code" href="../../d8/d30/main_2security__events_8c.html#ae85091221f96a8c86952e8b74450724d">add_ip_json_object</a>(json, ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, addr);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aebc9405e9209aa7610b93b95158801fa">AST_EVENT_IE_SESSION_TV</a>:</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span>timeval *tval;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      tval = *((<span class="keyword">const</span> <span class="keyword">struct </span>timeval **)(((<span class="keyword">const</span> <span class="keywordtype">char</span> *) sec) + ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#aadb6d6eb83e646653a1402032e45dcab">offset</a>));</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordflow">if</span> (req &amp;&amp; !tval) {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Required IE &#39;%d&#39; (%s) for security event &quot;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;               <span class="stringliteral">&quot;type &#39;%u&#39; (%s) not present\n&quot;</span>, ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>,</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;               <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>),</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;               sec-&gt;event_type, <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(sec-&gt;event_type));</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         res = -1;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="keywordflow">if</span> (tval) {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_tval = <a class="code" href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a>(*tval, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;         <span class="keywordflow">if</span> (!json_tval) {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            res = -1;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;         }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         res = <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>), json_tval);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c">AST_EVENT_IE_EVENT_TV</a>:</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87">AST_EVENT_IE_SEVERITY</a>:</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">/* Added automatically, nothing to do here. */</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unhandled IE type &#39;%d&#39; (%s), this security event &quot;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="stringliteral">&quot;will be missing data.\n&quot;</span>, ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>,</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type-&gt;<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>));</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div><div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491aebc9405e9209aa7610b93b95158801fa"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aebc9405e9209aa7610b93b95158801fa">AST_EVENT_IE_SESSION_TV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00279">event_defs.h:279</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a50ec820d053b27c971696fcb9d3cf646"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a50ec820d053b27c971696fcb9d3cf646">AST_EVENT_IE_SESSION_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00278">event_defs.h:278</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a5fa032e7ac02b5e666c74858624e7364"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5fa032e7ac02b5e666c74858624e7364">AST_EVENT_IE_RECEIVED_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00293">event_defs.h:293</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498">AST_EVENT_IE_SERVICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00275">event_defs.h:275</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ae85091221f96a8c86952e8b74450724d"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ae85091221f96a8c86952e8b74450724d">add_ip_json_object</a></div><div class="ttdeci">static int add_ip_json_object(struct ast_json *json, enum ast_event_ie_type ie_type, const struct ast_security_event_ip_addr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00924">main/security_events.c:924</a></div></div>
<div class="ttc" id="structval_html"><div class="ttname"><a href="../../d5/d85/structval.html">val</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dd1/ast__expr2_8c_source.html#l00325">ast_expr2.c:325</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a1ba9afe3c0f0edc7f44715ffedb7ce71"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a1ba9afe3c0f0edc7f44715ffedb7ce71">AST_EVENT_IE_ATTEMPTED_TRANSPORT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00295">event_defs.h:295</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a5587582d3bea90a234844ac28b605fbb"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5587582d3bea90a234844ac28b605fbb">AST_EVENT_IE_CHALLENGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00289">event_defs.h:289</a></div></div>
<div class="ttc" id="json_8h_html_a7070193de404a995e829dd75e7b4460f"><div class="ttname"><a href="../../d4/d05/json_8h.html#a7070193de404a995e829dd75e7b4460f">ast_json_stringf</a></div><div class="ttdeci">struct ast_json * ast_json_stringf(const char *format,...)</div><div class="ttdoc">Create a JSON string, printf style. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00283">json.c:283</a></div></div>
<div class="ttc" id="structast__security__event__ie__type_html_aadb6d6eb83e646653a1402032e45dcab"><div class="ttname"><a href="../../d4/d1e/structast__security__event__ie__type.html#aadb6d6eb83e646653a1402032e45dcab">ast_security_event_ie_type::offset</a></div><div class="ttdeci">size_t offset</div><div class="ttdoc">For internal usage. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00056">include/asterisk/security_events.h:56</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a4dfae7424b11307d9792e90c060f42f1"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a4dfae7424b11307d9792e90c060f42f1">AST_EVENT_IE_ACCOUNT_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00277">event_defs.h:277</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1">AST_EVENT_IE_EVENT_VERSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00274">event_defs.h:274</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491ac7cb1a81d6018d64f8c549813127b0e0"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac7cb1a81d6018d64f8c549813127b0e0">AST_EVENT_IE_EXPECTED_ADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00288">event_defs.h:288</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a5e8c5b9dc6ba68e04fed59b87b6a473e"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a5e8c5b9dc6ba68e04fed59b87b6a473e">AST_EVENT_IE_LOCAL_ADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00281">event_defs.h:281</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a15cb4d1b1764d003fdf0337ac5872be2"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a15cb4d1b1764d003fdf0337ac5872be2">AST_EVENT_IE_REMOTE_ADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00282">event_defs.h:282</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491ab916be055ed42418abd9926e73c20def"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ab916be055ed42418abd9926e73c20def">AST_EVENT_IE_RECEIVED_CHALLENGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00292">event_defs.h:292</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a69c53dc177ad41c097bd1ddade09d763"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a69c53dc177ad41c097bd1ddade09d763">AST_EVENT_IE_ACL_NAME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00280">event_defs.h:280</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00865">main/security_events.c:865</a></div></div>
<div class="ttc" id="structast__security__event__ip__addr_html_a0be0dacaa0715a9c5f0f52a5fdd9186d"><div class="ttname"><a href="../../dd/dd8/structast__security__event__ip__addr.html#a0be0dacaa0715a9c5f0f52a5fdd9186d">ast_security_event_ip_addr::addr</a></div><div class="ttdeci">const struct ast_sockaddr * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00142">security_events_defs.h:142</a></div></div>
<div class="ttc" id="json_8h_html_a2b7c72e2e3ab2634d8a4f8b708440d95"><div class="ttname"><a href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a></div><div class="ttdeci">struct ast_json * ast_json_timeval(const struct timeval tv, const char *zone)</div><div class="ttdoc">Construct a timeval as JSON. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00649">json.c:649</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491ae3f994c60f834039529cd1c87419c3e3"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ae3f994c60f834039529cd1c87419c3e3">AST_EVENT_IE_RESPONSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00290">event_defs.h:290</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491ac2b99e4afe5317742c5dd2c0f23d01b3"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac2b99e4afe5317742c5dd2c0f23d01b3">AST_EVENT_IE_REQUEST_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00284">event_defs.h:284</a></div></div>
<div class="ttc" id="structast__security__event__ie__type_html_ade84e0c0ea3aac6d43fab48ee43bc33d"><div class="ttname"><a href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ast_security_event_ie_type::ie_type</a></div><div class="ttdeci">enum ast_event_ie_type ie_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">include/asterisk/security_events.h:54</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87">AST_EVENT_IE_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00287">event_defs.h:287</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a2049edac260c7783112113e0c5a62515"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a2049edac260c7783112113e0c5a62515">AST_EVENT_IE_MODULE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00276">event_defs.h:276</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a6a1ec83e32b4487b8b3167f4a4aaf3a5"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a6a1ec83e32b4487b8b3167f4a4aaf3a5">AST_EVENT_IE_AUTH_METHOD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00286">event_defs.h:286</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ab3449f999d03b45fc61e5f59f3cb40cb"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a></div><div class="ttdeci">const char * ast_security_event_get_name(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the name of a security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00895">main/security_events.c:895</a></div></div>
<div class="ttc" id="event_8h_html_a7c877c624fbb6f9091873b4739bc5a9c"><div class="ttname"><a href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a></div><div class="ttdeci">const char * ast_event_get_ie_type_name(enum ast_event_ie_type ie_type)</div><div class="ttdoc">Get the string representation of an information element type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/deb/event_8c_source.html#l00208">event.c:208</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491af0c9d4d19259543bd670778105f082f6"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af0c9d4d19259543bd670778105f082f6">AST_EVENT_IE_REQUEST_PARAMS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00285">event_defs.h:285</a></div></div>
<div class="ttc" id="structast__security__event__ip__addr_html"><div class="ttname"><a href="../../dd/dd8/structast__security__event__ip__addr.html">ast_security_event_ip_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00141">security_events_defs.h:141</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c">AST_EVENT_IE_EVENT_TV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00283">event_defs.h:283</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491ac2c0a1748c0179318c431020327ac46f"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ac2c0a1748c0179318c431020327ac46f">AST_EVENT_IE_EXPECTED_RESPONSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00291">event_defs.h:291</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491acb1b4d0a7b1dd641f79ea774a6acc485"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491acb1b4d0a7b1dd641f79ea774a6acc485">AST_EVENT_IE_USING_PASSWORD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00294">event_defs.h:294</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a301b8bb03b4e043ca137886b09a66d91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301b8bb03b4e043ca137886b09a66d91">&#9670;&nbsp;</a></span>alloc_security_event_json_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* alloc_security_event_json_object </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *&#160;</td>
          <td class="paramname"><em>sec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01067">1067</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/deb/event_8c_source.html#l00208">ast_event_get_ie_type_name()</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00283">AST_EVENT_IE_EVENT_TV</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00274">AST_EVENT_IE_EVENT_VERSION</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00275">AST_EVENT_IE_SERVICE</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00287">AST_EVENT_IE_SEVERITY</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00317">ast_json_integer_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00389">ast_json_object_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00283">ast_json_stringf()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00649">ast_json_timeval()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00871">ast_security_event_severity_get_name()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00158">ast_security_event_common::event_type</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00167">ast_security_event_common::service</a>, and <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00160">ast_security_event_common::version</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>.</p>
<div class="fragment"><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;{</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   <span class="keyword">struct </span>timeval tv = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *severity_str;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_temp;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json_object, <a class="code" href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a>(), <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   <span class="keywordflow">if</span> (!json_object) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <span class="comment">/* NOTE: Every time ast_json_object_set is used, json_temp becomes a stale pointer since the reference is taken.</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">    *       This is true even if ast_json_object_set fails.</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   json_temp = <a class="code" href="../../d4/d05/json_8h.html#ac13f0f415f198c5a341017195933356f">ast_json_integer_create</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   <span class="keywordflow">if</span> (!json_temp || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json_object, <span class="stringliteral">&quot;SecurityEvent&quot;</span>, json_temp)) {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   json_temp = <a class="code" href="../../d4/d05/json_8h.html#a7070193de404a995e829dd75e7b4460f">ast_json_stringf</a>(<span class="stringliteral">&quot;%u&quot;</span>, sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">version</a>);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordflow">if</span> (!json_temp || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json_object, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(<a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1">AST_EVENT_IE_EVENT_VERSION</a>), json_temp)) {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   <span class="comment">/* AST_EVENT_IE_EVENT_TV */</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   json_temp  = <a class="code" href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a>(tv, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   <span class="keywordflow">if</span> (!json_temp || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json_object, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(<a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c">AST_EVENT_IE_EVENT_TV</a>), json_temp)) {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <span class="comment">/* AST_EVENT_IE_SERVICE */</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;   json_temp = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#af053a80dc771b285c53ac53025303970">service</a>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <span class="keywordflow">if</span> (!json_temp || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json_object, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(<a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498">AST_EVENT_IE_SERVICE</a>), json_temp)) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <span class="comment">/* AST_EVENT_IE_SEVERITY */</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   severity_str = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="../../d8/d30/main_2security__events_8c.html#a947bbf6fbc82e52e2a5f9231dcd786d9">ast_security_event_severity_get_name</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>].severity),</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="stringliteral">&quot;Unknown&quot;</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   );</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   json_temp = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(severity_str);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="keywordflow">if</span> (!json_temp || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json_object, <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(<a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87">AST_EVENT_IE_SEVERITY</a>), json_temp)) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(json_object);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="structast__security__event__common_html_ab6aa0eb589925a75d104087ce946a0ad"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">ast_security_event_common::event_type</a></div><div class="ttdeci">enum ast_security_event_type event_type</div><div class="ttdoc">The security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00158">security_events_defs.h:158</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491af60cdc5b67162fad086846b79e0dc498">AST_EVENT_IE_SERVICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00275">event_defs.h:275</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__security__event__common_html_af053a80dc771b285c53ac53025303970"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#af053a80dc771b285c53ac53025303970">ast_security_event_common::service</a></div><div class="ttdeci">const char * service</div><div class="ttdoc">Service that generated the event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00167">security_events_defs.h:167</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="json_8h_html_a7070193de404a995e829dd75e7b4460f"><div class="ttname"><a href="../../d4/d05/json_8h.html#a7070193de404a995e829dd75e7b4460f">ast_json_stringf</a></div><div class="ttdeci">struct ast_json * ast_json_stringf(const char *format,...)</div><div class="ttdoc">Create a JSON string, printf style. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00283">json.c:283</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a947bbf6fbc82e52e2a5f9231dcd786d9"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a947bbf6fbc82e52e2a5f9231dcd786d9">ast_security_event_severity_get_name</a></div><div class="ttdeci">const char * ast_security_event_severity_get_name(const enum ast_security_event_severity severity)</div><div class="ttdoc">Get the name of a security event severity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00871">main/security_events.c:871</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__security__event__common_html_acd99bb05ca015e7d74448acb1deba7ca"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">ast_security_event_common::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdoc">security event version </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00160">security_events_defs.h:160</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a00adf3a0c34ed5aa137302c226e0add1">AST_EVENT_IE_EVENT_VERSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00274">event_defs.h:274</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="json_8h_html_a2b7c72e2e3ab2634d8a4f8b708440d95"><div class="ttname"><a href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a></div><div class="ttdeci">struct ast_json * ast_json_timeval(const struct timeval tv, const char *zone)</div><div class="ttdoc">Construct a timeval as JSON. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00649">json.c:649</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a943fca61a400edc99d19d18e325feb87">AST_EVENT_IE_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00287">event_defs.h:287</a></div></div>
<div class="ttc" id="json_8h_html_a5892d6cd943e00556180fcf15d30788e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a></div><div class="ttdeci">struct ast_json * ast_json_object_create(void)</div><div class="ttdoc">Create a new JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00389">json.c:389</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="event_8h_html_a7c877c624fbb6f9091873b4739bc5a9c"><div class="ttname"><a href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a></div><div class="ttdeci">const char * ast_event_get_ie_type_name(enum ast_event_ie_type ie_type)</div><div class="ttdoc">Get the string representation of an information element type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/deb/event_8c_source.html#l00208">event.c:208</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a474c461cd1605616d69a18dc65b4932c">AST_EVENT_IE_EVENT_TV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00283">event_defs.h:283</a></div></div>
<div class="ttc" id="json_8h_html_ac13f0f415f198c5a341017195933356f"><div class="ttname"><a href="../../d4/d05/json_8h.html#ac13f0f415f198c5a341017195933356f">ast_json_integer_create</a></div><div class="ttdeci">struct ast_json * ast_json_integer_create(intmax_t value)</div><div class="ttdoc">Create a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00317">json.c:317</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8d9cdbb9e331268fa885f20d78da95c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8d9cdbb9e331268fa885f20d78da95c">&#9670;&nbsp;</a></span>append_event_str_from_json()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int append_event_str_from_json </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td>
          <td class="paramname"><em>ies</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00402">402</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00385">append_event_str_single()</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00070">AST_EVENT_IE_END</a>, and <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">ast_security_event_ie_type::ie_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keywordflow">if</span> (!ies) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">for</span> (i = 0; ies[i].<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> != <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>; i++) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#aacaf83011baee7b46b05bb4df8636c6d">append_event_str_single</a>(str, json, ies[i].ie_type)) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="ttc" id="structast__security__event__ie__type_html_ade84e0c0ea3aac6d43fab48ee43bc33d"><div class="ttname"><a href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ast_security_event_ie_type::ie_type</a></div><div class="ttdeci">enum ast_event_ie_type ie_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">include/asterisk/security_events.h:54</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_aacaf83011baee7b46b05bb4df8636c6d"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#aacaf83011baee7b46b05bb4df8636c6d">append_event_str_single</a></div><div class="ttdeci">static int append_event_str_single(struct ast_str **str, struct ast_json *json, const enum ast_event_ie_type ie_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00385">main/security_events.c:385</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00070">event_defs.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aacaf83011baee7b46b05bb4df8636c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacaf83011baee7b46b05bb4df8636c6d">&#9670;&nbsp;</a></span>append_event_str_single()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int append_event_str_single </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum <a class="el" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&#160;</td>
          <td class="paramname"><em>ie_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00385">385</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/deb/event_8c_source.html#l00208">ast_event_get_ie_type_name()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, and <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00402">append_event_str_from_json()</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *ie_type_key = <a class="code" href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a>(ie_type);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_string = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, ie_type_key);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keywordflow">if</span> (!json_string) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(str, 0, <span class="stringliteral">&quot;%s: %s\r\n&quot;</span>, ie_type_key, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(json_string), <span class="stringliteral">&quot;&quot;</span>)) == -1) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="event_8h_html_a7c877c624fbb6f9091873b4739bc5a9c"><div class="ttname"><a href="../../dd/d20/event_8h.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a></div><div class="ttdeci">const char * ast_event_get_ie_type_name(enum ast_event_ie_type ie_type)</div><div class="ttdoc">Get the string representation of an information element type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/deb/event_8c_source.html#l00208">event.c:208</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3449f999d03b45fc61e5f59f3cb40cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3449f999d03b45fc61e5f59f3cb40cb">&#9670;&nbsp;</a></span>ast_security_event_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_security_event_get_name </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of a security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if event_type is invalid </td></tr>
    <tr><td class="paramname">non-NULL</td><td>the name of the security event type</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">895</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">add_json_object()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">ast_security_event_report()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00644">gen_events()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].name;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bea01160811d84a487584cd400f27c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bea01160811d84a487584cd400f27c3">&#9670;&nbsp;</a></span>ast_security_event_get_optional_ies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>* ast_security_event_get_optional_ies </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the list of optional IEs for a given security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>invalid event_type </td></tr>
    <tr><td class="paramname">non-NULL</td><td>An array terminated with the value AST_EVENT_IE_END</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">914</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;{</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].optional_ies;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd7b4c2b7d86562bf6204c636bed9d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7b4c2b7d86562bf6204c636bed9d53">&#9670;&nbsp;</a></span>ast_security_event_get_required_ies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>* ast_security_event_get_required_ies </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the list of required IEs for a given security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>invalid event_type </td></tr>
    <tr><td class="paramname">non-NULL</td><td>An array terminated with the value AST_EVENT_IE_END</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">904</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;{</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].required_ies;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae13dc3d123710d7519588d54c51f8170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae13dc3d123710d7519588d54c51f8170">&#9670;&nbsp;</a></span>ast_security_event_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_security_event_report </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *&#160;</td>
          <td class="paramname"><em>sec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report a security event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>security event data. Callers of this function should never declare an instance of <a class="el" href="../../dd/d40/structast__security__event__common.html" title="Common structure elements. ">ast_security_event_common</a> directly. The argument should be an instance of a specific security event descriptor which has <a class="el" href="../../dd/d40/structast__security__event__common.html" title="Common structure elements. ">ast_security_event_common</a> at the very beginning.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">non-zero</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">1171</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00121">AST_SECURITY_EVENT_NUM_TYPES</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00158">ast_security_event_common::event_type</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>, and <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00160">ast_security_event_common::version</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00197">ast_sip_report_auth_challenge_sent()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00130">ast_sip_report_auth_failed_challenge_response()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00168">ast_sip_report_auth_success()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00102">ast_sip_report_failed_acl()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00075">ast_sip_report_invalid_endpoint()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00259">ast_sip_report_mem_limit()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00230">ast_sip_report_req_no_support()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00333">evt_gen_auth_method_not_allowed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00491">evt_gen_chal_resp_failed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00570">evt_gen_chal_sent()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00074">evt_gen_failed_acl()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00112">evt_gen_inval_acct_id()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00531">evt_gen_inval_password()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00607">evt_gen_inval_transport()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00220">evt_gen_load_avg()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00184">evt_gen_mem_limit()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00371">evt_gen_req_bad_format()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00256">evt_gen_req_no_support()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00294">evt_gen_req_not_allowed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00148">evt_gen_session_limit()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00410">evt_gen_successful_auth()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00446">evt_gen_unexpected_addr()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03360">report_auth_success()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03310">report_failed_acl()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03443">report_failed_challenge_response()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03335">report_inval_password()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03285">report_invalid_user()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03414">report_req_bad_format()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03385">report_req_not_allowed()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03473">report_session_limit()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00123">sip_report_auth_success()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00210">sip_report_chal_sent()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00068">sip_report_failed_acl()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00174">sip_report_failed_challenge_response()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00094">sip_report_inval_password()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00244">sip_report_inval_transport()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00043">sip_report_invalid_peer()</a>, and <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00149">sip_report_session_limit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;{</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> &gt;= <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>) {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid security event type\n&quot;</span>);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>].name) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Security event type %u not handled\n&quot;</span>,</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   <span class="keywordflow">if</span> (sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">version</a> != <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>].version) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Security event %u version mismatch\n&quot;</span>,</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#af34b009cd52c662e28242426ec40a5da">handle_security_event</a>(sec)) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to issue security event of type %s.\n&quot;</span>,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;}</div><div class="ttc" id="structast__security__event__common_html_ab6aa0eb589925a75d104087ce946a0ad"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">ast_security_event_common::event_type</a></div><div class="ttdeci">enum ast_security_event_type event_type</div><div class="ttdoc">The security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00158">security_events_defs.h:158</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="structast__security__event__common_html_acd99bb05ca015e7d74448acb1deba7ca"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">ast_security_event_common::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdoc">security event version </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00160">security_events_defs.h:160</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_af34b009cd52c662e28242426ec40a5da"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#af34b009cd52c662e28242426ec40a5da">handle_security_event</a></div><div class="ttdeci">static int handle_security_event(const struct ast_security_event_common *sec)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l01118">main/security_events.c:1118</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a></div><div class="ttdoc">This must stay at the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00121">security_events_defs.h:121</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ab3449f999d03b45fc61e5f59f3cb40cb"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a></div><div class="ttdeci">const char * ast_security_event_get_name(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the name of a security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00895">main/security_events.c:895</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a947bbf6fbc82e52e2a5f9231dcd786d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947bbf6fbc82e52e2a5f9231dcd786d9">&#9670;&nbsp;</a></span>ast_security_event_severity_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_security_event_severity_get_name </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a>&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of a security event severity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">severity</td><td>security event severity</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if severity is invalid </td></tr>
    <tr><td class="paramname">non-NULL</td><td>the name of the security event severity</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00871">871</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01067">alloc_security_event_json_object()</a>.</p>
<div class="fragment"><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>); i++) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>[i].<a class="code" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a> == <a class="code" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a>) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>[i].str;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_adef9a4cc441833acc08cf8ac335d305a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a></div><div class="ttdeci">enum ast_security_event_severity severity</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00503">main/security_events.c:503</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a458cfcebc5862c24cebeadf96bd292f8"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a></div><div class="ttdeci">static const struct @419 severities[]</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bfccbad0896b673d8eb936aa3c2caeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bfccbad0896b673d8eb936aa3c2caeb">&#9670;&nbsp;</a></span>ast_security_stasis_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_security_stasis_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes stasis topic/event types for <a class="el" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> and <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a88d718027e6e4abe11dcfe17bd267377">ast_security_event_type</a> </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00483">483</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00475">security_stasis_cleanup()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03947">asterisk_daemon()</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a90b87e2db58f030de91b0ab1beea6a23">security_stasis_cleanup</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(<span class="stringliteral">&quot;security:all&quot;</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a>) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>)) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div><div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a063b8a49db9862da0d66dd336416fc5a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></div><div class="ttdeci">static struct stasis_topic * security_topic</div><div class="ttdoc">Security Topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00378">main/security_events.c:378</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a90b87e2db58f030de91b0ab1beea6a23"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a90b87e2db58f030de91b0ab1beea6a23">security_stasis_cleanup</a></div><div class="ttdeci">static void security_stasis_cleanup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00475">main/security_events.c:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0db46f92449a8f63b954d776ebead63a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db46f92449a8f63b954d776ebead63a">&#9670;&nbsp;</a></span>ast_security_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* ast_security_topic </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> which publishes messages for security related issues. </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00380">380</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00378">security_topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01470">acl_change_stasis_subscribe()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01973">ast_res_pjsip_initialize_configuration()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../d5/d5e/res__pjsip__acl_8c_source.html#l00297">load_module()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>, <a class="el" href="../../da/ddd/named__acl_8c_source.html#l00371">publish_acl_change()</a>, and <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a063b8a49db9862da0d66dd336416fc5a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></div><div class="ttdeci">static struct stasis_topic * security_topic</div><div class="ttdoc">Security Topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00378">main/security_events.c:378</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ba1021cb8a3d9192cc1c43bf3cad5b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba1021cb8a3d9192cc1c43bf3cad5b7">&#9670;&nbsp;</a></span>check_event_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_event_type </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">885</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00121">AST_SECURITY_EVENT_NUM_TYPES</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">ast_security_event_get_optional_ies()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">ast_security_event_get_required_ies()</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)event_type &gt;= <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>) {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid security event type %u\n&quot;</span>, event_type);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div><div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a></div><div class="ttdoc">This must stay at the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00121">security_events_defs.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af34b009cd52c662e28242426ec40a5da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af34b009cd52c662e28242426ec40a5da">&#9670;&nbsp;</a></span>handle_security_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_security_event </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *&#160;</td>
          <td class="paramname"><em>sec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">1118</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">add_json_object()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01067">alloc_security_event_json_object()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d6/d37/event__defs_8h_source.html#l00070">AST_EVENT_IE_END</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00735">ast_json_payload_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">ast_security_event_get_optional_ies()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">ast_security_event_get_required_ies()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00380">ast_security_topic()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00158">ast_security_event_common::event_type</a>, <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">ast_security_event_ie_type::ie_type</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00938">NOT_REQUIRED</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00939">REQUIRED</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">ast_security_event_report()</a>.</p>
<div class="fragment"><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;{</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *, json_payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json_object, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *ies;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>()) {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   }</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;   json_object = <a class="code" href="../../d8/d30/main_2security__events_8c.html#a301b8bb03b4e043ca137886b09a66d91">alloc_security_event_json_object</a>(sec);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;   <span class="keywordflow">if</span> (!json_object) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   <span class="keywordflow">for</span> (ies = <a class="code" href="../../d8/d30/main_2security__events_8c.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>), i = 0;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;         ies[i].<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> != <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         i++) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#ad8c55ca94e326b3bf5477d19497bccc9">add_json_object</a>(json_object, sec, ies + i, <a class="code" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a>)) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         <span class="keywordflow">goto</span> return_error;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <span class="keywordflow">for</span> (ies = <a class="code" href="../../d8/d30/main_2security__events_8c.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>), i = 0;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;         ies[i].<a class="code" href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> != <a class="code" href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;         i++) {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#ad8c55ca94e326b3bf5477d19497bccc9">add_json_object</a>(json_object, sec, ies + i, <a class="code" href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a>)) {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         <span class="keywordflow">goto</span> return_error;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   <span class="comment">/* The json blob is ready.  Throw it in the payload and send it out over stasis. */</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   <span class="keywordflow">if</span> (!(json_payload = <a class="code" href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a>(json_object))) {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">goto</span> return_error;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>(), json_payload);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">goto</span> return_error;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a>(), msg);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;return_error:</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="ttc" id="structast__security__event__common_html_ab6aa0eb589925a75d104087ce946a0ad"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">ast_security_event_common::event_type</a></div><div class="ttdeci">enum ast_security_event_type event_type</div><div class="ttdoc">The security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00158">security_events_defs.h:158</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6cae79ba002cf0163d634b562a676808674">NOT_REQUIRED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00938">main/security_events.c:938</a></div></div>
<div class="ttc" id="json_8h_html_a8ac267a28e7eddf5b10bbb65139406f2"><div class="ttname"><a href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a></div><div class="ttdeci">struct ast_json_payload * ast_json_payload_create(struct ast_json *json)</div><div class="ttdoc">Create an ao2 object to pass json blobs as data payloads for stasis. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00735">json.c:735</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a52b7fae0b3110ff01e35a94fd3d2fd6ca779613937a96dc934924d48a0e29e154">REQUIRED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00939">main/security_events.c:939</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_afd7b4c2b7d86562bf6204c636bed9d53"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a></div><div class="ttdeci">const struct ast_security_event_ie_type * ast_security_event_get_required_ies(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the list of required IEs for a given security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00904">main/security_events.c:904</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a301b8bb03b4e043ca137886b09a66d91"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a301b8bb03b4e043ca137886b09a66d91">alloc_security_event_json_object</a></div><div class="ttdeci">static struct ast_json * alloc_security_event_json_object(const struct ast_security_event_common *sec)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l01067">main/security_events.c:1067</a></div></div>
<div class="ttc" id="structast__security__event__ie__type_html"><div class="ttname"><a href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00053">include/asterisk/security_events.h:53</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ad8c55ca94e326b3bf5477d19497bccc9"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ad8c55ca94e326b3bf5477d19497bccc9">add_json_object</a></div><div class="ttdeci">static int add_json_object(struct ast_json *json, const struct ast_security_event_common *sec, const struct ast_security_event_ie_type *ie_type, enum ie_required req)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00942">main/security_events.c:942</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="structast__security__event__ie__type_html_ade84e0c0ea3aac6d43fab48ee43bc33d"><div class="ttname"><a href="../../d4/d1e/structast__security__event__ie__type.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ast_security_event_ie_type::ie_type</a></div><div class="ttdeci">enum ast_event_ie_type ie_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html#l00054">include/asterisk/security_events.h:54</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a0bea01160811d84a487584cd400f27c3"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a></div><div class="ttdeci">const struct ast_security_event_ie_type * ast_security_event_get_optional_ies(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the list of optional IEs for a given security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00914">main/security_events.c:914</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="main_2security__events_8c_html_a0db46f92449a8f63b954d776ebead63a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a></div><div class="ttdeci">struct stasis_topic * ast_security_topic(void)</div><div class="ttdoc">A stasis_topic which publishes messages for security related issues. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00380">main/security_events.c:380</a></div></div>
<div class="ttc" id="event__defs_8h_html_a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f"><div class="ttname"><a href="../../d6/d37/event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d37/event__defs_8h_source.html#l00070">event_defs.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7acb37fa240fe2698e918017cfd3f385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7acb37fa240fe2698e918017cfd3f385">&#9670;&nbsp;</a></span>security_event_to_ami()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a>* security_event_to_ami </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00455">455</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d05/json_8h_source.html#l01025">ast_json_payload::json</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c.html#a1760a739d331792e5163abde85772d06">STASIS_MESSAGE_TYPE_DEFN()</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">to_ami()</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;{</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *payload = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message) != <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>()) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a1b79361f271d2cf30aa20efd91a50d53">security_event_to_ami_blob</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="structast__json__payload_html_a9cf488298469ae63ef947653d7ff9bab"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">ast_json_payload::json</a></div><div class="ttdeci">struct ast_json * json</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01025">json.h:1025</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a1b79361f271d2cf30aa20efd91a50d53"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a1b79361f271d2cf30aa20efd91a50d53">security_event_to_ami_blob</a></div><div class="ttdeci">static struct ast_manager_event_blob * security_event_to_ami_blob(struct ast_json *json)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00420">main/security_events.c:420</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b79361f271d2cf30aa20efd91a50d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b79361f271d2cf30aa20efd91a50d53">&#9670;&nbsp;</a></span>security_event_to_ami_blob()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a>* security_event_to_ami_blob </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">420</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00402">append_event_str_from_json()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00322">ast_json_integer_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00290">AST_LOG_ERROR</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09727">ast_manager_event_blob_create()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">ast_security_event_get_optional_ies()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">ast_security_event_get_required_ies()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00121">AST_SECURITY_EVENT_NUM_TYPES</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00089">EVENT_FLAG_SECURITY</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00375">SECURITY_EVENT_BUF_INIT_LEN</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00865">str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00455">security_event_to_ami()</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, <a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *event_type_json;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   event_type_json = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;SecurityEvent&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   event_type = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(event_type_json);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)event_type &lt; <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#ab711dac609fd5d81b02fd54143d9ccf3">SECURITY_EVENT_BUF_INIT_LEN</a>))) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#aa8d9cdbb9e331268fa885f20d78da95c">append_event_str_from_json</a>(&amp;<a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, json,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <a class="code" href="../../d8/d30/main_2security__events_8c.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a>(event_type))) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to issue a security event to AMI: &quot;</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         <span class="stringliteral">&quot;error occurred when adding required event fields.\n&quot;</span>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#aa8d9cdbb9e331268fa885f20d78da95c">append_event_str_from_json</a>(&amp;<a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, json,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <a class="code" href="../../d8/d30/main_2security__events_8c.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a>(event_type))) {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to issue a security event to AMI: &quot;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         <span class="stringliteral">&quot;error occurred when adding optional event fields.\n&quot;</span>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a>(<a class="code" href="../../db/d45/manager_8h.html#a673603420907be7dada8fc479e313333">EVENT_FLAG_SECURITY</a>,</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(event_type),</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>));</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div><div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_aa8d9cdbb9e331268fa885f20d78da95c"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#aa8d9cdbb9e331268fa885f20d78da95c">append_event_str_from_json</a></div><div class="ttdeci">static int append_event_str_from_json(struct ast_str **str, struct ast_json *json, const struct ast_security_event_ie_type *ies)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00402">main/security_events.c:402</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="manager_8h_html_a3ace32eaf9a3fc2f7d15121c64bf8ecd"><div class="ttname"><a href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a></div><div class="ttdeci">struct ast_manager_event_blob * ast_manager_event_blob_create(int event_flags, const char *manager_event, const char *extra_fields_fmt,...)</div><div class="ttdoc">Construct a ast_manager_event_blob. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09727">manager.c:9727</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_afd7b4c2b7d86562bf6204c636bed9d53"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a></div><div class="ttdeci">const struct ast_security_event_ie_type * ast_security_event_get_required_ies(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the list of required IEs for a given security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00904">main/security_events.c:904</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_a2fdd5bff193a29ec6c7278da2851ea56"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a></div><div class="ttdeci">#define AST_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00290">logger.h:290</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00865">main/security_events.c:865</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ab711dac609fd5d81b02fd54143d9ccf3"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ab711dac609fd5d81b02fd54143d9ccf3">SECURITY_EVENT_BUF_INIT_LEN</a></div><div class="ttdeci">static const size_t SECURITY_EVENT_BUF_INIT_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00375">main/security_events.c:375</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a0bea01160811d84a487584cd400f27c3"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a></div><div class="ttdeci">const struct ast_security_event_ie_type * ast_security_event_get_optional_ies(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the list of optional IEs for a given security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00914">main/security_events.c:914</a></div></div>
<div class="ttc" id="manager_8h_html_a673603420907be7dada8fc479e313333"><div class="ttname"><a href="../../db/d45/manager_8h.html#a673603420907be7dada8fc479e313333">EVENT_FLAG_SECURITY</a></div><div class="ttdeci">#define EVENT_FLAG_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00089">manager.h:89</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a></div><div class="ttdoc">This must stay at the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00121">security_events_defs.h:121</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ab3449f999d03b45fc61e5f59f3cb40cb"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a></div><div class="ttdeci">const char * ast_security_event_get_name(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the name of a security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00895">main/security_events.c:895</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="json_8h_html_ad20fdcbab1ed5c078284a687cced2877"><div class="ttname"><a href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a></div><div class="ttdeci">intmax_t ast_json_integer_get(const struct ast_json *integer)</div><div class="ttdoc">Get the value from a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00322">json.c:322</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90b87e2db58f030de91b0ab1beea6a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b87e2db58f030de91b0ab1beea6a23">&#9670;&nbsp;</a></span>security_stasis_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void security_stasis_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00475">475</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01523">STASIS_MESSAGE_TYPE_CLEANUP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00483">ast_security_stasis_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div><div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a063b8a49db9862da0d66dd336416fc5a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></div><div class="ttdeci">static struct stasis_topic * security_topic</div><div class="ttdoc">Security Topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00378">main/security_events.c:378</a></div></div>
<div class="ttc" id="stasis_8h_html_a31197e193b1dfd6c122ff6d7c7f6b3fa"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_CLEANUP(name)</div><div class="ttdoc">Boiler-plate messaging macro for cleaning up message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01523">stasis.h:1523</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1760a739d331792e5163abde85772d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1760a739d331792e5163abde85772d06">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STASIS_MESSAGE_TYPE_DEFN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">.&#160;</td>
          <td class="paramname"><em>to_ami</em> = <code><a class="el" href="../../d8/d30/main_2security__events_8c.html#a7acb37fa240fe2698e918017cfd3f385">security_event_to_ami</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Message type for security events. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00455">security_event_to_ami()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8f8f80d37794cde9472343e4487ba3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f8f80d37794cde9472343e4487ba3eb">&#9670;&nbsp;</a></span>name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* name</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00501">501</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
<a id="a4020d314f5654c6a3a5e49625b2ec1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4020d314f5654c6a3a5e49625b2ec1d2">&#9670;&nbsp;</a></span>optional_ies</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> optional_ies[<a class="el" href="../../d8/d30/main_2security__events_8c.html#abb3526605166ab5a381901b534dc38f8">MAX_SECURITY_IES</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00506">506</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
<a id="a51b076a042fb67f22773af4a58440dad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51b076a042fb67f22773af4a58440dad">&#9670;&nbsp;</a></span>required_ies</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> required_ies[<a class="el" href="../../d8/d30/main_2security__events_8c.html#abb3526605166ab5a381901b534dc38f8">MAX_SECURITY_IES</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00505">505</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
<a id="a63a523f56955f20e85d90620dee621ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63a523f56955f20e85d90620dee621ca">&#9670;&nbsp;</a></span>sec_events</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const { ... }   sec_events[<a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01067">alloc_security_event_json_object()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">ast_security_event_get_optional_ies()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">ast_security_event_get_required_ies()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">ast_security_event_report()</a>.</p>

</div>
</div>
<a id="ab711dac609fd5d81b02fd54143d9ccf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab711dac609fd5d81b02fd54143d9ccf3">&#9670;&nbsp;</a></span>SECURITY_EVENT_BUF_INIT_LEN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t SECURITY_EVENT_BUF_INIT_LEN = 256</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00375">375</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>

</div>
</div>
<a id="a063b8a49db9862da0d66dd336416fc5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063b8a49db9862da0d66dd336416fc5a">&#9670;&nbsp;</a></span>security_topic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* security_topic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Security Topic. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00378">378</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00380">ast_security_topic()</a>.</p>

</div>
</div>
<a id="a458cfcebc5862c24cebeadf96bd292f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458cfcebc5862c24cebeadf96bd292f8">&#9670;&nbsp;</a></span>severities</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const { ... }   severities[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   { <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0af1ebb471fa3f084d2e2effd34a8135ac">AST_SECURITY_EVENT_SEVERITY_INFO</a>,  <span class="stringliteral">&quot;Informational&quot;</span> },</div><div class="line">   { <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0a75b33105f12b6d1bc3ad8c94d5c7c714">AST_SECURITY_EVENT_SEVERITY_ERROR</a>, <span class="stringliteral">&quot;Error&quot;</span> },</div><div class="line">}</div><div class="ttc" id="security__events__defs_8h_html_ac24fb5f02b28cd5ad484be72c47a57d0af1ebb471fa3f084d2e2effd34a8135ac"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0af1ebb471fa3f084d2e2effd34a8135ac">AST_SECURITY_EVENT_SEVERITY_INFO</a></div><div class="ttdoc">Informational event, not something that has gone wrong. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00134">security_events_defs.h:134</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac24fb5f02b28cd5ad484be72c47a57d0a75b33105f12b6d1bc3ad8c94d5c7c714"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0a75b33105f12b6d1bc3ad8c94d5c7c714">AST_SECURITY_EVENT_SEVERITY_ERROR</a></div><div class="ttdoc">Something has gone wrong. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00136">security_events_defs.h:136</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00871">ast_security_event_severity_get_name()</a>.</p>

</div>
</div>
<a id="adef9a4cc441833acc08cf8ac335d305a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef9a4cc441833acc08cf8ac335d305a">&#9670;&nbsp;</a></span>severity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a> severity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00503">503</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
<a id="af25d6dc49269fa2003ac7c7fa6f13915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25d6dc49269fa2003ac7c7fa6f13915">&#9670;&nbsp;</a></span>str</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* str</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00865">865</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">add_json_object()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>

</div>
</div>
<a id="acd99bb05ca015e7d74448acb1deba7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd99bb05ca015e7d74448acb1deba7ca">&#9670;&nbsp;</a></span>version</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t version</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00502">502</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:46 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
