<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: dsp.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dsp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Convenience Signal Processing routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html">asterisk/frame.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1c/format__cache_8h_source.html">asterisk/format_cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d08/dsp_8h_source.html">asterisk/dsp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/dc2/ulaw_8h_source.html">asterisk/ulaw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/db5/alaw_8h_source.html">asterisk/alaw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d5b/options_8h_source.html">asterisk/options.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html">asterisk/config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dsp.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d06/dsp_8c__incl.png" border="0" usemap="#dsp_8c" alt=""/></div>
<map name="dsp_8c" id="dsp_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="2303,229,2387,256"/>
<area shape="rect" id="node14" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1857,80,1993,107"/>
<area shape="rect" id="node15" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="994,229,1109,256"/>
<area shape="rect" id="node22" href="../../d7/d5b/options_8h.html" title="Options provided by main asterisk program. " alt="" coords="2205,677,2340,704"/>
<area shape="rect" id="node28" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="1903,229,2029,256"/>
<area shape="rect" id="node31" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="2614,80,2790,107"/>
<area shape="rect" id="node32" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1159,80,1298,107"/>
<area shape="rect" id="node37" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="5,155,132,181"/>
<area shape="rect" id="node46" href="../../d3/d08/dsp_8h.html" title="Convenient Signal Processing routines. " alt="" coords="2815,80,2925,107"/>
<area shape="rect" id="node47" href="../../d4/dc2/ulaw_8h.html" title="u&#45;Law to Signed linear conversion " alt="" coords="2950,80,3065,107"/>
<area shape="rect" id="node48" href="../../d6/db5/alaw_8h.html" title="A&#45;Law to Signed linear conversion. " alt="" coords="3089,80,3203,107"/>
<area shape="rect" id="node49" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="259,155,372,181"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="2195,752,2350,779"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="1424,453,1561,480"/>
<area shape="rect" id="node12" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="2312,304,2447,331"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="2199,827,2346,853"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1147,603,1289,629"/>
<area shape="rect" id="node16" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="1061,304,1199,331"/>
<area shape="rect" id="node17" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1015,603,1077,629"/>
<area shape="rect" id="node20" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="945,528,1059,555"/>
<area shape="rect" id="node21" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1815,603,1941,629"/>
<area shape="rect" id="node23" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1223,304,1370,331"/>
<area shape="rect" id="node24" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="99,304,257,331"/>
<area shape="rect" id="node25" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="595,304,726,331"/>
<area shape="rect" id="node19" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="741,677,887,704"/>
<area shape="rect" id="node26" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="801,379,936,405"/>
<area shape="rect" id="node27" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1249,453,1400,480"/>
<area shape="rect" id="node29" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="2055,304,2186,331"/>
<area shape="rect" id="node30" href="../../d1/d84/endian_8h.html" title="Asterisk architecture endianess compatibility definitions. " alt="" coords="1901,304,2031,331"/>
<area shape="rect" id="node33" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="1329,155,1473,181"/>
<area shape="rect" id="node34" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="2057,229,2216,256"/>
<area shape="rect" id="node35" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="648,155,812,181"/>
<area shape="rect" id="node36" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1477,379,1623,405"/>
<area shape="rect" id="node38" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="837,155,943,181"/>
<area shape="rect" id="node39" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="1251,379,1401,405"/>
<area shape="rect" id="node40" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="968,155,1129,181"/>
<area shape="rect" id="node41" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="2225,155,2395,181"/>
<area shape="rect" id="node42" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="1932,155,2048,181"/>
<area shape="rect" id="node43" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="1750,155,1907,181"/>
<area shape="rect" id="node44" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="447,155,573,181"/>
<area shape="rect" id="node45" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1153,155,1304,181"/>
<area shape="rect" id="node50" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="610,229,711,256"/>
</map>
</div>
</div>
<p><a href="../../d5/d3b/dsp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d42/structdtmf__detect__state__t.html">dtmf_detect_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dbd/structgoertzel__result__t.html">goertzel_result_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/structmf__detect__state__t.html">mf_detect_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dc3/structprogalias.html">progalias</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/df7/structprogress.html">progress</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1d14f26f0f1376d16a84ea7834f5be70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a1d14f26f0f1376d16a84ea7834f5be70">BELL_MF_RELATIVE_PEAK</a>&#160;&#160;&#160;12.6    /* 11dB */</td></tr>
<tr class="separator:a1d14f26f0f1376d16a84ea7834f5be70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cee9cae76ca825f6af9d9dedc25e63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a09cee9cae76ca825f6af9d9dedc25e63">BELL_MF_THRESHOLD</a>&#160;&#160;&#160;1.6e9</td></tr>
<tr class="separator:a09cee9cae76ca825f6af9d9dedc25e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb725f58c4d616aca44873f87a251ef6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#adb725f58c4d616aca44873f87a251ef6">BELL_MF_TWIST</a>&#160;&#160;&#160;4.0     /* 6dB */</td></tr>
<tr class="separator:adb725f58c4d616aca44873f87a251ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62921b92fa4fb37f1e3a5d4c644fc1d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a62921b92fa4fb37f1e3a5d4c644fc1d8">CONFIG_FILE_NAME</a>&#160;&#160;&#160;&quot;dsp.conf&quot;</td></tr>
<tr class="separator:a62921b92fa4fb37f1e3a5d4c644fc1d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0552d253f9f73129985cec46b262d35d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0552d253f9f73129985cec46b262d35d">DEF_DTMF_HITS_TO_BEGIN</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a0552d253f9f73129985cec46b262d35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e784ed7d907009104317c4a61af3176"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a1e784ed7d907009104317c4a61af3176">DEF_DTMF_MISSES_TO_END</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a1e784ed7d907009104317c4a61af3176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9a3c55581aedf098446a36d09a1ae6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a5e9a3c55581aedf098446a36d09a1ae6">DEF_DTMF_NORMAL_TWIST</a>&#160;&#160;&#160;6.31	 /* 8.0dB */</td></tr>
<tr class="separator:a5e9a3c55581aedf098446a36d09a1ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d18e32bfd7abe1418c783bb559a2815"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0d18e32bfd7abe1418c783bb559a2815">DEF_DTMF_REVERSE_TWIST</a>&#160;&#160;&#160;2.51	 /* 4.01dB */</td></tr>
<tr class="separator:a0d18e32bfd7abe1418c783bb559a2815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b53428195fd14d7fb1277dee37797b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a47b53428195fd14d7fb1277dee37797b">DEF_RELAX_DTMF_NORMAL_TWIST</a>&#160;&#160;&#160;6.31	 /* 8.0dB */</td></tr>
<tr class="separator:a47b53428195fd14d7fb1277dee37797b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aeff17b5ac85fccc6c47e4f1b1acf28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a8aeff17b5ac85fccc6c47e4f1b1acf28">DEF_RELAX_DTMF_REVERSE_TWIST</a>&#160;&#160;&#160;3.98	 /* 6.0dB */</td></tr>
<tr class="separator:a8aeff17b5ac85fccc6c47e4f1b1acf28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9b1c28165a7071e354bd9d7823ca1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>&#160;&#160;&#160;8000</td></tr>
<tr class="separator:abe9b1c28165a7071e354bd9d7823ca1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8005141291a96e10c9c9efe02263e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0c8005141291a96e10c9c9efe02263e8">DEFAULT_THRESHOLD</a>&#160;&#160;&#160;512</td></tr>
<tr class="memdesc:a0c8005141291a96e10c9c9efe02263e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default minimum average magnitude threshold to determine talking/noise by the DSP.  <a href="#a0c8005141291a96e10c9c9efe02263e8">More...</a><br /></td></tr>
<tr class="separator:a0c8005141291a96e10c9c9efe02263e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab32788a6894e4f84d7c49ce6a2b4bd10"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>&#160;&#160;&#160;15</td></tr>
<tr class="separator:ab32788a6894e4f84d7c49ce6a2b4bd10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f207b5f13316dc0495304ee5b5d923c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>&#160;&#160;&#160;102</td></tr>
<tr class="separator:a7f207b5f13316dc0495304ee5b5d923c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d287bf752cc52501e908920bdeda015"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a7d287bf752cc52501e908920bdeda015">DTMF_RELATIVE_PEAK_COL</a>&#160;&#160;&#160;6.3     /* 8dB */</td></tr>
<tr class="separator:a7d287bf752cc52501e908920bdeda015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2849942f55808d209a04916de88c6bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab2849942f55808d209a04916de88c6bb">DTMF_RELATIVE_PEAK_ROW</a>&#160;&#160;&#160;6.3     /* 8dB */</td></tr>
<tr class="separator:ab2849942f55808d209a04916de88c6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfb0e44eab6c69bc0e2573adb252d1c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a4dfb0e44eab6c69bc0e2573adb252d1c">DTMF_THRESHOLD</a>&#160;&#160;&#160;8.0e7</td></tr>
<tr class="separator:a4dfb0e44eab6c69bc0e2573adb252d1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17557ece45a1ac2458c2a109ea80d84e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a17557ece45a1ac2458c2a109ea80d84e">DTMF_TO_TOTAL_ENERGY</a>&#160;&#160;&#160;42.0</td></tr>
<tr class="separator:a17557ece45a1ac2458c2a109ea80d84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1041464c0ba1ad755a0da7b9b9119233"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a1041464c0ba1ad755a0da7b9b9119233">FAX_TONE_CED_DB</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a1041464c0ba1ad755a0da7b9b9119233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2ad645ef024b1f21f5a3e05e07eb24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a4c2ad645ef024b1f21f5a3e05e07eb24">FAX_TONE_CED_DURATION</a>&#160;&#160;&#160;2600	/* ms */</td></tr>
<tr class="separator:a4c2ad645ef024b1f21f5a3e05e07eb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c57bc0b17a606cdf143de3f59099b1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a7c57bc0b17a606cdf143de3f59099b1a">FAX_TONE_CED_FREQ</a>&#160;&#160;&#160;2100</td></tr>
<tr class="separator:a7c57bc0b17a606cdf143de3f59099b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66baf787112a461a2e46fbb4352baa8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a66baf787112a461a2e46fbb4352baa8f">FAX_TONE_CNG_DB</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a66baf787112a461a2e46fbb4352baa8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea655fc91152db6b182f17a212d6c87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#adea655fc91152db6b182f17a212d6c87">FAX_TONE_CNG_DURATION</a>&#160;&#160;&#160;500	/* ms */</td></tr>
<tr class="separator:adea655fc91152db6b182f17a212d6c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ff20bb46c00387fe18ff35c859f8b7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a3ff20bb46c00387fe18ff35c859f8b7d">FAX_TONE_CNG_FREQ</a>&#160;&#160;&#160;1100</td></tr>
<tr class="separator:a3ff20bb46c00387fe18ff35c859f8b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a3ea6e2a2c890d2ce0228327c877a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:ab0a3ea6e2a2c890d2ce0228327c877a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5313700220195d4510860845d12d0523"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a5313700220195d4510860845d12d0523">MAX_DTMF_DIGITS</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a5313700220195d4510860845d12d0523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add921b6e54e9697d62fbfc0137efb0fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:add921b6e54e9697d62fbfc0137efb0fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48060c65aa5909df6326d08ed76a692f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a>&#160;&#160;&#160;0x7fff	/* Max signed linear amplitude */</td></tr>
<tr class="separator:a48060c65aa5909df6326d08ed76a692f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a9990b37515687259bf26d889df2ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a>&#160;&#160;&#160;80		/* Min signed linear amplitude detectable */</td></tr>
<tr class="separator:ab6a9990b37515687259bf26d889df2ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e159009069d203ae2301aa5cdeb480c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a>&#160;&#160;&#160;1e8</td></tr>
<tr class="separator:a4e159009069d203ae2301aa5cdeb480c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe56d06c4edb3c8d3bb76cc877e7e07e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a>&#160;&#160;&#160;10.0</td></tr>
<tr class="separator:afe56d06c4edb3c8d3bb76cc877e7e07e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4ea1c9c1bcb353473655b068c4ca76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a9e4ea1c9c1bcb353473655b068c4ca76">TONE_THRESHOLD</a>&#160;&#160;&#160;7.8e7</td></tr>
<tr class="separator:a9e4ea1c9c1bcb353473655b068c4ca76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a9fb2e530706d025a0d33063363a8ac8a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8a">busy_detect</a> { <br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> = 10, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a> = 7, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aaea71a835c8ec79b55ad9ac2a51ada2d4">BUSY_THRESHOLD</a> = 100, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a> = 75, 
<br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a> = 3100
<br />
 }</td></tr>
<tr class="separator:a9fb2e530706d025a0d33063363a8ac8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5520400b2835c739f9cc1abea9390c3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3">freq_index</a> { <br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef">HZ_350</a> = 0, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972">HZ_440</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552">HZ_480</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301">HZ_620</a>, 
<br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492">HZ_950</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173">HZ_1400</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa">HZ_1800</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc">HZ_425</a> = 0, 
<br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd">HZ_350UK</a> = 0, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450">HZ_440UK</a>
<br />
 }</td></tr>
<tr class="separator:aa5520400b2835c739f9cc1abea9390c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa23c853bfc745be9b034a9add00498c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498c">gsamp_size</a> { <a class="el" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec">GSAMP_SIZE_NA</a> = 183, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3">GSAMP_SIZE_CR</a> = 188, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc">GSAMP_SIZE_UK</a> = 160
 }</td></tr>
<tr class="separator:aaa23c853bfc745be9b034a9add00498c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e1f18b87b40baa3d655339bb0d6ffc1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1">gsamp_thresh</a> { <br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650">THRESH_RING</a> = 8, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948">THRESH_TALK</a> = 2, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a">THRESH_BUSY</a> = 4, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147">THRESH_CONGESTION</a> = 4, 
<br />
&#160;&#160;<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069">THRESH_HANGUP</a> = 60, 
<a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251">THRESH_RING2ANSWER</a> = 300
<br />
 }</td></tr>
<tr class="separator:a0e1f18b87b40baa3d655339bb0d6ffc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa078934b418fbdf95ad0e79e528cf826"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826">prog_mode</a> { <a class="el" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0">PROG_MODE_NA</a> = 0, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee">PROG_MODE_CR</a>, 
<a class="el" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445">PROG_MODE_UK</a>
 }</td></tr>
<tr class="separator:aa078934b418fbdf95ad0e79e528cf826"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a309197e46487283dfa6c7614a3e3d1f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, short *s, int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="separator:a309197e46487283dfa6c7614a3e3d1f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad82251eb86a7c1836a0d403585183da"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aad82251eb86a7c1836a0d403585183da">__ast_dsp_new</a> (unsigned int sample_rate)</td></tr>
<tr class="separator:aad82251eb86a7c1836a0d403585183da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af719a82882e371e7b6e6fb2b8c009c74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, short *s, int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, int *totalsilence, int *totalnoise, int *frames_energy)</td></tr>
<tr class="separator:af719a82882e371e7b6e6fb2b8c009c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380a2a03c9d2b260bb9cbefe070fc1dd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a380a2a03c9d2b260bb9cbefe070fc1dd">_dsp_init</a> (int <a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>)</td></tr>
<tr class="separator:a380a2a03c9d2b260bb9cbefe070fc1dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c546f85dd9daab37eeeb3761aba219"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad8c546f85dd9daab37eeeb3761aba219">ast_digit_detect_init</a> (<a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *s, int mf, unsigned int sample_rate)</td></tr>
<tr class="separator:ad8c546f85dd9daab37eeeb3761aba219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3349aaac5958df1f8a0147ebccf05dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad3349aaac5958df1f8a0147ebccf05dc">ast_dsp_busydetect</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:ad3349aaac5958df1f8a0147ebccf05dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return non-zero if historically this should be a busy, request that ast_dsp_silence has already been called.  <a href="#ad3349aaac5958df1f8a0147ebccf05dc">More...</a><br /></td></tr>
<tr class="separator:ad3349aaac5958df1f8a0147ebccf05dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66eb1c63ea0e0002ff7507fd9da0eccf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a66eb1c63ea0e0002ff7507fd9da0eccf">ast_dsp_call_progress</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *inf)</td></tr>
<tr class="memdesc:a66eb1c63ea0e0002ff7507fd9da0eccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scans for progress indication in audio.  <a href="#a66eb1c63ea0e0002ff7507fd9da0eccf">More...</a><br /></td></tr>
<tr class="separator:a66eb1c63ea0e0002ff7507fd9da0eccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45fbc637da9251814352c97382f24d40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a45fbc637da9251814352c97382f24d40">ast_dsp_digitreset</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:a45fbc637da9251814352c97382f24d40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset DTMF detector.  <a href="#a45fbc637da9251814352c97382f24d40">More...</a><br /></td></tr>
<tr class="separator:a45fbc637da9251814352c97382f24d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a57a1e374549eb2705068688f4046db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="separator:a0a57a1e374549eb2705068688f4046db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92238c472ae51a2926b51599108ab071"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a92238c472ae51a2926b51599108ab071">ast_dsp_get_features</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:a92238c472ae51a2926b51599108ab071"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get features.  <a href="#a92238c472ae51a2926b51599108ab071">More...</a><br /></td></tr>
<tr class="separator:a92238c472ae51a2926b51599108ab071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b2daa9b1bfbcbde7ce3f02417f694b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a78b2daa9b1bfbcbde7ce3f02417f694b">ast_dsp_get_sample_rate</a> (const struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:a78b2daa9b1bfbcbde7ce3f02417f694b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the sample rate this DSP structure was created with.  <a href="#a78b2daa9b1bfbcbde7ce3f02417f694b">More...</a><br /></td></tr>
<tr class="separator:a78b2daa9b1bfbcbde7ce3f02417f694b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5cfada9ab61cee75ac7d006e86d09d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0b5cfada9ab61cee75ac7d006e86d09d">ast_dsp_get_tcount</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:a0b5cfada9ab61cee75ac7d006e86d09d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get tcount (Threshold counter)  <a href="#a0b5cfada9ab61cee75ac7d006e86d09d">More...</a><br /></td></tr>
<tr class="separator:a0b5cfada9ab61cee75ac7d006e86d09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab28c68838eaed4e0c89460a4e554cca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aab28c68838eaed4e0c89460a4e554cca">ast_dsp_get_threshold_from_settings</a> (enum <a class="el" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a> which)</td></tr>
<tr class="memdesc:aab28c68838eaed4e0c89460a4e554cca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get silence threshold from dsp.conf.  <a href="#aab28c68838eaed4e0c89460a4e554cca">More...</a><br /></td></tr>
<tr class="separator:aab28c68838eaed4e0c89460a4e554cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accae19c5763ae43f0d5cf058f07d8d18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#accae19c5763ae43f0d5cf058f07d8d18">ast_dsp_get_tstate</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:accae19c5763ae43f0d5cf058f07d8d18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get tstate (Tone State)  <a href="#accae19c5763ae43f0d5cf058f07d8d18">More...</a><br /></td></tr>
<tr class="separator:accae19c5763ae43f0d5cf058f07d8d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a60e93006c8e1ca8fda922ae0e0da2c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a> (void)</td></tr>
<tr class="memdesc:a0a60e93006c8e1ca8fda922ae0e0da2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new dsp, assumes 8khz for internal sample rate.  <a href="#a0a60e93006c8e1ca8fda922ae0e0da2c">More...</a><br /></td></tr>
<tr class="separator:a0a60e93006c8e1ca8fda922ae0e0da2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc59fd6560e440699e6bb55aa101de93"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#adc59fd6560e440699e6bb55aa101de93">ast_dsp_new_with_rate</a> (unsigned int sample_rate)</td></tr>
<tr class="memdesc:adc59fd6560e440699e6bb55aa101de93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new dsp with a specific internal sample rate used during processing.  <a href="#adc59fd6560e440699e6bb55aa101de93">More...</a><br /></td></tr>
<tr class="separator:adc59fd6560e440699e6bb55aa101de93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5efca89c36180bbe497d83837167546"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ac5efca89c36180bbe497d83837167546">ast_dsp_noise</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *f, int *totalnoise)</td></tr>
<tr class="memdesc:ac5efca89c36180bbe497d83837167546"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the audio frame for noise.  <a href="#ac5efca89c36180bbe497d83837167546">More...</a><br /></td></tr>
<tr class="separator:ac5efca89c36180bbe497d83837167546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55ca4351805268c161127b00b533349"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa55ca4351805268c161127b00b533349">ast_dsp_process</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *af)</td></tr>
<tr class="memdesc:aa55ca4351805268c161127b00b533349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return AST_FRAME_NULL frames when there is silence, AST_FRAME_BUSY on busies, and call progress, all dependent upon which features are enabled.  <a href="#aa55ca4351805268c161127b00b533349">More...</a><br /></td></tr>
<tr class="separator:aa55ca4351805268c161127b00b533349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affdbf305e6266be1228a571fccf28c45"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#affdbf305e6266be1228a571fccf28c45">ast_dsp_prog_reset</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="separator:affdbf305e6266be1228a571fccf28c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673744da45e35463b6500a17c360bebe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a673744da45e35463b6500a17c360bebe">ast_dsp_reset</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:a673744da45e35463b6500a17c360bebe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset total silence count.  <a href="#a673744da45e35463b6500a17c360bebe">More...</a><br /></td></tr>
<tr class="separator:a673744da45e35463b6500a17c360bebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5088d241f0f7c6e3c82bacfb4a5099b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ae5088d241f0f7c6e3c82bacfb4a5099b">ast_dsp_set_busy_count</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int <a class="el" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a>)</td></tr>
<tr class="memdesc:ae5088d241f0f7c6e3c82bacfb4a5099b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of required cadences for busy.  <a href="#ae5088d241f0f7c6e3c82bacfb4a5099b">More...</a><br /></td></tr>
<tr class="separator:ae5088d241f0f7c6e3c82bacfb4a5099b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa7b2c7a6105d4d7d3a73930a087dd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a6fa7b2c7a6105d4d7d3a73930a087dd4">ast_dsp_set_busy_pattern</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, const struct <a class="el" href="../../d0/d5b/structast__dsp__busy__pattern.html">ast_dsp_busy_pattern</a> *cadence)</td></tr>
<tr class="memdesc:a6fa7b2c7a6105d4d7d3a73930a087dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set expected lengths of the busy tone.  <a href="#a6fa7b2c7a6105d4d7d3a73930a087dd4">More...</a><br /></td></tr>
<tr class="separator:a6fa7b2c7a6105d4d7d3a73930a087dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9912e8fcfc4d76058656934932af0b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#af9912e8fcfc4d76058656934932af0b1">ast_dsp_set_call_progress_zone</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, char *zone)</td></tr>
<tr class="memdesc:af9912e8fcfc4d76058656934932af0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set zone for doing progress detection.  <a href="#af9912e8fcfc4d76058656934932af0b1">More...</a><br /></td></tr>
<tr class="separator:af9912e8fcfc4d76058656934932af0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28ffa065bd46d09b5b06de2f77183b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa28ffa065bd46d09b5b06de2f77183b0">ast_dsp_set_digitmode</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int digitmode)</td></tr>
<tr class="memdesc:aa28ffa065bd46d09b5b06de2f77183b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set digit mode.  <a href="#aa28ffa065bd46d09b5b06de2f77183b0">More...</a><br /></td></tr>
<tr class="separator:aa28ffa065bd46d09b5b06de2f77183b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3cfa673380a4763168ce800db8b2f0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad3cfa673380a4763168ce800db8b2f0b">ast_dsp_set_faxmode</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int faxmode)</td></tr>
<tr class="memdesc:ad3cfa673380a4763168ce800db8b2f0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set fax mode.  <a href="#ad3cfa673380a4763168ce800db8b2f0b">More...</a><br /></td></tr>
<tr class="separator:ad3cfa673380a4763168ce800db8b2f0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc7fa20fba91e3c018f6989e95c714b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aedc7fa20fba91e3c018f6989e95c714b">ast_dsp_set_features</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int features)</td></tr>
<tr class="memdesc:aedc7fa20fba91e3c018f6989e95c714b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select feature set.  <a href="#aedc7fa20fba91e3c018f6989e95c714b">More...</a><br /></td></tr>
<tr class="separator:aedc7fa20fba91e3c018f6989e95c714b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae20416739a14507c5ddfc7aa98e7b136"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ae20416739a14507c5ddfc7aa98e7b136">ast_dsp_set_freqmode</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int freq, int dur, int <a class="el" href="../../d4/dd3/res__config__sqlite_8c.html#a082868565d651c0da1d2f0c194cb3248">db</a>, int squelch)</td></tr>
<tr class="memdesc:ae20416739a14507c5ddfc7aa98e7b136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set arbitrary frequency detection mode.  <a href="#ae20416739a14507c5ddfc7aa98e7b136">More...</a><br /></td></tr>
<tr class="separator:ae20416739a14507c5ddfc7aa98e7b136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a0b883127ba1f853e9e0fa5f29d81b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a06a0b883127ba1f853e9e0fa5f29d81b">ast_dsp_set_threshold</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int <a class="el" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a>)</td></tr>
<tr class="memdesc:a06a0b883127ba1f853e9e0fa5f29d81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the minimum average magnitude threshold to determine talking by the DSP.  <a href="#a06a0b883127ba1f853e9e0fa5f29d81b">More...</a><br /></td></tr>
<tr class="separator:a06a0b883127ba1f853e9e0fa5f29d81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3b67988bffb3addfbc8a4688fa466d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a3f3b67988bffb3addfbc8a4688fa466d">ast_dsp_silence</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *f, int *totalsilence)</td></tr>
<tr class="memdesc:a3f3b67988bffb3addfbc8a4688fa466d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the audio frame for silence.  <a href="#a3f3b67988bffb3addfbc8a4688fa466d">More...</a><br /></td></tr>
<tr class="separator:a3f3b67988bffb3addfbc8a4688fa466d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93f65e11fefc33db1f1c89824693c68"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *f, int *<a class="el" href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a>, int *frames_energy, int noise)</td></tr>
<tr class="separator:aa93f65e11fefc33db1f1c89824693c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584d2b608db31342bff90e53b52eda46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a584d2b608db31342bff90e53b52eda46">ast_dsp_silence_with_energy</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *f, int *totalsilence, int *frames_energy)</td></tr>
<tr class="memdesc:a584d2b608db31342bff90e53b52eda46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the audio frame for silence.  <a href="#a584d2b608db31342bff90e53b52eda46">More...</a><br /></td></tr>
<tr class="separator:a584d2b608db31342bff90e53b52eda46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6f146702ec253a6189176566527d30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ace6f146702ec253a6189176566527d30">ast_dsp_was_muted</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp)</td></tr>
<tr class="memdesc:ace6f146702ec253a6189176566527d30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if DSP code was muting any fragment of the last processed frame. Muting (squelching) happens when DSP code removes DTMF/MF/generic tones from the audio.  <a href="#ace6f146702ec253a6189176566527d30">More...</a><br /></td></tr>
<tr class="separator:ace6f146702ec253a6189176566527d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabeaa12abf1b4984df95f0dcd6d11556"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aabeaa12abf1b4984df95f0dcd6d11556">ast_dtmf_detect_init</a> (<a class="el" href="../../df/d42/structdtmf__detect__state__t.html">dtmf_detect_state_t</a> *s, unsigned int sample_rate)</td></tr>
<tr class="separator:aabeaa12abf1b4984df95f0dcd6d11556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504a394ff79bb1ebd4614f834e3b7dbe"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a504a394ff79bb1ebd4614f834e3b7dbe">ast_fax_detect_init</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *s)</td></tr>
<tr class="separator:a504a394ff79bb1ebd4614f834e3b7dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f3a1bd1e502a74a9630b3769d742a44"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a6f3a1bd1e502a74a9630b3769d742a44">ast_freq_detect_init</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *s, int freq, int dur, int <a class="el" href="../../d4/dd3/res__config__sqlite_8c.html#a082868565d651c0da1d2f0c194cb3248">db</a>, int squelch)</td></tr>
<tr class="separator:a6f3a1bd1e502a74a9630b3769d742a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00071c3dbca6a6de4ecc8e0e614b4da5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a00071c3dbca6a6de4ecc8e0e614b4da5">ast_mf_detect_init</a> (<a class="el" href="../../d5/d5b/structmf__detect__state__t.html">mf_detect_state_t</a> *s, unsigned int sample_rate)</td></tr>
<tr class="separator:a00071c3dbca6a6de4ecc8e0e614b4da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa35e0245ab713b259c5b43f07d635453"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa35e0245ab713b259c5b43f07d635453">AST_TEST_DEFINE</a> (test_dsp_fax_detect)</td></tr>
<tr class="separator:aa35e0245ab713b259c5b43f07d635453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2435c9e4b5da31fab47330e10d2925cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a2435c9e4b5da31fab47330e10d2925cd">AST_TEST_DEFINE</a> (test_dsp_dtmf_detect)</td></tr>
<tr class="separator:a2435c9e4b5da31fab47330e10d2925cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0be86964ca6f34d38c56724e317213"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a> (<a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *s, int freq, int duration, int amp, unsigned int sample_rate)</td></tr>
<tr class="separator:a0e0be86964ca6f34d38c56724e317213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25d091473980e52735b884cabe319ce"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *s, <a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> amp[], int samples, int squelch, int relax)</td></tr>
<tr class="separator:aa25d091473980e52735b884cabe319ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a334f9cc76595717181aae4bc088c3156"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a> (<a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *s, float freq, unsigned int sample_rate)</td></tr>
<tr class="separator:a334f9cc76595717181aae4bc088c3156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa823bf1feac16cc6fe3d06aad8b1262c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a> (<a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *s)</td></tr>
<tr class="separator:aa823bf1feac16cc6fe3d06aad8b1262c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fc3d2975c956b5981217215285e6bd"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a> (<a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *s)</td></tr>
<tr class="separator:a63fc3d2975c956b5981217215285e6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a84c56ff77f49a4a38c7dcb50134d61"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a> (<a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *s, short sample)</td></tr>
<tr class="separator:a8a84c56ff77f49a4a38c7dcb50134d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490046385646c599ef1b1983bd0f8c90"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a490046385646c599ef1b1983bd0f8c90">mf_detect</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *s, <a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> amp[], int samples, int squelch, int relax)</td></tr>
<tr class="separator:a490046385646c599ef1b1983bd0f8c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10feaebebf59c9371f2268ee984f364"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *fragment)</td></tr>
<tr class="separator:ab10feaebebf59c9371f2268ee984f364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dba54d7afec4002f759aa32fa7ce0be"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a> (float p1, float p2, float i1, float i2, float e)</td></tr>
<tr class="separator:a8dba54d7afec4002f759aa32fa7ce0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad394d2a22bef4aaab1e90a8a9921f41b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad394d2a22bef4aaab1e90a8a9921f41b">store_digit</a> (<a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *s, char <a class="el" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>)</td></tr>
<tr class="separator:ad394d2a22bef4aaab1e90a8a9921f41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49096094cdd2a9121cc0c246218840da"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a49096094cdd2a9121cc0c246218840da">test_dtmf_amplitude_sweep</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int digit_index)</td></tr>
<tr class="separator:a49096094cdd2a9121cc0c246218840da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a19cdc49481a2f4b171f490022b56a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ac9a19cdc49481a2f4b171f490022b56a">test_dtmf_twist_sweep</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, int digit_index)</td></tr>
<tr class="separator:ac9a19cdc49481a2f4b171f490022b56a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ad6d073b69b257fc653e0ba55844d9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#af9ad6d073b69b257fc653e0ba55844d9">test_dual_sample_gen</a> (short *slin_buf, int samples, int rate, int f1, short a1, int f2, short a2)</td></tr>
<tr class="separator:af9ad6d073b69b257fc653e0ba55844d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1608982b489c76a3f71b01517518454c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a1608982b489c76a3f71b01517518454c">test_tone_amplitude_sweep</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *tone_state)</td></tr>
<tr class="separator:a1608982b489c76a3f71b01517518454c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5322cba7f6f5757cdc6f2e4f91890d62"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *tone_state, short amplitude)</td></tr>
<tr class="separator:a5322cba7f6f5757cdc6f2e4f91890d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a549239eaec0a814839f116a7a33b0029"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a> (short *slin_buf, int samples, int rate, int freq, short amplitude)</td></tr>
<tr class="separator:a549239eaec0a814839f116a7a33b0029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89458575ad5ea64d6c46487a2c1a6b6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ac89458575ad5ea64d6c46487a2c1a6b6">test_tone_sample_gen_add</a> (short *slin_buf, int samples, int rate, int freq, short amplitude)</td></tr>
<tr class="separator:ac89458575ad5ea64d6c46487a2c1a6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a399ce184a63aad01299671419040ded7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a> (struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp, <a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *s, <a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> *amp, int samples)</td></tr>
<tr class="separator:a399ce184a63aad01299671419040ded7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;DSP&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .reload = reload_module, .load_pri = AST_MODPRI_CORE, .requires = &quot;extconfig&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83fee9a892df2842ec9d4560f5a65ed"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/dc3/structprogalias.html">progalias</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a> []</td></tr>
<tr class="separator:af83fee9a892df2842ec9d4560f5a65ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed69e4c904201b2dee62af600428e7c"><td class="memItemLeft" align="right" valign="top">static const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a4ed69e4c904201b2dee62af600428e7c">bell_mf_positions</a> [] = &quot;1247C-358A--69*---0B----#&quot;</td></tr>
<tr class="separator:a4ed69e4c904201b2dee62af600428e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20583928a48fd930b511ddbd722e6192"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a20583928a48fd930b511ddbd722e6192">DEFAULT_SILENCE_THRESHOLD</a> = 256</td></tr>
<tr class="memdesc:a20583928a48fd930b511ddbd722e6192"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default silence threshold we will use if an alternate configured value is not present or is invalid.  <a href="#a20583928a48fd930b511ddbd722e6192">More...</a><br /></td></tr>
<tr class="separator:a20583928a48fd930b511ddbd722e6192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add4d38fa22770d38c666f9b9361a1bee"><td class="memItemLeft" align="right" valign="top">static const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a> []</td></tr>
<tr class="separator:add4d38fa22770d38c666f9b9361a1bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc964f63482684acfd2937e981c678b7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a></td></tr>
<tr class="separator:abc964f63482684acfd2937e981c678b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba246381ba21cda471a8b4c5e81b48a5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a></td></tr>
<tr class="separator:aba246381ba21cda471a8b4c5e81b48a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec01db8127adabb95e443652f30963f2"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a></td></tr>
<tr class="separator:aec01db8127adabb95e443652f30963f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27699369d27243a453a74f24c1e0373b"><td class="memItemLeft" align="right" valign="top">static const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a> [] = &quot;123A&quot; &quot;456B&quot; &quot;789C&quot; &quot;*0#D&quot;</td></tr>
<tr class="separator:a27699369d27243a453a74f24c1e0373b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f8036cdc5c4dca199e2d123f333087"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a></td></tr>
<tr class="separator:a91f8036cdc5c4dca199e2d123f333087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89a046bbce1a7e6fc9ec15b88a22922c"><td class="memItemLeft" align="right" valign="top">static const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a> []</td></tr>
<tr class="separator:a89a046bbce1a7e6fc9ec15b88a22922c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a715aad7eb8bd2f4cd29197fc6b24a"><td class="memItemLeft" align="right" valign="top">static const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a91a715aad7eb8bd2f4cd29197fc6b24a">mf_tones</a> []</td></tr>
<tr class="separator:a91a715aad7eb8bd2f4cd29197fc6b24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa393efba8a1b3ccbb269e0ca7716f463"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d1/df7/structprogress.html">progress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a> []</td></tr>
<tr class="separator:aa393efba8a1b3ccbb269e0ca7716f463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2df3792a1bd43813423c43556bfe6b2"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a></td></tr>
<tr class="separator:ad2df3792a1bd43813423c43556bfe6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af097a604c6c8629d24ca1563a7c55160"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a></td></tr>
<tr class="separator:af097a604c6c8629d24ca1563a7c55160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0366c9d4146e4af0845b51e14744392e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a> [<a class="el" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfab7803c38447503d92bdcaaebddc19231">THRESHOLD_MAX</a>]</td></tr>
<tr class="separator:a0366c9d4146e4af0845b51e14744392e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Convenience Signal Processing routines. </p>
<dl class="section author"><dt>Author</dt><dd>Mark Spencer <a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ks'+'ter'+'@d'+'igi'+'um'+'.co'+'m'; return false;">marks<span style="display: none;">.nosp@m.</span>ter@<span style="display: none;">.nosp@m.</span>digiu<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a> </dd>
<dd>
Steve Underwood <a href="#" onclick="location.href='mai'+'lto:'+'ste'+'ve'+'u@c'+'op'+'pic'+'e.'+'org'; return false;">steve<span style="display: none;">.nosp@m.</span>u@co<span style="display: none;">.nosp@m.</span>ppice<span style="display: none;">.nosp@m.</span>.org</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1d14f26f0f1376d16a84ea7834f5be70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d14f26f0f1376d16a84ea7834f5be70">&#9670;&nbsp;</a></span>BELL_MF_RELATIVE_PEAK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BELL_MF_RELATIVE_PEAK&#160;&#160;&#160;12.6    /* 11dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00200">200</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>

</div>
</div>
<a id="a09cee9cae76ca825f6af9d9dedc25e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cee9cae76ca825f6af9d9dedc25e63">&#9670;&nbsp;</a></span>BELL_MF_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BELL_MF_THRESHOLD&#160;&#160;&#160;1.6e9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00198">198</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>

</div>
</div>
<a id="adb725f58c4d616aca44873f87a251ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb725f58c4d616aca44873f87a251ef6">&#9670;&nbsp;</a></span>BELL_MF_TWIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BELL_MF_TWIST&#160;&#160;&#160;4.0     /* 6dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00199">199</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>

</div>
</div>
<a id="a62921b92fa4fb37f1e3a5d4c644fc1d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62921b92fa4fb37f1e3a5d4c644fc1d8">&#9670;&nbsp;</a></span>CONFIG_FILE_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFIG_FILE_NAME&#160;&#160;&#160;&quot;dsp.conf&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00245">245</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="a0552d253f9f73129985cec46b262d35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0552d253f9f73129985cec46b262d35d">&#9670;&nbsp;</a></span>DEF_DTMF_HITS_TO_BEGIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_DTMF_HITS_TO_BEGIN&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00232">232</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="a1e784ed7d907009104317c4a61af3176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e784ed7d907009104317c4a61af3176">&#9670;&nbsp;</a></span>DEF_DTMF_MISSES_TO_END</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_DTMF_MISSES_TO_END&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00237">237</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="a5e9a3c55581aedf098446a36d09a1ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9a3c55581aedf098446a36d09a1ae6">&#9670;&nbsp;</a></span>DEF_DTMF_NORMAL_TWIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_DTMF_NORMAL_TWIST&#160;&#160;&#160;6.31	 /* 8.0dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00183">183</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a0d18e32bfd7abe1418c783bb559a2815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d18e32bfd7abe1418c783bb559a2815">&#9670;&nbsp;</a></span>DEF_DTMF_REVERSE_TWIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_DTMF_REVERSE_TWIST&#160;&#160;&#160;2.51	 /* 4.01dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00190">190</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a47b53428195fd14d7fb1277dee37797b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b53428195fd14d7fb1277dee37797b">&#9670;&nbsp;</a></span>DEF_RELAX_DTMF_NORMAL_TWIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_RELAX_DTMF_NORMAL_TWIST&#160;&#160;&#160;6.31	 /* 8.0dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00184">184</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="a8aeff17b5ac85fccc6c47e4f1b1acf28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aeff17b5ac85fccc6c47e4f1b1acf28">&#9670;&nbsp;</a></span>DEF_RELAX_DTMF_REVERSE_TWIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_RELAX_DTMF_REVERSE_TWIST&#160;&#160;&#160;3.98	 /* 6.0dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00191">191</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="abe9b1c28165a7071e354bd9d7823ca1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe9b1c28165a7071e354bd9d7823ca1a">&#9670;&nbsp;</a></span>DEFAULT_SAMPLE_RATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_SAMPLE_RATE&#160;&#160;&#160;8000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">221</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02274">test_tone_freq_sweep()</a>.</p>

</div>
</div>
<a id="a0c8005141291a96e10c9c9efe02263e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c8005141291a96e10c9c9efe02263e8">&#9670;&nbsp;</a></span>DEFAULT_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_THRESHOLD&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default minimum average magnitude threshold to determine talking/noise by the DSP. </p>
<p>The magnitude calculated for this threshold is determined by averaging the absolute value of all samples within a frame.</p>
<p>This value is the threshold for which a frame's average magnitude is determined to either be silence (below the threshold) or noise/talking (at or above the threshold). Please note that while the default threshold is an even exponent of 2, there is no requirement that it be so. The threshold will work for any value between 1 and 2^15. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00140">140</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>.</p>

</div>
</div>
<a id="ab32788a6894e4f84d7c49ce6a2b4bd10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab32788a6894e4f84d7c49ce6a2b4bd10">&#9670;&nbsp;</a></span>DSP_HISTORY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DSP_HISTORY&#160;&#160;&#160;15</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remember last 15 units </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00151">151</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01229">__ast_dsp_silence_noise()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01295">ast_dsp_busydetect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01780">ast_dsp_set_busy_count()</a>.</p>

</div>
</div>
<a id="a7f207b5f13316dc0495304ee5b5d923c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f207b5f13316dc0495304ee5b5d923c">&#9670;&nbsp;</a></span>DTMF_GSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTMF_GSIZE&#160;&#160;&#160;102</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00227">227</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a7d287bf752cc52501e908920bdeda015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d287bf752cc52501e908920bdeda015">&#9670;&nbsp;</a></span>DTMF_RELATIVE_PEAK_COL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTMF_RELATIVE_PEAK_COL&#160;&#160;&#160;6.3     /* 8dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00195">195</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="ab2849942f55808d209a04916de88c6bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2849942f55808d209a04916de88c6bb">&#9670;&nbsp;</a></span>DTMF_RELATIVE_PEAK_ROW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTMF_RELATIVE_PEAK_ROW&#160;&#160;&#160;6.3     /* 8dB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00194">194</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="a4dfb0e44eab6c69bc0e2573adb252d1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dfb0e44eab6c69bc0e2573adb252d1c">&#9670;&nbsp;</a></span>DTMF_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTMF_THRESHOLD&#160;&#160;&#160;8.0e7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00180">180</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="a17557ece45a1ac2458c2a109ea80d84e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17557ece45a1ac2458c2a109ea80d84e">&#9670;&nbsp;</a></span>DTMF_TO_TOTAL_ENERGY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTMF_TO_TOTAL_ENERGY&#160;&#160;&#160;42.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00196">196</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="a1041464c0ba1ad755a0da7b9b9119233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1041464c0ba1ad755a0da7b9b9119233">&#9670;&nbsp;</a></span>FAX_TONE_CED_DB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CED_DB&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00219">219</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="a4c2ad645ef024b1f21f5a3e05e07eb24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2ad645ef024b1f21f5a3e05e07eb24">&#9670;&nbsp;</a></span>FAX_TONE_CED_DURATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CED_DURATION&#160;&#160;&#160;2600	/* ms */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00218">218</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="a7c57bc0b17a606cdf143de3f59099b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c57bc0b17a606cdf143de3f59099b1a">&#9670;&nbsp;</a></span>FAX_TONE_CED_FREQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CED_FREQ&#160;&#160;&#160;2100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00217">217</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="a66baf787112a461a2e46fbb4352baa8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66baf787112a461a2e46fbb4352baa8f">&#9670;&nbsp;</a></span>FAX_TONE_CNG_DB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CNG_DB&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00211">211</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="adea655fc91152db6b182f17a212d6c87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea655fc91152db6b182f17a212d6c87">&#9670;&nbsp;</a></span>FAX_TONE_CNG_DURATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CNG_DURATION&#160;&#160;&#160;500	/* ms */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00210">210</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="a3ff20bb46c00387fe18ff35c859f8b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ff20bb46c00387fe18ff35c859f8b7d">&#9670;&nbsp;</a></span>FAX_TONE_CNG_FREQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAX_TONE_CNG_FREQ&#160;&#160;&#160;1100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00209">209</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>.</p>

</div>
</div>
<a id="ab0a3ea6e2a2c890d2ce0228327c877a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0a3ea6e2a2c890d2ce0228327c877a7">&#9670;&nbsp;</a></span>FREQ_ARRAY_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREQ_ARRAY_SIZE&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00115">115</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">ast_dsp_prog_reset()</a>.</p>

</div>
</div>
<a id="a5313700220195d4510860845d12d0523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5313700220195d4510860845d12d0523">&#9670;&nbsp;</a></span>MAX_DTMF_DIGITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DTMF_DIGITS&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00166">166</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00680">store_digit()</a>.</p>

</div>
</div>
<a id="add921b6e54e9697d62fbfc0137efb0fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add921b6e54e9697d62fbfc0137efb0fb">&#9670;&nbsp;</a></span>MF_GSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MF_GSIZE&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00224">224</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>

</div>
</div>
<a id="a48060c65aa5909df6326d08ed76a692f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48060c65aa5909df6326d08ed76a692f">&#9670;&nbsp;</a></span>TONE_AMPLITUDE_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TONE_AMPLITUDE_MAX&#160;&#160;&#160;0x7fff	/* Max signed linear amplitude */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02034">2034</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>.</p>

</div>
</div>
<a id="ab6a9990b37515687259bf26d889df2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a9990b37515687259bf26d889df2ed">&#9670;&nbsp;</a></span>TONE_AMPLITUDE_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TONE_AMPLITUDE_MIN&#160;&#160;&#160;80		/* Min signed linear amplitude detectable */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02035">2035</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>.</p>

</div>
</div>
<a id="a4e159009069d203ae2301aa5cdeb480c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e159009069d203ae2301aa5cdeb480c">&#9670;&nbsp;</a></span>TONE_MIN_THRESH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TONE_MIN_THRESH&#160;&#160;&#160;1e8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How much tone there should be at least to attempt </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00154">154</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01051">pair_there()</a>.</p>

</div>
</div>
<a id="afe56d06c4edb3c8d3bb76cc877e7e07e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe56d06c4edb3c8d3bb76cc877e7e07e">&#9670;&nbsp;</a></span>TONE_THRESH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TONE_THRESH&#160;&#160;&#160;10.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How much louder the tone should be than channel energy </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00153">153</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01051">pair_there()</a>.</p>

</div>
</div>
<a id="a9e4ea1c9c1bcb353473655b068c4ca76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e4ea1c9c1bcb353473655b068c4ca76">&#9670;&nbsp;</a></span>TONE_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TONE_THRESHOLD&#160;&#160;&#160;7.8e7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00181">181</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a9fb2e530706d025a0d33063363a8ac8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb2e530706d025a0d33063363a8ac8a">&#9670;&nbsp;</a></span>busy_detect</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8a">busy_detect</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5"></a>BUSY_PERCENT&#160;</td><td class="fielddoc"><p>The percentage difference between the two last silence periods </p>
</td></tr>
<tr><td class="fieldname"><a id="a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f"></a>BUSY_PAT_PERCENT&#160;</td><td class="fielddoc"><p>The percentage difference between measured and actual pattern </p>
</td></tr>
<tr><td class="fieldname"><a id="a9fb2e530706d025a0d33063363a8ac8aaea71a835c8ec79b55ad9ac2a51ada2d4"></a>BUSY_THRESHOLD&#160;</td><td class="fielddoc"><p>Max number of ms difference between max and min times in busy </p>
</td></tr>
<tr><td class="fieldname"><a id="a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40"></a>BUSY_MIN&#160;</td><td class="fielddoc"><p>Busy must be at least 80 ms in half-cadence </p>
</td></tr>
<tr><td class="fieldname"><a id="a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5"></a>BUSY_MAX&#160;</td><td class="fielddoc"><p>Busy can't be longer than 3100 ms in half-cadence </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00142">142</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> = 10,   <span class="comment">/*!&lt; The percentage difference between the two last silence periods */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a> = 7,   <span class="comment">/*!&lt; The percentage difference between measured and actual pattern */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aaea71a835c8ec79b55ad9ac2a51ada2d4">BUSY_THRESHOLD</a> = 100,   <span class="comment">/*!&lt; Max number of ms difference between max and min times in busy */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a> = 75,    <span class="comment">/*!&lt; Busy must be at least 80 ms in half-cadence */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a> = 3100      <span class="comment">/*!&lt; Busy can&#39;t be longer than 3100 ms in half-cadence */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;};</div><div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00147">dsp.c:147</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00146">dsp.c:146</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00143">dsp.c:143</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aaea71a835c8ec79b55ad9ac2a51ada2d4"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aaea71a835c8ec79b55ad9ac2a51ada2d4">BUSY_THRESHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00145">dsp.c:145</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00144">dsp.c:144</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5520400b2835c739f9cc1abea9390c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5520400b2835c739f9cc1abea9390c3">&#9670;&nbsp;</a></span>freq_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3">freq_index</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef"></a>HZ_350&#160;</td><td class="fielddoc"><p>For US modes { </p>
</td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972"></a>HZ_440&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552"></a>HZ_480&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301"></a>HZ_620&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492"></a>HZ_950&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173"></a>HZ_1400&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa"></a>HZ_1800&#160;</td><td class="fielddoc"><p>} </p>
</td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc"></a>HZ_425&#160;</td><td class="fielddoc"><p>For CR/BR modes </p>
</td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd"></a>HZ_350UK&#160;</td><td class="fielddoc"><p>For UK mode </p>
</td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f"></a>HZ_400UK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450"></a>HZ_440UK&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00085">85</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                {<span class="comment"></span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">   /*! For US modes { */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef">HZ_350</a> = 0,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972">HZ_440</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552">HZ_480</a>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301">HZ_620</a>,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492">HZ_950</a>,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173">HZ_1400</a>,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa">HZ_1800</a>, <span class="comment">/*!&lt; } */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">   /*! For CR/BR modes */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc">HZ_425</a> = 0,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">   /*! For UK mode */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd">HZ_350UK</a> = 0,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a>,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450">HZ_440UK</a></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;};</div><div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc">HZ_425</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00096">dsp.c:96</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450">HZ_440UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00101">dsp.c:101</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972">HZ_440</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00088">dsp.c:88</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301">HZ_620</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00090">dsp.c:90</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd">HZ_350UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00099">dsp.c:99</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173">HZ_1400</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00092">dsp.c:92</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef">HZ_350</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00087">dsp.c:87</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492">HZ_950</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00091">dsp.c:91</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa">HZ_1800</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00093">dsp.c:93</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552">HZ_480</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00089">dsp.c:89</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00100">dsp.c:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa23c853bfc745be9b034a9add00498c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa23c853bfc745be9b034a9add00498c">&#9670;&nbsp;</a></span>gsamp_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498c">gsamp_size</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of goertzels for progress detect </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec"></a>GSAMP_SIZE_NA&#160;</td><td class="fielddoc"><p>North America - 350, 440, 480, 620, 950, 1400, 1800 Hz </p>
</td></tr>
<tr><td class="fieldname"><a id="aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3"></a>GSAMP_SIZE_CR&#160;</td><td class="fielddoc"><p>Costa Rica, Brazil - Only care about 425 Hz </p>
</td></tr>
<tr><td class="fieldname"><a id="aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc"></a>GSAMP_SIZE_UK&#160;</td><td class="fielddoc"><p>UK disconnect goertzel feed - should trigger 400hz </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00073">73</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec">GSAMP_SIZE_NA</a> = 183,       <span class="comment">/*!&lt; North America - 350, 440, 480, 620, 950, 1400, 1800 Hz */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3">GSAMP_SIZE_CR</a> = 188,       <span class="comment">/*!&lt; Costa Rica, Brazil - Only care about 425 Hz */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc">GSAMP_SIZE_UK</a> = 160        <span class="comment">/*!&lt; UK disconnect goertzel feed - should trigger 400hz */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;};</div><div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3">GSAMP_SIZE_CR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00075">dsp.c:75</a></div></div>
<div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc">GSAMP_SIZE_UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00076">dsp.c:76</a></div></div>
<div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec">GSAMP_SIZE_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00074">dsp.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e1f18b87b40baa3d655339bb0d6ffc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e1f18b87b40baa3d655339bb0d6ffc1">&#9670;&nbsp;</a></span>gsamp_thresh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1">gsamp_thresh</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>All THRESH_XXX values are in GSAMP_SIZE chunks (us = 22ms) </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650"></a>THRESH_RING&#160;</td><td class="fielddoc"><p>Need at least 150ms ring to accept </p>
</td></tr>
<tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948"></a>THRESH_TALK&#160;</td><td class="fielddoc"><p>Talk detection does not work continuously </p>
</td></tr>
<tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a"></a>THRESH_BUSY&#160;</td><td class="fielddoc"><p>Need at least 80ms to accept </p>
</td></tr>
<tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147"></a>THRESH_CONGESTION&#160;</td><td class="fielddoc"><p>Need at least 80ms to accept </p>
</td></tr>
<tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069"></a>THRESH_HANGUP&#160;</td><td class="fielddoc"><p>Need at least 1300ms to accept hangup </p>
</td></tr>
<tr><td class="fieldname"><a id="a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251"></a>THRESH_RING2ANSWER&#160;</td><td class="fielddoc"><p>Timeout from start of ring to answer (about 6600 ms) </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00157">157</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                  {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650">THRESH_RING</a> = 8,     <span class="comment">/*!&lt; Need at least 150ms ring to accept */</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948">THRESH_TALK</a> = 2,     <span class="comment">/*!&lt; Talk detection does not work continuously */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a">THRESH_BUSY</a> = 4,     <span class="comment">/*!&lt; Need at least 80ms to accept */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147">THRESH_CONGESTION</a> = 4,     <span class="comment">/*!&lt; Need at least 80ms to accept */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069">THRESH_HANGUP</a> = 60,     <span class="comment">/*!&lt; Need at least 1300ms to accept hangup */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251">THRESH_RING2ANSWER</a> = 300   <span class="comment">/*!&lt; Timeout from start of ring to answer (about 6600 ms) */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;};</div><div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650">THRESH_RING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00158">dsp.c:158</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948">THRESH_TALK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00159">dsp.c:159</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147">THRESH_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00161">dsp.c:161</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251">THRESH_RING2ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00163">dsp.c:163</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069">THRESH_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00162">dsp.c:162</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a">THRESH_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00160">dsp.c:160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa078934b418fbdf95ad0e79e528cf826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa078934b418fbdf95ad0e79e528cf826">&#9670;&nbsp;</a></span>prog_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826">prog_mode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0"></a>PROG_MODE_NA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee"></a>PROG_MODE_CR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445"></a>PROG_MODE_UK&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00079">79</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;               {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0">PROG_MODE_NA</a> = 0,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee">PROG_MODE_CR</a>,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445">PROG_MODE_UK</a></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;};</div><div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445">PROG_MODE_UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00082">dsp.c:82</a></div></div>
<div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee">PROG_MODE_CR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00081">dsp.c:81</a></div></div>
<div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0">PROG_MODE_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00080">dsp.c:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a309197e46487283dfa6c7614a3e3d1f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a309197e46487283dfa6c7614a3e3d1f9">&#9670;&nbsp;</a></span>__ast_dsp_call_progress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __ast_dsp_call_progress </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">1074</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">AST_CONTROL_ANSWER</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">AST_CONTROL_BUSY</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">AST_CONTROL_CONGESTION</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">AST_CONTROL_HANGUP</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">AST_CONTROL_RINGING</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00043">DSP_FEATURE_CALL_PROGRESS</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00041">DSP_PROGRESS_BUSY</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00042">DSP_PROGRESS_CONGESTION</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00040">DSP_PROGRESS_RINGING</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00039">DSP_PROGRESS_TALK</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00056">DSP_TONE_STATE_BUSY</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00054">DSP_TONE_STATE_DIALTONE</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00060">DSP_TONE_STATE_HUNGUP</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00053">DSP_TONE_STATE_RINGING</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00052">DSP_TONE_STATE_SILENCE</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00057">DSP_TONE_STATE_SPECIAL1</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00058">DSP_TONE_STATE_SPECIAL2</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00059">DSP_TONE_STATE_SPECIAL3</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00055">DSP_TONE_STATE_TALKING</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00412">ast_dsp::features</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00115">FREQ_ARRAY_SIZE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00420">ast_dsp::freqcount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00419">ast_dsp::freqs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00431">ast_dsp::genergy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00362">goertzel_result()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00336">goertzel_sample()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00422">ast_dsp::gsamp_size</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00421">ast_dsp::gsamps</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00092">HZ_1400</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00093">HZ_1800</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00087">HZ_350</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00099">HZ_350UK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00100">HZ_400UK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00096">HZ_425</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00088">HZ_440</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00101">HZ_440UK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00089">HZ_480</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00090">HZ_620</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00091">HZ_950</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01051">pair_there()</a>, <a class="el" href="../../dc/d12/res__config__ldap_8c_source.html#l00076">pass</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00081">PROG_MODE_CR</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00080">PROG_MODE_NA</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00082">PROG_MODE_UK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00423">ast_dsp::progmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00413">ast_dsp::ringtimeout</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00425">ast_dsp::tcount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00160">THRESH_BUSY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00161">THRESH_CONGESTION</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00162">THRESH_HANGUP</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00158">THRESH_RING</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00163">THRESH_RING2ANSWER</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00159">THRESH_TALK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00154">TONE_MIN_THRESH</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00153">TONE_THRESH</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00424">ast_dsp::tstate</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01216">ast_dsp_call_progress()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <span class="keywordtype">short</span> samp;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <span class="keywordtype">int</span> y;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   <span class="keywordtype">int</span> newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a3d3e74ee4ce09143367f282416532a8a">DSP_TONE_STATE_SILENCE</a>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <span class="keywordtype">int</span> freqcount = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">freqcount</a> &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a> ? <a class="code" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a> : dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">freqcount</a>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <span class="keywordflow">while</span> (<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">/* Take the lesser of the number of samples we need and what we have */</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      pass = <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">if</span> (pass &gt; dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">gsamp_size</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a>) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         pass = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">gsamp_size</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a>; x++) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         samp = s[x];</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a> += (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp * (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;         <span class="keywordflow">for</span> (y = 0; y &lt; freqcount; y++) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[y], samp);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;         }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      s += <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a> += <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> -= <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a> == dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">gsamp_size</a>) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         <span class="keywordtype">float</span> hz[<a class="code" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a>];</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;         <span class="keywordflow">for</span> (y = 0; y &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a>; y++) {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            hz[y] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[y]);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;         <span class="keywordflow">switch</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a>) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0">PROG_MODE_NA</a>:</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a>(hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552">HZ_480</a>], hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301">HZ_620</a>], hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef">HZ_350</a>], hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972">HZ_440</a>], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a>)) {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a6a2d15a82b53bebc4a233831fd8b2469">DSP_TONE_STATE_BUSY</a>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a>(hz[HZ_440], hz[HZ_480], hz[HZ_350], hz[HZ_620], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a>)) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#ad2b35b81126d95bb62e32d66ec15d907">DSP_TONE_STATE_RINGING</a>;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a>(hz[HZ_350], hz[HZ_440], hz[HZ_480], hz[HZ_620], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a>)) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a2aa4a8185d14eb917c5c1fd498b234d6">DSP_TONE_STATE_DIALTONE</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492">HZ_950</a>] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * <a class="code" href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a>) {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a9801c31d7afb7271e894b47d8d78355c">DSP_TONE_STATE_SPECIAL1</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173">HZ_1400</a>] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;               <span class="comment">/* End of SPECIAL1 or middle of SPECIAL2 */</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;               <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a> == <a class="code" href="../../d3/d08/dsp_8h.html#a9801c31d7afb7271e894b47d8d78355c">DSP_TONE_STATE_SPECIAL1</a> || dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a> == <a class="code" href="../../d3/d08/dsp_8h.html#a20f8dce7565474d6a0e5e126c9c2354f">DSP_TONE_STATE_SPECIAL2</a>) {</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                  newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a20f8dce7565474d6a0e5e126c9c2354f">DSP_TONE_STATE_SPECIAL2</a>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;               }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa">HZ_1800</a>] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;               <span class="comment">/* End of SPECIAL2 or middle of SPECIAL3 */</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;               <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a> == <a class="code" href="../../d3/d08/dsp_8h.html#a20f8dce7565474d6a0e5e126c9c2354f">DSP_TONE_STATE_SPECIAL2</a> || dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a> == <a class="code" href="../../d3/d08/dsp_8h.html#a198fb3e9530aa0497a16a98cf9d20016">DSP_TONE_STATE_SPECIAL3</a>) {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                  newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a198fb3e9530aa0497a16a98cf9d20016">DSP_TONE_STATE_SPECIAL3</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;               }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a> &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#ac38adabe9708c6b5d64d074fbd7679a1">DSP_TONE_STATE_TALKING</a>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a3d3e74ee4ce09143367f282416532a8a">DSP_TONE_STATE_SILENCE</a>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            }</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee">PROG_MODE_CR</a>:</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="keywordflow">if</span> (hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc">HZ_425</a>] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#ad2b35b81126d95bb62e32d66ec15d907">DSP_TONE_STATE_RINGING</a>;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a> &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#ac38adabe9708c6b5d64d074fbd7679a1">DSP_TONE_STATE_TALKING</a>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a3d3e74ee4ce09143367f282416532a8a">DSP_TONE_STATE_SILENCE</a>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            }</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445">PROG_MODE_UK</a>:</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keywordflow">if</span> (hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a>] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a> * TONE_THRESH) {</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#ab7fa94945ad3c54830a2c54ce377df5c">DSP_TONE_STATE_HUNGUP</a>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a>(hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd">HZ_350UK</a>], hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450">HZ_440UK</a>], hz[<a class="code" href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a>], hz[HZ_400UK], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a>)) {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;               newstate = <a class="code" href="../../d3/d08/dsp_8h.html#a2aa4a8185d14eb917c5c1fd498b234d6">DSP_TONE_STATE_DIALTONE</a>;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t process in unknown prog mode &#39;%u&#39;\n&quot;</span>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a>);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;         }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;         <span class="keywordflow">if</span> (newstate == dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a>) {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a>++;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a>) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a>++;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keywordflow">switch</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a>) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d3/d08/dsp_8h.html#ad2b35b81126d95bb62e32d66ec15d907">DSP_TONE_STATE_RINGING</a>:</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;               <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a16d17271711ea378f25fbb6b46f5aa05">DSP_PROGRESS_RINGING</a>) &amp;&amp;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                   (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650">THRESH_RING</a>)) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                  res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                  dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a> = 1;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;               }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d3/d08/dsp_8h.html#a6a2d15a82b53bebc4a233831fd8b2469">DSP_TONE_STATE_BUSY</a>:</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;               <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a8d6f6052e448286a7c431a18fc257027">DSP_PROGRESS_BUSY</a>) &amp;&amp;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                   (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a">THRESH_BUSY</a>)) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                  res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                  dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp;= ~<a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;               }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d3/d08/dsp_8h.html#ac38adabe9708c6b5d64d074fbd7679a1">DSP_TONE_STATE_TALKING</a>:</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;               <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a3096d3630e21aecb4f12942a1f6361f6">DSP_PROGRESS_TALK</a>) &amp;&amp;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                   (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948">THRESH_TALK</a>)) {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                  res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                  dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp;= ~<a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;               }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d3/d08/dsp_8h.html#a198fb3e9530aa0497a16a98cf9d20016">DSP_TONE_STATE_SPECIAL3</a>:</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;               <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#aa0e79afce1894ffd75851c1e192d00ae">DSP_PROGRESS_CONGESTION</a>) &amp;&amp;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                   (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147">THRESH_CONGESTION</a>)) {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                  res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                  dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp;= ~<a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;               }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d3/d08/dsp_8h.html#ab7fa94945ad3c54830a2c54ce377df5c">DSP_TONE_STATE_HUNGUP</a>:</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;               <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>) &amp;&amp;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                   (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069">THRESH_HANGUP</a>)) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                  res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                  dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp;= ~<a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;               }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251">THRESH_RING2ANSWER</a>) {</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Consider call as answered because of timeout after last ring\n&quot;</span>);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;               res = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp;= ~<a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Stop state %d with duration %d\n&quot;</span>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Start state %d\n&quot;</span>, newstate);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a> = newstate;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a> = 1;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         <span class="comment">/* Reset goertzel */</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;         <span class="keywordflow">for</span> (x = 0; x &lt; 7; x++) {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[x].<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[x].<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = 0.0;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;         }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a> = 0;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">genergy</a> = 0.0;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   }</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;}</div><div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a3273548b474bb7033155d932e284b650">THRESH_RING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00158">dsp.c:158</a></div></div>
<div class="ttc" id="res__config__ldap_8c_html_a52388ec12a45b52ff62aaf3dfccd0cd5"><div class="ttname"><a href="../../dc/d12/res__config__ldap_8c.html#a52388ec12a45b52ff62aaf3dfccd0cd5">pass</a></div><div class="ttdeci">static char pass[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d12/res__config__ldap_8c_source.html#l00076">res_config_ldap.c:76</a></div></div>
<div class="ttc" id="dsp_8h_html_a16d17271711ea378f25fbb6b46f5aa05"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a16d17271711ea378f25fbb6b46f5aa05">DSP_PROGRESS_RINGING</a></div><div class="ttdeci">#define DSP_PROGRESS_RINGING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00040">dsp.h:40</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ab528db69a7fc29e230b92b16b206b948">THRESH_TALK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00159">dsp.c:159</a></div></div>
<div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1ec7dac8449f6ca4403b26295050d445">PROG_MODE_UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00082">dsp.c:82</a></div></div>
<div class="ttc" id="structast__dsp_html_abf65d5fad439d47cca94d7e6e889df16"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#abf65d5fad439d47cca94d7e6e889df16">ast_dsp::genergy</a></div><div class="ttdeci">float genergy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00431">dsp.c:431</a></div></div>
<div class="ttc" id="dsp_8h_html_ab7fa94945ad3c54830a2c54ce377df5c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#ab7fa94945ad3c54830a2c54ce377df5c">DSP_TONE_STATE_HUNGUP</a></div><div class="ttdeci">#define DSP_TONE_STATE_HUNGUP</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00060">dsp.h:60</a></div></div>
<div class="ttc" id="structast__dsp_html_a42e47b1321fa8ce991a016a17b1c2db2"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">ast_dsp::freqs</a></div><div class="ttdeci">goertzel_state_t freqs[FREQ_ARRAY_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00419">dsp.c:419</a></div></div>
<div class="ttc" id="dsp_8h_html_a8d6f6052e448286a7c431a18fc257027"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a8d6f6052e448286a7c431a18fc257027">DSP_PROGRESS_BUSY</a></div><div class="ttdeci">#define DSP_PROGRESS_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00041">dsp.h:41</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a11da18202314588d8bee11a8a3e901fc">HZ_425</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00096">dsp.c:96</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a751066fa2bdb86085efc8abc70cb3450">HZ_440UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00101">dsp.c:101</a></div></div>
<div class="ttc" id="dsp_8h_html_a3096d3630e21aecb4f12942a1f6361f6"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a3096d3630e21aecb4f12942a1f6361f6">DSP_PROGRESS_TALK</a></div><div class="ttdeci">#define DSP_PROGRESS_TALK</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00039">dsp.h:39</a></div></div>
<div class="ttc" id="dsp_8h_html_aa21ad1de4ef65e04563f6283a2213e25"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a></div><div class="ttdeci">#define DSP_FEATURE_CALL_PROGRESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00043">dsp.h:43</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a5abfa947cc4978a7b5346332fe80a972">HZ_440</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00088">dsp.c:88</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="dsp_8h_html_a2aa4a8185d14eb917c5c1fd498b234d6"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a2aa4a8185d14eb917c5c1fd498b234d6">DSP_TONE_STATE_DIALTONE</a></div><div class="ttdeci">#define DSP_TONE_STATE_DIALTONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00054">dsp.h:54</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1a9c54889c329088ac2966aa9da5073147">THRESH_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00161">dsp.c:161</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a4affdb885e3e40e4e59d6605bacc0301">HZ_620</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00090">dsp.c:90</a></div></div>
<div class="ttc" id="dsp_8h_html_aa0e79afce1894ffd75851c1e192d00ae"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa0e79afce1894ffd75851c1e192d00ae">DSP_PROGRESS_CONGESTION</a></div><div class="ttdeci">#define DSP_PROGRESS_CONGESTION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00042">dsp.h:42</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">include/asterisk/frame.h:282</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1aaa2f1187dbc87423ea061e824df6c251">THRESH_RING2ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00163">dsp.c:163</a></div></div>
<div class="ttc" id="dsp_8h_html_ac38adabe9708c6b5d64d074fbd7679a1"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#ac38adabe9708c6b5d64d074fbd7679a1">DSP_TONE_STATE_TALKING</a></div><div class="ttdeci">#define DSP_TONE_STATE_TALKING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00055">dsp.h:55</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1ad8cb56abce7f3f2bc51e65cb45d80069">THRESH_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00162">dsp.c:162</a></div></div>
<div class="ttc" id="dsp_8c_html_afe56d06c4edb3c8d3bb76cc877e7e07e"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a></div><div class="ttdeci">#define TONE_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00153">dsp.c:153</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a46c77430f0e09ac69dce8e4e397451fd">HZ_350UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00099">dsp.c:99</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ac8830680f5b830b3b7c4d500ff032173">HZ_1400</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00092">dsp.c:92</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="dsp_8h_html_a20f8dce7565474d6a0e5e126c9c2354f"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a20f8dce7565474d6a0e5e126c9c2354f">DSP_TONE_STATE_SPECIAL2</a></div><div class="ttdeci">#define DSP_TONE_STATE_SPECIAL2</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00058">dsp.h:58</a></div></div>
<div class="ttc" id="structast__dsp_html_ab3381c0c9d9a71fb64ac238593c98d7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">ast_dsp::gsamp_size</a></div><div class="ttdeci">enum gsamp_size gsamp_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00422">dsp.c:422</a></div></div>
<div class="ttc" id="dsp_8h_html_ad2b35b81126d95bb62e32d66ec15d907"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#ad2b35b81126d95bb62e32d66ec15d907">DSP_TONE_STATE_RINGING</a></div><div class="ttdeci">#define DSP_TONE_STATE_RINGING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00053">dsp.h:53</a></div></div>
<div class="ttc" id="dsp_8h_html_a6a2d15a82b53bebc4a233831fd8b2469"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a6a2d15a82b53bebc4a233831fd8b2469">DSP_TONE_STATE_BUSY</a></div><div class="ttdeci">#define DSP_TONE_STATE_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00056">dsp.h:56</a></div></div>
<div class="ttc" id="structast__dsp_html_a90920c61c3569534bc6411f978552d80"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">ast_dsp::freqcount</a></div><div class="ttdeci">int freqcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00420">dsp.c:420</a></div></div>
<div class="ttc" id="dsp_8h_html_a198fb3e9530aa0497a16a98cf9d20016"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a198fb3e9530aa0497a16a98cf9d20016">DSP_TONE_STATE_SPECIAL3</a></div><div class="ttdeci">#define DSP_TONE_STATE_SPECIAL3</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00059">dsp.h:59</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3abaffe17db7dd42d15b2e8857e562b8ef">HZ_350</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00087">dsp.c:87</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e1f18b87b40baa3d655339bb0d6ffc1afb4abaa9fb453273d480eca5b2a9340a">THRESH_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00160">dsp.c:160</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">include/asterisk/frame.h:278</a></div></div>
<div class="ttc" id="dsp_8h_html_a9801c31d7afb7271e894b47d8d78355c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a9801c31d7afb7271e894b47d8d78355c">DSP_TONE_STATE_SPECIAL1</a></div><div class="ttdeci">#define DSP_TONE_STATE_SPECIAL1</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00057">dsp.h:57</a></div></div>
<div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826a1c406f6c5b397da459d8771e8bb486ee">PROG_MODE_CR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00081">dsp.c:81</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3a237728fd41a11290c036fa83d0f51492">HZ_950</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00091">dsp.c:91</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3afba965ec9e4aa5b90bf97507f70f77aa">HZ_1800</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00093">dsp.c:93</a></div></div>
<div class="ttc" id="structast__dsp_html_a09467367454312afdf090ec7d63cb8b3"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">ast_dsp::tcount</a></div><div class="ttdeci">int tcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00425">dsp.c:425</a></div></div>
<div class="ttc" id="dsp_8c_html_a4e159009069d203ae2301aa5cdeb480c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a></div><div class="ttdeci">#define TONE_MIN_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00154">dsp.c:154</a></div></div>
<div class="ttc" id="structast__dsp_html_aca9840ebe7075b9e09a9b8e6546d987f"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">ast_dsp::gsamps</a></div><div class="ttdeci">int gsamps</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00421">dsp.c:421</a></div></div>
<div class="ttc" id="structast__dsp_html_a95d087aa0676d2cbc3e25cdd045311f7"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">ast_dsp::features</a></div><div class="ttdeci">int features</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00412">dsp.c:412</a></div></div>
<div class="ttc" id="dsp_8c_html_aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa078934b418fbdf95ad0e79e528cf826af50e9076f0beac22e26fb788869b61a0">PROG_MODE_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00080">dsp.c:80</a></div></div>
<div class="ttc" id="dsp_8c_html_a8a84c56ff77f49a4a38c7dcb50134d61"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a></div><div class="ttdeci">static void goertzel_sample(goertzel_state_t *s, short sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00336">dsp.c:336</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3aa6212cb04499b9812b8aedde7a6bc552">HZ_480</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00089">dsp.c:89</a></div></div>
<div class="ttc" id="dsp_8c_html_ab0a3ea6e2a2c890d2ce0228327c877a7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a></div><div class="ttdeci">#define FREQ_ARRAY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00115">dsp.c:115</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="dsp_8c_html_a63fc3d2975c956b5981217215285e6bd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a></div><div class="ttdeci">static float goertzel_result(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00362">dsp.c:362</a></div></div>
<div class="ttc" id="structast__dsp_html_a4754ae2a5d290d6e210d8066e7e58fce"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">ast_dsp::tstate</a></div><div class="ttdeci">int tstate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00424">dsp.c:424</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
<div class="ttc" id="dsp_8h_html_a3d3e74ee4ce09143367f282416532a8a"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a3d3e74ee4ce09143367f282416532a8a">DSP_TONE_STATE_SILENCE</a></div><div class="ttdeci">#define DSP_TONE_STATE_SILENCE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00052">dsp.h:52</a></div></div>
<div class="ttc" id="db_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4e/db_8h_source.html#l00060">db.h:60</a></div></div>
<div class="ttc" id="dsp_8c_html_aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa5520400b2835c739f9cc1abea9390c3ade787d7b9dd3a14cf6a2027a85a7a06f">HZ_400UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00100">dsp.c:100</a></div></div>
<div class="ttc" id="structast__dsp_html_ad20bd957eabb203120a091e13063e955"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ast_dsp::ringtimeout</a></div><div class="ttdeci">int ringtimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00413">dsp.c:413</a></div></div>
<div class="ttc" id="dsp_8c_html_a8dba54d7afec4002f759aa32fa7ce0be"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8dba54d7afec4002f759aa32fa7ce0be">pair_there</a></div><div class="ttdeci">static int pair_there(float p1, float p2, float i1, float i2, float e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01051">dsp.c:1051</a></div></div>
<div class="ttc" id="structast__dsp_html_a8f27a322054f8079506fca51ea0ef67a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">ast_dsp::progmode</a></div><div class="ttdeci">enum prog_mode progmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00423">dsp.c:423</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">include/asterisk/frame.h:285</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad82251eb86a7c1836a0d403585183da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad82251eb86a7c1836a0d403585183da">&#9670;&nbsp;</a></span>__ast_dsp_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a>* __ast_dsp_new </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">1722</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00559">ast_digit_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">ast_dsp_prog_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00415">ast_dsp::busycount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00140">DEFAULT_THRESHOLD</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00426">ast_dsp::digitmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00430">ast_dsp::display_inband_dtmf_warning</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00031">DSP_DIGITMODE_DTMF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00047">DSP_FAXMODE_DETECT_CNG</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00026">DSP_FEATURE_SILENCE_SUPPRESS</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00151">DSP_HISTORY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00427">ast_dsp::faxmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00412">ast_dsp::features</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00420">ast_dsp::freqcount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00407">ast_dsp::threshold</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01750">ast_dsp_new_with_rate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;{</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   <span class="keywordflow">if</span> ((dsp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*dsp)))) {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a686599473d8ce395e95619896d88d539">threshold</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a0c8005141291a96e10c9c9efe02263e8">DEFAULT_THRESHOLD</a>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> = <a class="code" href="../../d3/d08/dsp_8h.html#ab63492d48665481cbd29d913a6341b8e">DSP_FEATURE_SILENCE_SUPPRESS</a>;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> = <a class="code" href="../../d3/d08/dsp_8h.html#af0e16e88030540319d8a545dd7c2576c">DSP_DIGITMODE_DTMF</a>;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> = <a class="code" href="../../d3/d08/dsp_8h.html#aa97125e8415ed15db98bb7e79b17ab73">DSP_FAXMODE_DETECT_CNG</a>;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a> = <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">freqcount</a> = 0;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="comment">/* Initialize digit detector */</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#ad8c546f85dd9daab37eeeb3761aba219">ast_digit_detect_init</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">display_inband_dtmf_warning</a> = 1;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <span class="comment">/* Initialize initial DSP progress detect parameters */</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#affdbf305e6266be1228a571fccf28c45">ast_dsp_prog_reset</a>(dsp);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="comment">/* Initialize fax detector */</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a504a394ff79bb1ebd4614f834e3b7dbe">ast_fax_detect_init</a>(dsp);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   }</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;   <span class="keywordflow">return</span> dsp;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ad8c546f85dd9daab37eeeb3761aba219"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad8c546f85dd9daab37eeeb3761aba219">ast_digit_detect_init</a></div><div class="ttdeci">static void ast_digit_detect_init(digit_detect_state_t *s, int mf, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00559">dsp.c:559</a></div></div>
<div class="ttc" id="dsp_8h_html_af0e16e88030540319d8a545dd7c2576c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#af0e16e88030540319d8a545dd7c2576c">DSP_DIGITMODE_DTMF</a></div><div class="ttdeci">#define DSP_DIGITMODE_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00031">dsp.h:31</a></div></div>
<div class="ttc" id="dsp_8h_html_a5c7b41ef167d85ab193697e010dce94b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a></div><div class="ttdeci">#define DSP_DIGITMODE_MF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00032">dsp.h:32</a></div></div>
<div class="ttc" id="dsp_8c_html_affdbf305e6266be1228a571fccf28c45"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#affdbf305e6266be1228a571fccf28c45">ast_dsp_prog_reset</a></div><div class="ttdeci">static void ast_dsp_prog_reset(struct ast_dsp *dsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01700">dsp.c:1700</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="structast__dsp_html_a16e504da5771f1589a97d3164a3b08b8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">ast_dsp::faxmode</a></div><div class="ttdeci">int faxmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00427">dsp.c:427</a></div></div>
<div class="ttc" id="structast__dsp_html_a29a1e575aa8b94876e2d3b8da3f6da2b"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">ast_dsp::busycount</a></div><div class="ttdeci">int busycount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00415">dsp.c:415</a></div></div>
<div class="ttc" id="structast__dsp_html"><div class="ttname"><a href="../../d6/de5/structast__dsp.html">ast_dsp</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00405">dsp.c:405</a></div></div>
<div class="ttc" id="dsp_8h_html_ab63492d48665481cbd29d913a6341b8e"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#ab63492d48665481cbd29d913a6341b8e">DSP_FEATURE_SILENCE_SUPPRESS</a></div><div class="ttdeci">#define DSP_FEATURE_SILENCE_SUPPRESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00026">dsp.h:26</a></div></div>
<div class="ttc" id="structast__dsp_html_a90920c61c3569534bc6411f978552d80"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">ast_dsp::freqcount</a></div><div class="ttdeci">int freqcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00420">dsp.c:420</a></div></div>
<div class="ttc" id="dsp_8c_html_a0c8005141291a96e10c9c9efe02263e8"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0c8005141291a96e10c9c9efe02263e8">DEFAULT_THRESHOLD</a></div><div class="ttdeci">#define DEFAULT_THRESHOLD</div><div class="ttdoc">Default minimum average magnitude threshold to determine talking/noise by the DSP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00140">dsp.c:140</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="structast__dsp_html_a686599473d8ce395e95619896d88d539"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a686599473d8ce395e95619896d88d539">ast_dsp::threshold</a></div><div class="ttdeci">int threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00407">dsp.c:407</a></div></div>
<div class="ttc" id="structast__dsp_html_aa1e47d1242ef7ba65183a2c3e88e339d"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">ast_dsp::digitmode</a></div><div class="ttdeci">int digitmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00426">dsp.c:426</a></div></div>
<div class="ttc" id="dsp_8c_html_a504a394ff79bb1ebd4614f834e3b7dbe"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a504a394ff79bb1ebd4614f834e3b7dbe">ast_fax_detect_init</a></div><div class="ttdeci">static void ast_fax_detect_init(struct ast_dsp *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00511">dsp.c:511</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__dsp_html_a95d087aa0676d2cbc3e25cdd045311f7"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">ast_dsp::features</a></div><div class="ttdeci">int features</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00412">dsp.c:412</a></div></div>
<div class="ttc" id="structast__dsp_html_ab6401bd4f3bb3fcdd01650e97952b79e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">ast_dsp::display_inband_dtmf_warning</a></div><div class="ttdeci">int display_inband_dtmf_warning</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00430">dsp.c:430</a></div></div>
<div class="ttc" id="dsp_8h_html_aa97125e8415ed15db98bb7e79b17ab73"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa97125e8415ed15db98bb7e79b17ab73">DSP_FAXMODE_DETECT_CNG</a></div><div class="ttdeci">#define DSP_FAXMODE_DETECT_CNG</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00047">dsp.h:47</a></div></div>
<div class="ttc" id="dsp_8c_html_ab32788a6894e4f84d7c49ce6a2b4bd10"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a></div><div class="ttdeci">#define DSP_HISTORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00151">dsp.c:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af719a82882e371e7b6e6fb2b8c009c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af719a82882e371e7b6e6fb2b8c009c74">&#9670;&nbsp;</a></span>__ast_dsp_silence_noise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __ast_dsp_silence_noise </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>totalsilence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>totalnoise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>frames_energy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01229">1229</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/dc2/f2c_8h_source.html#l00195">abs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00143">BUSY_PERCENT</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00415">ast_dsp::busycount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00414">ast_dsp::busymaybe</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00151">DSP_HISTORY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00417">ast_dsp::historicnoise</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00418">ast_dsp::historicsilence</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00411">ast_dsp::totalnoise</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00409">ast_dsp::totalsilence</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01433">ast_dsp_silence_noise_with_energy()</a>.</p>
<div class="fragment"><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   <span class="keywordtype">int</span> accum;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   accum = 0;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      accum += <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(s[x]);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   accum /= <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   <span class="keywordflow">if</span> (accum &lt; dsp-&gt;<a class="code" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a>) {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="comment">/* Silent */</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a> += len / (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a> / 1000);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a>) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         <span class="comment">/* Move and save history */</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;         memmove(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a> + <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a> + <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> + 1, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> * <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[0]));</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[<a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - 1] = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/* we don&#39;t want to check for busydetect that frequently */</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a> = 1;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a> = 0;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      res = 1;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="comment">/* Not silent */</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a> += len / (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a> / 1000);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a>) {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         <span class="keywordtype">int</span> silence1 = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[<a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - 1];</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;         <span class="keywordtype">int</span> silence2 = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[<a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - 2];</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;         <span class="comment">/* Move and save history */</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;         memmove(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a> + <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a> + <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> + 1, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> * <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[0]));</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[<a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - 1] = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a>;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;         <span class="comment">/* check if the previous sample differs only by BUSY_PERCENT from the one before it */</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;         <span class="keywordflow">if</span> (silence1 &lt; silence2) {</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordflow">if</span> (silence1 + silence1 * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100 &gt;= silence2) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a> = 1;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a> = 0;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="keywordflow">if</span> (silence1 - silence1 * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100 &lt;= silence2) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a> = 1;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;               dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a> = 0;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;         }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a> = 0;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   }</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a>) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      *<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a> = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a>) {</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      *<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a> = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">totalnoise</a>;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;   }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <span class="keywordflow">if</span> (frames_energy) {</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      *frames_energy = accum;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a2233cf21d796054791292606009acbf8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">ast_dsp::busymaybe</a></div><div class="ttdeci">int busymaybe</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00414">dsp.c:414</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00143">dsp.c:143</a></div></div>
<div class="ttc" id="structast__dsp_html_a8d44232b19e9d5b8976167ce4600408a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">ast_dsp::historicsilence</a></div><div class="ttdeci">int historicsilence[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00418">dsp.c:418</a></div></div>
<div class="ttc" id="structast__dsp_html_a094105f8d645c85f853b07b09afd5f66"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">ast_dsp::historicnoise</a></div><div class="ttdeci">int historicnoise[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00417">dsp.c:417</a></div></div>
<div class="ttc" id="structast__dsp_html_a37f3ccbb8c8ee286cec59a4b0340e924"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">ast_dsp::totalsilence</a></div><div class="ttdeci">int totalsilence</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00409">dsp.c:409</a></div></div>
<div class="ttc" id="dsp_8h_html_a11a8ce2b7eba2230cab37aad708d9abf"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a></div><div class="ttdeci">threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00071">dsp.h:71</a></div></div>
<div class="ttc" id="structast__dsp_html_a29a1e575aa8b94876e2d3b8da3f6da2b"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">ast_dsp::busycount</a></div><div class="ttdeci">int busycount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00415">dsp.c:415</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00195">f2c.h:195</a></div></div>
<div class="ttc" id="structast__dsp_html_a8246dff6e1bba94227992b8e620f4800"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8246dff6e1bba94227992b8e620f4800">ast_dsp::totalnoise</a></div><div class="ttdeci">int totalnoise</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00411">dsp.c:411</a></div></div>
<div class="ttc" id="dsp_8c_html_ab32788a6894e4f84d7c49ce6a2b4bd10"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a></div><div class="ttdeci">#define DSP_HISTORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00151">dsp.c:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02466">2466</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02466">2466</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

</div>
</div>
<a id="a380a2a03c9d2b260bb9cbefe070fc1dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a380a2a03c9d2b260bb9cbefe070fc1dd">&#9670;&nbsp;</a></span>_dsp_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _dsp_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reload</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">1908</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01290">ast_config_destroy()</a>, <a class="el" href="../../d2/d9d/main_2config_8c_source.html#l03154">ast_config_load2()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01216">ast_variable_browse()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00245">CONFIG_FILE_NAME</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">CONFIG_FLAG_FILEUNCHANGED</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">CONFIG_STATUS_FILEINVALID</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00058">CONFIG_STATUS_FILEMISSING</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">CONFIG_STATUS_FILEUNCHANGED</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00232">DEF_DTMF_HITS_TO_BEGIN</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00237">DEF_DTMF_MISSES_TO_END</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00183">DEF_DTMF_NORMAL_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00190">DEF_DTMF_REVERSE_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00184">DEF_RELAX_DTMF_NORMAL_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00191">DEF_RELAX_DTMF_REVERSE_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00243">DEFAULT_SILENCE_THRESHOLD</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00333">dtmf_hits_to_begin</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00334">dtmf_misses_to_end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00329">dtmf_normal_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00330">dtmf_reverse_twist</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">ast_variable::name</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">ast_variable::next</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00331">relax_dtmf_normal_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00332">relax_dtmf_reverse_twist</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00073">THRESHOLD_SILENCE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00328">thresholds</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02442">load_module()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02454">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;{</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   <span class="keywordtype">int</span> cfg_threshold;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   <span class="keywordtype">float</span> cfg_twist;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <span class="keywordflow">if</span> ((cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(<a class="code" href="../../d5/d3b/dsp_8c.html#a62921b92fa4fb37f1e3a5d4c644fc1d8">CONFIG_FILE_NAME</a>, <span class="stringliteral">&quot;dsp&quot;</span>, config_flags)) == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;   }</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a>[<a class="code" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfa40278495f8621707b864e57e1110d20f">THRESHOLD_SILENCE</a>] = <a class="code" href="../../d5/d3b/dsp_8c.html#a20583928a48fd930b511ddbd722e6192">DEFAULT_SILENCE_THRESHOLD</a>;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a5e9a3c55581aedf098446a36d09a1ae6">DEF_DTMF_NORMAL_TWIST</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a0d18e32bfd7abe1418c783bb559a2815">DEF_DTMF_REVERSE_TWIST</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a47b53428195fd14d7fb1277dee37797b">DEF_RELAX_DTMF_NORMAL_TWIST</a>;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a8aeff17b5ac85fccc6c47e4f1b1acf28">DEF_RELAX_DTMF_REVERSE_TWIST</a>;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <a class="code" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a0552d253f9f73129985cec46b262d35d">DEF_DTMF_HITS_TO_BEGIN</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <a class="code" href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a1e784ed7d907009104317c4a61af3176">DEF_DTMF_MISSES_TO_END</a>;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a39bacaabcacf47583204c7634e64a2a0">CONFIG_STATUS_FILEMISSING</a> || cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <span class="keywordflow">for</span> (v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, <span class="stringliteral">&quot;default&quot;</span>); v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;silencethreshold&quot;</span>)) {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;cfg_threshold) &lt; 1) {</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg_threshold &lt; 0) {</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid silence threshold &#39;%d&#39; specified, using default\n&quot;</span>, cfg_threshold);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a>[<a class="code" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfa40278495f8621707b864e57e1110d20f">THRESHOLD_SILENCE</a>] = cfg_threshold;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;         }</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dtmf_normal_twist&quot;</span>)) {</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30f&quot;</span>, &amp;cfg_twist) &lt; 1) {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cfg_twist &lt; 2.0) || (cfg_twist &gt; 100.0)) {      <span class="comment">/* &lt; 3.0dB or &gt; 20dB */</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid dtmf_normal_twist value &#39;%.2f&#39; specified, using default of %.2f\n&quot;</span>, cfg_twist, <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a>);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a> = cfg_twist;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;         }</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dtmf_reverse_twist&quot;</span>)) {</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30f&quot;</span>, &amp;cfg_twist) &lt; 1) {</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cfg_twist &lt; 2.0) || (cfg_twist &gt; 100.0)) {      <span class="comment">/* &lt; 3.0dB or &gt; 20dB */</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid dtmf_reverse_twist value &#39;%.2f&#39; specified, using default of %.2f\n&quot;</span>, cfg_twist, <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a>);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a> = cfg_twist;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;         }</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;relax_dtmf_normal_twist&quot;</span>)) {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30f&quot;</span>, &amp;cfg_twist) &lt; 1) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cfg_twist &lt; 2.0) || (cfg_twist &gt; 100.0)) {      <span class="comment">/* &lt; 3.0dB or &gt; 20dB */</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid relax_dtmf_normal_twist value &#39;%.2f&#39; specified, using default of %.2f\n&quot;</span>, cfg_twist, <a class="code" href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a>);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a> = cfg_twist;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         }</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;relax_dtmf_reverse_twist&quot;</span>)) {</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30f&quot;</span>, &amp;cfg_twist) &lt; 1) {</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cfg_twist &lt; 2.0) || (cfg_twist &gt; 100.0)) {      <span class="comment">/* &lt; 3.0dB or &gt; 20dB */</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid relax_dtmf_reverse_twist value &#39;%.2f&#39; specified, using default of %.2f\n&quot;</span>, cfg_twist, <a class="code" href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a>);</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a> = cfg_twist;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;         }</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dtmf_hits_to_begin&quot;</span>)) {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;cfg_threshold) &lt; 1) {</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg_threshold &lt; 1) {     <span class="comment">/* must be 1 or greater */</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid dtmf_hits_to_begin value &#39;%d&#39; specified, using default of %d\n&quot;</span>, cfg_threshold, <a class="code" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a>);</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a> = cfg_threshold;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;         }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dtmf_misses_to_end&quot;</span>)) {</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;         <span class="keywordflow">if</span> (sscanf(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;cfg_threshold) &lt; 1) {</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to convert &#39;%s&#39; to a numeric value.\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg_threshold &lt; 1) {     <span class="comment">/* must be 1 or greater */</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid dtmf_misses_to_end value &#39;%d&#39; specified, using default of %d\n&quot;</span>, cfg_threshold, <a class="code" href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a>);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a> = cfg_threshold;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;         }</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   }</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;}</div><div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="dsp_8c_html_af097a604c6c8629d24ca1563a7c55160"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a></div><div class="ttdeci">static float relax_dtmf_reverse_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00332">dsp.c:332</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aef636ed2f3d33f4c7a1ba67eb7c4d052"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a></div><div class="ttdeci">struct ast_variable * ast_variable_browse(const struct ast_config *config, const char *category_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01216">extconf.c:1216</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="dsp_8c_html_a20583928a48fd930b511ddbd722e6192"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a20583928a48fd930b511ddbd722e6192">DEFAULT_SILENCE_THRESHOLD</a></div><div class="ttdeci">static const int DEFAULT_SILENCE_THRESHOLD</div><div class="ttdoc">The default silence threshold we will use if an alternate configured value is not present or is inval...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00243">dsp.c:243</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="dsp_8c_html_a5e9a3c55581aedf098446a36d09a1ae6"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a5e9a3c55581aedf098446a36d09a1ae6">DEF_DTMF_NORMAL_TWIST</a></div><div class="ttdeci">#define DEF_DTMF_NORMAL_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00183">dsp.c:183</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aab3eac8fa82a86a93c074deb7b77dbc9"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a></div><div class="ttdeci">struct ast_config * ast_config_load2(const char *filename, const char *who_asked, struct ast_flags flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03154">main/config.c:3154</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="dsp_8c_html_a0552d253f9f73129985cec46b262d35d"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0552d253f9f73129985cec46b262d35d">DEF_DTMF_HITS_TO_BEGIN</a></div><div class="ttdeci">#define DEF_DTMF_HITS_TO_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00232">dsp.c:232</a></div></div>
<div class="ttc" id="dsp_8c_html_a62921b92fa4fb37f1e3a5d4c644fc1d8"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a62921b92fa4fb37f1e3a5d4c644fc1d8">CONFIG_FILE_NAME</a></div><div class="ttdeci">#define CONFIG_FILE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00245">dsp.c:245</a></div></div>
<div class="ttc" id="dsp_8h_html_a11a8ce2b7eba2230cab37aad708d9abfa40278495f8621707b864e57e1110d20f"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfa40278495f8621707b864e57e1110d20f">THRESHOLD_SILENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00073">dsp.h:73</a></div></div>
<div class="ttc" id="dsp_8c_html_abc964f63482684acfd2937e981c678b7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a></div><div class="ttdeci">static int dtmf_hits_to_begin</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00333">dsp.c:333</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_a0d18e32bfd7abe1418c783bb559a2815"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0d18e32bfd7abe1418c783bb559a2815">DEF_DTMF_REVERSE_TWIST</a></div><div class="ttdeci">#define DEF_DTMF_REVERSE_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00190">dsp.c:190</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="dsp_8c_html_aba246381ba21cda471a8b4c5e81b48a5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a></div><div class="ttdeci">static int dtmf_misses_to_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00334">dsp.c:334</a></div></div>
<div class="ttc" id="dsp_8c_html_a1e784ed7d907009104317c4a61af3176"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a1e784ed7d907009104317c4a61af3176">DEF_DTMF_MISSES_TO_END</a></div><div class="ttdeci">#define DEF_DTMF_MISSES_TO_END</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00237">dsp.c:237</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="dsp_8c_html_a47b53428195fd14d7fb1277dee37797b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a47b53428195fd14d7fb1277dee37797b">DEF_RELAX_DTMF_NORMAL_TWIST</a></div><div class="ttdeci">#define DEF_RELAX_DTMF_NORMAL_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00184">dsp.c:184</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a846844eb2c4eb44554445936b3770711"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEUNCHANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">include/asterisk/config.h:59</a></div></div>
<div class="ttc" id="dsp_8c_html_aec01db8127adabb95e443652f30963f2"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a></div><div class="ttdeci">static float dtmf_normal_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00329">dsp.c:329</a></div></div>
<div class="ttc" id="dsp_8c_html_ad2df3792a1bd43813423c43556bfe6b2"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a></div><div class="ttdeci">static float relax_dtmf_normal_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00331">dsp.c:331</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00741">cdr_mysql.c:741</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a39bacaabcacf47583204c7634e64a2a0"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a39bacaabcacf47583204c7634e64a2a0">CONFIG_STATUS_FILEMISSING</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEMISSING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00058">include/asterisk/config.h:58</a></div></div>
<div class="ttc" id="dsp_8c_html_a91f8036cdc5c4dca199e2d123f333087"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a></div><div class="ttdeci">static float dtmf_reverse_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00330">dsp.c:330</a></div></div>
<div class="ttc" id="dsp_8c_html_a8aeff17b5ac85fccc6c47e4f1b1acf28"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8aeff17b5ac85fccc6c47e4f1b1acf28">DEF_RELAX_DTMF_REVERSE_TWIST</a></div><div class="ttdeci">#define DEF_RELAX_DTMF_REVERSE_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00191">dsp.c:191</a></div></div>
<div class="ttc" id="dsp_8c_html_a0366c9d4146e4af0845b51e14744392e"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a></div><div class="ttdeci">static int thresholds[THRESHOLD_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00328">dsp.c:328</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">include/asterisk/config.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8c546f85dd9daab37eeeb3761aba219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c546f85dd9daab37eeeb3761aba219">&#9670;&nbsp;</a></span>ast_digit_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_digit_detect_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00559">559</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00531">ast_dtmf_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00547">ast_mf_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00307">digit_detect_state_t::current_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00308">digit_detect_state_t::detected_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00305">digit_detect_state_t::digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00312">digit_detect_state_t::dtmf</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00309">digit_detect_state_t::lost_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00313">digit_detect_state_t::mf</a>, and <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01844">ast_dsp_set_digitmode()</a>.</p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;{</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> = 0;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a192a5c65db7b23a14d00ab5612b4c320">detected_digits</a> = 0;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6dde65ce3267d76bf68172a358940bce">lost_digits</a> = 0;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="keywordflow">if</span> (mf) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a00071c3dbca6a6de4ecc8e0e614b4da5">ast_mf_detect_init</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>, sample_rate);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#aabeaa12abf1b4984df95f0dcd6d11556">ast_dtmf_detect_init</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>, sample_rate);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div><div class="ttc" id="structdigit__detect__state__t_html_a07c84020c6c083f2732be8ff6a6c65ca"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a></div><div class="ttdeci">union digit_detect_state_t::@383 td</div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a6dde65ce3267d76bf68172a358940bce"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a6dde65ce3267d76bf68172a358940bce">digit_detect_state_t::lost_digits</a></div><div class="ttdeci">int lost_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00309">dsp.c:309</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_ac74ec91ceeab32c9468de13feb7c4d33"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">digit_detect_state_t::current_digits</a></div><div class="ttdeci">int current_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00307">dsp.c:307</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_abc255092d94df3f9fc5937c9177bcf3c"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digit_detect_state_t::digits</a></div><div class="ttdeci">char digits[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00305">dsp.c:305</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a8c1c9dbb611393e228a8a861ef042068"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">digit_detect_state_t::dtmf</a></div><div class="ttdeci">dtmf_detect_state_t dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00312">dsp.c:312</a></div></div>
<div class="ttc" id="dsp_8c_html_aabeaa12abf1b4984df95f0dcd6d11556"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aabeaa12abf1b4984df95f0dcd6d11556">ast_dtmf_detect_init</a></div><div class="ttdeci">static void ast_dtmf_detect_init(dtmf_detect_state_t *s, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00531">dsp.c:531</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a192a5c65db7b23a14d00ab5612b4c320"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a192a5c65db7b23a14d00ab5612b4c320">digit_detect_state_t::detected_digits</a></div><div class="ttdeci">int detected_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00308">dsp.c:308</a></div></div>
<div class="ttc" id="dsp_8c_html_a00071c3dbca6a6de4ecc8e0e614b4da5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a00071c3dbca6a6de4ecc8e0e614b4da5">ast_mf_detect_init</a></div><div class="ttdeci">static void ast_mf_detect_init(mf_detect_state_t *s, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00547">dsp.c:547</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a6bcc9350bec0d851925e46ca38a90349"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">digit_detect_state_t::mf</a></div><div class="ttdeci">mf_detect_state_t mf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00313">dsp.c:313</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3349aaac5958df1f8a0147ebccf05dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3349aaac5958df1f8a0147ebccf05dc">&#9670;&nbsp;</a></span>ast_dsp_busydetect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_busydetect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return non-zero if historically this should be a busy, request that ast_dsp_silence has already been called. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01295">1295</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/dc2/f2c_8h_source.html#l00195">abs</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00416">ast_dsp::busy_cadence</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00147">BUSY_MAX</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00146">BUSY_MIN</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00144">BUSY_PAT_PERCENT</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00143">BUSY_PERCENT</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00415">ast_dsp::busycount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00414">ast_dsp::busymaybe</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00151">DSP_HISTORY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00417">ast_dsp::historicnoise</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00418">ast_dsp::historicsilence</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00066">ast_dsp_busy_pattern::length</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00228">MAX</a>, and <a class="el" href="../../d3/d08/dsp_8h_source.html#l00068">ast_dsp_busy_pattern::pattern</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   <span class="keywordtype">int</span> res = 0, x;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   <span class="keywordtype">int</span> avgsilence = 0, hitsilence = 0;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   <span class="keywordtype">int</span> avgtone = 0, hittone = 0;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   <span class="comment">/* if we have a 4 length pattern, the way busymaybe is set doesn&#39;t help us. */</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">length</a> != 4) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="keywordflow">if</span> (!dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">busymaybe</a>) {</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;         <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      }</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <span class="keywordflow">for</span> (x = <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>; x &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>; x++) {</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      avgsilence += dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x];</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      avgtone += dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x];</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   avgsilence /= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;   avgtone /= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;   <span class="keywordflow">for</span> (x = <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>; x &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>; x++) {</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordflow">if</span> (avgsilence &gt; dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x]) {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;         <span class="keywordflow">if</span> (avgsilence - (avgsilence * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100) &lt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x]) {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            hitsilence++;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;         }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;         <span class="keywordflow">if</span> (avgsilence + (avgsilence * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100) &gt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x]) {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            hitsilence++;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;         }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordflow">if</span> (avgtone &gt; dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x]) {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;         <span class="keywordflow">if</span> (avgtone - (avgtone * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100) &lt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x]) {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            hittone++;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;         }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;         <span class="keywordflow">if</span> (avgtone + (avgtone * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a> / 100) &gt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x]) {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            hittone++;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;         }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   <span class="keywordflow">if</span> ((hittone &gt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> - 1) &amp;&amp; (hitsilence &gt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> - 1) &amp;&amp;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;       (avgtone &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a> &amp;&amp; avgtone &lt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a>) &amp;&amp;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;       (avgsilence &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a> &amp;&amp; avgsilence &lt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a>))</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;   <span class="keywordflow">if</span> ((hittone &gt;= dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> - 1) &amp;&amp; (avgtone &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a> &amp;&amp; avgtone &lt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a>))</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;   {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="preprocessor">#ifdef BUSYDETECT_COMPARE_TONE_AND_SILENCE</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keywordflow">if</span> (avgtone &gt; avgsilence) {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;         <span class="keywordflow">if</span> (avgtone - avgtone*<a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>/100 &lt;= avgsilence) {</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            res = 1;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;         }</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;         <span class="keywordflow">if</span> (avgtone + avgtone*<a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>/100 &gt;= avgsilence) {</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            res = 1;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;         }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      res = 1;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <span class="comment">/* If we have a 4-length pattern, we can go ahead and just check it in a different way. */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">length</a> == 4) {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keywordtype">int</span> errors = 0;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordtype">int</span> errors_max = ((4 * dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>) / 100.0) * <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a>;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordflow">for</span> (x = <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a> - (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a>); x &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>; x += 2) {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;         <span class="keywordtype">int</span> temp_error;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;         temp_error = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x] - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0]);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;         <span class="keywordflow">if</span> ((temp_error * 100) / dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>) {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            errors++;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;         temp_error = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>[x + 1] - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[2]);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;         <span class="keywordflow">if</span> ((temp_error * 100) / dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[2] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>) {</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            errors++;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;         }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;         temp_error = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x] - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1]);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;         <span class="keywordflow">if</span> ((temp_error * 100) / dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>) {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            errors++;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;         }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;         temp_error = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>[x + 1] - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[3]);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;         <span class="keywordflow">if</span> ((temp_error * 100) / dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[3] &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a>) {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            errors++;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;         }</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;errors = %d  max = %d\n&quot;</span>, errors, errors_max);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">if</span> (errors &lt;= errors_max) {</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   <span class="comment">/* If we know the expected busy tone length, check we are in the range */</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   <span class="keywordflow">if</span> (res &amp;&amp; (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0] &gt; 0)) {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(avgtone - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0]) &gt; <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0]*<a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a>/100, 20)) {</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="preprocessor">#ifdef BUSYDETECT_DEBUG</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;busy detector: avgtone of %d not close enough to desired %d\n&quot;</span>,</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            avgtone, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0]);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;         res = 0;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <span class="comment">/* If we know the expected busy tone silent-period length, check we are in the range */</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   <span class="keywordflow">if</span> (res &amp;&amp; (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1] &gt; 0)) {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(avgsilence - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1]) &gt; <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1]*<a class="code" href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a>/100, 20)) {</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="preprocessor">#ifdef BUSYDETECT_DEBUG</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;busy detector: avgsilence of %d not close enough to desired %d\n&quot;</span>,</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;         avgsilence, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a>.<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1]);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;         res = 0;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      }</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   }</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="preprocessor">#if !defined(BUSYDETECT_TONEONLY) &amp;&amp; defined(BUSYDETECT_DEBUG)</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;ast_dsp_busydetect detected busy, avgtone: %d, avgsilence %d\n&quot;</span>, avgtone, avgsilence);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;busy detector: FAILED with avgtone: %d, avgsilence %d\n&quot;</span>, avgtone, avgsilence);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;   }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a2233cf21d796054791292606009acbf8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a2233cf21d796054791292606009acbf8">ast_dsp::busymaybe</a></div><div class="ttdeci">int busymaybe</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00414">dsp.c:414</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa5a4f81a75666e40a10a22d23c00e42d5">BUSY_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00147">dsp.c:147</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa8fda9d1e84f60c5e84a392a404f6ff40">BUSY_MIN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00146">dsp.c:146</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aad895eaff8ec976c7efe788d100c83bb5">BUSY_PERCENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00143">dsp.c:143</a></div></div>
<div class="ttc" id="structast__dsp__busy__pattern_html_a8bf4ddcdbc0a03e32898ba1c5a20c953"><div class="ttname"><a href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">ast_dsp_busy_pattern::pattern</a></div><div class="ttdeci">int pattern[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00068">dsp.h:68</a></div></div>
<div class="ttc" id="structast__dsp_html_a8d44232b19e9d5b8976167ce4600408a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">ast_dsp::historicsilence</a></div><div class="ttdeci">int historicsilence[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00418">dsp.c:418</a></div></div>
<div class="ttc" id="structast__dsp_html_a094105f8d645c85f853b07b09afd5f66"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">ast_dsp::historicnoise</a></div><div class="ttdeci">int historicnoise[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00417">dsp.c:417</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="utils_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00228">utils.h:228</a></div></div>
<div class="ttc" id="structast__dsp_html_a29a1e575aa8b94876e2d3b8da3f6da2b"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">ast_dsp::busycount</a></div><div class="ttdeci">int busycount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00415">dsp.c:415</a></div></div>
<div class="ttc" id="structast__dsp__busy__pattern_html_a9f59b34b1f25fe00023291b678246bcc"><div class="ttname"><a href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">ast_dsp_busy_pattern::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00066">dsp.h:66</a></div></div>
<div class="ttc" id="dsp_8c_html_a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9fb2e530706d025a0d33063363a8ac8aa69f24fafffd787f70bbf4467e103015f">BUSY_PAT_PERCENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00144">dsp.c:144</a></div></div>
<div class="ttc" id="structast__dsp_html_ae40d7af4dfc270d67db982403bcebba0"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">ast_dsp::busy_cadence</a></div><div class="ttdeci">struct ast_dsp_busy_pattern busy_cadence</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00416">dsp.c:416</a></div></div>
<div class="ttc" id="f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00195">f2c.h:195</a></div></div>
<div class="ttc" id="dsp_8c_html_ab32788a6894e4f84d7c49ce6a2b4bd10"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a></div><div class="ttdeci">#define DSP_HISTORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00151">dsp.c:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66eb1c63ea0e0002ff7507fd9da0eccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66eb1c63ea0e0002ff7507fd9da0eccf">&#9670;&nbsp;</a></span>ast_dsp_call_progress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_call_progress </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>inf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scans for progress indication in audio. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01216">1216</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00542">ast_format_cache_is_slinear()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">ast_frame::datalen</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, and <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>.</p>
<div class="fragment"><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;{</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t check call progress of non-voice frames\n&quot;</span>);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a>(inf-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>)) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can only check call progress in signed-linear frames\n&quot;</span>);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   }</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a>(dsp, inf-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, inf-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> / 2);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div><div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="dsp_8c_html_a309197e46487283dfa6c7614a3e3d1f9"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a></div><div class="ttdeci">static int __ast_dsp_call_progress(struct ast_dsp *dsp, short *s, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01074">dsp.c:1074</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="format__cache_8h_html_a309515067d94f11b99659093c5beefee"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a></div><div class="ttdeci">int ast_format_cache_is_slinear(struct ast_format *format)</div><div class="ttdoc">Determines if a format is one of the cached slin formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00542">format_cache.c:542</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45fbc637da9251814352c97382f24d40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45fbc637da9251814352c97382f24d40">&#9670;&nbsp;</a></span>ast_dsp_digitreset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_digitreset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset DTMF detector. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01797">1797</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00284">dtmf_detect_state_t::col_out</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00307">digit_detect_state_t::current_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00288">dtmf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00297">mf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00290">dtmf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00299">mf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00426">ast_dsp::digitmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00305">digit_detect_state_t::digits</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00312">digit_detect_state_t::dtmf</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00429">ast_dsp::dtmf_began</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00289">dtmf_detect_state_t::energy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00382">goertzel_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00285">dtmf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00298">mf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00287">dtmf_detect_state_t::lasthit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00313">digit_detect_state_t::mf</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00286">dtmf_detect_state_t::misses</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00283">dtmf_detect_state_t::row_out</a>, <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00296">mf_detect_state_t::tone_out</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09512">analog_ss_thread()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l00847">mbl_new()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01582">my_dsp_reset_and_flush_digits()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>
<div class="fragment"><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;{</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">dtmf_began</a> = 0;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a>) {</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <a class="code" href="../../d5/d5b/structmf__detect__state__t.html">mf_detect_state_t</a> *s = &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">/* Reinitialise the detector for the next block */</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[i]);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[0] = 0;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <a class="code" href="../../df/d42/structdtmf__detect__state__t.html">dtmf_detect_state_t</a> *s = &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="comment">/* Reinitialise the detector for the next block */</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>[i]);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>[i]);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">lasthit</a> = 0;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> = 0.0;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">hits</a> = 0;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a> = 0;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   }</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> = 0;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;}</div><div class="ttc" id="structdigit__detect__state__t_html_a07c84020c6c083f2732be8ff6a6c65ca"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a></div><div class="ttdeci">union digit_detect_state_t::@383 td</div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_acb6b7e41e677928ff3ee0f9930319eee"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">dtmf_detect_state_t::misses</a></div><div class="ttdeci">int misses</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00286">dsp.c:286</a></div></div>
<div class="ttc" id="dsp_8h_html_a5c7b41ef167d85ab193697e010dce94b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a></div><div class="ttdeci">#define DSP_DIGITMODE_MF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00032">dsp.h:32</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html">mf_detect_state_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00294">dsp.c:294</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a6eb4f6f645392a720b883b687918880f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">dtmf_detect_state_t::hits</a></div><div class="ttdeci">int hits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00285">dsp.c:285</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_ac74ec91ceeab32c9468de13feb7c4d33"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">digit_detect_state_t::current_digits</a></div><div class="ttdeci">int current_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00307">dsp.c:307</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_aefd6f30bb7df6a58d77f2e7032300889"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">mf_detect_state_t::tone_out</a></div><div class="ttdeci">goertzel_state_t tone_out[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00296">dsp.c:296</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">dtmf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00288">dsp.c:288</a></div></div>
<div class="ttc" id="dsp_8c_html_aa823bf1feac16cc6fe3d06aad8b1262c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a></div><div class="ttdeci">static void goertzel_reset(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00382">dsp.c:382</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html">dtmf_detect_state_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00281">dsp.c:281</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_abc255092d94df3f9fc5937c9177bcf3c"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digit_detect_state_t::digits</a></div><div class="ttdeci">char digits[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00305">dsp.c:305</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af1fb0b506fe9bf5d68b9e2d84393945e"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">dtmf_detect_state_t::lasthit</a></div><div class="ttdeci">int lasthit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00287">dsp.c:287</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a8c1c9dbb611393e228a8a861ef042068"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">digit_detect_state_t::dtmf</a></div><div class="ttdeci">dtmf_detect_state_t dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00312">dsp.c:312</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">dtmf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00290">dsp.c:290</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_ae2a8d527cd8efbc81c4d39c2bf216c2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">dtmf_detect_state_t::col_out</a></div><div class="ttdeci">goertzel_state_t col_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00284">dsp.c:284</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_ab504ac2052e441f05b416f0582f169ea"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">mf_detect_state_t::hits</a></div><div class="ttdeci">int hits[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00298">dsp.c:298</a></div></div>
<div class="ttc" id="structast__dsp_html_aba87c96f3d55cec3433197cb774bdb81"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">ast_dsp::dtmf_began</a></div><div class="ttdeci">int dtmf_began</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00429">dsp.c:429</a></div></div>
<div class="ttc" id="structast__dsp_html_aa1e47d1242ef7ba65183a2c3e88e339d"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">ast_dsp::digitmode</a></div><div class="ttdeci">int digitmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00426">dsp.c:426</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">mf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00299">dsp.c:299</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a2d107b3b2dcebab8a10c9d39894f6b2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">dtmf_detect_state_t::energy</a></div><div class="ttdeci">float energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00289">dsp.c:289</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">mf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00297">dsp.c:297</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a6bcc9350bec0d851925e46ca38a90349"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">digit_detect_state_t::mf</a></div><div class="ttdeci">mf_detect_state_t mf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00313">dsp.c:313</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a08afba015760120cc445d7d7cf11c24f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">dtmf_detect_state_t::row_out</a></div><div class="ttdeci">goertzel_state_t row_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00283">dsp.c:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a57a1e374549eb2705068688f4046db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a57a1e374549eb2705068688f4046db">&#9670;&nbsp;</a></span>ast_dsp_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01770">1770</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09512">analog_ss_thread()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l07792">chan_list_destructor()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00765">chan_pjsip_cng_tone_detected()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00838">chan_pjsip_read_stream()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l05992">dahdi_hangup()</a>, <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00134">datastore_destroy_cb()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00201">destroy_callback()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l04539">destroy_endpoint()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l03676">destroy_faxdetect()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l01096">destroy_session()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04930">disable_dsp_detect()</a>, <a class="el" href="../../d5/d4c/app__waitforsilence_8c_source.html#l00154">do_waiting()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d2/d48/app__amd_8c_source.html#l00162">isAnsweringMachine()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00902">mgcp_hangup()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l02066">my_all_subchannels_hungup()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01591">my_dsp_set_digitmode()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l04117">ooh323_destroy()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01530">pjsip_acf_dtmf_mode_write()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00274">read_mf_digits()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00358">read_sf_digits()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>, <a class="el" href="../../db/d4e/bridge__softmix_8c_source.html#l00303">set_softmix_bridge_data()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l08631">sip_rtp_read()</a>, <a class="el" href="../../db/d4e/bridge__softmix_8c_source.html#l00817">softmix_bridge_leave()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04702">unload_module()</a>, and <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;{</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(dsp);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;}</div><div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92238c472ae51a2926b51599108ab071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92238c472ae51a2926b51599108ab071">&#9670;&nbsp;</a></span>ast_dsp_get_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_get_features </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get features. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01764">1764</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00412">ast_dsp::features</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00765">chan_pjsip_cng_tone_detected()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00838">chan_pjsip_read_stream()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01530">pjsip_acf_dtmf_mode_write()</a>, and <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>.</p>
<div class="fragment"><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;{</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">return</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a>);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a95d087aa0676d2cbc3e25cdd045311f7"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">ast_dsp::features</a></div><div class="ttdeci">int features</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00412">dsp.c:412</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78b2daa9b1bfbcbde7ce3f02417f694b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b2daa9b1bfbcbde7ce3f02417f694b">&#9670;&nbsp;</a></span>ast_dsp_get_sample_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ast_dsp_get_sample_rate </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the sample rate this DSP structure was created with. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01717">1717</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>.</p>
<div class="fragment"><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;{</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;   <span class="keywordflow">return</span> dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b5cfada9ab61cee75ac7d006e86d09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b5cfada9ab61cee75ac7d006e86d09d">&#9670;&nbsp;</a></span>ast_dsp_get_tcount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_get_tcount </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get tcount (Threshold counter) </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01903">1903</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00425">ast_dsp::tcount</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l08418">dahdi_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;{</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   <span class="keywordflow">return</span> dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">tcount</a>;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a09467367454312afdf090ec7d63cb8b3"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a09467367454312afdf090ec7d63cb8b3">ast_dsp::tcount</a></div><div class="ttdeci">int tcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00425">dsp.c:425</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab28c68838eaed4e0c89460a4e554cca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab28c68838eaed4e0c89460a4e554cca">&#9670;&nbsp;</a></span>ast_dsp_get_threshold_from_settings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_get_threshold_from_settings </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a>&#160;</td>
          <td class="paramname"><em>which</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get silence threshold from dsp.conf. </p>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01996">1996</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00328">thresholds</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13680">actual_load_config()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l01339">app_exec()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l02489">ast_record_review()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02399">conf_rec_name()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d5/d4c/app__waitforsilence_8c_source.html#l00154">do_waiting()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d2/d48/app__amd_8c_source.html#l00476">load_config()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02075">setup_privacy_args()</a>, and <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00310">talk_detect_fn_write()</a>.</p>
<div class="fragment"><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;{</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a>[which];</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;}</div><div class="ttc" id="dsp_8c_html_a0366c9d4146e4af0845b51e14744392e"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0366c9d4146e4af0845b51e14744392e">thresholds</a></div><div class="ttdeci">static int thresholds[THRESHOLD_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00328">dsp.c:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="accae19c5763ae43f0d5cf058f07d8d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accae19c5763ae43f0d5cf058f07d8d18">&#9670;&nbsp;</a></span>ast_dsp_get_tstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_get_tstate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get tstate (Tone State) </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01898">1898</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00424">ast_dsp::tstate</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l08418">dahdi_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;{</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;   <span class="keywordflow">return</span> dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">tstate</a>;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a4754ae2a5d290d6e210d8066e7e58fce"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a4754ae2a5d290d6e210d8066e7e58fce">ast_dsp::tstate</a></div><div class="ttdeci">int tstate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00424">dsp.c:424</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a60e93006c8e1ca8fda922ae0e0da2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a60e93006c8e1ca8fda922ae0e0da2c">&#9670;&nbsp;</a></span>ast_dsp_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a>* ast_dsp_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a new dsp, assumes 8khz for internal sample rate. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">1745</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">DEFAULT_SAMPLE_RATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00399">detect_write()</a>, <a class="el" href="../../d5/d4c/app__waitforsilence_8c_source.html#l00154">do_waiting()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04896">enable_dsp_detect()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l03694">fax_detect_new()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l01215">fax_session_new()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d2/d48/app__amd_8c_source.html#l00162">isAnsweringMachine()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l01494">mgcp_new()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l12365">misdn_set_opt_exec()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01591">my_dsp_set_digitmode()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00413">ooh323_new()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01530">pjsip_acf_dtmf_mode_write()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l05922">read_config()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00274">read_mf_digits()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00358">read_sf_digits()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;{</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aad82251eb86a7c1836a0d403585183da">__ast_dsp_new</a>(<a class="code" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div><div class="ttc" id="dsp_8c_html_abe9b1c28165a7071e354bd9d7823ca1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a></div><div class="ttdeci">#define DEFAULT_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00221">dsp.c:221</a></div></div>
<div class="ttc" id="dsp_8c_html_aad82251eb86a7c1836a0d403585183da"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aad82251eb86a7c1836a0d403585183da">__ast_dsp_new</a></div><div class="ttdeci">static struct ast_dsp * __ast_dsp_new(unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01722">dsp.c:1722</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc59fd6560e440699e6bb55aa101de93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc59fd6560e440699e6bb55aa101de93">&#9670;&nbsp;</a></span>ast_dsp_new_with_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a>* ast_dsp_new_with_rate </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a new dsp with a specific internal sample rate used during processing. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01750">1750</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d4e/bridge__softmix_8c_source.html#l00303">set_softmix_bridge_data()</a>, and <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00260">set_talk_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;{</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aad82251eb86a7c1836a0d403585183da">__ast_dsp_new</a>(sample_rate);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;}</div><div class="ttc" id="dsp_8c_html_aad82251eb86a7c1836a0d403585183da"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aad82251eb86a7c1836a0d403585183da">__ast_dsp_new</a></div><div class="ttdeci">static struct ast_dsp * __ast_dsp_new(unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01722">dsp.c:1722</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5efca89c36180bbe497d83837167546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5efca89c36180bbe497d83837167546">&#9670;&nbsp;</a></span>ast_dsp_noise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_noise </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>totalnoise</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the audio frame for noise. </p>
<dl class="section since"><dt>Since</dt><dd>1.6.1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsp</td><td>DSP processing audio media. </td></tr>
    <tr><td class="paramname">f</td><td>Audio frame to process. </td></tr>
    <tr><td class="paramname">totalnoise</td><td>Variable to set to the total accumulated noise in ms seen by the DSP since the last silence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the frame is silence. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01488">1488</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01433">ast_dsp_silence_noise_with_energy()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;{</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a>(dsp, f, totalnoise, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;}</div><div class="ttc" id="dsp_8c_html_aa93f65e11fefc33db1f1c89824693c68"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a></div><div class="ttdeci">static int ast_dsp_silence_noise_with_energy(struct ast_dsp *dsp, struct ast_frame *f, int *total, int *frames_energy, int noise)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01433">dsp.c:1433</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa55ca4351805268c161127b00b533349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55ca4351805268c161127b00b533349">&#9670;&nbsp;</a></span>ast_dsp_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a>* ast_dsp_process </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>af</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return AST_FRAME_NULL frames when there is silence, AST_FRAME_BUSY on busies, and call progress, all dependent upon which features are enabled. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">1494</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01229">__ast_dsp_silence_noise()</a>, <a class="el" href="../../d6/db5/alaw_8h_source.html#l00084">AST_ALAW</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01005">ast_channel_softhangup_internal_flag_add()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">AST_CONTROL_ANSWER</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">AST_CONTROL_BUSY</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">AST_CONTROL_CONGESTION</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">AST_CONTROL_HANGUP</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">AST_CONTROL_RINGING</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01295">ast_dsp_busydetect()</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00091">ast_format_alaw</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00542">ast_format_cache_is_slinear()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00201">ast_format_cmp()</a>, <a class="el" href="../../d0/d0a/format_8h_source.html#l00036">AST_FORMAT_CMP_EQUAL</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00086">ast_format_ulaw</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00139">AST_FRAME_DTMF</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00125">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00099">AST_FRAME_DTMF_END</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00107">AST_FRAME_NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00577">ast_frisolate</a>, <a class="el" href="../../d6/db5/alaw_8h_source.html#l00050">AST_LIN2A</a>, <a class="el" href="../../d4/dc2/ulaw_8h_source.html#l00049">AST_LIN2MU</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/dc2/ulaw_8h_source.html#l00085">AST_MULAW</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01139">ast_queue_frame()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l01122">AST_SOFTHANGUP_DEV</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00437">ast_dsp::ced_tone_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00436">ast_dsp::cng_tone_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00307">digit_detect_state_t::current_digits</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">ast_frame::datalen</a>, <a class="el" href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">digit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00306">digit_detect_state_t::digitlen</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00426">ast_dsp::digitmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00305">digit_detect_state_t::digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00430">ast_dsp::display_inband_dtmf_warning</a>, <a class="el" href="../../dc/dbf/test__amihooks_8c_source.html#l00048">done</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00034">DSP_DIGITMODE_NOQUELCH</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00037">DSP_DIGITMODE_RELAXDTMF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00048">DSP_FAXMODE_DETECT_CED</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00047">DSP_FAXMODE_DETECT_CNG</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00027">DSP_FEATURE_BUSY_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00043">DSP_FEATURE_CALL_PROGRESS</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00028">DSP_FEATURE_DIGIT_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00029">DSP_FEATURE_FAX_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00045">DSP_FEATURE_FREQ_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00026">DSP_FEATURE_SILENCE_SUPPRESS</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00044">DSP_FEATURE_WAITDIALTONE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00429">ast_dsp::dtmf_began</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00389">fragment_t::end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00406">ast_dsp::f</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00427">ast_dsp::faxmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00412">ast_dsp::features</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00428">ast_dsp::freqmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00417">ast_dsp::historicnoise</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00418">ast_dsp::historicsilence</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">ast_frame_subclass::integer</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00193">ast_frame::len</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00434">ast_dsp::mute_data</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00432">ast_dsp::mute_fragments</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">ast_frame::src</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00388">fragment_t::start</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00838">chan_pjsip_read_stream()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l08418">dahdi_read()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00224">detect_callback()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l03745">fax_detect_framehook()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l01109">mbl_read()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l01181">mgcp_rtp_read()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l04978">ooh323_rtp_read()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l07318">process_ast_dsp()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00274">read_mf_digits()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00358">read_sf_digits()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l08631">sip_rtp_read()</a>, and <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;{</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <span class="keywordtype">int</span> silence;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a> = 0, fax_digit = 0, custom_freq_digit = 0;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   <span class="keywordtype">short</span> *shortdata;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *odata;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *outf = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   <span class="keywordflow">if</span> (!af) {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <span class="keywordflow">if</span> (af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordflow">return</span> af;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   }</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   odata = af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   len = af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   <span class="comment">/* Make sure we have short data */</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>)) {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      shortdata = af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      len = af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> / 2;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      shortdata = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * 2);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;         shortdata[x] = <a class="code" href="../../d4/dc2/ulaw_8h.html#a00ac194f4317c7c388bfe531f51c803a">AST_MULAW</a>(odata[x]);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      }</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      shortdata = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * 2);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;         shortdata[x] = <a class="code" href="../../d6/db5/alaw_8h.html#a85173bf923da21593f2db8132a70d4b0">AST_ALAW</a>(odata[x]);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="comment">/*Display warning only once. Otherwise you would get hundreds of warnings every second */</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">display_inband_dtmf_warning</a>) {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Inband DTMF is not supported on codec %s. Use RFC2833\n&quot;</span>, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>));</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">display_inband_dtmf_warning</a> = 0;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="keywordflow">return</span> af;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;   }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;   <span class="comment">/* Initially we do not want to mute anything */</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">mute_fragments</a> = 0;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="comment">/* Need to run the silence detection stuff for silence suppression and busy detection */</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#ab63492d48665481cbd29d913a6341b8e">DSP_FEATURE_SILENCE_SUPPRESS</a>) || (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a25ab003573ab7f608bc42723b3a5168a">DSP_FEATURE_BUSY_DETECT</a>)) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      res = <a class="code" href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a>(dsp, shortdata, len, &amp;silence, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   }</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#ab63492d48665481cbd29d913a6341b8e">DSP_FEATURE_SILENCE_SUPPRESS</a>) &amp;&amp; silence) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a29ff71f9d5c7927906ebd437fe372056">AST_FRAME_NULL</a>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(af);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;   }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a25ab003573ab7f608bc42723b3a5168a">DSP_FEATURE_BUSY_DETECT</a>) &amp;&amp; <a class="code" href="../../d5/d3b/dsp_8c.html#ad3349aaac5958df1f8a0147ebccf05dc">ast_dsp_busydetect</a>(dsp)) {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab683c21c4a34450c4bfb8b672a7b4045">ast_channel_softhangup_internal_flag_add</a>(chan, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a>);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(af);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Requesting Hangup because the busy tone was detected on channel %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;   }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a>)) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#aa97125e8415ed15db98bb7e79b17ab73">DSP_FAXMODE_DETECT_CNG</a>) &amp;&amp; <a class="code" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, shortdata, len)) {</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;         fax_digit = <span class="charliteral">&#39;f&#39;</span>;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      }</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a9cf0612744d70d091c16780d55d0a122">DSP_FAXMODE_DETECT_CED</a>) &amp;&amp; <a class="code" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>, shortdata, len)) {</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         fax_digit = <span class="charliteral">&#39;e&#39;</span>;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#aba34e93f4bf51e43868d1655efec7020">DSP_FEATURE_FREQ_DETECT</a>)) {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">freqmode</a>) &amp;&amp; <a class="code" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, shortdata, len)) {</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;         custom_freq_digit = <span class="charliteral">&#39;q&#39;</span>;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      }</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   }</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; (<a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a> | <a class="code" href="../../d3/d08/dsp_8h.html#a25ab003573ab7f608bc42723b3a5168a">DSP_FEATURE_BUSY_DETECT</a>)) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a>) {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;         digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a490046385646c599ef1b1983bd0f8c90">mf_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, shortdata, len, (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a3e5f9f8f26812f78103589047d426ea4">DSP_DIGITMODE_NOQUELCH</a>) == 0, (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#af955a2d9ad32683d8d783619480cd348">DSP_DIGITMODE_RELAXDTMF</a>));</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;         digit = <a class="code" href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, shortdata, len, (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a3e5f9f8f26812f78103589047d426ea4">DSP_DIGITMODE_NOQUELCH</a>) == 0, (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#af955a2d9ad32683d8d783619480cd348">DSP_DIGITMODE_RELAXDTMF</a>));</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>) {</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;         <span class="keywordtype">int</span> <span class="keyword">event</span> = 0, event_len = 0;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;         <span class="keywordtype">char</span> event_digit = 0;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;         <span class="keywordflow">if</span> (!dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">dtmf_began</a>) {</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="comment">/* We have not reported DTMF_BEGIN for anything yet */</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a>) {</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;               <span class="keyword">event</span> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be">AST_FRAME_DTMF_BEGIN</a>;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;               event_digit = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0];</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">dtmf_began</a> = 1;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> &gt; 1 || digit != dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0]) {</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <span class="comment">/* Digit changed. This means digit we have reported with DTMF_BEGIN ended */</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a>) {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;               <span class="keyword">event</span> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a>;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;               event_digit = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0];</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;               event_len = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[0] * 1000 / dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            memmove(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[0], &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[1], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            memmove(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[0], &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[1], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> * <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[0]));</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>--;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">dtmf_began</a> = 0;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a25ab003573ab7f608bc42723b3a5168a">DSP_FEATURE_BUSY_DETECT</a>) {</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;               <span class="comment">/* Reset Busy Detector as we have some confirmed activity */</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;               memset(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>));</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;               memset(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>));</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;DTMF Detected - Reset busydetector\n&quot;</span>);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;         }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../df/d7d/structevent.html">event</a>) {</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../df/d7d/structevent.html">event</a>;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> = event_digit;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a> = event_len;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            outf = &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;         }</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      }</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;   }</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   <span class="keywordflow">if</span> (fax_digit) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <span class="comment">/* Fax was detected - digit is either &#39;q&#39; or &#39;r&#39; */</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> = fax_digit;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      outf = &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;   }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;   <span class="keywordflow">if</span> (custom_freq_digit) {</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="comment">/* Custom frequency was detected - digit is &#39;q&#39; */</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> = custom_freq_digit;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      outf = &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;   <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a>)) {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      res = <a class="code" href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a>(dsp, shortdata, len);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         <span class="keywordflow">switch</span> (res) {</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>:</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>:</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            memset(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>));</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> = res;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = <span class="stringliteral">&quot;dsp_progress&quot;</span>;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <span class="keywordflow">if</span> (chan) {</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(chan, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">f</a>);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            }</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Don&#39;t know how to represent call progress message %d\n&quot;</span>, res);</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;         }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a1d5cf337f5788319b8ba8bf6d161dce5">DSP_FEATURE_WAITDIALTONE</a>)) {</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      res = <a class="code" href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a>(dsp, shortdata, len);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>:</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <span class="comment">/* Mute fragment of the frame */</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">mute_fragments</a>; x++) {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      memset(shortdata + dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">mute_data</a>[x].<a class="code" href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">start</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a>) * (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">mute_data</a>[x].<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> - dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">mute_data</a>[x].<a class="code" href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">start</a>));</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;         odata[x] = <a class="code" href="../../d4/dc2/ulaw_8h.html#a8e5e288eb1167065a9a235f79dcfee89">AST_LIN2MU</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) shortdata[x]);</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      }</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(af-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;         odata[x] = <a class="code" href="../../d6/db5/alaw_8h.html#a45b65da856bb05f79d22425d41457e0f">AST_LIN2A</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) shortdata[x]);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   <span class="keywordflow">if</span> (outf) {</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">if</span> (chan) {</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(chan, af);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      }</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(af);</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a>(outf);</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="keywordflow">return</span> af;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   }</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;}</div><div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00036">format.h:36</a></div></div>
<div class="ttc" id="structfragment__t_html_a37722a150250e2a5a98e5e0d11e53449"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">fragment_t::start</a></div><div class="ttdeci">int start</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00388">dsp.c:388</a></div></div>
<div class="ttc" id="db_8h_html_aa343fa3b3d06292b959ffdd4c4703b06"><div class="ttname"><a href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a></div><div class="ttdeci">short int16_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4e/db_8h_source.html#l00059">db.h:59</a></div></div>
<div class="ttc" id="structast__dsp_html_ac923c92546ce2e7061c6e6d241f7f678"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">ast_dsp::freqmode</a></div><div class="ttdeci">int freqmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00428">dsp.c:428</a></div></div>
<div class="ttc" id="dsp_8h_html_a84818b360426bdd5f588cdca463e15be"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_DIGIT_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00028">dsp.h:28</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="structast__dsp_html_a735f764b1095611ace084e7c6c06857d"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a735f764b1095611ace084e7c6c06857d">ast_dsp::f</a></div><div class="ttdeci">struct ast_frame f</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00406">dsp.c:406</a></div></div>
<div class="ttc" id="dsp_8h_html_a5c7b41ef167d85ab193697e010dce94b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a></div><div class="ttdeci">#define DSP_DIGITMODE_MF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00032">dsp.h:32</a></div></div>
<div class="ttc" id="format__cache_8h_html_a568c3f5838b53c38f11996dbe5ff5785"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a></div><div class="ttdeci">struct ast_format * ast_format_ulaw</div><div class="ttdoc">Built-in cached ulaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00086">format_cache.c:86</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="alaw_8h_html_a85173bf923da21593f2db8132a70d4b0"><div class="ttname"><a href="../../d6/db5/alaw_8h.html#a85173bf923da21593f2db8132a70d4b0">AST_ALAW</a></div><div class="ttdeci">#define AST_ALAW(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db5/alaw_8h_source.html#l00084">alaw.h:84</a></div></div>
<div class="ttc" id="dsp_8h_html_aa21ad1de4ef65e04563f6283a2213e25"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa21ad1de4ef65e04563f6283a2213e25">DSP_FEATURE_CALL_PROGRESS</a></div><div class="ttdeci">#define DSP_FEATURE_CALL_PROGRESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00043">dsp.h:43</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="dsp_8c_html_a309197e46487283dfa6c7614a3e3d1f9"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a309197e46487283dfa6c7614a3e3d1f9">__ast_dsp_call_progress</a></div><div class="ttdeci">static int __ast_dsp_call_progress(struct ast_dsp *dsp, short *s, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01074">dsp.c:1074</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="structast__dsp_html_a8d44232b19e9d5b8976167ce4600408a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">ast_dsp::historicsilence</a></div><div class="ttdeci">int historicsilence[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00418">dsp.c:418</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01122">channel.h:1122</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_ac74ec91ceeab32c9468de13feb7c4d33"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">digit_detect_state_t::current_digits</a></div><div class="ttdeci">int current_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00307">dsp.c:307</a></div></div>
<div class="ttc" id="dsp_8c_html_aa25d091473980e52735b884cabe319ce"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a></div><div class="ttdeci">static int dtmf_detect(struct ast_dsp *dsp, digit_detect_state_t *s, int16_t amp[], int samples, int squelch, int relax)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00693">dsp.c:693</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">include/asterisk/frame.h:282</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a248afd6c02044259a386f6b7aee922a2"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a></div><div class="ttdeci">#define AST_FRAME_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00139">include/asterisk/frame.h:139</a></div></div>
<div class="ttc" id="dsp_8c_html_ad3349aaac5958df1f8a0147ebccf05dc"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad3349aaac5958df1f8a0147ebccf05dc">ast_dsp_busydetect</a></div><div class="ttdeci">int ast_dsp_busydetect(struct ast_dsp *dsp)</div><div class="ttdoc">Return non-zero if historically this should be a busy, request that ast_dsp_silence has already been ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01295">dsp.c:1295</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="structast__dsp_html_a094105f8d645c85f853b07b09afd5f66"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">ast_dsp::historicnoise</a></div><div class="ttdeci">int historicnoise[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00417">dsp.c:417</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_abc255092d94df3f9fc5937c9177bcf3c"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digit_detect_state_t::digits</a></div><div class="ttdeci">char digits[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00305">dsp.c:305</a></div></div>
<div class="ttc" id="test__amihooks_8c_html_a5992b274cfdcacdbc1fa8347fd01ebde"><div class="ttname"><a href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a></div><div class="ttdeci">int done</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dbf/test__amihooks_8c_source.html#l00048">test_amihooks.c:48</a></div></div>
<div class="ttc" id="dsp_8h_html_af955a2d9ad32683d8d783619480cd348"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#af955a2d9ad32683d8d783619480cd348">DSP_DIGITMODE_RELAXDTMF</a></div><div class="ttdeci">#define DSP_DIGITMODE_RELAXDTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00037">dsp.h:37</a></div></div>
<div class="ttc" id="structast__dsp_html_a16e504da5771f1589a97d3164a3b08b8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">ast_dsp::faxmode</a></div><div class="ttdeci">int faxmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00427">dsp.c:427</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_adece183191b0e700e039e59101e06105"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">ast_frame_subclass::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">include/asterisk/frame.h:152</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="format_8h_html_a738c58eca291b71de4422e95bff27400"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cmp(const struct ast_format *format1, const struct ast_format *format2)</div><div class="ttdoc">Compare two formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00201">format.c:201</a></div></div>
<div class="ttc" id="structast__frame_html_af51e37c9331049b1e3d250a7c8bc3c26"><div class="ttname"><a href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">ast_frame::src</a></div><div class="ttdeci">const char * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">include/asterisk/frame.h:181</a></div></div>
<div class="ttc" id="ulaw_8h_html_a00ac194f4317c7c388bfe531f51c803a"><div class="ttname"><a href="../../d4/dc2/ulaw_8h.html#a00ac194f4317c7c388bfe531f51c803a">AST_MULAW</a></div><div class="ttdeci">#define AST_MULAW(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc2/ulaw_8h_source.html#l00085">ulaw.h:85</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="dsp_8h_html_ab63492d48665481cbd29d913a6341b8e"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#ab63492d48665481cbd29d913a6341b8e">DSP_FEATURE_SILENCE_SUPPRESS</a></div><div class="ttdeci">#define DSP_FEATURE_SILENCE_SUPPRESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00026">dsp.h:26</a></div></div>
<div class="ttc" id="dsp_8h_html_a92045e8a8ad56b9b31d24db325fa95ab"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_FAX_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00029">dsp.h:29</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a29ff71f9d5c7927906ebd437fe372056"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a29ff71f9d5c7927906ebd437fe372056">AST_FRAME_NULL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00107">include/asterisk/frame.h:107</a></div></div>
<div class="ttc" id="format__cache_8h_html_a309515067d94f11b99659093c5beefee"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a></div><div class="ttdeci">int ast_format_cache_is_slinear(struct ast_format *format)</div><div class="ttdoc">Determines if a format is one of the cached slin formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00542">format_cache.c:542</a></div></div>
<div class="ttc" id="channel_8h_html_a6cbcba5661d55216968cde8fdf913c89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a></div><div class="ttdeci">int ast_queue_frame(struct ast_channel *chan, struct ast_frame *f)</div><div class="ttdoc">Queue one or more frames to a channel&amp;#39;s frame queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01139">channel.c:1139</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">include/asterisk/frame.h:105</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="structfragment__t_html_abce9f5dc9c83f2639b72024fdee5d388"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">fragment_t::end</a></div><div class="ttdeci">int end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00389">dsp.c:389</a></div></div>
<div class="ttc" id="dsp_8c_html_a490046385646c599ef1b1983bd0f8c90"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a490046385646c599ef1b1983bd0f8c90">mf_detect</a></div><div class="ttdeci">static int mf_detect(struct ast_dsp *dsp, digit_detect_state_t *s, int16_t amp[], int samples, int squelch, int relax)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00900">dsp.c:900</a></div></div>
<div class="ttc" id="structast__dsp_html_aba87c96f3d55cec3433197cb774bdb81"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aba87c96f3d55cec3433197cb774bdb81">ast_dsp::dtmf_began</a></div><div class="ttdeci">int dtmf_began</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00429">dsp.c:429</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00099">include/asterisk/frame.h:99</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">include/asterisk/frame.h:278</a></div></div>
<div class="ttc" id="dsp_8h_html_a9cf0612744d70d091c16780d55d0a122"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a9cf0612744d70d091c16780d55d0a122">DSP_FAXMODE_DETECT_CED</a></div><div class="ttdeci">#define DSP_FAXMODE_DETECT_CED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00048">dsp.h:48</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structast__dsp_html_aa1e47d1242ef7ba65183a2c3e88e339d"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">ast_dsp::digitmode</a></div><div class="ttdeci">int digitmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00426">dsp.c:426</a></div></div>
<div class="ttc" id="dsp_8h_html_a25ab003573ab7f608bc42723b3a5168a"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a25ab003573ab7f608bc42723b3a5168a">DSP_FEATURE_BUSY_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_BUSY_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00027">dsp.h:27</a></div></div>
<div class="ttc" id="dsp_8c_html_af719a82882e371e7b6e6fb2b8c009c74"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a></div><div class="ttdeci">static int __ast_dsp_silence_noise(struct ast_dsp *dsp, short *s, int len, int *totalsilence, int *totalnoise, int *frames_energy)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01229">dsp.c:1229</a></div></div>
<div class="ttc" id="structast__dsp_html_a227e7147c3d372e856173f9374fd9a10"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">ast_dsp::mute_fragments</a></div><div class="ttdeci">int mute_fragments</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00432">dsp.c:432</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a314496ce1d74ed7fdb9c5319c5e2e953"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a></div><div class="ttdeci">#define ast_frisolate(fr)</div><div class="ttdoc">Makes a frame independent of any static storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00577">include/asterisk/frame.h:577</a></div></div>
<div class="ttc" id="structast__dsp_html_a95d087aa0676d2cbc3e25cdd045311f7"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">ast_dsp::features</a></div><div class="ttdeci">int features</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00412">dsp.c:412</a></div></div>
<div class="ttc" id="structast__dsp_html_a8730f4e587506f00367fe9324658c2fd"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ast_dsp::ced_tone_state</a></div><div class="ttdeci">tone_detect_state_t ced_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00437">dsp.c:437</a></div></div>
<div class="ttc" id="dsp_8c_html_a399ce184a63aad01299671419040ded7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a></div><div class="ttdeci">static int tone_detect(struct ast_dsp *dsp, tone_detect_state_t *s, int16_t *amp, int samples)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00573">dsp.c:573</a></div></div>
<div class="ttc" id="format__cache_8h_html_a95c058fe6adef68780f026d6aec2481c"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a></div><div class="ttdeci">struct ast_format * ast_format_alaw</div><div class="ttdoc">Built-in cached alaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00091">format_cache.c:91</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="structast__dsp_html_ab6401bd4f3bb3fcdd01650e97952b79e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">ast_dsp::display_inband_dtmf_warning</a></div><div class="ttdeci">int display_inband_dtmf_warning</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00430">dsp.c:430</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structast__dsp_html_af2dd36b2153d471a6cc303c4ce77ab95"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">ast_dsp::cng_tone_state</a></div><div class="ttdeci">tone_detect_state_t cng_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00436">dsp.c:436</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="channel_8h_html_ab683c21c4a34450c4bfb8b672a7b4045"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab683c21c4a34450c4bfb8b672a7b4045">ast_channel_softhangup_internal_flag_add</a></div><div class="ttdeci">void ast_channel_softhangup_internal_flag_add(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01005">channel_internal_api.c:1005</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_aa75910b0b36bbf7b4ed69cad18c34d3a"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digit_detect_state_t::digitlen</a></div><div class="ttdeci">int digitlen[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00306">dsp.c:306</a></div></div>
<div class="ttc" id="dsp_8h_html_aa97125e8415ed15db98bb7e79b17ab73"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa97125e8415ed15db98bb7e79b17ab73">DSP_FAXMODE_DETECT_CNG</a></div><div class="ttdeci">#define DSP_FAXMODE_DETECT_CNG</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00047">dsp.h:47</a></div></div>
<div class="ttc" id="structast__dsp_html_a092a89a548303c7c2359aa3feb70348c"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">ast_dsp::mute_data</a></div><div class="ttdeci">fragment_t mute_data[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00434">dsp.c:434</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="dsp_8h_html_a3e5f9f8f26812f78103589047d426ea4"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a3e5f9f8f26812f78103589047d426ea4">DSP_DIGITMODE_NOQUELCH</a></div><div class="ttdeci">#define DSP_DIGITMODE_NOQUELCH</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00034">dsp.h:34</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be">AST_FRAME_DTMF_BEGIN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00125">include/asterisk/frame.h:125</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="dsp_8h_html_aba34e93f4bf51e43868d1655efec7020"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aba34e93f4bf51e43868d1655efec7020">DSP_FEATURE_FREQ_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_FREQ_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00045">dsp.h:45</a></div></div>
<div class="ttc" id="dsp_8h_html_a1d5cf337f5788319b8ba8bf6d161dce5"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a1d5cf337f5788319b8ba8bf6d161dce5">DSP_FEATURE_WAITDIALTONE</a></div><div class="ttdeci">#define DSP_FEATURE_WAITDIALTONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00044">dsp.h:44</a></div></div>
<div class="ttc" id="structast__frame_html_aaccba9d5adc3f6c39aad767db95ba484"><div class="ttname"><a href="../../d0/d99/structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">ast_frame::len</a></div><div class="ttdeci">long len</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00193">include/asterisk/frame.h:193</a></div></div>
<div class="ttc" id="ulaw_8h_html_a8e5e288eb1167065a9a235f79dcfee89"><div class="ttname"><a href="../../d4/dc2/ulaw_8h.html#a8e5e288eb1167065a9a235f79dcfee89">AST_LIN2MU</a></div><div class="ttdeci">#define AST_LIN2MU(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc2/ulaw_8h_source.html#l00049">ulaw.h:49</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">include/asterisk/frame.h:285</a></div></div>
<div class="ttc" id="alaw_8h_html_a45b65da856bb05f79d22425d41457e0f"><div class="ttname"><a href="../../d6/db5/alaw_8h.html#a45b65da856bb05f79d22425d41457e0f">AST_LIN2A</a></div><div class="ttdeci">#define AST_LIN2A(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db5/alaw_8h_source.html#l00050">alaw.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="affdbf305e6266be1228a571fccf28c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affdbf305e6266be1228a571fccf28c45">&#9670;&nbsp;</a></span>ast_dsp_prog_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_dsp_prog_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">1700</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00115">FREQ_ARRAY_SIZE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00420">ast_dsp::freqcount</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00119">progress::freqs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00419">ast_dsp::freqs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00376">goertzel_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00422">ast_dsp::gsamp_size</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00421">ast_dsp::gsamps</a>, <a class="el" href="../../dc/dc2/f2c_8h_source.html#l00198">max</a>, <a class="el" href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00423">ast_dsp::progmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00413">ast_dsp::ringtimeout</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00118">progress::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01879">ast_dsp_set_call_progress_zone()</a>.</p>
<div class="fragment"><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;{</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a> = 0;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">gsamp_size</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a>[dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a>].<a class="code" href="../../d1/df7/structprogress.html#a21d89b33fb71e9017cd44b4986654ab2">size</a>;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a> = 0;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a>; x++) {</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a>[dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a>].<a class="code" href="../../d1/df7/structprogress.html#a43446aa1558992668b4b53d82696b74a">freqs</a>[x]) {</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[x], (<span class="keywordtype">float</span>)<a class="code" href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a>[dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a>].<a class="code" href="../../d1/df7/structprogress.html#a43446aa1558992668b4b53d82696b74a">freqs</a>[x], dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;         max = x + 1;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">freqcount</a> = <a class="code" href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a> = 0;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a42e47b1321fa8ce991a016a17b1c2db2"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">ast_dsp::freqs</a></div><div class="ttdeci">goertzel_state_t freqs[FREQ_ARRAY_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00419">dsp.c:419</a></div></div>
<div class="ttc" id="structprogress_html_a21d89b33fb71e9017cd44b4986654ab2"><div class="ttname"><a href="../../d1/df7/structprogress.html#a21d89b33fb71e9017cd44b4986654ab2">progress::size</a></div><div class="ttdeci">enum gsamp_size size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00118">dsp.c:118</a></div></div>
<div class="ttc" id="structprogress_html_a43446aa1558992668b4b53d82696b74a"><div class="ttname"><a href="../../d1/df7/structprogress.html#a43446aa1558992668b4b53d82696b74a">progress::freqs</a></div><div class="ttdeci">int freqs[FREQ_ARRAY_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00119">dsp.c:119</a></div></div>
<div class="ttc" id="dsp_8c_html_aa393efba8a1b3ccbb269e0ca7716f463"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa393efba8a1b3ccbb269e0ca7716f463">modes</a></div><div class="ttdeci">static struct progress modes[]</div></div>
<div class="ttc" id="structast__dsp_html_ab3381c0c9d9a71fb64ac238593c98d7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ab3381c0c9d9a71fb64ac238593c98d7e">ast_dsp::gsamp_size</a></div><div class="ttdeci">enum gsamp_size gsamp_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00422">dsp.c:422</a></div></div>
<div class="ttc" id="structast__dsp_html_a90920c61c3569534bc6411f978552d80"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a90920c61c3569534bc6411f978552d80">ast_dsp::freqcount</a></div><div class="ttdeci">int freqcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00420">dsp.c:420</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="dsp_8c_html_a334f9cc76595717181aae4bc088c3156"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a></div><div class="ttdeci">static void goertzel_init(goertzel_state_t *s, float freq, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00376">dsp.c:376</a></div></div>
<div class="ttc" id="structast__dsp_html_aca9840ebe7075b9e09a9b8e6546d987f"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">ast_dsp::gsamps</a></div><div class="ttdeci">int gsamps</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00421">dsp.c:421</a></div></div>
<div class="ttc" id="dsp_8c_html_ab0a3ea6e2a2c890d2ce0228327c877a7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab0a3ea6e2a2c890d2ce0228327c877a7">FREQ_ARRAY_SIZE</a></div><div class="ttdeci">#define FREQ_ARRAY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00115">dsp.c:115</a></div></div>
<div class="ttc" id="structast__dsp_html_ad20bd957eabb203120a091e13063e955"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ast_dsp::ringtimeout</a></div><div class="ttdeci">int ringtimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00413">dsp.c:413</a></div></div>
<div class="ttc" id="structast__dsp_html_a8f27a322054f8079506fca51ea0ef67a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">ast_dsp::progmode</a></div><div class="ttdeci">enum prog_mode progmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00423">dsp.c:423</a></div></div>
<div class="ttc" id="f2c_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00198">f2c.h:198</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a673744da45e35463b6500a17c360bebe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673744da45e35463b6500a17c360bebe">&#9670;&nbsp;</a></span>ast_dsp_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset total silence count. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01830">1830</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00419">ast_dsp::freqs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00421">ast_dsp::gsamps</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00417">ast_dsp::historicnoise</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00418">ast_dsp::historicsilence</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00413">ast_dsp::ringtimeout</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00409">ast_dsp::totalsilence</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d60/res__fax_8c_source.html#l00577">debug_check_frame_for_silence()</a>.</p>
<div class="fragment"><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;{</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">totalsilence</a> = 0;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">gsamps</a> = 0;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; 4; x++) {</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[x].<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">freqs</a>[x].<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = 0.0;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   }</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;   memset(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">historicsilence</a>));</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   memset(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">historicnoise</a>));</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ringtimeout</a> = 0;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a42e47b1321fa8ce991a016a17b1c2db2"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a42e47b1321fa8ce991a016a17b1c2db2">ast_dsp::freqs</a></div><div class="ttdeci">goertzel_state_t freqs[FREQ_ARRAY_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00419">dsp.c:419</a></div></div>
<div class="ttc" id="structast__dsp_html_a8d44232b19e9d5b8976167ce4600408a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8d44232b19e9d5b8976167ce4600408a">ast_dsp::historicsilence</a></div><div class="ttdeci">int historicsilence[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00418">dsp.c:418</a></div></div>
<div class="ttc" id="structast__dsp_html_a094105f8d645c85f853b07b09afd5f66"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a094105f8d645c85f853b07b09afd5f66">ast_dsp::historicnoise</a></div><div class="ttdeci">int historicnoise[DSP_HISTORY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00417">dsp.c:417</a></div></div>
<div class="ttc" id="structast__dsp_html_a37f3ccbb8c8ee286cec59a4b0340e924"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a37f3ccbb8c8ee286cec59a4b0340e924">ast_dsp::totalsilence</a></div><div class="ttdeci">int totalsilence</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00409">dsp.c:409</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="structast__dsp_html_aca9840ebe7075b9e09a9b8e6546d987f"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aca9840ebe7075b9e09a9b8e6546d987f">ast_dsp::gsamps</a></div><div class="ttdeci">int gsamps</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00421">dsp.c:421</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
<div class="ttc" id="structast__dsp_html_ad20bd957eabb203120a091e13063e955"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ad20bd957eabb203120a091e13063e955">ast_dsp::ringtimeout</a></div><div class="ttdeci">int ringtimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00413">dsp.c:413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5088d241f0f7c6e3c82bacfb4a5099b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5088d241f0f7c6e3c82bacfb4a5099b">&#9670;&nbsp;</a></span>ast_dsp_set_busy_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_set_busy_count </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cadences</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set number of required cadences for busy. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01780">1780</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00415">ast_dsp::busycount</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l00569">cadences</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00151">DSP_HISTORY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;{</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a> &lt; 4) {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <a class="code" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a> = 4;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   }</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a> &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>) {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <a class="code" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a>;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   }</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">busycount</a> = <a class="code" href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a>;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a29a1e575aa8b94876e2d3b8da3f6da2b"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a29a1e575aa8b94876e2d3b8da3f6da2b">ast_dsp::busycount</a></div><div class="ttdeci">int busycount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00415">dsp.c:415</a></div></div>
<div class="ttc" id="chan__dahdi_8c_html_ad07d646abd9d3f187412ff33dc665aee"><div class="ttname"><a href="../../d1/d97/chan__dahdi_8c.html#ad07d646abd9d3f187412ff33dc665aee">cadences</a></div><div class="ttdeci">static struct dahdi_ring_cadence cadences[NUM_CADENCE_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/chan__dahdi_8c_source.html#l00569">chan_dahdi.c:569</a></div></div>
<div class="ttc" id="dsp_8c_html_ab32788a6894e4f84d7c49ce6a2b4bd10"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab32788a6894e4f84d7c49ce6a2b4bd10">DSP_HISTORY</a></div><div class="ttdeci">#define DSP_HISTORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00151">dsp.c:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fa7b2c7a6105d4d7d3a73930a087dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fa7b2c7a6105d4d7d3a73930a087dd4">&#9670;&nbsp;</a></span>ast_dsp_set_busy_pattern()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_set_busy_pattern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d5b/structast__dsp__busy__pattern.html">ast_dsp_busy_pattern</a> *&#160;</td>
          <td class="paramname"><em>cadence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set expected lengths of the busy tone. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01791">1791</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00416">ast_dsp::busy_cadence</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00066">ast_dsp_busy_pattern::length</a>, and <a class="el" href="../../d3/d08/dsp_8h_source.html#l00068">ast_dsp_busy_pattern::pattern</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;{</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">busy_cadence</a> = *cadence;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;dsp busy pattern set to %d,%d,%d,%d\n&quot;</span>, cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[0], cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[1], (cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">length</a> == 4) ? cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[2] : 0, (cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">length</a> == 4) ? cadence-&gt;<a class="code" href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">pattern</a>[3] : 0);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;}</div><div class="ttc" id="structast__dsp__busy__pattern_html_a8bf4ddcdbc0a03e32898ba1c5a20c953"><div class="ttname"><a href="../../d0/d5b/structast__dsp__busy__pattern.html#a8bf4ddcdbc0a03e32898ba1c5a20c953">ast_dsp_busy_pattern::pattern</a></div><div class="ttdeci">int pattern[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00068">dsp.h:68</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__dsp__busy__pattern_html_a9f59b34b1f25fe00023291b678246bcc"><div class="ttname"><a href="../../d0/d5b/structast__dsp__busy__pattern.html#a9f59b34b1f25fe00023291b678246bcc">ast_dsp_busy_pattern::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00066">dsp.h:66</a></div></div>
<div class="ttc" id="structast__dsp_html_ae40d7af4dfc270d67db982403bcebba0"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ae40d7af4dfc270d67db982403bcebba0">ast_dsp::busy_cadence</a></div><div class="ttdeci">struct ast_dsp_busy_pattern busy_cadence</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00416">dsp.c:416</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9912e8fcfc4d76058656934932af0b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9912e8fcfc4d76058656934932af0b1">&#9670;&nbsp;</a></span>ast_dsp_set_call_progress_zone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_set_call_progress_zone </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>zone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set zone for doing progress detection. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01879">1879</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">ast_dsp_prog_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00106">progalias::mode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00105">progalias::name</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00423">ast_dsp::progmode</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;{</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a>); x++) {</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a>[x].<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, zone)) {</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;         dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">progmode</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a>[x].<a class="code" href="../../d3/dc3/structprogalias.html#aac12ed78a7d47865a1dba0dcdfff7f5a">mode</a>;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#affdbf305e6266be1228a571fccf28c45">ast_dsp_prog_reset</a>(dsp);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   }</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_affdbf305e6266be1228a571fccf28c45"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#affdbf305e6266be1228a571fccf28c45">ast_dsp_prog_reset</a></div><div class="ttdeci">static void ast_dsp_prog_reset(struct ast_dsp *dsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01700">dsp.c:1700</a></div></div>
<div class="ttc" id="dsp_8c_html_af83fee9a892df2842ec9d4560f5a65ed"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af83fee9a892df2842ec9d4560f5a65ed">aliases</a></div><div class="ttdeci">static struct progalias aliases[]</div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structprogalias_html_aac12ed78a7d47865a1dba0dcdfff7f5a"><div class="ttname"><a href="../../d3/dc3/structprogalias.html#aac12ed78a7d47865a1dba0dcdfff7f5a">progalias::mode</a></div><div class="ttdeci">enum prog_mode mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00106">dsp.c:106</a></div></div>
<div class="ttc" id="structast__dsp_html_a8f27a322054f8079506fca51ea0ef67a"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8f27a322054f8079506fca51ea0ef67a">ast_dsp::progmode</a></div><div class="ttdeci">enum prog_mode progmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00423">dsp.c:423</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa28ffa065bd46d09b5b06de2f77183b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28ffa065bd46d09b5b06de2f77183b0">&#9670;&nbsp;</a></span>ast_dsp_set_digitmode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_set_digitmode </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>digitmode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set digit mode. </p>
<dl class="section version"><dt>Version</dt><dd>1.6.1 renamed from ast_dsp_digitmode to ast_dsp_set_digitmode </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01844">1844</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00559">ast_digit_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00426">ast_dsp::digitmode</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00031">DSP_DIGITMODE_DTMF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00035">DSP_DIGITMODE_MUTECONF</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00036">DSP_DIGITMODE_MUTEMAX</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09512">analog_ss_thread()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l05992">dahdi_hangup()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l06545">dahdi_setoption()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04896">enable_dsp_detect()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l01494">mgcp_new()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l12095">mkintf()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01591">my_dsp_set_digitmode()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00413">ooh323_new()</a>, and <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00274">read_mf_digits()</a>.</p>
<div class="fragment"><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;{</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   <span class="keywordtype">int</span> <span class="keyword">new</span>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   <span class="keywordtype">int</span> old;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   old = dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> &amp; (<a class="code" href="../../d3/d08/dsp_8h.html#af0e16e88030540319d8a545dd7c2576c">DSP_DIGITMODE_DTMF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#aa34f768f0cae2ee8f2db1e8f57f02b21">DSP_DIGITMODE_MUTECONF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#a6d78a2f3c0532d36beca1b8b5e97eb30">DSP_DIGITMODE_MUTEMAX</a>);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <span class="keyword">new</span> = digitmode &amp; (<a class="code" href="../../d3/d08/dsp_8h.html#af0e16e88030540319d8a545dd7c2576c">DSP_DIGITMODE_DTMF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#aa34f768f0cae2ee8f2db1e8f57f02b21">DSP_DIGITMODE_MUTECONF</a> | <a class="code" href="../../d3/d08/dsp_8h.html#a6d78a2f3c0532d36beca1b8b5e97eb30">DSP_DIGITMODE_MUTEMAX</a>);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <span class="keywordflow">if</span> (old != <span class="keyword">new</span>) {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <span class="comment">/* Must initialize structures if switching from MF to DTMF or vice-versa */</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#ad8c546f85dd9daab37eeeb3761aba219">ast_digit_detect_init</a>(&amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, <span class="keyword">new</span> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a>, dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   }</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">digitmode</a> = digitmode;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ad8c546f85dd9daab37eeeb3761aba219"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad8c546f85dd9daab37eeeb3761aba219">ast_digit_detect_init</a></div><div class="ttdeci">static void ast_digit_detect_init(digit_detect_state_t *s, int mf, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00559">dsp.c:559</a></div></div>
<div class="ttc" id="dsp_8h_html_af0e16e88030540319d8a545dd7c2576c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#af0e16e88030540319d8a545dd7c2576c">DSP_DIGITMODE_DTMF</a></div><div class="ttdeci">#define DSP_DIGITMODE_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00031">dsp.h:31</a></div></div>
<div class="ttc" id="dsp_8h_html_a5c7b41ef167d85ab193697e010dce94b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a5c7b41ef167d85ab193697e010dce94b">DSP_DIGITMODE_MF</a></div><div class="ttdeci">#define DSP_DIGITMODE_MF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00032">dsp.h:32</a></div></div>
<div class="ttc" id="dsp_8h_html_aa34f768f0cae2ee8f2db1e8f57f02b21"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aa34f768f0cae2ee8f2db1e8f57f02b21">DSP_DIGITMODE_MUTECONF</a></div><div class="ttdeci">#define DSP_DIGITMODE_MUTECONF</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00035">dsp.h:35</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="dsp_8h_html_a6d78a2f3c0532d36beca1b8b5e97eb30"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a6d78a2f3c0532d36beca1b8b5e97eb30">DSP_DIGITMODE_MUTEMAX</a></div><div class="ttdeci">#define DSP_DIGITMODE_MUTEMAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00036">dsp.h:36</a></div></div>
<div class="ttc" id="structast__dsp_html_aa1e47d1242ef7ba65183a2c3e88e339d"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#aa1e47d1242ef7ba65183a2c3e88e339d">ast_dsp::digitmode</a></div><div class="ttdeci">int digitmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00426">dsp.c:426</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3cfa673380a4763168ce800db8b2f0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cfa673380a4763168ce800db8b2f0b">&#9670;&nbsp;</a></span>ast_dsp_set_faxmode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_set_faxmode </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>faxmode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set fax mode. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01870">1870</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00427">ast_dsp::faxmode</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d60/res__fax_8c_source.html#l03694">fax_detect_new()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00413">ooh323_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;{</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> != faxmode) {</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> = faxmode;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a504a394ff79bb1ebd4614f834e3b7dbe">ast_fax_detect_init</a>(dsp);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   }</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a16e504da5771f1589a97d3164a3b08b8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">ast_dsp::faxmode</a></div><div class="ttdeci">int faxmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00427">dsp.c:427</a></div></div>
<div class="ttc" id="dsp_8c_html_a504a394ff79bb1ebd4614f834e3b7dbe"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a504a394ff79bb1ebd4614f834e3b7dbe">ast_fax_detect_init</a></div><div class="ttdeci">static void ast_fax_detect_init(struct ast_dsp *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00511">dsp.c:511</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aedc7fa20fba91e3c018f6989e95c714b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc7fa20fba91e3c018f6989e95c714b">&#9670;&nbsp;</a></span>ast_dsp_set_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_set_features </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select feature set. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01755">1755</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00430">ast_dsp::display_inband_dtmf_warning</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00028">DSP_FEATURE_DIGIT_DETECT</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00412">ast_dsp::features</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00765">chan_pjsip_cng_tone_detected()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00838">chan_pjsip_read_stream()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l06473">dahdi_dtmf_detect_disable()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l06487">dahdi_dtmf_detect_enable()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l07231">dahdi_handle_dtmf()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09153">dahdi_new()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l08418">dahdi_read()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l06545">dahdi_setoption()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00399">detect_write()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04896">enable_dsp_detect()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l03694">fax_detect_new()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l01494">mgcp_new()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l12365">misdn_set_opt_exec()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01648">my_handle_dtmf()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l02225">my_new_analog_ast_channel()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00413">ooh323_new()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01530">pjsip_acf_dtmf_mode_write()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l05922">read_config()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00274">read_mf_digits()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00358">read_sf_digits()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l08631">sip_rtp_read()</a>, and <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;{</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">features</a> = features;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   <span class="keywordflow">if</span> (!(features &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a>)) {</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">display_inband_dtmf_warning</a> = 0;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   }</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;}</div><div class="ttc" id="dsp_8h_html_a84818b360426bdd5f588cdca463e15be"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_DIGIT_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00028">dsp.h:28</a></div></div>
<div class="ttc" id="structast__dsp_html_a95d087aa0676d2cbc3e25cdd045311f7"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a95d087aa0676d2cbc3e25cdd045311f7">ast_dsp::features</a></div><div class="ttdeci">int features</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00412">dsp.c:412</a></div></div>
<div class="ttc" id="structast__dsp_html_ab6401bd4f3bb3fcdd01650e97952b79e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ab6401bd4f3bb3fcdd01650e97952b79e">ast_dsp::display_inband_dtmf_warning</a></div><div class="ttdeci">int display_inband_dtmf_warning</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00430">dsp.c:430</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae20416739a14507c5ddfc7aa98e7b136"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20416739a14507c5ddfc7aa98e7b136">&#9670;&nbsp;</a></span>ast_dsp_set_freqmode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_set_freqmode </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>squelch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set arbitrary frequency detection mode. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01859">1859</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00522">ast_freq_detect_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00428">ast_dsp::freqmode</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00399">detect_write()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00358">read_sf_digits()</a>, and <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;{</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   <span class="keywordflow">if</span> (freq &gt; 0) {</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">freqmode</a> = 1;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a6f3a1bd1e502a74a9630b3769d742a44">ast_freq_detect_init</a>(dsp, freq, dur, <a class="code" href="../../d5/dd1/cdr__sqlite3__custom_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, squelch);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">freqmode</a> = 0;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   }</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;}</div><div class="ttc" id="structast__dsp_html_ac923c92546ce2e7061c6e6d241f7f678"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">ast_dsp::freqmode</a></div><div class="ttdeci">int freqmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00428">dsp.c:428</a></div></div>
<div class="ttc" id="cdr__sqlite3__custom_8c_html_ad6e663497d2c934364b3bcf07496b30b"><div class="ttname"><a href="../../d5/dd1/cdr__sqlite3__custom_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a></div><div class="ttdeci">static sqlite3 * db</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/cdr__sqlite3__custom_8c_source.html#l00060">cdr_sqlite3_custom.c:60</a></div></div>
<div class="ttc" id="dsp_8c_html_a6f3a1bd1e502a74a9630b3769d742a44"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a6f3a1bd1e502a74a9630b3769d742a44">ast_freq_detect_init</a></div><div class="ttdeci">static void ast_freq_detect_init(struct ast_dsp *s, int freq, int dur, int db, int squelch)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00522">dsp.c:522</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06a0b883127ba1f853e9e0fa5f29d81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a0b883127ba1f853e9e0fa5f29d81b">&#9670;&nbsp;</a></span>ast_dsp_set_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_dsp_set_threshold </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the minimum average magnitude threshold to determine talking by the DSP. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01775">1775</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00407">ast_dsp::threshold</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d5/d4c/app__waitforsilence_8c_source.html#l00154">do_waiting()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l01215">fax_session_new()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d2/d48/app__amd_8c_source.html#l00162">isAnsweringMachine()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../db/d4e/bridge__softmix_8c_source.html#l00303">set_softmix_bridge_data()</a>, and <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00260">set_talk_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;{</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a686599473d8ce395e95619896d88d539">threshold</a> = <a class="code" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a>;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;}</div><div class="ttc" id="dsp_8h_html_a11a8ce2b7eba2230cab37aad708d9abf"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abf">threshold</a></div><div class="ttdeci">threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00071">dsp.h:71</a></div></div>
<div class="ttc" id="structast__dsp_html_a686599473d8ce395e95619896d88d539"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a686599473d8ce395e95619896d88d539">ast_dsp::threshold</a></div><div class="ttdeci">int threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00407">dsp.c:407</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f3b67988bffb3addfbc8a4688fa466d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3b67988bffb3addfbc8a4688fa466d">&#9670;&nbsp;</a></span>ast_dsp_silence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_silence </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>totalsilence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the audio frame for silence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsp</td><td>DSP processing audio media. </td></tr>
    <tr><td class="paramname">f</td><td>Audio frame to process. </td></tr>
    <tr><td class="paramname">totalsilence</td><td>Variable to set to the total accumulated silence in ms seen by the DSP since the last noise.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the frame is silence. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01483">1483</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01433">ast_dsp_silence_noise_with_energy()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l00577">debug_check_frame_for_silence()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d2/d48/app__amd_8c_source.html#l00162">isAnsweringMachine()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00159">talk_detect_audiohook_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;{</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a>(dsp, f, totalsilence, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;}</div><div class="ttc" id="dsp_8c_html_aa93f65e11fefc33db1f1c89824693c68"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a></div><div class="ttdeci">static int ast_dsp_silence_noise_with_energy(struct ast_dsp *dsp, struct ast_frame *f, int *total, int *frames_energy, int noise)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01433">dsp.c:1433</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa93f65e11fefc33db1f1c89824693c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93f65e11fefc33db1f1c89824693c68">&#9670;&nbsp;</a></span>ast_dsp_silence_noise_with_energy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_dsp_silence_noise_with_energy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>frames_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noise</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01433">1433</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01229">__ast_dsp_silence_noise()</a>, <a class="el" href="../../d6/db5/alaw_8h_source.html#l00084">AST_ALAW</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00091">ast_format_alaw</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00542">ast_format_cache_is_slinear()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00201">ast_format_cmp()</a>, <a class="el" href="../../d0/d0a/format_8h_source.html#l00036">AST_FORMAT_CMP_EQUAL</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00086">ast_format_ulaw</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/dc2/ulaw_8h_source.html#l00085">AST_MULAW</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">ast_frame::datalen</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, and <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01488">ast_dsp_noise()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01483">ast_dsp_silence()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01478">ast_dsp_silence_with_energy()</a>.</p>
<div class="fragment"><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;{</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;   <span class="keywordtype">short</span> *s;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *odata;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;   <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;   }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t calculate silence on a non-voice frame\n&quot;</span>);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>)) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      s = f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      len = f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>/2;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      odata = f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      len = f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;         s = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(len * 2);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            s[x] = <a class="code" href="../../d4/dc2/ulaw_8h.html#a00ac194f4317c7c388bfe531f51c803a">AST_MULAW</a>(odata[x]);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         }</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         s = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(len * 2);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; x++) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            s[x] = <a class="code" href="../../d6/db5/alaw_8h.html#a85173bf923da21593f2db8132a70d4b0">AST_ALAW</a>(odata[x]);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can only calculate silence on signed-linear, alaw or ulaw frames :(\n&quot;</span>);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;   }</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   <span class="keywordflow">if</span> (noise) {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a>(dsp, s, len, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a>, frames_energy);</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a>(dsp, s, len, <a class="code" href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, frames_energy);</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;}</div><div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00036">format.h:36</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="format__cache_8h_html_a568c3f5838b53c38f11996dbe5ff5785"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a></div><div class="ttdeci">struct ast_format * ast_format_ulaw</div><div class="ttdoc">Built-in cached ulaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00086">format_cache.c:86</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="alaw_8h_html_a85173bf923da21593f2db8132a70d4b0"><div class="ttname"><a href="../../d6/db5/alaw_8h.html#a85173bf923da21593f2db8132a70d4b0">AST_ALAW</a></div><div class="ttdeci">#define AST_ALAW(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db5/alaw_8h_source.html#l00084">alaw.h:84</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="format_8h_html_a738c58eca291b71de4422e95bff27400"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cmp(const struct ast_format *format1, const struct ast_format *format2)</div><div class="ttdoc">Compare two formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00201">format.c:201</a></div></div>
<div class="ttc" id="ulaw_8h_html_a00ac194f4317c7c388bfe531f51c803a"><div class="ttname"><a href="../../d4/dc2/ulaw_8h.html#a00ac194f4317c7c388bfe531f51c803a">AST_MULAW</a></div><div class="ttdeci">#define AST_MULAW(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc2/ulaw_8h_source.html#l00085">ulaw.h:85</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="format__cache_8h_html_a309515067d94f11b99659093c5beefee"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a309515067d94f11b99659093c5beefee">ast_format_cache_is_slinear</a></div><div class="ttdeci">int ast_format_cache_is_slinear(struct ast_format *format)</div><div class="ttdoc">Determines if a format is one of the cached slin formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00542">format_cache.c:542</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="dsp_8c_html_af719a82882e371e7b6e6fb2b8c009c74"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af719a82882e371e7b6e6fb2b8c009c74">__ast_dsp_silence_noise</a></div><div class="ttdeci">static int __ast_dsp_silence_noise(struct ast_dsp *dsp, short *s, int len, int *totalsilence, int *totalnoise, int *frames_energy)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01229">dsp.c:1229</a></div></div>
<div class="ttc" id="format__cache_8h_html_a95c058fe6adef68780f026d6aec2481c"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a></div><div class="ttdeci">struct ast_format * ast_format_alaw</div><div class="ttdoc">Built-in cached alaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00091">format_cache.c:91</a></div></div>
<div class="ttc" id="res__adsi_8c_html_ac7af894858cf396a219d632f40afdc8d"><div class="ttname"><a href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a></div><div class="ttdeci">static int total</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d27/res__adsi_8c_source.html#l00968">res_adsi.c:968</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a584d2b608db31342bff90e53b52eda46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584d2b608db31342bff90e53b52eda46">&#9670;&nbsp;</a></span>ast_dsp_silence_with_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_silence_with_energy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>totalsilence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>frames_energy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the audio frame for silence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsp</td><td>DSP processing audio media. </td></tr>
    <tr><td class="paramname">f</td><td>Audio frame to process. </td></tr>
    <tr><td class="paramname">totalsilence</td><td>Variable to set to the total accumulated silence in ms seen by the DSP since the last noise. </td></tr>
    <tr><td class="paramname">frames_energy</td><td>Variable to set to the average energy of the samples in the frame.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the frame is silence. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01478">1478</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01433">ast_dsp_silence_noise_with_energy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d4e/bridge__softmix_8c_source.html#l00942">softmix_bridge_write_voice()</a>.</p>
<div class="fragment"><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;{</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a>(dsp, f, totalsilence, frames_energy, 0);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;}</div><div class="ttc" id="dsp_8c_html_aa93f65e11fefc33db1f1c89824693c68"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa93f65e11fefc33db1f1c89824693c68">ast_dsp_silence_noise_with_energy</a></div><div class="ttdeci">static int ast_dsp_silence_noise_with_energy(struct ast_dsp *dsp, struct ast_frame *f, int *total, int *frames_energy, int noise)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01433">dsp.c:1433</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace6f146702ec253a6189176566527d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace6f146702ec253a6189176566527d30">&#9670;&nbsp;</a></span>ast_dsp_was_muted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dsp_was_muted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if DSP code was muting any fragment of the last processed frame. Muting (squelching) happens when DSP code removes DTMF/MF/generic tones from the audio. </p>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01893">1893</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00432">ast_dsp::mute_fragments</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l08418">dahdi_read()</a>.</p>
<div class="fragment"><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;{</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;   <span class="keywordflow">return</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">mute_fragments</a> &gt; 0);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;}</div><div class="ttc" id="structast__dsp_html_a227e7147c3d372e856173f9374fd9a10"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">ast_dsp::mute_fragments</a></div><div class="ttdeci">int mute_fragments</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00432">dsp.c:432</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aabeaa12abf1b4984df95f0dcd6d11556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabeaa12abf1b4984df95f0dcd6d11556">&#9670;&nbsp;</a></span>ast_dtmf_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_dtmf_detect_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d42/structdtmf__detect__state__t.html">dtmf_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00531">531</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00284">dtmf_detect_state_t::col_out</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00288">dtmf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00290">dtmf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00320">dtmf_col</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00317">dtmf_row</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00289">dtmf_detect_state_t::energy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00376">goertzel_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00285">dtmf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00287">dtmf_detect_state_t::lasthit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00286">dtmf_detect_state_t::misses</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00283">dtmf_detect_state_t::row_out</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00559">ast_digit_detect_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;{</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a>(&amp;s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>[i], <a class="code" href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a>[i], sample_rate);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a>(&amp;s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>[i], <a class="code" href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[i], sample_rate);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">lasthit</a> = 0;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> = 0.0;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">hits</a> = 0;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   s-&gt;<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a> = 0;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div><div class="ttc" id="structdtmf__detect__state__t_html_acb6b7e41e677928ff3ee0f9930319eee"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">dtmf_detect_state_t::misses</a></div><div class="ttdeci">int misses</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00286">dsp.c:286</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a6eb4f6f645392a720b883b687918880f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">dtmf_detect_state_t::hits</a></div><div class="ttdeci">int hits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00285">dsp.c:285</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">dtmf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00288">dsp.c:288</a></div></div>
<div class="ttc" id="dsp_8c_html_add4d38fa22770d38c666f9b9361a1bee"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a></div><div class="ttdeci">static const float dtmf_col[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00320">dsp.c:320</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af1fb0b506fe9bf5d68b9e2d84393945e"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">dtmf_detect_state_t::lasthit</a></div><div class="ttdeci">int lasthit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00287">dsp.c:287</a></div></div>
<div class="ttc" id="dsp_8c_html_a89a046bbce1a7e6fc9ec15b88a22922c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a></div><div class="ttdeci">static const float dtmf_row[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00317">dsp.c:317</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">dtmf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00290">dsp.c:290</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_ae2a8d527cd8efbc81c4d39c2bf216c2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">dtmf_detect_state_t::col_out</a></div><div class="ttdeci">goertzel_state_t col_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00284">dsp.c:284</a></div></div>
<div class="ttc" id="dsp_8c_html_a334f9cc76595717181aae4bc088c3156"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a></div><div class="ttdeci">static void goertzel_init(goertzel_state_t *s, float freq, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00376">dsp.c:376</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a2d107b3b2dcebab8a10c9d39894f6b2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">dtmf_detect_state_t::energy</a></div><div class="ttdeci">float energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00289">dsp.c:289</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a08afba015760120cc445d7d7cf11c24f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">dtmf_detect_state_t::row_out</a></div><div class="ttdeci">goertzel_state_t row_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00283">dsp.c:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a504a394ff79bb1ebd4614f834e3b7dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a504a394ff79bb1ebd4614f834e3b7dbe">&#9670;&nbsp;</a></span>ast_fax_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_fax_detect_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">511</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00450">ast_tone_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00437">ast_dsp::ced_tone_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00436">ast_dsp::cng_tone_state</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00049">DSP_FAXMODE_DETECT_SQUELCH</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00219">FAX_TONE_CED_DB</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00218">FAX_TONE_CED_DURATION</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00217">FAX_TONE_CED_FREQ</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00211">FAX_TONE_CNG_DB</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00210">FAX_TONE_CNG_DURATION</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00209">FAX_TONE_CNG_FREQ</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00427">ast_dsp::faxmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00267">tone_detect_state_t::squelch</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01722">__ast_dsp_new()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01870">ast_dsp_set_faxmode()</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;{</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a>(&amp;s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a3ff20bb46c00387fe18ff35c859f8b7d">FAX_TONE_CNG_FREQ</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#adea655fc91152db6b182f17a212d6c87">FAX_TONE_CNG_DURATION</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a66baf787112a461a2e46fbb4352baa8f">FAX_TONE_CNG_DB</a>, s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a>(&amp;s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a7c57bc0b17a606cdf143de3f59099b1a">FAX_TONE_CED_FREQ</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a4c2ad645ef024b1f21f5a3e05e07eb24">FAX_TONE_CED_DURATION</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a1041464c0ba1ad755a0da7b9b9119233">FAX_TONE_CED_DB</a>, s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">faxmode</a> &amp; <a class="code" href="../../d3/d08/dsp_8h.html#a9baae529c58a54aaa53a0ccef8caa05e">DSP_FAXMODE_DETECT_SQUELCH</a>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>.<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> = 1;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>.<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> = 1;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div><div class="ttc" id="structtone__detect__state__t_html_a3b2d9962865c06939bce31989f96da16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">tone_detect_state_t::squelch</a></div><div class="ttdeci">int squelch</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00267">dsp.c:267</a></div></div>
<div class="ttc" id="dsp_8c_html_a3ff20bb46c00387fe18ff35c859f8b7d"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a3ff20bb46c00387fe18ff35c859f8b7d">FAX_TONE_CNG_FREQ</a></div><div class="ttdeci">#define FAX_TONE_CNG_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00209">dsp.c:209</a></div></div>
<div class="ttc" id="dsp_8c_html_a1041464c0ba1ad755a0da7b9b9119233"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a1041464c0ba1ad755a0da7b9b9119233">FAX_TONE_CED_DB</a></div><div class="ttdeci">#define FAX_TONE_CED_DB</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00219">dsp.c:219</a></div></div>
<div class="ttc" id="dsp_8h_html_a9baae529c58a54aaa53a0ccef8caa05e"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a9baae529c58a54aaa53a0ccef8caa05e">DSP_FAXMODE_DETECT_SQUELCH</a></div><div class="ttdeci">#define DSP_FAXMODE_DETECT_SQUELCH</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00049">dsp.h:49</a></div></div>
<div class="ttc" id="dsp_8c_html_adea655fc91152db6b182f17a212d6c87"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#adea655fc91152db6b182f17a212d6c87">FAX_TONE_CNG_DURATION</a></div><div class="ttdeci">#define FAX_TONE_CNG_DURATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00210">dsp.c:210</a></div></div>
<div class="ttc" id="dsp_8c_html_a7c57bc0b17a606cdf143de3f59099b1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a7c57bc0b17a606cdf143de3f59099b1a">FAX_TONE_CED_FREQ</a></div><div class="ttdeci">#define FAX_TONE_CED_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00217">dsp.c:217</a></div></div>
<div class="ttc" id="dsp_8c_html_a66baf787112a461a2e46fbb4352baa8f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a66baf787112a461a2e46fbb4352baa8f">FAX_TONE_CNG_DB</a></div><div class="ttdeci">#define FAX_TONE_CNG_DB</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00211">dsp.c:211</a></div></div>
<div class="ttc" id="dsp_8c_html_a4c2ad645ef024b1f21f5a3e05e07eb24"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a4c2ad645ef024b1f21f5a3e05e07eb24">FAX_TONE_CED_DURATION</a></div><div class="ttdeci">#define FAX_TONE_CED_DURATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00218">dsp.c:218</a></div></div>
<div class="ttc" id="structast__dsp_html_a16e504da5771f1589a97d3164a3b08b8"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a16e504da5771f1589a97d3164a3b08b8">ast_dsp::faxmode</a></div><div class="ttdeci">int faxmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00427">dsp.c:427</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e0be86964ca6f34d38c56724e317213"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a></div><div class="ttdeci">static void ast_tone_detect_init(tone_detect_state_t *s, int freq, int duration, int amp, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00450">dsp.c:450</a></div></div>
<div class="ttc" id="structast__dsp_html_a8730f4e587506f00367fe9324658c2fd"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ast_dsp::ced_tone_state</a></div><div class="ttdeci">tone_detect_state_t ced_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00437">dsp.c:437</a></div></div>
<div class="ttc" id="structast__dsp_html_af2dd36b2153d471a6cc303c4ce77ab95"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">ast_dsp::cng_tone_state</a></div><div class="ttdeci">tone_detect_state_t cng_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00436">dsp.c:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f3a1bd1e502a74a9630b3769d742a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f3a1bd1e502a74a9630b3769d742a44">&#9670;&nbsp;</a></span>ast_freq_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_freq_detect_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>squelch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00522">522</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00450">ast_tone_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00436">ast_dsp::cng_tone_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00428">ast_dsp::freqmode</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00433">ast_dsp::sample_rate</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00267">tone_detect_state_t::squelch</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01859">ast_dsp_set_freqmode()</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="comment">/* we can conveniently just use one of the two fax tone states */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a>(&amp;s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, freq, dur, <a class="code" href="../../d5/dd1/cdr__sqlite3__custom_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">freqmode</a> &amp; squelch) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      s-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>.<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> = 1;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div><div class="ttc" id="structtone__detect__state__t_html_a3b2d9962865c06939bce31989f96da16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">tone_detect_state_t::squelch</a></div><div class="ttdeci">int squelch</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00267">dsp.c:267</a></div></div>
<div class="ttc" id="structast__dsp_html_ac923c92546ce2e7061c6e6d241f7f678"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#ac923c92546ce2e7061c6e6d241f7f678">ast_dsp::freqmode</a></div><div class="ttdeci">int freqmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00428">dsp.c:428</a></div></div>
<div class="ttc" id="cdr__sqlite3__custom_8c_html_ad6e663497d2c934364b3bcf07496b30b"><div class="ttname"><a href="../../d5/dd1/cdr__sqlite3__custom_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a></div><div class="ttdeci">static sqlite3 * db</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/cdr__sqlite3__custom_8c_source.html#l00060">cdr_sqlite3_custom.c:60</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="dsp_8c_html_a0e0be86964ca6f34d38c56724e317213"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0e0be86964ca6f34d38c56724e317213">ast_tone_detect_init</a></div><div class="ttdeci">static void ast_tone_detect_init(tone_detect_state_t *s, int freq, int duration, int amp, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00450">dsp.c:450</a></div></div>
<div class="ttc" id="structast__dsp_html_af2dd36b2153d471a6cc303c4ce77ab95"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">ast_dsp::cng_tone_state</a></div><div class="ttdeci">tone_detect_state_t cng_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00436">dsp.c:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00071c3dbca6a6de4ecc8e0e614b4da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00071c3dbca6a6de4ecc8e0e614b4da5">&#9670;&nbsp;</a></span>ast_mf_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_mf_detect_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d5b/structmf__detect__state__t.html">mf_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00547">547</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00297">mf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00299">mf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00376">goertzel_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00298">mf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00323">mf_tones</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00296">mf_detect_state_t::tone_out</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00559">ast_digit_detect_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;{</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a>(&amp;s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[i], <a class="code" href="../../d5/d3b/dsp_8c.html#a91a715aad7eb8bd2f4cd29197fc6b24a">mf_tones</a>[i], sample_rate);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[0] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3] = s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4] = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   s-&gt;<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div><div class="ttc" id="structmf__detect__state__t_html_aefd6f30bb7df6a58d77f2e7032300889"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">mf_detect_state_t::tone_out</a></div><div class="ttdeci">goertzel_state_t tone_out[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00296">dsp.c:296</a></div></div>
<div class="ttc" id="dsp_8c_html_a334f9cc76595717181aae4bc088c3156"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a></div><div class="ttdeci">static void goertzel_init(goertzel_state_t *s, float freq, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00376">dsp.c:376</a></div></div>
<div class="ttc" id="dsp_8c_html_a91a715aad7eb8bd2f4cd29197fc6b24a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a91a715aad7eb8bd2f4cd29197fc6b24a">mf_tones</a></div><div class="ttdeci">static const float mf_tones[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00323">dsp.c:323</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_ab504ac2052e441f05b416f0582f169ea"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">mf_detect_state_t::hits</a></div><div class="ttdeci">int hits[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00298">dsp.c:298</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">mf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00299">dsp.c:299</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">mf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00297">dsp.c:297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02466">2466</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

</div>
</div>
<a id="aa35e0245ab713b259c5b43f07d635453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa35e0245ab713b259c5b43f07d635453">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">test_dsp_fax_detect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">2336</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01770">ast_dsp_free()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00437">ast_dsp::ced_tone_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00436">ast_dsp::cng_tone_state</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02274">test_tone_freq_sweep()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02034">TONE_AMPLITUDE_MAX</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02035">TONE_AMPLITUDE_MIN</a>.</p>
<div class="fragment"><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;{</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;fax&quot;</span>;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dsp/&quot;</span>;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;DSP fax tone detect unit test&quot;</span>;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;         <span class="stringliteral">&quot;Tests fax tone detection code.&quot;</span>;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;   }</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   dsp = <a class="code" href="../../d5/d3b/dsp_8c.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a>();</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;   <span class="keywordflow">if</span> (!dsp) {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   }</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;   result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;   <span class="comment">/* Test CNG tone amplitude detection */</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a1608982b489c76a3f71b01517518454c">test_tone_amplitude_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>)) {</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;   }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;   <span class="comment">/* Test CED tone amplitude detection */</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a1608982b489c76a3f71b01517518454c">test_tone_amplitude_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>)) {</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;   }</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;   <span class="comment">/* Test CNG tone frequency detection */</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a>)) {</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;   }</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">cng_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a>)) {</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;   <span class="comment">/* Test CED tone frequency detection */</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a>)) {</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   }</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ced_tone_state</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a>)) {</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   }</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a>(dsp);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;}</div><div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="dsp_8c_html_a5322cba7f6f5757cdc6f2e4f91890d62"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a5322cba7f6f5757cdc6f2e4f91890d62">test_tone_freq_sweep</a></div><div class="ttdeci">static int test_tone_freq_sweep(struct ast_test *test, struct ast_dsp *dsp, tone_detect_state_t *tone_state, short amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02274">dsp.c:2274</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structast__dsp_html"><div class="ttname"><a href="../../d6/de5/structast__dsp.html">ast_dsp</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00405">dsp.c:405</a></div></div>
<div class="ttc" id="dsp_8c_html_a0a57a1e374549eb2705068688f4046db"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a></div><div class="ttdeci">void ast_dsp_free(struct ast_dsp *dsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01770">dsp.c:1770</a></div></div>
<div class="ttc" id="dsp_8c_html_a1608982b489c76a3f71b01517518454c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a1608982b489c76a3f71b01517518454c">test_tone_amplitude_sweep</a></div><div class="ttdeci">static int test_tone_amplitude_sweep(struct ast_test *test, struct ast_dsp *dsp, tone_detect_state_t *tone_state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02037">dsp.c:2037</a></div></div>
<div class="ttc" id="dsp_8c_html_ab6a9990b37515687259bf26d889df2ed"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02035">dsp.c:2035</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="dsp_8c_html_a48060c65aa5909df6326d08ed76a692f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02034">dsp.c:2034</a></div></div>
<div class="ttc" id="structast__dsp_html_a8730f4e587506f00367fe9324658c2fd"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a8730f4e587506f00367fe9324658c2fd">ast_dsp::ced_tone_state</a></div><div class="ttdeci">tone_detect_state_t ced_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00437">dsp.c:437</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structast__dsp_html_af2dd36b2153d471a6cc303c4ce77ab95"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#af2dd36b2153d471a6cc303c4ce77ab95">ast_dsp::cng_tone_state</a></div><div class="ttdeci">tone_detect_state_t cng_tone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00436">dsp.c:436</a></div></div>
<div class="ttc" id="dsp_8c_html_a0a60e93006c8e1ca8fda922ae0e0da2c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a></div><div class="ttdeci">struct ast_dsp * ast_dsp_new(void)</div><div class="ttdoc">Allocates a new dsp, assumes 8khz for internal sample rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01745">dsp.c:1745</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2435c9e4b5da31fab47330e10d2925cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2435c9e4b5da31fab47330e10d2925cd">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">test_dsp_dtmf_detect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02392">2392</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01770">ast_dsp_free()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00326">dtmf_positions</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;{</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *dsp;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;dtmf&quot;</span>;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dsp/&quot;</span>;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;DSP DTMF detect unit test&quot;</span>;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;         <span class="stringliteral">&quot;Tests DTMF detection code.&quot;</span>;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;   dsp = <a class="code" href="../../d5/d3b/dsp_8c.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a>();</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;   <span class="keywordflow">if</span> (!dsp) {</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   }</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;   result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   <span class="keywordflow">for</span> (idx = 0; <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[idx]; ++idx) {</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a49096094cdd2a9121cc0c246218840da">test_dtmf_amplitude_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, idx)) {</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;         result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      }</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;   }</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   <span class="keywordflow">for</span> (idx = 0; <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[idx]; ++idx) {</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#ac9a19cdc49481a2f4b171f490022b56a">test_dtmf_twist_sweep</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, dsp, idx)) {</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;         result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      }</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   }</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a>(dsp);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ac9a19cdc49481a2f4b171f490022b56a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ac9a19cdc49481a2f4b171f490022b56a">test_dtmf_twist_sweep</a></div><div class="ttdeci">static int test_dtmf_twist_sweep(struct ast_test *test, struct ast_dsp *dsp, int digit_index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02176">dsp.c:2176</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="dsp_8c_html_a27699369d27243a453a74f24c1e0373b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a></div><div class="ttdeci">static const char dtmf_positions[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00326">dsp.c:326</a></div></div>
<div class="ttc" id="dsp_8c_html_a49096094cdd2a9121cc0c246218840da"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a49096094cdd2a9121cc0c246218840da">test_dtmf_amplitude_sweep</a></div><div class="ttdeci">static int test_dtmf_amplitude_sweep(struct ast_test *test, struct ast_dsp *dsp, int digit_index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02096">dsp.c:2096</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="structast__dsp_html"><div class="ttname"><a href="../../d6/de5/structast__dsp.html">ast_dsp</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00405">dsp.c:405</a></div></div>
<div class="ttc" id="dsp_8c_html_a0a57a1e374549eb2705068688f4046db"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a></div><div class="ttdeci">void ast_dsp_free(struct ast_dsp *dsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01770">dsp.c:1770</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dsp_8c_html_a0a60e93006c8e1ca8fda922ae0e0da2c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a></div><div class="ttdeci">struct ast_dsp * ast_dsp_new(void)</div><div class="ttdoc">Allocates a new dsp, assumes 8khz for internal sample rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01745">dsp.c:1745</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e0be86964ca6f34d38c56724e317213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0be86964ca6f34d38c56724e317213">&#9670;&nbsp;</a></span>ast_tone_detect_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_tone_detect_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00450">450</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00266">tone_detect_state_t::block_size</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00269">tone_detect_state_t::energy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00265">tone_detect_state_t::freq</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00376">goertzel_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00276">tone_detect_state_t::hit_count</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00273">tone_detect_state_t::hits_required</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00277">tone_detect_state_t::last_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00270">tone_detect_state_t::samples_pending</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00267">tone_detect_state_t::squelch</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00274">tone_detect_state_t::threshold</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00268">tone_detect_state_t::tone</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00511">ast_fax_detect_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00522">ast_freq_detect_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordtype">int</span> duration_samples;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordtype">float</span> x;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordtype">int</span> periods_in_block;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a> = freq;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="comment">/* Desired tone duration in samples */</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   duration_samples = duration * <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a> / 1000;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <span class="comment">/* We want to allow 10% deviation of tone duration */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   duration_samples = duration_samples * 9 / 10;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="comment">/* If we want to remove tone, it is important to have block size not</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">      to exceed frame size. Otherwise by the moment tone is detected it is too late</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">      to squelch it from previous frames. Block size is 20ms at the given sample rate.*/</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a> = (20 * <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>) / 1000;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   periods_in_block = s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a> * freq / <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="comment">/* Make sure we will have at least 5 periods at target frequency for analisys.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">      This may make block larger than expected packet and will make squelching impossible</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">      but at least we will be detecting the tone */</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordflow">if</span> (periods_in_block &lt; 5) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      periods_in_block = 5;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="comment">/* Now calculate final block size. It will contain integer number of periods */</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a> = periods_in_block * <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a> / freq;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="comment">/* tone_detect is generally only used to detect fax tones and we</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">      do not need squelching the fax tones */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> = 0;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="comment">/* Account for the first and the last block to be incomplete</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">      and thus no tone will be detected in them */</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">hits_required</a> = (duration_samples - (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a> - 1)) / s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a>(&amp;s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone</a>, freq, <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a> = s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a> = 0;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#aea678c244f0a2d57c55eaf866095376b">last_hit</a> = 0;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> = 0.0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="comment">/* We want tone energy to be amp decibels above the rest of the signal (the noise).</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">      According to Parseval&#39;s theorem the energy computed in time domain equals to energy</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">      computed in frequency domain. So subtracting energy in the frequency domain (Goertzel result)</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">      from the energy in the time domain we will get energy of the remaining signal (without the tone</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">      we are detecting). We will be checking that</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">      10*log(Ew / (Et - Ew)) &gt; amp</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">      Calculate threshold so that we will be actually checking</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">      Ew &gt; Et * threshold</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   x = pow(10.0, amp / 10.0);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a376acef8954eadc70f4b55e8e0588e13">threshold</a> = x / (x + 1);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Setup tone %d Hz, %d ms, block_size=%d, hits_required=%d\n&quot;</span>, freq, duration, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">hits_required</a>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div><div class="ttc" id="structtone__detect__state__t_html_ad5761886830ba92291e1c22e7df920a3"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">tone_detect_state_t::hits_required</a></div><div class="ttdeci">int hits_required</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00273">dsp.c:273</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a3b2d9962865c06939bce31989f96da16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">tone_detect_state_t::squelch</a></div><div class="ttdeci">int squelch</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00267">dsp.c:267</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ae0d22272b68e75d19ac0b80c01f806b6"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">tone_detect_state_t::freq</a></div><div class="ttdeci">int freq</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00265">dsp.c:265</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ac59ddf0973a442144767b1ff898d7296"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">tone_detect_state_t::samples_pending</a></div><div class="ttdeci">int samples_pending</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00270">dsp.c:270</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a2d107b3b2dcebab8a10c9d39894f6b2a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">tone_detect_state_t::energy</a></div><div class="ttdeci">float energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00269">dsp.c:269</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a376acef8954eadc70f4b55e8e0588e13"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a376acef8954eadc70f4b55e8e0588e13">tone_detect_state_t::threshold</a></div><div class="ttdeci">float threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00274">dsp.c:274</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="dsp_8c_html_a334f9cc76595717181aae4bc088c3156"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a334f9cc76595717181aae4bc088c3156">goertzel_init</a></div><div class="ttdeci">static void goertzel_init(goertzel_state_t *s, float freq, unsigned int sample_rate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00376">dsp.c:376</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_af1c43188701355ac6ce51b32d77fcb1a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">tone_detect_state_t::hit_count</a></div><div class="ttdeci">int hit_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00276">dsp.c:276</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a70b27761c7d0bd5cd90f4fe47e569b94"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">tone_detect_state_t::block_size</a></div><div class="ttdeci">int block_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00266">dsp.c:266</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a83b51f2e56aa08b601a3a4fd609f6d16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone_detect_state_t::tone</a></div><div class="ttdeci">goertzel_state_t tone</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00268">dsp.c:268</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_aea678c244f0a2d57c55eaf866095376b"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#aea678c244f0a2d57c55eaf866095376b">tone_detect_state_t::last_hit</a></div><div class="ttdeci">int last_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00277">dsp.c:277</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa25d091473980e52735b884cabe319ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25d091473980e52735b884cabe319ce">&#9670;&nbsp;</a></span>dtmf_detect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int dtmf_detect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a>&#160;</td>
          <td class="paramname"><em>amp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>squelch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>relax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">693</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00284">dtmf_detect_state_t::col_out</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00307">digit_detect_state_t::current_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00288">dtmf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00290">dtmf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00306">digit_detect_state_t::digitlen</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00312">digit_detect_state_t::dtmf</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00227">DTMF_GSIZE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00333">dtmf_hits_to_begin</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00334">dtmf_misses_to_end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00329">dtmf_normal_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00326">dtmf_positions</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00195">DTMF_RELATIVE_PEAK_COL</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00194">DTMF_RELATIVE_PEAK_ROW</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00330">dtmf_reverse_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00180">DTMF_THRESHOLD</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00196">DTMF_TO_TOTAL_ENERGY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00389">fragment_t::end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00289">dtmf_detect_state_t::energy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00382">goertzel_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00362">goertzel_result()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00336">goertzel_sample()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00285">dtmf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00287">dtmf_detect_state_t::lasthit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00286">dtmf_detect_state_t::misses</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00144">mute</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00440">mute_fragment()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00291">dtmf_detect_state_t::mute_samples</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00331">relax_dtmf_normal_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00332">relax_dtmf_reverse_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00283">dtmf_detect_state_t::row_out</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00388">fragment_t::start</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00680">store_digit()</a>, and <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>
<div class="fragment"><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="keywordtype">float</span> row_energy[4];</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="keywordtype">float</span> col_energy[4];</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keywordtype">int</span> sample;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="keywordtype">short</span> samp;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordtype">int</span> best_row;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="keywordtype">int</span> best_col;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keywordtype">int</span> hit;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keywordtype">int</span> limit;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <a class="code" href="../../d3/d6f/structfragment__t.html">fragment_t</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> = {0, 0};</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="keywordflow">if</span> (squelch &amp;&amp; s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &gt; 0) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &lt; samples) ? s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> : samples;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> -= mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   hit = 0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="keywordflow">for</span> (sample = 0; sample &lt; samples; sample = limit) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="comment">/* DTMF_GSIZE is optimised to meet the DTMF specs. */</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">if</span> ((samples - sample) &gt;= (<a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a> - s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a>)) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         limit = sample + (<a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a> - s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         limit = samples;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">/* The following unrolled loop takes only 35% (rough estimate) of the</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         time of a rolled loop on the machine on which it was developed */</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">for</span> (j = sample; j &lt; limit; j++) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         samp = amp[j];</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> += (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp * (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         <span class="comment">/* With GCC 2.95, the following unrolled code seems to take about 35%</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">            (rough estimate) as long as a neat little 0-3 loop */</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>, samp);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>, samp);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a> + 1, samp);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a> + 1, samp);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a> + 2, samp);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a> + 2, samp);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a> + 3, samp);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a> + 3, samp);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> += (limit - sample);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="comment">/* We are at the end of a DTMF detection block */</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="comment">/* Find the peak row and the peak column */</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      row_energy[0] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>[0]);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      col_energy[0] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>[0]);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordflow">for</span> (best_row = best_col = 0, i = 1; i &lt; 4; i++) {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         row_energy[i] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>[i]);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;         <span class="keywordflow">if</span> (row_energy[i] &gt; row_energy[best_row]) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            best_row = i;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         col_energy[i] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>[i]);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         <span class="keywordflow">if</span> (col_energy[i] &gt; col_energy[best_col]) {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            best_col = i;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;         }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      }</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(10, <span class="stringliteral">&quot;DTMF best &#39;%c&#39; Erow=%.4E Ecol=%.4E Erc=%.4E Et=%.4E\n&quot;</span>,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[(best_row &lt;&lt; 2) + best_col],</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         row_energy[best_row], col_energy[best_col],</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         row_energy[best_row] + col_energy[best_col], s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a>);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      hit = 0;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="comment">/* Basic signal level test and the twist test */</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span> (row_energy[best_row] &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a4dfb0e44eab6c69bc0e2573adb252d1c">DTMF_THRESHOLD</a> &amp;&amp;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          col_energy[best_col] &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a4dfb0e44eab6c69bc0e2573adb252d1c">DTMF_THRESHOLD</a> &amp;&amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          col_energy[best_col] &lt; row_energy[best_row] * (relax ? <a class="code" href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a> : <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a>) &amp;&amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          row_energy[best_row] &lt; col_energy[best_col] * (relax ? <a class="code" href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a> : <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a>)) {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         <span class="comment">/* Relative peak test */</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">if</span> ((i != best_col &amp;&amp;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                col_energy[i] * <a class="code" href="../../d5/d3b/dsp_8c.html#a7d287bf752cc52501e908920bdeda015">DTMF_RELATIVE_PEAK_COL</a> &gt; col_energy[best_col]) ||</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                (i != best_row</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                 &amp;&amp; row_energy[i] * <a class="code" href="../../d5/d3b/dsp_8c.html#ab2849942f55808d209a04916de88c6bb">DTMF_RELATIVE_PEAK_ROW</a> &gt; row_energy[best_row])) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;         }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         <span class="comment">/* ... and fraction of total energy test */</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;         <span class="keywordflow">if</span> (i &gt;= 4 &amp;&amp;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;             (row_energy[best_row] + col_energy[best_col]) &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a17557ece45a1ac2458c2a109ea80d84e">DTMF_TO_TOTAL_ENERGY</a> * s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a>) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="comment">/* Got a hit */</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            hit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[(best_row &lt;&lt; 2) + best_col];</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(10, <span class="stringliteral">&quot;DTMF hit &#39;%c&#39;\n&quot;</span>, hit);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;         }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"> * Adapted from ETSI ES 201 235-3 V1.3.1 (2006-03)</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"> * (40ms reference is tunable with hits_to_begin and misses_to_end)</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"> * each hit/miss is 12.75ms with DTMF_GSIZE at 102</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"> * Character recognition: When not DRC *(1) and then</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"> *      Shall exist VSC &gt; 40 ms (hits_to_begin)</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment"> *      May exist 20 ms &lt;= VSC &lt;= 40 ms</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"> *      Shall not exist VSC &lt; 20 ms</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"> * Character recognition: When DRC and then</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"> *      Shall cease Not VSC &gt; 40 ms (misses_to_end)</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> *      May cease 20 ms &gt;= Not VSC &gt;= 40 ms</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"> *      Shall not cease Not VSC &lt; 20 ms</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> * *(1) or optionally a different digit recognition condition</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> * Legend: VSC The continuous existence of a valid signal condition.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> *      Not VSC The continuous non-existence of valid signal condition.</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"> *      DRC The existence of digit recognition condition.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"> *      Not DRC The non-existence of digit recognition condition.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"> * Example: hits_to_begin=2 misses_to_end=3</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment"> * -------A last_hit=A hits=0&amp;1</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"> * ------AA hits=2 current_hit=A misses=0       BEGIN A</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"> * -----AA- misses=1 last_hit=&#39; &#39; hits=0</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"> * ----AA-- misses=2</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"> * ---AA--- misses=3 current_hit=&#39; &#39;            END A</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"> * --AA---B last_hit=B hits=0&amp;1</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"> * -AA---BC last_hit=C hits=0&amp;1</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"> * AA---BCC hits=2 current_hit=C misses=0       BEGIN C</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"> * A---BCC- misses=1 last_hit=&#39; &#39; hits=0</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"> * ---BCC-C misses=0 last_hit=C hits=0&amp;1</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"> * --BCC-CC misses=0</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"> * Example: hits_to_begin=3 misses_to_end=2</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"> * -------A last_hit=A hits=0&amp;1</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"> * ------AA hits=2</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"> * -----AAA hits=3 current_hit=A misses=0       BEGIN A</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"> * ----AAAB misses=1 last_hit=B hits=0&amp;1</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> * ---AAABB misses=2 current_hit=&#39; &#39; hits=2     END A</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> * --AAABBB hits=3 current_hit=B misses=0       BEGIN B</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> * -AAABBBB misses=0</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"> * Example: hits_to_begin=2 misses_to_end=2</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"> * -------A last_hit=A hits=0&amp;1</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"> * ------AA hits=2 current_hit=A misses=0       BEGIN A</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> * -----AAB misses=1 hits=0&amp;1</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"> * ----AABB misses=2 current_hit=&#39; &#39; hits=2 current_hit=B misses=0 BEGIN B</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"> * ---AABBB misses=0</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a>) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;         <span class="comment">/* We are in the middle of a digit already */</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;         <span class="keywordflow">if</span> (hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a>) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a>++;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a>) {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;               <span class="comment">/* There were enough misses to consider digit ended */</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;               s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a> = 0;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="comment">/* Current hit was same as last, so increment digit duration (of last digit) */</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> - 1] += <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">/* Look for a start of a new digit no matter if we are already in the middle of some</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">         digit or not. This is because hits_to_begin may be smaller than misses_to_end</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">         and we may find begin of new digit before we consider last one ended. */</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">if</span> (hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">lasthit</a>) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">lasthit</a> = hit;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">hits</a> = 0;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">if</span> (hit &amp;&amp; hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a>) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">hits</a>++;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;         <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">hits</a> == <a class="code" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a>) {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ad394d2a22bef4aaab1e90a8a9921f41b">store_digit</a>(s, hit);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> - 1] = <a class="code" href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a> * <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = hit;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">misses</a> = 0;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;         }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="comment">/* If we had a hit in this block, include it into mute fragment */</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">if</span> (squelch &amp;&amp; hit) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;         <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &lt; sample - <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="comment">/* There is a gap between fragments */</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            mute.<a class="code" href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">start</a> = (sample &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>) ? (sample - <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>) : 0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = limit + <a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="comment">/* Reinitialise the detector for the next block */</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">row_out</a>[i]);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">col_out</a>[i]);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> = 0.0;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <span class="keywordflow">if</span> (squelch &amp;&amp; mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>) {</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &gt; samples) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> = mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> - samples;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = samples;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keywordflow">return</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">dtmf</a>.<a class="code" href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a>); <span class="comment">/* return the debounced hit */</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ab10feaebebf59c9371f2268ee984f364"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a></div><div class="ttdeci">static void mute_fragment(struct ast_dsp *dsp, fragment_t *fragment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00440">dsp.c:440</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a07c84020c6c083f2732be8ff6a6c65ca"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a></div><div class="ttdeci">union digit_detect_state_t::@383 td</div></div>
<div class="ttc" id="dsp_8c_html_af097a604c6c8629d24ca1563a7c55160"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af097a604c6c8629d24ca1563a7c55160">relax_dtmf_reverse_twist</a></div><div class="ttdeci">static float relax_dtmf_reverse_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00332">dsp.c:332</a></div></div>
<div class="ttc" id="structfragment__t_html_a37722a150250e2a5a98e5e0d11e53449"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">fragment_t::start</a></div><div class="ttdeci">int start</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00388">dsp.c:388</a></div></div>
<div class="ttc" id="dsp_8c_html_a7d287bf752cc52501e908920bdeda015"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a7d287bf752cc52501e908920bdeda015">DTMF_RELATIVE_PEAK_COL</a></div><div class="ttdeci">#define DTMF_RELATIVE_PEAK_COL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00195">dsp.c:195</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a528b92081b5923d5748e62ce97d2534b"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">dtmf_detect_state_t::mute_samples</a></div><div class="ttdeci">int mute_samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00291">dsp.c:291</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_acb6b7e41e677928ff3ee0f9930319eee"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#acb6b7e41e677928ff3ee0f9930319eee">dtmf_detect_state_t::misses</a></div><div class="ttdeci">int misses</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00286">dsp.c:286</a></div></div>
<div class="ttc" id="dsp_8c_html_ab2849942f55808d209a04916de88c6bb"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab2849942f55808d209a04916de88c6bb">DTMF_RELATIVE_PEAK_ROW</a></div><div class="ttdeci">#define DTMF_RELATIVE_PEAK_ROW</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00194">dsp.c:194</a></div></div>
<div class="ttc" id="dsp_8c_html_a17557ece45a1ac2458c2a109ea80d84e"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a17557ece45a1ac2458c2a109ea80d84e">DTMF_TO_TOTAL_ENERGY</a></div><div class="ttdeci">#define DTMF_TO_TOTAL_ENERGY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00196">dsp.c:196</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a6eb4f6f645392a720b883b687918880f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a6eb4f6f645392a720b883b687918880f">dtmf_detect_state_t::hits</a></div><div class="ttdeci">int hits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00285">dsp.c:285</a></div></div>
<div class="ttc" id="dsp_8c_html_a4dfb0e44eab6c69bc0e2573adb252d1c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a4dfb0e44eab6c69bc0e2573adb252d1c">DTMF_THRESHOLD</a></div><div class="ttdeci">#define DTMF_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00180">dsp.c:180</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_ac74ec91ceeab32c9468de13feb7c4d33"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">digit_detect_state_t::current_digits</a></div><div class="ttdeci">int current_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00307">dsp.c:307</a></div></div>
<div class="ttc" id="dsp_8c_html_a27699369d27243a453a74f24c1e0373b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a></div><div class="ttdeci">static const char dtmf_positions[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00326">dsp.c:326</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">dtmf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00288">dsp.c:288</a></div></div>
<div class="ttc" id="dsp_8c_html_a7f207b5f13316dc0495304ee5b5d923c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a></div><div class="ttdeci">#define DTMF_GSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00227">dsp.c:227</a></div></div>
<div class="ttc" id="dsp_8c_html_aa823bf1feac16cc6fe3d06aad8b1262c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a></div><div class="ttdeci">static void goertzel_reset(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00382">dsp.c:382</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a29128ae5c15a12dea5fe4f263ba6cec1"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a></div><div class="ttdeci">static int mute</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00144">chan_alsa.c:144</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af1fb0b506fe9bf5d68b9e2d84393945e"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af1fb0b506fe9bf5d68b9e2d84393945e">dtmf_detect_state_t::lasthit</a></div><div class="ttdeci">int lasthit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00287">dsp.c:287</a></div></div>
<div class="ttc" id="dsp_8c_html_abc964f63482684acfd2937e981c678b7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abc964f63482684acfd2937e981c678b7">dtmf_hits_to_begin</a></div><div class="ttdeci">static int dtmf_hits_to_begin</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00333">dsp.c:333</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a8c1c9dbb611393e228a8a861ef042068"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a8c1c9dbb611393e228a8a861ef042068">digit_detect_state_t::dtmf</a></div><div class="ttdeci">dtmf_detect_state_t dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00312">dsp.c:312</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="dsp_8c_html_aba246381ba21cda471a8b4c5e81b48a5"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aba246381ba21cda471a8b4c5e81b48a5">dtmf_misses_to_end</a></div><div class="ttdeci">static int dtmf_misses_to_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00334">dsp.c:334</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">dtmf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00290">dsp.c:290</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_ae2a8d527cd8efbc81c4d39c2bf216c2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#ae2a8d527cd8efbc81c4d39c2bf216c2a">dtmf_detect_state_t::col_out</a></div><div class="ttdeci">goertzel_state_t col_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00284">dsp.c:284</a></div></div>
<div class="ttc" id="dsp_8c_html_ad394d2a22bef4aaab1e90a8a9921f41b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad394d2a22bef4aaab1e90a8a9921f41b">store_digit</a></div><div class="ttdeci">static void store_digit(digit_detect_state_t *s, char digit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00680">dsp.c:680</a></div></div>
<div class="ttc" id="structfragment__t_html_abce9f5dc9c83f2639b72024fdee5d388"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">fragment_t::end</a></div><div class="ttdeci">int end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00389">dsp.c:389</a></div></div>
<div class="ttc" id="dsp_8c_html_aec01db8127adabb95e443652f30963f2"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a></div><div class="ttdeci">static float dtmf_normal_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00329">dsp.c:329</a></div></div>
<div class="ttc" id="dsp_8c_html_ad2df3792a1bd43813423c43556bfe6b2"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad2df3792a1bd43813423c43556bfe6b2">relax_dtmf_normal_twist</a></div><div class="ttdeci">static float relax_dtmf_normal_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00331">dsp.c:331</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a2d107b3b2dcebab8a10c9d39894f6b2a"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">dtmf_detect_state_t::energy</a></div><div class="ttdeci">float energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00289">dsp.c:289</a></div></div>
<div class="ttc" id="dsp_8c_html_a8a84c56ff77f49a4a38c7dcb50134d61"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a></div><div class="ttdeci">static void goertzel_sample(goertzel_state_t *s, short sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00336">dsp.c:336</a></div></div>
<div class="ttc" id="structfragment__t_html"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html">fragment_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00387">dsp.c:387</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_aa75910b0b36bbf7b4ed69cad18c34d3a"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digit_detect_state_t::digitlen</a></div><div class="ttdeci">int digitlen[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00306">dsp.c:306</a></div></div>
<div class="ttc" id="dsp_8c_html_a63fc3d2975c956b5981217215285e6bd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a></div><div class="ttdeci">static float goertzel_result(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00362">dsp.c:362</a></div></div>
<div class="ttc" id="db_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4e/db_8h_source.html#l00060">db.h:60</a></div></div>
<div class="ttc" id="dsp_8c_html_a91f8036cdc5c4dca199e2d123f333087"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a></div><div class="ttdeci">static float dtmf_reverse_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00330">dsp.c:330</a></div></div>
<div class="ttc" id="structdtmf__detect__state__t_html_a08afba015760120cc445d7d7cf11c24f"><div class="ttname"><a href="../../df/d42/structdtmf__detect__state__t.html#a08afba015760120cc445d7d7cf11c24f">dtmf_detect_state_t::row_out</a></div><div class="ttdeci">goertzel_state_t row_out[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00283">dsp.c:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a334f9cc76595717181aae4bc088c3156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a334f9cc76595717181aae4bc088c3156">&#9670;&nbsp;</a></span>goertzel_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void goertzel_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sample_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00376">376</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00253">goertzel_state_t::chunky</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l00352">cos</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00255">goertzel_state_t::fac</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00083">M_PI</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">ast_dsp_prog_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00531">ast_dtmf_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00547">ast_mf_detect_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00450">ast_tone_detect_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">chunky</a> = 0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">fac</a> = (int)(32768.0 * 2.0 * <a class="code" href="../../d5/dff/chan__iax2_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a>(2.0 * <a class="code" href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * freq / <a class="code" href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">sample_rate</a>));</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div><div class="ttc" id="chan__iax2_8c_html_ae91dad65f553f7afebe4af507803bc7f"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a></div><div class="ttdeci">unsigned int cos</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00352">chan_iax2.c:352</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a02c4de9cefa10ed9ce982f4bf20b2c45"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">goertzel_state_t::fac</a></div><div class="ttdeci">int fac</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00255">dsp.c:255</a></div></div>
<div class="ttc" id="resample_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00083">resample.c:83</a></div></div>
<div class="ttc" id="structast__dsp_html_a1c086f81c095b0efd7a87ee29fc5ba7e"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a1c086f81c095b0efd7a87ee29fc5ba7e">ast_dsp::sample_rate</a></div><div class="ttdeci">unsigned int sample_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00433">dsp.c:433</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a62dcb0dfbf7d76ad21e0523758467048"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">goertzel_state_t::chunky</a></div><div class="ttdeci">int chunky</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00253">dsp.c:253</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa823bf1feac16cc6fe3d06aad8b1262c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa823bf1feac16cc6fe3d06aad8b1262c">&#9670;&nbsp;</a></span>goertzel_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void goertzel_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00382">382</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00253">goertzel_state_t::chunky</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01797">ast_dsp_digitreset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">chunky</a> = 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a62dcb0dfbf7d76ad21e0523758467048"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">goertzel_state_t::chunky</a></div><div class="ttdeci">int chunky</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00253">dsp.c:253</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a63fc3d2975c956b5981217215285e6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63fc3d2975c956b5981217215285e6bd">&#9670;&nbsp;</a></span>goertzel_result()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float goertzel_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00362">362</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00253">goertzel_state_t::chunky</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00255">goertzel_state_t::fac</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00260">goertzel_result_t::power</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00259">goertzel_result_t::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="../../d2/dbd/structgoertzel__result__t.html">goertzel_result_t</a> r;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   r.<a class="code" href="../../d2/dbd/structgoertzel__result__t.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = (s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> * s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a>) + (s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> * s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   r.<a class="code" href="../../d2/dbd/structgoertzel__result__t.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> -= ((s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> * s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a>) &gt;&gt; 15) * s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">fac</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">    * We have to double the exponent because we multiplied the</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">    * previous sample calculation values together.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   r.<a class="code" href="../../d2/dbd/structgoertzel__result__t.html#a0a923163c4d4ac8a2ecbf16f95d21fe2">power</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">chunky</a> * 2;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)r.<a class="code" href="../../d2/dbd/structgoertzel__result__t.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> * (float)(1 &lt;&lt; r.<a class="code" href="../../d2/dbd/structgoertzel__result__t.html#a0a923163c4d4ac8a2ecbf16f95d21fe2">power</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="ttc" id="structgoertzel__state__t_html_a02c4de9cefa10ed9ce982f4bf20b2c45"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">goertzel_state_t::fac</a></div><div class="ttdeci">int fac</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00255">dsp.c:255</a></div></div>
<div class="ttc" id="structgoertzel__result__t_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d2/dbd/structgoertzel__result__t.html#ac4f474c82e82cbb89ca7c36dd52be0ed">goertzel_result_t::value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00259">dsp.c:259</a></div></div>
<div class="ttc" id="structgoertzel__result__t_html_a0a923163c4d4ac8a2ecbf16f95d21fe2"><div class="ttname"><a href="../../d2/dbd/structgoertzel__result__t.html#a0a923163c4d4ac8a2ecbf16f95d21fe2">goertzel_result_t::power</a></div><div class="ttdeci">int power</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00260">dsp.c:260</a></div></div>
<div class="ttc" id="structgoertzel__result__t_html"><div class="ttname"><a href="../../d2/dbd/structgoertzel__result__t.html">goertzel_result_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00258">dsp.c:258</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a62dcb0dfbf7d76ad21e0523758467048"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">goertzel_state_t::chunky</a></div><div class="ttdeci">int chunky</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00253">dsp.c:253</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a84c56ff77f49a4a38c7dcb50134d61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a84c56ff77f49a4a38c7dcb50134d61">&#9670;&nbsp;</a></span>goertzel_sample()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void goertzel_sample </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d12/structgoertzel__state__t.html">goertzel_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>sample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00336">336</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/dc2/f2c_8h_source.html#l00195">abs</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00253">goertzel_state_t::chunky</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00255">goertzel_state_t::fac</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00249">goertzel_state_t::v2</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00251">goertzel_state_t::v3</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keywordtype">int</span> v1;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">    * Shift previous values so</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">    * v1 is previous previous value</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">    * v2 is previous value</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">    * until the new v3 is calculated.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   v1 = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="comment">/* Discard the binary fraction introduced by s-&gt;fac */</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = (s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">fac</a> * s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a>) &gt;&gt; 15;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="comment">/* Scale sample to match previous values */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> - v1 + (sample &gt;&gt; s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">chunky</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a>) &gt; (1 &lt;&lt; 15)) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">/* The result is now too large so increase the chunky power. */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">chunky</a>++;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">v3</a> &gt;&gt; 1;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> = s-&gt;<a class="code" href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">v2</a> &gt;&gt; 1;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="ttc" id="structgoertzel__state__t_html_a02c4de9cefa10ed9ce982f4bf20b2c45"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a02c4de9cefa10ed9ce982f4bf20b2c45">goertzel_state_t::fac</a></div><div class="ttdeci">int fac</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00255">dsp.c:255</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a1e875987c97698717b5977707b82fe22"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a1e875987c97698717b5977707b82fe22">goertzel_state_t::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00251">dsp.c:251</a></div></div>
<div class="ttc" id="f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00195">f2c.h:195</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_a62dcb0dfbf7d76ad21e0523758467048"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#a62dcb0dfbf7d76ad21e0523758467048">goertzel_state_t::chunky</a></div><div class="ttdeci">int chunky</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00253">dsp.c:253</a></div></div>
<div class="ttc" id="structgoertzel__state__t_html_aa517e2fff4a8c9cba11391ca12f91803"><div class="ttname"><a href="../../d1/d12/structgoertzel__state__t.html#aa517e2fff4a8c9cba11391ca12f91803">goertzel_state_t::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00249">dsp.c:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02442">2442</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00102">AST_MODULE_LOAD_FAILURE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02454">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;{</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a380a2a03c9d2b260bb9cbefe070fc1dd">_dsp_init</a>(0)) {</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a>;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;   }</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(test_dsp_fax_detect);</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(test_dsp_dtmf_detect);</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a></div><div class="ttdoc">Module could not be loaded properly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00102">module.h:102</a></div></div>
<div class="ttc" id="dsp_8c_html_a380a2a03c9d2b260bb9cbefe070fc1dd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a380a2a03c9d2b260bb9cbefe070fc1dd">_dsp_init</a></div><div class="ttdeci">static int _dsp_init(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01908">dsp.c:1908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a490046385646c599ef1b1983bd0f8c90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a490046385646c599ef1b1983bd0f8c90">&#9670;&nbsp;</a></span>mf_detect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int mf_detect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a>&#160;</td>
          <td class="paramname"><em>amp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>squelch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>relax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">900</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00327">bell_mf_positions</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00200">BELL_MF_RELATIVE_PEAK</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00198">BELL_MF_THRESHOLD</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00199">BELL_MF_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00297">mf_detect_state_t::current_hit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00299">mf_detect_state_t::current_sample</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00389">fragment_t::end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00382">goertzel_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00362">goertzel_result()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00336">goertzel_sample()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00298">mf_detect_state_t::hits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00313">digit_detect_state_t::mf</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00224">MF_GSIZE</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00144">mute</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00440">mute_fragment()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00300">mf_detect_state_t::mute_samples</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00388">fragment_t::start</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00680">store_digit()</a>, <a class="el" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00296">mf_detect_state_t::tone_out</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   <span class="keywordtype">float</span> energy[6];</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordtype">int</span> best;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   <span class="keywordtype">int</span> second_best;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keywordtype">int</span> sample;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="keywordtype">short</span> samp;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keywordtype">int</span> hit;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordtype">int</span> limit;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <a class="code" href="../../d3/d6f/structfragment__t.html">fragment_t</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> = {0, 0};</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   <span class="keywordflow">if</span> (squelch &amp;&amp; s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &gt; 0) {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &lt; samples) ? s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> : samples;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> -= mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   hit = 0;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   <span class="keywordflow">for</span> (sample = 0; sample &lt; samples; sample = limit) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="comment">/* 80 is optimised to meet the MF specs. */</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="comment">/* XXX So then why is MF_GSIZE defined as 120? */</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> ((samples - sample) &gt;= (<a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a> - s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a>)) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;         limit = sample + (<a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a> - s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         limit = samples;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="comment">/* The following unrolled loop takes only 35% (rough estimate) of the</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">         time of a rolled loop on the machine on which it was developed */</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordflow">for</span> (j = sample; j &lt; limit; j++) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         <span class="comment">/* With GCC 2.95, the following unrolled code seems to take about 35%</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">            (rough estimate) as long as a neat little 0-3 loop */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         samp = amp[j];</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>, samp);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a> + 1, samp);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a> + 2, samp);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a> + 3, samp);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a> + 4, samp);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a> + 5, samp);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> += (limit - sample);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>) {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="comment">/* We&#39;re at the end of an MF detection block.  */</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="comment">/* Find the two highest energies. The spec says to look for</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">         two tones and two tones only. Taking this literally -ie</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">         only two tones pass the minimum threshold - doesn&#39;t work</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">         well. The sinc function mess, due to rectangular windowing</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">         ensure that! Find the two highest energies and ensure they</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">         are considerably stronger than any of the others. */</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      energy[0] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[0]);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      energy[1] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[1]);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">if</span> (energy[0] &gt; energy[1]) {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;         best = 0;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;         second_best = 1;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         best = 1;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         second_best = 0;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="comment">/*endif*/</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">for</span> (i = 2; i &lt; 6; i++) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;         energy[i] = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[i]);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;         <span class="keywordflow">if</span> (energy[i] &gt;= energy[best]) {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            second_best = best;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            best = i;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (energy[i] &gt;= energy[second_best]) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            second_best = i;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;         }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">/* Basic signal level and twist tests */</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      hit = 0;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">if</span> (energy[best] &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a09cee9cae76ca825f6af9d9dedc25e63">BELL_MF_THRESHOLD</a> &amp;&amp; energy[second_best] &gt;= <a class="code" href="../../d5/d3b/dsp_8c.html#a09cee9cae76ca825f6af9d9dedc25e63">BELL_MF_THRESHOLD</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          &amp;&amp; energy[best] &lt; energy[second_best]*<a class="code" href="../../d5/d3b/dsp_8c.html#adb725f58c4d616aca44873f87a251ef6">BELL_MF_TWIST</a></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          &amp;&amp; energy[best] * <a class="code" href="../../d5/d3b/dsp_8c.html#adb725f58c4d616aca44873f87a251ef6">BELL_MF_TWIST</a> &gt; energy[second_best]) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;         <span class="comment">/* Relative peak test */</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;         hit = -1;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordflow">if</span> (i != best &amp;&amp; i != second_best) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;               <span class="keywordflow">if</span> (energy[i]*<a class="code" href="../../d5/d3b/dsp_8c.html#a1d14f26f0f1376d16a84ea7834f5be70">BELL_MF_RELATIVE_PEAK</a> &gt;= energy[second_best]) {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                  <span class="comment">/* The best two are not clearly the best */</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                  hit = 0;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;               }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;         }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">if</span> (hit) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         <span class="comment">/* Get the values into ascending order */</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         <span class="keywordflow">if</span> (second_best &lt; best) {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            i = best;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            best = second_best;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            second_best = i;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;         }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;         best = best * 5 + second_best - 1;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;         hit = <a class="code" href="../../d5/d3b/dsp_8c.html#a4ed69e4c904201b2dee62af600428e7c">bell_mf_positions</a>[best];</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;         <span class="comment">/* Look for two successive similar results */</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;         <span class="comment">/* The logic in the next test is:</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">            For KP we need 4 successive identical clean detects, with</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">            two blocks of something different preceeding it. For anything</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">            else we need two successive identical clean detects, with</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">            two blocks of something different preceeding it. */</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;         <span class="keywordflow">if</span> (hit == s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4] &amp;&amp; hit == s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3] &amp;&amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            ((hit != <span class="charliteral">&#39;*&#39;</span> &amp;&amp; hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2] &amp;&amp; hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1])||</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;             (hit == <span class="charliteral">&#39;*&#39;</span> &amp;&amp; hit == s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2] &amp;&amp; hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1] &amp;&amp;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;             hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[0]))) {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ad394d2a22bef4aaab1e90a8a9921f41b">store_digit</a>(s, hit);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;         }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">if</span> (hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4] &amp;&amp; hit != s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3]) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;         <span class="comment">/* Two successive block without a hit terminate current digit */</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a> = 0;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[0] = s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1];</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[1] = s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2];</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[2] = s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3];</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[3] = s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4];</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">hits</a>[4] = hit;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="comment">/* If we had a hit in this block, include it into mute fragment */</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordflow">if</span> (squelch &amp;&amp; hit) {</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;         <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &lt; sample - <a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="comment">/* There is a gap between fragments */</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            mute.<a class="code" href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">start</a> = (sample &gt; <a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>) ? (sample - <a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>) : 0;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = limit + <a class="code" href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="comment">/* Reinitialise the detector for the next block */</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">tone_out</a>[i]);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">current_sample</a> = 0;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="keywordflow">if</span> (squelch &amp;&amp; mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &gt; samples) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;         s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> = mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> - samples;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = samples;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   }</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <span class="keywordflow">return</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">td</a>.<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">mf</a>.<a class="code" href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">current_hit</a>); <span class="comment">/* return the debounced hit */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ab10feaebebf59c9371f2268ee984f364"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a></div><div class="ttdeci">static void mute_fragment(struct ast_dsp *dsp, fragment_t *fragment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00440">dsp.c:440</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a07c84020c6c083f2732be8ff6a6c65ca"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a07c84020c6c083f2732be8ff6a6c65ca">digit_detect_state_t::td</a></div><div class="ttdeci">union digit_detect_state_t::@383 td</div></div>
<div class="ttc" id="structfragment__t_html_a37722a150250e2a5a98e5e0d11e53449"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">fragment_t::start</a></div><div class="ttdeci">int start</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00388">dsp.c:388</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_a528b92081b5923d5748e62ce97d2534b"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mf_detect_state_t::mute_samples</a></div><div class="ttdeci">int mute_samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00300">dsp.c:300</a></div></div>
<div class="ttc" id="dsp_8c_html_a4ed69e4c904201b2dee62af600428e7c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a4ed69e4c904201b2dee62af600428e7c">bell_mf_positions</a></div><div class="ttdeci">static const char bell_mf_positions[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00327">dsp.c:327</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_aefd6f30bb7df6a58d77f2e7032300889"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#aefd6f30bb7df6a58d77f2e7032300889">mf_detect_state_t::tone_out</a></div><div class="ttdeci">goertzel_state_t tone_out[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00296">dsp.c:296</a></div></div>
<div class="ttc" id="dsp_8c_html_aa823bf1feac16cc6fe3d06aad8b1262c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a></div><div class="ttdeci">static void goertzel_reset(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00382">dsp.c:382</a></div></div>
<div class="ttc" id="dsp_8c_html_adb725f58c4d616aca44873f87a251ef6"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#adb725f58c4d616aca44873f87a251ef6">BELL_MF_TWIST</a></div><div class="ttdeci">#define BELL_MF_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00199">dsp.c:199</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a29128ae5c15a12dea5fe4f263ba6cec1"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a></div><div class="ttdeci">static int mute</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00144">chan_alsa.c:144</a></div></div>
<div class="ttc" id="dsp_8c_html_ad394d2a22bef4aaab1e90a8a9921f41b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ad394d2a22bef4aaab1e90a8a9921f41b">store_digit</a></div><div class="ttdeci">static void store_digit(digit_detect_state_t *s, char digit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00680">dsp.c:680</a></div></div>
<div class="ttc" id="structfragment__t_html_abce9f5dc9c83f2639b72024fdee5d388"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">fragment_t::end</a></div><div class="ttdeci">int end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00389">dsp.c:389</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_ab504ac2052e441f05b416f0582f169ea"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#ab504ac2052e441f05b416f0582f169ea">mf_detect_state_t::hits</a></div><div class="ttdeci">int hits[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00298">dsp.c:298</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af507d2d28aa3774531b92b9e88a154b5"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af507d2d28aa3774531b92b9e88a154b5">mf_detect_state_t::current_sample</a></div><div class="ttdeci">int current_sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00299">dsp.c:299</a></div></div>
<div class="ttc" id="dsp_8c_html_add921b6e54e9697d62fbfc0137efb0fb"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#add921b6e54e9697d62fbfc0137efb0fb">MF_GSIZE</a></div><div class="ttdeci">#define MF_GSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00224">dsp.c:224</a></div></div>
<div class="ttc" id="dsp_8c_html_a8a84c56ff77f49a4a38c7dcb50134d61"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a></div><div class="ttdeci">static void goertzel_sample(goertzel_state_t *s, short sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00336">dsp.c:336</a></div></div>
<div class="ttc" id="dsp_8c_html_a1d14f26f0f1376d16a84ea7834f5be70"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a1d14f26f0f1376d16a84ea7834f5be70">BELL_MF_RELATIVE_PEAK</a></div><div class="ttdeci">#define BELL_MF_RELATIVE_PEAK</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00200">dsp.c:200</a></div></div>
<div class="ttc" id="dsp_8c_html_a09cee9cae76ca825f6af9d9dedc25e63"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a09cee9cae76ca825f6af9d9dedc25e63">BELL_MF_THRESHOLD</a></div><div class="ttdeci">#define BELL_MF_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00198">dsp.c:198</a></div></div>
<div class="ttc" id="structfragment__t_html"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html">fragment_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00387">dsp.c:387</a></div></div>
<div class="ttc" id="dsp_8c_html_a63fc3d2975c956b5981217215285e6bd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a></div><div class="ttdeci">static float goertzel_result(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00362">dsp.c:362</a></div></div>
<div class="ttc" id="structmf__detect__state__t_html_af2509132e185dd749b33dc32e1ca5949"><div class="ttname"><a href="../../d5/d5b/structmf__detect__state__t.html#af2509132e185dd749b33dc32e1ca5949">mf_detect_state_t::current_hit</a></div><div class="ttdeci">int current_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00297">dsp.c:297</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a6bcc9350bec0d851925e46ca38a90349"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a6bcc9350bec0d851925e46ca38a90349">digit_detect_state_t::mf</a></div><div class="ttdeci">mf_detect_state_t mf</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00313">dsp.c:313</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab10feaebebf59c9371f2268ee984f364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10feaebebf59c9371f2268ee984f364">&#9670;&nbsp;</a></span>mute_fragment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mute_fragment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *&#160;</td>
          <td class="paramname"><em>fragment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00440">440</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00434">ast_dsp::mute_data</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00432">ast_dsp::mute_fragments</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">mute_fragments</a> &gt;= <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">mute_data</a>)) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Too many fragments to mute. Ignoring\n&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">mute_data</a>[dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">mute_fragments</a>++] = *fragment;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__dsp_html_a227e7147c3d372e856173f9374fd9a10"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a227e7147c3d372e856173f9374fd9a10">ast_dsp::mute_fragments</a></div><div class="ttdeci">int mute_fragments</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00432">dsp.c:432</a></div></div>
<div class="ttc" id="structast__dsp_html_a092a89a548303c7c2359aa3feb70348c"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a092a89a548303c7c2359aa3feb70348c">ast_dsp::mute_data</a></div><div class="ttdeci">fragment_t mute_data[5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00434">dsp.c:434</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dba54d7afec4002f759aa32fa7ce0be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dba54d7afec4002f759aa32fa7ce0be">&#9670;&nbsp;</a></span>pair_there()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pair_there </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01051">1051</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00154">TONE_MIN_THRESH</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00153">TONE_THRESH</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01074">__ast_dsp_call_progress()</a>.</p>
<div class="fragment"><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="comment">/* See if p1 and p2 are there, relative to i1 and i2 and total energy */</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   <span class="comment">/* Make sure absolute levels are high enough */</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="keywordflow">if</span> ((p1 &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a>) || (p2 &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a>)) {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="comment">/* Amplify ignored stuff */</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   i2 *= <a class="code" href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   i1 *= <a class="code" href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   e *= <a class="code" href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <span class="comment">/* Check first tone */</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="keywordflow">if</span> ((p1 &lt; i1) || (p1 &lt; i2) || (p1 &lt; e)) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   }</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   <span class="comment">/* And second */</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   <span class="keywordflow">if</span> ((p2 &lt; i1) || (p2 &lt; i2) || (p2 &lt; e)) {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="comment">/* Guess it&#39;s there... */</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div><div class="ttc" id="dsp_8c_html_afe56d06c4edb3c8d3bb76cc877e7e07e"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#afe56d06c4edb3c8d3bb76cc877e7e07e">TONE_THRESH</a></div><div class="ttdeci">#define TONE_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00153">dsp.c:153</a></div></div>
<div class="ttc" id="dsp_8c_html_a4e159009069d203ae2301aa5cdeb480c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a4e159009069d203ae2301aa5cdeb480c">TONE_MIN_THRESH</a></div><div class="ttdeci">#define TONE_MIN_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00154">dsp.c:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02454">2454</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00316">AST_MODFLAG_GLOBAL_SYMBOLS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00324">AST_MODPRI_CORE</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02442">load_module()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02434">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;{</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/dsp_8c.html#a380a2a03c9d2b260bb9cbefe070fc1dd">_dsp_init</a>(1);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;}</div><div class="ttc" id="dsp_8c_html_a380a2a03c9d2b260bb9cbefe070fc1dd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a380a2a03c9d2b260bb9cbefe070fc1dd">_dsp_init</a></div><div class="ttdeci">static int _dsp_init(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01908">dsp.c:1908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad394d2a22bef4aaab1e90a8a9921f41b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad394d2a22bef4aaab1e90a8a9921f41b">&#9670;&nbsp;</a></span>store_digit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void store_digit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd0/structdigit__detect__state__t.html">digit_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>digit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00680">680</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00307">digit_detect_state_t::current_digits</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00308">digit_detect_state_t::detected_digits</a>, <a class="el" href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">digit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00306">digit_detect_state_t::digitlen</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00305">digit_detect_state_t::digits</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00309">digit_detect_state_t::lost_digits</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00166">MAX_DTMF_DIGITS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a192a5c65db7b23a14d00ab5612b4c320">detected_digits</a>++;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a> &lt; <a class="code" href="../../d5/d3b/dsp_8c.html#a5313700220195d4510860845d12d0523">MAX_DTMF_DIGITS</a>) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digitlen</a>[s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>] = 0;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>++] = <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digits</a>[s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">current_digits</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Digit lost due to full buffer\n&quot;</span>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      s-&gt;<a class="code" href="../../d7/dd0/structdigit__detect__state__t.html#a6dde65ce3267d76bf68172a358940bce">lost_digits</a>++;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div><div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a6dde65ce3267d76bf68172a358940bce"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a6dde65ce3267d76bf68172a358940bce">digit_detect_state_t::lost_digits</a></div><div class="ttdeci">int lost_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00309">dsp.c:309</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_ac74ec91ceeab32c9468de13feb7c4d33"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#ac74ec91ceeab32c9468de13feb7c4d33">digit_detect_state_t::current_digits</a></div><div class="ttdeci">int current_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00307">dsp.c:307</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_abc255092d94df3f9fc5937c9177bcf3c"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#abc255092d94df3f9fc5937c9177bcf3c">digit_detect_state_t::digits</a></div><div class="ttdeci">char digits[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00305">dsp.c:305</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_a5313700220195d4510860845d12d0523"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a5313700220195d4510860845d12d0523">MAX_DTMF_DIGITS</a></div><div class="ttdeci">#define MAX_DTMF_DIGITS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00166">dsp.c:166</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_a192a5c65db7b23a14d00ab5612b4c320"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#a192a5c65db7b23a14d00ab5612b4c320">digit_detect_state_t::detected_digits</a></div><div class="ttdeci">int detected_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00308">dsp.c:308</a></div></div>
<div class="ttc" id="structdigit__detect__state__t_html_aa75910b0b36bbf7b4ed69cad18c34d3a"><div class="ttname"><a href="../../d7/dd0/structdigit__detect__state__t.html#aa75910b0b36bbf7b4ed69cad18c34d3a">digit_detect_state_t::digitlen</a></div><div class="ttdeci">int digitlen[MAX_DTMF_DIGITS+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00306">dsp.c:306</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a49096094cdd2a9121cc0c246218840da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49096094cdd2a9121cc0c246218840da">&#9670;&nbsp;</a></span>test_dtmf_amplitude_sweep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_dtmf_amplitude_sweep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>digit_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">2096</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01797">ast_dsp_digitreset()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">DEFAULT_SAMPLE_RATE</a>, <a class="el" href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">digit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00320">dtmf_col</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00227">DTMF_GSIZE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00326">dtmf_positions</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00317">dtmf_row</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02026">test_dual_sample_gen()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02034">TONE_AMPLITUDE_MAX</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02035">TONE_AMPLITUDE_MIN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02392">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;{</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;   <span class="keywordtype">short</span> slin_buf[<a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>];</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   <span class="keywordtype">int</span> row;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d4b/structcolumn.html">column</a>;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;   <span class="keyword">struct </span>{</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordtype">short</span> amp_val;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;   } amp_tests[] = {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">       * XXX Since there is no current DTMF level detection issue.  This test</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">       * just checks the current detection levels.</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      { .amp_val = <a class="code" href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a>/2,  .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      { .amp_val = 10000,              .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      { .amp_val = 1000,               .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      { .amp_val = 500,             .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      { .amp_val = 250,             .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      { .amp_val = 200,             .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      { .amp_val = 180,             .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="comment">/* Various digits detect and not detect in this range */</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      { .amp_val = 170,             .digit = 0, },</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      { .amp_val = 100,             .digit = 0, },</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">       * Amplitudes below TONE_AMPLITUDE_MIN start having questionable detection</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">       * over quantization and background noise.</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      { .amp_val = <a class="code" href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a>, .digit = 0, },</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      { .amp_val = 75,              .digit = 0, },</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      { .amp_val = 10,              .digit = 0, },</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      { .amp_val = 1,                  .digit = 0, },</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   };</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;   row = (digit_index &gt;&gt; 2) &amp; 0x03;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   column = digit_index &amp; 0x03;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   result = 0;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(amp_tests); ++idx) {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="keywordtype">int</span> duration;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Test &#39;%c&#39; at amplitude %d\n&quot;</span>,</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], amp_tests[idx].amp_val);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#af9ad6d073b69b257fc653e0ba55844d9">test_dual_sample_gen</a>(slin_buf, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(slin_buf), <a class="code" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>,</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;         (<span class="keywordtype">int</span>) <a class="code" href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a>[row], amp_tests[idx].amp_val,</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;         (<span class="keywordtype">int</span>) <a class="code" href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[column], amp_tests[idx].amp_val);</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      digit = 0;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="keywordflow">for</span> (duration = 0; !digit &amp;&amp; duration &lt; 3; ++duration) {</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;         digit = <a class="code" href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, slin_buf, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(slin_buf),</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            0, 0);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      }</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <span class="keywordflow">if</span> (amp_tests[idx].digit != digit) {</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">          * Both messages are needed.  ast_debug for when figuring out</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">          * what went wrong and the test update for normal output before</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment">          * you start debugging.  The different logging methods are not</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">          * synchronized.</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="stringliteral">&quot;Test &#39;%c&#39; at amplitude %d failed.  Detected Digit: &#39;%c&#39;\n&quot;</span>,</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], amp_tests[idx].amp_val,</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            digit ?: <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test,</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            <span class="stringliteral">&quot;Test &#39;%c&#39; at amplitude %d failed.  Detected Digit: &#39;%c&#39;\n&quot;</span>,</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], amp_tests[idx].amp_val,</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            digit ?: <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;         result = -1;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a45fbc637da9251814352c97382f24d40">ast_dsp_digitreset</a>(dsp);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;   }</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;}</div><div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_aa25d091473980e52735b884cabe319ce"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a></div><div class="ttdeci">static int dtmf_detect(struct ast_dsp *dsp, digit_detect_state_t *s, int16_t amp[], int samples, int squelch, int relax)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00693">dsp.c:693</a></div></div>
<div class="ttc" id="dsp_8c_html_a27699369d27243a453a74f24c1e0373b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a></div><div class="ttdeci">static const char dtmf_positions[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00326">dsp.c:326</a></div></div>
<div class="ttc" id="dsp_8c_html_a7f207b5f13316dc0495304ee5b5d923c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a></div><div class="ttdeci">#define DTMF_GSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00227">dsp.c:227</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="dsp_8c_html_add4d38fa22770d38c666f9b9361a1bee"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a></div><div class="ttdeci">static const float dtmf_col[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00320">dsp.c:320</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="dsp_8c_html_a89a046bbce1a7e6fc9ec15b88a22922c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a></div><div class="ttdeci">static const float dtmf_row[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00317">dsp.c:317</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dsp_8c_html_a45fbc637da9251814352c97382f24d40"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a45fbc637da9251814352c97382f24d40">ast_dsp_digitreset</a></div><div class="ttdeci">void ast_dsp_digitreset(struct ast_dsp *dsp)</div><div class="ttdoc">Reset DTMF detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01797">dsp.c:1797</a></div></div>
<div class="ttc" id="dsp_8c_html_ab6a9990b37515687259bf26d889df2ed"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02035">dsp.c:2035</a></div></div>
<div class="ttc" id="dsp_8c_html_a48060c65aa5909df6326d08ed76a692f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02034">dsp.c:2034</a></div></div>
<div class="ttc" id="dsp_8c_html_abe9b1c28165a7071e354bd9d7823ca1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a></div><div class="ttdeci">#define DEFAULT_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00221">dsp.c:221</a></div></div>
<div class="ttc" id="dsp_8c_html_af9ad6d073b69b257fc653e0ba55844d9"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af9ad6d073b69b257fc653e0ba55844d9">test_dual_sample_gen</a></div><div class="ttdeci">static void test_dual_sample_gen(short *slin_buf, int samples, int rate, int f1, short a1, int f2, short a2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02026">dsp.c:2026</a></div></div>
<div class="ttc" id="structcolumn_html"><div class="ttname"><a href="../../de/d4b/structcolumn.html">column</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00098">cdr_mysql.c:98</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9a19cdc49481a2f4b171f490022b56a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a19cdc49481a2f4b171f490022b56a">&#9670;&nbsp;</a></span>test_dtmf_twist_sweep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_dtmf_twist_sweep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>digit_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">2176</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01797">ast_dsp_digitreset()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00183">DEF_DTMF_NORMAL_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00190">DEF_DTMF_REVERSE_TWIST</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">DEFAULT_SAMPLE_RATE</a>, <a class="el" href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">digit</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00435">ast_dsp::digit_state</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00320">dtmf_col</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00227">DTMF_GSIZE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00329">dtmf_normal_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00326">dtmf_positions</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00330">dtmf_reverse_twist</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00317">dtmf_row</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02026">test_dual_sample_gen()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02392">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;{</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   <span class="keywordtype">short</span> slin_buf[<a class="code" href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a>];</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   <span class="keywordtype">int</span> row;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d4b/structcolumn.html">column</a>;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;   <span class="keyword">struct </span>{</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <span class="keywordtype">short</span> amp_row;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keywordtype">short</span> amp_col;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   } twist_tests[] = {</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">       * XXX Since there is no current DTMF twist detection issue.  This test</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">       * just checks the current detection levels.</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">       * Normal twist has the column higher than the row amplitude.</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">       * Reverse twist is the other way.</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      { .amp_row = 1000 + 1800, .amp_col = 1000 +    0, .digit = 0, },</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      { .amp_row = 1000 + 1700, .amp_col = 1000 +    0, .digit = 0, },</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="comment">/* Various digits detect and not detect in this range */</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      { .amp_row = 1000 + 1400, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      { .amp_row = 1000 + 1300, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      { .amp_row = 1000 + 1200, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      { .amp_row = 1000 + 1100, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      { .amp_row = 1000 + 1000, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      { .amp_row = 1000 +  100, .amp_col = 1000 +    0, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  100, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  200, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  300, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  400, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  500, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  550, .digit = <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index], },</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      <span class="comment">/* Various digits detect and not detect in this range */</span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  650, .digit = 0, },</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  700, .digit = 0, },</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      { .amp_row = 1000 +    0, .amp_col = 1000 +  800, .digit = 0, },</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   };</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;   <span class="keywordtype">float</span> save_normal_twist;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   <span class="keywordtype">float</span> save_reverse_twist;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;   save_normal_twist = <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   save_reverse_twist = <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a>;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a5e9a3c55581aedf098446a36d09a1ae6">DEF_DTMF_NORMAL_TWIST</a>;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a> = <a class="code" href="../../d5/d3b/dsp_8c.html#a0d18e32bfd7abe1418c783bb559a2815">DEF_DTMF_REVERSE_TWIST</a>;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;   row = (digit_index &gt;&gt; 2) &amp; 0x03;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;   column = digit_index &amp; 0x03;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;   result = 0;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(twist_tests); ++idx) {</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keywordtype">int</span> duration;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Test &#39;%c&#39; twist row %d col %d amplitudes\n&quot;</span>,</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index],</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;         twist_tests[idx].amp_row, twist_tests[idx].amp_col);</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#af9ad6d073b69b257fc653e0ba55844d9">test_dual_sample_gen</a>(slin_buf, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(slin_buf), <a class="code" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>,</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;         (<span class="keywordtype">int</span>) <a class="code" href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a>[row], twist_tests[idx].amp_row,</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;         (<span class="keywordtype">int</span>) <a class="code" href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[column], twist_tests[idx].amp_col);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      digit = 0;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="keywordflow">for</span> (duration = 0; !digit &amp;&amp; duration &lt; 3; ++duration) {</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;         digit = <a class="code" href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a>(dsp, &amp;dsp-&gt;<a class="code" href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">digit_state</a>, slin_buf, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(slin_buf),</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            0, 0);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      }</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="keywordflow">if</span> (twist_tests[idx].digit != digit) {</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">          * Both messages are needed.  ast_debug for when figuring out</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">          * what went wrong and the test update for normal output before</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">          * you start debugging.  The different logging methods are not</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">          * synchronized.</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            <span class="stringliteral">&quot;Test &#39;%c&#39; twist row %d col %d amplitudes failed.  Detected Digit: &#39;%c&#39;\n&quot;</span>,</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index],</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            twist_tests[idx].amp_row, twist_tests[idx].amp_col,</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            digit ?: <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test,</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            <span class="stringliteral">&quot;Test &#39;%c&#39; twist row %d col %d amplitudes failed.  Detected Digit: &#39;%c&#39;\n&quot;</span>,</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a>[digit_index],</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            twist_tests[idx].amp_row, twist_tests[idx].amp_col,</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            digit ?: <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;         result = -1;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      }</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a45fbc637da9251814352c97382f24d40">ast_dsp_digitreset</a>(dsp);</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;   }</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a> = save_normal_twist;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a> = save_reverse_twist;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;}</div><div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_a5e9a3c55581aedf098446a36d09a1ae6"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a5e9a3c55581aedf098446a36d09a1ae6">DEF_DTMF_NORMAL_TWIST</a></div><div class="ttdeci">#define DEF_DTMF_NORMAL_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00183">dsp.c:183</a></div></div>
<div class="ttc" id="dsp_8c_html_aa25d091473980e52735b884cabe319ce"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa25d091473980e52735b884cabe319ce">dtmf_detect</a></div><div class="ttdeci">static int dtmf_detect(struct ast_dsp *dsp, digit_detect_state_t *s, int16_t amp[], int samples, int squelch, int relax)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00693">dsp.c:693</a></div></div>
<div class="ttc" id="dsp_8c_html_a27699369d27243a453a74f24c1e0373b"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a27699369d27243a453a74f24c1e0373b">dtmf_positions</a></div><div class="ttdeci">static const char dtmf_positions[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00326">dsp.c:326</a></div></div>
<div class="ttc" id="dsp_8c_html_a7f207b5f13316dc0495304ee5b5d923c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a7f207b5f13316dc0495304ee5b5d923c">DTMF_GSIZE</a></div><div class="ttdeci">#define DTMF_GSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00227">dsp.c:227</a></div></div>
<div class="ttc" id="structast__dsp_html_a79258a44d42aea84f2ff2b5bafff1ed6"><div class="ttname"><a href="../../d6/de5/structast__dsp.html#a79258a44d42aea84f2ff2b5bafff1ed6">ast_dsp::digit_state</a></div><div class="ttdeci">digit_detect_state_t digit_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00435">dsp.c:435</a></div></div>
<div class="ttc" id="dsp_8c_html_add4d38fa22770d38c666f9b9361a1bee"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a></div><div class="ttdeci">static const float dtmf_col[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00320">dsp.c:320</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="dsp_8c_html_a0d18e32bfd7abe1418c783bb559a2815"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a0d18e32bfd7abe1418c783bb559a2815">DEF_DTMF_REVERSE_TWIST</a></div><div class="ttdeci">#define DEF_DTMF_REVERSE_TWIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00190">dsp.c:190</a></div></div>
<div class="ttc" id="dsp_8c_html_a89a046bbce1a7e6fc9ec15b88a22922c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a89a046bbce1a7e6fc9ec15b88a22922c">dtmf_row</a></div><div class="ttdeci">static const float dtmf_row[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00317">dsp.c:317</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dsp_8c_html_a45fbc637da9251814352c97382f24d40"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a45fbc637da9251814352c97382f24d40">ast_dsp_digitreset</a></div><div class="ttdeci">void ast_dsp_digitreset(struct ast_dsp *dsp)</div><div class="ttdoc">Reset DTMF detector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01797">dsp.c:1797</a></div></div>
<div class="ttc" id="dsp_8c_html_aec01db8127adabb95e443652f30963f2"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aec01db8127adabb95e443652f30963f2">dtmf_normal_twist</a></div><div class="ttdeci">static float dtmf_normal_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00329">dsp.c:329</a></div></div>
<div class="ttc" id="dsp_8c_html_abe9b1c28165a7071e354bd9d7823ca1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a></div><div class="ttdeci">#define DEFAULT_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00221">dsp.c:221</a></div></div>
<div class="ttc" id="dsp_8c_html_af9ad6d073b69b257fc653e0ba55844d9"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#af9ad6d073b69b257fc653e0ba55844d9">test_dual_sample_gen</a></div><div class="ttdeci">static void test_dual_sample_gen(short *slin_buf, int samples, int rate, int f1, short a1, int f2, short a2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02026">dsp.c:2026</a></div></div>
<div class="ttc" id="structcolumn_html"><div class="ttname"><a href="../../de/d4b/structcolumn.html">column</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00098">cdr_mysql.c:98</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dsp_8c_html_a91f8036cdc5c4dca199e2d123f333087"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a91f8036cdc5c4dca199e2d123f333087">dtmf_reverse_twist</a></div><div class="ttdeci">static float dtmf_reverse_twist</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00330">dsp.c:330</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9ad6d073b69b257fc653e0ba55844d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ad6d073b69b257fc653e0ba55844d9">&#9670;&nbsp;</a></span>test_dual_sample_gen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_dual_sample_gen </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>slin_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>a2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02026">2026</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02002">test_tone_sample_gen()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02014">test_tone_sample_gen_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>
<div class="fragment"><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;{</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a>(slin_buf, samples, rate, f1, a1);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   <a class="code" href="../../d5/d3b/dsp_8c.html#ac89458575ad5ea64d6c46487a2c1a6b6">test_tone_sample_gen_add</a>(slin_buf, samples, rate, f2, a2);</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;}</div><div class="ttc" id="dsp_8c_html_a549239eaec0a814839f116a7a33b0029"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a></div><div class="ttdeci">static void test_tone_sample_gen(short *slin_buf, int samples, int rate, int freq, short amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02002">dsp.c:2002</a></div></div>
<div class="ttc" id="dsp_8c_html_ac89458575ad5ea64d6c46487a2c1a6b6"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ac89458575ad5ea64d6c46487a2c1a6b6">test_tone_sample_gen_add</a></div><div class="ttdeci">static void test_tone_sample_gen_add(short *slin_buf, int samples, int rate, int freq, short amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02014">dsp.c:2014</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1608982b489c76a3f71b01517518454c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1608982b489c76a3f71b01517518454c">&#9670;&nbsp;</a></span>test_tone_amplitude_sweep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_tone_amplitude_sweep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>tone_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">2037</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00266">tone_detect_state_t::block_size</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">DEFAULT_SAMPLE_RATE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00265">tone_detect_state_t::freq</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00276">tone_detect_state_t::hit_count</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00273">tone_detect_state_t::hits_required</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02002">test_tone_sample_gen()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02034">TONE_AMPLITUDE_MAX</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02035">TONE_AMPLITUDE_MIN</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;{</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;   <span class="keywordtype">short</span> slin_buf[tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>];</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keyword">struct </span>{</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="keywordtype">short</span> amp_val;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keywordtype">int</span> detect;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   } amp_tests[] = {</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      { .amp_val = <a class="code" href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a>, .detect = 1, },</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      { .amp_val = 10000,              .detect = 1, },</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      { .amp_val = 1000,               .detect = 1, },</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      { .amp_val = 100,             .detect = 1, },</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      { .amp_val = <a class="code" href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a>, .detect = 1, },</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      { .amp_val = 75,              .detect = 0, },</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      { .amp_val = 10,              .detect = 0, },</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      { .amp_val = 1,                  .detect = 0, },</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   };</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   result = 0;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(amp_tests); ++idx) {</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keywordtype">int</span> detected;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keywordtype">int</span> duration;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Test %d Hz at amplitude %d\n&quot;</span>,</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;         tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, amp_tests[idx].amp_val);</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a>(slin_buf, tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>,</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;         tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, amp_tests[idx].amp_val);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      detected = 0;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">for</span> (duration = 0; !detected &amp;&amp; duration &lt; tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">hits_required</a> + 3; ++duration) {</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;         detected = <a class="code" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a>(dsp, tone_state, slin_buf, tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>) ? 1 : 0;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      }</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="keywordflow">if</span> (amp_tests[idx].detect != detected) {</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">          * Both messages are needed.  ast_debug for when figuring out</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">          * what went wrong and the test update for normal output before</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">          * you start debugging.  The different logging methods are not</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">          * synchronized.</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <span class="stringliteral">&quot;Test %d Hz at amplitude %d failed.  Detected: %s\n&quot;</span>,</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, amp_tests[idx].amp_val,</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            detected ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test,</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="stringliteral">&quot;Test %d Hz at amplitude %d failed.  Detected: %s\n&quot;</span>,</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, amp_tests[idx].amp_val,</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            detected ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;         result = -1;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      }</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a> = 0;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   }</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;}</div><div class="ttc" id="structtone__detect__state__t_html_ad5761886830ba92291e1c22e7df920a3"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">tone_detect_state_t::hits_required</a></div><div class="ttdeci">int hits_required</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00273">dsp.c:273</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dsp_8c_html_a549239eaec0a814839f116a7a33b0029"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a></div><div class="ttdeci">static void test_tone_sample_gen(short *slin_buf, int samples, int rate, int freq, short amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02002">dsp.c:2002</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ae0d22272b68e75d19ac0b80c01f806b6"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">tone_detect_state_t::freq</a></div><div class="ttdeci">int freq</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00265">dsp.c:265</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_af1c43188701355ac6ce51b32d77fcb1a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">tone_detect_state_t::hit_count</a></div><div class="ttdeci">int hit_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00276">dsp.c:276</a></div></div>
<div class="ttc" id="dsp_8c_html_ab6a9990b37515687259bf26d889df2ed"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab6a9990b37515687259bf26d889df2ed">TONE_AMPLITUDE_MIN</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02035">dsp.c:2035</a></div></div>
<div class="ttc" id="dsp_8c_html_a48060c65aa5909df6326d08ed76a692f"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a48060c65aa5909df6326d08ed76a692f">TONE_AMPLITUDE_MAX</a></div><div class="ttdeci">#define TONE_AMPLITUDE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02034">dsp.c:2034</a></div></div>
<div class="ttc" id="dsp_8c_html_abe9b1c28165a7071e354bd9d7823ca1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a></div><div class="ttdeci">#define DEFAULT_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00221">dsp.c:221</a></div></div>
<div class="ttc" id="dsp_8c_html_a399ce184a63aad01299671419040ded7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a></div><div class="ttdeci">static int tone_detect(struct ast_dsp *dsp, tone_detect_state_t *s, int16_t *amp, int samples)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00573">dsp.c:573</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a70b27761c7d0bd5cd90f4fe47e569b94"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">tone_detect_state_t::block_size</a></div><div class="ttdeci">int block_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00266">dsp.c:266</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5322cba7f6f5757cdc6f2e4f91890d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5322cba7f6f5757cdc6f2e4f91890d62">&#9670;&nbsp;</a></span>test_tone_freq_sweep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_tone_freq_sweep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>tone_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>amplitude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02274">2274</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00266">tone_detect_state_t::block_size</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00221">DEFAULT_SAMPLE_RATE</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00265">tone_detect_state_t::freq</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00276">tone_detect_state_t::hit_count</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00273">tone_detect_state_t::hits_required</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02002">test_tone_sample_gen()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">tone_detect()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02336">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;{</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;   <span class="keywordtype">short</span> slin_buf[tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>];</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;   <span class="keywordtype">int</span> freq;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;   <span class="keywordtype">int</span> lower_freq;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;   <span class="keywordtype">int</span> upper_freq;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   <span class="comment">/* Calculate detection frequency range */</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   lower_freq = tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a> - 4;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;   upper_freq = tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a> + 4;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   result = 0;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;   <span class="comment">/* Sweep frequencies loop. */</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keywordflow">for</span> (freq = 100; freq &lt;= 3500; freq += 1) {</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="keywordtype">int</span> detected;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordtype">int</span> duration;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keywordtype">int</span> expect_detection;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keywordflow">if</span> (freq == tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>) {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;         <span class="comment">/* This case is done by the amplitude sweep. */</span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      }</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      expect_detection = (lower_freq &lt;= freq &amp;&amp; freq &lt;= upper_freq) ? 1 : 0;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Test %d Hz detection given %d Hz tone at amplitude %d.  Range:%d-%d Expect detect: %s\n&quot;</span>,</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;         tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, freq, amplitude, lower_freq, upper_freq,</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;         expect_detection ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a>(slin_buf, tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>, <a class="code" href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>, freq,</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;         amplitude);</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      detected = 0;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keywordflow">for</span> (duration = 0; !detected &amp;&amp; duration &lt; tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">hits_required</a> + 3; ++duration) {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;         detected = <a class="code" href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a>(dsp, tone_state, slin_buf, tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>) ? 1 : 0;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      }</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keywordflow">if</span> (expect_detection != detected) {</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">          * Both messages are needed.  ast_debug for when figuring out</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">          * what went wrong and the test update for normal output before</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">          * you start debugging.  The different logging methods are not</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">          * synchronized.</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="stringliteral">&quot;Test %d Hz detection given %d Hz tone at amplitude %d failed.  Range:%d-%d Detected: %s\n&quot;</span>,</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, freq, amplitude, lower_freq, upper_freq,</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            detected ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test,</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="stringliteral">&quot;Test %d Hz detection given %d Hz tone at amplitude %d failed.  Range:%d-%d Detected: %s\n&quot;</span>,</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, freq, amplitude, lower_freq, upper_freq,</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            detected ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;         result = -1;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      }</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      tone_state-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a> = 0;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;   }</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;}</div><div class="ttc" id="structtone__detect__state__t_html_ad5761886830ba92291e1c22e7df920a3"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">tone_detect_state_t::hits_required</a></div><div class="ttdeci">int hits_required</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00273">dsp.c:273</a></div></div>
<div class="ttc" id="dsp_8c_html_a549239eaec0a814839f116a7a33b0029"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a549239eaec0a814839f116a7a33b0029">test_tone_sample_gen</a></div><div class="ttdeci">static void test_tone_sample_gen(short *slin_buf, int samples, int rate, int freq, short amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l02002">dsp.c:2002</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ae0d22272b68e75d19ac0b80c01f806b6"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">tone_detect_state_t::freq</a></div><div class="ttdeci">int freq</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00265">dsp.c:265</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_af1c43188701355ac6ce51b32d77fcb1a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">tone_detect_state_t::hit_count</a></div><div class="ttdeci">int hit_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00276">dsp.c:276</a></div></div>
<div class="ttc" id="dsp_8c_html_abe9b1c28165a7071e354bd9d7823ca1a"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a></div><div class="ttdeci">#define DEFAULT_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00221">dsp.c:221</a></div></div>
<div class="ttc" id="dsp_8c_html_a399ce184a63aad01299671419040ded7"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a399ce184a63aad01299671419040ded7">tone_detect</a></div><div class="ttdeci">static int tone_detect(struct ast_dsp *dsp, tone_detect_state_t *s, int16_t *amp, int samples)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00573">dsp.c:573</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a70b27761c7d0bd5cd90f4fe47e569b94"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">tone_detect_state_t::block_size</a></div><div class="ttdeci">int block_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00266">dsp.c:266</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a549239eaec0a814839f116a7a33b0029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a549239eaec0a814839f116a7a33b0029">&#9670;&nbsp;</a></span>test_tone_sample_gen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_tone_sample_gen </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>slin_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>amplitude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02002">2002</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00083">M_PI</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02026">test_dual_sample_gen()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02274">test_tone_freq_sweep()</a>.</p>
<div class="fragment"><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;{</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;   <span class="keywordtype">double</span> sample_step = 2.0 * <a class="code" href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * freq / rate;<span class="comment">/* radians per step */</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; samples; ++idx) {</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      slin_buf[idx] = amplitude * sin(sample_step * idx);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;   }</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;}</div><div class="ttc" id="resample_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00083">resample.c:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac89458575ad5ea64d6c46487a2c1a6b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89458575ad5ea64d6c46487a2c1a6b6">&#9670;&nbsp;</a></span>test_tone_sample_gen_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_tone_sample_gen_add </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>slin_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>amplitude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02014">2014</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00083">M_PI</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02026">test_dual_sample_gen()</a>.</p>
<div class="fragment"><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;{</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;   <span class="keywordtype">double</span> sample_step = 2.0 * <a class="code" href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * freq / rate;<span class="comment">/* radians per step */</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; samples; ++idx) {</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      slin_buf[idx] += amplitude * sin(sample_step * idx);</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;   }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;}</div><div class="ttc" id="resample_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00083">resample.c:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a399ce184a63aad01299671419040ded7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a399ce184a63aad01299671419040ded7">&#9670;&nbsp;</a></span>tone_detect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tone_detect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/de5/structast__dsp.html">ast_dsp</a> *&#160;</td>
          <td class="paramname"><em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d6a/structtone__detect__state__t.html">tone_detect_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> *&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00573">573</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00266">tone_detect_state_t::block_size</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00389">fragment_t::end</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00269">tone_detect_state_t::energy</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00265">tone_detect_state_t::freq</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00382">goertzel_reset()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00362">goertzel_result()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00336">goertzel_sample()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00276">tone_detect_state_t::hit_count</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00273">tone_detect_state_t::hits_required</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00277">tone_detect_state_t::last_hit</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00144">mute</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00440">mute_fragment()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00271">tone_detect_state_t::mute_samples</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00270">tone_detect_state_t::samples_pending</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00267">tone_detect_state_t::squelch</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00388">fragment_t::start</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00274">tone_detect_state_t::threshold</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00268">tone_detect_state_t::tone</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00181">TONE_THRESHOLD</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01494">ast_dsp_process()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02037">test_tone_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02274">test_tone_freq_sweep()</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keywordtype">float</span> tone_energy;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordtype">int</span> hit = 0;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordtype">int</span> limit;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <a class="code" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> *ptr;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <span class="keywordtype">short</span> samp;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordtype">int</span> start, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <a class="code" href="../../d3/d6f/structfragment__t.html">fragment_t</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> = {0, 0};</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> &amp;&amp; s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &gt; 0) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> &lt; samples) ? s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> : samples;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> -= mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">for</span> (start = 0; start &lt; samples; start = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>) {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="comment">/* Process in blocks. */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      limit = samples - start;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">if</span> (limit &gt; s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a>) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         limit = s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      end = start + limit;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">for</span> (i = limit, ptr = amp ; i &gt; 0; i--, ptr++) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;         samp = *ptr;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;         <span class="comment">/* signed 32 bit int should be enough to square any possible signed 16 bit value */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> += (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp * (<a class="code" href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>) samp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         <a class="code" href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a>(&amp;s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone</a>, samp);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a> -= limit;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a>) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;         <span class="comment">/* Finished incomplete (last) block */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      tone_energy = <a class="code" href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a>(&amp;s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone</a>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">/* Scale to make comparable */</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      tone_energy *= 2.0;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> *= s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(10, <span class="stringliteral">&quot;%d Hz tone %2d Ew=%.4E, Et=%.4E, s/n=%10.2f\n&quot;</span>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>, tone_energy, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a>, tone_energy / (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> - tone_energy));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      hit = 0;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/dsp_8c.html#a9e4ea1c9c1bcb353473655b068c4ca76">TONE_THRESHOLD</a> &lt;= tone_energy</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;         &amp;&amp; tone_energy &gt; s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> * s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a376acef8954eadc70f4b55e8e0588e13">threshold</a>) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(10, <span class="stringliteral">&quot;%d Hz tone Hit! %2d Ew=%.4E, Et=%.4E, s/n=%10.2f\n&quot;</span>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>, tone_energy, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a>, tone_energy / (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> - tone_energy));</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;         hit = 1;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;         s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>++;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">if</span> (hit == s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#aea678c244f0a2d57c55eaf866095376b">last_hit</a>) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;         <span class="keywordflow">if</span> (!hit) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="comment">/* Two successive misses. Tone ended */</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a> = 0;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a>++;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">hit_count</a> == s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">hits_required</a>) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%d Hz tone detected\n&quot;</span>, s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">freq</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         res = 1;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#aea678c244f0a2d57c55eaf866095376b">last_hit</a> = hit;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">/* If we had a hit in this block, include it into mute fragment */</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> &amp;&amp; hit) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &lt; start - s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="comment">/* There is a gap between fragments */</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            mute.<a class="code" href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">start</a> = (start &gt; s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>) ? (start - s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>) : 0;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = end + s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="comment">/* Reinitialise the detector for the next block */</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">/* Reset for the next block */</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a>(&amp;s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">/* Advance to the next block */</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">energy</a> = 0.0;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">samples_pending</a> = s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">block_size</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      amp += limit;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">squelch</a> &amp;&amp; mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">if</span> (mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> &gt; samples) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         s-&gt;<a class="code" href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">mute_samples</a> = mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> - samples;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         mute.<a class="code" href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = samples;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a>(dsp, &amp;mute);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;}</div><div class="ttc" id="dsp_8c_html_ab10feaebebf59c9371f2268ee984f364"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#ab10feaebebf59c9371f2268ee984f364">mute_fragment</a></div><div class="ttdeci">static void mute_fragment(struct ast_dsp *dsp, fragment_t *fragment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00440">dsp.c:440</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ad5761886830ba92291e1c22e7df920a3"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ad5761886830ba92291e1c22e7df920a3">tone_detect_state_t::hits_required</a></div><div class="ttdeci">int hits_required</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00273">dsp.c:273</a></div></div>
<div class="ttc" id="structfragment__t_html_a37722a150250e2a5a98e5e0d11e53449"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#a37722a150250e2a5a98e5e0d11e53449">fragment_t::start</a></div><div class="ttdeci">int start</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00388">dsp.c:388</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a3b2d9962865c06939bce31989f96da16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a3b2d9962865c06939bce31989f96da16">tone_detect_state_t::squelch</a></div><div class="ttdeci">int squelch</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00267">dsp.c:267</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ae0d22272b68e75d19ac0b80c01f806b6"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ae0d22272b68e75d19ac0b80c01f806b6">tone_detect_state_t::freq</a></div><div class="ttdeci">int freq</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00265">dsp.c:265</a></div></div>
<div class="ttc" id="db_8h_html_aa343fa3b3d06292b959ffdd4c4703b06"><div class="ttname"><a href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a></div><div class="ttdeci">short int16_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4e/db_8h_source.html#l00059">db.h:59</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_ac59ddf0973a442144767b1ff898d7296"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#ac59ddf0973a442144767b1ff898d7296">tone_detect_state_t::samples_pending</a></div><div class="ttdeci">int samples_pending</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00270">dsp.c:270</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a2d107b3b2dcebab8a10c9d39894f6b2a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a2d107b3b2dcebab8a10c9d39894f6b2a">tone_detect_state_t::energy</a></div><div class="ttdeci">float energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00269">dsp.c:269</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="dsp_8c_html_aa823bf1feac16cc6fe3d06aad8b1262c"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aa823bf1feac16cc6fe3d06aad8b1262c">goertzel_reset</a></div><div class="ttdeci">static void goertzel_reset(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00382">dsp.c:382</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a29128ae5c15a12dea5fe4f263ba6cec1"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a></div><div class="ttdeci">static int mute</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00144">chan_alsa.c:144</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a376acef8954eadc70f4b55e8e0588e13"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a376acef8954eadc70f4b55e8e0588e13">tone_detect_state_t::threshold</a></div><div class="ttdeci">float threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00274">dsp.c:274</a></div></div>
<div class="ttc" id="structfragment__t_html_abce9f5dc9c83f2639b72024fdee5d388"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#abce9f5dc9c83f2639b72024fdee5d388">fragment_t::end</a></div><div class="ttdeci">int end</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00389">dsp.c:389</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_af1c43188701355ac6ce51b32d77fcb1a"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#af1c43188701355ac6ce51b32d77fcb1a">tone_detect_state_t::hit_count</a></div><div class="ttdeci">int hit_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00276">dsp.c:276</a></div></div>
<div class="ttc" id="dsp_8c_html_a9e4ea1c9c1bcb353473655b068c4ca76"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a9e4ea1c9c1bcb353473655b068c4ca76">TONE_THRESHOLD</a></div><div class="ttdeci">#define TONE_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00181">dsp.c:181</a></div></div>
<div class="ttc" id="dsp_8c_html_a8a84c56ff77f49a4a38c7dcb50134d61"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a8a84c56ff77f49a4a38c7dcb50134d61">goertzel_sample</a></div><div class="ttdeci">static void goertzel_sample(goertzel_state_t *s, short sample)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00336">dsp.c:336</a></div></div>
<div class="ttc" id="structfragment__t_html"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html">fragment_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00387">dsp.c:387</a></div></div>
<div class="ttc" id="dsp_8c_html_a63fc3d2975c956b5981217215285e6bd"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#a63fc3d2975c956b5981217215285e6bd">goertzel_result</a></div><div class="ttdeci">static float goertzel_result(goertzel_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00362">dsp.c:362</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a70b27761c7d0bd5cd90f4fe47e569b94"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a70b27761c7d0bd5cd90f4fe47e569b94">tone_detect_state_t::block_size</a></div><div class="ttdeci">int block_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00266">dsp.c:266</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a83b51f2e56aa08b601a3a4fd609f6d16"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a83b51f2e56aa08b601a3a4fd609f6d16">tone_detect_state_t::tone</a></div><div class="ttdeci">goertzel_state_t tone</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00268">dsp.c:268</a></div></div>
<div class="ttc" id="db_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="../../da/d4e/db_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4e/db_8h_source.html#l00060">db.h:60</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_aea678c244f0a2d57c55eaf866095376b"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#aea678c244f0a2d57c55eaf866095376b">tone_detect_state_t::last_hit</a></div><div class="ttdeci">int last_hit</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00277">dsp.c:277</a></div></div>
<div class="ttc" id="structtone__detect__state__t_html_a528b92081b5923d5748e62ce97d2534b"><div class="ttname"><a href="../../d6/d6a/structtone__detect__state__t.html#a528b92081b5923d5748e62ce97d2534b">tone_detect_state_t::mute_samples</a></div><div class="ttdeci">int mute_samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00271">dsp.c:271</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02434">2434</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02454">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;{</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(test_dsp_fax_detect);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(test_dsp_dtmf_detect);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;}</div><div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;DSP&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .reload = reload_module, .load_pri = AST_MODPRI_CORE, .requires = &quot;extconfig&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02466">2466</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

</div>
</div>
<a id="af83fee9a892df2842ec9d4560f5a65ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83fee9a892df2842ec9d4560f5a65ed">&#9670;&nbsp;</a></span>aliases</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/dc3/structprogalias.html">progalias</a>  aliases[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01879">ast_dsp_set_call_progress_zone()</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02466">2466</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

</div>
</div>
<a id="a4ed69e4c904201b2dee62af600428e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed69e4c904201b2dee62af600428e7c">&#9670;&nbsp;</a></span>bell_mf_positions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char bell_mf_positions[] = &quot;1247C-358A--69*---0B----#&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00327">327</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00900">mf_detect()</a>.</p>

</div>
</div>
<a id="a20583928a48fd930b511ddbd722e6192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20583928a48fd930b511ddbd722e6192">&#9670;&nbsp;</a></span>DEFAULT_SILENCE_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int DEFAULT_SILENCE_THRESHOLD = 256</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The default silence threshold we will use if an alternate configured value is not present or is invalid. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00243">243</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>.</p>

</div>
</div>
<a id="add4d38fa22770d38c666f9b9361a1bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add4d38fa22770d38c666f9b9361a1bee">&#9670;&nbsp;</a></span>dtmf_col</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float dtmf_col[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   1209.0, 1336.0, 1477.0, 1633.0</div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00320">320</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00531">ast_dtmf_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="abc964f63482684acfd2937e981c678b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc964f63482684acfd2937e981c678b7">&#9670;&nbsp;</a></span>dtmf_hits_to_begin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int dtmf_hits_to_begin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00333">333</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="aba246381ba21cda471a8b4c5e81b48a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba246381ba21cda471a8b4c5e81b48a5">&#9670;&nbsp;</a></span>dtmf_misses_to_end</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int dtmf_misses_to_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00334">334</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="aec01db8127adabb95e443652f30963f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec01db8127adabb95e443652f30963f2">&#9670;&nbsp;</a></span>dtmf_normal_twist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float dtmf_normal_twist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00329">329</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a27699369d27243a453a74f24c1e0373b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27699369d27243a453a74f24c1e0373b">&#9670;&nbsp;</a></span>dtmf_positions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char dtmf_positions[] = &quot;123A&quot; &quot;456B&quot; &quot;789C&quot; &quot;*0#D&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00326">326</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02392">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a91f8036cdc5c4dca199e2d123f333087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f8036cdc5c4dca199e2d123f333087">&#9670;&nbsp;</a></span>dtmf_reverse_twist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float dtmf_reverse_twist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00330">330</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a89a046bbce1a7e6fc9ec15b88a22922c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89a046bbce1a7e6fc9ec15b88a22922c">&#9670;&nbsp;</a></span>dtmf_row</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float dtmf_row[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   697.0,  770.0,  852.0,  941.0</div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00317">317</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00531">ast_dtmf_detect_init()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02096">test_dtmf_amplitude_sweep()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l02176">test_dtmf_twist_sweep()</a>.</p>

</div>
</div>
<a id="a91a715aad7eb8bd2f4cd29197fc6b24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a715aad7eb8bd2f4cd29197fc6b24a">&#9670;&nbsp;</a></span>mf_tones</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float mf_tones[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   700.0, 900.0, 1100.0, 1300.0, 1500.0, 1700.0</div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00323">323</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00547">ast_mf_detect_init()</a>, and <a class="el" href="../../d4/d28/channel_8c_source.html#l04880">ast_senddigit_mf_begin()</a>.</p>

</div>
</div>
<a id="aa393efba8a1b3ccbb269e0ca7716f463"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa393efba8a1b3ccbb269e0ca7716f463">&#9670;&nbsp;</a></span>modes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/df7/structprogress.html">progress</a>  modes[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   { <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec">GSAMP_SIZE_NA</a>, { 350, 440, 480, 620, 950, 1400, 1800 } }, </div><div class="line">   { <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3">GSAMP_SIZE_CR</a>, { 425 } },               </div><div class="line">   { <a class="code" href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc">GSAMP_SIZE_UK</a>, { 350, 400, 440 } },           </div><div class="line">}</div><div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca2372926ea26a26e6e335e83036066cb3">GSAMP_SIZE_CR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00075">dsp.c:75</a></div></div>
<div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca82375cd6e0ea4c8bda51a2fa3fc00dbc">GSAMP_SIZE_UK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00076">dsp.c:76</a></div></div>
<div class="ttc" id="dsp_8c_html_aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec"><div class="ttname"><a href="../../d5/d3b/dsp_8c.html#aaa23c853bfc745be9b034a9add00498ca18fc86d868b209870aba80b5fdebf6ec">GSAMP_SIZE_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l00074">dsp.c:74</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01700">ast_dsp_prog_reset()</a>.</p>

</div>
</div>
<a id="ad2df3792a1bd43813423c43556bfe6b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2df3792a1bd43813423c43556bfe6b2">&#9670;&nbsp;</a></span>relax_dtmf_normal_twist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float relax_dtmf_normal_twist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00331">331</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="af097a604c6c8629d24ca1563a7c55160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af097a604c6c8629d24ca1563a7c55160">&#9670;&nbsp;</a></span>relax_dtmf_reverse_twist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float relax_dtmf_reverse_twist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00332">332</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00693">dtmf_detect()</a>.</p>

</div>
</div>
<a id="a0366c9d4146e4af0845b51e14744392e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0366c9d4146e4af0845b51e14744392e">&#9670;&nbsp;</a></span>thresholds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int thresholds[<a class="el" href="../../d3/d08/dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfab7803c38447503d92bdcaaebddc19231">THRESHOLD_MAX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d3b/dsp_8c_source.html#l00328">328</a> of file <a class="el" href="../../d5/d3b/dsp_8c_source.html">dsp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01908">_dsp_init()</a>, and <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01996">ast_dsp_get_threshold_from_settings()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:45:49 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
