<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_diversion.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_diversion.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &lt;pjsip_ua.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">asterisk/res_pjsip_session.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d90/strings_8h_source.html">asterisk/strings.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_diversion.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d9e/res__pjsip__diversion_8c__incl.png" border="0" usemap="#res__pjsip__diversion_8c" alt=""/></div>
<map name="res__pjsip__diversion_8c" id="res__pjsip__diversion_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="2472,393,2556,420"/>
<area shape="rect" id="node10" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="719,87,863,114"/>
<area shape="rect" id="node20" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="2149,244,2287,271"/>
<area shape="rect" id="node23" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="3242,468,3373,495"/>
<area shape="rect" id="node47" href="../../d9/de7/res__pjsip__session_8h.html" title="asterisk/res_pjsip\l_session.h" alt="" coords="2608,80,2740,121"/>
<area shape="rect" id="node49" href="../../de/d47/callerid_8h.html" title="CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr..." alt="" coords="2351,87,2485,114"/>
<area shape="rect" id="node50" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="3207,87,3343,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="2255,468,2410,495"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="2928,617,3065,644"/>
<area shape="rect" id="node7" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="2435,468,2569,495"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="2259,543,2406,569"/>
<area shape="rect" id="node15" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="861,468,1018,495"/>
<area shape="rect" id="node16" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="705,543,832,569"/>
<area shape="rect" id="node18" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="871,319,1018,345"/>
<area shape="rect" id="node19" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="2484,617,2635,644"/>
<area shape="rect" id="node39" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="645,319,796,345"/>
<area shape="rect" id="node40" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="1074,169,1207,196"/>
<area shape="rect" id="node41" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="877,244,1013,271"/>
<area shape="rect" id="node42" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="930,169,1050,196"/>
<area shape="rect" id="node43" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="1189,244,1345,271"/>
<area shape="rect" id="node44" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1337,169,1526,196"/>
<area shape="rect" id="node45" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="506,244,701,271"/>
<area shape="rect" id="node46" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="701,468,836,495"/>
<area shape="rect" id="node17" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="2729,692,2843,719"/>
<area shape="rect" id="node21" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="3026,319,3170,345"/>
<area shape="rect" id="node22" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="3147,393,3262,420"/>
<area shape="rect" id="node24" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="2824,543,2959,569"/>
<area shape="rect" id="node25" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="1667,393,1825,420"/>
<area shape="rect" id="node28" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="1835,319,1999,345"/>
<area shape="rect" id="node29" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="1516,393,1643,420"/>
<area shape="rect" id="node30" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="2145,393,2291,420"/>
<area shape="rect" id="node31" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="2824,319,2951,345"/>
<area shape="rect" id="node32" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="2255,319,2362,345"/>
<area shape="rect" id="node33" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="2597,543,2748,569"/>
<area shape="rect" id="node34" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="1445,319,1607,345"/>
<area shape="rect" id="node35" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="2386,319,2557,345"/>
<area shape="rect" id="node36" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="2581,319,2697,345"/>
<area shape="rect" id="node37" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="2023,319,2181,345"/>
<area shape="rect" id="node38" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1295,319,1421,345"/>
<area shape="rect" id="node26" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="1649,468,1779,495"/>
<area shape="rect" id="node27" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="1364,543,1491,569"/>
<area shape="rect" id="node48" href="../../de/d5f/sdp__srtp_8h.html" title="SRTP and SDP Security descriptions. " alt="" coords="2603,169,2745,196"/>
</map>
</div>
</div>
<p><a href="../../d5/da9/res__pjsip__diversion_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d30/structreasons.html">reasons</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diversion header reasons.  <a href="../../df/d30/structreasons.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06cf6cd14f54f63385ef60a0588eddc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ae06cf6cd14f54f63385ef60a0588eddc">add_diversion_header</a> (pjsip_tx_data *tdata, struct <a class="el" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> *data)</td></tr>
<tr class="separator:ae06cf6cd14f54f63385ef60a0588eddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac4e3e4caff73c8541ef7b30ed7b7c3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a5ac4e3e4caff73c8541ef7b30ed7b7c3">add_history_info_header</a> (pjsip_tx_data *tdata, struct <a class="el" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> *data)</td></tr>
<tr class="separator:a5ac4e3e4caff73c8541ef7b30ed7b7c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4295169d9745fed048e67d50327a80"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a7a4295169d9745fed048e67d50327a80">add_supported</a> (pjsip_tx_data *tdata)</td></tr>
<tr class="separator:a7a4295169d9745fed048e67d50327a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcf076e5a872adbe3baa9ac4a0437a3e"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169">AST_REDIRECTING_REASON</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#adcf076e5a872adbe3baa9ac4a0437a3e">cause_to_reason</a> (const unsigned long cause)</td></tr>
<tr class="separator:adcf076e5a872adbe3baa9ac4a0437a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60728e5b3f383ff67ff3f2970032265"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ae60728e5b3f383ff67ff3f2970032265">copy_redirecting_id</a> (struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *dst, const struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *src, struct <a class="el" href="../../df/dcf/structast__set__party__id.html">ast_set_party_id</a> *<a class="el" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>)</td></tr>
<tr class="separator:ae60728e5b3f383ff67ff3f2970032265"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a990557f8a0e254af190df1a38febb9e4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a990557f8a0e254af190df1a38febb9e4">diversion_incoming_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a990557f8a0e254af190df1a38febb9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58d5f9ec5a75ff5817caa254b207844"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ad58d5f9ec5a75ff5817caa254b207844">diversion_incoming_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:ad58d5f9ec5a75ff5817caa254b207844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a6d1001f395856d43e8b5903528c739"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a9a6d1001f395856d43e8b5903528c739">diversion_outgoing_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:a9a6d1001f395856d43e8b5903528c739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8b7f492a09d95f5bcad54745b61120"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#aad8b7f492a09d95f5bcad54745b61120">diversion_outgoing_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:aad8b7f492a09d95f5bcad54745b61120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0455adb445220618e7bf694e4d975835"><td class="memItemLeft" align="right" valign="top">static pjsip_fromto_hdr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a0455adb445220618e7bf694e4d975835">get_diversion_header</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a0455adb445220618e7bf694e4d975835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac56809b18003bb68913a38e8d7c50bbd"><td class="memItemLeft" align="right" valign="top">static pjsip_fromto_hdr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a> (pjsip_rx_data *rdata, const unsigned int <a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a>)</td></tr>
<tr class="separator:ac56809b18003bb68913a38e8d7c50bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0251b39032d951af558086e96020799"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0251b39032d951af558086e96020799">get_redirecting_add_diversion</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:ac0251b39032d951af558086e96020799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b13533d7aa909e171ba36316c0a2cdf"><td class="memItemLeft" align="right" valign="top">static const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a3b13533d7aa909e171ba36316c0a2cdf">reason_code_to_cause</a> (const struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *reason)</td></tr>
<tr class="separator:a3b13533d7aa909e171ba36316c0a2cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfa1f717702d2ee7798a40f238dbc2a"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a7dfa1f717702d2ee7798a40f238dbc2a">reason_code_to_str</a> (const struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *reason)</td></tr>
<tr class="separator:a7dfa1f717702d2ee7798a40f238dbc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41bf2b761b89af2b14e2313e64a7cb2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_fromto_hdr *from_info, pjsip_name_addr *to_info)</td></tr>
<tr class="separator:ab41bf2b761b89af2b14e2313e64a7cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18d696573886c7c5d77b1186792f820"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ac18d696573886c7c5d77b1186792f820">set_redirecting_id</a> (pjsip_name_addr *name_addr, struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *data, struct <a class="el" href="../../df/dcf/structast__set__party__id.html">ast_set_party_id</a> *<a class="el" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>)</td></tr>
<tr class="separator:ac18d696573886c7c5d77b1186792f820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0075cb93401f6bbfc37820e8aff49a5d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a0075cb93401f6bbfc37820e8aff49a5d">set_redirecting_reason</a> (pjsip_fromto_hdr *from_info, pjsip_name_addr *to_info, struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *data)</td></tr>
<tr class="separator:a0075cb93401f6bbfc37820e8aff49a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691a2393388e10276ec271c2afca87ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a691a2393388e10276ec271c2afca87ca">set_redirecting_reason_by_cause</a> (pjsip_name_addr *name_addr, struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *data)</td></tr>
<tr class="separator:a691a2393388e10276ec271c2afca87ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e8504b3e389a561cd0d2c55409dc80"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a> (char **dst, const pj_str_t *src)</td></tr>
<tr class="separator:ac0e8504b3e389a561cd0d2c55409dc80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9449cc9b3bc7c2081ba96b5ff27d994"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ad9449cc9b3bc7c2081ba96b5ff27d994">sip_is_token</a> (const char *<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr class="separator:ad9449cc9b3bc7c2081ba96b5ff27d994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Add Diversion Header Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip,res_pjsip_session&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c59eb2bd73a177525a003f3bb21430"><td class="memItemLeft" align="right" valign="top">static const pj_str_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a> = { &quot;Diversion&quot;, 9 }</td></tr>
<tr class="separator:aa0c59eb2bd73a177525a003f3bb21430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af87a810bed4f2c35cf45c6bbf14cf85d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#af87a810bed4f2c35cf45c6bbf14cf85d">diversion_supplement</a></td></tr>
<tr class="separator:af87a810bed4f2c35cf45c6bbf14cf85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d59bf50709fd4ae0a53b7343462e2d7"><td class="memItemLeft" align="right" valign="top">static pj_str_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a8d59bf50709fd4ae0a53b7343462e2d7">HISTINFO_SUPPORTED_NAME</a> = { &quot;histinfo&quot;, 8 }</td></tr>
<tr class="separator:a8d59bf50709fd4ae0a53b7343462e2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a836e53554b09224d39d1d4068bc97d"><td class="memItemLeft" align="right" valign="top">static const pj_str_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a> = { &quot;History-Info&quot;, 12 }</td></tr>
<tr class="separator:a6a836e53554b09224d39d1d4068bc97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261ead104dbe5a21fdcbae5d8f5328b5"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../df/d30/structreasons.html">reasons</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a> []</td></tr>
<tr class="separator:a261ead104dbe5a21fdcbae5d8f5328b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00730">730</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00730">730</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="ae06cf6cd14f54f63385ef60a0588eddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06cf6cd14f54f63385ef60a0588eddc">&#9670;&nbsp;</a></span>add_diversion_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_diversion_header </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">504</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00038">diversion_name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00528">ast_party_redirecting::from</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00543">ast_party_redirecting::reason</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00155">reason_code_to_str()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00053">sip_is_token()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00531">ast_party_redirecting::to</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">get_redirecting_add_diversion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t reason_name = { <span class="stringliteral">&quot;reason&quot;</span>, 6 };</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   pjsip_fromto_hdr *hdr;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   pjsip_name_addr *name_addr;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   pjsip_sip_uri *uri;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   pjsip_param *param;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   pjsip_fromto_hdr *old_hdr;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *reason_str;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *quote_str;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordtype">char</span> *reason_buf;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   pjsip_uri *base;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *<span class="keywordtype">id</span> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <span class="keywordflow">if</span> (tdata-&gt;msg-&gt;type == PJSIP_REQUEST_MSG) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordtype">id</span> = &amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="comment">/* In responses indicate the new destination */</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordtype">id</span> = &amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#ad6644f992fc696511eebf8732e98e74a">to</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   base = PJSIP_MSG_FROM_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keywordflow">if</span> (!id-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(id-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   hdr = pjsip_from_hdr_create(tdata-&gt;pool);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   hdr-&gt;type = PJSIP_H_OTHER;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   hdr-&gt;sname = hdr-&gt;name = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   name_addr = pjsip_uri_clone(tdata-&gt;pool, base);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   uri = pjsip_uri_get_uri(name_addr-&gt;uri);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   pj_strdup2(tdata-&gt;pool, &amp;name_addr-&gt;display, id-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   pj_strdup2(tdata-&gt;pool, &amp;uri-&gt;user, id-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   param = PJ_POOL_ALLOC_T(tdata-&gt;pool, pjsip_param);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   param-&gt;name = reason_name;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   reason_str = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a7dfa1f717702d2ee7798a40f238dbc2a">reason_code_to_str</a>(&amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#aa961ad9bce0cf7679c5d938519ff1885">reason</a>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">/* Reason is either already quoted or it is a token to not need quotes added. */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   quote_str = *reason_str == <span class="charliteral">&#39;\&quot;&#39;</span> || <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ad9449cc9b3bc7c2081ba96b5ff27d994">sip_is_token</a>(reason_str) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\&quot;&quot;</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   reason_buf = pj_pool_alloc(tdata-&gt;pool, strlen(reason_str) + 3);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   sprintf(reason_buf, <span class="stringliteral">&quot;%s%s%s&quot;</span>, quote_str, reason_str, quote_str);<span class="comment">/* Safe */</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   param-&gt;value = pj_str(reason_buf);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   pj_list_insert_before(&amp;hdr-&gt;other_param, param);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   hdr-&gt;uri = (pjsip_uri *) name_addr;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   old_hdr = pjsip_msg_find_hdr_by_name(tdata-&gt;msg, &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">if</span> (old_hdr) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      pj_list_erase(old_hdr);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *)hdr);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div><div class="ttc" id="structast__party__id_html"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html">ast_party_id</a></div><div class="ttdoc">Information needed to identify an endpoint in a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00339">channel.h:339</a></div></div>
<div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a7dfa1f717702d2ee7798a40f238dbc2a"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a7dfa1f717702d2ee7798a40f238dbc2a">reason_code_to_str</a></div><div class="ttdeci">static const char * reason_code_to_str(const struct ast_party_redirecting_reason *reason)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00155">res_pjsip_diversion.c:155</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ad9449cc9b3bc7c2081ba96b5ff27d994"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ad9449cc9b3bc7c2081ba96b5ff27d994">sip_is_token</a></div><div class="ttdeci">static int sip_is_token(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00053">res_pjsip_diversion.c:53</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_acf09e8312b8b4396ec42c5147cdf9b5b"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">ast_party_redirecting::from</a></div><div class="ttdeci">struct ast_party_id from</div><div class="ttdoc">Who is redirecting the call (Sent to the party the call is redirected toward) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00528">channel.h:528</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_aa961ad9bce0cf7679c5d938519ff1885"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#aa961ad9bce0cf7679c5d938519ff1885">ast_party_redirecting::reason</a></div><div class="ttdeci">struct ast_party_redirecting_reason reason</div><div class="ttdoc">Reason for the redirection. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00543">channel.h:543</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_ad6644f992fc696511eebf8732e98e74a"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#ad6644f992fc696511eebf8732e98e74a">ast_party_redirecting::to</a></div><div class="ttdeci">struct ast_party_id to</div><div class="ttdoc">Call is redirecting to a new party (Sent to the caller) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00531">channel.h:531</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_aa0c59eb2bd73a177525a003f3bb21430"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a></div><div class="ttdeci">static const pj_str_t diversion_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00038">res_pjsip_diversion.c:38</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ac4e3e4caff73c8541ef7b30ed7b7c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac4e3e4caff73c8541ef7b30ed7b7c3">&#9670;&nbsp;</a></span>add_history_info_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_history_info_header </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00572">572</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00085">reasons::cause</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00528">ast_party_redirecting::from</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00039">history_info_name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00543">ast_party_redirecting::reason</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00175">reason_code_to_cause()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00531">ast_party_redirecting::to</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">get_redirecting_add_diversion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t index_name = { <span class="stringliteral">&quot;index&quot;</span>, 5 };</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t cause_name = { <span class="stringliteral">&quot;cause&quot;</span>, 5 };</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t first_index = { <span class="stringliteral">&quot;1&quot;</span>, 1 };</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t last_index = { <span class="stringliteral">&quot;1.1&quot;</span>, 3 };</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   pjsip_fromto_hdr *hdr;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   pjsip_name_addr *name_addr;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   pjsip_sip_uri *uri;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   pjsip_param *param;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   pjsip_fromto_hdr *old_hdr;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cause;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keywordtype">char</span> *cause_buf;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *to = &amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#ad6644f992fc696511eebf8732e98e74a">to</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *from = &amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   pjsip_uri *base = PJSIP_MSG_TO_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   hdr = pjsip_from_hdr_create(tdata-&gt;pool);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   hdr-&gt;type = PJSIP_H_OTHER;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   hdr-&gt;sname = hdr-&gt;name = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   name_addr = pjsip_uri_clone(tdata-&gt;pool, base);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   uri = pjsip_uri_get_uri(name_addr-&gt;uri);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="comment">/* if no redirecting information, then TO is the original destination */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (from-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(from-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      pj_strdup2(tdata-&gt;pool, &amp;name_addr-&gt;display, from-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      pj_strdup2(tdata-&gt;pool, &amp;uri-&gt;user, from-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   param = PJ_POOL_ALLOC_T(tdata-&gt;pool, pjsip_param);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   param-&gt;name = index_name;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   param-&gt;value = first_index;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   pj_list_insert_before(&amp;hdr-&gt;other_param, param);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   hdr-&gt;uri = (pjsip_uri *) name_addr;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keywordflow">while</span> ((old_hdr = pjsip_msg_find_hdr_by_name(tdata-&gt;msg, &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      pj_list_erase(old_hdr);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *)hdr);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordflow">if</span> (!to-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(to-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   hdr = pjsip_from_hdr_create(tdata-&gt;pool);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   hdr-&gt;type = PJSIP_H_OTHER;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   hdr-&gt;sname = hdr-&gt;name = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   name_addr = pjsip_uri_clone(tdata-&gt;pool, base);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   uri = pjsip_uri_get_uri(name_addr-&gt;uri);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   pj_strdup2(tdata-&gt;pool, &amp;name_addr-&gt;display, to-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   pj_strdup2(tdata-&gt;pool, &amp;uri-&gt;user, to-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   param = PJ_POOL_ALLOC_T(tdata-&gt;pool, pjsip_param);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   param-&gt;name = index_name;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   param-&gt;value = last_index;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   pj_list_insert_before(&amp;hdr-&gt;other_param, param);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   param = PJ_POOL_ALLOC_T(tdata-&gt;pool, pjsip_param);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   param-&gt;name = cause_name;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   cause = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a3b13533d7aa909e171ba36316c0a2cdf">reason_code_to_cause</a>(&amp;data-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#aa961ad9bce0cf7679c5d938519ff1885">reason</a>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   cause_buf = pj_pool_alloc(tdata-&gt;pool, 4);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   snprintf(cause_buf, 4, <span class="stringliteral">&quot;%ud&quot;</span>, cause);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   param-&gt;value = pj_str(cause_buf);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   pj_list_insert_before(&amp;uri-&gt;other_param, param);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   hdr-&gt;uri = (pjsip_uri *) name_addr;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *)hdr);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div><div class="ttc" id="structast__party__id_html"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html">ast_party_id</a></div><div class="ttdoc">Information needed to identify an endpoint in a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00339">channel.h:339</a></div></div>
<div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a3b13533d7aa909e171ba36316c0a2cdf"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a3b13533d7aa909e171ba36316c0a2cdf">reason_code_to_cause</a></div><div class="ttdeci">static const unsigned int reason_code_to_cause(const struct ast_party_redirecting_reason *reason)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00175">res_pjsip_diversion.c:175</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_acf09e8312b8b4396ec42c5147cdf9b5b"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">ast_party_redirecting::from</a></div><div class="ttdeci">struct ast_party_id from</div><div class="ttdoc">Who is redirecting the call (Sent to the party the call is redirected toward) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00528">channel.h:528</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a6a836e53554b09224d39d1d4068bc97d"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a></div><div class="ttdeci">static const pj_str_t history_info_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00039">res_pjsip_diversion.c:39</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_aa961ad9bce0cf7679c5d938519ff1885"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#aa961ad9bce0cf7679c5d938519ff1885">ast_party_redirecting::reason</a></div><div class="ttdeci">struct ast_party_redirecting_reason reason</div><div class="ttdoc">Reason for the redirection. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00543">channel.h:543</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_ad6644f992fc696511eebf8732e98e74a"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#ad6644f992fc696511eebf8732e98e74a">ast_party_redirecting::to</a></div><div class="ttdeci">struct ast_party_id to</div><div class="ttdoc">Call is redirecting to a new party (Sent to the caller) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00531">channel.h:531</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a4295169d9745fed048e67d50327a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4295169d9745fed048e67d50327a80">&#9670;&nbsp;</a></span>add_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_supported </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00120">120</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00040">HISTINFO_SUPPORTED_NAME</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">get_redirecting_add_diversion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   pjsip_supported_hdr *hdr;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   hdr = pjsip_msg_find_hdr(tdata-&gt;msg, PJSIP_H_SUPPORTED, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keywordflow">if</span> (!hdr) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">/* insert a new Supported header */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      hdr = pjsip_supported_hdr_create(tdata-&gt;pool);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> (!hdr) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *)hdr);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="comment">/* Asterisk can send multiple &quot;181 Call forwarded&quot; in a single session,</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">    * we might have already modified Supported before</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; hdr-&gt;count; ++i) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> (pj_stricmp(&amp;hdr-&gt;values[i], &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a8d59bf50709fd4ae0a53b7343462e2d7">HISTINFO_SUPPORTED_NAME</a>) == 0) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span> (hdr-&gt;count &gt;= PJSIP_GENERIC_ARRAY_MAX_COUNT) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="comment">/* add on to the existing Supported header */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   pj_strassign(&amp;hdr-&gt;values[hdr-&gt;count++], &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a8d59bf50709fd4ae0a53b7343462e2d7">HISTINFO_SUPPORTED_NAME</a>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_a8d59bf50709fd4ae0a53b7343462e2d7"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a8d59bf50709fd4ae0a53b7343462e2d7">HISTINFO_SUPPORTED_NAME</a></div><div class="ttdeci">static pj_str_t HISTINFO_SUPPORTED_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00040">res_pjsip_diversion.c:40</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00730">730</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="adcf076e5a872adbe3baa9ac4a0437a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcf076e5a872adbe3baa9ac4a0437a3e">&#9670;&nbsp;</a></span>cause_to_reason()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169">AST_REDIRECTING_REASON</a> cause_to_reason </td>
          <td>(</td>
          <td class="paramtype">const unsigned long&#160;</td>
          <td class="paramname"><em>cause</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00102">102</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d47/callerid_8h_source.html#l00398">AST_REDIRECTING_REASON_DEFLECTION</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00393">AST_REDIRECTING_REASON_NO_ANSWER</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00394">AST_REDIRECTING_REASON_UNAVAILABLE</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00395">AST_REDIRECTING_REASON_UNCONDITIONAL</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00391">AST_REDIRECTING_REASON_UNKNOWN</a>, and <a class="el" href="../../de/d47/callerid_8h_source.html#l00392">AST_REDIRECTING_REASON_USER_BUSY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00326">set_redirecting_reason_by_cause()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                                              {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">switch</span>(cause) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">case</span> 302:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169ac0b65b437eabc6c251883b9094d74b5e">AST_REDIRECTING_REASON_UNCONDITIONAL</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">case</span> 486:</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169aeb1c62f996a259e85eed7e6e529addaf">AST_REDIRECTING_REASON_USER_BUSY</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">case</span> 408:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a44d73d03e9d22a95d04fecb97a4a96a5">AST_REDIRECTING_REASON_NO_ANSWER</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">case</span> 480:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">case</span> 487:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169ab66eaca00d890abee0495c676b5789b1">AST_REDIRECTING_REASON_DEFLECTION</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">case</span> 503:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169abdb90f3f8c8155369dcdbd057188a78e">AST_REDIRECTING_REASON_UNAVAILABLE</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div><div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169a44d73d03e9d22a95d04fecb97a4a96a5"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a44d73d03e9d22a95d04fecb97a4a96a5">AST_REDIRECTING_REASON_NO_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00393">callerid.h:393</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00391">callerid.h:391</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169aeb1c62f996a259e85eed7e6e529addaf"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169aeb1c62f996a259e85eed7e6e529addaf">AST_REDIRECTING_REASON_USER_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00392">callerid.h:392</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169abdb90f3f8c8155369dcdbd057188a78e"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169abdb90f3f8c8155369dcdbd057188a78e">AST_REDIRECTING_REASON_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00394">callerid.h:394</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169ac0b65b437eabc6c251883b9094d74b5e"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169ac0b65b437eabc6c251883b9094d74b5e">AST_REDIRECTING_REASON_UNCONDITIONAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00395">callerid.h:395</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169ab66eaca00d890abee0495c676b5789b1"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169ab66eaca00d890abee0495c676b5789b1">AST_REDIRECTING_REASON_DEFLECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00398">callerid.h:398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae60728e5b3f383ff67ff3f2970032265"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60728e5b3f383ff67ff3f2970032265">&#9670;&nbsp;</a></span>copy_redirecting_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void copy_redirecting_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/dcf/structast__set__party__id.html">ast_set_party_id</a> *&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00312">312</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d28/channel_8c_source.html#l01765">ast_party_id_copy()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00364">ast_set_party_id::name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00366">ast_set_party_id::number</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">set_redirecting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a>(dst, src);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      update-&gt;<a class="code" href="../../df/dcf/structast__set__party__id.html#aa6787fc6eb732987040b1f378489db54">number</a> = 1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      update-&gt;<a class="code" href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">name</a> = 1;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="channel_8h_html_abbf5c9830dd3533f3a6d5d35f941effb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a></div><div class="ttdeci">void ast_party_id_copy(struct ast_party_id *dest, const struct ast_party_id *src)</div><div class="ttdoc">Copy the source party id information to the destination party id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01765">channel.c:1765</a></div></div>
<div class="ttc" id="structast__set__party__id_html_aa6787fc6eb732987040b1f378489db54"><div class="ttname"><a href="../../df/dcf/structast__set__party__id.html#aa6787fc6eb732987040b1f378489db54">ast_set_party_id::number</a></div><div class="ttdeci">unsigned char number</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00366">channel.h:366</a></div></div>
<div class="ttc" id="structast__set__party__id_html_abbd32f02dc419af56bdf709336f6c33e"><div class="ttname"><a href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">ast_set_party_id::name</a></div><div class="ttdeci">unsigned char name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00364">channel.h:364</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a990557f8a0e254af190df1a38febb9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a990557f8a0e254af190df1a38febb9e4">&#9670;&nbsp;</a></span>diversion_incoming_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int diversion_incoming_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00427">427</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">get_diversion_header()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">get_history_info_header()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">set_redirecting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   pjsip_fromto_hdr *hdr = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a0455adb445220618e7bf694e4d975835">get_diversion_header</a>(rdata);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">if</span> (hdr) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a>(session, hdr, (pjsip_name_addr*)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            PJSIP_MSG_TO_HDR(rdata-&gt;msg_info.msg)-&gt;uri);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      pjsip_fromto_hdr *history_info_to;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      pjsip_fromto_hdr *history_info_from;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      history_info_to  = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a>(rdata, 0);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">if</span> (history_info_to) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         <span class="comment">/* If History-Info is present, then it will also include the original</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">            redirected-from in addition to the redirected-to */</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         history_info_from = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a>(rdata, 1);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a>(session, history_info_from, (pjsip_name_addr*)history_info_to-&gt;uri);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_ac56809b18003bb68913a38e8d7c50bbd"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a></div><div class="ttdeci">static pjsip_fromto_hdr * get_history_info_header(pjsip_rx_data *rdata, const unsigned int first)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">res_pjsip_diversion.c:215</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ab41bf2b761b89af2b14e2313e64a7cb2"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a></div><div class="ttdeci">static void set_redirecting(struct ast_sip_session *session, pjsip_fromto_hdr *from_info, pjsip_name_addr *to_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">res_pjsip_diversion.c:386</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a0455adb445220618e7bf694e4d975835"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a0455adb445220618e7bf694e4d975835">get_diversion_header</a></div><div class="ttdeci">static pjsip_fromto_hdr * get_diversion_header(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">res_pjsip_diversion.c:190</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad58d5f9ec5a75ff5817caa254b207844"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58d5f9ec5a75ff5817caa254b207844">&#9670;&nbsp;</a></span>diversion_incoming_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void diversion_incoming_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00450">450</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">get_diversion_header()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">get_history_info_header()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">set_redirecting()</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t contact_name = { <span class="stringliteral">&quot;Contact&quot;</span>, 7 };</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t contact_name_s = { <span class="stringliteral">&quot;m&quot;</span>, 1 };</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   pjsip_status_line <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = rdata-&gt;msg_info.msg-&gt;line.status;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   pjsip_fromto_hdr *div_hdr;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   pjsip_fromto_hdr *history_info_to;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   pjsip_fromto_hdr *history_info_from;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   pjsip_contact_hdr *contact_hdr;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keywordflow">if</span> ((status.code != 302) &amp;&amp; (status.code != 181)) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <span class="comment">/* use the diversion header info if there is one. if not one then use the</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">      the history-info, if that doesn&#39;t exist, use session caller id info. if</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">      that doesn&#39;t exist use info from the To hdr*/</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keywordflow">if</span> (!(div_hdr = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a0455adb445220618e7bf694e4d975835">get_diversion_header</a>(rdata))) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      history_info_to  = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a>(rdata, 0);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">if</span> (history_info_to) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         <span class="comment">/* If History-Info is present, then it will also include the original</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">            redirected-from in addition to the redirected-to */</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         history_info_from = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a>(rdata, 1);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a>(session, history_info_from, (pjsip_name_addr*)history_info_to-&gt;uri);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (!div_hdr &amp;&amp; !session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;         div_hdr = PJSIP_MSG_TO_HDR(rdata-&gt;msg_info.msg);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keywordflow">if</span> (status.code == 302) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">/* With 302, Contact indicates the final destination and possibly Diversion indicates the hop before */</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      contact_hdr = pjsip_msg_find_hdr_by_names(rdata-&gt;msg_info.msg, &amp;contact_name, &amp;contact_name_s, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a>(session, div_hdr, contact_hdr ? (pjsip_name_addr*)contact_hdr-&gt;uri :</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            (pjsip_name_addr*)PJSIP_MSG_FROM_HDR(rdata-&gt;msg_info.msg)-&gt;uri);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">/* With 181, Diversion is non-standard, but if present indicates the new final destination, and To indicating the original */</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a>(session, PJSIP_MSG_TO_HDR(rdata-&gt;msg_info.msg),</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            div_hdr ? (pjsip_name_addr*)div_hdr-&gt;uri : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_ac56809b18003bb68913a38e8d7c50bbd"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac56809b18003bb68913a38e8d7c50bbd">get_history_info_header</a></div><div class="ttdeci">static pjsip_fromto_hdr * get_history_info_header(pjsip_rx_data *rdata, const unsigned int first)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">res_pjsip_diversion.c:215</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ab41bf2b761b89af2b14e2313e64a7cb2"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ab41bf2b761b89af2b14e2313e64a7cb2">set_redirecting</a></div><div class="ttdeci">static void set_redirecting(struct ast_sip_session *session, pjsip_fromto_hdr *from_info, pjsip_name_addr *to_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">res_pjsip_diversion.c:386</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a0455adb445220618e7bf694e4d975835"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a0455adb445220618e7bf694e4d975835">get_diversion_header</a></div><div class="ttdeci">static pjsip_fromto_hdr * get_diversion_header(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">res_pjsip_diversion.c:190</a></div></div>
<div class="ttc" id="structast__sip__session_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_sip_session::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">res_pjsip_session.h:207</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a6d1001f395856d43e8b5903528c739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a6d1001f395856d43e8b5903528c739">&#9670;&nbsp;</a></span>diversion_outgoing_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void diversion_outgoing_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00675">675</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">get_redirecting_add_diversion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0251b39032d951af558086e96020799">get_redirecting_add_diversion</a>(session, tdata);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_ac0251b39032d951af558086e96020799"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac0251b39032d951af558086e96020799">get_redirecting_add_diversion</a></div><div class="ttdeci">static void get_redirecting_add_diversion(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">res_pjsip_diversion.c:651</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad8b7f492a09d95f5bcad54745b61120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8b7f492a09d95f5bcad54745b61120">&#9670;&nbsp;</a></span>diversion_outgoing_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void diversion_outgoing_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00687">687</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">get_redirecting_add_diversion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <span class="keyword">struct </span>pjsip_status_line <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = tdata-&gt;msg-&gt;line.status;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <span class="comment">/* add to 302 and 181 */</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keywordflow">if</span> (PJSIP_IS_STATUS_IN_CLASS(status.code, 300) || (status.code == 181)) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0251b39032d951af558086e96020799">get_redirecting_add_diversion</a>(session, tdata);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_ac0251b39032d951af558086e96020799"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac0251b39032d951af558086e96020799">get_redirecting_add_diversion</a></div><div class="ttdeci">static void get_redirecting_add_diversion(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">res_pjsip_diversion.c:651</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0455adb445220618e7bf694e4d975835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0455adb445220618e7bf694e4d975835">&#9670;&nbsp;</a></span>get_diversion_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_fromto_hdr* get_diversion_header </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">190</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00038">diversion_name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00427">diversion_incoming_request()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00450">diversion_incoming_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t from_name = { <span class="stringliteral">&quot;From&quot;</span>, 4 };</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   pjsip_generic_string_hdr *hdr;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   pj_str_t <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordflow">if</span> (!(hdr = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   pj_strdup_with_null(rdata-&gt;tp_info.pool, &amp;value, &amp;hdr-&gt;hvalue);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="comment">/* parse as a fromto header */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">return</span> pjsip_parse_hdr(rdata-&gt;tp_info.pool, &amp;from_name, value.ptr,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                pj_strlen(&amp;value), &amp;size);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_aa0c59eb2bd73a177525a003f3bb21430"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#aa0c59eb2bd73a177525a003f3bb21430">diversion_name</a></div><div class="ttdeci">static const pj_str_t diversion_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00038">res_pjsip_diversion.c:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac56809b18003bb68913a38e8d7c50bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56809b18003bb68913a38e8d7c50bbd">&#9670;&nbsp;</a></span>get_history_info_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_fromto_hdr* get_history_info_header </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">215</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00039">history_info_name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00427">diversion_incoming_request()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00450">diversion_incoming_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t from_name = { <span class="stringliteral">&quot;From&quot;</span>, 4 };</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   pjsip_fromto_hdr * result_hdr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   pjsip_generic_string_hdr *hdr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   hdr = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">if</span> (!hdr) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t index_name = { <span class="stringliteral">&quot;index&quot;</span>, 5 };</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      pj_str_t <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordtype">int</span> size;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      pjsip_fromto_hdr * fromto_hdr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      pjsip_param * index = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      pj_strdup_with_null(rdata-&gt;tp_info.pool, &amp;value, &amp;hdr-&gt;hvalue);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">/* parse as a fromto header */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      fromto_hdr =  pjsip_parse_hdr(rdata-&gt;tp_info.pool, &amp;from_name, value.ptr,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                   pj_strlen(&amp;value), &amp;size);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">if</span> (fromto_hdr == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      index = pjsip_param_find(&amp;fromto_hdr-&gt;other_param, &amp;index_name);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">if</span> (index) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <span class="keywordflow">if</span> (!pj_strcmp2(&amp;index-&gt;value, <span class="stringliteral">&quot;1&quot;</span>)) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../df/d44/app__meetme_8c.html#a18b6f1cf748d864dd085819a7d4e6680">first</a>) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;               <span class="keywordflow">return</span> fromto_hdr;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      result_hdr = fromto_hdr;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   } <span class="keywordflow">while</span> ((hdr = pjsip_msg_find_hdr_by_name(rdata-&gt;msg_info.msg, &amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a>, hdr-&gt;next)));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordflow">return</span> result_hdr;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a6a836e53554b09224d39d1d4068bc97d"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a6a836e53554b09224d39d1d4068bc97d">history_info_name</a></div><div class="ttdeci">static const pj_str_t history_info_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00039">res_pjsip_diversion.c:39</a></div></div>
<div class="ttc" id="app__meetme_8c_html_a18b6f1cf748d864dd085819a7d4e6680"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a18b6f1cf748d864dd085819a7d4e6680">first</a></div><div class="ttdeci">struct sla_ringing_trunk * first</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01092">app_meetme.c:1092</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0251b39032d951af558086e96020799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0251b39032d951af558086e96020799">&#9670;&nbsp;</a></span>get_redirecting_add_diversion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void get_redirecting_add_diversion </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00651">651</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">add_diversion_header()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00572">add_history_info_header()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00120">add_supported()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00908">ast_channel_redirecting()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00641">ast_sip_endpoint_id_configuration::send_diversion</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00649">ast_sip_endpoint_id_configuration::send_history_info</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00675">diversion_outgoing_request()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00687">diversion_outgoing_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;{</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> *data;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a7a4295169d9745fed048e67d50327a80">add_supported</a>(tdata);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> &amp;&amp; session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a183c1e73b5aa7be0c84f5df1fb6eb95a">send_diversion</a> &amp;&amp;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;       (data = <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>))-&gt;count) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ae06cf6cd14f54f63385ef60a0588eddc">add_diversion_header</a>(tdata, data);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> &amp;&amp; session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a4415f480cf9f9cefd524e14174c1f0ee">send_history_info</a>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      data = <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a5ac4e3e4caff73c8541ef7b30ed7b7c3">add_history_info_header</a>(tdata, data);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a4415f480cf9f9cefd524e14174c1f0ee"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a4415f480cf9f9cefd524e14174c1f0ee">ast_sip_endpoint_id_configuration::send_history_info</a></div><div class="ttdeci">unsigned int send_history_info</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00649">res_pjsip.h:649</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a5ac4e3e4caff73c8541ef7b30ed7b7c3"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a5ac4e3e4caff73c8541ef7b30ed7b7c3">add_history_info_header</a></div><div class="ttdeci">static void add_history_info_header(pjsip_tx_data *tdata, struct ast_party_redirecting *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00572">res_pjsip_diversion.c:572</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ae06cf6cd14f54f63385ef60a0588eddc"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ae06cf6cd14f54f63385ef60a0588eddc">add_diversion_header</a></div><div class="ttdeci">static void add_diversion_header(pjsip_tx_data *tdata, struct ast_party_redirecting *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">res_pjsip_diversion.c:504</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a7a4295169d9745fed048e67d50327a80"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a7a4295169d9745fed048e67d50327a80">add_supported</a></div><div class="ttdeci">static int add_supported(pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00120">res_pjsip_diversion.c:120</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="structast__party__redirecting_html"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a></div><div class="ttdoc">Redirecting Line information. RDNIS (Redirecting Directory Number Information Service) Where a call d...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00523">channel.h:523</a></div></div>
<div class="ttc" id="channel_8h_html_ad2334e69c466aec25ba3cbba53b7201b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a></div><div class="ttdeci">struct ast_party_redirecting * ast_channel_redirecting(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00908">channel_internal_api.c:908</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a183c1e73b5aa7be0c84f5df1fb6eb95a"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a183c1e73b5aa7be0c84f5df1fb6eb95a">ast_sip_endpoint_id_configuration::send_diversion</a></div><div class="ttdeci">unsigned int send_diversion</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00641">res_pjsip.h:641</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00709">709</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00464">ast_module_shutdown_ref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00616">ast_sip_session_register_supplement</a>, and <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00718">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="comment">/* Because we are passing static memory to pjsip, we need to make sure it</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">    * stays valid while we potentially have active sessions */</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#aa21df5d2fdfb2d6e2734a3056ec3db7c">ast_sip_session_register_supplement</a>(&amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#af87a810bed4f2c35cf45c6bbf14cf85d">diversion_supplement</a>);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="module_8h_html_a9967b09817639f2e15c3f074a60b6379"><div class="ttname"><a href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a></div><div class="ttdeci">#define ast_module_shutdown_ref(mod)</div><div class="ttdoc">Prevent unload of the module before shutdown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00464">module.h:464</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_af87a810bed4f2c35cf45c6bbf14cf85d"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#af87a810bed4f2c35cf45c6bbf14cf85d">diversion_supplement</a></div><div class="ttdeci">static struct ast_sip_session_supplement diversion_supplement</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00697">res_pjsip_diversion.c:697</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_aa21df5d2fdfb2d6e2734a3056ec3db7c"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#aa21df5d2fdfb2d6e2734a3056ec3db7c">ast_sip_session_register_supplement</a></div><div class="ttdeci">#define ast_sip_session_register_supplement(supplement)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00616">res_pjsip_session.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b13533d7aa909e171ba36316c0a2cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b13533d7aa909e171ba36316c0a2cdf">&#9670;&nbsp;</a></span>reason_code_to_cause()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const unsigned int reason_code_to_cause </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *&#160;</td>
          <td class="paramname"><em>reason</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00175">175</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00085">reasons::cause</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00511">ast_party_redirecting_reason::code</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00083">reasons::code</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00572">add_history_info_header()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keywordtype">int</span> code;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   code = reason-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>); ++idx) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (code == <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>[idx].code) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>[idx].<a class="code" href="../../df/d30/structreasons.html#a729cfb9a2317e733ac4cdeeb4bbdf96a">cause</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">return</span> 404;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a261ead104dbe5a21fdcbae5d8f5328b5"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a></div><div class="ttdeci">static const struct reasons reason_table[]</div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">ast_party_redirecting_reason::code</a></div><div class="ttdeci">int code</div><div class="ttdoc">enum AST_REDIRECTING_REASON value for redirection </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00511">channel.h:511</a></div></div>
<div class="ttc" id="structreasons_html_a729cfb9a2317e733ac4cdeeb4bbdf96a"><div class="ttname"><a href="../../df/d30/structreasons.html#a729cfb9a2317e733ac4cdeeb4bbdf96a">reasons::cause</a></div><div class="ttdeci">const unsigned int cause</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00085">res_pjsip_diversion.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dfa1f717702d2ee7798a40f238dbc2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfa1f717702d2ee7798a40f238dbc2a">&#9670;&nbsp;</a></span>reason_code_to_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* reason_code_to_str </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *&#160;</td>
          <td class="paramname"><em>reason</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00155">155</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00511">ast_party_redirecting_reason::code</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00083">reasons::code</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00508">ast_party_redirecting_reason::str</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00084">reasons::text</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">add_diversion_header()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordtype">int</span> code;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="comment">/* use specific string if given */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(reason-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> reason-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   code = reason-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>); ++idx) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> (code == <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>[idx].code) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a>[idx].<a class="code" href="../../df/d30/structreasons.html#a16343090e80c4472521560f30113d96c">text</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="ttc" id="structreasons_html_a16343090e80c4472521560f30113d96c"><div class="ttname"><a href="../../df/d30/structreasons.html#a16343090e80c4472521560f30113d96c">reasons::text</a></div><div class="ttdeci">const char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00084">res_pjsip_diversion.c:84</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a261ead104dbe5a21fdcbae5d8f5328b5"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a261ead104dbe5a21fdcbae5d8f5328b5">reason_table</a></div><div class="ttdeci">static const struct reasons reason_table[]</div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">ast_party_redirecting_reason::code</a></div><div class="ttdeci">int code</div><div class="ttdoc">enum AST_REDIRECTING_REASON value for redirection </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00511">channel.h:511</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_redirecting_reason::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">a string value for the redirecting reason </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00508">channel.h:508</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab41bf2b761b89af2b14e2313e64a7cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41bf2b761b89af2b14e2313e64a7cb2">&#9670;&nbsp;</a></span>set_redirecting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_redirecting </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_fromto_hdr *&#160;</td>
          <td class="paramname"><em>from_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_name_addr *&#160;</td>
          <td class="paramname"><em>to_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">386</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d28/channel_8c_source.html#l10392">ast_channel_queue_redirecting_update()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l09215">ast_channel_set_redirecting()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02179">ast_party_redirecting_free()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02122">ast_party_redirecting_init()</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00391">AST_REDIRECTING_REASON_UNKNOWN</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01750">ast_set_party_id_all()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00511">ast_party_redirecting_reason::code</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00312">copy_redirecting_id()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00549">ast_party_redirecting::count</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00528">ast_party_redirecting::from</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00560">ast_set_party_redirecting::from</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00566">ast_set_party_redirecting::priv_from</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00564">ast_set_party_redirecting::priv_orig</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00568">ast_set_party_redirecting::priv_to</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00543">ast_party_redirecting::reason</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00273">set_redirecting_id()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00351">set_redirecting_reason()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00531">ast_party_redirecting::to</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00562">ast_set_party_redirecting::to</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00427">diversion_incoming_request()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00450">diversion_incoming_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> data;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/df8/structast__set__party__redirecting.html">ast_set_party_redirecting</a> <a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a1a5760823cd16fd0343e489efd9c8f89">ast_party_redirecting_init</a>(&amp;data);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   memset(&amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   data.reason.code = <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span> (from_info) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac18d696573886c7c5d77b1186792f820">set_redirecting_id</a>((pjsip_name_addr*)from_info-&gt;uri,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         &amp;data.from, &amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.from);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a0075cb93401f6bbfc37820e8aff49a5d">set_redirecting_reason</a>(from_info, to_info, &amp;data.reason);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aa095ba128741aac1e9306e4956be8707">ast_set_party_id_all</a>(&amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.priv_to);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ae60728e5b3f383ff67ff3f2970032265">copy_redirecting_id</a>(&amp;data.from, &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>, &amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.from);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">if</span> (to_info) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac18d696573886c7c5d77b1186792f820">set_redirecting_id</a>(to_info, &amp;data.to, &amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.to);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa095ba128741aac1e9306e4956be8707">ast_set_party_id_all</a>(&amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.priv_orig);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa095ba128741aac1e9306e4956be8707">ast_set_party_id_all</a>(&amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.priv_from);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa095ba128741aac1e9306e4956be8707">ast_set_party_id_all</a>(&amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>.priv_to);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   ++data.count;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a1cb98e78f1231d96dad09ddaeaf0981d">ast_channel_set_redirecting</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, &amp;data, &amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="comment">/* Only queue an indication if it was due to a response */</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;role == PJSIP_ROLE_UAC) {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a8195bba43b7c08b3063bd19b28291b55">ast_channel_queue_redirecting_update</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, &amp;data, &amp;<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ac8bce0bf79829c59a7671c4eff83a31f">ast_party_redirecting_free</a>(&amp;data);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="ttc" id="res__pjsip__diversion_8c_html_ae60728e5b3f383ff67ff3f2970032265"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ae60728e5b3f383ff67ff3f2970032265">copy_redirecting_id</a></div><div class="ttdeci">static void copy_redirecting_id(struct ast_party_id *dst, const struct ast_party_id *src, struct ast_set_party_id *update)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00312">res_pjsip_diversion.c:312</a></div></div>
<div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00391">callerid.h:391</a></div></div>
<div class="ttc" id="codec__g726_8c_html_a8c58a1d1fd9436ff5145385d3ef7a430"><div class="ttname"><a href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a></div><div class="ttdeci">static void update(int code_size, int y, int wi, int fi, int dq, int sr, int dqsez, struct g726_state *state_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/codec__g726_8c_source.html#l00367">codec_g726.c:367</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="channel_8h_html_a1cb98e78f1231d96dad09ddaeaf0981d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1cb98e78f1231d96dad09ddaeaf0981d">ast_channel_set_redirecting</a></div><div class="ttdeci">void ast_channel_set_redirecting(struct ast_channel *chan, const struct ast_party_redirecting *redirecting, const struct ast_set_party_redirecting *update)</div><div class="ttdoc">Set the redirecting id information in the Asterisk channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l09215">channel.c:9215</a></div></div>
<div class="ttc" id="structast__party__redirecting_html"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a></div><div class="ttdoc">Redirecting Line information. RDNIS (Redirecting Directory Number Information Service) Where a call d...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00523">channel.h:523</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a0075cb93401f6bbfc37820e8aff49a5d"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a0075cb93401f6bbfc37820e8aff49a5d">set_redirecting_reason</a></div><div class="ttdeci">static void set_redirecting_reason(pjsip_fromto_hdr *from_info, pjsip_name_addr *to_info, struct ast_party_redirecting_reason *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00351">res_pjsip_diversion.c:351</a></div></div>
<div class="ttc" id="channel_8h_html_ac8bce0bf79829c59a7671c4eff83a31f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac8bce0bf79829c59a7671c4eff83a31f">ast_party_redirecting_free</a></div><div class="ttdeci">void ast_party_redirecting_free(struct ast_party_redirecting *doomed)</div><div class="ttdoc">Destroy the redirecting information contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02179">channel.c:2179</a></div></div>
<div class="ttc" id="structast__set__party__redirecting_html"><div class="ttname"><a href="../../de/df8/structast__set__party__redirecting.html">ast_set_party_redirecting</a></div><div class="ttdoc">Indicate what information in ast_party_redirecting should be set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00556">channel.h:556</a></div></div>
<div class="ttc" id="channel_8h_html_a1a5760823cd16fd0343e489efd9c8f89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1a5760823cd16fd0343e489efd9c8f89">ast_party_redirecting_init</a></div><div class="ttdeci">void ast_party_redirecting_init(struct ast_party_redirecting *init)</div><div class="ttdoc">Initialize the given redirecting structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02122">channel.c:2122</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ac18d696573886c7c5d77b1186792f820"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac18d696573886c7c5d77b1186792f820">set_redirecting_id</a></div><div class="ttdeci">static void set_redirecting_id(pjsip_name_addr *name_addr, struct ast_party_id *data, struct ast_set_party_id *update)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00273">res_pjsip_diversion.c:273</a></div></div>
<div class="ttc" id="channel_8h_html_a8195bba43b7c08b3063bd19b28291b55"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8195bba43b7c08b3063bd19b28291b55">ast_channel_queue_redirecting_update</a></div><div class="ttdeci">void ast_channel_queue_redirecting_update(struct ast_channel *chan, const struct ast_party_redirecting *redirecting, const struct ast_set_party_redirecting *update)</div><div class="ttdoc">Queue a redirecting update frame on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10392">channel.c:10392</a></div></div>
<div class="ttc" id="channel_8h_html_aa095ba128741aac1e9306e4956be8707"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa095ba128741aac1e9306e4956be8707">ast_set_party_id_all</a></div><div class="ttdeci">void ast_set_party_id_all(struct ast_set_party_id *update_id)</div><div class="ttdoc">Set the update marker to update all information of a corresponding party id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01750">channel.c:1750</a></div></div>
<div class="ttc" id="structast__sip__session_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_sip_session::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">res_pjsip_session.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac18d696573886c7c5d77b1186792f820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac18d696573886c7c5d77b1186792f820">&#9670;&nbsp;</a></span>set_redirecting_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_redirecting_id </td>
          <td>(</td>
          <td class="paramtype">pjsip_name_addr *&#160;</td>
          <td class="paramname"><em>name_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/dcf/structast__set__party__id.html">ast_set_party_id</a> *&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00273">273</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00364">ast_set_party_id::name</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00366">ast_set_party_id::number</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00264">set_redirecting_value()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">set_redirecting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   pjsip_sip_uri *uri = pjsip_uri_get_uri(name_addr-&gt;uri);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordtype">char</span> *semi;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   pj_str_t uri_user;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   uri_user = uri-&gt;user;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="comment">/* Always truncate redirecting number at a semicolon. */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   semi = pj_strchr(&amp;uri_user, <span class="charliteral">&#39;;&#39;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">if</span> (semi) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">       * We need to be able to handle URI&#39;s looking like</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">       * &quot;sip:1235557890;phone-context=national@x.x.x.x;user=phone&quot;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">       * Where the uri-&gt;user field will result in:</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">       * &quot;1235557890;phone-context=national&quot;</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">       * People don&#39;t care about anything after the semicolon</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">       * showing up on their displays even though the RFC</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">       * allows the semicolon.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      pj_strset(&amp;uri_user, (<span class="keywordtype">char</span> *) pj_strbuf(&amp;uri_user), semi - pj_strbuf(&amp;uri_user));</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordflow">if</span> (pj_strlen(&amp;uri_user)) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      update-&gt;<a class="code" href="../../df/dcf/structast__set__party__id.html#aa6787fc6eb732987040b1f378489db54">number</a> = 1;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      data-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> = 1;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a>(&amp;data-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, &amp;uri_user);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="keywordflow">if</span> (pj_strlen(&amp;name_addr-&gt;display)) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      update-&gt;<a class="code" href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">name</a> = 1;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      data-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> = 1;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a>(&amp;data-&gt;<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, &amp;name_addr-&gt;display);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ac0e8504b3e389a561cd0d2c55409dc80"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a></div><div class="ttdeci">static void set_redirecting_value(char **dst, const pj_str_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00264">res_pjsip_diversion.c:264</a></div></div>
<div class="ttc" id="structast__set__party__id_html_aa6787fc6eb732987040b1f378489db54"><div class="ttname"><a href="../../df/dcf/structast__set__party__id.html#aa6787fc6eb732987040b1f378489db54">ast_set_party_id::number</a></div><div class="ttdeci">unsigned char number</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00366">channel.h:366</a></div></div>
<div class="ttc" id="structast__set__party__id_html_abbd32f02dc419af56bdf709336f6c33e"><div class="ttname"><a href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">ast_set_party_id::name</a></div><div class="ttdeci">unsigned char name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00364">channel.h:364</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0075cb93401f6bbfc37820e8aff49a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0075cb93401f6bbfc37820e8aff49a5d">&#9670;&nbsp;</a></span>set_redirecting_reason()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_redirecting_reason </td>
          <td>(</td>
          <td class="paramtype">pjsip_fromto_hdr *&#160;</td>
          <td class="paramname"><em>from_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_name_addr *&#160;</td>
          <td class="paramname"><em>to_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00351">351</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../dc/dd5/callerid_8c_source.html#l01223">ast_redirecting_reason_parse()</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00391">AST_REDIRECTING_REASON_UNKNOWN</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l01639">ast_strip_quoted()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00511">ast_party_redirecting_reason::code</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00326">set_redirecting_reason_by_cause()</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00264">set_redirecting_value()</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00508">ast_party_redirecting_reason::str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00386">set_redirecting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t reason_name = { <span class="stringliteral">&quot;reason&quot;</span>, 6 };</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   pjsip_param *reason = pjsip_param_find(&amp;from_info-&gt;other_param, &amp;reason_name);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <span class="keywordtype">char</span> *reason_str;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keywordflow">if</span> (!reason) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (to_info) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#a691a2393388e10276ec271c2afca87ca">set_redirecting_reason_by_cause</a>(to_info, data);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a>(&amp;data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, &amp;reason-&gt;value);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">if</span> (!data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="comment">/* Oops, allocation failure */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   reason_str = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="comment">/* Remove any enclosing double-quotes */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">if</span> (*reason_str == <span class="charliteral">&#39;&quot;&#39;</span>) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      reason_str = <a class="code" href="../../d6/d90/strings_8h.html#aeb597bdc9a1209c2e7dd8af04de43485">ast_strip_quoted</a>(reason_str, <span class="stringliteral">&quot;\&quot;&quot;</span>, <span class="stringliteral">&quot;\&quot;&quot;</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> = <a class="code" href="../../de/d47/callerid_8h.html#acb5eeae1a2076a16e7727368d0d95e17">ast_redirecting_reason_parse</a>(reason_str);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> &lt; 0) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> = <a class="code" href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div><div class="ttc" id="callerid_8h_html_a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a84c18283fee396ec5947fc497dd39169a1cf63751ca0805657b57f0ca36069f41">AST_REDIRECTING_REASON_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00391">callerid.h:391</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_a691a2393388e10276ec271c2afca87ca"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#a691a2393388e10276ec271c2afca87ca">set_redirecting_reason_by_cause</a></div><div class="ttdeci">static void set_redirecting_reason_by_cause(pjsip_name_addr *name_addr, struct ast_party_redirecting_reason *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00326">res_pjsip_diversion.c:326</a></div></div>
<div class="ttc" id="callerid_8h_html_acb5eeae1a2076a16e7727368d0d95e17"><div class="ttname"><a href="../../de/d47/callerid_8h.html#acb5eeae1a2076a16e7727368d0d95e17">ast_redirecting_reason_parse</a></div><div class="ttdeci">int ast_redirecting_reason_parse(const char *data)</div><div class="ttdoc">Convert redirecting reason text code to value (used in config file parsing) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01223">callerid.c:1223</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">ast_party_redirecting_reason::code</a></div><div class="ttdeci">int code</div><div class="ttdoc">enum AST_REDIRECTING_REASON value for redirection </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00511">channel.h:511</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_ac0e8504b3e389a561cd0d2c55409dc80"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#ac0e8504b3e389a561cd0d2c55409dc80">set_redirecting_value</a></div><div class="ttdeci">static void set_redirecting_value(char **dst, const pj_str_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00264">res_pjsip_diversion.c:264</a></div></div>
<div class="ttc" id="strings_8h_html_aeb597bdc9a1209c2e7dd8af04de43485"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aeb597bdc9a1209c2e7dd8af04de43485">ast_strip_quoted</a></div><div class="ttdeci">char * ast_strip_quoted(char *s, const char *beg_quotes, const char *end_quotes)</div><div class="ttdoc">Strip leading/trailing whitespace and quotes from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01639">main/utils.c:1639</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_redirecting_reason::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">a string value for the redirecting reason </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00508">channel.h:508</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a691a2393388e10276ec271c2afca87ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691a2393388e10276ec271c2afca87ca">&#9670;&nbsp;</a></span>set_redirecting_reason_by_cause()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_redirecting_reason_by_cause </td>
          <td>(</td>
          <td class="paramtype">pjsip_name_addr *&#160;</td>
          <td class="paramname"><em>name_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/dee/structast__party__redirecting__reason.html">ast_party_redirecting_reason</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00326">326</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00085">reasons::cause</a>, <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00102">cause_to_reason()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00511">ast_party_redirecting_reason::code</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00508">ast_party_redirecting_reason::str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00351">set_redirecting_reason()</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t cause_name = { <span class="stringliteral">&quot;cause&quot;</span>, 5 };</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   pjsip_sip_uri *uri = pjsip_uri_get_uri(name_addr);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   pjsip_param *cause = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cause_value = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(uri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(uri)) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   cause = pjsip_param_find(&amp;uri-&gt;other_param, &amp;cause_name);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="keywordflow">if</span> (!cause) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   cause_value = pj_strtoul(&amp;cause-&gt;value);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> = <a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#adcf076e5a872adbe3baa9ac4a0437a3e">cause_to_reason</a>(cause_value);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   data-&gt;<a class="code" href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div><div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#a45a5b7c00a796a23f01673cef1dbe0a9">ast_party_redirecting_reason::code</a></div><div class="ttdeci">int code</div><div class="ttdoc">enum AST_REDIRECTING_REASON value for redirection </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00511">channel.h:511</a></div></div>
<div class="ttc" id="structast__party__redirecting__reason_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d1/dee/structast__party__redirecting__reason.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_redirecting_reason::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">a string value for the redirecting reason </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00508">channel.h:508</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_adcf076e5a872adbe3baa9ac4a0437a3e"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#adcf076e5a872adbe3baa9ac4a0437a3e">cause_to_reason</a></div><div class="ttdeci">static enum AST_REDIRECTING_REASON cause_to_reason(const unsigned long cause)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00102">res_pjsip_diversion.c:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e8504b3e389a561cd0d2c55409dc80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e8504b3e389a561cd0d2c55409dc80">&#9670;&nbsp;</a></span>set_redirecting_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_redirecting_value </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pj_str_t *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00264">264</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, and <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00273">set_redirecting_id()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00351">set_redirecting_reason()</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(*dst);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   *dst = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(pj_strlen(src) + 1);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordflow">if</span> (*dst) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(*dst, src, pj_strlen(src) + 1);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9449cc9b3bc7c2081ba96b5ff27d994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9449cc9b3bc7c2081ba96b5ff27d994">&#9670;&nbsp;</a></span>sip_is_token()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_is_token </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00053">53</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">add_diversion_header()</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordtype">int</span> is_token;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">/* An empty string is not a token. */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   is_token = 1;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> (!isalnum(*<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         &amp;&amp; !strchr(<span class="stringliteral">&quot;-.!%*_+`&#39;~&quot;</span>, *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         <span class="comment">/* The character is not allowed in a token. */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         is_token = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   } <span class="keywordflow">while</span> (*++<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="keywordflow">return</span> is_token;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div><div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00718">718</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00328">AST_MODPRI_APP_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00063">ast_sip_session_unregister_supplement()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00709">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#aae89632996ffdcf888ab251c14dc6cdb">ast_sip_session_unregister_supplement</a>(&amp;<a class="code" href="../../d5/da9/res__pjsip__diversion_8c.html#af87a810bed4f2c35cf45c6bbf14cf85d">diversion_supplement</a>);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8h_html_aae89632996ffdcf888ab251c14dc6cdb"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#aae89632996ffdcf888ab251c14dc6cdb">ast_sip_session_unregister_supplement</a></div><div class="ttdeci">void ast_sip_session_unregister_supplement(struct ast_sip_session_supplement *supplement)</div><div class="ttdoc">Unregister a an supplement to SIP session processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00063">pjsip_session.c:63</a></div></div>
<div class="ttc" id="res__pjsip__diversion_8c_html_af87a810bed4f2c35cf45c6bbf14cf85d"><div class="ttname"><a href="../../d5/da9/res__pjsip__diversion_8c.html#af87a810bed4f2c35cf45c6bbf14cf85d">diversion_supplement</a></div><div class="ttdeci">static struct ast_sip_session_supplement diversion_supplement</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00697">res_pjsip_diversion.c:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Add Diversion Header Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip,res_pjsip_session&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00730">730</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00730">730</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="aa0c59eb2bd73a177525a003f3bb21430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c59eb2bd73a177525a003f3bb21430">&#9670;&nbsp;</a></span>diversion_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const pj_str_t diversion_name = { &quot;Diversion&quot;, 9 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00038">38</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00504">add_diversion_header()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00190">get_diversion_header()</a>.</p>

</div>
</div>
<a id="af87a810bed4f2c35cf45c6bbf14cf85d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af87a810bed4f2c35cf45c6bbf14cf85d">&#9670;&nbsp;</a></span>diversion_supplement</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> diversion_supplement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00697">697</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

</div>
</div>
<a id="a8d59bf50709fd4ae0a53b7343462e2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d59bf50709fd4ae0a53b7343462e2d7">&#9670;&nbsp;</a></span>HISTINFO_SUPPORTED_NAME</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pj_str_t HISTINFO_SUPPORTED_NAME = { &quot;histinfo&quot;, 8 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00040">40</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00120">add_supported()</a>.</p>

</div>
</div>
<a id="a6a836e53554b09224d39d1d4068bc97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a836e53554b09224d39d1d4068bc97d">&#9670;&nbsp;</a></span>history_info_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const pj_str_t history_info_name = { &quot;History-Info&quot;, 12 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00039">39</a> of file <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html">res_pjsip_diversion.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00572">add_history_info_header()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00215">get_history_info_header()</a>.</p>

</div>
</div>
<a id="a261ead104dbe5a21fdcbae5d8f5328b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a261ead104dbe5a21fdcbae5d8f5328b5">&#9670;&nbsp;</a></span>reason_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../df/d30/structreasons.html">reasons</a>  reason_table[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00175">reason_code_to_cause()</a>, and <a class="el" href="../../d5/da9/res__pjsip__diversion_8c_source.html#l00155">reason_code_to_str()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:30 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
