<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_outbound_registration.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">res_pjsip_outbound_registration.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d96/res__pjsip__outbound__registration_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 2013, Digium, Inc.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Joshua Colp &lt;jcolp@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   &lt;depend&gt;pjproject&lt;/depend&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">   &lt;depend&gt;res_pjsip&lt;/depend&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">   &lt;use type=&quot;module&quot;&gt;res_statsd&lt;/use&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">   &lt;support_level&gt;core&lt;/support_level&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;pjsip.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;pjsip_ua.h&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d8c/res__pjsip_8h.html">asterisk/res_pjsip.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d9f/res__pjsip__cli_8h.html">asterisk/res_pjsip_cli.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d1e/taskprocessor_8h.html">asterisk/taskprocessor.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/df0/stasis__system_8h.html">asterisk/stasis_system.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d7d/threadstorage_8h.html">asterisk/threadstorage.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d40/threadpool_8h.html">asterisk/threadpool.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d67/statsd_8h.html">asterisk/statsd.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d5c/res__pjsip__private_8h.html">res_pjsip/include/res_pjsip_private.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d68/vector_8h.html">asterisk/vector.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/*** DOCUMENTATION</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   &lt;configInfo name=&quot;res_pjsip_outbound_registration&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">      &lt;synopsis&gt;SIP resource for outbound registrations&lt;/synopsis&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">      &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">         &lt;emphasis&gt;Outbound Registration&lt;/emphasis&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">         &lt;/para&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">         &lt;para&gt;This module allows &lt;literal&gt;res_pjsip&lt;/literal&gt; to register to other SIP servers.&lt;/para&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">      &lt;configFile name=&quot;pjsip.conf&quot;&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">         &lt;configObject name=&quot;registration&quot;&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">            &lt;synopsis&gt;The configuration for outbound registration&lt;/synopsis&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">            &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">               Registration is &lt;emphasis&gt;COMPLETELY&lt;/emphasis&gt; separate from the rest of</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">               &lt;literal&gt;pjsip.conf&lt;/literal&gt;. A minimal configuration consists of</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">               setting a &lt;literal&gt;server_uri&lt;/literal&gt;   and a &lt;literal&gt;client_uri&lt;/literal&gt;.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">            &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">            &lt;configOption name=&quot;auth_rejection_permanent&quot; default=&quot;yes&quot;&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">               &lt;synopsis&gt;Determines whether failed authentication challenges are treated</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">               as permanent failures.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;If this option is enabled and an authentication challenge fails,</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">               registration will not be attempted again until the configuration is reloaded.&lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">            &lt;configOption name=&quot;client_uri&quot;&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">               &lt;synopsis&gt;Client SIP URI used when attemping outbound registration&lt;/synopsis&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">                  This is the address-of-record for the outbound registration (i.e. the URI in</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">                  the To header of the REGISTER).&lt;/para&gt;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">                  &lt;para&gt;For registration with an ITSP, the client SIP URI may need to consist of</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">                  an account name or number and the provider&#39;s hostname for their registrar, e.g.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">                  client_uri=1234567890@example.com. This may differ between providers.&lt;/para&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">                  &lt;para&gt;For registration to generic registrars, the client SIP URI will depend</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">                  on networking specifics and configuration of the registrar.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">            &lt;configOption name=&quot;contact_user&quot;&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">               &lt;synopsis&gt;Contact User to use in request&lt;/synopsis&gt;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">            &lt;configOption name=&quot;contact_header_params&quot;&gt;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">               &lt;synopsis&gt;Header parameters to place in the Contact header&lt;/synopsis&gt;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">            &lt;configOption name=&quot;expiration&quot; default=&quot;3600&quot;&gt;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">               &lt;synopsis&gt;Expiration time for registrations in seconds&lt;/synopsis&gt;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">            &lt;configOption name=&quot;max_retries&quot; default=&quot;10&quot;&gt;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">               &lt;synopsis&gt;Maximum number of registration attempts.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">                  This sets the maximum number of registration attempts that are made before</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">                  stopping any further attempts. If set to 0 then upon failure no further attempts</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">                  are made.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">            &lt;configOption name=&quot;outbound_auth&quot; default=&quot;&quot;&gt;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">               &lt;synopsis&gt;Authentication object(s) to be used for outbound registrations.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">                  This is a comma-delimited list of &lt;replaceable&gt;auth&lt;/replaceable&gt;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">                  sections defined in &lt;filename&gt;pjsip.conf&lt;/filename&gt; used to respond</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">                  to outbound authentication challenges.&lt;/para&gt;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">                  Using the same auth section for inbound and outbound</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">                  authentication is not recommended.  There is a difference in</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">                  meaning for an empty realm setting between inbound and outbound</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">                  authentication uses.  See the auth realm description for details.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">                  &lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">            &lt;configOption name=&quot;outbound_proxy&quot; default=&quot;&quot;&gt;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">               &lt;synopsis&gt;Full SIP URI of the outbound proxy used to send registrations&lt;/synopsis&gt;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">            &lt;configOption name=&quot;retry_interval&quot; default=&quot;60&quot;&gt;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">               &lt;synopsis&gt;Interval in seconds between retries if outbound registration is unsuccessful&lt;/synopsis&gt;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">            &lt;configOption name=&quot;forbidden_retry_interval&quot; default=&quot;0&quot;&gt;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">               &lt;synopsis&gt;Interval used when receiving a 403 Forbidden response.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">                  If a 403 Forbidden is received, chan_pjsip will wait</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">                  &lt;replaceable&gt;forbidden_retry_interval&lt;/replaceable&gt; seconds before</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">                  attempting registration again. If 0 is specified, chan_pjsip will not</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">                  retry after receiving a 403 Forbidden response. Setting this to a non-zero</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">                  value goes against a &quot;SHOULD NOT&quot; in RFC3261, but can be used to work around</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">                  buggy registrars.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">            &lt;configOption name=&quot;fatal_retry_interval&quot; default=&quot;0&quot;&gt;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">               &lt;synopsis&gt;Interval used when receiving a Fatal response.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">                  If a fatal response is received, chan_pjsip will wait</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">                  &lt;replaceable&gt;fatal_retry_interval&lt;/replaceable&gt; seconds before</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                  attempting registration again. If 0 is specified, chan_pjsip will not</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">                  retry after receiving a fatal (non-temporary 4xx, 5xx, 6xx) response.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">                  Setting this to a non-zero value may go against a &quot;SHOULD NOT&quot; in RFC3261,</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">                  but can be used to work around buggy registrars.&lt;/para&gt;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;if also set the &lt;replaceable&gt;forbidden_retry_interval&lt;/replaceable&gt;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">                  takes precedence over this one when a 403 is received.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">                  Also, if &lt;replaceable&gt;auth_rejection_permanent&lt;/replaceable&gt; equals &#39;yes&#39; then</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">                  a 401 and 407 become subject to this retry interval.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">            &lt;configOption name=&quot;server_uri&quot;&gt;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">               &lt;synopsis&gt;SIP URI of the server to register against&lt;/synopsis&gt;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">                  This is the URI at which to find the registrar to send the outbound REGISTER. This URI</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">                  is used as the request URI of the outbound REGISTER request from Asterisk.&lt;/para&gt;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">                  &lt;para&gt;For registration with an ITSP, the setting may often be just the domain of</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">                  the registrar, e.g. sip:sip.example.com.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">            &lt;configOption name=&quot;transport&quot;&gt;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">               &lt;synopsis&gt;Transport used for outbound authentication&lt;/synopsis&gt;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;A &lt;replaceable&gt;transport&lt;/replaceable&gt; configured in</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">                  &lt;literal&gt;pjsip.conf&lt;/literal&gt;. As with other &lt;literal&gt;res_pjsip&lt;/literal&gt; modules, this will use the first available transport of the appropriate type if unconfigured.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">            &lt;configOption name=&quot;line&quot;&gt;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">               &lt;synopsis&gt;Whether to add a &#39;line&#39; parameter to the Contact for inbound call matching&lt;/synopsis&gt;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">                  When enabled this option will cause a &#39;line&#39; parameter to be added to the Contact</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">                  header placed into the outgoing registration request. If the remote server sends a call</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">                  this line parameter will be used to establish a relationship to the outbound registration,</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">                  ultimately causing the configured endpoint to be used.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">            &lt;configOption name=&quot;endpoint&quot;&gt;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">               &lt;synopsis&gt;Endpoint to use for incoming related calls&lt;/synopsis&gt;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">                  When line support is enabled this configured endpoint name is used for incoming calls</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">                  that are related to the outbound registration.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">            &lt;configOption name=&quot;type&quot;&gt;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">               &lt;synopsis&gt;Must be of type &#39;registration&#39;.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">            &lt;configOption name=&quot;support_path&quot;&gt;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">               &lt;synopsis&gt;Enables advertising SIP Path support for outbound REGISTER requests.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">               &lt;description&gt;&lt;para&gt;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">                  When this option is enabled, outbound REGISTER requests will advertise</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">                  support for Path headers so that intervening proxies can add to the Path</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">                  header as necessary.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">               &lt;/para&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">            &lt;configOption name=&quot;support_outbound&quot;&gt;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">               &lt;synopsis&gt;Enables advertising SIP Outbound support (RFC5626) for outbound REGISTER requests.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">         &lt;/configObject&gt;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">      &lt;/configFile&gt;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">   &lt;/configInfo&gt;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">   &lt;manager name=&quot;PJSIPUnregister&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">         Unregister an outbound registration.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">         &lt;parameter name=&quot;Registration&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">            &lt;para&gt;The outbound registration to unregister or &#39;*all&#39; to unregister them all.&lt;/para&gt;</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">         &lt;para&gt;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">         Unregisters the specified (or all) outbound registration(s) and stops future registration attempts.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">         Call PJSIPRegister to start registration and schedule re-registrations according to configuration.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">            &lt;/para&gt;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">   &lt;manager name=&quot;PJSIPRegister&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">         Register an outbound registration.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">         &lt;parameter name=&quot;Registration&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">            &lt;para&gt;The outbound registration to register or &#39;*all&#39; to register them all.&lt;/para&gt;</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">         &lt;para&gt;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">         Unregisters the specified (or all) outbound registration(s) then starts registration and schedules re-registrations</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">         according to configuration.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">            &lt;/para&gt;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">   &lt;manager name=&quot;PJSIPShowRegistrationsOutbound&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">         Lists PJSIP outbound registrations.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">      &lt;syntax /&gt;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">         &lt;para&gt;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">         In response &lt;literal&gt;OutboundRegistrationDetail&lt;/literal&gt; events showing configuration and status</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">         information are raised for each outbound registration object. &lt;literal&gt;AuthDetail&lt;/literal&gt;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">         events are raised for each associated auth object as well.  Once all events are completed an</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">         &lt;literal&gt;OutboundRegistrationDetailComplete&lt;/literal&gt; is issued.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">                        &lt;/para&gt;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/* forward declarations */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1a9a9a97cbae2fdf1c2890fe9adbc92">set_outbound_initial_authentication_credentials</a>(pjsip_regc *regc,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/dca/structast__sip__auth__vector.html">ast_sip_auth_vector</a> *auth_vector);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/*! \brief Some thread local storage used to determine if the running thread invoked the callback */</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1ae1ce6947f3f39fd07bd4c26b1183d">  245</a></span>&#160;<a class="code" href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1ae1ce6947f3f39fd07bd4c26b1183d">register_callback_invoked</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">/*! \brief Amount of buffer time (in seconds) before expiration that we re-register at */</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1532fa6ad6ad7d60a568fc5b3594cd94">  248</a></span>&#160;<span class="preprocessor">#define REREGISTER_BUFFER_TIME 10</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">/*! \brief Size of the buffer for creating a unique string for the line */</span></div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1a9e55a3612e24973891ec2b87811f1d">  251</a></span>&#160;<span class="preprocessor">#define LINE_PARAMETER_SIZE 8</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">/*! \brief Various states that an outbound registration may be in */</span></div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">  254</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">sip_outbound_registration_status</a> {<span class="comment"></span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">   /*! \brief Currently unregistered */</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">  256</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">   /*! \brief Registered, yay! */</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">  258</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>,<span class="comment"></span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">   /*! \brief Registration was rejected, but response was temporal */</span></div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">  260</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>,<span class="comment"></span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">   /*! \brief Registration was rejected, permanently */</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">  262</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>,<span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">   /*! \brief Registration is stopping. */</span></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">  264</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">SIP_REGISTRATION_STOPPING</a>,<span class="comment"></span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">   /*! \brief Registration has been stopped */</span></div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">  266</a></span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a>,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;};</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> * \brief Convert the internal registration state to an external status string.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> * \since 13.5.0</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> * \param state Current outbound registration state.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> * \return External registration status string.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">  278</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(<span class="keyword">enum</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">sip_outbound_registration_status</a> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   str = <span class="stringliteral">&quot;Unregistered&quot;</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <span class="keywordflow">switch</span> (state) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">SIP_REGISTRATION_STOPPING</a>:</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a>:</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a>:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>:</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      str = <span class="stringliteral">&quot;Registered&quot;</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>:</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>:</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      str = <span class="stringliteral">&quot;Rejected&quot;</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">/*! \brief Outbound registration information */</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html">  300</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> {<span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">   /*! \brief Sorcery object details */</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../df/df4/structsip__outbound__registration.html#a0e85270ccb77c71eb8f9693642c46daf">SORCERY_OBJECT</a>(details);<span class="comment"></span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">   /*! \brief Stringfields */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">      /*! \brief URI for the registrar */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>);<span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">      /*! \brief URI for the AOR */</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>);<span class="comment"></span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">      /*! \brief Optional user for contact header */</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#aff8e665e1528d0e12e446fcbd4d2efa6">contact_user</a>);<span class="comment"></span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">      /*! \bried Optional header parameters for contact */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#a7568cd99aeb0e7f2919a9c03f1a8d674">contact_header_params</a>);<span class="comment"></span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">      /*! \brief Explicit transport to use for registration */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">transport</a>);<span class="comment"></span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">      /*! \brief Outbound proxy to use */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>);<span class="comment"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">      /*! \brief Endpoint to use for related incoming calls */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../df/df4/structsip__outbound__registration.html#aa3522da32a7960126d5eb2ac0c1c6c36">endpoint</a>);</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">  319</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">   /*! \brief Requested expiration time */</span></div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">  321</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">expiration</a>;<span class="comment"></span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for temporal responses */</span></div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a98068831aa58db10990857613f081058">  323</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a98068831aa58db10990857613f081058">retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for permanent responses */</span></div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#ac18889d3debd7178ac69dba0fc3c2349">  325</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for all permanent responses */</span></div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#ac892ead8a4bfdf8a66380b1183eb17e9">  327</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">   /*! \brief Treat authentication challenges that we cannot handle as permanent failures */</span></div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a12221be4cf0c835b3d35678aa90f09aa">  329</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a>;<span class="comment"></span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">   /*! \brief Maximum number of retries permitted */</span></div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#ac471888e0087722725624aead073fda5">  331</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac471888e0087722725624aead073fda5">max_retries</a>;<span class="comment"></span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">   /*! \brief Whether to add a line parameter to the outbound Contact or not */</span></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">  333</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>;<span class="comment"></span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">   /*! \brief Configured authentication credentials */</span></div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">  335</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dca/structast__sip__auth__vector.html">ast_sip_auth_vector</a> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>;<span class="comment"></span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">   /*! \brief Whether Path support is enabled */</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a6e527f7843b00df547d2221a7d31ef60">  337</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a>;<span class="comment"></span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">   /*! \brief Whether Outbound support is enabled */</span></div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../df/df4/structsip__outbound__registration.html#a457b76cddd3ca295da0836c07efd33b3">  339</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;};</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/*! \brief Outbound registration client state information (persists for lifetime of regc) */</span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html">  343</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> {<span class="comment"></span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">   /*! \brief Current state of this registration */</span></div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">  345</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">sip_outbound_registration_status</a> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;<span class="comment"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">    * \brief Outbound registration client</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">    * \note May only be accessed within the serializer thread</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">    * because it might get destroyed and set to NULL for</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">    * module unload.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">  352</a></span>&#160;   pjsip_regc *<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>;<span class="comment"></span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">    * \brief Last tdata sent</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">    * We need the original tdata to resend a request on auth failure</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">    * or timeout.  On an auth failure, we use the original tdata</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    * to initialize the new tdata for the authorized response.  On a timeout</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">    * we need it to skip failed SRV entries if any.</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">  360</a></span>&#160;   pjsip_tx_data *<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>;<span class="comment"></span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">   /*! \brief Timer entry for retrying on temporal responses */</span></div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">  362</a></span>&#160;   pj_timer_entry <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">timer</a>;<span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">   /*! \brief Optional line parameter placed into Contact */</span></div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">  364</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>[<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1a9e55a3612e24973891ec2b87811f1d">LINE_PARAMETER_SIZE</a>];<span class="comment"></span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">   /*! \brief Current number of retries */</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">  366</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a>;<span class="comment"></span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">   /*! \brief Maximum number of retries permitted */</span></div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">  368</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">max_retries</a>;<span class="comment"></span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for temporal responses */</span></div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">  370</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for permanent responses */</span></div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">  372</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">   /*! \brief Interval at which retries should occur for all permanent responses */</span></div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">  374</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>;<span class="comment"></span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">   /*! \brief Treat authentication challenges that we cannot handle as permanent failures */</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a12221be4cf0c835b3d35678aa90f09aa">  376</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a>;<span class="comment"></span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">   /*! \brief Determines whether SIP Path support should be advertised */</span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6e527f7843b00df547d2221a7d31ef60">  378</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a>;<span class="comment"></span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">   /*! \brief Determines whether SIP Outbound support should be advertised */</span></div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a457b76cddd3ca295da0836c07efd33b3">  380</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a>;<span class="comment"></span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">   /*! CSeq number of last sent auth request. */</span></div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#abc867dcf2080fffd890e3ff80e40956a">  382</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#abc867dcf2080fffd890e3ff80e40956a">auth_cseq</a>;<span class="comment"></span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">   /*! \brief Serializer for stuff and things */</span></div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">  384</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">   /*! \brief Configured authentication credentials */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">  386</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dca/structast__sip__auth__vector.html">ast_sip_auth_vector</a> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>;<span class="comment"></span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">   /*! \brief Registration should be destroyed after completion of transaction */</span></div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">  388</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">destroy</a>:1;<span class="comment"></span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">   /*! \brief Non-zero if we have attempted sending a REGISTER with authentication */</span></div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">  390</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">auth_attempted</a>:1;<span class="comment"></span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">   /*! \brief The name of the transport to be used for the registration */</span></div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">  392</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>;<span class="comment"></span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">   /*! \brief The name of the registration sorcery object */</span></div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">  394</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;};</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">/*! \brief Outbound registration state information (persists for lifetime that registration should exist) */</span></div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="../../d3/d3f/structsip__outbound__registration__state.html">  398</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> {<span class="comment"></span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">   /*! \brief Outbound registration configuration object */</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">  400</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>;<span class="comment"></span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">   /*! \brief Client state information */</span></div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">  402</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;};</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/*! Time needs to be long enough for a transaction to timeout if nothing replies. */</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a536155006f9be75496538efe377145e6">  406</a></span>&#160;<span class="preprocessor">#define MAX_UNLOAD_TIMEOUT_TIME     35 </span><span class="comment">/* Seconds */</span><span class="preprocessor"></span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">/*! Shutdown group to monitor sip_outbound_registration_client_state serializers. */</span></div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c3d0057b62bfa5b08fe977478749c24">  409</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dc/d82/structast__serializer__shutdown__group.html">ast_serializer_shutdown_group</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">/*! \brief Default number of state container buckets */</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a46aa50c37f5c251756d5564d8c96aa38">  412</a></span>&#160;<span class="preprocessor">#define DEFAULT_STATE_BUCKETS 53</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a253e3df4e474d9f21b13bdb86880a4">AO2_GLOBAL_OBJ_STATIC</a>(current_states);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">/*! subscription id for network change events */</span></div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abe7962a7f3bb90f89e2cf66b6d390659">  416</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abe7962a7f3bb90f89e2cf66b6d390659">network_change_sub</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/*! \brief hashing function for state objects */</span></div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af33cd7eda831b14b7720db418206a013">  419</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af33cd7eda831b14b7720db418206a013">registration_state_hash</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *object;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *key;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      key = obj;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordtype">object</span> = obj;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      key = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(object-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(key);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/*! \brief comparator function for state objects */</span></div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a361792ceb797e0709c07318da3611bf4">  440</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a361792ceb797e0709c07318da3611bf4">registration_state_cmp</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *object_left = obj;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *object_right = arg;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = arg;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      right_key = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(object_right-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      cmp = strcmp(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(object_left-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>), right_key);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a>:</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">/* Not supported by container. */</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      cmp = 0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="keywordflow">if</span> (cmp) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">  468</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *states;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">if</span> (states) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      state = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(states, <span class="keywordtype">id</span>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(states, -1);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aba6cb640df8f32c52de5727b10051284">  481</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aba6cb640df8f32c52de5727b10051284">get_registrations</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../df/d9e/structregistrations.html">registrations</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dff/chan__iax2_8c.html#a0443ab92a32c0d55ac2bace5904fbb3e">registrations</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">/*! \brief Callback function for matching an outbound registration based on line */</span></div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad111cd1f90812e2a977fb2ac17f6725a">  491</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad111cd1f90812e2a977fb2ac17f6725a">line_identify_relationship</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   pjsip_param *<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a> = arg;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">return</span> !pj_strcmp2(&amp;line-&gt;value, state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">line</a>) ? <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> : 0;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7452bb47baa9a7b2d159cc4bda456f17">  499</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>pjsip_param *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7452bb47baa9a7b2d159cc4bda456f17">get_uri_option_line</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *uri)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   pjsip_sip_uri *pjuri;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t LINE_STR = { <span class="stringliteral">&quot;line&quot;</span>, 4 };</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(uri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(uri)) {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   pjuri = pjsip_uri_get_uri(uri);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="keywordflow">return</span> pjsip_param_find(&amp;pjuri-&gt;other_param, &amp;LINE_STR);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">/*! \brief Endpoint identifier which uses the &#39;line&#39; parameter to establish a relationship to an outgoing registration */</span></div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0f735a1c6c2ff0a2f29a96d6631a3e82">  512</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0f735a1c6c2ff0a2f29a96d6631a3e82">line_identify</a>(pjsip_rx_data *rdata)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   pjsip_param *<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, states, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *, <a class="code" href="../../d4/d88/structstate.html">state</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">if</span> (!(line = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7452bb47baa9a7b2d159cc4bda456f17">get_uri_option_line</a>(rdata-&gt;msg_info.to-&gt;uri))</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      &amp;&amp; !(line = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7452bb47baa9a7b2d159cc4bda456f17">get_uri_option_line</a>(rdata-&gt;msg_info.msg-&gt;line.req.uri))) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">if</span> (!states) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(states, 0, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad111cd1f90812e2a977fb2ac17f6725a">line_identify_relationship</a>, line);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d88/structstate.html">state</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration-&gt;endpoint)) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Determined relationship to outbound registration &#39;%s&#39; based on line &#39;%s&#39;, using configured endpoint &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration), <a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;client_state-&gt;line, <a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration-&gt;endpoint);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;endpoint&quot;</span>, <a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration-&gt;endpoint);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa00e847f05d7351e625c30d9cc71aa93">  539</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d97/structast__sip__endpoint__identifier.html">ast_sip_endpoint_identifier</a> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa00e847f05d7351e625c30d9cc71aa93">line_identifier</a> = {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   .<a class="code" href="../../d0/d97/structast__sip__endpoint__identifier.html#a70e9eb29aa44b8d1b8e2e158b97bb11c">identify_endpoint</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0f735a1c6c2ff0a2f29a96d6631a3e82">line_identify</a>,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;};</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">/*! \brief Helper function which cancels the timer on a client */</span></div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">  544</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="keywordflow">if</span> (pj_timer_heap_cancel_if_active(pjsip_endpt_get_timer_heap(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>()),</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      &amp;client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">timer</a>, client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">timer</a>.id)) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="comment">/* The timer was successfully cancelled, drop the refcount of client_state */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5daffcecdec4b287e88ce65d8d768487">  553</a></span>&#160;<span class="keyword">static</span> pj_str_t <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5daffcecdec4b287e88ce65d8d768487">PATH_NAME</a> = { <span class="stringliteral">&quot;path&quot;</span>, 4 };</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abd6ac29370652d224cd0e2f60be2ea28">  554</a></span>&#160;<span class="keyword">static</span> pj_str_t <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abd6ac29370652d224cd0e2f60be2ea28">OUTBOUND_NAME</a> = { <span class="stringliteral">&quot;outbound&quot;</span>, 8 };</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">/*! \brief Helper function which sends a message and cleans up, if needed, on failure */</span></div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">  557</a></span>&#160;<span class="keyword">static</span> pj_status_t <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   pjsip_tx_data *tdata)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   pj_status_t <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <span class="keywordtype">int</span> *callback_invoked;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   pjsip_tpselector selector = { .type = PJSIP_TPSELECTOR_NONE, };</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   callback_invoked = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1ae1ce6947f3f39fd07bd4c26b1183d">register_callback_invoked</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="keywordflow">if</span> (!callback_invoked) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">return</span> PJ_ENOMEM;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   *callback_invoked = 0;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="comment">/* Due to the message going out the callback may now be invoked, so bump the count */</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, +1);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">    * We also bump tdata in expectation of saving it to client_state-&gt;last_tdata.</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">    * We have to do it BEFORE pjsip_regc_send because if it succeeds, it decrements</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">    * the ref count on its own.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   pjsip_tx_data_add_ref(tdata);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">    * Set the transport in case transports were reloaded.</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">    * When pjproject removes the extraneous error messages produced,</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    * we can check status and only set the transport and resend if there was an error</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac94b7c59f69d31b962e42098955f8fa4">ast_sip_set_tpselector_from_transport_name</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>, &amp;selector);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   pjsip_regc_set_transport(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;selector);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9e1ef995698ba16cad6608225b8de946">ast_sip_tpselector_unref</a>(&amp;selector);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   status = pjsip_regc_send(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, tdata);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">    * If the attempt to send the message failed and the callback was not invoked we need to</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">    * drop the references we just added</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">if</span> ((status != PJ_SUCCESS) &amp;&amp; !(*callback_invoked)) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">    * Decref the old last_data before replacing it.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">    * BTW, it&#39;s quite possible that last_data == tdata</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">    * if we&#39;re trying successive servers in an SRV set.</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      pjsip_tx_data_dec_ref(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a> = tdata;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">/*! \brief Helper function to add string to Supported header */</span></div><div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7fc92b8eea9b7e19e20024cb8119ccfb">  615</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7fc92b8eea9b7e19e20024cb8119ccfb">add_to_supported_header</a>(pjsip_tx_data *tdata, pj_str_t *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   pjsip_supported_hdr *hdr;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   hdr = pjsip_msg_find_hdr(tdata-&gt;msg, PJSIP_H_SUPPORTED, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keywordflow">if</span> (!hdr) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="comment">/* insert a new Supported header */</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      hdr = pjsip_supported_hdr_create(tdata-&gt;pool);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (!hdr) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;         pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      pjsip_msg_add_hdr(tdata-&gt;msg, (pjsip_hdr *)hdr);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="comment">/* Don&#39;t add the value if it&#39;s already there */</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; hdr-&gt;count; ++i) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">if</span> (pj_stricmp(&amp;hdr-&gt;values[i], name) == 0) {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keywordflow">if</span> (hdr-&gt;count &gt;= PJSIP_GENERIC_ARRAY_MAX_COUNT) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="comment">/* add on to the existing Supported header */</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   pj_strassign(&amp;hdr-&gt;values[hdr-&gt;count++], name);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">/*! \brief Helper function to add configured supported headers */</span></div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">  650</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">add_configured_supported_headers</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state, pjsip_tx_data *tdata)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a>) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7fc92b8eea9b7e19e20024cb8119ccfb">add_to_supported_header</a>(tdata, &amp;<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5daffcecdec4b287e88ce65d8d768487">PATH_NAME</a>)) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a>) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7fc92b8eea9b7e19e20024cb8119ccfb">add_to_supported_header</a>(tdata, &amp;<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abd6ac29370652d224cd0e2f60be2ea28">OUTBOUND_NAME</a>)) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">/*! \brief Callback function for registering */</span></div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a45542c0cd8e3d61c4d0c639074395abc">  668</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a45542c0cd8e3d61c4d0c639074395abc">handle_client_registration</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;{</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *, client_state, data, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1a9a9a97cbae2fdf1c2890fe9adbc92">set_outbound_initial_authentication_credentials</a>(client_state-&gt;client, &amp;client_state-&gt;outbound_auths)) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set initial authentication credentials\n&quot;</span>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;status == <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      || pjsip_regc_register(client_state-&gt;client, PJ_FALSE, &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(1)) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      pjsip_regc_get_info(client_state-&gt;client, &amp;info);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Outbound REGISTER attempt %u to &#39;%.*s&#39; with client &#39;%.*s&#39;\n&quot;</span>,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;         client_state-&gt;retries + 1,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;         (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;         (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">add_configured_supported_headers</a>(client_state, tdata)) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set supported headers\n&quot;</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(client_state, tdata);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;}</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/*! \brief Timer callback function, used just for registrations */</span></div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a55c93ab3532991aa5db9440b6ee2b3">  703</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a55c93ab3532991aa5db9440b6ee2b3">sip_outbound_registration_timer_cb</a>(pj_timer_heap_t *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#ae9f993fcad1fd49cb50f4a541101ccb7">timer_heap</a>, <span class="keyword">struct</span> pj_timer_entry *<a class="code" href="../../d3/d96/structentry.html">entry</a>)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;{</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state = entry-&gt;user_data;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   entry-&gt;id = 0;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">    * Transfer client_state reference to serializer task so the</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">    * nominal path will not dec the client_state ref in this</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">    * pjproject callback thread.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a45542c0cd8e3d61c4d0c639074395abc">handle_client_registration</a>, client_state)) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Scheduled outbound registration could not be executed.\n&quot;</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">/*! \brief Helper function which sets up the timer to re-register in a specific amount of time */</span></div><div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">  721</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seconds)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   pj_time_val delay = { .sec = seconds, };</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a>(client_state);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   pjsip_regc_get_info(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;info);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Scheduling outbound registration to server &#39;%.*s&#39; from client &#39;%.*s&#39; in %d seconds\n&quot;</span>,</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;         (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         seconds);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, +1);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <span class="keywordflow">if</span> (pjsip_endpt_schedule_timer(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), &amp;client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">timer</a>, &amp;delay) != PJ_SUCCESS) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to schedule registration to server &#39;%.*s&#39; from client &#39;%.*s&#39;\n&quot;</span>,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">  743</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state, <span class="keyword">enum</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">sip_outbound_registration_status</a> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;{</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *status_old;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *status_new;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> == status) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">/* Status state did not change at all. */</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   status_old = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   status_new = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(status);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keywordflow">if</span> (!strcmp(status_old, status_new)) {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">       * The internal status state may have changed but the status</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">       * state we tell the world did not change at all.</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a2d6d16d49502503505c1b5748be47c83">ast_statsd_log_string_va</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.%s&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;-1&quot;</span>, 1.0,</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      status_old);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a2d6d16d49502503505c1b5748be47c83">ast_statsd_log_string_va</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.%s&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;+1&quot;</span>, 1.0,</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      status_new);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;}</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">/*! \brief Callback function for unregistering (potentially) and destroying state */</span></div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8380e4bb4249f1a7d4bef09985bf73b5">  772</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8380e4bb4249f1a7d4bef09985bf73b5">handle_client_state_destruction</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state = data;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a>(client_state);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      pjsip_tx_data *tdata;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      pjsip_regc_get_info(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;info);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">if</span> (info.is_busy == PJ_TRUE) {</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         <span class="comment">/* If a client transaction is in progress we defer until it is complete */</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="stringliteral">&quot;Registration transaction is busy with server &#39;%.*s&#39; from client &#39;%.*s&#39;.\n&quot;</span>,</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">destroy</a> = 1;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">switch</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a>:</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>:</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="stringliteral">&quot;Trying to unregister with server &#39;%.*s&#39; from client &#39;%.*s&#39; before destruction.\n&quot;</span>,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(client_state, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">SIP_REGISTRATION_STOPPING</a>);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">destroy</a> = 1;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;         <span class="keywordflow">if</span> (pjsip_regc_unregister(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            &amp;&amp; <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">add_configured_supported_headers</a>(client_state, tdata)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            &amp;&amp; <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(client_state, tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>:</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>:</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">SIP_REGISTRATION_STOPPING</a>:</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a>:</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      pjsip_regc_destroy(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(client_state, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a>);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac5342f99fec726a94fb4b713e43eec12">ast_sip_auth_vector_destroy</a>(&amp;client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;}</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">/*! \brief Structure for registration response */</span></div><div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html">  832</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> {<span class="comment"></span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">   /*! \brief Response code for the registration attempt */</span></div><div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">  834</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>;<span class="comment"></span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">   /*! \brief Expiration time for registration */</span></div><div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">  836</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">expiration</a>;<span class="comment"></span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">   /*! \brief Retry-After value */</span></div><div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">  838</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">retry_after</a>;<span class="comment"></span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">   /*! \brief Outbound registration client state */</span></div><div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">  840</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>;<span class="comment"></span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">   /*! \brief The response message */</span></div><div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">  842</a></span>&#160;   pjsip_rx_data *<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>;<span class="comment"></span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">   /*! \brief Request for which the response was received */</span></div><div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">  844</a></span>&#160;   pjsip_tx_data *<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;};</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">/*! \brief Registration response structure destructor */</span></div><div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a74db2eb050f68d18300d0584b9a2a671">  848</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a74db2eb050f68d18300d0584b9a2a671">registration_response_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;{</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> *response = obj;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      pjsip_rx_data_free_cloned(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      pjsip_tx_data_dec_ref(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">/*! \brief Helper function which determines if a response code is temporal or not */</span></div><div class="line"><a name="l00864"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a82533315c5406ca144bac2824078a514">  864</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a82533315c5406ca144bac2824078a514">sip_outbound_registration_is_temporal</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>)</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;{</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <span class="comment">/* Shamelessly taken from pjsua */</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   <span class="keywordflow">if</span> (code == PJSIP_SC_REQUEST_TIMEOUT ||</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      code == PJSIP_SC_INTERNAL_SERVER_ERROR ||</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      code == PJSIP_SC_BAD_GATEWAY ||</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      code == PJSIP_SC_SERVICE_UNAVAILABLE ||</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      code == PJSIP_SC_SERVER_TIMEOUT ||</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      ((code == PJSIP_SC_UNAUTHORIZED ||</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        code == PJSIP_SC_PROXY_AUTHENTICATION_REQUIRED) &amp;&amp;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;       !client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a>) ||</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      PJSIP_IS_STATUS_IN_CLASS(code, 600)) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4d2100faf8e050dc5c26cd54d487452">  883</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4d2100faf8e050dc5c26cd54d487452">schedule_retry</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> *response, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> interval,</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;{</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, interval);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>) {</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Temporal response &#39;%d&#39; received from &#39;%s&#39; on &quot;</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;         <span class="stringliteral">&quot;registration attempt to &#39;%s&#39;, retrying in &#39;%u&#39;\n&quot;</span>,</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, server_uri, client_uri, interval);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No response received from &#39;%s&#39; on &quot;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;         <span class="stringliteral">&quot;registration attempt to &#39;%s&#39;, retrying in &#39;%u&#39;\n&quot;</span>,</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;         server_uri, client_uri, interval);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7d094e30468f05a60d455bd804f7c941">  900</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7d094e30468f05a60d455bd804f7c941">reregister_immediately_cb</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;{</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordflow">if</span> (state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> != <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(1)) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      pjsip_regc_get_info(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;info);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;         <span class="stringliteral">&quot;Outbound registration transport to server &#39;%.*s&#39; from client &#39;%.*s&#39; shutdown\n&quot;</span>,</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;         (<span class="keywordtype">int</span>) info.server_uri.slen, info.server_uri.ptr,</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         (<span class="keywordtype">int</span>) info.client_uri.slen, info.client_uri.ptr);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, +1);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a45542c0cd8e3d61c4d0c639074395abc">handle_client_registration</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment"> * \brief The reliable transport we registered using has shutdown.</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"> * \since 13.18.0</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"> * \param obj What is needed to initiate a reregister attempt.</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"> * \note Normally executed by the pjsip monitor thread.</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00939"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">  939</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">registration_transport_shutdown_cb</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;{</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name = obj;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_name);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="comment">/* Registration no longer exists or shutting down. */</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7d094e30468f05a60d455bd804f7c941">reregister_immediately_cb</a>, state)) {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af5c116e487d0241d5b723858e5e40ef4">  954</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af5c116e487d0241d5b723858e5e40ef4">monitor_matcher</a>(<span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;{</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordtype">char</span> *ma = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="keywordtype">char</span> *mb = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   <span class="keywordflow">return</span> strcmp(ma, mb) == 0;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;}</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8eedbfa3d0832f502e16d1fb2b26ee02">  962</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8eedbfa3d0832f502e16d1fb2b26ee02">registration_transport_monitor_setup</a>(pjsip_transport *<a class="code" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">transport</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/dde/chan__phone_8c.html#a4e40373706bcf5cdb9409dac3166d280">monitor</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_TRANSPORT_IS_RELIABLE(transport)) {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   monitor = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(strlen(registration_name) + 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <span class="keywordflow">if</span> (!monitor) {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   strcpy(monitor, registration_name);<span class="comment">/* Safe */</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">    * We&#39;ll ignore if the transport has already been shutdown before we</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">    * register the monitor.  We might get into a message spamming infinite</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">    * loop of registration, shutdown, reregistration...</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aaee14820d45bd0be318822580b5a8b59">ast_sip_transport_monitor_register</a>(transport, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">registration_transport_shutdown_cb</a>,</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      monitor);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(monitor, -1);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a110fd2cc81e44ec29e95e193adafea46">  986</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a110fd2cc81e44ec29e95e193adafea46">save_response_fields_to_transport</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> *response)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;{</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t associated_uri_str = { <span class="stringliteral">&quot;P-Associated-URI&quot;</span>, 16 };</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t service_route_str = { <span class="stringliteral">&quot;Service-Route&quot;</span>, 13 };</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   pjsip_hdr *<a class="code" href="../../d5/d65/structheader.html">header</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   pjsip_msg *msg = response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   <span class="keyword">struct </span>ast_sip_service_route_vector *service_routes = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <span class="comment">/* If no transport is specified then we can&#39;t update any */</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>)) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   }</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a1b1690d1107c614d4eb2853d96c55062">ast_sip_transport_state_set_transport</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="keywordflow">while</span> ((header = pjsip_msg_find_hdr_by_name(msg, &amp;service_route_str, header ? header-&gt;next : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordtype">char</span> *service_route;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordtype">size_t</span> size;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="comment">/* The below code takes the approach that if we can&#39;t store all service routes then we</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">       * store none at all. This gives a predictable failure condition instead of storing a</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">       * partial list and having partial route headers.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      size = pj_strlen(&amp;((pjsip_generic_string_hdr*)header)-&gt;hvalue) + 1;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      service_route = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(size);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">if</span> (!service_route) {</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;         <span class="keywordflow">if</span> (service_routes) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a790e1a3ec85fd649e267eee830b565c4">ast_sip_service_route_vector_destroy</a>(service_routes);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            service_routes = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;         }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(service_route, &amp;((pjsip_generic_string_hdr*)header)-&gt;hvalue, size);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">if</span> (!service_routes) {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;         service_routes = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d3bb8496e8ca801ce7e5ff204a28837">ast_sip_service_route_vector_alloc</a>();</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;         <span class="keywordflow">if</span> (!service_routes) {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(service_route);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;         }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(service_routes, service_route)) {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(service_route);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a790e1a3ec85fd649e267eee830b565c4">ast_sip_service_route_vector_destroy</a>(service_routes);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         service_routes = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="comment">/* If any service routes were handled then store them on the transport */</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   <span class="keywordflow">if</span> (service_routes) {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb302970b725b934e07bbda28c9e4f23">ast_sip_transport_state_set_service_routes</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>, service_routes);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="comment">/* If an associated URI is present in the response we need to use it on any outgoing</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">    * traffic on the transport.</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   header = pjsip_msg_find_hdr_by_name(msg, &amp;associated_uri_str, NULL);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <span class="keywordflow">if</span> (header) {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>[pj_strlen(&amp;((pjsip_generic_string_hdr*)header)-&gt;hvalue) + 1];</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(value, &amp;((pjsip_generic_string_hdr*)header)-&gt;hvalue, <span class="keyword">sizeof</span>(value));</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae885353b1f44a15a8a828864561de00c">ast_sip_transport_state_set_preferred_identity</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>, value);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">/*! \brief Callback function for handling a response to a registration attempt */</span></div><div class="line"><a name="l01056"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a3c1b82437e7e8843602d3dce17cc4e9d"> 1056</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a3c1b82437e7e8843602d3dce17cc4e9d">handle_registration_response</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;{</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> *response = data;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> == <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a>) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(response, -1);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   pjsip_regc_get_info(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;info);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(server_uri, &amp;info.server_uri, <span class="keyword">sizeof</span>(server_uri));</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(client_uri, &amp;info.client_uri, <span class="keyword">sizeof</span>(client_uri));</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Processing REGISTER response %d from server &#39;%s&#39; for client &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, server_uri, client_uri);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == 408 || response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == 503) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d8c/res__pjsip_8h.html#afa22bc164a1c4108006f96822318ff14">ast_sip_failover_request</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>))) {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;         <span class="keywordtype">int</span> res = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;         <span class="comment">/* The tdata ref was stolen */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;         <span class="keywordflow">if</span> (res == PJ_SUCCESS) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(response, -1);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;         }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == 401 || response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == 407)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      &amp;&amp; (!response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">auth_attempted</a></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         || response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.cseq-&gt;cseq != response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#abc867dcf2080fffd890e3ff80e40956a">auth_cseq</a>)) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      pjsip_cseq_hdr *cseq_hdr;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      pjsip_tx_data *tdata;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a>(&amp;response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>,</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>, &amp;tdata)) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">auth_attempted</a> = 1;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Sending authenticated REGISTER to server &#39;%s&#39; from client &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;               server_uri, client_uri);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;         pjsip_tx_data_add_ref(tdata);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;         res = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, tdata);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;         <span class="comment">/* Save the cseq that actually got sent. */</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         cseq_hdr = (pjsip_cseq_hdr *) pjsip_msg_find_hdr(tdata-&gt;msg, PJSIP_H_CSEQ,</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#abc867dcf2080fffd890e3ff80e40956a">auth_cseq</a> = cseq_hdr-&gt;cseq;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;         <span class="keywordflow">if</span> (res == PJ_SUCCESS) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(response, -1);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to create authenticated REGISTER request to server &#39;%s&#39; from client &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;               server_uri, client_uri);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="comment">/* Otherwise, fall through so the failure is processed appropriately */</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">auth_attempted</a> = 0;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <span class="keywordflow">if</span> (PJSIP_IS_STATUS_IN_CLASS(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, 200)) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="comment">/* Check if this is in regards to registering or unregistering */</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">expiration</a>) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;         <span class="keywordtype">int</span> next_registration_round;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;         <span class="comment">/* If the registration went fine simply reschedule registration for the future */</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Outbound registration to &#39;%s&#39; with client &#39;%s&#39; successful\n&quot;</span>, server_uri, client_uri);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a> = 0;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;         next_registration_round = response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">expiration</a> - <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1532fa6ad6ad7d60a568fc5b3594cd94">REREGISTER_BUFFER_TIME</a>;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         <span class="keywordflow">if</span> (next_registration_round &lt; 0) {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="comment">/* Re-register immediately. */</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            next_registration_round = 0;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, next_registration_round);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         <span class="comment">/* See if we should monitor for transport shutdown */</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8eedbfa3d0832f502e16d1fb2b26ee02">registration_transport_monitor_setup</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport,</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Outbound unregistration to &#39;%s&#39; with client &#39;%s&#39; successful\n&quot;</span>, server_uri, client_uri);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a>);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5d73e049fbced1da4e3041d1656e0aa6">ast_sip_transport_monitor_unregister</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">registration_transport_shutdown_cb</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a>,</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af5c116e487d0241d5b723858e5e40ef4">monitor_matcher</a>);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      }</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a110fd2cc81e44ec29e95e193adafea46">save_response_fields_to_transport</a>(response);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">destroy</a>) {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="comment">/* We need to deal with the pending destruction instead. */</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">retry_after</a>) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="comment">/* If we have been instructed to retry after a period of time, schedule it as such */</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4d2100faf8e050dc5c26cd54d487452">schedule_retry</a>(response, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">retry_after</a>, server_uri, client_uri);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">retry_interval</a></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      &amp;&amp; <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a82533315c5406ca144bac2824078a514">sip_outbound_registration_is_temporal</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>)) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a> == response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">max_retries</a>) {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;         <span class="comment">/* If we received enough temporal responses to exceed our maximum give up permanently */</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Maximum retries reached when attempting outbound registration to &#39;%s&#39; with client &#39;%s&#39;, stopping registration attempt\n&quot;</span>,</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            server_uri, client_uri);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <span class="comment">/* On the other hand if we can still try some more do so */</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a>++;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4d2100faf8e050dc5c26cd54d487452">schedule_retry</a>(response, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">retry_interval</a>, server_uri, client_uri);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> == 403</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;         &amp;&amp; response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;         &amp;&amp; response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a> &lt; response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">max_retries</a>) {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;         <span class="comment">/* A forbidden response retry interval is configured and there are retries remaining */</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a>++;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;403 Forbidden fatal response received from &#39;%s&#39; on registration attempt to &#39;%s&#39;, retrying in &#39;%u&#39; seconds\n&quot;</span>,</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            server_uri, client_uri, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            &amp;&amp; response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a> &lt; response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">max_retries</a>) {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         <span class="comment">/* Some kind of fatal failure response received, so retry according to configured interval */</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a>);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;         response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a>++;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%d&#39; fatal response received from &#39;%s&#39; on registration attempt to &#39;%s&#39;, retrying in &#39;%u&#39; seconds\n&quot;</span>,</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, server_uri, client_uri, response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;         <span class="comment">/* Finally if there&#39;s no hope of registering give up */</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Fatal response &#39;%d&#39; received from &#39;%s&#39; on registration attempt to &#39;%s&#39;, stopping outbound registration\n&quot;</span>,</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;               response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a>, server_uri, client_uri);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Fatal registration attempt to &#39;%s&#39;, stopping outbound registration\n&quot;</span>, client_uri);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <a class="code" href="../../d3/df0/stasis__system_8h.html#a0868bf726d24bce354a1d14f13b39a70">ast_system_publish_registry</a>(<span class="stringliteral">&quot;PJSIP&quot;</span>, client_uri, server_uri,</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   <span class="keywordflow">if</span> (response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">destroy</a>) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="comment">/* We have a pending deferred destruction to complete now. */</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, +1);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8380e4bb4249f1a7d4bef09985bf73b5">handle_client_state_destruction</a>(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;   }</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(response, -1);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;}</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">/*! \brief Callback function for outbound registration client */</span></div><div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af28a67b870d8865247fe2e14dcb03a07"> 1207</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af28a67b870d8865247fe2e14dcb03a07">sip_outbound_registration_response_cb</a>(<span class="keyword">struct</span> pjsip_regc_cbparam *param)</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;{</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state = param-&gt;token;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d4c/structregistration__response.html">registration_response</a> *response;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   <span class="keywordtype">int</span> *callback_invoked;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   callback_invoked = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1ae1ce6947f3f39fd07bd4c26b1183d">register_callback_invoked</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(callback_invoked != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(client_state != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   *callback_invoked = 1;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   response = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*response), <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a74db2eb050f68d18300d0584b9a2a671">registration_response_destroy</a>);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   <span class="keywordflow">if</span> (!response) {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client_state, -1);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">code</a> = param-&gt;code;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">expiration</a> = param-&gt;expiration;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">    * Transfer client_state reference to response so the</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">    * nominal path will not dec the client_state ref in this</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">    * pjproject callback thread.</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a> = <a class="code" href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received REGISTER response %d(%.*s)\n&quot;</span>,</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      param-&gt;code, (<span class="keywordtype">int</span>) param-&gt;reason.slen, param-&gt;reason.ptr);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   <span class="keywordflow">if</span> (param-&gt;rdata) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keyword">struct </span>pjsip_retry_after_hdr *retry_after;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      pjsip_transaction *tsx;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      retry_after = pjsip_msg_find_hdr(param-&gt;rdata-&gt;msg_info.msg, PJSIP_H_RETRY_AFTER,</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">retry_after</a> = retry_after ? retry_after-&gt;ivalue : 0;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">       * If we got a response from the server, we have to use the tdata</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">       * from the transaction, not the tdata saved when we sent the</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">       * request.  If we use the saved tdata, we won&#39;t process responses</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">       * like 423 Interval Too Brief correctly and we&#39;ll wind up sending</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">       * the bad Expires value again.</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      pjsip_tx_data_dec_ref(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      tsx = pjsip_rdata_get_tsx(param-&gt;rdata);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a> = tsx-&gt;last_tx;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      pjsip_tx_data_add_ref(response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a>);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      pjsip_rx_data_clone(param-&gt;rdata, 0, &amp;response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="comment">/* old_request steals the reference */</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      response-&gt;<a class="code" href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">old_request</a> = client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;   }</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">    * Transfer response reference to serializer task so the</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">    * nominal path will not dec the response ref in this</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">    * pjproject callback thread.</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a3c1b82437e7e8843602d3dce17cc4e9d">handle_registration_response</a>, response)) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to pass incoming registration response to threadpool\n&quot;</span>);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(response);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;   }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">/*! \brief Destructor function for registration state */</span></div><div class="line"><a name="l01276"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66ac7b74defe3790a72568a394c55270"> 1276</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66ac7b74defe3790a72568a394c55270">sip_outbound_registration_state_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;{</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Destroying registration state for registration to server &#39;%s&#39; from client &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a> ? state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a> ? state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="comment">/* Nothing to do */</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, -1);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>,</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8380e4bb4249f1a7d4bef09985bf73b5">handle_client_state_destruction</a>, state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>)) {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to pass outbound registration client destruction to threadpool\n&quot;</span>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, -1);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   }</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">/*! \brief Destructor function for client registration state */</span></div><div class="line"><a name="l01297"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a76eeff441a1c0f25e33e41191c0ca815"> 1297</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a76eeff441a1c0f25e33e41191c0ca815">sip_outbound_registration_client_state_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;{</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a> *client_state = obj;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a6bd3bc2a7663784200d00e63f3eceeef">ast_statsd_log_string</a>(<span class="stringliteral">&quot;PJSIP.registrations.count&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;-1&quot;</span>, 1.0);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a2d6d16d49502503505c1b5748be47c83">ast_statsd_log_string_va</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.%s&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;-1&quot;</span>, 1.0,</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>));</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a>);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a>);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <span class="keywordflow">if</span> (client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>) {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      pjsip_tx_data_dec_ref(client_state-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">last_tdata</a>);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">/*! \brief Allocator function for registration state */</span></div><div class="line"><a name="l01314"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac48fbe3a83520ca92ebde956e2c5c5d4"> 1314</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac48fbe3a83520ca92ebde956e2c5c5d4">sip_outbound_registration_state_alloc</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>)</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;{</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <span class="keywordtype">char</span> tps_name[<a class="code" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a> + 1];</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;   state = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*state), <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66ac7b74defe3790a72568a394c55270">sip_outbound_registration_state_destroy</a>);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>),</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a76eeff441a1c0f25e33e41191c0ca815">sip_outbound_registration_client_state_destroy</a>);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>) {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   }</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   pj_timer_entry_init(&amp;state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">timer</a>, 0, state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>,</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a55c93ab3532991aa5db9440b6ee2b3">sip_outbound_registration_timer_cb</a>);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">transport</a>);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a> =</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration));</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a6bd3bc2a7663784200d00e63f3eceeef">ast_statsd_log_string</a>(<span class="stringliteral">&quot;PJSIP.registrations.count&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;+1&quot;</span>, 1.0);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#a2d6d16d49502503505c1b5748be47c83">ast_statsd_log_string_va</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.%s&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, <span class="stringliteral">&quot;+1&quot;</span>, 1.0,</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>));</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">transport_name</a></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      || !state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">registration_name</a>) {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;   }</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;   <span class="comment">/* Create name with seq number appended. */</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a>(tps_name, <span class="keyword">sizeof</span>(tps_name), <span class="stringliteral">&quot;pjsip/outreg/%s&quot;</span>,</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration));</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga575cb798179c82d92b24415d3e174b5b">ast_sip_create_serializer_group</a>(tps_name,</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      shutdown_group);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;   <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>) {</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;   }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(registration);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;}</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">/*! \brief Destructor function for registration information */</span></div><div class="line"><a name="l01363"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abc58ecbb693180f1556ee7ae939f3774"> 1363</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abc58ecbb693180f1556ee7ae939f3774">sip_outbound_registration_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;{</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac5342f99fec726a94fb4b713e43eec12">ast_sip_auth_vector_destroy</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(registration);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;}</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">/*! \brief Allocator function for registration information */</span></div><div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2d9f49ccb117db36a181b412670f4ce7"> 1373</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2d9f49ccb117db36a181b412670f4ce7">sip_outbound_registration_alloc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;{</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;   registration = <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(*registration),</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abc58ecbb693180f1556ee7ae939f3774">sip_outbound_registration_destroy</a>);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   <span class="keywordflow">if</span> (!registration || <a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(registration, 256)) {</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(registration);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   <span class="keywordflow">return</span> registration;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;}</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">/*! \brief Helper function which populates a pj_str_t with a contact header */</span></div><div class="line"><a name="l01388"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a503c27e9cb915cd6bebd3c22f7d911e0"> 1388</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a503c27e9cb915cd6bebd3c22f7d911e0">sip_dialog_create_contact</a>(pj_pool_t *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, pj_str_t *<a class="code" href="../../d9/d03/structcontact.html">contact</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/dbc/structuser.html">user</a>,</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;   <span class="keyword">const</span> pj_str_t *target, pjsip_tpselector *selector, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *header_params)</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;{</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   pj_str_t <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>, local_addr;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   pjsip_uri *uri;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   pjsip_sip_uri *sip_uri;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;   pjsip_transport_type_e <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   <span class="keywordtype">int</span> local_port;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   pj_strdup_with_null(pool, &amp;tmp, target);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <span class="keywordflow">if</span> (!(uri = pjsip_parse_uri(pool, tmp.ptr, tmp.slen, 0)) ||</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;       (!PJSIP_URI_SCHEME_IS_SIP(uri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(uri))) {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;   sip_uri = pjsip_uri_get_uri(uri);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   type = pjsip_transport_get_type_from_name(&amp;sip_uri-&gt;transport_param);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   <span class="keywordflow">if</span> (PJSIP_URI_SCHEME_IS_SIPS(sip_uri)) {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">if</span> (type == PJSIP_TRANSPORT_UNSPECIFIED</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         || !(pjsip_transport_get_flag_from_type(type) &amp; PJSIP_TRANSPORT_SECURE)) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;         type = PJSIP_TRANSPORT_TLS;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!sip_uri-&gt;transport_param.slen) {</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      type = PJSIP_TRANSPORT_UDP;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == PJSIP_TRANSPORT_UNSPECIFIED) {</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   }</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;   <span class="keywordflow">if</span> (pj_strchr(&amp;sip_uri-&gt;host, <span class="charliteral">&#39;:&#39;</span>)) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      type |= PJSIP_TRANSPORT_IPV6;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;   }</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;   <span class="keywordflow">if</span> (pjsip_tpmgr_find_local_addr(pjsip_endpt_get_tpmgr(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>()),</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      pool, type, selector, &amp;local_addr, &amp;local_port) != PJ_SUCCESS) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;   }</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;   <span class="keywordflow">if</span> (!pj_strchr(&amp;sip_uri-&gt;host, <span class="charliteral">&#39;:&#39;</span>) &amp;&amp; pj_strchr(&amp;local_addr, <span class="charliteral">&#39;:&#39;</span>)) {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      type |= PJSIP_TRANSPORT_IPV6;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;   }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;   contact-&gt;ptr = pj_pool_alloc(pool, PJSIP_MAX_URL_SIZE);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   contact-&gt;slen = pj_ansi_snprintf(contact-&gt;ptr, PJSIP_MAX_URL_SIZE,</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="stringliteral">&quot;&lt;%s:%s@%s%.*s%s:%d%s%s%s%s&gt;%s%s&quot;</span>,</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      ((pjsip_transport_get_flag_from_type(type) &amp; PJSIP_TRANSPORT_SECURE) &amp;&amp; PJSIP_URI_SCHEME_IS_SIPS(uri)) ? <span class="stringliteral">&quot;sips&quot;</span> : <span class="stringliteral">&quot;sip&quot;</span>,</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      user,</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      (type &amp; PJSIP_TRANSPORT_IPV6) ? <span class="stringliteral">&quot;[&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      (<span class="keywordtype">int</span>)local_addr.slen,</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      local_addr.ptr,</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      (type &amp; PJSIP_TRANSPORT_IPV6) ? <span class="stringliteral">&quot;]&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      local_port,</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      (type != PJSIP_TRANSPORT_UDP &amp;&amp; type != PJSIP_TRANSPORT_UDP6) ? <span class="stringliteral">&quot;;transport=&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      (type != PJSIP_TRANSPORT_UDP &amp;&amp; type != PJSIP_TRANSPORT_UDP6) ? pjsip_transport_get_type_name(type) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(line) ? <span class="stringliteral">&quot;;line=&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(line, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(header_params) ? <span class="stringliteral">&quot;;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(header_params, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;}</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment"> * \brief Check if a registration can be reused</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"> * This checks if the existing outbound registration&#39;s configuration differs from a newly-applied</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment"> * outbound registration to see if the applied one.</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment"> * \param existing The pre-existing outbound registration</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment"> * \param applied The newly-created registration</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aecac86b5984b9351049f957b23b69992"> 1461</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aecac86b5984b9351049f957b23b69992">can_reuse_registration</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *existing,</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *applied)</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;{</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <span class="keywordtype">int</span> rc = 1;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a> = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>();</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *ve = <a class="code" href="../../d8/d25/sorcery_8h.html#a197b6724158db0da59852d25d36fa5f1">ast_sorcery_objectset_create</a>(sorcery, existing);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *va = <a class="code" href="../../d8/d25/sorcery_8h.html#a197b6724158db0da59852d25d36fa5f1">ast_sorcery_objectset_create</a>(sorcery, applied);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *vc = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a9dbf5d1177fd4ab31efe1037f4dc1c24">ast_sorcery_changeset_create</a>(ve, va, &amp;vc) || vc != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      rc = 0;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Registration &#39;%s&#39; changed.  Can&#39;t re-use.\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(existing));</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Registration &#39;%s&#39; didn&#39;t change.  Can re-use\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(existing));</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(ve);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(va);</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(vc);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;   <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;}</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">/* \brief Get google oauth2 access token using refresh token */</span></div><div class="line"><a name="l01485"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7ccb361420d2a3f4189411fc1141cac9"> 1485</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7ccb361420d2a3f4189411fc1141cac9">fetch_google_access_token</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;{</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   <span class="keywordtype">char</span> *cmd = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *token;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d12/res__config__ldap_8c.html#a75e4590043edf35241d30fabe2eda546">url</a> = <span class="stringliteral">&quot;https://www.googleapis.com/oauth2/v3/token&quot;</span>;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[4096];</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d96/structast__json__error.html">ast_json_error</a> error;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;   <span class="comment">/* set timeout to be shorter than default 180s (also checks func_curl is available) */</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/de0/pbx_8h.html#ae70e64cdf669396c88ea8eda900b0b3b">ast_func_write</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;CURLOPT(conntimeout)&quot;</span>, <span class="stringliteral">&quot;10&quot;</span>)) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;CURL is unavailable. This is required for Google OAuth 2.0 authentication. Please ensure it is loaded.\n&quot;</span>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   res = <a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;cmd,</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="stringliteral">&quot;CURL(%s,client_id=%s&amp;client_secret=%s&amp;refresh_token=%s&amp;grant_type=refresh_token)&quot;</span>,</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      url, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a4b8582884dc99ca78481aaf09d2a8aaa">oauth_clientid</a>, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a4e8ff91b48d6fcdfb7f0265d59bdd979">oauth_secret</a>, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#ad300470818476484645b03f3c0c66591">refresh_token</a>);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Performing Google OAuth 2.0 authentication using command: %s\n&quot;</span>, cmd);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;   res = <a class="code" href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, cmd, buf, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cmd);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not retrieve Google OAuth 2.0 authentication\n&quot;</span>);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;   }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Google OAuth 2.0 authentication returned: %s\n&quot;</span>, buf);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#adca5179982d1f48df7127c123f15ce74">ast_json_load_string</a>(buf, &amp;error);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not parse Google OAuth 2.0 authentication: %d(%d) %s: &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         error.<a class="code" href="../../d0/d96/structast__json__error.html#a41ebd28ef1d7c6ade45642cb6acc1039">line</a>, error.<a class="code" href="../../d0/d96/structast__json__error.html#a60dae4c6e78188cd718b696e4f08fc71">column</a>, error.<a class="code" href="../../d0/d96/structast__json__error.html#a9b20e804a129dc6c80e6df3c4559dc2b">text</a>, buf);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;   }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;   token = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;access_token&quot;</span>));</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   <span class="keywordflow">if</span> (!token) {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not find Google OAuth 2.0 access_token in: &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;         buf);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;   }</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;   token = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(token);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;   <span class="keywordflow">return</span> token;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;}</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment"> * \brief Set pjsip registration context with any authentication credentials that need to be</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment"> * sent in the initial registration request</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment"> * \param regc The pjsip registration context</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment"> * \param auth_vector The vector of configured authentication credentials</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01545"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1a9a9a97cbae2fdf1c2890fe9adbc92"> 1545</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1a9a9a97cbae2fdf1c2890fe9adbc92">set_outbound_initial_authentication_credentials</a>(pjsip_regc *regc,</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/dca/structast__sip__auth__vector.html">ast_sip_auth_vector</a> *auth_vector)</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;{</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;   <span class="keywordtype">size_t</span> auth_size = <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(auth_vector);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auths[auth_size];</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *access_token;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   pjsip_cred_info auth_creds[1];</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   pjsip_auth_clt_pref prefs;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;   memset(auths, 0, <span class="keyword">sizeof</span>(auths));</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a72f43e82cb97ea0b744a4a0ba7ff0a43">ast_sip_retrieve_auths</a>(auth_vector, auths)) {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      res = -1;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;   }</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; auth_size; ++idx) {</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="keywordflow">switch</span> (auths[idx]-&gt;<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cda0d8d8506a624618324fd18bb4a7e7079">AST_SIP_AUTH_TYPE_GOOGLE_OAUTH</a>:</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;         pj_cstr(&amp;auth_creds[0].username, auths[idx]-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">auth_user</a>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;         pj_cstr(&amp;auth_creds[0].scheme, <span class="stringliteral">&quot;Bearer&quot;</span>);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         pj_cstr(&amp;auth_creds[0].<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>, auths[idx]-&gt;realm);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Obtaining Google OAuth access token\n&quot;</span>);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;         access_token = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7ccb361420d2a3f4189411fc1141cac9">fetch_google_access_token</a>(auths[idx]);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;         <span class="keywordflow">if</span> (!access_token) {</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Obtaining Google OAuth access token failed\n&quot;</span>);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            access_token = auths[idx]-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#af263f62bf45d20982f102de2a9cd461f">auth_pass</a>;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;            res = -1;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;         }</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Setting data to &#39;%s&#39;\n&quot;</span>, access_token);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;         pj_cstr(&amp;auth_creds[0].data, access_token);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;         auth_creds[0].data_type = PJSIP_CRED_DATA_PLAIN_PASSWD;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;         pjsip_regc_set_credentials(regc, 1, auth_creds);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;         <span class="comment">/* for oauth, send auth without waiting for unauthorized response */</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;         prefs.initial_auth = PJ_TRUE;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;         pj_cstr(&amp;prefs.algorithm, <span class="stringliteral">&quot;oauth&quot;</span>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;         pjsip_regc_set_prefs(regc, &amp;prefs);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         <span class="keywordflow">if</span> (access_token != auths[idx]-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#af263f62bf45d20982f102de2a9cd461f">auth_pass</a>) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">char</span> *) access_token);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;         }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;         <span class="comment">/* other cases handled after receiving auth rejection */</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   }</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a3e8ce0855f5b8cc0e2c64cc59887d779">ast_sip_cleanup_auths</a>(auths, auth_size);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;}</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">/*! \brief Helper function that allocates a pjsip registration client and configures it */</span></div><div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0be5c2e7ad5a80313f0d1fee09e7e843"> 1603</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0be5c2e7ad5a80313f0d1fee09e7e843">sip_outbound_registration_regc_alloc</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = data;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>,</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;       <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   pj_pool_t *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   pj_str_t <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   pjsip_uri *uri;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   pj_str_t <a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>, contact_uri;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;   pjsip_tpselector selector = { .type = PJSIP_TPSELECTOR_NONE, };</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;   pool = pjsip_endpt_create_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), <span class="stringliteral">&quot;URI Validation&quot;</span>, 256, 256);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not create pool for URI validation on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>));</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;   }</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;   pj_strdup2_with_null(pool, &amp;tmp, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;   uri = pjsip_parse_uri(pool, tmp.ptr, tmp.slen, 0);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   <span class="keywordflow">if</span> (!uri) {</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid server URI &#39;%s&#39; specified on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;         <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>));</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      pjsip_endpt_release_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), pool);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   }</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   pj_strdup2_with_null(pool, &amp;tmp, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;   uri = pjsip_parse_uri(pool, tmp.ptr, tmp.slen, 0);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;   <span class="keywordflow">if</span> (!uri) {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid client URI &#39;%s&#39; specified on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;         <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>));</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      pjsip_endpt_release_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), pool);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;   }</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>)) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      pj_strdup2_with_null(pool, &amp;tmp, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      uri = pjsip_parse_uri(pool, tmp.ptr, tmp.slen, 0);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">if</span> (!uri) {</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid outbound proxy URI &#39;%s&#39; specified on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>));</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;         pjsip_endpt_release_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), pool);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;   }</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;   pjsip_endpt_release_pool(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), pool);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;   <span class="keywordflow">if</span> (pjsip_regc_create(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>,</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af28a67b870d8865247fe2e14dcb03a07">sip_outbound_registration_response_cb</a>,</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;         &amp;state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   }</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac94b7c59f69d31b962e42098955f8fa4">ast_sip_set_tpselector_from_transport_name</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">transport</a>, &amp;selector);</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;   pjsip_regc_set_transport(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;selector);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>)) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      pjsip_route_hdr route_set, *route;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t ROUTE_HNAME = { <span class="stringliteral">&quot;Route&quot;</span>, 5 };</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      pj_str_t <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      pj_list_init(&amp;route_set);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      pj_strdup2_with_null(pjsip_regc_get_pool(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>), &amp;tmp,</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;         <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      route = pjsip_parse_hdr(pjsip_regc_get_pool(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>),</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;         &amp;ROUTE_HNAME, tmp.ptr, tmp.slen, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keywordflow">if</span> (!route) {</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9e1ef995698ba16cad6608225b8de946">ast_sip_tpselector_unref</a>(&amp;selector);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      pj_list_insert_nodes_before(&amp;route_set, route);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      pjsip_regc_set_route_set(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;route_set);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   <span class="keywordflow">if</span> (state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>) {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">line</a>, <span class="keyword">sizeof</span>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">line</a>));</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;   }</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   pj_cstr(&amp;server_uri, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a503c27e9cb915cd6bebd3c22f7d911e0">sip_dialog_create_contact</a>(pjsip_regc_get_pool(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>),</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      &amp;contact_uri, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#aff8e665e1528d0e12e446fcbd4d2efa6">contact_user</a>, <span class="stringliteral">&quot;s&quot;</span>), &amp;server_uri, &amp;selector,</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">line</a>, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a7568cd99aeb0e7f2919a9c03f1a8d674">contact_header_params</a>)) {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9e1ef995698ba16cad6608225b8de946">ast_sip_tpselector_unref</a>(&amp;selector);</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9e1ef995698ba16cad6608225b8de946">ast_sip_tpselector_unref</a>(&amp;selector);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;   pj_cstr(&amp;client_uri, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;   <span class="keywordflow">if</span> (pjsip_regc_init(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;server_uri, &amp;client_uri,</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      &amp;client_uri, 1, &amp;contact_uri, <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">expiration</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   }</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;}</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">/*! \brief Helper function which performs a single registration */</span></div><div class="line"><a name="l01708"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477"> 1708</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477">sip_outbound_registration_perform</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;{</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = data;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   <span class="comment">/* Just in case the client state is being reused for this registration, free the auth information */</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac5342f99fec726a94fb4b713e43eec12">ast_sip_auth_vector_destroy</a>(&amp;state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>));</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>); ++i) {</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, i));</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">if</span> (name &amp;&amp; <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, name)) {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(name);</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">retry_interval</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a98068831aa58db10990857613f081058">retry_interval</a>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">max_retries</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ac471888e0087722725624aead073fda5">max_retries</a>;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">retries</a> = 0;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a>;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a>;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;   state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a> = registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a>;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;   pjsip_regc_update_expires(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">expiration</a>);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, (<a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() % 10) + 1);</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(registration, -1);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">/*! \brief Apply function which finds or allocates a state structure */</span></div><div class="line"><a name="l01744"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e42339585acd64891a8d11f1504ea60"> 1744</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e42339585acd64891a8d11f1504ea60">sip_outbound_registration_apply</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;{</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, states, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *, <a class="code" href="../../d4/d88/structstate.html">state</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *, new_state, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *applied = obj;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;   <span class="keywordflow">if</span> (!states) {</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="comment">/* Global container has gone.  Likely shutting down. */</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   }</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   <a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(states, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied), <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Applying configuration to outbound registration &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>)) {</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No server URI specified on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5c/res__pjsip__private_8h.html#a11c06d062df22e560a693c61da9ffa3c">ast_sip_validate_uri_length</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>)) {</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Server URI or hostname length exceeds pjproject limit or is not a sip(s) uri: &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>)) {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No client URI specified on outbound registration &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5c/res__pjsip__private_8h.html#a11c06d062df22e560a693c61da9ffa3c">ast_sip_validate_uri_length</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>)) {</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Client URI or hostname length exceeds pjproject limit or is not a sip(s) uri: &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a> &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#aa3522da32a7960126d5eb2ac0c1c6c36">endpoint</a>)) {</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Line support has been enabled on outbound registration &#39;%s&#39; without providing an endpoint\n&quot;</span>,</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#aa3522da32a7960126d5eb2ac0c1c6c36">endpoint</a>) &amp;&amp; !applied-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;An endpoint has been specified on outbound registration &#39;%s&#39; without enabling line support\n&quot;</span>,</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;   }</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d88/structstate.html">state</a> &amp;&amp; <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aecac86b5984b9351049f957b23b69992">can_reuse_registration</a>(<a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration, applied)) {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4,</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         <span class="stringliteral">&quot;No change between old configuration and new configuration on outbound registration &#39;%s&#39;. Using previous state\n&quot;</span>,</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(applied));</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">       * This is OK to replace without relinking the state in the</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">       * current_states container since state-&gt;registration and</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">       * applied have the same key.</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(states);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(<a class="code" href="../../d4/d88/structstate.html">state</a>-&gt;registration, applied);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(states);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   }</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   <span class="keywordflow">if</span> (!(new_state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac48fbe3a83520ca92ebde956e2c5c5d4">sip_outbound_registration_state_alloc</a>(applied))) {</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   }</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a>(new_state-&gt;client_state-&gt;serializer,</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0be5c2e7ad5a80313f0d1fee09e7e843">sip_outbound_registration_regc_alloc</a>, new_state)) {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(new_state-&gt;client_state-&gt;serializer,</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;               <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477">sip_outbound_registration_perform</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(new_state))) {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to perform outbound registration on &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(new_state-&gt;registration));</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_state, -1);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(states);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d88/structstate.html">state</a>) {</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(states, <a class="code" href="../../d4/d88/structstate.html">state</a>);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;   }</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(states, new_state);</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(states);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;}</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a52f23503e09ad7f6ab7cce9163b21872"> 1828</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a52f23503e09ad7f6ab7cce9163b21872">outbound_auth_handler</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/de0/structaco__option.html">aco_option</a> *opt, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;{</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae2a70501bd77f6a45cfac6cd343dd7fa">ast_sip_auth_vector_init</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a9402eeb89268606c03c23e63df7e32f5"> 1835</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a9402eeb89268606c03c23e63df7e32f5">outbound_auths_to_str</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> intptr_t *<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, <span class="keywordtype">char</span> **<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;{</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5dfee119fa8decee60b36380e84ffc40">ast_sip_auths_to_str</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, buf);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;}</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1a3cfb170f6d562dbd938cdd5d059bb"> 1842</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1a3cfb170f6d562dbd938cdd5d059bb">outbound_auths_to_var_list</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> **fields)</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;{</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *head = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>) ; i++) {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a7af2e88e6e3812ec80facb1b41df43de">ast_variable_list_append</a>(&amp;head, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(<span class="stringliteral">&quot;outbound_auth&quot;</span>,</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, i), <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   }</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;   <span class="keywordflow">if</span> (head) {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      *fields = head;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;   }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;}</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa06519e07ad0d92edb3ab7e8a910e0f7"> 1860</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa06519e07ad0d92edb3ab7e8a910e0f7">unregister_task</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;{</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;   <span class="keyword">struct </span>pjsip_regc *client = state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;   pjsip_regc_get_info(client, &amp;info);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Unregistering contacts with server &#39;%s&#39; from client &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>, state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>);</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <span class="keywordflow">if</span> (pjsip_regc_unregister(client, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      &amp;&amp; <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">add_configured_supported_headers</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, tdata)) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>, tdata);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;}</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div><div class="line"><a name="l01882"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526"> 1882</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;{</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, +1);</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa06519e07ad0d92edb3ab7e8a910e0f7">unregister_task</a>, state)) {</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;}</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4d0179e0cf04c08d87db248822b3955c"> 1893</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4d0179e0cf04c08d87db248822b3955c">queue_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;{</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, +1);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477">sip_outbound_registration_perform</a>, state)) {</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   }</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;}</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0"> 1904</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0">unregister_all</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;{</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *states;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;   states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <span class="keywordflow">if</span> (!states) {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   <span class="comment">/* Clean out all the states and let sorcery handle recreating the registrations */</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(states, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(states, -1);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;}</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f"> 1918</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f">reregister_all</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;{</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0">unregister_all</a>();</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a6f052c6dd5e388e519725406a6af5215">ast_sorcery_load_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;}</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0b63fcdb0e736b698602fbcbe0ea591d"> 1924</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0b63fcdb0e736b698602fbcbe0ea591d">cli_complete_registration</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>,</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                   <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;{</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="keywordtype">int</span> wordlen;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <span class="keywordtype">int</span> which = 0;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d5/dff/chan__iax2_8c.html#a0443ab92a32c0d55ac2bace5904fbb3e">registrations</a>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;   <span class="keywordflow">if</span> (pos != 3) {</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   }</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   wordlen = strlen(word);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   <span class="keywordflow">if</span> (wordlen == 0 &amp;&amp; ++which &gt; state) {</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;*all&quot;</span>);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;   }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;   registrations = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>,</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   <span class="keywordflow">if</span> (!registrations) {</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;   }</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(registrations, 0);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;   <span class="keywordflow">while</span> ((registration = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(word, name, wordlen) &amp;&amp; ++which &gt; state) {</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;         result = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(name);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(registration, -1);</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      }</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;   }</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(registrations, -1);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div><div class="line"><a name="l01968"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6f2b148fd40115de7dc273247d5f28be"> 1968</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6f2b148fd40115de7dc273247d5f28be">cli_unregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;{</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip send unregister&quot;</span>;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;         <span class="stringliteral">&quot;Usage: pjsip send unregister &lt;registration&gt; | *all\n&quot;</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;         <span class="stringliteral">&quot;       Unregisters the specified (or all) outbound registration(s) &quot;</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;         <span class="stringliteral">&quot;and stops future registration attempts.\n&quot;</span>;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0b63fcdb0e736b698602fbcbe0ea591d">cli_complete_registration</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   }</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   registration_name = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3];</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;   <span class="keywordflow">if</span> (strcmp(registration_name, <span class="stringliteral">&quot;*all&quot;</span>) == 0) {</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0">unregister_all</a>();</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unregister all queued\n&quot;</span>);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;   }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_name);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to retrieve registration %s\n&quot;</span>, registration_name);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   }</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a>(state)) {</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Failed to queue unregistration\n&quot;</span>);</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;   }</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad6abfe953081de3a494b667078d0f2c7"> 2011</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad6abfe953081de3a494b667078d0f2c7">cli_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;{</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip send register&quot;</span>;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;         <span class="stringliteral">&quot;Usage: pjsip send register &lt;registration&gt; | *all \n&quot;</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;         <span class="stringliteral">&quot;       Unregisters the specified (or all) outbound &quot;</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;         <span class="stringliteral">&quot;registration(s) then starts registration(s) and schedules re-registrations.\n&quot;</span>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0b63fcdb0e736b698602fbcbe0ea591d">cli_complete_registration</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   }</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   }</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   registration_name = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3];</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;   <span class="keywordflow">if</span> (strcmp(registration_name, <span class="stringliteral">&quot;*all&quot;</span>) == 0) {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f">reregister_all</a>();</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Re-register all queued\n&quot;</span>);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   }</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_name);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to retrieve registration %s\n&quot;</span>, registration_name);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;   }</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   <span class="comment">/* We need to serialize the unregister and register so they need</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">    * to be queued as separate tasks.</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a>(state)) {</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Failed to queue unregistration\n&quot;</span>);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4d0179e0cf04c08d87db248822b3955c">queue_register</a>(state)) {</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Failed to queue registration\n&quot;</span>);</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   }</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;}</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a62335a29dc5fc2ae927d923a1a372938"> 2059</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a62335a29dc5fc2ae927d923a1a372938">ami_unregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;{</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Registration&quot;</span>);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(registration_name)) {</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Registration parameter missing.&quot;</span>);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;   <span class="keywordflow">if</span> (strcmp(registration_name, <span class="stringliteral">&quot;*all&quot;</span>) == 0) {</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0">unregister_all</a>();</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Unregistrations queued.&quot;</span>);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   }</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_name);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to retrieve registration entry\n&quot;</span>);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;   }</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a>(state)) {</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Failed to queue unregistration&quot;</span>);</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Unregistration sent&quot;</span>);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   }</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;}</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5cd5b408e27b27e519386044af259073"> 2091</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5cd5b408e27b27e519386044af259073">ami_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;{</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_name = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Registration&quot;</span>);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(registration_name)) {</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Registration parameter missing.&quot;</span>);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   }</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;   <span class="keywordflow">if</span> (strcmp(registration_name, <span class="stringliteral">&quot;*all&quot;</span>) == 0) {</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f">reregister_all</a>();</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Reregistrations queued.&quot;</span>);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;   }</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;   state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_name);</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to retrieve registration entry\n&quot;</span>);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;   }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;   <span class="comment">/* We need to serialize the unregister and register so they need</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">    * to be queued as separate tasks.</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a>(state)) {</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Failed to queue unregistration&quot;</span>);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4d0179e0cf04c08d87db248822b3955c">queue_register</a>(state)) {</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Failed to queue unregistration&quot;</span>);</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Reregistration sent&quot;</span>);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   }</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;}</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"><a class="line" href="../../d4/d1b/structsip__ami__outbound.html"> 2128</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d1b/structsip__ami__outbound.html">sip_ami_outbound</a> {</div><div class="line"><a name="l02129"></a><span class="lineno"><a class="line" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4"> 2129</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> *<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a>;</div><div class="line"><a name="l02130"></a><span class="lineno"><a class="line" href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0"> 2130</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>;</div><div class="line"><a name="l02131"></a><span class="lineno"><a class="line" href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f"> 2131</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f">not_registered</a>;</div><div class="line"><a name="l02132"></a><span class="lineno"><a class="line" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e"> 2132</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;};</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afe00161d4986dcff61225bf18e1ead6d"> 2135</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afe00161d4986dcff61225bf18e1ead6d">ami_outbound_registration_task</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;{</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structsip__ami__outbound.html">sip_ami_outbound</a> *<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a> = obj;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;   buf = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a>(<span class="stringliteral">&quot;OutboundRegistrationDetail&quot;</span>, ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a>);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;   }</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab105b4d8cca635ce7aeed34c4543ab54">ast_sip_sorcery_object_to_ami</a>(ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>, &amp;buf);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;   <span class="keywordflow">if</span> ((state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>)))) {</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      pjsip_regc_info <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <span class="keywordflow">if</span> (state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> == <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a>) {</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;         ++ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;         ++ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f">not_registered</a>;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      }</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;Status: %s\r\n&quot;</span>,</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;         <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>));</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      pjsip_regc_get_info(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">client</a>, &amp;info);</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;NextReg: %d\r\n&quot;</span>, info.next_reg);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;   }</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a>-&gt;<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a4690151b996bef01389d22a11ec0b21e">ast_sip_format_auths_ami</a>(&amp;ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a>);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;}</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a95b85891504e7b87e44eeb8d74b58a89"> 2171</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a95b85891504e7b87e44eeb8d74b58a89">ami_outbound_registration_detail</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;{</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structsip__ami__outbound.html">sip_ami_outbound</a> *<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a> = arg;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;   ami-&gt;<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a> = obj;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afe00161d4986dcff61225bf18e1ead6d">ami_outbound_registration_task</a>, ami);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;}</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a05f4b1cd543ee5eba99f76928df91f68"> 2179</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a05f4b1cd543ee5eba99f76928df91f68">ami_show_outbound_registrations</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s,</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;{</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a> ami = { .<a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a> = <a class="code" href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">s</a>, .m = <a class="code" href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">m</a>, .action_id = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>), };</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structsip__ami__outbound.html">sip_ami_outbound</a> ami_outbound = { .<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">ami</a> = &amp;ami };</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *regs;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   regs = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aba6cb640df8f32c52de5727b10051284">get_registrations</a>();</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   <span class="keywordflow">if</span> (!regs) {</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to retrieve &quot;</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;              <span class="stringliteral">&quot;outbound registrations\n&quot;</span>);</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   }</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Following are Events for each Outbound registration&quot;</span>,</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(regs, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a95b85891504e7b87e44eeb8d74b58a89">ami_outbound_registration_detail</a>, &amp;ami_outbound);</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;OutboundRegistrationDetailComplete&quot;</span>,</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      ami_outbound.<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> + ami_outbound.<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f">not_registered</a>);</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="stringliteral">&quot;Registered: %d\r\n&quot;</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      <span class="stringliteral">&quot;NotRegistered: %d\r\n&quot;</span>,</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      ami_outbound.<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>,</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      ami_outbound.<a class="code" href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f">not_registered</a>);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(regs, -1);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;}</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div><div class="line"><a name="l02211"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac1601540f1d2be4be34fb53b8dd96f70"> 2211</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac1601540f1d2be4be34fb53b8dd96f70">cli_get_container</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>)</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;{</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, <a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *s_container;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   <a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#a57392a9d5ccf946ae992af2ad83cf7b0">ast_sorcery_retrieve_by_regex</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, regex);</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a>) {</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   }</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   s_container = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0,</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#aafb892d94b22a7cee58517f4ab19387f">ast_sorcery_object_id_sort</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a83eba565782cb769634180b88db29d45">ast_sorcery_object_id_compare</a>);</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;   <span class="keywordflow">if</span> (!s_container) {</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;   }</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a04bf2beaf5811f6b95768e42fb95d9a5">ao2_container_dup</a>(s_container, <a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a>, 0)) {</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(s_container, -1);</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;   }</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;   <span class="keywordflow">return</span> s_container;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;}</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div><div class="line"><a name="l02235"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c4344947bef0dc3813ff04482d4ec34"> 2235</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c4344947bef0dc3813ff04482d4ec34">cli_iterator</a>(<span class="keywordtype">void</span> *<a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a78adb9ce06bb67dc38340c501d439d71">ao2_callback_fn</a> callback, <span class="keywordtype">void</span> *<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>)</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;{</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(container, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, callback, args);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;}</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02242"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0c343ef50cc7a1d66c0569d15d285941"> 2242</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0c343ef50cc7a1d66c0569d15d285941">cli_retrieve_by_id</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;{</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *states;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;   <span class="keywordtype">void</span> *obj = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   <span class="keywordflow">if</span> (!obj) {</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="comment">/* if the object no longer exists then remove its state  */</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="keywordflow">if</span> (states) {</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(states, <span class="keywordtype">id</span>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>);</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(states, -1);</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      }</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;   }</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;   <span class="keywordflow">return</span> obj;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;}</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;</div><div class="line"><a name="l02259"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2b763a2a08e7882b81e5dbd3a71c3e01"> 2259</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2b763a2a08e7882b81e5dbd3a71c3e01">cli_print_header</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;{</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/da9/structast__sip__cli__context.html">ast_sip_cli_context</a> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = arg;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">output_buffer</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">output_buffer</a>, 0,</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="stringliteral">&quot; &lt;Registration/ServerURI..............................&gt;  &lt;Auth..........&gt;  &lt;Status.......&gt;\n&quot;</span>);</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;}</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div><div class="line"><a name="l02271"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4220c486ce13a2d2efba2c9774dbeb2"> 2271</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4220c486ce13a2d2efba2c9774dbeb2">cli_print_body</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;{</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/da9/structast__sip__cli__context.html">ast_sip_cli_context</a> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = arg;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="preprocessor">#define REGISTRATION_URI_FIELD_LEN  53</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">output_buffer</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">output_buffer</a>, 0, <span class="stringliteral">&quot; %-s/%-*.*s  %-16s  %-16s\n&quot;</span>,</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      <span class="keywordtype">id</span>,</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      (<span class="keywordtype">int</span>) (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2fd82b0bad8784964f5cfdde8ae20401">REGISTRATION_URI_FIELD_LEN</a> - strlen(<span class="keywordtype">id</span>)),</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      (<span class="keywordtype">int</span>) (<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2fd82b0bad8784964f5cfdde8ae20401">REGISTRATION_URI_FIELD_LEN</a> - strlen(<span class="keywordtype">id</span>)),</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>,</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>)</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;         ? <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;registration-&gt;<a class="code" href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, 0)</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;         : <span class="stringliteral">&quot;n/a&quot;</span>,</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      (state ? <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a>) : <span class="stringliteral">&quot;Unregistered&quot;</span>));</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a34e395469afdb136d1b2f305dfb66d0a">show_details</a></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      || (context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a1434305066cbd59d89f4e1c0d93aa0fe">show_details_only_level_0</a> &amp;&amp; context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#ae6e64c2211d834b7ba0eeab24933d46a">indent_level</a> == 0)) {</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;context-&gt;<a class="code" href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">output_buffer</a>, 0, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <a class="code" href="../../d1/d9f/res__pjsip__cli_8h.html#a7e01eb585854a662d1f1875cf4caa055">ast_sip_cli_print_sorcery_objectset</a>(registration, context, 0);</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;}</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment"> * A function pointer to callback needs to be within the</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment"> * module in order to avoid problems with an undefined</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment"> * symbol when the module is loaded.</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02306"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275"> 2306</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275">my_cli_traverse_objects</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;{</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d9f/res__pjsip__cli_8h.html#a57787250de0867bdf4146f57edc1c8d9">ast_sip_cli_traverse_objects</a>(e, cmd, a);</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;}</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div><div class="line"><a name="l02311"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1f14c0e5b7c3a9632df348f9b3f6184"> 2311</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1f14c0e5b7c3a9632df348f9b3f6184">cli_outbound_registration</a>[] = {</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6f2b148fd40115de7dc273247d5f28be">cli_unregister</a>, <span class="stringliteral">&quot;Unregisters outbound registration target&quot;</span>),</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad6abfe953081de3a494b667078d0f2c7">cli_register</a>, <span class="stringliteral">&quot;Registers an outbound registration target&quot;</span>),</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275">my_cli_traverse_objects</a>, <span class="stringliteral">&quot;List PJSIP Registrations&quot;</span>,</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      .<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip list registrations&quot;</span>,</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      .<a class="code" href="../../d6/d47/utils_2frame_8c.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a> = <span class="stringliteral">&quot;Usage: pjsip list registrations [ like &lt;pattern&gt; ]\n&quot;</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="stringliteral">&quot;       List the configured PJSIP Registrations\n&quot;</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            <span class="stringliteral">&quot;       Optional regular expression pattern is used to filter the list.\n&quot;</span>),</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275">my_cli_traverse_objects</a>, <span class="stringliteral">&quot;Show PJSIP Registrations&quot;</span>,</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      .<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip show registrations&quot;</span>,</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      .<a class="code" href="../../d6/d47/utils_2frame_8c.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a> = <span class="stringliteral">&quot;Usage: pjsip show registrations [ like &lt;pattern&gt; ]\n&quot;</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            <span class="stringliteral">&quot;       Show the configured PJSIP Registrations\n&quot;</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="stringliteral">&quot;       Optional regular expression pattern is used to filter the list.\n&quot;</span>),</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275">my_cli_traverse_objects</a>, <span class="stringliteral">&quot;Show PJSIP Registration&quot;</span>,</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      .<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;pjsip show registration&quot;</span>,</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      .<a class="code" href="../../d6/d47/utils_2frame_8c.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a> = <span class="stringliteral">&quot;Usage: pjsip show registration &lt;id&gt;\n&quot;</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;             <span class="stringliteral">&quot;       Show the configured PJSIP Registration\n&quot;</span>),</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;};</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;</div><div class="line"><a name="l02330"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#adcd252e4b3ee6c4adab994080c1a34d7"> 2330</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html">ast_sip_cli_formatter_entry</a> *<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#adcd252e4b3ee6c4adab994080c1a34d7">cli_formatter</a>;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8810bff9344e0b1be67d06b8ed607a51"> 2332</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8810bff9344e0b1be67d06b8ed607a51">auth_observer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;{</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *regs;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *registration_id;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Auths updated. Checking for any outbound registrations that are in permanent rejected state so they can be retried\n&quot;</span>);</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   regs = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>,</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   <span class="keywordflow">if</span> (!regs || <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(regs) == 0) {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(regs);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;   }</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(regs, 0);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;   <span class="keywordflow">for</span> (; (registration = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(registration, -1)) {</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      registration_id = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      state = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a>(registration_id);</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      <span class="keywordflow">if</span> (state &amp;&amp; state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">status</a> == <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a>) {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Trying outbound registration &#39;%s&#39; again\n&quot;</span>, registration_id);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">client_state</a>-&gt;<a class="code" href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>,</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                     <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477">sip_outbound_registration_perform</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(state))) {</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to perform outbound registration on &#39;%s&#39;\n&quot;</span>, registration_id);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;         }</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      }</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;   }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(regs);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;}</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div><div class="line"><a name="l02368"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91cdf105965641c67e971c677b8e2582"> 2368</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91cdf105965641c67e971c677b8e2582">observer_callbacks_auth</a> = {</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   .<a class="code" href="../../d2/ddb/structast__sorcery__observer.html#a1ebad9f5bd6a80f6f666354460b86e0d">loaded</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8810bff9344e0b1be67d06b8ed607a51">auth_observer</a>,</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;};</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae5974ff2b87d863b558b2bfb8092a4a8"> 2372</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae5974ff2b87d863b558b2bfb8092a4a8">check_state</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;{</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;   registration = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>,</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(state-&gt;<a class="code" href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">registration</a>));</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   <span class="keywordflow">if</span> (!registration) {</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <span class="comment">/* This is a dead registration */</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   }</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(registration, -1);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;}</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment"> * \brief Observer to purge dead registration states.</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment"> * \param name Module name owning the sorcery instance.</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment"> * \param sorcery Instance being observed.</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment"> * \param object_type Name of object being observed.</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment"> * \param reloaded Non-zero if the object is being reloaded.</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02399"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afc558cd4f34e2df1be3c691b4620a315"> 2399</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afc558cd4f34e2df1be3c691b4620a315">registration_loaded_observer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *object_type, <span class="keywordtype">int</span> reloaded)</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;{</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *states;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;   <span class="keywordflow">if</span> (strcmp(object_type, <span class="stringliteral">&quot;registration&quot;</span>)) {</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      <span class="comment">/* Not interested */</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   <span class="keywordflow">if</span> (!states) {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      <span class="comment">/* Global container has gone.  Likely shutting down. */</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;   }</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">    * Refresh the current configured registrations. We don&#39;t need to hold</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">    * onto the objects, as the apply handler will cause their states to</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">    * be created appropriately.</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aba6cb640df8f32c52de5727b10051284">get_registrations</a>());</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;   <span class="comment">/* Now to purge dead registrations. */</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(states, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae5974ff2b87d863b558b2bfb8092a4a8">check_state</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(states, -1);</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;}</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a08ceb135e9c4b8c983eecf12fb01cde7"> 2426</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dc/d45/structast__sorcery__instance__observer.html">ast_sorcery_instance_observer</a> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a08ceb135e9c4b8c983eecf12fb01cde7">observer_callbacks_registrations</a> = {</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   .<a class="code" href="../../dc/d45/structast__sorcery__instance__observer.html#a62883356278e945a5c144b8caa76afcb">object_type_loaded</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afc558cd4f34e2df1be3c691b4620a315">registration_loaded_observer</a>,</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;};</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div><div class="line"><a name="l02430"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2ab003b20499c5102299f41756932adc"> 2430</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2ab003b20499c5102299f41756932adc">registration_deleted_observer</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;{</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a> *registration = obj;</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *states;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;   states = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(current_states);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   <span class="keywordflow">if</span> (!states) {</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="comment">/* Global container has gone.  Likely shutting down. */</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   }</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(states, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(registration), <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(states, -1);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;}</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4c0c7887be88ee3edb5385b829098eef"> 2446</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4c0c7887be88ee3edb5385b829098eef">registration_observer</a> = {</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;   .<a class="code" href="../../d2/ddb/structast__sorcery__observer.html#a448fc014efb883eea5ce870dcb4c928b">deleted</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2ab003b20499c5102299f41756932adc">registration_deleted_observer</a>,</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;};</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a824b82f379067264549b5dd7ad72baf1"> 2450</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a824b82f379067264549b5dd7ad72baf1">network_change_stasis_cb</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;{</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   <span class="comment">/* This callback is only concerned with network change messages from the system topic. */</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message) != <a class="code" href="../../d3/df0/stasis__system_8h.html#aa64dd458ea6717cb35efd8656767da61">ast_network_change_type</a>()) {</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   }</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Received network change event\n&quot;</span>);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f">reregister_all</a>();</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;}</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae"> 2461</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;{</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;   <span class="keywordtype">int</span> remaining;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;   network_change_sub = <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(network_change_sub);</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;PJSIPShowRegistrationsOutbound&quot;</span>);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;PJSIPUnregister&quot;</span>);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;PJSIPRegister&quot;</span>);</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(cli_outbound_registration, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_outbound_registration));</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;   <a class="code" href="../../d1/d9f/res__pjsip__cli_8h.html#a2d86edf5478a04305feab4e327a280c8">ast_sip_unregister_cli_formatter</a>(cli_formatter);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;   cli_formatter = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7ba7488bde246be405e2e376f18107ab">ast_sip_unregister_endpoint_identifier</a>(&amp;line_identifier);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;auth&quot;</span>, &amp;observer_callbacks_auth);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a27e4472f54af1cf4a00c936b65c3967b">ast_sorcery_instance_observer_remove</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), &amp;observer_callbacks_registrations);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a7956acdd8675b6d55407ea134fb371cc">ast_sorcery_object_unregister</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>);</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(current_states);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7e419c29ebfb010ca04b7c189c207bbd">ast_sip_transport_monitor_unregister_all</a>(<a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">registration_transport_shutdown_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;   <span class="comment">/* Wait for registration serializers to get destroyed. */</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Waiting for registration transactions to complete for unload.\n&quot;</span>);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;   remaining = <a class="code" href="../../d3/d40/threadpool_8h.html#ab8cbf6d9f2f9964fc6225a73cc287441">ast_serializer_shutdown_group_join</a>(shutdown_group, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a536155006f9be75496538efe377145e6">MAX_UNLOAD_TIMEOUT_TIME</a>);</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;   <span class="keywordflow">if</span> (remaining) {</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">       * NOTE: We probably have a sip_outbound_registration_client_state</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">       * ref leak if the remaining count cannot reach zero after a few</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">       * minutes of trying to unload.</span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unload incomplete.  Could not stop %d outbound registrations.  Try again later.\n&quot;</span>,</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;         remaining);</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;   }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Successful shutdown.\n&quot;</span>);</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(shutdown_group);</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;   shutdown_group = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9"> 2508</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;{</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../df/d3a/res__pjsip__outbound__publish_8c.html#abcc2de32fdf1487d09e70c9af7a942df">new_states</a>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   shutdown_group = <a class="code" href="../../d3/d40/threadpool_8h.html#a26d6e398621cb8b8d2e1066b0393944a">ast_serializer_shutdown_group_alloc</a>();</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   <span class="keywordflow">if</span> (!shutdown_group) {</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   }</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   <span class="comment">/* Create outbound registration states container. */</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   new_states = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a46aa50c37f5c251756d5564d8c96aa38">DEFAULT_STATE_BUCKETS</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af33cd7eda831b14b7720db418206a013">registration_state_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a361792ceb797e0709c07318da3611bf4">registration_state_cmp</a>);</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   <span class="keywordflow">if</span> (!new_states) {</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate registration states container\n&quot;</span>);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   }</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(current_states, new_states);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_states, -1);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">    * Register sorcery object descriptions.</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;res_pjsip_outbound_registration&quot;</span>);</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;config&quot;</span>, <span class="stringliteral">&quot;pjsip.conf,criteria=type=registration&quot;</span>);</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2d9f49ccb117db36a181b412670f4ce7">sip_outbound_registration_alloc</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e42339585acd64891a8d11f1504ea60">sip_outbound_registration_apply</a>)) {</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;   }</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a>, 0, 0);</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;server_uri&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">server_uri</a>));</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;client_uri&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">client_uri</a>));</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;contact_user&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#aff8e665e1528d0e12e446fcbd4d2efa6">contact_user</a>));</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;contact_header_params&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a7568cd99aeb0e7f2919a9c03f1a8d674">contact_header_params</a>));</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;transport&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">transport</a>));</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;outbound_proxy&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">outbound_proxy</a>));</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;expiration&quot;</span>, <span class="stringliteral">&quot;3600&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">expiration</a>));</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;retry_interval&quot;</span>, <span class="stringliteral">&quot;60&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a98068831aa58db10990857613f081058">retry_interval</a>));</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;forbidden_retry_interval&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac18889d3debd7178ac69dba0fc3c2349">forbidden_retry_interval</a>));</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;fatal_retry_interval&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac892ead8a4bfdf8a66380b1183eb17e9">fatal_retry_interval</a>));</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;max_retries&quot;</span>, <span class="stringliteral">&quot;10&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ac471888e0087722725624aead073fda5">max_retries</a>));</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;auth_rejection_permanent&quot;</span>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a12221be4cf0c835b3d35678aa90f09aa">auth_rejection_permanent</a>));</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;outbound_auth&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a52f23503e09ad7f6ab7cce9163b21872">outbound_auth_handler</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a9402eeb89268606c03c23e63df7e32f5">outbound_auths_to_str</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1a3cfb170f6d562dbd938cdd5d059bb">outbound_auths_to_var_list</a>, 0, 0);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;support_path&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a6e527f7843b00df547d2221a7d31ef60">support_path</a>));</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;support_outbound&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2">OPT_YESNO_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#a457b76cddd3ca295da0836c07efd33b3">support_outbound</a>));</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;line&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">line</a>));</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>, <span class="stringliteral">&quot;endpoint&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a>, <a class="code" href="../../df/df4/structsip__outbound__registration.html#aa3522da32a7960126d5eb2ac0c1c6c36">endpoint</a>));</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">    * Register sorcery observers.</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#ae0f5f4c63ea1bd82304c9c1bacd10068">ast_sorcery_instance_observer_add</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(),</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      &amp;observer_callbacks_registrations)</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      || <a class="code" href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;auth&quot;</span>,</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;         &amp;observer_callbacks_auth)</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      || <a class="code" href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>,</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;         &amp;registration_observer)) {</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to register observers.\n&quot;</span>);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;   }</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   <span class="comment">/* Register how this module identifies endpoints. */</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a66822f0bda04ca112f8f1d0b29e9f4a4">ast_sip_register_endpoint_identifier</a>(&amp;line_identifier);</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;   <span class="comment">/* Register CLI commands. */</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;   cli_formatter = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html">ast_sip_cli_formatter_entry</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;   <span class="keywordflow">if</span> (!cli_formatter) {</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate memory for cli formatter\n&quot;</span>);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;   }</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;registration&quot;</span>;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a0053a651dbc1962d77b2603ab94f124c">print_header</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2b763a2a08e7882b81e5dbd3a71c3e01">cli_print_header</a>;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aa3690b518c6016080aef35624fa64cc6">print_body</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4220c486ce13a2d2efba2c9774dbeb2">cli_print_body</a>;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aaa9ad2d95661da110c0e429950a220f6">get_container</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac1601540f1d2be4be34fb53b8dd96f70">cli_get_container</a>;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a14a5962933d8c6c2bb185ce99345da34">iterate</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c4344947bef0dc3813ff04482d4ec34">cli_iterator</a>;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a328348f7f0793218f7891b2e6196ca25">get_id</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   cli_formatter-&gt;<a class="code" href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aebc646bb4393e15f08463b0d565c7ef8">retrieve_by_id</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0c343ef50cc7a1d66c0569d15d285941">cli_retrieve_by_id</a>;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;   <a class="code" href="../../d1/d9f/res__pjsip__cli_8h.html#ada1855e329ba30824743e9ad30d2fe19">ast_sip_register_cli_formatter</a>(cli_formatter);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(cli_outbound_registration, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_outbound_registration));</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;   <span class="comment">/* Register AMI actions. */</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;PJSIPUnregister&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a62335a29dc5fc2ae927d923a1a372938">ami_unregister</a>);</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;PJSIPRegister&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5cd5b408e27b27e519386044af259073">ami_register</a>);</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;PJSIPShowRegistrationsOutbound&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a05f4b1cd543ee5eba99f76928df91f68">ami_show_outbound_registrations</a>);</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;   <span class="comment">/* Clear any previous statsd gauges in case we weren&#39;t shutdown cleanly */</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#ab28a718bc4cbc0a95c67d16289258b7c">ast_statsd_log</a>(<span class="stringliteral">&quot;PJSIP.registrations.count&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, 0);</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#ab28a718bc4cbc0a95c67d16289258b7c">ast_statsd_log</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.Registered&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, 0);</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#ab28a718bc4cbc0a95c67d16289258b7c">ast_statsd_log</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.Unregistered&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, 0);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;   <a class="code" href="../../d4/d67/statsd_8h.html#ab28a718bc4cbc0a95c67d16289258b7c">ast_statsd_log</a>(<span class="stringliteral">&quot;PJSIP.registrations.state.Rejected&quot;</span>, <a class="code" href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a>, 0);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   <span class="comment">/* Load configuration objects */</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a6f052c6dd5e388e519725406a6af5215">ast_sorcery_load_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>);</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;   network_change_sub = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../d3/df0/stasis__system_8h.html#a196188f45631aed77434c898ed322ce6">ast_system_topic</a>(),</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a824b82f379067264549b5dd7ad72baf1">network_change_stasis_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(network_change_sub, <a class="code" href="../../d3/df0/stasis__system_8h.html#aa64dd458ea6717cb35efd8656767da61">ast_network_change_type</a>());</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(network_change_sub, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;}</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;</div><div class="line"><a name="l02614"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527"> 2614</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;{</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;registration&quot;</span>);</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;}</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a>(<a class="code" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a>, <span class="stringliteral">&quot;PJSIP Outbound Registration Support&quot;</span>,</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;   .support_level = <a class="code" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>,</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;   .load = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>,</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;   .<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>,</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;   .unload = <a class="code" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>,</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;   .load_pri = <a class="code" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a08d902290b0d6cbffd8e607d5e399a06">AST_MODPRI_APP_DEPEND</a>,</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   .requires = <span class="stringliteral">&quot;res_pjsip&quot;</span>,</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;   .optional_modules = <span class="stringliteral">&quot;res_statsd&quot;</span>,</div><div class="line"><a name="l02628"></a><span class="lineno"><a class="line" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae"> 2628</a></span>&#160;);</div><div class="ttc" id="structregistrations_html"><div class="ttname"><a href="../../df/d9e/structregistrations.html">registrations</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00656">chan_iax2.c:656</a></div></div>
<div class="ttc" id="structast__sip__cli__context_html_a94df2cb63c128aa62d70fedeadd02ad2"><div class="ttname"><a href="../../d6/da9/structast__sip__cli__context.html#a94df2cb63c128aa62d70fedeadd02ad2">ast_sip_cli_context::output_buffer</a></div><div class="ttdeci">struct ast_str * output_buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00036">res_pjsip_cli.h:36</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ac268c0a8272ec11e73269392507fb1a6"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a></div><div class="ttdeci">#define AST_THREADSTORAGE(name)</div><div class="ttdoc">Define a thread storage variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00084">threadstorage.h:84</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a6e527f7843b00df547d2221a7d31ef60"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a6e527f7843b00df547d2221a7d31ef60">sip_outbound_registration::support_path</a></div><div class="ttdeci">unsigned int support_path</div><div class="ttdoc">Whether Path support is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00337">res_pjsip_outbound_registration.c:337</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_aaa9ad2d95661da110c0e429950a220f6"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aaa9ad2d95661da110c0e429950a220f6">ast_sip_cli_formatter_entry::get_container</a></div><div class="ttdeci">struct ao2_container *(* get_container)(const char *regex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00064">res_pjsip_cli.h:64</a></div></div>
<div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a5295e9b3cd4296ca5425b22ade90c75a"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a5295e9b3cd4296ca5425b22ade90c75a">sip_outbound_registration_client_state::auth_attempted</a></div><div class="ttdeci">unsigned int auth_attempted</div><div class="ttdoc">Non-zero if we have attempted sending a REGISTER with authentication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00390">res_pjsip_outbound_registration.c:390</a></div></div>
<div class="ttc" id="pbx_8h_html_aa4e9618aa036a586af7d7663afd9b507"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a></div><div class="ttdeci">int ast_func_read(struct ast_channel *chan, const char *function, char *workspace, size_t len)</div><div class="ttdoc">executes a read operation on a function </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00599">pbx_functions.c:599</a></div></div>
<div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a8e49bc0a293fa0b4b8632ed71cba31fb"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e49bc0a293fa0b4b8632ed71cba31fb">update_client_state_status</a></div><div class="ttdeci">static void update_client_state_status(struct sip_outbound_registration_client_state *client_state, enum sip_outbound_registration_status status)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00743">res_pjsip_outbound_registration.c:743</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="threadpool_8h_html"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html">threadpool.h</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a8eedbfa3d0832f502e16d1fb2b26ee02"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8eedbfa3d0832f502e16d1fb2b26ee02">registration_transport_monitor_setup</a></div><div class="ttdeci">static void registration_transport_monitor_setup(pjsip_transport *transport, const char *registration_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00962">res_pjsip_outbound_registration.c:962</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a0c343ef50cc7a1d66c0569d15d285941"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0c343ef50cc7a1d66c0569d15d285941">cli_retrieve_by_id</a></div><div class="ttdeci">static void * cli_retrieve_by_id(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02242">res_pjsip_outbound_registration.c:2242</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ab47623e207bf2cdd0edfa613d91894e5"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a></div><div class="ttdeci">void ast_taskprocessor_build_name(char *buf, unsigned int size, const char *format,...)</div><div class="ttdoc">Build a taskprocessor name with a sequence number on the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01295">taskprocessor.c:1295</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae2a70501bd77f6a45cfac6cd343dd7fa"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae2a70501bd77f6a45cfac6cd343dd7fa">ast_sip_auth_vector_init</a></div><div class="ttdeci">int ast_sip_auth_vector_init(struct ast_sip_auth_vector *vector, const char *auth_names)</div><div class="ttdoc">Initialize an auth vector with the configured values. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l00267">pjsip_configuration.c:267</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac48fbe3a83520ca92ebde956e2c5c5d4"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac48fbe3a83520ca92ebde956e2c5c5d4">sip_outbound_registration_state_alloc</a></div><div class="ttdeci">static struct sip_outbound_registration_state * sip_outbound_registration_state_alloc(struct sip_outbound_registration *registration)</div><div class="ttdoc">Allocator function for registration state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01314">res_pjsip_outbound_registration.c:1314</a></div></div>
<div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a824b82f379067264549b5dd7ad72baf1"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a824b82f379067264549b5dd7ad72baf1">network_change_stasis_cb</a></div><div class="ttdeci">static void network_change_stasis_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02450">res_pjsip_outbound_registration.c:2450</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a536155006f9be75496538efe377145e6"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a536155006f9be75496538efe377145e6">MAX_UNLOAD_TIMEOUT_TIME</a></div><div class="ttdeci">#define MAX_UNLOAD_TIMEOUT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00406">res_pjsip_outbound_registration.c:406</a></div></div>
<div class="ttc" id="structsip__ami__outbound_html_a530877ae593be107412b1b655429be5f"><div class="ttname"><a href="../../d4/d1b/structsip__ami__outbound.html#a530877ae593be107412b1b655429be5f">sip_ami_outbound::not_registered</a></div><div class="ttdeci">int not_registered</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02131">res_pjsip_outbound_registration.c:2131</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html">ast_sip_cli_formatter_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00052">res_pjsip_cli.h:52</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="structast__sorcery__observer_html_a448fc014efb883eea5ce870dcb4c928b"><div class="ttname"><a href="../../d2/ddb/structast__sorcery__observer.html#a448fc014efb883eea5ce870dcb4c928b">ast_sorcery_observer::deleted</a></div><div class="ttdeci">void(* deleted)(const void *object)</div><div class="ttdoc">Callback for when an object is deleted. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00340">sorcery.h:340</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a7ccb361420d2a3f4189411fc1141cac9"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7ccb361420d2a3f4189411fc1141cac9">fetch_google_access_token</a></div><div class="ttdeci">static const char * fetch_google_access_token(const struct ast_sip_auth *auth)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01485">res_pjsip_outbound_registration.c:1485</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a0b63fcdb0e736b698602fbcbe0ea591d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0b63fcdb0e736b698602fbcbe0ea591d">cli_complete_registration</a></div><div class="ttdeci">static char * cli_complete_registration(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01924">res_pjsip_outbound_registration.c:1924</a></div></div>
<div class="ttc" id="module_8h_html_ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15"><div class="ttname"><a href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00121">module.h:121</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_ac471888e0087722725624aead073fda5"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#ac471888e0087722725624aead073fda5">sip_outbound_registration::max_retries</a></div><div class="ttdeci">unsigned int max_retries</div><div class="ttdoc">Maximum number of retries permitted. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00331">res_pjsip_outbound_registration.c:331</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_adea5390496e5477192d86f340d512d04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a></div><div class="ttdeci">void ast_variables_destroy(struct ast_variable *var)</div><div class="ttdoc">Free variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01263">extconf.c:1263</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a4e8ff91b48d6fcdfb7f0265d59bdd979"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a4e8ff91b48d6fcdfb7f0265d59bdd979">ast_sip_auth::oauth_secret</a></div><div class="ttdeci">const ast_string_field oauth_secret</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00460">res_pjsip.h:460</a></div></div>
<div class="ttc" id="structast__json__error_html_a9b20e804a129dc6c80e6df3c4559dc2b"><div class="ttname"><a href="../../d0/d96/structast__json__error.html#a9b20e804a129dc6c80e6df3c4559dc2b">ast_json_error::text</a></div><div class="ttdeci">char text[AST_JSON_ERROR_TEXT_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00837">json.h:837</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac7801c700ee3ddfbc8adf07e8faa6db8"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac7801c700ee3ddfbc8adf07e8faa6db8">schedule_registration</a></div><div class="ttdeci">static void schedule_registration(struct sip_outbound_registration_client_state *client_state, unsigned int seconds)</div><div class="ttdoc">Helper function which sets up the timer to re-register in a specific amount of time. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00721">res_pjsip_outbound_registration.c:721</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="sorcery_8h_html_ae0f5f4c63ea1bd82304c9c1bacd10068"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ae0f5f4c63ea1bd82304c9c1bacd10068">ast_sorcery_instance_observer_add</a></div><div class="ttdeci">int ast_sorcery_instance_observer_add(struct ast_sorcery *sorcery, const struct ast_sorcery_instance_observer *callbacks)</div><div class="ttdoc">Add an observer to a sorcery instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00520">sorcery.c:520</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a457b76cddd3ca295da0836c07efd33b3"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a457b76cddd3ca295da0836c07efd33b3">sip_outbound_registration_client_state::support_outbound</a></div><div class="ttdeci">unsigned int support_outbound</div><div class="ttdoc">Determines whether SIP Outbound support should be advertised. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00380">res_pjsip_outbound_registration.c:380</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2a3c266bdb3a70e7f63425b91d16a275"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2a3c266bdb3a70e7f63425b91d16a275">my_cli_traverse_objects</a></div><div class="ttdeci">static char * my_cli_traverse_objects(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02306">res_pjsip_outbound_registration.c:2306</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__sip__ami_html_ac0506a88d121327118c7346baa303a9e"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#ac0506a88d121327118c7346baa303a9e">ast_sip_ami::m</a></div><div class="ttdeci">const struct message * m</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02741">res_pjsip.h:2741</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structregistration__response_html_ae33b6a64fd188d8c0b08aa593e229140"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#ae33b6a64fd188d8c0b08aa593e229140">registration_response::old_request</a></div><div class="ttdeci">pjsip_tx_data * old_request</div><div class="ttdoc">Request for which the response was received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00844">res_pjsip_outbound_registration.c:844</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="res__pjsip__private_8h_html"><div class="ttname"><a href="../../d7/d5c/res__pjsip__private_8h.html">res_pjsip_private.h</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac5342f99fec726a94fb4b713e43eec12"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac5342f99fec726a94fb4b713e43eec12">ast_sip_auth_vector_destroy</a></div><div class="ttdeci">void ast_sip_auth_vector_destroy(struct ast_sip_auth_vector *vector)</div><div class="ttdoc">Free contents of an auth vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l00249">pjsip_configuration.c:249</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aaee14820d45bd0be318822580b5a8b59"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aaee14820d45bd0be318822580b5a8b59">ast_sip_transport_monitor_register</a></div><div class="ttdeci">enum ast_transport_monitor_reg ast_sip_transport_monitor_register(pjsip_transport *transport, ast_transport_monitor_shutdown_cb cb, void *ao2_data)</div><div class="ttdoc">Register a reliable transport shutdown monitor callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00306">pjsip_transport_events.c:306</a></div></div>
<div class="ttc" id="stasis__system_8h_html"><div class="ttname"><a href="../../d3/df0/stasis__system_8h.html">stasis_system.h</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ad1be3771574c5e5853fcdabe099f931f"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ad1be3771574c5e5853fcdabe099f931f">sip_outbound_registration_client_state::status</a></div><div class="ttdeci">enum sip_outbound_registration_status status</div><div class="ttdoc">Current state of this registration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00345">res_pjsip_outbound_registration.c:345</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aa00e847f05d7351e625c30d9cc71aa93"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa00e847f05d7351e625c30d9cc71aa93">line_identifier</a></div><div class="ttdeci">static struct ast_sip_endpoint_identifier line_identifier</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00539">res_pjsip_outbound_registration.c:539</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="threadpool_8h_html_a26d6e398621cb8b8d2e1066b0393944a"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#a26d6e398621cb8b8d2e1066b0393944a">ast_serializer_shutdown_group_alloc</a></div><div class="ttdeci">struct ast_serializer_shutdown_group * ast_serializer_shutdown_group_alloc(void)</div><div class="ttdoc">Create a serializer group shutdown control object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01229">threadpool.c:1229</a></div></div>
<div class="ttc" id="stasis__system_8h_html_aa64dd458ea6717cb35efd8656767da61"><div class="ttname"><a href="../../d3/df0/stasis__system_8h.html#aa64dd458ea6717cb35efd8656767da61">ast_network_change_type</a></div><div class="ttdeci">struct stasis_message_type * ast_network_change_type(void)</div><div class="ttdoc">A stasis_message_type for network changes. </div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a8e42339585acd64891a8d11f1504ea60"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8e42339585acd64891a8d11f1504ea60">sip_outbound_registration_apply</a></div><div class="ttdeci">static int sip_outbound_registration_apply(const struct ast_sorcery *sorcery, void *obj)</div><div class="ttdoc">Apply function which finds or allocates a state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01744">res_pjsip_outbound_registration.c:1744</a></div></div>
<div class="ttc" id="structast__sip__ami_html"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html">ast_sip_ami</a></div><div class="ttdoc">AMI variable container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02737">res_pjsip.h:2737</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="statsd_8h_html"><div class="ttname"><a href="../../d4/d67/statsd_8h.html">statsd.h</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_ada0741a2ed763300a150a4611551c2c3"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#ada0741a2ed763300a150a4611551c2c3">sip_outbound_registration::client_uri</a></div><div class="ttdeci">const ast_string_field client_uri</div><div class="ttdoc">URI for the AOR. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="structstasis__subscription_html"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00681">stasis.c:681</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae885353b1f44a15a8a828864561de00c"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae885353b1f44a15a8a828864561de00c">ast_sip_transport_state_set_preferred_identity</a></div><div class="ttdeci">int ast_sip_transport_state_set_preferred_identity(const char *transport_name, const char *identity)</div><div class="ttdoc">Sets the P-Preferred-Identity on a child transport. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00242">config_transport.c:242</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_afc558cd4f34e2df1be3c691b4620a315"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afc558cd4f34e2df1be3c691b4620a315">registration_loaded_observer</a></div><div class="ttdeci">static void registration_loaded_observer(const char *name, const struct ast_sorcery *sorcery, const char *object_type, int reloaded)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02399">res_pjsip_outbound_registration.c:2399</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a></div><div class="ttdoc">Perform no matching, return all objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00123">sorcery.h:123</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ac18889d3debd7178ac69dba0fc3c2349"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ac18889d3debd7178ac69dba0fc3c2349">sip_outbound_registration_client_state::forbidden_retry_interval</a></div><div class="ttdeci">unsigned int forbidden_retry_interval</div><div class="ttdoc">Interval at which retries should occur for permanent responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00372">res_pjsip_outbound_registration.c:372</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a110fd2cc81e44ec29e95e193adafea46"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a110fd2cc81e44ec29e95e193adafea46">save_response_fields_to_transport</a></div><div class="ttdeci">static void save_response_fields_to_transport(struct registration_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00986">res_pjsip_outbound_registration.c:986</a></div></div>
<div class="ttc" id="sorcery_8h_html_a83eba565782cb769634180b88db29d45"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a83eba565782cb769634180b88db29d45">ast_sorcery_object_id_compare</a></div><div class="ttdeci">int ast_sorcery_object_id_compare(void *obj, void *arg, int flags)</div><div class="ttdoc">ao2 object comparator based on sorcery id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02459">sorcery.c:2459</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_abe7962a7f3bb90f89e2cf66b6d390659"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abe7962a7f3bb90f89e2cf66b6d390659">network_change_sub</a></div><div class="ttdeci">static struct stasis_subscription * network_change_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00416">res_pjsip_outbound_registration.c:416</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_acef2f236d7d6e9e799545af3a9a27a19"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#acef2f236d7d6e9e799545af3a9a27a19">sip_outbound_registration_client_state::timer</a></div><div class="ttdeci">pj_timer_entry timer</div><div class="ttdoc">Timer entry for retrying on temporal responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00362">res_pjsip_outbound_registration.c:362</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="structast__sorcery_html"><div class="ttname"><a href="../../d2/d88/structast__sorcery.html">ast_sorcery</a></div><div class="ttdoc">Full structure for sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00230">sorcery.c:230</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_afe00161d4986dcff61225bf18e1ead6d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#afe00161d4986dcff61225bf18e1ead6d">ami_outbound_registration_task</a></div><div class="ttdeci">static int ami_outbound_registration_task(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02135">res_pjsip_outbound_registration.c:2135</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_a14a5962933d8c6c2bb185ce99345da34"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a14a5962933d8c6c2bb185ce99345da34">ast_sip_cli_formatter_entry::iterate</a></div><div class="ttdeci">int(* iterate)(void *container, ao2_callback_fn callback, void *args)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00066">res_pjsip_cli.h:66</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a></div><div class="ttdoc">Type for a default handler that should do nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00399">config_options.h:399</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a9f4106ac09bd7c29f7fd3e4165b960ca"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a9f4106ac09bd7c29f7fd3e4165b960ca">sip_outbound_registration::server_uri</a></div><div class="ttdeci">const ast_string_field server_uri</div><div class="ttdoc">URI for the registrar. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a91cdf105965641c67e971c677b8e2582"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91cdf105965641c67e971c677b8e2582">observer_callbacks_auth</a></div><div class="ttdeci">static const struct ast_sorcery_observer observer_callbacks_auth</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02368">res_pjsip_outbound_registration.c:2368</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_af33cd7eda831b14b7720db418206a013"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af33cd7eda831b14b7720db418206a013">registration_state_hash</a></div><div class="ttdeci">static int registration_state_hash(const void *obj, const int flags)</div><div class="ttdoc">hashing function for state objects </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00419">res_pjsip_outbound_registration.c:419</a></div></div>
<div class="ttc" id="structsip__outbound__registration__state_html"><div class="ttname"><a href="../../d3/d3f/structsip__outbound__registration__state.html">sip_outbound_registration_state</a></div><div class="ttdoc">Outbound registration state information (persists for lifetime that registration should exist) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00398">res_pjsip_outbound_registration.c:398</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a8380e4bb4249f1a7d4bef09985bf73b5"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8380e4bb4249f1a7d4bef09985bf73b5">handle_client_state_destruction</a></div><div class="ttdeci">static int handle_client_state_destruction(void *data)</div><div class="ttdoc">Callback function for unregistering (potentially) and destroying state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00772">res_pjsip_outbound_registration.c:772</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a1b56eeceac401ddb81ce4a7db511a526"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1b56eeceac401ddb81ce4a7db511a526">queue_unregister</a></div><div class="ttdeci">static int queue_unregister(struct sip_outbound_registration_state *state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01882">res_pjsip_outbound_registration.c:1882</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a1c6e48938c599616c6e893017f183e0a"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a1c6e48938c599616c6e893017f183e0a">sip_outbound_registration::expiration</a></div><div class="ttdeci">unsigned int expiration</div><div class="ttdoc">Requested expiration time. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00321">res_pjsip_outbound_registration.c:321</a></div></div>
<div class="ttc" id="stringfields_8h_html_a061580e89c55282a7140fa3fdfd52b6d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a></div><div class="ttdeci">#define AST_DECLARE_STRING_FIELDS(field_list)</div><div class="ttdoc">Declare the fields needed in a structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00337">stringfields.h:337</a></div></div>
<div class="ttc" id="sorcery_8h_html_a9db9fd1cf5ec967af2ad3a63c27e0233"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a></div><div class="ttdeci">#define ast_sorcery_apply_config(sorcery, name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00456">sorcery.h:456</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a></div><div class="ttdoc">Return all matching objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00120">sorcery.h:120</a></div></div>
<div class="ttc" id="json_8h_html_adca5179982d1f48df7127c123f15ce74"><div class="ttname"><a href="../../d4/d05/json_8h.html#adca5179982d1f48df7127c123f15ce74">ast_json_load_string</a></div><div class="ttdeci">struct ast_json * ast_json_load_string(const char *input, struct ast_json_error *error)</div><div class="ttdoc">Parse null terminated string into a JSON object or array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00546">json.c:546</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html">sip_outbound_registration_client_state</a></div><div class="ttdoc">Outbound registration client state information (persists for lifetime of regc) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00343">res_pjsip_outbound_registration.c:343</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a0f735a1c6c2ff0a2f29a96d6631a3e82"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0f735a1c6c2ff0a2f29a96d6631a3e82">line_identify</a></div><div class="ttdeci">static struct ast_sip_endpoint * line_identify(pjsip_rx_data *rdata)</div><div class="ttdoc">Endpoint identifier which uses the &amp;#39;line&amp;#39; parameter to establish a relationship to an outgoing regist...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00512">res_pjsip_outbound_registration.c:512</a></div></div>
<div class="ttc" id="test__func__file_8c_html_a7df83d295429a2562396f1ec127a46c0"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a></div><div class="ttdeci">const char * args</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00046">test_func_file.c:46</a></div></div>
<div class="ttc" id="structast__sip__endpoint__identifier_html_a70e9eb29aa44b8d1b8e2e158b97bb11c"><div class="ttname"><a href="../../d0/d97/structast__sip__endpoint__identifier.html#a70e9eb29aa44b8d1b8e2e158b97bb11c">ast_sip_endpoint_identifier::identify_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint *(* identify_endpoint)(pjsip_rx_data *rdata)</div><div class="ttdoc">Callback used to identify the source of a message. See ast_sip_identify_endpoint for more details...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00998">res_pjsip.h:998</a></div></div>
<div class="ttc" id="structast__sip__cli__context_html_a34e395469afdb136d1b2f305dfb66d0a"><div class="ttname"><a href="../../d6/da9/structast__sip__cli__context.html#a34e395469afdb136d1b2f305dfb66d0a">ast_sip_cli_context::show_details</a></div><div class="ttdeci">unsigned show_details</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00042">res_pjsip_cli.h:42</a></div></div>
<div class="ttc" id="structast__sip__cli__context_html"><div class="ttname"><a href="../../d6/da9/structast__sip__cli__context.html">ast_sip_cli_context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00034">res_pjsip_cli.h:34</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_abd6ac29370652d224cd0e2f60be2ea28"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abd6ac29370652d224cd0e2f60be2ea28">OUTBOUND_NAME</a></div><div class="ttdeci">static pj_str_t OUTBOUND_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00554">res_pjsip_outbound_registration.c:554</a></div></div>
<div class="ttc" id="threadstorage_8h_html"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html">threadstorage.h</a></div><div class="ttdoc">Definitions to aid in the use of thread local storage. </div></div>
<div class="ttc" id="sorcery_8h_html_a6f052c6dd5e388e519725406a6af5215"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6f052c6dd5e388e519725406a6af5215">ast_sorcery_load_object</a></div><div class="ttdeci">void ast_sorcery_load_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to load persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01393">sorcery.c:1393</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aa1ae1ce6947f3f39fd07bd4c26b1183d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1ae1ce6947f3f39fd07bd4c26b1183d">register_callback_invoked</a></div><div class="ttdeci">static struct ast_threadstorage register_callback_invoked</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00245">res_pjsip_outbound_registration.c:245</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ad6abfe953081de3a494b667078d0f2c7"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad6abfe953081de3a494b667078d0f2c7">cli_register</a></div><div class="ttdeci">static char * cli_register(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02011">res_pjsip_outbound_registration.c:2011</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_adf4c5a237767eb6db5b1db41ccdfc689"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_MAX_NAME</div><div class="ttdoc">Suggested maximum taskprocessor name length (less null terminator). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00060">taskprocessor.h:60</a></div></div>
<div class="ttc" id="threadpool_8h_html_ab8cbf6d9f2f9964fc6225a73cc287441"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#ab8cbf6d9f2f9964fc6225a73cc287441">ast_serializer_shutdown_group_join</a></div><div class="ttdeci">int ast_serializer_shutdown_group_join(struct ast_serializer_shutdown_group *shutdown_group, int timeout)</div><div class="ttdoc">Wait for the serializers in the group to shutdown with timeout. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01241">threadpool.c:1241</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gab8c82412fe0432a91d5c7985cfdf9b59"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a></div><div class="ttdeci">int ast_sip_push_task_wait_servant(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to SIP servants and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05204">res_pjsip.c:5204</a></div></div>
<div class="ttc" id="logger_8h_html_a6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00241">logger.h:241</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a52f23503e09ad7f6ab7cce9163b21872"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a52f23503e09ad7f6ab7cce9163b21872">outbound_auth_handler</a></div><div class="ttdeci">static int outbound_auth_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01828">res_pjsip_outbound_registration.c:1828</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2fd82b0bad8784964f5cfdde8ae20401"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2fd82b0bad8784964f5cfdde8ae20401">REGISTRATION_URI_FIELD_LEN</a></div><div class="ttdeci">#define REGISTRATION_URI_FIELD_LEN</div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a6a10f37afeb1858bb37a5d9243d64de0"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a6a10f37afeb1858bb37a5d9243d64de0">sip_outbound_registration_client_state::line</a></div><div class="ttdeci">char line[LINE_PARAMETER_SIZE]</div><div class="ttdoc">Optional line parameter placed into Contact. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00364">res_pjsip_outbound_registration.c:364</a></div></div>
<div class="ttc" id="structregistration__response_html"><div class="ttname"><a href="../../da/d4c/structregistration__response.html">registration_response</a></div><div class="ttdoc">Structure for registration response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00832">res_pjsip_outbound_registration.c:832</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ac471888e0087722725624aead073fda5"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ac471888e0087722725624aead073fda5">sip_outbound_registration_client_state::max_retries</a></div><div class="ttdeci">unsigned int max_retries</div><div class="ttdoc">Maximum number of retries permitted. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00368">res_pjsip_outbound_registration.c:368</a></div></div>
<div class="ttc" id="structast__json__error_html"><div class="ttname"><a href="../../d0/d96/structast__json__error.html">ast_json_error</a></div><div class="ttdoc">JSON parsing error information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00829">json.h:829</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_af28a67b870d8865247fe2e14dcb03a07"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af28a67b870d8865247fe2e14dcb03a07">sip_outbound_registration_response_cb</a></div><div class="ttdeci">static void sip_outbound_registration_response_cb(struct pjsip_regc_cbparam *param)</div><div class="ttdoc">Callback function for outbound registration client. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01207">res_pjsip_outbound_registration.c:1207</a></div></div>
<div class="ttc" id="res__pjsip__cli_8h_html_a57787250de0867bdf4146f57edc1c8d9"><div class="ttname"><a href="../../d1/d9f/res__pjsip__cli_8h.html#a57787250de0867bdf4146f57edc1c8d9">ast_sip_cli_traverse_objects</a></div><div class="ttdeci">char * ast_sip_cli_traverse_objects(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df0/pjsip__cli_8c_source.html#l00109">pjsip_cli.c:109</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a457b76cddd3ca295da0836c07efd33b3"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a457b76cddd3ca295da0836c07efd33b3">sip_outbound_registration::support_outbound</a></div><div class="ttdeci">unsigned int support_outbound</div><div class="ttdoc">Whether Outbound support is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00339">res_pjsip_outbound_registration.c:339</a></div></div>
<div class="ttc" id="structast__cli__args_html_a2a7a1aa13a4f14075411123a4495593c"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">ast_cli_args::line</a></div><div class="ttdeci">const char * line</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00162">cli.h:162</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aba6cb640df8f32c52de5727b10051284"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aba6cb640df8f32c52de5727b10051284">get_registrations</a></div><div class="ttdeci">static struct ao2_container * get_registrations(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00481">res_pjsip_outbound_registration.c:481</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_aff8e665e1528d0e12e446fcbd4d2efa6"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#aff8e665e1528d0e12e446fcbd4d2efa6">sip_outbound_registration::contact_user</a></div><div class="ttdeci">const ast_string_field contact_user</div><div class="ttdoc">Optional user for contact header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a7452bb47baa9a7b2d159cc4bda456f17"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7452bb47baa9a7b2d159cc4bda456f17">get_uri_option_line</a></div><div class="ttdeci">static struct pjsip_param * get_uri_option_line(const void *uri)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00499">res_pjsip_outbound_registration.c:499</a></div></div>
<div class="ttc" id="sorcery_8h_html_a57392a9d5ccf946ae992af2ad83cf7b0"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a57392a9d5ccf946ae992af2ad83cf7b0">ast_sorcery_retrieve_by_regex</a></div><div class="ttdeci">struct ao2_container * ast_sorcery_retrieve_by_regex(const struct ast_sorcery *sorcery, const char *type, const char *regex)</div><div class="ttdoc">Retrieve multiple objects using a regular expression on their id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01949">sorcery.c:1949</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461b"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461b">sip_outbound_registration_status</a></div><div class="ttdeci">sip_outbound_registration_status</div><div class="ttdoc">Various states that an outbound registration may be in. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00254">res_pjsip_outbound_registration.c:254</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a4b8582884dc99ca78481aaf09d2a8aaa"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a4b8582884dc99ca78481aaf09d2a8aaa">ast_sip_auth::oauth_clientid</a></div><div class="ttdeci">const ast_string_field oauth_clientid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00458">res_pjsip.h:458</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="statsd_8h_html_a6bd3bc2a7663784200d00e63f3eceeef"><div class="ttname"><a href="../../d4/d67/statsd_8h.html#a6bd3bc2a7663784200d00e63f3eceeef">ast_statsd_log_string</a></div><div class="ttdeci">void ast_statsd_log_string(const char *metric_name, const char *metric_type, const char *value, double sample_rate)</div><div class="ttdoc">Send a stat to the configured statsd server. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0c/res__statsd_8c_source.html#l00111">res_statsd.c:111</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a5daffcecdec4b287e88ce65d8d768487"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5daffcecdec4b287e88ce65d8d768487">PATH_NAME</a></div><div class="ttdeci">static pj_str_t PATH_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00553">res_pjsip_outbound_registration.c:553</a></div></div>
<div class="ttc" id="res__pjsip__cli_8h_html_ada1855e329ba30824743e9ad30d2fe19"><div class="ttname"><a href="../../d1/d9f/res__pjsip__cli_8h.html#ada1855e329ba30824743e9ad30d2fe19">ast_sip_register_cli_formatter</a></div><div class="ttdeci">int ast_sip_register_cli_formatter(struct ast_sip_cli_formatter_entry *formatter)</div><div class="ttdoc">Registers a CLI formatter. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df0/pjsip__cli_8c_source.html#l00310">pjsip_cli.c:310</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_afa22bc164a1c4108006f96822318ff14"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afa22bc164a1c4108006f96822318ff14">ast_sip_failover_request</a></div><div class="ttdeci">int ast_sip_failover_request(pjsip_tx_data *tdata)</div><div class="ttdoc">Set a request to use the next value in the list of resolved addresses. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04871">res_pjsip.c:4871</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_abc58ecbb693180f1556ee7ae939f3774"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#abc58ecbb693180f1556ee7ae939f3774">sip_outbound_registration_destroy</a></div><div class="ttdeci">static void sip_outbound_registration_destroy(void *obj)</div><div class="ttdoc">Destructor function for registration information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01363">res_pjsip_outbound_registration.c:1363</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a98068831aa58db10990857613f081058"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a98068831aa58db10990857613f081058">sip_outbound_registration_client_state::retry_interval</a></div><div class="ttdeci">unsigned int retry_interval</div><div class="ttdoc">Interval at which retries should occur for temporal responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00370">res_pjsip_outbound_registration.c:370</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a4c0c7887be88ee3edb5385b829098eef"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4c0c7887be88ee3edb5385b829098eef">registration_observer</a></div><div class="ttdeci">static const struct ast_sorcery_observer registration_observer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02446">res_pjsip_outbound_registration.c:2446</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a15ae1ab81b53febdf7011a323e59f3e0"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a15ae1ab81b53febdf7011a323e59f3e0">unregister_all</a></div><div class="ttdeci">static void unregister_all(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01904">res_pjsip_outbound_registration.c:1904</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ab40ad6fcfeefab3befa32ab479be04a2">OPT_YESNO_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00481">config_options.h:481</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a66896b81e18e555d87fcfc8d13c23817"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66896b81e18e555d87fcfc8d13c23817">registration_transport_shutdown_cb</a></div><div class="ttdeci">static void registration_transport_shutdown_cb(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00939">res_pjsip_outbound_registration.c:939</a></div></div>
<div class="ttc" id="structsip__ami__outbound_html_a0ffa3e0c7bc8dd5d68b09dd58c0af1d4"><div class="ttname"><a href="../../d4/d1b/structsip__ami__outbound.html#a0ffa3e0c7bc8dd5d68b09dd58c0af1d4">sip_ami_outbound::ami</a></div><div class="ttdeci">struct ast_sip_ami * ami</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02129">res_pjsip_outbound_registration.c:2129</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ae8a2ebf0c1bb1508413d2d4615b64477"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae8a2ebf0c1bb1508413d2d4615b64477">sip_outbound_registration_perform</a></div><div class="ttdeci">static int sip_outbound_registration_perform(void *data)</div><div class="ttdoc">Helper function which performs a single registration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01708">res_pjsip_outbound_registration.c:1708</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a72f43e82cb97ea0b744a4a0ba7ff0a43"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a72f43e82cb97ea0b744a4a0ba7ff0a43">ast_sip_retrieve_auths</a></div><div class="ttdeci">int ast_sip_retrieve_auths(const struct ast_sip_auth_vector *auths, struct ast_sip_auth **out)</div><div class="ttdoc">Retrieve relevant SIP auth structures from sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02360">pjsip_configuration.c:2360</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aecac86b5984b9351049f957b23b69992"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aecac86b5984b9351049f957b23b69992">can_reuse_registration</a></div><div class="ttdeci">static int can_reuse_registration(struct sip_outbound_registration *existing, struct sip_outbound_registration *applied)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01461">res_pjsip_outbound_registration.c:1461</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a6d90b7ed17164c4ecb76dac5bda2043d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6d90b7ed17164c4ecb76dac5bda2043d">sip_outbound_registration_status_str</a></div><div class="ttdeci">static const char * sip_outbound_registration_status_str(enum sip_outbound_registration_status state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00278">res_pjsip_outbound_registration.c:278</a></div></div>
<div class="ttc" id="manager_8h_html_a420f0f755e1c3378b45ca7f6f0669ffa"><div class="ttname"><a href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a></div><div class="ttdeci">#define EVENT_FLAG_SYSTEM</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00071">manager.h:71</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_a78adb9ce06bb67dc38340c501d439d71"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a78adb9ce06bb67dc38340c501d439d71">ao2_callback_fn</a></div><div class="ttdeci">int() ao2_callback_fn(void *obj, void *arg, int flags)</div><div class="ttdoc">Type of a generic callback function. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01230">astobj2.h:1230</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsip__outbound__registration__state_html_a0379c36ac6c780ebcd6f6dd3c3784cbd"><div class="ttname"><a href="../../d3/d3f/structsip__outbound__registration__state.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">sip_outbound_registration_state::client_state</a></div><div class="ttdeci">struct sip_outbound_registration_client_state * client_state</div><div class="ttdoc">Client state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00402">res_pjsip_outbound_registration.c:402</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a></div><div class="ttdoc">The arg parameter is a partial search key similar to OBJ_SEARCH_KEY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01120">astobj2.h:1120</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a045e92a13d3f4b1e0d061b4b6e64f1e1"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">sip_outbound_registration::outbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector outbound_auths</div><div class="ttdoc">Configured authentication credentials. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00335">res_pjsip_outbound_registration.c:335</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a66822f0bda04ca112f8f1d0b29e9f4a4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a66822f0bda04ca112f8f1d0b29e9f4a4">ast_sip_register_endpoint_identifier</a></div><div class="ttdeci">int ast_sip_register_endpoint_identifier(struct ast_sip_endpoint_identifier *identifier)</div><div class="ttdoc">Register a SIP endpoint identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03508">res_pjsip.c:3508</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_ac18889d3debd7178ac69dba0fc3c2349"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#ac18889d3debd7178ac69dba0fc3c2349">sip_outbound_registration::forbidden_retry_interval</a></div><div class="ttdeci">unsigned int forbidden_retry_interval</div><div class="ttdoc">Interval at which retries should occur for permanent responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00325">res_pjsip_outbound_registration.c:325</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_abc867dcf2080fffd890e3ff80e40956a"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#abc867dcf2080fffd890e3ff80e40956a">sip_outbound_registration_client_state::auth_cseq</a></div><div class="ttdeci">unsigned int auth_cseq</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00382">res_pjsip_outbound_registration.c:382</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac3382bf6da54c56b37069bd76bbdf4f9"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a></div><div class="ttdeci">static int load_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02508">res_pjsip_outbound_registration.c:2508</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461babcb0d82a3913968e3624b0646898aacc">SIP_REGISTRATION_STOPPING</a></div><div class="ttdoc">Registration is stopping. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00264">res_pjsip_outbound_registration.c:264</a></div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00317">module.h:317</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a8b55fd039a8b14683eae2d3c0a1c86ae"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a8b55fd039a8b14683eae2d3c0a1c86ae">sip_outbound_registration::outbound_proxy</a></div><div class="ttdeci">const ast_string_field outbound_proxy</div><div class="ttdoc">Outbound proxy to use. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5dfee119fa8decee60b36380e84ffc40"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5dfee119fa8decee60b36380e84ffc40">ast_sip_auths_to_str</a></div><div class="ttdeci">int ast_sip_auths_to_str(const struct ast_sip_auth_vector *auths, char **buf)</div><div class="ttdoc">Converts an auths array to a string of comma separated values. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l00317">pjsip_configuration.c:317</a></div></div>
<div class="ttc" id="sorcery_8h_html_a7956acdd8675b6d55407ea134fb371cc"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a7956acdd8675b6d55407ea134fb371cc">ast_sorcery_object_unregister</a></div><div class="ttdeci">int ast_sorcery_object_unregister(struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Unregister an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01061">sorcery.c:1061</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a></div><div class="ttdoc">Type for default option handler for unsigned integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00459">config_options.h:459</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ad09fa931f468002152a3cc2d5ce25eae"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a></div><div class="ttdeci">static int unload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02461">res_pjsip_outbound_registration.c:2461</a></div></div>
<div class="ttc" id="structast__sorcery__instance__observer_html"><div class="ttname"><a href="../../dc/d45/structast__sorcery__instance__observer.html">ast_sorcery_instance_observer</a></div><div class="ttdoc">Interface for the sorcery instance observer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00237">sorcery.h:237</a></div></div>
<div class="ttc" id="structast__cli__args_html_acfc02ec89670db29251fda6a66602ce2"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">ast_cli_args::n</a></div><div class="ttdeci">const int n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00165">cli.h:165</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gac231880459dcf8feacf1bb272b60472a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a></div><div class="ttdeci">int ast_sip_push_task_wait_serializer(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to the serializer and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05218">res_pjsip.c:5218</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a503c27e9cb915cd6bebd3c22f7d911e0"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a503c27e9cb915cd6bebd3c22f7d911e0">sip_dialog_create_contact</a></div><div class="ttdeci">static int sip_dialog_create_contact(pj_pool_t *pool, pj_str_t *contact, const char *user, const pj_str_t *target, pjsip_tpselector *selector, const char *line, const char *header_params)</div><div class="ttdoc">Helper function which populates a pj_str_t with a contact header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01388">res_pjsip_outbound_registration.c:1388</a></div></div>
<div class="ttc" id="stringfields_8h_html_a51b5729220efb7cda4393ed35ecdfea2"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a></div><div class="ttdeci">#define AST_STRING_FIELD(name)</div><div class="ttdoc">Declare a string field. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00299">stringfields.h:299</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a5cd5b408e27b27e519386044af259073"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a5cd5b408e27b27e519386044af259073">ami_register</a></div><div class="ttdeci">static int ami_register(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02091">res_pjsip_outbound_registration.c:2091</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="utils_8h_html_a7b4f10b070e95ba413e258a3e4b03c20"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a></div><div class="ttdeci">long int ast_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02064">main/utils.c:2064</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a46aa50c37f5c251756d5564d8c96aa38"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a46aa50c37f5c251756d5564d8c96aa38">DEFAULT_STATE_BUCKETS</a></div><div class="ttdeci">#define DEFAULT_STATE_BUCKETS</div><div class="ttdoc">Default number of state container buckets. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00412">res_pjsip_outbound_registration.c:412</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="sorcery_8h_html_aafb892d94b22a7cee58517f4ab19387f"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aafb892d94b22a7cee58517f4ab19387f">ast_sorcery_object_id_sort</a></div><div class="ttdeci">int ast_sorcery_object_id_sort(const void *obj, const void *arg, int flags)</div><div class="ttdoc">ao2 object sorter based on sorcery id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02435">sorcery.c:2435</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_aebc646bb4393e15f08463b0d565c7ef8"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aebc646bb4393e15f08463b0d565c7ef8">ast_sip_cli_formatter_entry::retrieve_by_id</a></div><div class="ttdeci">void *(* retrieve_by_id)(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00068">res_pjsip_cli.h:68</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a6e527f7843b00df547d2221a7d31ef60"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a6e527f7843b00df547d2221a7d31ef60">sip_outbound_registration_client_state::support_path</a></div><div class="ttdeci">unsigned int support_path</div><div class="ttdoc">Determines whether SIP Path support should be advertised. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00378">res_pjsip_outbound_registration.c:378</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a44cdbda076f37ba09880ba74d942b606"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a44cdbda076f37ba09880ba74d942b606">sip_outbound_registration::transport</a></div><div class="ttdeci">const ast_string_field transport</div><div class="ttdoc">Explicit transport to use for registration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_af6ece877d063e7ccde6199ad7c1dcfde"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#af6ece877d063e7ccde6199ad7c1dcfde">sip_outbound_registration_client_state::last_tdata</a></div><div class="ttdeci">pjsip_tx_data * last_tdata</div><div class="ttdoc">Last tdata sent We need the original tdata to resend a request on auth failure or timeout...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00360">res_pjsip_outbound_registration.c:360</a></div></div>
<div class="ttc" id="structast__sip__ami_html_a38bed88f5fd00306683b620c6c90eef4"><div class="ttname"><a href="../../d4/d2f/structast__sip__ami.html#a38bed88f5fd00306683b620c6c90eef4">ast_sip_ami::s</a></div><div class="ttdeci">struct mansession * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02739">res_pjsip.h:2739</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="res__fax_8c_html_a7ea220e4d14b05876af4430e9832ce47"><div class="ttname"><a href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a></div><div class="ttdeci">struct ao2_container * container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d60/res__fax_8c_source.html#l00502">res_fax.c:502</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga575cb798179c82d92b24415d3e174b5b"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga575cb798179c82d92b24415d3e174b5b">ast_sip_create_serializer_group</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer_group(const char *name, struct ast_serializer_shutdown_group *shutdown_group)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05128">res_pjsip.c:5128</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a4810e8d609e3e1a5dd97faaca36d55ee"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a></div><div class="ttdeci">int ast_sip_create_request_with_auth(const struct ast_sip_auth_vector *auths, pjsip_rx_data *challenge, pjsip_tx_data *tdata, pjsip_tx_data **new_request)</div><div class="ttdoc">Create a response to an authentication challenge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03412">res_pjsip.c:3412</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a66581086d34dfe7ea86b0644bacef239"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a></div><div class="ttdeci">#define ast_variable_new(name, value, filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">include/asterisk/config.h:914</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ace55fa9c096b67fac919d25bcecbdeca"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ace55fa9c096b67fac919d25bcecbdeca">sip_outbound_registration_client_state::registration_name</a></div><div class="ttdeci">char * registration_name</div><div class="ttdoc">The name of the registration sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00394">res_pjsip_outbound_registration.c:394</a></div></div>
<div class="ttc" id="res__pjsip__cli_8h_html_a2d86edf5478a04305feab4e327a280c8"><div class="ttname"><a href="../../d1/d9f/res__pjsip__cli_8h.html#a2d86edf5478a04305feab4e327a280c8">ast_sip_unregister_cli_formatter</a></div><div class="ttdeci">int ast_sip_unregister_cli_formatter(struct ast_sip_cli_formatter_entry *formatter)</div><div class="ttdoc">Unregisters a CLI formatter. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df0/pjsip__cli_8c_source.html#l00326">pjsip_cli.c:326</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2ab003b20499c5102299f41756932adc"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2ab003b20499c5102299f41756932adc">registration_deleted_observer</a></div><div class="ttdeci">static void registration_deleted_observer(const void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02430">res_pjsip_outbound_registration.c:2430</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="res__pjsip__cli_8h_html"><div class="ttname"><a href="../../d1/d9f/res__pjsip__cli_8h.html">res_pjsip_cli.h</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a4690151b996bef01389d22a11ec0b21e"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a4690151b996bef01389d22a11ec0b21e">ast_sip_format_auths_ami</a></div><div class="ttdeci">int ast_sip_format_auths_ami(const struct ast_sip_auth_vector *auths, struct ast_sip_ami *ami)</div><div class="ttdoc">Format auth details for AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcb/config__auth_8c_source.html#l00195">config_auth.c:195</a></div></div>
<div class="ttc" id="statsd_8h_html_ab28a718bc4cbc0a95c67d16289258b7c"><div class="ttname"><a href="../../d4/d67/statsd_8h.html#ab28a718bc4cbc0a95c67d16289258b7c">ast_statsd_log</a></div><div class="ttdeci">void ast_statsd_log(const char *metric_name, const char *metric_type, intmax_t value)</div><div class="ttdoc">Send a stat to the configured statsd server. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0c/res__statsd_8c_source.html#l00222">res_statsd.c:222</a></div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="structast__sip__cli__context_html_ae6e64c2211d834b7ba0eeab24933d46a"><div class="ttname"><a href="../../d6/da9/structast__sip__cli__context.html#ae6e64c2211d834b7ba0eeab24933d46a">ast_sip_cli_context::indent_level</a></div><div class="ttdeci">int indent_level</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00040">res_pjsip_cli.h:40</a></div></div>
<div class="ttc" id="sorcery_8h_html_a27e4472f54af1cf4a00c936b65c3967b"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a27e4472f54af1cf4a00c936b65c3967b">ast_sorcery_instance_observer_remove</a></div><div class="ttdeci">void ast_sorcery_instance_observer_remove(struct ast_sorcery *sorcery, const struct ast_sorcery_instance_observer *callbacks)</div><div class="ttdoc">Remove an observer from a sorcery instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00537">sorcery.c:537</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d3bb8496e8ca801ce7e5ff204a28837"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d3bb8496e8ca801ce7e5ff204a28837">ast_sip_service_route_vector_alloc</a></div><div class="ttdeci">struct ast_sip_service_route_vector * ast_sip_service_route_vector_alloc(void)</div><div class="ttdoc">Allocate a vector of service routes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00352">config_transport.c:352</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="sorcery_8h_html_a6c1928d47eae1172f236e8ee421c2db4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a></div><div class="ttdeci">int ast_sorcery_observer_add(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Add an observer to a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02386">sorcery.c:2386</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ad1a9a9a97cbae2fdf1c2890fe9adbc92"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1a9a9a97cbae2fdf1c2890fe9adbc92">set_outbound_initial_authentication_credentials</a></div><div class="ttdeci">static int set_outbound_initial_authentication_credentials(pjsip_regc *regc, const struct ast_sip_auth_vector *auth_vector)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01545">res_pjsip_outbound_registration.c:1545</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5d73e049fbced1da4e3041d1656e0aa6"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5d73e049fbced1da4e3041d1656e0aa6">ast_sip_transport_monitor_unregister</a></div><div class="ttdeci">void ast_sip_transport_monitor_unregister(pjsip_transport *transport, ast_transport_monitor_shutdown_cb cb, void *data, ast_transport_monitor_data_matcher matches)</div><div class="ttdoc">Unregister a reliable transport shutdown monitor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00277">pjsip_transport_events.c:277</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2c4344947bef0dc3813ff04482d4ec34"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c4344947bef0dc3813ff04482d4ec34">cli_iterator</a></div><div class="ttdeci">static int cli_iterator(void *container, ao2_callback_fn callback, void *args)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02235">res_pjsip_outbound_registration.c:2235</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ad1f14c0e5b7c3a9632df348f9b3f6184"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad1f14c0e5b7c3a9632df348f9b3f6184">cli_outbound_registration</a></div><div class="ttdeci">static struct ast_cli_entry cli_outbound_registration[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02311">res_pjsip_outbound_registration.c:2311</a></div></div>
<div class="ttc" id="structsip__outbound__registration__state_html_af03aaf5122fd52717e03379b67e9bb5e"><div class="ttname"><a href="../../d3/d3f/structsip__outbound__registration__state.html#af03aaf5122fd52717e03379b67e9bb5e">sip_outbound_registration_state::registration</a></div><div class="ttdeci">struct sip_outbound_registration * registration</div><div class="ttdoc">Outbound registration configuration object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00400">res_pjsip_outbound_registration.c:400</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a1532fa6ad6ad7d60a568fc5b3594cd94"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1532fa6ad6ad7d60a568fc5b3594cd94">REREGISTER_BUFFER_TIME</a></div><div class="ttdeci">#define REREGISTER_BUFFER_TIME</div><div class="ttdoc">Amount of buffer time (in seconds) before expiration that we re-register at. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00248">res_pjsip_outbound_registration.c:248</a></div></div>
<div class="ttc" id="structregistration__response_html_a45a5b7c00a796a23f01673cef1dbe0a9"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#a45a5b7c00a796a23f01673cef1dbe0a9">registration_response::code</a></div><div class="ttdeci">int code</div><div class="ttdoc">Response code for the registration attempt. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00834">res_pjsip_outbound_registration.c:834</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html">sip_outbound_registration</a></div><div class="ttdoc">Outbound registration information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00300">res_pjsip_outbound_registration.c:300</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a05f4b1cd543ee5eba99f76928df91f68"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a05f4b1cd543ee5eba99f76928df91f68">ami_show_outbound_registrations</a></div><div class="ttdeci">static int ami_show_outbound_registrations(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02179">res_pjsip_outbound_registration.c:2179</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="structsip__ami__outbound_html"><div class="ttname"><a href="../../d4/d1b/structsip__ami__outbound.html">sip_ami_outbound</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02128">res_pjsip_outbound_registration.c:2128</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a790e1a3ec85fd649e267eee830b565c4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a790e1a3ec85fd649e267eee830b565c4">ast_sip_service_route_vector_destroy</a></div><div class="ttdeci">void ast_sip_service_route_vector_destroy(struct ast_sip_service_route_vector *service_routes)</div><div class="ttdoc">Destroy a vector of service routes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00366">config_transport.c:366</a></div></div>
<div class="ttc" id="structsip__ami__outbound_html_a995fb73070b544ea93cbc8b4552a44b0"><div class="ttname"><a href="../../d4/d1b/structsip__ami__outbound.html#a995fb73070b544ea93cbc8b4552a44b0">sip_ami_outbound::registered</a></div><div class="ttdeci">int registered</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02130">res_pjsip_outbound_registration.c:2130</a></div></div>
<div class="ttc" id="structregistration__response_html_ad6057e40387509de502bdc91007d3238"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#ad6057e40387509de502bdc91007d3238">registration_response::expiration</a></div><div class="ttdeci">int expiration</div><div class="ttdoc">Expiration time for registration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00836">res_pjsip_outbound_registration.c:836</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_aadebe2487a2c5240ab6cd02c83add0bf"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a></div><div class="ttdeci">char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00037">utils/frame.c:37</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba78cbebc5fbb5987eb9e018035ed71cab">SIP_REGISTRATION_REJECTED_PERMANENT</a></div><div class="ttdoc">Registration was rejected, permanently. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00262">res_pjsip_outbound_registration.c:262</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="astobj2_8h_html_a04bf2beaf5811f6b95768e42fb95d9a5"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a04bf2beaf5811f6b95768e42fb95d9a5">ao2_container_dup</a></div><div class="ttdeci">int ao2_container_dup(struct ao2_container *dest, struct ao2_container *src, enum search_flags flags)</div><div class="ttdoc">Copy all object references in the src container into the dest container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00673">astobj2_container.c:673</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="structast__json__error_html_a60dae4c6e78188cd718b696e4f08fc71"><div class="ttname"><a href="../../d0/d96/structast__json__error.html#a60dae4c6e78188cd718b696e4f08fc71">ast_json_error::column</a></div><div class="ttdeci">int column</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00833">json.h:833</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ab7e3a9f89d0b6fe03a40230efba1d81d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ab7e3a9f89d0b6fe03a40230efba1d81d">get_state</a></div><div class="ttdeci">static struct sip_outbound_registration_state * get_state(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00468">res_pjsip_outbound_registration.c:468</a></div></div>
<div class="ttc" id="structast__sorcery__observer_html"><div class="ttname"><a href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a></div><div class="ttdoc">Interface for a sorcery object type observer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00332">sorcery.h:332</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="chan__phone_8c_html_a4e40373706bcf5cdb9409dac3166d280"><div class="ttname"><a href="../../da/dde/chan__phone_8c.html#a4e40373706bcf5cdb9409dac3166d280">monitor</a></div><div class="ttdeci">static unsigned int monitor</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dde/chan__phone_8c_source.html#l00116">chan_phone.c:116</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00294">config_options.h:294</a></div></div>
<div class="ttc" id="strings_8h_html_ab2c8e1bf4b2b01a1ffabf882774907bb"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab2c8e1bf4b2b01a1ffabf882774907bb">ast_generate_random_string</a></div><div class="ttdeci">char * ast_generate_random_string(char *buf, size_t size)</div><div class="ttdoc">Create a pseudo-random string of a fixed length. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00227">strings.c:227</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a1a9e55a3612e24973891ec2b87811f1d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a1a9e55a3612e24973891ec2b87811f1d">LINE_PARAMETER_SIZE</a></div><div class="ttdeci">#define LINE_PARAMETER_SIZE</div><div class="ttdoc">Size of the buffer for creating a unique string for the line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00251">res_pjsip_outbound_registration.c:251</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a7fc92b8eea9b7e19e20024cb8119ccfb"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7fc92b8eea9b7e19e20024cb8119ccfb">add_to_supported_header</a></div><div class="ttdeci">static int add_to_supported_header(pjsip_tx_data *tdata, pj_str_t *name)</div><div class="ttdoc">Helper function to add string to Supported header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00615">res_pjsip_outbound_registration.c:615</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a0e85270ccb77c71eb8f9693642c46daf"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a0e85270ccb77c71eb8f9693642c46daf">sip_outbound_registration::SORCERY_OBJECT</a></div><div class="ttdeci">SORCERY_OBJECT(details)</div><div class="ttdoc">Sorcery object details. </div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_af5c116e487d0241d5b723858e5e40ef4"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af5c116e487d0241d5b723858e5e40ef4">monitor_matcher</a></div><div class="ttdeci">static int monitor_matcher(void *a, void *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00954">res_pjsip_outbound_registration.c:954</a></div></div>
<div class="ttc" id="stasis__system_8h_html_a196188f45631aed77434c898ed322ce6"><div class="ttname"><a href="../../d3/df0/stasis__system_8h.html#a196188f45631aed77434c898ed322ce6">ast_system_topic</a></div><div class="ttdeci">struct stasis_topic * ast_system_topic(void)</div><div class="ttdoc">A Stasis Message Bus API topic which publishes messages regarding system changes. ...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da0/stasis__system_8c_source.html#l00347">stasis_system.c:347</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a3e8ce0855f5b8cc0e2c64cc59887d779"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a3e8ce0855f5b8cc0e2c64cc59887d779">ast_sip_cleanup_auths</a></div><div class="ttdeci">void ast_sip_cleanup_auths(struct ast_sip_auth *auths[], size_t num_auths)</div><div class="ttdoc">Clean up retrieved auth structures from memory. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02377">pjsip_configuration.c:2377</a></div></div>
<div class="ttc" id="sorcery_8h_html_a197b6724158db0da59852d25d36fa5f1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a197b6724158db0da59852d25d36fa5f1">ast_sorcery_objectset_create</a></div><div class="ttdeci">#define ast_sorcery_objectset_create(sorcery, object)</div><div class="ttdoc">Create an object set (KVP list) for an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01136">sorcery.h:1136</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a12221be4cf0c835b3d35678aa90f09aa"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a12221be4cf0c835b3d35678aa90f09aa">sip_outbound_registration::auth_rejection_permanent</a></div><div class="ttdeci">unsigned int auth_rejection_permanent</div><div class="ttdoc">Treat authentication challenges that we cannot handle as permanent failures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00329">res_pjsip_outbound_registration.c:329</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ac23e23ba60f358de78a893d537c0afa4">sip_outbound_registration_client_state::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdoc">Serializer for stuff and things. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00384">res_pjsip_outbound_registration.c:384</a></div></div>
<div class="ttc" id="cli_8h_html_ae47751901c430ebb833e59291a5e0b3f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a></div><div class="ttdeci">#define CLI_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00046">cli.h:46</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="func__strings_8c_html_a1b62eb9e3ebf087509f4301aa6336931"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a></div><div class="ttdeci">static int regex(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00948">func_strings.c:948</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00741">cdr_mysql.c:741</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a4a253e3df4e474d9f21b13bdb86880a4"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a253e3df4e474d9f21b13bdb86880a4">AO2_GLOBAL_OBJ_STATIC</a></div><div class="ttdeci">static AO2_GLOBAL_OBJ_STATIC(current_states)</div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bad2ebb28b044d1138c7efed8b9ba3adf0">SIP_REGISTRATION_UNREGISTERED</a></div><div class="ttdoc">Currently unregistered. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00256">res_pjsip_outbound_registration.c:256</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a7c6ac25ea7536c0bc9ed18cbcf917527"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a></div><div class="ttdeci">static int reload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02614">res_pjsip_outbound_registration.c:2614</a></div></div>
<div class="ttc" id="structast__sip__auth_html_af263f62bf45d20982f102de2a9cd461f"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#af263f62bf45d20982f102de2a9cd461f">ast_sip_auth::auth_pass</a></div><div class="ttdeci">const ast_string_field auth_pass</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00452">res_pjsip.h:452</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2d9f49ccb117db36a181b412670f4ce7"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2d9f49ccb117db36a181b412670f4ce7">sip_outbound_registration_alloc</a></div><div class="ttdeci">static void * sip_outbound_registration_alloc(const char *name)</div><div class="ttdoc">Allocator function for registration information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01373">res_pjsip_outbound_registration.c:1373</a></div></div>
<div class="ttc" id="vector_8h_html"><div class="ttname"><a href="../../d6/d68/vector_8h.html">vector.h</a></div><div class="ttdoc">Vector container support. </div></div>
<div class="ttc" id="structaco__option_html"><div class="ttname"><a href="../../db/de0/structaco__option.html">aco_option</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00062">config_options.c:62</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structast__sip__auth__vector_html"><div class="ttname"><a href="../../d0/dca/structast__sip__auth__vector.html">ast_sip_auth_vector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00467">res_pjsip.h:467</a></div></div>
<div class="ttc" id="taskprocessor_8h_html"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html">taskprocessor.h</a></div><div class="ttdoc">An API for managing task processing threads that can be shared across modules. </div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a4d0179e0cf04c08d87db248822b3955c"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4d0179e0cf04c08d87db248822b3955c">queue_register</a></div><div class="ttdeci">static int queue_register(struct sip_outbound_registration_state *state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01893">res_pjsip_outbound_registration.c:1893</a></div></div>
<div class="ttc" id="structast__sip__endpoint__identifier_html"><div class="ttname"><a href="../../d0/d97/structast__sip__endpoint__identifier.html">ast_sip_endpoint_identifier</a></div><div class="ttdoc">An entity responsible for identifying the source of a SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00993">res_pjsip.h:993</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_a328348f7f0793218f7891b2e6196ca25"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a328348f7f0793218f7891b2e6196ca25">ast_sip_cli_formatter_entry::get_id</a></div><div class="ttdeci">const char *(* get_id)(const void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00070">res_pjsip_cli.h:70</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a1b1690d1107c614d4eb2853d96c55062"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a1b1690d1107c614d4eb2853d96c55062">ast_sip_transport_state_set_transport</a></div><div class="ttdeci">int ast_sip_transport_state_set_transport(const char *transport_name, pjsip_transport *transport)</div><div class="ttdoc">Sets the PJSIP transport on a child transport. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00206">config_transport.c:206</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a0443ab92a32c0d55ac2bace5904fbb3e"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a0443ab92a32c0d55ac2bace5904fbb3e">registrations</a></div><div class="ttdeci">static struct registrations registrations</div></div>
<div class="ttc" id="structuser_html"><div class="ttname"><a href="../../d8/dbc/structuser.html">user</a></div><div class="ttdoc">structure to hold users read from users.conf </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00312">res_phoneprov.c:312</a></div></div>
<div class="ttc" id="structast__sip__auth_html_ad300470818476484645b03f3c0c66591"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#ad300470818476484645b03f3c0c66591">ast_sip_auth::refresh_token</a></div><div class="ttdeci">const ast_string_field refresh_token</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00456">res_pjsip.h:456</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a95b85891504e7b87e44eeb8d74b58a89"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a95b85891504e7b87e44eeb8d74b58a89">ami_outbound_registration_detail</a></div><div class="ttdeci">static int ami_outbound_registration_detail(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02171">res_pjsip_outbound_registration.c:2171</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="structheader_html"><div class="ttname"><a href="../../d5/d65/structheader.html">header</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d73/pjsip__global__headers_8c_source.html#l00047">pjsip_global_headers.c:47</a></div></div>
<div class="ttc" id="structast__sorcery__observer_html_a1ebad9f5bd6a80f6f666354460b86e0d"><div class="ttname"><a href="../../d2/ddb/structast__sorcery__observer.html#a1ebad9f5bd6a80f6f666354460b86e0d">ast_sorcery_observer::loaded</a></div><div class="ttdeci">void(* loaded)(const char *object_type)</div><div class="ttdoc">Callback for when an object type is loaded/reloaded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00343">sorcery.h:343</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5b63b1eceb879f2cf0e23f356040737a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5b63b1eceb879f2cf0e23f356040737a">ast_sip_create_ami_event</a></div><div class="ttdeci">struct ast_str * ast_sip_create_ami_event(const char *event, struct ast_sip_ami *ami)</div><div class="ttdoc">Creates a string to store AMI event data in. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l01584">pjsip_configuration.c:1584</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_addaa208b0ed785225e24490fb9f28a80"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a></div><div class="ttdeci">AST_MODULE_INFO(ASTERISK_GPL_KEY, AST_MODFLAG_GLOBAL_SYMBOLS|AST_MODFLAG_LOAD_ORDER, &quot;HTTP Phone Provisioning&quot;,.support_level=AST_MODULE_SUPPORT_EXTENDED,.load=load_module,.unload=unload_module,.reload=reload,.load_pri=AST_MODPRI_CHANNEL_DEPEND,.requires=&quot;http&quot;,)</div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a76bfc4580ecce3bd49fab35b0e5bd74a"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a76bfc4580ecce3bd49fab35b0e5bd74a">sip_outbound_registration_client_state::transport_name</a></div><div class="ttdeci">char * transport_name</div><div class="ttdoc">The name of the transport to be used for the registration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00392">res_pjsip_outbound_registration.c:392</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a3c1b82437e7e8843602d3dce17cc4e9d"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a3c1b82437e7e8843602d3dce17cc4e9d">handle_registration_response</a></div><div class="ttdeci">static int handle_registration_response(void *data)</div><div class="ttdoc">Callback function for handling a response to a registration attempt. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01056">res_pjsip_outbound_registration.c:1056</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ad111cd1f90812e2a977fb2ac17f6725a"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ad111cd1f90812e2a977fb2ac17f6725a">line_identify_relationship</a></div><div class="ttdeci">static int line_identify_relationship(void *obj, void *arg, int flags)</div><div class="ttdoc">Callback function for matching an outbound registration based on line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00491">res_pjsip_outbound_registration.c:491</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="sorcery_8h_html_aaa9cd237841a70862001f580b23212c9"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_fields(const struct ast_sorcery *sorcery, const char *type, unsigned int flags, struct ast_variable *fields)</div><div class="ttdoc">Retrieve an object or multiple objects using specific fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01897">sorcery.c:1897</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a361792ceb797e0709c07318da3611bf4"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a361792ceb797e0709c07318da3611bf4">registration_state_cmp</a></div><div class="ttdeci">static int registration_state_cmp(void *obj, void *arg, int flags)</div><div class="ttdoc">comparator function for state objects </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00440">res_pjsip_outbound_registration.c:440</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a4a55c93ab3532991aa5db9440b6ee2b3"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a4a55c93ab3532991aa5db9440b6ee2b3">sip_outbound_registration_timer_cb</a></div><div class="ttdeci">static void sip_outbound_registration_timer_cb(pj_timer_heap_t *timer_heap, struct pj_timer_entry *entry)</div><div class="ttdoc">Timer callback function, used just for registrations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00703">res_pjsip_outbound_registration.c:703</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aa06519e07ad0d92edb3ab7e8a910e0f7"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa06519e07ad0d92edb3ab7e8a910e0f7">unregister_task</a></div><div class="ttdeci">static int unregister_task(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01860">res_pjsip_outbound_registration.c:1860</a></div></div>
<div class="ttc" id="manager_8h_html_a0b1b4140c2836696a6950e92ab48a580"><div class="ttname"><a href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a></div><div class="ttdeci">#define EVENT_FLAG_REPORTING</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00080">manager.h:80</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="statsd_8h_html_a6afb619b8958442badec05d4303a0d5d"><div class="ttname"><a href="../../d4/d67/statsd_8h.html#a6afb619b8958442badec05d4303a0d5d">AST_STATSD_GAUGE</a></div><div class="ttdeci">#define AST_STATSD_GAUGE</div><div class="ttdoc">Support for publishing to a statsd server. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/statsd_8h_source.html#l00032">statsd.h:32</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac1601540f1d2be4be34fb53b8dd96f70"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac1601540f1d2be4be34fb53b8dd96f70">cli_get_container</a></div><div class="ttdeci">static struct ao2_container * cli_get_container(const char *regex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02211">res_pjsip_outbound_registration.c:2211</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3a11e1a1d3e99bed3ea0a7c57a3880d7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_global_obj_replace_unref(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00908">astobj2.h:908</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a98068831aa58db10990857613f081058"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a98068831aa58db10990857613f081058">sip_outbound_registration::retry_interval</a></div><div class="ttdeci">unsigned int retry_interval</div><div class="ttdoc">Interval at which retries should occur for temporal responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00323">res_pjsip_outbound_registration.c:323</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab5b75b4bdba91e178731511c7fa659cda0d8d8506a624618324fd18bb4a7e7079"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cda0d8d8506a624618324fd18bb4a7e7079">AST_SIP_AUTH_TYPE_GOOGLE_OAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00437">res_pjsip.h:437</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a></div><div class="ttdoc">The arg parameter is an object of the same type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01091">astobj2.h:1091</a></div></div>
<div class="ttc" id="structast__sorcery__instance__observer_html_a62883356278e945a5c144b8caa76afcb"><div class="ttname"><a href="../../dc/d45/structast__sorcery__instance__observer.html#a62883356278e945a5c144b8caa76afcb">ast_sorcery_instance_observer::object_type_loaded</a></div><div class="ttdeci">void(* object_type_loaded)(const char *name, const struct ast_sorcery *sorcery, const char *object_type, int reloaded)</div><div class="ttdoc">Callback after any object_type is loaded/reloaded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00260">sorcery.h:260</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_adee22a644c469429436b423b79b4366a"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#adee22a644c469429436b423b79b4366a">sip_outbound_registration_client_state::retries</a></div><div class="ttdeci">unsigned int retries</div><div class="ttdoc">Current number of retries. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00366">res_pjsip_outbound_registration.c:366</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="sorcery_8h_html_a18d64c360480b458754fc30f781d5011"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a></div><div class="ttdeci">void ast_sorcery_observer_remove(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Remove an observer from a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02418">sorcery.c:2418</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a9402eeb89268606c03c23e63df7e32f5"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a9402eeb89268606c03c23e63df7e32f5">outbound_auths_to_str</a></div><div class="ttdeci">static int outbound_auths_to_str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01835">res_pjsip_outbound_registration.c:1835</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="res__pjsip__private_8h_html_a11c06d062df22e560a693c61da9ffa3c"><div class="ttname"><a href="../../d7/d5c/res__pjsip__private_8h.html#a11c06d062df22e560a693c61da9ffa3c">ast_sip_validate_uri_length</a></div><div class="ttdeci">int ast_sip_validate_uri_length(const char *uri)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00525">location.c:525</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="res__pjsip__phoneprov__provider_8c_html_a95eb520bdb1abcd2a70b1432d3ecbf4c"><div class="ttname"><a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a></div><div class="ttdeci">static struct ast_sorcery * sorcery</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c_source.html#l00126">res_pjsip_phoneprov_provider.c:126</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="sorcery_8h_html_a9dbf5d1177fd4ab31efe1037f4dc1c24"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a9dbf5d1177fd4ab31efe1037f4dc1c24">ast_sorcery_changeset_create</a></div><div class="ttdeci">int ast_sorcery_changeset_create(const struct ast_variable *original, const struct ast_variable *modified, struct ast_variable **changes)</div><div class="ttdoc">Create a changeset given two object sets. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01663">sorcery.c:1663</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a045e92a13d3f4b1e0d061b4b6e64f1e1"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">sip_outbound_registration_client_state::outbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector outbound_auths</div><div class="ttdoc">Configured authentication credentials. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00386">res_pjsip_outbound_registration.c:386</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_aa3522da32a7960126d5eb2ac0c1c6c36"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#aa3522da32a7960126d5eb2ac0c1c6c36">sip_outbound_registration::endpoint</a></div><div class="ttdeci">const ast_string_field endpoint</div><div class="ttdoc">Endpoint to use for related incoming calls. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="structregistration__response_html_a0379c36ac6c780ebcd6f6dd3c3784cbd"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#a0379c36ac6c780ebcd6f6dd3c3784cbd">registration_response::client_state</a></div><div class="ttdeci">struct sip_outbound_registration_client_state * client_state</div><div class="ttdoc">Outbound registration client state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00840">res_pjsip_outbound_registration.c:840</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8c_html_abcc2de32fdf1487d09e70c9af7a942df"><div class="ttname"><a href="../../df/d3a/res__pjsip__outbound__publish_8c.html#abcc2de32fdf1487d09e70c9af7a942df">new_states</a></div><div class="ttdeci">static struct ao2_container * new_states</div><div class="ttdoc">Used on [re]loads to hold new state data. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00271">res_pjsip_outbound_publish.c:271</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_adcd252e4b3ee6c4adab994080c1a34d7"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#adcd252e4b3ee6c4adab994080c1a34d7">cli_formatter</a></div><div class="ttdeci">static struct ast_sip_cli_formatter_entry * cli_formatter</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02330">res_pjsip_outbound_registration.c:2330</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a62335a29dc5fc2ae927d923a1a372938"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a62335a29dc5fc2ae927d923a1a372938">ami_unregister</a></div><div class="ttdeci">static int ami_unregister(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02059">res_pjsip_outbound_registration.c:2059</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac4220c486ce13a2d2efba2c9774dbeb2"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4220c486ce13a2d2efba2c9774dbeb2">cli_print_body</a></div><div class="ttdeci">static int cli_print_body(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02271">res_pjsip_outbound_registration.c:2271</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_a12221be4cf0c835b3d35678aa90f09aa"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#a12221be4cf0c835b3d35678aa90f09aa">sip_outbound_registration_client_state::auth_rejection_permanent</a></div><div class="ttdeci">unsigned int auth_rejection_permanent</div><div class="ttdoc">Treat authentication challenges that we cannot handle as permanent failures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00376">res_pjsip_outbound_registration.c:376</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab105b4d8cca635ce7aeed34c4543ab54"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab105b4d8cca635ce7aeed34c4543ab54">ast_sip_sorcery_object_to_ami</a></div><div class="ttdeci">int ast_sip_sorcery_object_to_ami(const void *obj, struct ast_str **buf)</div><div class="ttdoc">Converts a sorcery object to a string of object properties. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l01609">pjsip_configuration.c:1609</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ae5974ff2b87d863b558b2bfb8092a4a8"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ae5974ff2b87d863b558b2bfb8092a4a8">check_state</a></div><div class="ttdeci">static int check_state(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02372">res_pjsip_outbound_registration.c:2372</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a66ac7b74defe3790a72568a394c55270"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a66ac7b74defe3790a72568a394c55270">sip_outbound_registration_state_destroy</a></div><div class="ttdeci">static void sip_outbound_registration_state_destroy(void *obj)</div><div class="ttdoc">Destructor function for registration state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01276">res_pjsip_outbound_registration.c:1276</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a8810bff9344e0b1be67d06b8ed607a51"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a8810bff9344e0b1be67d06b8ed607a51">auth_observer</a></div><div class="ttdeci">static void auth_observer(const char *type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02332">res_pjsip_outbound_registration.c:2332</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2b763a2a08e7882b81e5dbd3a71c3e01"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2b763a2a08e7882b81e5dbd3a71c3e01">cli_print_header</a></div><div class="ttdeci">static int cli_print_header(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02259">res_pjsip_outbound_registration.c:2259</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7ba7488bde246be405e2e376f18107ab"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7ba7488bde246be405e2e376f18107ab">ast_sip_unregister_endpoint_identifier</a></div><div class="ttdeci">void ast_sip_unregister_endpoint_identifier(struct ast_sip_endpoint_identifier *identifier)</div><div class="ttdoc">Unregister a SIP endpoint identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03513">res_pjsip.c:3513</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac4d2100faf8e050dc5c26cd54d487452"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac4d2100faf8e050dc5c26cd54d487452">schedule_retry</a></div><div class="ttdeci">static void schedule_retry(struct registration_response *response, unsigned int interval, const char *server_uri, const char *client_uri)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00883">res_pjsip_outbound_registration.c:883</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_a0053a651dbc1962d77b2603ab94f124c"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a0053a651dbc1962d77b2603ab94f124c">ast_sip_cli_formatter_entry::print_header</a></div><div class="ttdeci">ao2_callback_fn * print_header</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00060">res_pjsip_cli.h:60</a></div></div>
<div class="ttc" id="structregistration__response_html_ade5ccc60ae8c2912b1c64aab8921c726"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#ade5ccc60ae8c2912b1c64aab8921c726">registration_response::retry_after</a></div><div class="ttdeci">int retry_after</div><div class="ttdoc">Retry-After value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00838">res_pjsip_outbound_registration.c:838</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a74db2eb050f68d18300d0584b9a2a671"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a74db2eb050f68d18300d0584b9a2a671">registration_response_destroy</a></div><div class="ttdeci">static void registration_response_destroy(void *obj)</div><div class="ttdoc">Registration response structure destructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00848">res_pjsip_outbound_registration.c:848</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a45542c0cd8e3d61c4d0c639074395abc"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a45542c0cd8e3d61c4d0c639074395abc">handle_client_registration</a></div><div class="ttdeci">static int handle_client_registration(void *data)</div><div class="ttdoc">Callback function for registering. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00668">res_pjsip_outbound_registration.c:668</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a76eeff441a1c0f25e33e41191c0ca815"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a76eeff441a1c0f25e33e41191c0ca815">sip_outbound_registration_client_state_destroy</a></div><div class="ttdeci">static void sip_outbound_registration_client_state_destroy(void *obj)</div><div class="ttdoc">Destructor function for client registration state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01297">res_pjsip_outbound_registration.c:1297</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aff156a32a4d008899d33f4fcd0dd3066"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aff156a32a4d008899d33f4fcd0dd3066">add_configured_supported_headers</a></div><div class="ttdeci">static int add_configured_supported_headers(struct sip_outbound_registration_client_state *client_state, pjsip_tx_data *tdata)</div><div class="ttdoc">Helper function to add configured supported headers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00650">res_pjsip_outbound_registration.c:650</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a82533315c5406ca144bac2824078a514"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a82533315c5406ca144bac2824078a514">sip_outbound_registration_is_temporal</a></div><div class="ttdeci">static int sip_outbound_registration_is_temporal(unsigned int code, struct sip_outbound_registration_client_state *client_state)</div><div class="ttdoc">Helper function which determines if a response code is temporal or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00864">res_pjsip_outbound_registration.c:864</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_ac892ead8a4bfdf8a66380b1183eb17e9"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#ac892ead8a4bfdf8a66380b1183eb17e9">sip_outbound_registration::fatal_retry_interval</a></div><div class="ttdeci">unsigned int fatal_retry_interval</div><div class="ttdoc">Interval at which retries should occur for all permanent responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00327">res_pjsip_outbound_registration.c:327</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ac892ead8a4bfdf8a66380b1183eb17e9"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ac892ead8a4bfdf8a66380b1183eb17e9">sip_outbound_registration_client_state::fatal_retry_interval</a></div><div class="ttdeci">unsigned int fatal_retry_interval</div><div class="ttdoc">Interval at which retries should occur for all permanent responses. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00374">res_pjsip_outbound_registration.c:374</a></div></div>
<div class="ttc" id="stasis__system_8h_html_a0868bf726d24bce354a1d14f13b39a70"><div class="ttname"><a href="../../d3/df0/stasis__system_8h.html#a0868bf726d24bce354a1d14f13b39a70">ast_system_publish_registry</a></div><div class="ttdeci">void ast_system_publish_registry(const char *channeltype, const char *username, const char *domain, const char *status, const char *cause)</div><div class="ttdoc">Publish a channel driver outgoing registration message. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/da0/stasis__system_8c_source.html#l00118">stasis_system.c:118</a></div></div>
<div class="ttc" id="structsip__ami__outbound_html_af03aaf5122fd52717e03379b67e9bb5e"><div class="ttname"><a href="../../d4/d1b/structsip__ami__outbound.html#af03aaf5122fd52717e03379b67e9bb5e">sip_ami_outbound::registration</a></div><div class="ttdeci">struct sip_outbound_registration * registration</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02132">res_pjsip_outbound_registration.c:2132</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_ab16498ae4f96c29649dd52ac032e811d"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#ab16498ae4f96c29649dd52ac032e811d">sip_outbound_registration_client_state::destroy</a></div><div class="ttdeci">unsigned int destroy</div><div class="ttdoc">Registration should be destroyed after completion of transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00388">res_pjsip_outbound_registration.c:388</a></div></div>
<div class="ttc" id="structast__json__error_html_a41ebd28ef1d7c6ade45642cb6acc1039"><div class="ttname"><a href="../../d0/d96/structast__json__error.html#a41ebd28ef1d7c6ade45642cb6acc1039">ast_json_error::line</a></div><div class="ttdeci">int line</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00831">json.h:831</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a></div><div class="ttdoc">Search option field mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01076">astobj2.h:1076</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="statsd_8h_html_a2d6d16d49502503505c1b5748be47c83"><div class="ttname"><a href="../../d4/d67/statsd_8h.html#a2d6d16d49502503505c1b5748be47c83">ast_statsd_log_string_va</a></div><div class="ttdeci">void ast_statsd_log_string_va(const char *metric_name, const char *metric_type, const char *value, double sample_rate,...)</div><div class="ttdoc">Send a stat to the configured statsd server. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0c/res__statsd_8c_source.html#l00176">res_statsd.c:176</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_ae9f993fcad1fd49cb50f4a541101ccb7"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#ae9f993fcad1fd49cb50f4a541101ccb7">timer_heap</a></div><div class="ttdeci">static pj_timer_heap_t * timer_heap</div><div class="ttdoc">Global timer heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00239">res_rtp_asterisk.c:239</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9e1ef995698ba16cad6608225b8de946"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9e1ef995698ba16cad6608225b8de946">ast_sip_tpselector_unref</a></div><div class="ttdeci">void ast_sip_tpselector_unref(pjsip_tpselector *selector)</div><div class="ttdoc">Unreference a pjsip_tpselector. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03987">res_pjsip.c:3987</a></div></div>
<div class="ttc" id="module_8h_html_aa4f734041ffd9d75b07cefb0291e1e58a08d902290b0d6cbffd8e607d5e399a06"><div class="ttname"><a href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a08d902290b0d6cbffd8e607d5e399a06">AST_MODPRI_APP_DEPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00328">module.h:328</a></div></div>
<div class="ttc" id="res__config__ldap_8c_html_a75e4590043edf35241d30fabe2eda546"><div class="ttname"><a href="../../dc/d12/res__config__ldap_8c.html#a75e4590043edf35241d30fabe2eda546">url</a></div><div class="ttdeci">static char url[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d12/res__config__ldap_8c_source.html#l00074">res_config_ldap.c:74</a></div></div>
<div class="ttc" id="manager_8h_html_a5b63b8a8faede2d852e071e1f7b31c11"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a></div><div class="ttdeci">#define ast_manager_register_xml(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00186">manager.h:186</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_aa3690b518c6016080aef35624fa64cc6"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#aa3690b518c6016080aef35624fa64cc6">ast_sip_cli_formatter_entry::print_body</a></div><div class="ttdeci">ao2_callback_fn * print_body</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00062">res_pjsip_cli.h:62</a></div></div>
<div class="ttc" id="module_8h_html_aba2c8d4be709a254658b21a834f8294a"><div class="ttname"><a href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a></div><div class="ttdeci">#define ASTERISK_GPL_KEY</div><div class="ttdoc">The text the key() function should return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00046">module.h:46</a></div></div>
<div class="ttc" id="logger_8h_html_a33f6031de4ab6d1406465a7a3ee18e86"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a></div><div class="ttdeci">#define DEBUG_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00441">logger.h:441</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="res__pjsip__cli_8h_html_a7e01eb585854a662d1f1875cf4caa055"><div class="ttname"><a href="../../d1/d9f/res__pjsip__cli_8h.html#a7e01eb585854a662d1f1875cf4caa055">ast_sip_cli_print_sorcery_objectset</a></div><div class="ttdeci">int ast_sip_cli_print_sorcery_objectset(void *obj, void *arg, int flags)</div><div class="ttdoc">Prints a sorcery object&amp;#39;s ast_variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df0/pjsip__cli_8c_source.html#l00036">pjsip_cli.c:36</a></div></div>
<div class="ttc" id="structast__sip__cli__formatter__entry_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d8/d5c/structast__sip__cli__formatter__entry.html#a8f8f80d37794cde9472343e4487ba3eb">ast_sip_cli_formatter_entry::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00058">res_pjsip_cli.h:58</a></div></div>
<div class="ttc" id="res__pjsip_8h_html"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html">res_pjsip.h</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a2c3d0057b62bfa5b08fe977478749c24"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a></div><div class="ttdeci">static struct ast_serializer_shutdown_group * shutdown_group</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00409">res_pjsip_outbound_registration.c:409</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a08ceb135e9c4b8c983eecf12fb01cde7"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a08ceb135e9c4b8c983eecf12fb01cde7">observer_callbacks_registrations</a></div><div class="ttdeci">static const struct ast_sorcery_instance_observer observer_callbacks_registrations</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02426">res_pjsip_outbound_registration.c:2426</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_a7568cd99aeb0e7f2919a9c03f1a8d674"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#a7568cd99aeb0e7f2919a9c03f1a8d674">sip_outbound_registration::contact_header_params</a></div><div class="ttdeci">const ast_string_field contact_header_params</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00319">res_pjsip_outbound_registration.c:319</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a91e17af66429640a9207cb6cfa2a8462"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a91e17af66429640a9207cb6cfa2a8462">registration_client_send</a></div><div class="ttdeci">static pj_status_t registration_client_send(struct sip_outbound_registration_client_state *client_state, pjsip_tx_data *tdata)</div><div class="ttdoc">Helper function which sends a message and cleans up, if needed, on failure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00557">res_pjsip_outbound_registration.c:557</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a7d094e30468f05a60d455bd804f7c941"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a7d094e30468f05a60d455bd804f7c941">reregister_immediately_cb</a></div><div class="ttdeci">static int reregister_immediately_cb(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00900">res_pjsip_outbound_registration.c:900</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461ba7851fb9303534cf9c1d8e775d14bc7b3">SIP_REGISTRATION_REGISTERED</a></div><div class="ttdoc">Registered, yay! </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00258">res_pjsip_outbound_registration.c:258</a></div></div>
<div class="ttc" id="pbx_8h_html_ae70e64cdf669396c88ea8eda900b0b3b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ae70e64cdf669396c88ea8eda900b0b3b">ast_func_write</a></div><div class="ttdeci">int ast_func_write(struct ast_channel *chan, const char *function, const char *value)</div><div class="ttdoc">executes a write operation on a function </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00692">pbx_functions.c:692</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a994f736930117b1bdf0e0c10504baf4f"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a994f736930117b1bdf0e0c10504baf4f">reregister_all</a></div><div class="ttdeci">static void reregister_all(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01918">res_pjsip_outbound_registration.c:1918</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_aa1a3cfb170f6d562dbd938cdd5d059bb"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#aa1a3cfb170f6d562dbd938cdd5d059bb">outbound_auths_to_var_list</a></div><div class="ttdeci">static int outbound_auths_to_var_list(const void *obj, struct ast_variable **fields)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01842">res_pjsip_outbound_registration.c:1842</a></div></div>
<div class="ttc" id="structregistration__response_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../da/d4c/structregistration__response.html#a41249c16bd9cc17b36f3719debaf7a67">registration_response::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdoc">The response message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00842">res_pjsip_outbound_registration.c:842</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7e419c29ebfb010ca04b7c189c207bbd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7e419c29ebfb010ca04b7c189c207bbd">ast_sip_transport_monitor_unregister_all</a></div><div class="ttdeci">void ast_sip_transport_monitor_unregister_all(ast_transport_monitor_shutdown_cb cb, void *data, ast_transport_monitor_data_matcher matches)</div><div class="ttdoc">Unregister a transport shutdown monitor from all reliable transports. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/pjsip__transport__events_8c_source.html#l00257">pjsip_transport_events.c:257</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a9dfeb2fdce6acf9c0f869d674aa5a1c2"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">ast_sip_auth::auth_user</a></div><div class="ttdeci">const ast_string_field auth_user</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00450">res_pjsip.h:450</a></div></div>
<div class="ttc" id="structast__serializer__shutdown__group_html"><div class="ttname"><a href="../../dc/d82/structast__serializer__shutdown__group.html">ast_serializer_shutdown_group</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01215">threadpool.c:1215</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a7af2e88e6e3812ec80facb1b41df43de"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a7af2e88e6e3812ec80facb1b41df43de">ast_variable_list_append</a></div><div class="ttdeci">#define ast_variable_list_append(head, new_var)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00949">include/asterisk/config.h:949</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bae5d79a0c692c261576407232de739eab">SIP_REGISTRATION_REJECTED_TEMPORARY</a></div><div class="ttdoc">Registration was rejected, but response was temporal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00260">res_pjsip_outbound_registration.c:260</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a0be5c2e7ad5a80313f0d1fee09e7e843"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a0be5c2e7ad5a80313f0d1fee09e7e843">sip_outbound_registration_regc_alloc</a></div><div class="ttdeci">static int sip_outbound_registration_regc_alloc(void *data)</div><div class="ttdoc">Helper function that allocates a pjsip registration client and configures it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01603">res_pjsip_outbound_registration.c:1603</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_afb302970b725b934e07bbda28c9e4f23"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afb302970b725b934e07bbda28c9e4f23">ast_sip_transport_state_set_service_routes</a></div><div class="ttdeci">int ast_sip_transport_state_set_service_routes(const char *transport_name, struct ast_sip_service_route_vector *service_routes)</div><div class="ttdoc">Sets the service routes on a child transport. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00270">config_transport.c:270</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="structsip__outbound__registration__client__state_html_af75a9fa26b26315633b6691f96dbccfc"><div class="ttname"><a href="../../d8/d03/structsip__outbound__registration__client__state.html#af75a9fa26b26315633b6691f96dbccfc">sip_outbound_registration_client_state::client</a></div><div class="ttdeci">pjsip_regc * client</div><div class="ttdoc">Outbound registration client. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00352">res_pjsip_outbound_registration.c:352</a></div></div>
<div class="ttc" id="codecs_2gsm_2inc_2private_8h_html_a0b023cbb2bf7d034c2269d58d7455ac8"><div class="ttname"><a href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a></div><div class="ttdeci">short word</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da0/codecs_2gsm_2inc_2private_8h_source.html#l00012">codecs/gsm/inc/private.h:12</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_a6f2b148fd40115de7dc273247d5f28be"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a6f2b148fd40115de7dc273247d5f28be">cli_unregister</a></div><div class="ttdeci">static char * cli_unregister(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01968">res_pjsip_outbound_registration.c:1968</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
<div class="ttc" id="structast__sip__cli__context_html_a1434305066cbd59d89f4e1c0d93aa0fe"><div class="ttname"><a href="../../d6/da9/structast__sip__cli__context.html#a1434305066cbd59d89f4e1c0d93aa0fe">ast_sip_cli_context::show_details_only_level_0</a></div><div class="ttdeci">unsigned show_details_only_level_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9f/res__pjsip__cli_8h_source.html#l00046">res_pjsip_cli.h:46</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac94b7c59f69d31b962e42098955f8fa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac94b7c59f69d31b962e42098955f8fa4">ast_sip_set_tpselector_from_transport_name</a></div><div class="ttdeci">int ast_sip_set_tpselector_from_transport_name(const char *transport_name, pjsip_tpselector *selector)</div><div class="ttdoc">Sets pjsip_tpselector from ast_sip_transport. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03957">res_pjsip.c:3957</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#ac8280749471b7b24d12dee477fc2461bab2a6125e86e6f7afc8eb0a9027e64da0">SIP_REGISTRATION_STOPPED</a></div><div class="ttdoc">Registration has been stopped. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00266">res_pjsip_outbound_registration.c:266</a></div></div>
<div class="ttc" id="res__pjsip__outbound__registration_8c_html_af83744b5cee98114608743fbe2124982"><div class="ttname"><a href="../../d9/d96/res__pjsip__outbound__registration_8c.html#af83744b5cee98114608743fbe2124982">cancel_registration</a></div><div class="ttdeci">static void cancel_registration(struct sip_outbound_registration_client_state *client_state)</div><div class="ttdoc">Helper function which cancels the timer on a client. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00544">res_pjsip_outbound_registration.c:544</a></div></div>
<div class="ttc" id="structsip__outbound__registration_html_ae81f92b05f69edc98e6251688e3518da"><div class="ttname"><a href="../../df/df4/structsip__outbound__registration.html#ae81f92b05f69edc98e6251688e3518da">sip_outbound_registration::line</a></div><div class="ttdeci">unsigned int line</div><div class="ttdoc">Whether to add a line parameter to the outbound Contact or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00333">res_pjsip_outbound_registration.c:333</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:44:04 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
