<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_session.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_session.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;pjlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../df/d90/linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/df1/netsock2_8h_source.html">asterisk/netsock2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d5f/sdp__srtp_8h_source.html">asterisk/sdp_srtp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d16/codec_8h_source.html">asterisk/codec.h</a>&quot;</code><br />
<code>#include &lt;pjsip_ua.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_session.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d06/res__pjsip__session_8h__incl.png" border="0" usemap="#res__pjsip__session_8h" alt=""/></div>
<map name="res__pjsip__session_8h" id="res__pjsip__session_8h">
<area shape="rect" id="node3" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1168,453,1319,480"/>
<area shape="rect" id="node15" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="885,80,1023,107"/>
<area shape="rect" id="node22" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="1481,379,1608,405"/>
<area shape="rect" id="node41" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2335,379,2482,405"/>
<area shape="rect" id="node45" href="../../de/d5f/sdp__srtp_8h.html" title="SRTP and SDP Security descriptions. " alt="" coords="2019,80,2161,107"/>
<area shape="rect" id="node4" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1028,528,1141,555"/>
<area shape="rect" id="node6" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="559,603,621,629"/>
<area shape="rect" id="node8" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="734,677,881,704"/>
<area shape="rect" id="node11" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1081,603,1232,629"/>
<area shape="rect" id="node12" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1765,603,1892,629"/>
<area shape="rect" id="node13" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1256,603,1399,629"/>
<area shape="rect" id="node16" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="423,155,567,181"/>
<area shape="rect" id="node17" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="503,304,618,331"/>
<area shape="rect" id="node18" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="562,379,719,405"/>
<area shape="rect" id="node20" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="599,229,757,256"/>
<area shape="rect" id="node23" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="2069,379,2204,405"/>
<area shape="rect" id="node24" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="5,453,169,480"/>
<area shape="rect" id="node27" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="1036,229,1163,256"/>
<area shape="rect" id="node29" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="845,379,991,405"/>
<area shape="rect" id="node30" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="833,229,960,256"/>
<area shape="rect" id="node31" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="715,155,822,181"/>
<area shape="rect" id="node32" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="1307,379,1457,405"/>
<area shape="rect" id="node33" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="1357,229,1519,256"/>
<area shape="rect" id="node34" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="207,304,378,331"/>
<area shape="rect" id="node36" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="283,155,399,181"/>
<area shape="rect" id="node38" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="1074,155,1231,181"/>
<area shape="rect" id="node39" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1730,229,1855,256"/>
<area shape="rect" id="node44" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1611,155,1761,181"/>
<area shape="rect" id="node19" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="1684,453,1811,480"/>
<area shape="rect" id="node21" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="845,304,975,331"/>
<area shape="rect" id="node25" href="../../d9/dab/select_8h.html" title="Bitfield expansions for ast_select. " alt="" coords="157,528,284,555"/>
<area shape="rect" id="node28" href="../../d1/d84/endian_8h.html" title="Asterisk architecture endianess compatibility definitions. " alt="" coords="1050,304,1181,331"/>
<area shape="rect" id="node35" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="200,379,284,405"/>
<area shape="rect" id="node37" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="259,229,422,256"/>
<area shape="rect" id="node40" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="1629,304,1743,331"/>
<area shape="rect" id="node42" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1408,304,1553,331"/>
<area shape="rect" id="node43" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="1768,304,1892,331"/>
<area shape="rect" id="node46" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="2129,155,2285,181"/>
<area shape="rect" id="node47" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="2387,229,2513,256"/>
<area shape="rect" id="node48" href="../../de/d15/res__srtp_8h.html" title="SRTP resource. " alt="" coords="2069,304,2209,331"/>
<area shape="rect" id="node49" href="../../d5/d1f/logger__category_8h.html" title="asterisk/logger_category.h" alt="" coords="2329,453,2518,480"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d7b/res__pjsip__session_8h__dep__incl.png" border="0" usemap="#res__pjsip__session_8hdep" alt=""/></div>
<map name="res__pjsip__session_8hdep" id="res__pjsip__session_8hdep">
<area shape="rect" id="node2" href="../../d0/d29/chan__pjsip_8c.html" title="PSJIP SIP Channel Driver. " alt="" coords="5,87,105,114"/>
<area shape="rect" id="node3" href="../../d9/d6d/cli__commands_8c.html" title="PJSIP channel CLI functions. " alt="" coords="130,87,255,114"/>
<area shape="rect" id="node4" href="../../de/dfc/pjsip_2dialplan__functions_8c.html" title="PJSIP channel dialplan functions. " alt="" coords="279,87,426,114"/>
<area shape="rect" id="node5" href="../../d7/da2/res__hep__pjsip_8c.html" title="PJSIP logging with Homer. " alt="" coords="450,87,570,114"/>
<area shape="rect" id="node6" href="../../d3/d9e/pjsip__message__filter_8c.html" title="pjsip_message_filter.c" alt="" coords="594,87,757,114"/>
<area shape="rect" id="node7" href="../../d2/dc0/pjsip__session_8c.html" title="pjsip_session.c" alt="" coords="781,87,898,114"/>
<area shape="rect" id="node8" href="../../dc/d2a/res__pjsip__caller__id_8c.html" title="res_pjsip_caller_id.c" alt="" coords="921,87,1069,114"/>
<area shape="rect" id="node9" href="../../d5/da9/res__pjsip__diversion_8c.html" title="res_pjsip_diversion.c" alt="" coords="1093,87,1247,114"/>
<area shape="rect" id="node10" href="../../d2/d3b/res__pjsip__dlg__options_8c.html" title="res_pjsip_dlg_options.c" alt="" coords="1271,87,1440,114"/>
<area shape="rect" id="node11" href="../../d8/d66/res__pjsip__dtmf__info_8c.html" title="res_pjsip_dtmf_info.c" alt="" coords="1464,87,1620,114"/>
<area shape="rect" id="node12" href="../../d6/d5b/res__pjsip__empty__info_8c.html" title="res_pjsip_empty_info.c" alt="" coords="1644,87,1811,114"/>
<area shape="rect" id="node13" href="../../d6/dd6/res__pjsip__header__funcs_8c.html" title="res_pjsip_header_funcs.c" alt="" coords="1835,87,2017,114"/>
<area shape="rect" id="node14" href="../../da/d83/res__pjsip__messaging_8c.html" title="res_pjsip_messaging.c" alt="" coords="2041,87,2208,114"/>
<area shape="rect" id="node15" href="../../d4/dc3/res__pjsip__nat_8c.html" title="res_pjsip_nat.c" alt="" coords="2233,87,2350,114"/>
<area shape="rect" id="node16" href="../../d8/d41/res__pjsip__notify_8c.html" title="res_pjsip_notify.c" alt="" coords="2373,87,2503,114"/>
<area shape="rect" id="node17" href="../../dd/d7c/res__pjsip__one__touch__record__info_8c.html" title="res_pjsip_one_touch\l_record_info.c" alt="" coords="2527,80,2679,121"/>
<area shape="rect" id="node18" href="../../d9/d91/res__pjsip__path_8c.html" title="res_pjsip_path.c" alt="" coords="2703,87,2829,114"/>
<area shape="rect" id="node19" href="../../d1/d75/res__pjsip__refer_8c.html" title="res_pjsip_refer.c" alt="" coords="2853,87,2978,114"/>
<area shape="rect" id="node20" href="../../da/d5c/res__pjsip__rfc3326_8c.html" title="res_pjsip_rfc3326.c" alt="" coords="3002,87,3146,114"/>
<area shape="rect" id="node21" href="../../d5/d82/res__pjsip__sdp__rtp_8c.html" title="SIP SDP media stream handling. " alt="" coords="3170,87,3314,114"/>
<area shape="rect" id="node22" href="../../d2/d14/res__pjsip__send__to__voicemail_8c.html" title="Module for managing send to voicemail requests in SIP REFER messages against PJSIP channels..." alt="" coords="3339,87,3553,114"/>
<area shape="rect" id="node23" href="../../dc/d13/pjsip__session__caps_8c.html" title="pjsip_session_caps.c" alt="" coords="3578,87,3733,114"/>
<area shape="rect" id="node24" href="../../d4/d92/res__pjsip__session_8c.html" title="res_pjsip_session.c" alt="" coords="3757,87,3901,114"/>
<area shape="rect" id="node25" href="../../da/d84/res__pjsip__stir__shaken_8c.html" title="res_pjsip_stir_shaken.c" alt="" coords="3925,87,4095,114"/>
<area shape="rect" id="node26" href="../../dc/d80/res__pjsip__t38_8c.html" title="SIP T.38 handling. " alt="" coords="4119,87,4237,114"/>
<area shape="rect" id="node27" href="../../d2/db8/res__pjsip__transport__websocket_8c.html" title="res_pjsip_transport\l_websocket.c" alt="" coords="4261,80,4405,121"/>
<area shape="rect" id="node28" href="../../d6/d36/test__res__pjsip__session__caps_8c.html" title="res_pjsip_session format caps tests " alt="" coords="4429,80,4594,121"/>
</map>
</div>
</div>
<p><a href="../../d9/de7/res__pjsip__session_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure which contains a channel implementation and session.  <a href="../../d4/d51/structast__sip__channel__pvt.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure describing a SIP session.  <a href="../../d2/dec/structast__sip__session.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure containing SIP session media information.  <a href="../../d0/d23/structast__sip__session__media.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains read callback information.  <a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains media state information (streams, sessions)  <a href="../../de/dd5/structast__sip__session__media__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A handler for SDPs in SIP sessions.  <a href="../../d2/d29/structast__sip__session__sdp__handler.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A supplement to SIP message processing.  <a href="../../df/db8/structast__sip__session__supplement.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa21df5d2fdfb2d6e2734a3056ec3db7c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa21df5d2fdfb2d6e2734a3056ec3db7c">ast_sip_session_register_supplement</a>(supplement)&#160;&#160;&#160;<a class="el" href="../../d2/dc0/pjsip__session_8c.html#aa4ddc4ad38445110621ccfcea72ead37">ast_sip_session_register_supplement_with_module</a>(AST_MODULE_SELF, supplement)</td></tr>
<tr class="separator:aa21df5d2fdfb2d6e2734a3056ec3db7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afd7121d8247121ec6170e3411bdd98da"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#afd7121d8247121ec6170e3411bdd98da">ast_sip_session_media_read_cb</a>) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media)</td></tr>
<tr class="separator:afd7121d8247121ec6170e3411bdd98da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab727426f5a9d91957363388912fe378d"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab727426f5a9d91957363388912fe378d">ast_sip_session_media_write_cb</a>) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame)</td></tr>
<tr class="separator:ab727426f5a9d91957363388912fe378d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d9345e8ae94af746bf9b8cae9ae4e0"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:a10d9345e8ae94af746bf9b8cae9ae4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e35cdda0bf863afb19d1d954f309e5"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a83e35cdda0bf863afb19d1d954f309e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12b69e365ef6deab260e02cdf2b3ba29"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjmedia_sdp_session *sdp)</td></tr>
<tr class="separator:a12b69e365ef6deab260e02cdf2b3ba29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:abe6d95e3b5210140fce96a3985eb77b0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0">ast_sip_session_call_direction</a> { <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9">AST_SIP_SESSION_INCOMING_CALL</a> = 0, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a>
 }<tr class="memdesc:abe6d95e3b5210140fce96a3985eb77b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates the call direction respective to Asterisk.  <a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:abe6d95e3b5210140fce96a3985eb77b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6e261e955a17cce047bc3080fae195"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a> { <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e">AST_SIP_SESSION_BEFORE_REDIRECTING</a> = (1 &lt;&lt; 0), 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a> = (1 &lt;&lt; 1), 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0">AST_SIP_SESSION_AFTER_MEDIA</a> = (1 &lt;&lt; 2)
 }<tr class="memdesc:a7c6e261e955a17cce047bc3080fae195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes when a supplement should be called into on incoming responses.  <a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a7c6e261e955a17cce047bc3080fae195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4598b72ea4cbd27ae1254725d291933"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933">ast_sip_session_sdp_stream_defer</a> { <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a>
 }</td></tr>
<tr class="separator:ad4598b72ea4cbd27ae1254725d291933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62cd8d9efeeb8507ea3b9ce909a822a3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3">ast_sip_session_t38state</a> { <br />
&#160;&#160;<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3ad668e592cef9a8e9e5a330cb1b45c46f">T38_DISABLED</a> = 0, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a31b6eff4254a18d6357535c2b3110385">T38_LOCAL_REINVITE</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a306c88a911bc77eaac89b4299d9da840">T38_PEER_REINVITE</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a56d613ef79d68640e76a8254bdfe1054">T38_ENABLED</a>, 
<br />
&#160;&#160;<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3aa9118ef3a002948047052c45eb39fe12">T38_REJECTED</a>, 
<a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a454fbbbe2793bb4fc5a5bb554aeb02ff">T38_MAX_ENUM</a>
<br />
 }<tr class="memdesc:a62cd8d9efeeb8507ea3b9ce909a822a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">T.38 states for a session.  <a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a62cd8d9efeeb8507ea3b9ce909a822a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a95cafef155609ea0d35d60b178902941"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a95cafef155609ea0d35d60b178902941">ast_sip_channel_pvt_alloc</a> (void *pvt, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a95cafef155609ea0d35d60b178902941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new SIP channel pvt structure.  <a href="#a95cafef155609ea0d35d60b178902941">More...</a><br /></td></tr>
<tr class="separator:a95cafef155609ea0d35d60b178902941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a> (pjsip_dialog *dlg)</td></tr>
<tr class="memdesc:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a session from a dialog.  <a href="#a908cdf7ba25c4d6f3d2efdf01f0125ca">More...</a><br /></td></tr>
<tr class="separator:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a6d3bc4b6c4bdd1a98347a2b33a35b517">ast_sip_session_add_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr class="memdesc:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a datastore to a SIP session.  <a href="#a6d3bc4b6c4bdd1a98347a2b33a35b517">More...</a><br /></td></tr>
<tr class="separator:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6cefb7bfc8ff5bf254b8bbd56c443d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a6c6cefb7bfc8ff5bf254b8bbd56c443d">ast_sip_session_add_supplements</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a6c6cefb7bfc8ff5bf254b8bbd56c443d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add supplements to a SIP session.  <a href="#a6c6cefb7bfc8ff5bf254b8bbd56c443d">More...</a><br /></td></tr>
<tr class="separator:a6c6cefb7bfc8ff5bf254b8bbd56c443d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a868929ef02d6469dbae49fcedaf26"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa6a868929ef02d6469dbae49fcedaf26">ast_sip_session_alloc</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="el" href="../../d9/d03/structcontact.html">contact</a>, pjsip_inv_session *inv, pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:aa6a868929ef02d6469dbae49fcedaf26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new SIP session.  <a href="#aa6a868929ef02d6469dbae49fcedaf26">More...</a><br /></td></tr>
<tr class="separator:aa6a868929ef02d6469dbae49fcedaf26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28af3f44693710b56fb141c509a5eb9d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a28af3f44693710b56fb141c509a5eb9d">ast_sip_session_alloc_datastore</a> (const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *info, const char *uid)</td></tr>
<tr class="memdesc:a28af3f44693710b56fb141c509a5eb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a>  <a href="#a28af3f44693710b56fb141c509a5eb9d">More...</a><br /></td></tr>
<tr class="separator:a28af3f44693710b56fb141c509a5eb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73c173cbf6b282f81a445ed05050cb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa73c173cbf6b282f81a445ed05050cb9">ast_sip_session_create_invite</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data **tdata)</td></tr>
<tr class="memdesc:aa73c173cbf6b282f81a445ed05050cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an INVITE request.  <a href="#aa73c173cbf6b282f81a445ed05050cb9">More...</a><br /></td></tr>
<tr class="separator:aa73c173cbf6b282f81a445ed05050cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae415668ea4e21bd1a053dece640e2f46"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ae415668ea4e21bd1a053dece640e2f46">ast_sip_session_create_outgoing</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="el" href="../../d9/d03/structcontact.html">contact</a>, const char *location, const char *request_user, struct <a class="el" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *req_topology)</td></tr>
<tr class="memdesc:ae415668ea4e21bd1a053dece640e2f46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new outgoing SIP session.  <a href="#ae415668ea4e21bd1a053dece640e2f46">More...</a><br /></td></tr>
<tr class="separator:ae415668ea4e21bd1a053dece640e2f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab099805fb795c60964dff130d6d15165"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab099805fb795c60964dff130d6d15165">ast_sip_session_defer_termination</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:ab099805fb795c60964dff130d6d15165"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defer local termination of a session until remote side terminates, or an amount of time passes.  <a href="#ab099805fb795c60964dff130d6d15165">More...</a><br /></td></tr>
<tr class="separator:ab099805fb795c60964dff130d6d15165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587c035e9aae3bf37049f886dc29dcb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a587c035e9aae3bf37049f886dc29dcb6">ast_sip_session_defer_termination_cancel</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a587c035e9aae3bf37049f886dc29dcb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel a pending deferred termination.  <a href="#a587c035e9aae3bf37049f886dc29dcb6">More...</a><br /></td></tr>
<tr class="separator:a587c035e9aae3bf37049f886dc29dcb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55296422ab86c7de1d7f52e9c227d82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa55296422ab86c7de1d7f52e9c227d82">ast_sip_session_end_if_deferred</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:aa55296422ab86c7de1d7f52e9c227d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">End the session if it had been previously deferred.  <a href="#aa55296422ab86c7de1d7f52e9c227d82">More...</a><br /></td></tr>
<tr class="separator:aa55296422ab86c7de1d7f52e9c227d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6e787aa2429e93f12e7be624ec3970"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a0b6e787aa2429e93f12e7be624ec3970">ast_sip_session_get_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a0b6e787aa2429e93f12e7be624ec3970"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a session datastore.  <a href="#a0b6e787aa2429e93f12e7be624ec3970">More...</a><br /></td></tr>
<tr class="separator:a0b6e787aa2429e93f12e7be624ec3970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95797137ac1484fe2214be36db22f6dd"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a> (const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a95797137ac1484fe2214be36db22f6dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the channel or endpoint name associated with the session.  <a href="#a95797137ac1484fe2214be36db22f6dd">More...</a><br /></td></tr>
<tr class="separator:a95797137ac1484fe2214be36db22f6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d96ab8cbcc0f85012300573e3db2900"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a> (const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream)</td></tr>
<tr class="memdesc:a4d96ab8cbcc0f85012300573e3db2900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a provided pending stream will be the default stream or not.  <a href="#a4d96ab8cbcc0f85012300573e3db2900">More...</a><br /></td></tr>
<tr class="separator:a4d96ab8cbcc0f85012300573e3db2900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bfa7d54f046b76d00644d3e650af6cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a6bfa7d54f046b76d00644d3e650af6cd">ast_sip_session_media_add_read_callback</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, int fd, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#afd7121d8247121ec6170e3411bdd98da">ast_sip_session_media_read_cb</a> callback)</td></tr>
<tr class="memdesc:a6bfa7d54f046b76d00644d3e650af6cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a read callback for a media session with a specific file descriptor.  <a href="#a6bfa7d54f046b76d00644d3e650af6cd">More...</a><br /></td></tr>
<tr class="separator:a6bfa7d54f046b76d00644d3e650af6cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29930c927d55f4f7a615a11766a6a09"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa29930c927d55f4f7a615a11766a6a09">ast_sip_session_media_get_transport</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media)</td></tr>
<tr class="memdesc:aa29930c927d55f4f7a615a11766a6a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the underlying media session that is acting as transport for a media session.  <a href="#aa29930c927d55f4f7a615a11766a6a09">More...</a><br /></td></tr>
<tr class="separator:aa29930c927d55f4f7a615a11766a6a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae799be93a0bc786802a9404362b236fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ae799be93a0bc786802a9404362b236fa">ast_sip_session_media_set_write_callback</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab727426f5a9d91957363388912fe378d">ast_sip_session_media_write_cb</a> callback)</td></tr>
<tr class="memdesc:ae799be93a0bc786802a9404362b236fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a write callback for a media session.  <a href="#ae799be93a0bc786802a9404362b236fa">More...</a><br /></td></tr>
<tr class="separator:ae799be93a0bc786802a9404362b236fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0018e2a2f5cae3abe84426c44fee908"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state, enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, int position)</td></tr>
<tr class="memdesc:ae0018e2a2f5cae3abe84426c44fee908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate an ast_session_media and add it to the media state's vector.  <a href="#ae0018e2a2f5cae3abe84426c44fee908">More...</a><br /></td></tr>
<tr class="separator:ae0018e2a2f5cae3abe84426c44fee908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a> (void)</td></tr>
<tr class="memdesc:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a session media state structure.  <a href="#a0a9996be2e7d0a6fe7df55098932f5f6">More...</a><br /></td></tr>
<tr class="separator:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c9ec6c960e59090e7c6301c1bce890"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a> (const struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:a76c9ec6c960e59090e7c6301c1bce890"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone a media state.  <a href="#a76c9ec6c960e59090e7c6301c1bce890">More...</a><br /></td></tr>
<tr class="separator:a76c9ec6c960e59090e7c6301c1bce890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a52106819ac5621fe89579644d4afd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:a8a52106819ac5621fe89579644d4afd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a session media state structure.  <a href="#a8a52106819ac5621fe89579644d4afd3">More...</a><br /></td></tr>
<tr class="separator:a8a52106819ac5621fe89579644d4afd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02f331ac12ec53a9f072a9862405055"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:ae02f331ac12ec53a9f072a9862405055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a media state to a clean state.  <a href="#ae02f331ac12ec53a9f072a9862405055">More...</a><br /></td></tr>
<tr class="separator:ae02f331ac12ec53a9f072a9862405055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57bfc75550b1312b46ef584410ae8a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *sip_session, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:af57bfc75550b1312b46ef584410ae8a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a media stats.  <a href="#af57bfc75550b1312b46ef584410ae8a9">More...</a><br /></td></tr>
<tr class="separator:af57bfc75550b1312b46ef584410ae8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45a3852c5bef6bf3719080907f02a42"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ae45a3852c5bef6bf3719080907f02a42">ast_sip_session_refresh</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a> on_request_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response, enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, int generate_new_sdp, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:ae45a3852c5bef6bf3719080907f02a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a reinvite or UPDATE on a session.  <a href="#ae45a3852c5bef6bf3719080907f02a42">More...</a><br /></td></tr>
<tr class="separator:ae45a3852c5bef6bf3719080907f02a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c6ebf48a77449c1058861ff70a958a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a11c6ebf48a77449c1058861ff70a958a">ast_sip_session_regenerate_answer</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation)</td></tr>
<tr class="memdesc:a11c6ebf48a77449c1058861ff70a958a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regenerate SDP Answer.  <a href="#a11c6ebf48a77449c1058861ff70a958a">More...</a><br /></td></tr>
<tr class="separator:a11c6ebf48a77449c1058861ff70a958a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">ast_sip_session_register_sdp_handler</a> (struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *stream_type)</td></tr>
<tr class="memdesc:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register an SDP handler.  <a href="#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">More...</a><br /></td></tr>
<tr class="separator:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ddc4ad38445110621ccfcea72ead37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aa4ddc4ad38445110621ccfcea72ead37">ast_sip_session_register_supplement_with_module</a> (struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *module, struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement)</td></tr>
<tr class="memdesc:aa4ddc4ad38445110621ccfcea72ead37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a supplement to SIP session processing.  <a href="#aa4ddc4ad38445110621ccfcea72ead37">More...</a><br /></td></tr>
<tr class="separator:aa4ddc4ad38445110621ccfcea72ead37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80752332a327901006cee3a209c03968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a80752332a327901006cee3a209c03968">ast_sip_session_remove_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a80752332a327901006cee3a209c03968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a session datastore from the session.  <a href="#a80752332a327901006cee3a209c03968">More...</a><br /></td></tr>
<tr class="separator:a80752332a327901006cee3a209c03968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6b10ea506d88abcd42bb8373dcb2c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a4c6b10ea506d88abcd42bb8373dcb2c4">ast_sip_session_remove_supplements</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a4c6b10ea506d88abcd42bb8373dcb2c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove supplements from a SIP session.  <a href="#a4c6b10ea506d88abcd42bb8373dcb2c4">More...</a><br /></td></tr>
<tr class="separator:a4c6b10ea506d88abcd42bb8373dcb2c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#add9e11223bb5b1c0e9ca30678e97dc0f">ast_sip_session_resume_reinvite</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resumes processing of a deferred incoming re-invite.  <a href="#add9e11223bb5b1c0e9ca30678e97dc0f">More...</a><br /></td></tr>
<tr class="separator:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP request.  <a href="#a35a7aa9427f3aea9384c1a481ce6a5f3">More...</a><br /></td></tr>
<tr class="separator:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response)</td></tr>
<tr class="memdesc:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP request and get called back when a response is received.  <a href="#a6e71dd1b8a6901e044953ff9e3a0343d">More...</a><br /></td></tr>
<tr class="separator:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed4c9a6bf6967790981c02027f5f02e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:aed4c9a6bf6967790981c02027f5f02e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP response.  <a href="#aed4c9a6bf6967790981c02027f5f02e8">More...</a><br /></td></tr>
<tr class="separator:aed4c9a6bf6967790981c02027f5f02e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#af07a4b2b3de4cbbd66b09acb55ca3c5e">ast_sip_session_suspend</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request and wait for the session serializer to be suspended.  <a href="#af07a4b2b3de4cbbd66b09acb55ca3c5e">More...</a><br /></td></tr>
<tr class="separator:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac548e363175ba43f7ad75438729deac3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, int response)</td></tr>
<tr class="memdesc:ac548e363175ba43f7ad75438729deac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminate a session and, if possible, send the provided response code.  <a href="#ac548e363175ba43f7ad75438729deac3">More...</a><br /></td></tr>
<tr class="separator:ac548e363175ba43f7ad75438729deac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d632ac85810d8394ad5d54b83a2f87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a22d632ac85810d8394ad5d54b83a2f87">ast_sip_session_unregister_sdp_handler</a> (struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *stream_type)</td></tr>
<tr class="memdesc:a22d632ac85810d8394ad5d54b83a2f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister an SDP handler.  <a href="#a22d632ac85810d8394ad5d54b83a2f87">More...</a><br /></td></tr>
<tr class="separator:a22d632ac85810d8394ad5d54b83a2f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae89632996ffdcf888ab251c14dc6cdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#aae89632996ffdcf888ab251c14dc6cdb">ast_sip_session_unregister_supplement</a> (struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement)</td></tr>
<tr class="memdesc:aae89632996ffdcf888ab251c14dc6cdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a an supplement to SIP session processing.  <a href="#aae89632996ffdcf888ab251c14dc6cdb">More...</a><br /></td></tr>
<tr class="separator:aae89632996ffdcf888ab251c14dc6cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ac37f93342a3e8ca33fb4ca84d4ac3e58">ast_sip_session_unsuspend</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request the session serializer be unsuspended.  <a href="#ac37f93342a3e8ca33fb4ca84d4ac3e58">More...</a><br /></td></tr>
<tr class="separator:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa21df5d2fdfb2d6e2734a3056ec3db7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21df5d2fdfb2d6e2734a3056ec3db7c">&#9670;&nbsp;</a></span>ast_sip_session_register_supplement</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_sip_session_register_supplement</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">supplement</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="../../d2/dc0/pjsip__session_8c.html#aa4ddc4ad38445110621ccfcea72ead37">ast_sip_session_register_supplement_with_module</a>(AST_MODULE_SELF, supplement)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00616">616</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9e/pjsip__message__filter_8c_source.html#l00573">ast_res_pjsip_init_message_filter()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03304">load_module()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afd7121d8247121ec6170e3411bdd98da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7121d8247121ec6170e3411bdd98da">&#9670;&nbsp;</a></span>ast_sip_session_media_read_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a>*(* ast_sip_session_media_read_cb) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00068">68</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

</div>
</div>
<a id="ab727426f5a9d91957363388912fe378d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab727426f5a9d91957363388912fe378d">&#9670;&nbsp;</a></span>ast_sip_session_media_write_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sip_session_media_write_cb) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00069">69</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

</div>
</div>
<a id="a10d9345e8ae94af746bf9b8cae9ae4e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d9345e8ae94af746bf9b8cae9ae4e0">&#9670;&nbsp;</a></span>ast_sip_session_request_creation_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sip_session_request_creation_cb) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00246">246</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

</div>
</div>
<a id="a83e35cdda0bf863afb19d1d954f309e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e35cdda0bf863afb19d1d954f309e5">&#9670;&nbsp;</a></span>ast_sip_session_response_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sip_session_response_cb) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00247">247</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

</div>
</div>
<a id="a12b69e365ef6deab260e02cdf2b3ba29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12b69e365ef6deab260e02cdf2b3ba29">&#9670;&nbsp;</a></span>ast_sip_session_sdp_creation_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sip_session_sdp_creation_cb) (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjmedia_sdp_session *sdp)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00248">248</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="abe6d95e3b5210140fce96a3985eb77b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe6d95e3b5210140fce96a3985eb77b0">&#9670;&nbsp;</a></span>ast_sip_session_call_direction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0">ast_sip_session_call_direction</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates the call direction respective to Asterisk. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9"></a>AST_SIP_SESSION_INCOMING_CALL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c"></a>AST_SIP_SESSION_OUTGOING_CALL&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00166">166</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9">AST_SIP_SESSION_INCOMING_CALL</a> = 0,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a>,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8h_html_abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9">AST_SIP_SESSION_INCOMING_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00167">res_pjsip_session.h:167</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00168">res_pjsip_session.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6e261e955a17cce047bc3080fae195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6e261e955a17cce047bc3080fae195">&#9670;&nbsp;</a></span>ast_sip_session_response_priority</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Describes when a supplement should be called into on incoming responses. </p>
<p>In most cases, session supplements will not need to worry about this because in most cases, the correct value will be automatically applied. However, there are rare circumstances when a supplement will want to specify when it should be called.</p>
<p>The values below are listed in chronological order. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e"></a>AST_SIP_SESSION_BEFORE_REDIRECTING&#160;</td><td class="fielddoc"><p>When processing 3XX responses, the supplement is called into before the redirecting information is processed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6"></a>AST_SIP_SESSION_BEFORE_MEDIA&#160;</td><td class="fielddoc"><p>For responses to INVITE transactions, the supplement is called into before media is negotiated.</p>
<p>This priority is applied by default to any session supplement that does not specify a response priority. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0"></a>AST_SIP_SESSION_AFTER_MEDIA&#160;</td><td class="fielddoc"><p>For INVITE transactions, the supplement is called into after media is negotiated. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00259">259</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                       {<span class="comment"></span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    * When processing 3XX responses, the supplement is called into before</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    * the redirecting information is processed.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e">AST_SIP_SESSION_BEFORE_REDIRECTING</a> = (1 &lt;&lt; 0),<span class="comment"></span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    * For responses to INVITE transactions, the supplement is called into</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    * before media is negotiated.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    * This priority is applied by default to any session supplement that</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    * does not specify a response priority.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a> = (1 &lt;&lt; 1),<span class="comment"></span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    * For INVITE transactions, the supplement is called into after media</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    * is negotiated.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0">AST_SIP_SESSION_AFTER_MEDIA</a> = (1 &lt;&lt; 2),</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00272">res_pjsip_session.h:272</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e">AST_SIP_SESSION_BEFORE_REDIRECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00264">res_pjsip_session.h:264</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0">AST_SIP_SESSION_AFTER_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00277">res_pjsip_session.h:277</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4598b72ea4cbd27ae1254725d291933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4598b72ea4cbd27ae1254725d291933">&#9670;&nbsp;</a></span>ast_sip_session_sdp_stream_defer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933">ast_sip_session_sdp_stream_defer</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846"></a>AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED&#160;</td><td class="fielddoc"><p>The stream was not handled by this handler. If there are other registered handlers for this stream type, they will be called. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529"></a>AST_SIP_SESSION_SDP_DEFER_ERROR&#160;</td><td class="fielddoc"><p>There was an error encountered. No further operations will take place and the current negotiation will be abandoned. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a"></a>AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED&#160;</td><td class="fielddoc"><p>Re-invite is not needed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a"></a>AST_SIP_SESSION_SDP_DEFER_NEEDED&#160;</td><td class="fielddoc"><p>Re-invite should be deferred and will be resumed later. No further operations will take place. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00363">363</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                      {<span class="comment"></span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">   /*! The stream was not handled by this handler. If there are other registered handlers for this stream type, they will be called. */</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a>,<span class="comment"></span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">   /*! There was an error encountered. No further operations will take place and the current negotiation will be abandoned. */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a>,<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">   /*! Re-invite is not needed */</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a>,<span class="comment"></span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">   /*! Re-invite should be deferred and will be resumed later. No further operations will take place. */</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a>,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00371">res_pjsip_session.h:371</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00369">res_pjsip_session.h:369</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00367">res_pjsip_session.h:367</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00365">res_pjsip_session.h:365</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62cd8d9efeeb8507ea3b9ce909a822a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62cd8d9efeeb8507ea3b9ce909a822a3">&#9670;&nbsp;</a></span>ast_sip_session_t38state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3">ast_sip_session_t38state</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>T.38 states for a session. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3ad668e592cef9a8e9e5a330cb1b45c46f"></a>T38_DISABLED&#160;</td><td class="fielddoc"><p>Not enabled </p>
</td></tr>
<tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3a31b6eff4254a18d6357535c2b3110385"></a>T38_LOCAL_REINVITE&#160;</td><td class="fielddoc"><p>Offered from local - REINVITE </p>
</td></tr>
<tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3a306c88a911bc77eaac89b4299d9da840"></a>T38_PEER_REINVITE&#160;</td><td class="fielddoc"><p>Offered from peer - REINVITE </p>
</td></tr>
<tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3a56d613ef79d68640e76a8254bdfe1054"></a>T38_ENABLED&#160;</td><td class="fielddoc"><p>Negotiated (enabled) </p>
</td></tr>
<tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3aa9118ef3a002948047052c45eb39fe12"></a>T38_REJECTED&#160;</td><td class="fielddoc"><p>Refused </p>
</td></tr>
<tr><td class="fieldname"><a id="a62cd8d9efeeb8507ea3b9ce909a822a3a454fbbbe2793bb4fc5a5bb554aeb02ff"></a>T38_MAX_ENUM&#160;</td><td class="fielddoc"><p>Not an actual state; used as max value in the enum </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00054">54</a> of file <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">res_pjsip_session.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                              {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3ad668e592cef9a8e9e5a330cb1b45c46f">T38_DISABLED</a> = 0,   <span class="comment">/*!&lt; Not enabled */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a31b6eff4254a18d6357535c2b3110385">T38_LOCAL_REINVITE</a>, <span class="comment">/*!&lt; Offered from local - REINVITE */</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a306c88a911bc77eaac89b4299d9da840">T38_PEER_REINVITE</a>,  <span class="comment">/*!&lt; Offered from peer - REINVITE */</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a56d613ef79d68640e76a8254bdfe1054">T38_ENABLED</a>,        <span class="comment">/*!&lt; Negotiated (enabled) */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3aa9118ef3a002948047052c45eb39fe12">T38_REJECTED</a>,       <span class="comment">/*!&lt; Refused */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a454fbbbe2793bb4fc5a5bb554aeb02ff">T38_MAX_ENUM</a>,       <span class="comment">/*!&lt; Not an actual state; used as max value in the enum */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3a56d613ef79d68640e76a8254bdfe1054"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a56d613ef79d68640e76a8254bdfe1054">T38_ENABLED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00058">res_pjsip_session.h:58</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3a454fbbbe2793bb4fc5a5bb554aeb02ff"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a454fbbbe2793bb4fc5a5bb554aeb02ff">T38_MAX_ENUM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00060">res_pjsip_session.h:60</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3a31b6eff4254a18d6357535c2b3110385"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a31b6eff4254a18d6357535c2b3110385">T38_LOCAL_REINVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00056">res_pjsip_session.h:56</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3ad668e592cef9a8e9e5a330cb1b45c46f"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3ad668e592cef9a8e9e5a330cb1b45c46f">T38_DISABLED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00055">res_pjsip_session.h:55</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3a306c88a911bc77eaac89b4299d9da840"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3a306c88a911bc77eaac89b4299d9da840">T38_PEER_REINVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00057">res_pjsip_session.h:57</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a62cd8d9efeeb8507ea3b9ce909a822a3aa9118ef3a002948047052c45eb39fe12"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a62cd8d9efeeb8507ea3b9ce909a822a3aa9118ef3a002948047052c45eb39fe12">T38_REJECTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00059">res_pjsip_session.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a95cafef155609ea0d35d60b178902941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cafef155609ea0d35d60b178902941">&#9670;&nbsp;</a></span>ast_sip_channel_pvt_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a>* ast_sip_channel_pvt_alloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new SIP channel pvt structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvt</td><td>Pointer to channel specific information </td></tr>
    <tr><td class="paramname">session</td><td>Pointer to SIP session</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02974">2974</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">ast_sip_channel_pvt::pvt</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">ast_sip_channel_pvt::session</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02966">sip_channel_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00547">chan_pjsip_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;{</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a> *<a class="code" href="../../d4/d84/structchannel.html">channel</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*channel), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a92471759f1f84a29c1cf773bb83b7807">sip_channel_destroy</a>);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   <span class="keywordflow">if</span> (!channel) {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   }</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a>, +1);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;   channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a> = <a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a>;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">session</a> = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;   <span class="keywordflow">return</span> channel;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;}</div><div class="ttc" id="structast__sip__channel__pvt_html_a77153a7ab7ba05031fbbb4e67aa9dcfc"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">ast_sip_channel_pvt::pvt</a></div><div class="ttdeci">void * pvt</div><div class="ttdoc">Pointer to channel specific implementation information, must be ao2 object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">res_pjsip_session.h:468</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a></div><div class="ttdoc">A structure which contains a channel implementation and session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00466">res_pjsip_session.h:466</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html_a47bd1bb949183a58a194970acaccffbd"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">ast_sip_channel_pvt::session</a></div><div class="ttdeci">struct ast_sip_session * session</div><div class="ttdoc">Pointer to session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">res_pjsip_session.h:470</a></div></div>
<div class="ttc" id="structchannel_html"><div class="ttname"><a href="../../d4/d84/structchannel.html">channel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00095">muted.c:95</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a92471759f1f84a29c1cf773bb83b7807"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a92471759f1f84a29c1cf773bb83b7807">sip_channel_destroy</a></div><div class="ttdeci">static void sip_channel_destroy(void *obj)</div><div class="ttdoc">Destructor for SIP channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02966">res_pjsip_session.c:2966</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a908cdf7ba25c4d6f3d2efdf01f0125ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908cdf7ba25c4d6f3d2efdf01f0125ca">&#9670;&nbsp;</a></span>ast_sip_dialog_get_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_dialog_get_session </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves a session from a dialog. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlg</td><td>The dialog to retrieve the session from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>if session exists </td></tr>
    <tr><td class="paramname">NULL</td><td>if no session</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The reference count of the session is increased when returned</dd>
<dd>
This function <em>must</em> be called with the dialog locked </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">3630</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/da2/res__hep__pjsip_8c_source.html#l00047">assign_uuid()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00969">refer_incoming_invite_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">session_reinvite_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;{</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;   pjsip_inv_session *inv_session = pjsip_dlg_get_inv_session(dlg);</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;   <span class="keywordflow">if</span> (!inv_session ||</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      !(session = inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id])) {</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;   }</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d3bc4b6c4bdd1a98347a2b33a35b517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3bc4b6c4bdd1a98347a2b33a35b517">&#9670;&nbsp;</a></span>ast_sip_session_add_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_add_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td>
          <td class="paramname"><em>datastore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a datastore to a SIP session. </p>
<p>Note that SIP uses reference counted datastores. The datastore passed into this function must have been allocated using <a class="el" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc()</a> or there will be serious problems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to add the datastore to </td></tr>
    <tr><td class="paramname">datastore</td><td>The datastore to be added to the session </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01273">1273</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00071">ast_datastore::info</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00125">handle_incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;{</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(datastore != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">info</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>) == 0);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, datastore)) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__datastore_html_a03ea21247b5d39b165343431b44131f1"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">ast_datastore::info</a></div><div class="ttdeci">const struct ast_datastore_info * info</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00071">datastore.h:71</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c6cefb7bfc8ff5bf254b8bbd56c443d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6cefb7bfc8ff5bf254b8bbd56c443d">&#9670;&nbsp;</a></span>ast_sip_session_add_supplements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_add_supplements </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add supplements to a SIP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to initialize </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00090">90</a> of file <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html">pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00443">ast_module_ref</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l04629">copy()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">ast_sip_session_supplement::module</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00581">SCOPED_LOCK</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00077">supplement_dup()</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a> = <a class="code" href="../../d2/dc0/pjsip__session_8c.html#a637f6f23c5312fd0b1e66fa51d8ecd86">supplement_dup</a>(iter);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span> (!copy) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">/* referenced session created. increasing module reference. */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a>(copy-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, copy, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="app__voicemail_8c_html_abe15777a07ac747625b018ac01f92531"><div class="ttname"><a href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a></div><div class="ttdeci">static int copy(char *infile, char *outfile)</div><div class="ttdoc">Utility function to copy a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l04629">app_voicemail.c:4629</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="lock_8h_html_a8b9d9f2f2c41ecf3c70587c2510dddfc"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a></div><div class="ttdeci">#define SCOPED_LOCK(varname, lock, lockfunc, unlockfunc)</div><div class="ttdoc">Scoped Locks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00581">lock.h:581</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_sip_session_supplement::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">res_pjsip_session.h:288</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="structsession__supplements_html"><div class="ttname"><a href="../../d9/d91/structsession__supplements.html">session_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00033">pjsip_session.c:33</a></div></div>
<div class="ttc" id="pjsip__session_8c_html_a637f6f23c5312fd0b1e66fa51d8ecd86"><div class="ttname"><a href="../../d2/dc0/pjsip__session_8c.html#a637f6f23c5312fd0b1e66fa51d8ecd86">supplement_dup</a></div><div class="ttdeci">static struct ast_sip_session_supplement * supplement_dup(const struct ast_sip_session_supplement *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00077">pjsip_session.c:77</a></div></div>
<div class="ttc" id="module_8h_html_a8dea6491bedba471fc44574d76438577"><div class="ttname"><a href="../../d5/d16/module_8h.html#a8dea6491bedba471fc44574d76438577">ast_module_ref</a></div><div class="ttdeci">#define ast_module_ref(mod)</div><div class="ttdoc">Hold a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00443">module.h:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6a868929ef02d6469dbae49fcedaf26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a868929ef02d6469dbae49fcedaf26">&#9670;&nbsp;</a></span>ast_sip_session_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_session_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *&#160;</td>
          <td class="paramname"><em>contact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new SIP session. </p>
<p>This will take care of allocating the datastores container on the session as well as placing all registered supplements onto the session.</p>
<p>The endpoint that is passed in will have its reference count increased by one since the session will be keeping a reference to the endpoint. The session will relinquish this reference when the session is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that this session communicates with </td></tr>
    <tr><td class="paramname">contact</td><td>The contact associated with this session </td></tr>
    <tr><td class="paramname">inv_session</td><td>The PJSIP INVITE session data </td></tr>
    <tr><td class="paramname">rdata</td><td>INVITE request received (NULL if for outgoing allocation) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">2990</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01755">ast_dsp_set_features()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00625">AST_LIST_HEAD_INIT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00680">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01757">ast_party_id_init()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">ast_sip_create_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">ast_sip_dialog_set_endpoint()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">ast_sip_dialog_set_serializer()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00419">AST_SIP_DTMF_AUTO</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00415">AST_SIP_DTMF_INBAND</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">ast_sip_get_distributor_serializer()</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00090">ast_sip_session_add_supplements()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">ast_sip_session_media_state_alloc()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01295">ast_taskprocessor_build_name()</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00060">AST_TASKPROCESSOR_MAX_NAME</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">ast_sip_session::authentication_challenge_count</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00185">ast_sip_session::contact</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01226">DATASTORE_BUCKETS</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02888">datastore_cmp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02878">datastore_hash()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00203">ast_sip_session::direct_media_cap</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00213">ast_sip_session::dsp</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00028">DSP_FEATURE_DIGIT_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00029">DSP_FEATURE_FAX_DETECT</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00233">ast_sip_session::dtmf</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00857">ast_sip_endpoint::dtmf</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00869">ast_sip_endpoint::faxdetect</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04415">handle_session_begin()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00231">ast_sip_session::moh_passthrough</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00879">ast_sip_endpoint::moh_passthrough</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">ast_sip_session_create_outgoing()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;{</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *ret_session;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;   <span class="keywordtype">int</span> dsp_features = 0;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a>);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>) {</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;   }</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6f42d3bf45cc9af6f794d9d1cf8c45ca">AST_LIST_HEAD_INIT</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;supplements);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;delayed_requests);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;id);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;direct_media_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;direct_media_cap) {</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;datastores = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae586d6908c81e9a59e0e68358c12c9cc">datastore_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac60c8c7a11b9aa2b347630c7d08af17d">datastore_cmp</a>);</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;datastores) {</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;   }</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;active_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a>();</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;active_media_state) {</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   }</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a>();</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state) {</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   }</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;media_stats, 1) &lt; 0) {</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   }</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   <span class="keywordflow">if</span> (endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8">AST_SIP_DTMF_INBAND</a> || endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b">AST_SIP_DTMF_AUTO</a>) {</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      dsp_features |= <a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a>;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;   }</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   <span class="keywordflow">if</span> (endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#af8a29ee5509cdaf8e4a85c7f81fd4b25">faxdetect</a>) {</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      dsp_features |= <a class="code" href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a>;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   }</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;   <span class="keywordflow">if</span> (dsp_features) {</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp = <a class="code" href="../../d3/d08/dsp_8h.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a>();</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp) {</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      <a class="code" href="../../d3/d08/dsp_8h.html#aedc7fa20fba91e3c018f6989e95c714b">ast_dsp_set_features</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp, dsp_features);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;   }</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;endpoint = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(endpoint);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   <span class="keywordflow">if</span> (rdata) {</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment">       * We must continue using the serializer that the original</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">       * INVITE came in on for the dialog.  There may be</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">       * retransmissions already enqueued in the original</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">       * serializer that can result in reentrancy and message</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment">       * sequencing problems.</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a>(rdata);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordtype">char</span> tps_name[<a class="code" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a> + 1];</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <span class="comment">/* Create name with seq number appended. */</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a>(tps_name, <span class="keyword">sizeof</span>(tps_name), <span class="stringliteral">&quot;pjsip/outsess/%s&quot;</span>,</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a>(tps_name);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;   }</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer) {</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   }</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a>(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a>(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, endpoint);</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   <span class="comment">/* When a PJSIP INVITE session is created it is created with a reference</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">    * count of 1, with that reference being managed by the underlying state</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">    * of the INVITE session itself. When the INVITE session transitions to</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">    * a DISCONNECTED state that reference is released. This means we can not</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">    * rely on that reference to ensure the INVITE session remains for the</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">    * lifetime of our session. To ensure it does we add our own reference</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">    * and release it when our own session goes away, ensuring that the INVITE</span></div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">    * session remains for the lifetime of session.</span></div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_INV_SESSION_REF</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_add_ref(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Can&#39;t increase the session reference counter\n&quot;</span>);</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   }</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;   pjsip_dlg_inc_session(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   <a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;contact = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(contact);</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;inv_session = <a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dtmf = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a>;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;moh_passthrough = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a56458fcd1003f7554cee73c7f0346cbb">moh_passthrough</a>;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a6c6cefb7bfc8ff5bf254b8bbd56c443d">ast_sip_session_add_supplements</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="comment">/* Release the ref held by session-&gt;inv_session */</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   }</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;authentication_challenge_count = 0;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   <span class="comment">/* Fire seesion begin handlers */</span></div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3533f635938c655112221b97eac4884a">handle_session_begin</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>);</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   <span class="comment">/* Avoid unnecessary ref manipulation to return a session */</span></div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   ret_session = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   <span class="keywordflow">return</span> ret_session;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;}</div><div class="ttc" id="structast__sip__endpoint_html_abb7c899dc9afe319240163be2b213813"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">ast_sip_endpoint::dtmf</a></div><div class="ttdeci">enum ast_sip_dtmf_mode dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00857">res_pjsip.h:857</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ab47623e207bf2cdd0edfa613d91894e5"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a></div><div class="ttdeci">void ast_taskprocessor_build_name(char *buf, unsigned int size, const char *format,...)</div><div class="ttdoc">Build a taskprocessor name with a sequence number on the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01295">taskprocessor.c:1295</a></div></div>
<div class="ttc" id="dsp_8h_html_a84818b360426bdd5f588cdca463e15be"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_DIGIT_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00028">dsp.h:28</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga86c62fe22e3b7fb409c13ec7fd4fee2d"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a></div><div class="ttdeci">void ast_sip_dialog_set_serializer(pjsip_dialog *dlg, struct ast_taskprocessor *serializer)</div><div class="ttdoc">Set a serializer on a SIP dialog so requests and responses are automatically serialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">pjsip_distributor.c:266</a></div></div>
<div class="ttc" id="dsp_8h_html_a0a60e93006c8e1ca8fda922ae0e0da2c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a></div><div class="ttdeci">struct ast_dsp * ast_dsp_new(void)</div><div class="ttdoc">Allocates a new dsp, assumes 8khz for internal sample rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01745">dsp.c:1745</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga6d8415024c851216fa63fbb94d0aadcf"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a></div><div class="ttdeci">void ast_sip_dialog_set_endpoint(pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint)</div><div class="ttdoc">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">pjsip_distributor.c:294</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_adf4c5a237767eb6db5b1db41ccdfc689"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_MAX_NAME</div><div class="ttdoc">Suggested maximum taskprocessor name length (less null terminator). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00060">taskprocessor.h:60</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a39fcd37b99a8eafd0aa1c961d8736f88"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a></div><div class="ttdeci">#define DATASTORE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01226">res_pjsip_session.c:1226</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8">AST_SIP_DTMF_INBAND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00415">res_pjsip.h:415</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6d2190ae1fcb37e66c2a445f2fe59ec3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a></div><div class="ttdeci">static void session_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">res_pjsip_session.c:2900</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="dsp_8h_html_a92045e8a8ad56b9b31d24db325fa95ab"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_FAX_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00029">dsp.h:29</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae586d6908c81e9a59e0e68358c12c9cc"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae586d6908c81e9a59e0e68358c12c9cc">datastore_hash</a></div><div class="ttdeci">static int datastore_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02878">res_pjsip_session.c:2878</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac60c8c7a11b9aa2b347630c7d08af17d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac60c8c7a11b9aa2b347630c7d08af17d">datastore_cmp</a></div><div class="ttdeci">static int datastore_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02888">res_pjsip_session.c:2888</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gad57aa0b914fbd6adbf8ee2fe176e1fb1"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer(const char *name)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05133">res_pjsip.c:5133</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_af8a29ee5509cdaf8e4a85c7f81fd4b25"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#af8a29ee5509cdaf8e4a85c7f81fd4b25">ast_sip_endpoint::faxdetect</a></div><div class="ttdeci">unsigned int faxdetect</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00869">res_pjsip.h:869</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga506c31bc071963fa7ef3ed517fa0a533"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_get_distributor_serializer(pjsip_rx_data *rdata)</div><div class="ttdoc">Determine the distributor serializer for the SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">pjsip_distributor.c:448</a></div></div>
<div class="ttc" id="dsp_8h_html_aedc7fa20fba91e3c018f6989e95c714b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aedc7fa20fba91e3c018f6989e95c714b">ast_dsp_set_features</a></div><div class="ttdeci">void ast_dsp_set_features(struct ast_dsp *dsp, int features)</div><div class="ttdoc">Select feature set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01755">dsp.c:1755</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6f42d3bf45cc9af6f794d9d1cf8c45ca"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6f42d3bf45cc9af6f794d9d1cf8c45ca">AST_LIST_HEAD_INIT</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00625">linkedlists.h:625</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a56458fcd1003f7554cee73c7f0346cbb"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a56458fcd1003f7554cee73c7f0346cbb">ast_sip_endpoint::moh_passthrough</a></div><div class="ttdeci">unsigned int moh_passthrough</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00879">res_pjsip.h:879</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3533f635938c655112221b97eac4884a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3533f635938c655112221b97eac4884a">handle_session_begin</a></div><div class="ttdeci">static void handle_session_begin(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04415">res_pjsip_session.c:4415</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b">AST_SIP_DTMF_AUTO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00419">res_pjsip.h:419</a></div></div>
<div class="ttc" id="channel_8h_html_a2126ac3bbc1a14f6ed5ccdfcbb851776"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a></div><div class="ttdeci">void ast_party_id_init(struct ast_party_id *init)</div><div class="ttdoc">Initialize the given party id structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01757">channel.c:1757</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a6c6cefb7bfc8ff5bf254b8bbd56c443d"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a6c6cefb7bfc8ff5bf254b8bbd56c443d">ast_sip_session_add_supplements</a></div><div class="ttdeci">int ast_sip_session_add_supplements(struct ast_sip_session *session)</div><div class="ttdoc">Add supplements to a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00090">pjsip_session.c:90</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0a9996be2e7d0a6fe7df55098932f5f6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_alloc(void)</div><div class="ttdoc">Allocate a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">res_pjsip_session.c:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28af3f44693710b56fb141c509a5eb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28af3f44693710b56fb141c509a5eb9d">&#9670;&nbsp;</a></span>ast_sip_session_alloc_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_session_alloc_datastore </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> </p>
<p>There are two major differences between this and <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> 1) This allocates a refcounted object 2) This will fill in a uid if one is not provided</p>
<p>DO NOT call <a class="el" href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14" title="Free a data store object. ">ast_datastore_free()</a> on a datastore allocated in this way since that function will attempt to free the datastore rather than play nicely with its refcount.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>Callbacks for datastore </td></tr>
    <tr><td class="paramname">uid</td><td>Identifier for datastore </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to allocate datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly allocated datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01243">1243</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../df/da9/uuid_8c_source.html#l00143">ast_uuid_generate_str()</a>, <a class="el" href="../../dd/d1d/uuid_8h_source.html#l00027">AST_UUID_STR_LEN</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01229">session_datastore_destroy()</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00125">handle_incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;{</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <span class="keywordtype">char</span> uuid_buf[<a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>];</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uid_ptr = uid;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;   <span class="keywordflow">if</span> (!info) {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   datastore = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*datastore), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adb6b8967d5861edcb38d2a36ad3349b7">session_datastore_destroy</a>);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   datastore-&gt;info = <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uid)) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">/* They didn&#39;t provide an ID so we&#39;ll provide one ourself */</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      uid_ptr = <a class="code" href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a>(uuid_buf, <span class="keyword">sizeof</span>(uuid_buf));</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   datastore-&gt;uid = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(uid_ptr);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="keywordflow">if</span> (!datastore-&gt;uid) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, +1);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   <span class="keywordflow">return</span> datastore;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;}</div><div class="ttc" id="uuid_8h_html_a127408e53d34dca0c589a099fabf1e13"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a></div><div class="ttdeci">#define AST_UUID_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d1d/uuid_8h_source.html#l00027">uuid.h:27</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adb6b8967d5861edcb38d2a36ad3349b7"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adb6b8967d5861edcb38d2a36ad3349b7">session_datastore_destroy</a></div><div class="ttdeci">static void session_datastore_destroy(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01229">res_pjsip_session.c:1229</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="uuid_8h_html_abe6d0b550cd9a54964e7891960d1e5bc"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a></div><div class="ttdeci">char * ast_uuid_generate_str(char *buf, size_t size)</div><div class="ttdoc">Generate a UUID string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/uuid_8c_source.html#l00143">uuid.c:143</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa73c173cbf6b282f81a445ed05050cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73c173cbf6b282f81a445ed05050cb9">&#9670;&nbsp;</a></span>ast_sip_session_create_invite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_create_invite </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data **&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an INVITE request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Starting session for the INVITE </td></tr>
    <tr><td class="paramname">tdata</td><td>The created request. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">2847</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00889">ast_sip_endpoint::preferred_codec_only</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">set_from_header()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>.</p>
<div class="fragment"><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;{</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   pjmedia_sdp_session *offer;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <span class="keywordflow">if</span> (!(offer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 500, PJ_FALSE);</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Couldn&#39;t create offer\n&quot;</span>);</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;   }</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;   pjsip_inv_set_local_sdp(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, offer);</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;   pjmedia_sdp_neg_set_prefer_remote_codec_order(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_FALSE);</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="preprocessor">#ifdef PJMEDIA_SDP_NEG_ANSWER_MULTIPLE_CODECS</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">preferred_codec_only</a>) {</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      pjmedia_sdp_neg_set_answer_multiple_codecs(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_TRUE);</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   }</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment">    * We MUST call set_from_header() before pjsip_inv_invite.  If we don&#39;t, the</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">    * From in the initial INVITE will be wrong but the rest of the messages will be OK.</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a74185467f13d0fd3860ef8a8762ca49d">set_from_header</a>(session);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_invite(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;pjsip_inv_invite failed\n&quot;</span>);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   }</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a74185467f13d0fd3860ef8a8762ca49d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a74185467f13d0fd3860ef8a8762ca49d">set_from_header</a></div><div class="ttdeci">static void set_from_header(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">res_pjsip_session.c:1637</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a65d1205823395f1a6c4f8c1af4d18a50"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">ast_sip_endpoint::preferred_codec_only</a></div><div class="ttdeci">unsigned int preferred_codec_only</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00889">res_pjsip.h:889</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae415668ea4e21bd1a053dece640e2f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae415668ea4e21bd1a053dece640e2f46">&#9670;&nbsp;</a></span>ast_sip_session_create_outgoing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_session_create_outgoing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *&#160;</td>
          <td class="paramname"><em>contact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>request_user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *&#160;</td>
          <td class="paramname"><em>req_topology</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new outgoing SIP session. </p>
<p>The endpoint that is passed in will have its reference count increased by one since the session will be keeping a reference to the endpoint. The session will relinquish this reference when the session is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that this session uses for settings </td></tr>
    <tr><td class="paramname">contact</td><td>The contact that this session will communicate with </td></tr>
    <tr><td class="paramname">location</td><td>Name of the location to call, be it named location or explicit URI. Overrides contact if present. </td></tr>
    <tr><td class="paramname">request_user</td><td>Optional request user to place in the request URI if permitted </td></tr>
    <tr><td class="paramname">req_topology</td><td>The requested capabilities </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">3317</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00223">ast_sip_session::aor</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01765">ast_party_id_copy()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01009">AST_SIP_CONTACT_FILTER_REACHABLE</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04028">ast_sip_create_dialog_uac()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00272">ast_sip_location_retrieve_contact_and_aor_from_list_filtered()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../dc/d13/pjsip__session__caps_8c_source.html#l00130">ast_sip_session_create_joint_call_stream()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00168">AST_SIP_SESSION_OUTGOING_CALL</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00292">ast_stream_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00358">ast_stream_get_format_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00650">ast_stream_topology_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00748">ast_stream_topology_append_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00241">ast_sip_session::call_direction</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00839">ast_sip_endpoint::extensions</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00578">ast_sip_endpoint_extensions::flags</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00565">ast_sip_timer_options::min_se</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00629">ast_sip_endpoint_id_configuration::self</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00567">ast_sip_timer_options::sess_expires</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03306">setup_outbound_invite_auth()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l00360">timer</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00580">ast_sip_endpoint_extensions::timer</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00772">ast_sip_endpoint_media_configuration::topology</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02559">request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;{</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a> *, found_aor, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *, found_contact, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;   pjsip_timer_setting <a class="code" href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;   <span class="keyword">struct </span>pjsip_inv_session *inv_session;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *ret_session;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s %s Topology: %s\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), request_user,</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(req_topology, &amp;STR_TMP)));</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <span class="comment">/* If no location has been provided use the AOR list from the endpoint itself */</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   <span class="keywordflow">if</span> (location || !contact) {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      location = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(location, endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac3d09ffbeec1bf7617e6d26084517d70">ast_sip_location_retrieve_contact_and_aor_from_list_filtered</a>(location, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75">AST_SIP_CONTACT_FILTER_REACHABLE</a>,</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;         &amp;found_aor, &amp;found_contact);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      <span class="keywordflow">if</span> (!found_contact || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(found_contact-&gt;uri)) {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;         uri = location;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;         uri = found_contact-&gt;uri;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      }</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      uri = contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;   }</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;   <span class="comment">/* If we still have no URI to dial fail to create the session */</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Endpoint &#39;%s&#39;: No URI available.  Is endpoint registered?\n&quot;</span>,</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;No URI\n&quot;</span>);</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   }</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;   <span class="keywordflow">if</span> (!(dlg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a>(endpoint, uri, request_user))) {</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create dialog\n&quot;</span>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;   }</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4937945ffae151bc235182493d104c8c">setup_outbound_invite_auth</a>(dlg)) {</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;      pjsip_dlg_terminate(dlg);</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t setup auth\n&quot;</span>);</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   }</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_create_uac(dlg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>, &amp;inv_session) != PJ_SUCCESS) {</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      pjsip_dlg_terminate(dlg);</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create uac\n&quot;</span>);</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;   }</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="preprocessor">#if defined(HAVE_PJSIP_REPLACE_MEDIA_STREAM) || defined(PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE)</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;   inv_session-&gt;sdp_neg_flags = PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;   pjsip_timer_setting_default(&amp;timer);</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;   timer.min_se = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">min_se</a>;</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;   timer.sess_expires = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">sess_expires</a>;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;   pjsip_timer_init_session(inv_session, &amp;timer);</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a>(endpoint, found_contact ? found_contact : contact,</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;      inv_session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>) {</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;   }</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;aor = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(found_aor);</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;call_direction = <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a>;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;id, &amp;endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>);</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(req_topology) &gt; 0) {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <span class="comment">/* get joint caps between req_topology and endpoint topology */</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(req_topology); ++i) {</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *req_stream;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *clone_stream;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;         req_stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(req_topology, i);</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(req_stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;         }</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;         clone_stream = <a class="code" href="../../dd/d20/res__pjsip__session__caps_8h.html#a84b461501e6bd34a40f40ab1a681d40f">ast_sip_session_create_joint_call_stream</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, req_stream);</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;         <span class="keywordflow">if</span> (!clone_stream || <a class="code" href="../../d8/d95/stream_8h.html#a6cc9bce25a44e3d9074337e2c882f445">ast_stream_get_format_count</a>(clone_stream) == 0) {</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(clone_stream);</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;         }</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology = <a class="code" href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a>();</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;               pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create topology\n&quot;</span>);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;            }</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;         }</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology, clone_stream) &lt; 0) {</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(clone_stream);</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;         }</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      }</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;   }</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <span class="comment">/* Use the configured topology on the endpoint as the pending one */</span></div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;         pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t clone topology\n&quot;</span>);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      }</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;   }</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;   <span class="keywordflow">if</span> (pjsip_dlg_add_usage(dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="comment">/* Since we are not notifying ourselves that the INVITE session is being terminated</span></div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">       * we need to manually drop its reference to session</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t add usage\n&quot;</span>);</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   }</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="comment">/* Avoid unnecessary ref manipulation to return a session */</span></div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   ret_session = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(ret_session);</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_ab4ae79a585283a422b758eddcd9663c2"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a></div><div class="ttdeci">struct ast_sip_session * ast_sip_session_alloc(struct ast_sip_endpoint *endpoint, struct ast_sip_contact *contact, pjsip_inv_session *inv_session, pjsip_rx_data *rdata)</div><div class="ttdoc">Allocate a new SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">res_pjsip_session.c:2990</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_a3033f0fbb7aa3b8fbacf78ae177358d3"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">ast_sip_timer_options::sess_expires</a></div><div class="ttdeci">unsigned int sess_expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00567">res_pjsip.h:567</a></div></div>
<div class="ttc" id="structast__sip__aor_html"><div class="ttname"><a href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a></div><div class="ttdoc">A SIP address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00361">res_pjsip.h:361</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4937945ffae151bc235182493d104c8c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4937945ffae151bc235182493d104c8c">setup_outbound_invite_auth</a></div><div class="ttdeci">static int setup_outbound_invite_auth(pjsip_dialog *dlg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03306">res_pjsip_session.c:3306</a></div></div>
<div class="ttc" id="channel_8h_html_abbf5c9830dd3533f3a6d5d35f941effb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a></div><div class="ttdeci">void ast_party_id_copy(struct ast_party_id *dest, const struct ast_party_id *src)</div><div class="ttdoc">Copy the source party id information to the destination party id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01765">channel.c:1765</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="stream_8h_html_a6cc9bce25a44e3d9074337e2c882f445"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6cc9bce25a44e3d9074337e2c882f445">ast_stream_get_format_count</a></div><div class="ttdeci">int ast_stream_get_format_count(const struct ast_stream *stream)</div><div class="ttdoc">Get the count of the current negotiated formats of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00358">stream.c:358</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a452835913f7150a5045dd75ee822b491"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a></div><div class="ttdeci">int ast_stream_topology_append_stream(struct ast_stream_topology *topology, struct ast_stream *stream)</div><div class="ttdoc">Append a stream to the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00748">stream.c:748</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_abc8cf95684205004f10203166581fc5d"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">ast_sip_timer_options::min_se</a></div><div class="ttdeci">unsigned int min_se</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00565">res_pjsip.h:565</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac3d09ffbeec1bf7617e6d26084517d70"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac3d09ffbeec1bf7617e6d26084517d70">ast_sip_location_retrieve_contact_and_aor_from_list_filtered</a></div><div class="ttdeci">void ast_sip_location_retrieve_contact_and_aor_from_list_filtered(const char *aor_list, unsigned int flags, struct ast_sip_aor **aor, struct ast_sip_contact **contact)</div><div class="ttdoc">Retrieve the first bound contact AND the AOR chosen from a list of AORs and filter based on flags...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00272">location.c:272</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stream_8h_html_ad225f95d1de536ba61f43150cfe3bd06"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_alloc(void)</div><div class="ttdoc">Create a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00650">stream.c:650</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_a28a4f505bc0cea6581fa6bde2161bced"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">ast_sip_endpoint_extensions::timer</a></div><div class="ttdeci">struct ast_sip_timer_options timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00580">res_pjsip.h:580</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="stream_8h_html_acd53513fe1965d4e5d4581d79ef8d24c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a></div><div class="ttdeci">void ast_stream_free(struct ast_stream *stream)</div><div class="ttdoc">Destroy a media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00292">stream.c:292</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00168">res_pjsip_session.h:168</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">ast_sip_endpoint_extensions::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00578">res_pjsip.h:578</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_endpoint_media_configuration::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00772">res_pjsip.h:772</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a179b9758f096dc75be612d5f4e5f07cc"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">ast_sip_endpoint_id_configuration::self</a></div><div class="ttdeci">struct ast_party_id self</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00629">res_pjsip.h:629</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76b100c44ffb8b301467785f3dd1c984"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">ast_sip_endpoint::extensions</a></div><div class="ttdeci">struct ast_sip_endpoint_extensions extensions</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00839">res_pjsip.h:839</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a681ca1bf74a943a8009a5c2ad6894831"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a></div><div class="ttdeci">pjsip_dialog * ast_sip_create_dialog_uac(const struct ast_sip_endpoint *endpoint, const char *aor_name, const char *request_user)</div><div class="ttdoc">General purpose method for creating a UAC dialog with an endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04028">res_pjsip.c:4028</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75">AST_SIP_CONTACT_FILTER_REACHABLE</a></div><div class="ttdoc">Return only reachable or unknown contacts. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01009">res_pjsip.h:1009</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a></div><div class="ttdeci">static struct ast_timer * timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00360">chan_iax2.c:360</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="res__pjsip__session__caps_8h_html_a84b461501e6bd34a40f40ab1a681d40f"><div class="ttname"><a href="../../dd/d20/res__pjsip__session__caps_8h.html#a84b461501e6bd34a40f40ab1a681d40f">ast_sip_session_create_joint_call_stream</a></div><div class="ttdeci">struct ast_stream * ast_sip_session_create_joint_call_stream(const struct ast_sip_session *session, struct ast_stream *remote)</div><div class="ttdoc">Create a new stream of joint capabilities. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d13/pjsip__session__caps_8c_source.html#l00130">pjsip_session_caps.c:130</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab099805fb795c60964dff130d6d15165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab099805fb795c60964dff130d6d15165">&#9670;&nbsp;</a></span>ast_sip_session_defer_termination()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_defer_termination </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defer local termination of a session until remote side terminates, or an amount of time passes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to defer termination on</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03554">3554</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">ast_sip_session::defer_end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">ast_sip_session::ended_while_deferred</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">ast_sip_session::scheduled_termination</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">session_termination_cb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;{</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;   pj_time_val delay = { .sec = 60, };</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;   <span class="comment">/* The session should not have an active deferred termination request. */</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 1;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a> = 1;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a> = 0;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;   pj_timer_entry_init(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>, 0, session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a79606e824455a241d8eaaeef6bcc0a7c">session_termination_cb</a>);</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;   res = (pjsip_endpt_schedule_timer(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;      &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>, &amp;delay) != PJ_SUCCESS) ? -1 : 0;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 0;</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;   }</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ac2c154a795044fcfbadae5f1bab089df"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">ast_sip_session::defer_end</a></div><div class="ttdeci">unsigned int defer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">res_pjsip_session.h:227</a></div></div>
<div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_aef6d512ea85f581bcfd51fba42d6e8e3"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ast_sip_session::ended_while_deferred</a></div><div class="ttdeci">unsigned int ended_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">res_pjsip_session.h:229</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a79606e824455a241d8eaaeef6bcc0a7c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a79606e824455a241d8eaaeef6bcc0a7c">session_termination_cb</a></div><div class="ttdeci">static void session_termination_cb(pj_timer_heap_t *timer_heap, struct pj_timer_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">res_pjsip_session.c:3545</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_a5e674de8b1bb04f45fe397c9bdfe9c78"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">ast_sip_session::scheduled_termination</a></div><div class="ttdeci">pj_timer_entry scheduled_termination</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">res_pjsip_session.h:205</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a587c035e9aae3bf37049f886dc29dcb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a587c035e9aae3bf37049f886dc29dcb6">&#9670;&nbsp;</a></span>ast_sip_session_defer_termination_cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_defer_termination_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel a pending deferred termination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to cancel a deferred termination on. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03596">3596</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">sip_session_defer_termination_stop_timer()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">ast_sip_session::terminate_while_deferred</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00511">defer_termination_cancel_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;{</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>) {</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      <span class="comment">/* Already canceled or timer fired. */</span></div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;   }</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 0;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">terminate_while_deferred</a>) {</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      <span class="comment">/* Complete the termination started by the upper layer. */</span></div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a>(session, 0);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;   }</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;   <span class="comment">/* Stop the termination timer if it is still running. */</span></div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a>(session);</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_add232d9657a85f507655cda6c38b9e4a"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">ast_sip_session::terminate_while_deferred</a></div><div class="ttdeci">unsigned int terminate_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">res_pjsip_session.h:217</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8bd0100b8c103a8d8633eb0db236f6af"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a></div><div class="ttdeci">static void sip_session_defer_termination_stop_timer(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">res_pjsip_session.c:3588</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac548e363175ba43f7ad75438729deac3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a></div><div class="ttdeci">void ast_sip_session_terminate(struct ast_sip_session *session, int response)</div><div class="ttdoc">Terminate a session and, if possible, send the provided response code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">res_pjsip_session.c:3451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa55296422ab86c7de1d7f52e9c227d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55296422ab86c7de1d7f52e9c227d82">&#9670;&nbsp;</a></span>ast_sip_session_end_if_deferred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_end_if_deferred </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>End the session if it had been previously deferred. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to end if it had been deferred </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03614">3614</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">ast_sip_session::defer_end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">ast_sip_session::ended_while_deferred</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00511">defer_termination_cancel_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00553">refer_attended_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00502">session_end_if_deferred_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;{</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a>) {</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;   }</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a> = 0;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a>) {</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      <span class="comment">/* Complete the session end started by the remote hangup. */</span></div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Ending session after being deferred\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a> = 0;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>(session);</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;   }</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ac2c154a795044fcfbadae5f1bab089df"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">ast_sip_session::defer_end</a></div><div class="ttdeci">unsigned int defer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">res_pjsip_session.h:227</a></div></div>
<div class="ttc" id="structast__sip__session_html_aef6d512ea85f581bcfd51fba42d6e8e3"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ast_sip_session::ended_while_deferred</a></div><div class="ttdeci">unsigned int ended_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">res_pjsip_session.h:229</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad11de1bfcc9846e016339bd3b482d16f"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a></div><div class="ttdeci">static int session_end(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">res_pjsip_session.c:4525</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b6e787aa2429e93f12e7be624ec3970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b6e787aa2429e93f12e7be624ec3970">&#9670;&nbsp;</a></span>ast_sip_session_get_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_session_get_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a session datastore. </p>
<p>The datastore retrieved will have its reference count incremented. When the caller is done with the datastore, the reference counted needs to be decremented using <a class="el" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session from which to retrieve the datastore </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to find the specified datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The specified datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01285">1285</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00171">chan_pjsip_get_rtp_peer()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l00760">channel_read_pjsip()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00268">direct_media_mitigate_glare()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00187">handle_outgoing_response()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00576">outgoing_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00254">read_header()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00398">remove_header()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00202">t38_automatic_reject()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>, and <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00364">update_header()</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95797137ac1484fe2214be36db22f6dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95797137ac1484fe2214be36db22f6dd">&#9670;&nbsp;</a></span>ast_sip_session_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_session_get_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the channel or endpoint name associated with the session. </p>
<dl class="section since"><dt>Since</dt><dd>18.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Channel</td><td>name or endpoint name or "unknown" </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">115</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">add_sdp_streams()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00682">answer()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">ast_sip_session_create_invite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03614">ast_sip_session_end_if_deferred()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02535">ast_sip_session_regenerate_answer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02385">chan_pjsip_call()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03241">chan_pjsip_incoming_ack()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03186">chan_pjsip_incoming_response()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03156">chan_pjsip_incoming_response_update_cause()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00547">chan_pjsip_new()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02972">chan_pjsip_session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">generate_session_refresh_sdp()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00315">get_codecs()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03666">get_destination()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">handle_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">handle_incoming_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">handle_outgoing_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">handle_outgoing_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">invite_collision_timeout()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01549">on_topology_change_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">outbound_invite_auth()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03115">pbx_start_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">resend_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01575">send_topology_change_refresh()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">session_inv_on_media_update()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04185">session_on_rx_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04163">session_on_tsx_state()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">set_from_header()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00438">set_incoming_call_offer_cap()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;(null session)&quot;</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d96ab8cbcc0f85012300573e3db2900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d96ab8cbcc0f85012300573e3db2900">&#9670;&nbsp;</a></span>ast_sip_session_is_pending_stream_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_is_pending_stream_default </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if a provided pending stream will be the default stream or not. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to check against </td></tr>
    <tr><td class="paramname">stream</td><td>The pending stream</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if stream will be default </td></tr>
    <tr><td class="paramname">0</td><td>if stream will NOT be the default </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">359</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, and <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Pending topology was NULL for channel &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) : <span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>); ++index) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index)) !=</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream)) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index) == stream ? 1 : 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bfa7d54f046b76d00644d3e650af6cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bfa7d54f046b76d00644d3e650af6cd">&#9670;&nbsp;</a></span>ast_sip_session_media_add_read_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_media_add_read_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#afd7121d8247121ec6170e3411bdd98da">ast_sip_session_media_read_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a read callback for a media session with a specific file descriptor. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor </td></tr>
    <tr><td class="paramname">callback</td><td>The read callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>the read callback was successfully added </td></tr>
    <tr><td class="paramname">-1</td><td>the read callback could not be added</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operations on the pending media state </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00385">385</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">ast_sip_session_media_read_callback_state::fd</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a> callback_state = {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      .<a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = <a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a>,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      .read_callback = callback,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      .session = session_media,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   };</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="comment">/* The contents of the vector are whole structs and not pointers */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;read_callbacks, callback_state);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html_a6f8059414f0228f0256115e024eeed4b"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">ast_sip_session_media_read_callback_state::fd</a></div><div class="ttdeci">int fd</div><div class="ttdoc">The file descriptor itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">res_pjsip_session.h:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa29930c927d55f4f7a615a11766a6a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa29930c927d55f4f7a615a11766a6a09">&#9670;&nbsp;</a></span>ast_sip_session_media_get_transport()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a>* ast_sip_session_media_get_transport </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the underlying media session that is acting as transport for a media session. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session to retrieve the transport for</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operates on the pending media state</dd>
<dd>
This function is guaranteed to return non-NULL </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00414">414</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, and <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>)) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">return</span> session_media;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions); ++index) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *bundle_group_session_media;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      bundle_group_session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, index);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="comment">/* The first session which is in the bundle group is considered the authoritative session for transport */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">if</span> (bundle_group_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a>) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;         <span class="keywordflow">return</span> bundle_group_session_media;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">return</span> session_media;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae799be93a0bc786802a9404362b236fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae799be93a0bc786802a9404362b236fa">&#9670;&nbsp;</a></span>ast_sip_session_media_set_write_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_media_set_write_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab727426f5a9d91957363388912fe378d">ast_sip_session_media_write_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a write callback for a media session. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session </td></tr>
    <tr><td class="paramname">callback</td><td>The write callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>the write callback was successfully add </td></tr>
    <tr><td class="paramname">-1</td><td>the write callback is already set to something different</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operates on the pending media state </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00398">398</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00107">ast_sip_session_media::write_callback</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a>) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a> == callback) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a> = callback;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="structast__sip__session__media_html_a25e03a749a471c5fbd87eab596cce9a7"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">ast_sip_session_media::write_callback</a></div><div class="ttdeci">ast_sip_session_media_write_cb write_callback</div><div class="ttdoc">The write callback when writing frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00107">res_pjsip_session.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0018e2a2f5cae3abe84426c44fee908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0018e2a2f5cae3abe84426c44fee908">&#9670;&nbsp;</a></span>ast_sip_session_media_state_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a>* ast_sip_session_media_state_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate an ast_session_media and add it to the media state's vector. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<p>This allocates a session media of the specified type. The position argument determines where in the vector that the new session media will be inserted.</p>
<dl class="section note"><dt>Note</dt><dd>The returned ast_session_media is the reference held by the vector. Callers of this function must NOT decrement the refcount of the session media.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session on which to query active media state for </td></tr>
    <tr><td class="paramname">media_state</td><td>Media state to place the session media into </td></tr>
    <tr><td class="paramname">type</td><td>The type of the session media </td></tr>
    <tr><td class="paramname">position</td><td>Position at which to insert the new session media.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The active media state will be queried and if a media session already exists at the given position for the same type it will be reused instead of allocating a new one.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">490</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">ast_sip_session_media::bundled</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00087">ast_sip_session_media::encryption</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00711">ast_sip_media_rtp_configuration::encryption</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00697">ast_sip_media_rtp_configuration::ice_support</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">ast_sip_session_media::keepalive_sched_id</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00103">ast_sip_session_media::remote_ice</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00101">ast_sip_session_media::remote_rtcp_mux</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00786">ast_sip_endpoint_media_configuration::rtcp_mux</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00764">ast_sip_endpoint_media_configuration::rtp</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">session_media_dtor()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">ast_sip_session_media::stream_name</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">ast_sip_session_media::stream_num</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">ast_sip_session_media::timeout_sched_id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00794">ast_sip_endpoint_media_configuration::webrtc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *current_session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Adding position %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), position);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="comment">/* It is possible for this media state to already contain a session for the stream. If this</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">    * is the case we simply return it.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordflow">if</span> (position &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions)) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      current_session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, position);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (current_session_media &amp;&amp; current_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> == <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(current_session_media, <span class="stringliteral">&quot;Using existing media_session\n&quot;</span>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="comment">/* Determine if we can reuse the session media from the active media state if present */</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="keywordflow">if</span> (position &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;sessions)) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;sessions, position);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">/* A stream can never exist without an accompanying media session */</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> == <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, +1);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Reusing existing media session\n&quot;</span>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">          * If this session_media was previously removed, its bundle group was probably reset</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">          * to -1 so if bundling is enabled on the endpoint, we need to reset it to 0, set</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">          * the bundled flag and reset its mid.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a> &amp;&amp; session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> == -1) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">webrtc</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, <span class="stringliteral">&quot;%s-%d&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), position) &lt; 0) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t alloc mid\n&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Can&#39;t reuse existing media session because the types are different. %s &lt;&gt; %s\n&quot;</span>,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>));</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">/* No existing media session we can use so create a new one */</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      session_media = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*session_media), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Creating new media session\n&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a947ba038dc2e3de1a3d4ce24e88da1d4">encryption</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#a947ba038dc2e3de1a3d4ce24e88da1d4">encryption</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a52b71bbc800a8503cfca7eb90f00e23a">remote_ice</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#afc0a4cb1a5b0ecd8d4324bd8466788c2">ice_support</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a6f7b8add12e23680b28e4b88f70a1a83">remote_rtcp_mux</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a86ef296f0f63688c8273119a2611f876">rtcp_mux</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">keepalive_sched_id</a> = -1;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">timeout_sched_id</a> = -1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a> = position;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a>) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         <span class="comment">/* This is a new stream so create a new mid based on media type and position, which makes it unique.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">          * If this is the result of an offer the mid will just end up getting replaced.</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, <span class="stringliteral">&quot;%s-%d&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), position) &lt; 0) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t alloc mid\n&quot;</span>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = 0;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         <span class="comment">/* Some WebRTC clients can&#39;t handle an offer to bundle media streams. Instead they expect them to</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">          * already be bundled. Every client handles this scenario though so if WebRTC is enabled just go</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">          * ahead and treat the streams as having already been bundled.</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">webrtc</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = -1;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">stream_name</a>);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">stream_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, position)));</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;media_state-&gt;sessions, position, session_media)) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t replace media_session\n&quot;</span>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(current_session_media);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="comment">/* If this stream will be active in some way and it is the first of this type then consider this the default media session to match */</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="keywordflow">if</span> (!media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &amp;&amp; <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, position)) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Setting media session as default for %s\n&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] = session_media;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(session_media, <span class="stringliteral">&quot;Done\n&quot;</span>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div><div class="ttc" id="structast__sip__endpoint__media__configuration_html_aa64681ccac6f69e15c21471249e68121"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">ast_sip_endpoint_media_configuration::webrtc</a></div><div class="ttdeci">unsigned int webrtc</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00794">res_pjsip.h:794</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_afc0a4cb1a5b0ecd8d4324bd8466788c2"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#afc0a4cb1a5b0ecd8d4324bd8466788c2">ast_sip_media_rtp_configuration::ice_support</a></div><div class="ttdeci">unsigned int ice_support</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00697">res_pjsip.h:697</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a86ef296f0f63688c8273119a2611f876"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a86ef296f0f63688c8273119a2611f876">ast_sip_endpoint_media_configuration::rtcp_mux</a></div><div class="ttdeci">unsigned int rtcp_mux</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00786">res_pjsip.h:786</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a947ba038dc2e3de1a3d4ce24e88da1d4"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a947ba038dc2e3de1a3d4ce24e88da1d4">ast_sip_session_media::encryption</a></div><div class="ttdeci">enum ast_sip_session_media_encryption encryption</div><div class="ttdoc">What type of encryption is in use on this stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00087">res_pjsip_session.h:87</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_adde8efbb4df251209d1b3e05e166a025"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">ast_sip_session_media::bundled</a></div><div class="ttdeci">unsigned int bundled</div><div class="ttdoc">Whether this stream is currently bundled or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">res_pjsip_session.h:115</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3a6b074b7eab19c35ccf9ef22fb8e316"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">ast_sip_session_media::stream_name</a></div><div class="ttdeci">char * stream_name</div><div class="ttdoc">Stream name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">res_pjsip_session.h:127</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a0728d28b6a031937ed2546296d430561"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">ast_sip_endpoint_media_configuration::rtp</a></div><div class="ttdeci">struct ast_sip_media_rtp_configuration rtp</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00764">res_pjsip.h:764</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_a947ba038dc2e3de1a3d4ce24e88da1d4"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#a947ba038dc2e3de1a3d4ce24e88da1d4">ast_sip_media_rtp_configuration::encryption</a></div><div class="ttdeci">enum ast_sip_session_media_encryption encryption</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00711">res_pjsip.h:711</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8383e75e786449dd2f4258b0819dd8f1"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">ast_sip_session_media::stream_num</a></div><div class="ttdeci">int stream_num</div><div class="ttdoc">The stream number to place into any resulting frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">res_pjsip_session.h:109</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7a1020cea0d78fe4969869c10fd93973"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a></div><div class="ttdeci">static void session_media_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">res_pjsip_session.c:469</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a75b67fe2a02f4641321116ad6fa0253d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">ast_sip_session_media::timeout_sched_id</a></div><div class="ttdeci">int timeout_sched_id</div><div class="ttdoc">Scheduler ID for RTP timeout. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">res_pjsip_session.h:93</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_af723510e5f7d3a2c82f5b9fe1e16802f"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">ast_sip_session_media::keepalive_sched_id</a></div><div class="ttdeci">int keepalive_sched_id</div><div class="ttdoc">Scheduler ID for RTP keepalive. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">res_pjsip_session.h:91</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a6f7b8add12e23680b28e4b88f70a1a83"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a6f7b8add12e23680b28e4b88f70a1a83">ast_sip_session_media::remote_rtcp_mux</a></div><div class="ttdeci">unsigned int remote_rtcp_mux</div><div class="ttdoc">Does remote support rtcp_mux. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00101">res_pjsip_session.h:101</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a52b71bbc800a8503cfca7eb90f00e23a"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a52b71bbc800a8503cfca7eb90f00e23a">ast_sip_session_media::remote_ice</a></div><div class="ttdeci">unsigned int remote_ice</div><div class="ttdoc">Does remote support ice. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00103">res_pjsip_session.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a9996be2e7d0a6fe7df55098932f5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9996be2e7d0a6fe7df55098932f5f6">&#9670;&nbsp;</a></span>ast_sip_session_media_state_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* ast_sip_session_media_state_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a session media state structure. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">238</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00061">DEFAULT_NUM_SESSION_MEDIA</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">internal_sip_session_media_state_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01524">topology_change_refresh_data_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a>(</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5e3aa3a6565c9201950caa9a3f7b31a6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a></div><div class="ttdeci">#define DEFAULT_NUM_SESSION_MEDIA</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00061">res_pjsip_session.c:61</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8fb456164755b6c4fc3df83e70c805c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a></div><div class="ttdeci">static struct ast_sip_session_media_state * internal_sip_session_media_state_alloc(size_t sessions, size_t read_callbacks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">res_pjsip_session.c:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76c9ec6c960e59090e7c6301c1bce890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c9ec6c960e59090e7c6301c1bce890">&#9670;&nbsp;</a></span>ast_sip_session_media_state_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* ast_sip_session_media_state_clone </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clone a media state. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to clone</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">297</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">internal_sip_session_media_state_alloc()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00137">ast_sip_session_media_read_callback_state::read_callback</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00275">t38_reinvite_sdp_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *cloned;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   cloned = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a>(</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions),</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;read_callbacks));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordflow">if</span> (!cloned) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keywordflow">if</span> (media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">if</span> (!cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(cloned);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions); ++index) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, index);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index));</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(session_media);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;cloned-&gt;sessions, index, session_media)) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session_media);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index)) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a> &amp;&amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         !cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[type]) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] = session_media;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;read_callbacks); ++index) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a> *<a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a0d1e34d634c305bcb322d830f71da0af">read_callback</a> = <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;media_state-&gt;read_callbacks, index);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;cloned-&gt;read_callbacks, index, *read_callback);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">return</span> cloned;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8fb456164755b6c4fc3df83e70c805c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a></div><div class="ttdeci">static struct ast_sip_session_media_state * internal_sip_session_media_state_alloc(size_t sessions, size_t read_callbacks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">res_pjsip_session.c:214</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html_a0d1e34d634c305bcb322d830f71da0af"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a0d1e34d634c305bcb322d830f71da0af">ast_sip_session_media_read_callback_state::read_callback</a></div><div class="ttdeci">ast_sip_session_media_read_cb read_callback</div><div class="ttdoc">The callback to invoke. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00137">res_pjsip_session.h:137</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a></div><div class="ttdeci">ast_media_type</div><div class="ttdoc">Types of media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00030">codec.h:30</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a52106819ac5621fe89579644d4afd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a52106819ac5621fe89579644d4afd3">&#9670;&nbsp;</a></span>ast_sip_session_media_state_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_state_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a session media state structure. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">344</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01063">session_refresh_state_destroy()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00290">t38_reinvite_response_cb()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00073">t38_state_destroy()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01516">topology_change_refresh_data_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="comment">/* This will reset the internal state so we only have to free persistent things */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(media_state);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;media_state-&gt;sessions);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;media_state-&gt;read_callbacks);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(media_state);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae02f331ac12ec53a9f072a9862405055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae02f331ac12ec53a9f072a9862405055">&#9670;&nbsp;</a></span>ast_sip_session_media_state_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_state_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a media state to a clean state. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to reset </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">278</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00743">ast_stream_topology_free()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00573">AST_VECTOR_ELEM_CLEANUP_NOOP</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00627">AST_VECTOR_RESET</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01549">on_topology_change_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">session_inv_on_media_update()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">session_reinvite_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00290">t38_reinvite_response_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;media_state-&gt;sessions, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;media_state-&gt;read_callbacks, <a class="code" href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>; ++index) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[index] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div><div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_a1885c25b9d767a53d1df9b641f53951a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a></div><div class="ttdeci">#define AST_VECTOR_ELEM_CLEANUP_NOOP(elem)</div><div class="ttdoc">Vector element cleanup that does nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00573">vector.h:573</a></div></div>
<div class="ttc" id="vector_8h_html_a0e59aa540254f87575cb1d28821bbd1f"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a></div><div class="ttdeci">#define AST_VECTOR_RESET(vec, cleanup)</div><div class="ttdoc">Reset vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00627">vector.h:627</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="stream_8h_html_a88eca139ded2d5bbc6cdcf793febc265"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a></div><div class="ttdeci">void ast_stream_topology_free(struct ast_stream_topology *topology)</div><div class="ttdoc">Unreference and destroy a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00743">stream.c:743</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af57bfc75550b1312b46ef584410ae8a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57bfc75550b1312b46ef584410ae8a9">&#9670;&nbsp;</a></span>ast_sip_session_media_stats_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_stats_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>sip_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a media stats. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to save </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">244</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l02446">ast_rtp_instance_get_stats()</a>, <a class="el" href="../../d5/dde/rtp__engine_8h_source.html#l00182">AST_RTP_INSTANCE_STAT_ALL</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00488">AST_VECTOR_REMOVE_CMP_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00204">media_stats_local_ssrc_cmp()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00077">ast_sip_session_media::rtp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">if</span> (!media_state || !sip_session) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions); i++) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *stats_tmp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, i);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (!media || !media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      stats_tmp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a>));</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (!stats_tmp) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      ret = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a82a029e03affad8a6e1b322c0b9fe2c3">ast_rtp_instance_get_stats</a>(media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, stats_tmp, <a class="code" href="../../d5/dde/rtp__engine_8h.html#a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4">AST_RTP_INSTANCE_STAT_ALL</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">if</span> (ret) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(stats_tmp);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">/* remove all the duplicated stats if exist */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a>(&amp;sip_session-&gt;media_stats, stats_tmp, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2a75356a9f850bf7c497f8a963719457">media_stats_local_ssrc_cmp</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;sip_session-&gt;media_stats, stats_tmp);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="ttc" id="rtp__engine_8h_html_a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4">AST_RTP_INSTANCE_STAT_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00182">rtp_engine.h:182</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a82a029e03affad8a6e1b322c0b9fe2c3"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a82a029e03affad8a6e1b322c0b9fe2c3">ast_rtp_instance_get_stats</a></div><div class="ttdeci">int ast_rtp_instance_get_stats(struct ast_rtp_instance *instance, struct ast_rtp_instance_stats *stats, enum ast_rtp_instance_stat stat)</div><div class="ttdoc">Retrieve statistics about an RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02446">rtp_engine.c:2446</a></div></div>
<div class="ttc" id="vector_8h_html_a671c51a3e6202230ef9d2330624ea996"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_CMP_UNORDERED(vec, value, cmp, cleanup)</div><div class="ttdoc">Remove an element from a vector that matches the given comparison. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00488">vector.h:488</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8adb8595b8127cbea2118fada1ef8782"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">ast_sip_session_media::rtp</a></div><div class="ttdeci">struct ast_rtp_instance * rtp</div><div class="ttdoc">RTP instance itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00077">res_pjsip_session.h:77</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a2a75356a9f850bf7c497f8a963719457"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2a75356a9f850bf7c497f8a963719457">media_stats_local_ssrc_cmp</a></div><div class="ttdeci">static int media_stats_local_ssrc_cmp(const struct ast_rtp_instance_stats *vec_elem, const struct ast_rtp_instance_stats *srch)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00204">res_pjsip_session.c:204</a></div></div>
<div class="ttc" id="structast__rtp__instance__stats_html"><div class="ttname"><a href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00366">rtp_engine.h:366</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae45a3852c5bef6bf3719080907f02a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45a3852c5bef6bf3719080907f02a42">&#9670;&nbsp;</a></span>ast_sip_session_refresh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_request_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generate_new_sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a reinvite or UPDATE on a session. </p>
<p>This method will inspect the session in order to construct an appropriate session refresh request. As with any outgoing request in res_pjsip_session, this will call into registered supplements in case they wish to add anything.</p>
<p>Note: The on_request_creation callback may or may not be called in the same thread where this function is called. Request creation may need to be delayed due to the current INVITE transaction state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which the reinvite will be sent </td></tr>
    <tr><td class="paramname">on_request_creation</td><td>Callback called when request is created </td></tr>
    <tr><td class="paramname">on_sdp_creation</td><td>Callback called when SDP is created </td></tr>
    <tr><td class="paramname">on_response</td><td>Callback called when response for request is received </td></tr>
    <tr><td class="paramname">method</td><td>The method that should be used when constructing the session refresh </td></tr>
    <tr><td class="paramname">generate_new_sdp</td><td>Boolean to indicate if a new SDP should be created </td></tr>
    <tr><td class="paramname">media_state</td><td>Optional requested media state for the SDP</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successfully sent refresh </td></tr>
    <tr><td class="paramname">-1</td><td>Failure to send refresh</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If a media_state is passed in ownership will be taken in all cases </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02524">2524</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01513">dtmf_mode_refresh_cb()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01652">refresh_write_cb()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01490">remote_send_hold_refresh()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00396">send_direct_media_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01575">send_topology_change_refresh()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00428">t38_interpret_parameters()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01429">update_connected_line_information()</a>.</p>
<div class="fragment"><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;{</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a>(session, on_request_creation, on_sdp_creation,</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      on_response, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, generate_new_sdp, media_state, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a9d68a08d3f45966f9c90fa2903aed739"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a></div><div class="ttdeci">static int sip_session_refresh(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request_creation, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, enum ast_sip_session_refresh_method method, int generate_new_sdp, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queued)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">res_pjsip_session.c:2184</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11c6ebf48a77449c1058861ff70a958a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c6ebf48a77449c1058861ff70a958a">&#9670;&nbsp;</a></span>ast_sip_session_regenerate_answer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_regenerate_answer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regenerate SDP Answer. </p>
<p>This method is used when an SDP offer has been received but an SDP answer has not been sent yet. It requests that a new local SDP be created and set as the SDP answer. As with any outgoing request in res_pjsip_session, this will call into registered supplements in case they wish to add anything.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which the answer will be updated </td></tr>
    <tr><td class="paramname">on_sdp_creation</td><td>Callback called when SDP is created </td></tr>
    <tr><td class="paramname">generate_new_sdp</td><td>Boolean to indicate if a new SDP should be created </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successfully updated the SDP answer </td></tr>
    <tr><td class="paramname">-1</td><td>Failure to updated the SDP answer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02535">2535</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01513">dtmf_mode_refresh_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;{</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   pjmedia_sdp_session *new_answer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   <span class="keyword">const</span> pjmedia_sdp_session *previous_offer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   <span class="comment">/* The SDP answer can only be regenerated if it is still pending to be sent */</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <span class="keywordflow">if</span> (!inv_session-&gt;neg || (pjmedia_sdp_neg_get_state(inv_session-&gt;neg) != PJMEDIA_SDP_NEG_STATE_REMOTE_OFFER &amp;&amp;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      pjmedia_sdp_neg_get_state(inv_session-&gt;neg) != PJMEDIA_SDP_NEG_STATE_WAIT_NEGO)) {</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Requested to regenerate local SDP answer for channel &#39;%s&#39; but negotiation in state &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>), pjmedia_sdp_neg_state_str(pjmedia_sdp_neg_get_state(inv_session-&gt;neg)));</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Bad negotiation state\n&quot;</span>);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   }</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   pjmedia_sdp_neg_get_neg_remote(inv_session-&gt;neg, &amp;previous_offer);</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   <span class="keywordflow">if</span> (pjmedia_sdp_neg_get_state(inv_session-&gt;neg) == PJMEDIA_SDP_NEG_STATE_WAIT_NEGO) {</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="comment">/* Transition the SDP negotiator back to when it received the remote offer */</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      pjmedia_sdp_neg_negotiate(inv_session-&gt;pool, inv_session-&gt;neg, 0);</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      pjmedia_sdp_neg_set_remote_offer(inv_session-&gt;pool, inv_session-&gt;neg, previous_offer);</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   }</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;   new_answer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(inv_session, session, previous_offer);</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;   <span class="keywordflow">if</span> (!new_answer) {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not create a new local SDP answer for channel &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>));</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Couldn&#39;t create new SDP\n&quot;</span>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;   }</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   <span class="keywordflow">if</span> (on_sdp_creation) {</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <span class="keywordflow">if</span> (on_sdp_creation(session, new_answer)) {</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Callback failed\n&quot;</span>);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      }</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;   pjsip_inv_set_sdp_answer(inv_session, new_answer);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30cf6ad5b4d5ad87ecfeb571a24fe8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">&#9670;&nbsp;</a></span>ast_sip_session_register_sdp_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_register_sdp_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>stream_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register an SDP handler. </p>
<p>An SDP handler is responsible for parsing incoming SDP streams and ensuring that Asterisk can cope with the contents. Similarly, the SDP handler will be responsible for constructing outgoing SDP streams.</p>
<p>Multiple handlers for the same stream type may be registered. They will be visited in the order they were registered. Handlers will be visited for each stream type until one claims to have handled the stream.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The SDP handler to register </td></tr>
    <tr><td class="paramname">stream_type</td><td>The type of media stream for which to call the handler </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00138">138</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00680">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">ast_sip_session_sdp_handler::id</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00602">SCOPED_AO2LOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02347">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, stream_type, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> (handler_list) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *iter;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">/* Check if this handler is already registered for this stream type */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, iter, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         <span class="keywordflow">if</span> (!strcmp(iter-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>)) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Handler &#39;%s&#39; already registered for stream type &#39;%s&#39;.\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Registered SDP stream handler &#39;%s&#39; for stream type &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="comment">/* No stream of this type has been registered yet, so we need to create a new list */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*handler_list) + strlen(stream_type), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="comment">/* Safe use of strcpy */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   strcpy(handler_list-&gt;stream_type, stream_type);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;handler_list-&gt;list);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, handler_list)) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Registered SDP stream handler &#39;%s&#39; for stream type &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">ast_sip_session_sdp_handler::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">res_pjsip_session.h:382</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4ddc4ad38445110621ccfcea72ead37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ddc4ad38445110621ccfcea72ead37">&#9670;&nbsp;</a></span>ast_sip_session_register_supplement_with_module()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_register_supplement_with_module </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *&#160;</td>
          <td class="paramname"><em>supplement</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a supplement to SIP session processing. </p>
<p>This allows for someone to insert themselves in the processing of SIP requests and responses. This, for example could allow for a module to set channel data based on headers in an incoming message. Similarly, a module could reject an incoming request if desired.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">module</td><td>Referenced module(NULL safe) </td></tr>
    <tr><td class="paramname">supplement</td><td>The supplement to register </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00035">35</a> of file <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html">pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00609">AST_RWLIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00740">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00272">AST_SIP_SESSION_BEFORE_MEDIA</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">ast_sip_session_supplement::module</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00292">ast_sip_session_supplement::priority</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00360">ast_sip_session_supplement::response_priority</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00581">SCOPED_LOCK</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordtype">int</span> inserted = 0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(supplement != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a> = <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">if</span> (!supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a82b06adfc16e93cbdf490670091c18cf">response_priority</a>) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a82b06adfc16e93cbdf490670091c18cf">response_priority</a> = <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#aa513867e0c879afe032ffc99bac34d3b">priority</a> &gt; supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#aa513867e0c879afe032ffc99bac34d3b">priority</a>) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#acf8253a64f9a4e2170454f4bf0559e33">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(supplement, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         inserted = 1;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">if</span> (!inserted) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, supplement, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00272">res_pjsip_session.h:272</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a82b06adfc16e93cbdf490670091c18cf"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a82b06adfc16e93cbdf490670091c18cf">ast_sip_session_supplement::response_priority</a></div><div class="ttdeci">enum ast_sip_session_response_priority response_priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00360">res_pjsip_session.h:360</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="lock_8h_html_a8b9d9f2f2c41ecf3c70587c2510dddfc"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a></div><div class="ttdeci">#define SCOPED_LOCK(varname, lock, lockfunc, unlockfunc)</div><div class="ttdoc">Scoped Locks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00581">lock.h:581</a></div></div>
<div class="ttc" id="linkedlists_8h_html_acf8253a64f9a4e2170454f4bf0559e33"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#acf8253a64f9a4e2170454f4bf0559e33">AST_RWLIST_INSERT_BEFORE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_BEFORE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00609">linkedlists.h:609</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_sip_session_supplement::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">res_pjsip_session.h:288</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_aa513867e0c879afe032ffc99bac34d3b"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#aa513867e0c879afe032ffc99bac34d3b">ast_sip_session_supplement::priority</a></div><div class="ttdeci">enum ast_sip_supplement_priority priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00292">res_pjsip_session.h:292</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
<div class="ttc" id="structsession__supplements_html"><div class="ttname"><a href="../../d9/d91/structsession__supplements.html">session_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00033">pjsip_session.c:33</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a80752332a327901006cee3a209c03968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80752332a327901006cee3a209c03968">&#9670;&nbsp;</a></span>ast_sip_session_remove_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_remove_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a session datastore from the session. </p>
<p>This operation may cause the datastore's <a class="el" href="../../da/dfd/gsm__destroy_8c.html#aafde19f7d36ca163a143579c1b125b6d">free()</a> callback to be called if the reference count reaches zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to remove the datastore from </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to remove </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01290">1290</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00268">direct_media_mitigate_glare()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00187">handle_outgoing_response()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00576">outgoing_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01652">refresh_write_cb()</a>, and <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;{</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (<span class="keywordtype">void</span> *) <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c6b10ea506d88abcd42bb8373dcb2c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c6b10ea506d88abcd42bb8373dcb2c4">&#9670;&nbsp;</a></span>ast_sip_session_remove_supplements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_remove_supplements </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove supplements from a SIP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to remove </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00111">111</a> of file <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html">pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00469">ast_module_unref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">ast_sip_session_supplement::module</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="comment">/* free the supplements */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">while</span> ((iter = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>))) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         <span class="comment">/* referenced session closed. decreasing modue reference. */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(iter);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_sip_session_supplement::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00288">res_pjsip_session.h:288</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add9e11223bb5b1c0e9ca30678e97dc0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9e11223bb5b1c0e9ca30678e97dc0f">&#9670;&nbsp;</a></span>ast_sip_session_resume_reinvite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_resume_reinvite </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resumes processing of a deferred incoming re-invite. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session which has a pending incoming re-invite</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When resuming a re-invite it is given to the pjsip stack as if it had just been received from a transport, this means that the deferral callback will be called again. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02798">2798</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00219">ast_sip_session::deferred_reinvite</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00202">t38_automatic_reject()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00428">t38_interpret_parameters()</a>.</p>
<div class="fragment"><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;{</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>) {</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   }</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      pjsip_endpt_process_rx_data(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   pjsip_rx_data_free_cloned(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>);</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_a808f5363605eee5ebe8963b7b8ccad52"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">ast_sip_session::deferred_reinvite</a></div><div class="ttdeci">pjsip_rx_data * deferred_reinvite</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00219">res_pjsip_session.h:219</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35a7aa9427f3aea9384c1a481ce6a5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a7aa9427f3aea9384c1a481ce6a5f3">&#9670;&nbsp;</a></span>ast_sip_session_send_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP request. </p>
<p>This will send the SIP request specified in tdata and call into any registered supplements' outgoing_request callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to which to send the request </td></tr>
    <tr><td class="paramname">tdata</td><td>The request to send </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">2842</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04560">check_request_status()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">outbound_invite_auth()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02218">transmit_info_dtmf()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01351">transmit_info_with_vidupdate()</a>.</p>
<div class="fragment"><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;{</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a>(session, tdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6e71dd1b8a6901e044953ff9e3a0343d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a></div><div class="ttdeci">void ast_sip_session_send_request_with_cb(struct ast_sip_session *session, pjsip_tx_data *tdata, ast_sip_session_response_cb on_response)</div><div class="ttdoc">Send a SIP request and get called back when a response is received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">res_pjsip_session.c:2818</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e71dd1b8a6901e044953ff9e3a0343d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e71dd1b8a6901e044953ff9e3a0343d">&#9670;&nbsp;</a></span>ast_sip_session_send_request_with_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_request_with_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP request and get called back when a response is received. </p>
<p>This will send the request out exactly the same as <a class="el" href="../../d8/d8c/res__pjsip_8h.html#a9302fd362f9d52147d928c5bc4740433" title="General purpose method for sending a SIP request. ">ast_sip_send_request()</a> does. The difference is that when a response arrives, the specified callback will be called into</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which to send the request </td></tr>
    <tr><td class="paramname">tdata</td><td>The request to send </td></tr>
    <tr><td class="paramname">on_response</td><td>Callback to be called when a response is received </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">2818</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02670">ast_sip_mod_data_set</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">handle_outgoing_request()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">MOD_DATA_ON_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;{</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   <span class="comment">/* For every request except BYE we disallow sending of the message when</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">    * the session has been disconnected. A BYE request is special though</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">    * because it can be sent again after the session is disconnected except</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">    * with credentials.</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;state == PJSIP_INV_STATE_DISCONNECTED &amp;&amp;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      tdata-&gt;msg-&gt;line.req.method.id != PJSIP_BYE_METHOD) {</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a>(tdata-&gt;pool, tdata-&gt;mod_data, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id,</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;              <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a>, on_response);</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae1b7d51bdf278a523bbaa5086302552b">handle_outgoing_request</a>(session, tdata);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;   pjsip_inv_send_msg(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata);</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a929623f98bee0fc9eb242c0bce08d227"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a></div><div class="ttdeci">#define MOD_DATA_ON_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">res_pjsip_session.c:57</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9937f98867d28da0cc0e8590d9c9ffa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a></div><div class="ttdeci">#define ast_sip_mod_data_set(pool, mod_data, id, key, val)</div><div class="ttdoc">Utilizing a mod_data array for a given id, set the value associated with the given key...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02670">res_pjsip.h:2670</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae1b7d51bdf278a523bbaa5086302552b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae1b7d51bdf278a523bbaa5086302552b">handle_outgoing_request</a></div><div class="ttdeci">static void handle_outgoing_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">res_pjsip_session.c:4481</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed4c9a6bf6967790981c02027f5f02e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed4c9a6bf6967790981c02027f5f02e8">&#9670;&nbsp;</a></span>ast_sip_session_send_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP response. </p>
<p>This will send the SIP response specified in tdata and call into any registered supplements' outgoing_response callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which to send the response. </td></tr>
    <tr><td class="paramname">tdata</td><td>The response to send </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">2576</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">handle_outgoing_response()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04185">session_on_rx_response()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04163">session_on_tsx_state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00682">answer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01333">indicate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00969">refer_incoming_invite_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01877">transfer_redirect()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01429">update_connected_line_information()</a>.</p>
<div class="fragment"><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;{</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac8a7f2c555647574c05995ba10788c17">handle_outgoing_response</a>(session, tdata);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;   pjsip_inv_send_msg(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata);</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac8a7f2c555647574c05995ba10788c17"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac8a7f2c555647574c05995ba10788c17">handle_outgoing_response</a></div><div class="ttdeci">static void handle_outgoing_response(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">res_pjsip_session.c:4498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af07a4b2b3de4cbbd66b09acb55ca3c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07a4b2b3de4cbbd66b09acb55ca3c5e">&#9670;&nbsp;</a></span>ast_sip_session_suspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_suspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request and wait for the session serializer to be suspended. </p>
<dl class="section since"><dt>Since</dt><dd>12.7.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Which session to suspend the serializer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>No channel locks can be held while calling without risk of deadlock.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">3155</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00476">ao2_object_get_lockaddr()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00199">ast_cond_init</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00203">ast_cond_wait</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01207">ast_taskprocessor_is_suspended()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01266">ast_taskprocessor_is_task()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01185">ast_taskprocessor_suspend()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">ast_sip_session_suspender::cond_suspended</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03134">sip_session_suspend_task()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03118">sip_session_suspender_dtor()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">ast_sip_session::suspended</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">ast_sip_session_suspender::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01612">chan_pjsip_indicate()</a>.</p>
<div class="fragment"><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;{</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *suspender;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>)) {</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="comment">/* I am the session&#39;s serializer thread so I cannot suspend. */</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   }</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a37f9fcdd63017df32ddb3b2601d1e223">ast_taskprocessor_is_suspended</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>)) {</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="comment">/* The serializer already suspended. */</span></div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   suspender = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*suspender), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6c7aeb0cc811ca617953f8b4c24a39f6">sip_session_suspender_dtor</a>);</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   <span class="keywordflow">if</span> (!suspender) {</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="comment">/* We will just have to hope that the system does not deadlock */</span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   }</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, +1);</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;   res = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5355aaa265e4a9ef57068b7dd8140870">sip_session_suspend_task</a>, suspender);</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <span class="comment">/* We will just have to hope that the system does not deadlock */</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, -2);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   }</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> = suspender;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;   <span class="comment">/* Wait for the serializer to get suspended. */</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(suspender);</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;   <span class="keywordflow">while</span> (!suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">suspended</a>) {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a>(suspender));</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;   }</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(suspender);</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#aeea7131da6b62d2e9b5d91c5de529d6c">ast_taskprocessor_suspend</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;}</div><div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="astobj2_8h_html_a503b6c7ced96f9b56ec59c115cbeb29a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a></div><div class="ttdeci">void * ao2_object_get_lockaddr(void *obj)</div><div class="ttdoc">Return the mutex lock address of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00476">astobj2.c:476</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_aeea7131da6b62d2e9b5d91c5de529d6c"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#aeea7131da6b62d2e9b5d91c5de529d6c">ast_taskprocessor_suspend</a></div><div class="ttdeci">int ast_taskprocessor_suspend(struct ast_taskprocessor *tps)</div><div class="ttdoc">Indicate the taskprocessor is suspended. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01185">taskprocessor.c:1185</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a4a66670abd8be00ab53bd9125a57574f"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a></div><div class="ttdeci">int ast_taskprocessor_is_task(struct ast_taskprocessor *tps)</div><div class="ttdoc">Am I the given taskprocessor&amp;#39;s current task. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01266">taskprocessor.c:1266</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_ad5a799b56c95ee841cdd4c0cfca4484e"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">ast_sip_session_suspender::cond_suspended</a></div><div class="ttdeci">ast_cond_t cond_suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">res_pjsip_session.c:3112</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a37f9fcdd63017df32ddb3b2601d1e223"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a37f9fcdd63017df32ddb3b2601d1e223">ast_taskprocessor_is_suspended</a></div><div class="ttdeci">int ast_taskprocessor_is_suspended(struct ast_taskprocessor *tps)</div><div class="ttdoc">Get the task processor suspend status. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01207">taskprocessor.c:1207</a></div></div>
<div class="ttc" id="structast__sip__session_html_a965365a4589d683773f1eb2b6bb8e3f2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">ast_sip_session::suspended</a></div><div class="ttdeci">struct ast_sip_session_suspender * suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">res_pjsip_session.h:197</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6c7aeb0cc811ca617953f8b4c24a39f6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6c7aeb0cc811ca617953f8b4c24a39f6">sip_session_suspender_dtor</a></div><div class="ttdeci">static void sip_session_suspender_dtor(void *vdoomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03118">res_pjsip_session.c:3118</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_af62c9334e77989174caccf53beee4215"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">ast_sip_session_suspender::suspended</a></div><div class="ttdeci">int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">res_pjsip_session.c:3114</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5355aaa265e4a9ef57068b7dd8140870"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5355aaa265e4a9ef57068b7dd8140870">sip_session_suspend_task</a></div><div class="ttdeci">static int sip_session_suspend_task(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03134">res_pjsip_session.c:3134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac548e363175ba43f7ad75438729deac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac548e363175ba43f7ad75438729deac3">&#9670;&nbsp;</a></span>ast_sip_session_terminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_terminate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminate a session and, if possible, send the provided response code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to terminate </td></tr>
    <tr><td class="paramname">response</td><td>The response code to use for termination if possible</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Calling this function MAY cause the last session reference to be released and the session destructor to be called. If you need to do something with session after this call, be sure to bump the ref count before calling terminate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">3451</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">ast_sip_session_media_stats_save()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00230">SWAP</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">ast_sip_session::terminate_while_deferred</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03596">ast_sip_session_defer_termination_cancel()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02483">hangup()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03530">session_termination_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;{</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   pj_status_t <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;   pjsip_tx_data *packet = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Response %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), response);</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>) {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">terminate_while_deferred</a> = 1;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Deferred\n&quot;</span>);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;   }</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   <span class="keywordflow">if</span> (!response) {</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      response = 603;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;   }</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;   <span class="comment">/* The media sessions need to exist for the lifetime of the underlying channel</span></div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="comment">    * to ensure that anything (such as bridge_native_rtp) has access to them as</span></div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">    * appropriate. Since ast_sip_session_terminate is called by chan_pjsip and other</span></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">    * places when the session is to be terminated we terminate any existing</span></div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">    * media sessions here.</span></div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <span class="keywordflow">switch</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;state) {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;   <span class="keywordflow">case</span> PJSIP_INV_STATE_NULL:</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">          * Normally, it&#39;s pjproject&#39;s transaction cleanup that ultimately causes the</span></div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">          * final session reference to be released but if both STATE and invite_tsx are NULL,</span></div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment">          * we never created a transaction in the first place.  In this case, we need to</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="comment">          * do the cleanup ourselves.</span></div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;         <span class="comment">/* Transfer the inv_session session reference to the session_end_task */</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;         pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, PJ_TRUE);</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>(session);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">          * session_end_completion will cleanup the final session reference unless</span></div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">          * ast_sip_session_terminate&#39;s caller is holding one.</span></div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a>(session);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;         pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, PJ_TRUE);</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      }</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;   <span class="keywordflow">case</span> PJSIP_INV_STATE_CONFIRMED:</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Delay sending BYE because of outstanding transaction...\n&quot;</span>,</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;         <span class="comment">/* If this is delayed the only thing that will happen is a BYE request so we don&#39;t</span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">          * actually need to store the response code for when it happens.</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1);</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      }</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      status = pjsip_inv_end_session(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;packet);</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      <span class="keywordflow">if</span> (status == PJ_SUCCESS &amp;&amp; packet) {</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;         <span class="comment">/* Flush any delayed requests so they cannot overlap this transaction. */</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;         <span class="keywordflow">while</span> ((delay = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>))) {</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a>(delay);</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;         }</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;         <span class="keywordflow">if</span> (packet-&gt;msg-&gt;type == PJSIP_RESPONSE_MSG) {</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(session, packet);</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, packet);</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;         }</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      }</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;   }</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a219b1d1405e2e3799cc9c784154c688d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a></div><div class="ttdeci">static int session_end_completion(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">res_pjsip_session.c:4548</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aed4c9a6bf6967790981c02027f5f02e8"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a></div><div class="ttdeci">void ast_sip_session_send_response(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">res_pjsip_session.c:2576</a></div></div>
<div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_add232d9657a85f507655cda6c38b9e4a"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">ast_sip_session::terminate_while_deferred</a></div><div class="ttdeci">unsigned int terminate_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">res_pjsip_session.h:217</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3a7a6a1e5210478116a640b215ef53b4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a></div><div class="ttdeci">static int delay_request(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, int generate_new_sdp, enum delayed_method method, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queue_head)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">res_pjsip_session.c:1591</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abdb87d2e0451ce7382da2c5b23525c73"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a></div><div class="ttdeci">static void delayed_request_free(struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">res_pjsip_session.c:1379</a></div></div>
<div class="ttc" id="utils_8h_html_aac9153aee4bdb92701df902e06a74eb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a></div><div class="ttdeci">#define SWAP(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00230">utils.h:230</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad11de1bfcc9846e016339bd3b482d16f"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a></div><div class="ttdeci">static int session_end(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">res_pjsip_session.c:4525</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_af57bfc75550b1312b46ef584410ae8a9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a></div><div class="ttdeci">void ast_sip_session_media_stats_save(struct ast_sip_session *sip_session, struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Save a media stats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">res_pjsip_session.c:244</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22d632ac85810d8394ad5d54b83a2f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d632ac85810d8394ad5d54b83a2f87">&#9670;&nbsp;</a></span>ast_sip_session_unregister_sdp_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_unregister_sdp_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>stream_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister an SDP handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The SDP handler to unregister </td></tr>
    <tr><td class="paramname">stream_type</td><td>Stream type for which the SDP handler was registered </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00199">199</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01743">ao2_callback_data</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00176">remove_handler()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02324">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;{</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0989647a11cd5cd082cf357a387c47a7">remove_handler</a>, (<span class="keywordtype">void</span> *)stream_type, handler);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0989647a11cd5cd082cf357a387c47a7"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0989647a11cd5cd082cf357a387c47a7">remove_handler</a></div><div class="ttdeci">static int remove_handler(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00176">res_pjsip_session.c:176</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae89632996ffdcf888ab251c14dc6cdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae89632996ffdcf888ab251c14dc6cdb">&#9670;&nbsp;</a></span>ast_sip_session_unregister_supplement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_unregister_supplement </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *&#160;</td>
          <td class="paramname"><em>supplement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a an supplement to SIP session processing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">supplement</td><td>The supplement to unregister </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00063">63</a> of file <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html">pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00569">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00581">SCOPED_LOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9e/pjsip__message__filter_8c_source.html#l00565">ast_res_pjsip_cleanup_message_filter()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03304">load_module()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03403">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>, <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d9/d91/structsession__supplements.html">session_supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">if</span> (supplement == iter) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="lock_8h_html_a8b9d9f2f2c41ecf3c70587c2510dddfc"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a></div><div class="ttdeci">#define SCOPED_LOCK(varname, lock, lockfunc, unlockfunc)</div><div class="ttdoc">Scoped Locks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00581">lock.h:581</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="structsession__supplements_html"><div class="ttname"><a href="../../d9/d91/structsession__supplements.html">session_supplements</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00033">pjsip_session.c:33</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac37f93342a3e8ca33fb4ca84d4ac3e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac37f93342a3e8ca33fb4ca84d4ac3e58">&#9670;&nbsp;</a></span>ast_sip_session_unsuspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_unsuspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request the session serializer be unsuspended. </p>
<dl class="section since"><dt>Since</dt><dd>12.7.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Which session to unsuspend the serializer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03200">3200</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01196">ast_taskprocessor_unsuspend()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">ast_sip_session_suspender::complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">ast_sip_session::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01612">chan_pjsip_indicate()</a>.</p>
<div class="fragment"><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;{</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *suspender = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a>;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;   <span class="keywordflow">if</span> (!suspender) {</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="comment">/* Nothing to do */</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;   }</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;   <span class="comment">/* Signal that the serializer task suspension is now complete. */</span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(suspender);</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">complete</a> = 1;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>);</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(suspender);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, -1);</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a8460a4b877658e3c2a6abbafcfa4c54c">ast_taskprocessor_unsuspend</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">ast_sip_session_suspender::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">res_pjsip_session.c:3115</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a8460a4b877658e3c2a6abbafcfa4c54c"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a8460a4b877658e3c2a6abbafcfa4c54c">ast_taskprocessor_unsuspend</a></div><div class="ttdeci">int ast_taskprocessor_unsuspend(struct ast_taskprocessor *tps)</div><div class="ttdoc">Indicate the taskprocessor is unsuspended. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01196">taskprocessor.c:1196</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
<div class="ttc" id="structast__sip__session_html_a965365a4589d683773f1eb2b6bb8e3f2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">ast_sip_session::suspended</a></div><div class="ttdeci">struct ast_sip_session_suspender * suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">res_pjsip_session.h:197</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:35 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
