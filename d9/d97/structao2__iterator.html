<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: ao2_iterator Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">ao2_iterator Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>When we need to walk through a container, we use an <a class="el" href="../../d9/d97/structao2__iterator.html" title="When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...">ao2_iterator</a> to keep track of the current position.  
 <a href="../../d9/d97/structao2__iterator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for ao2_iterator:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d21/structao2__iterator__coll__graph.png" border="0" usemap="#ao2__iterator_coll__map" alt="Collaboration graph"/></div>
<map name="ao2__iterator_coll__map" id="ao2__iterator_coll__map">
<area shape="rect" id="node2" href="../../d2/da9/structao2__container.html" title="Generic container type. " alt="" coords="164,5,277,32"/>
<area shape="rect" id="node3" href="../../df/d93/structao2__container__methods.html" title="ao2_container_methods" alt="" coords="288,245,465,272"/>
<area shape="rect" id="node4" href="../../da/d68/structao2__container__node.html" title="Generic container node. " alt="" coords="301,103,453,130"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:add66ef9875bb0ff1bd4747707d6f3333"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d97/structao2__iterator.html#add66ef9875bb0ff1bd4747707d6f3333">c</a></td></tr>
<tr class="separator:add66ef9875bb0ff1bd4747707d6f3333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a520408f4775914f7510cc59db5a60b38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d97/structao2__iterator.html#a520408f4775914f7510cc59db5a60b38">complete</a></td></tr>
<tr class="separator:a520408f4775914f7510cc59db5a60b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8bf36fe0577cba66bccda3a6f7e80a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d97/structao2__iterator.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a></td></tr>
<tr class="separator:ac8bf36fe0577cba66bccda3a6f7e80a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af76c8e4ca085d06236bab2f1caf79db9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d97/structao2__iterator.html#af76c8e4ca085d06236bab2f1caf79db9">last_node</a></td></tr>
<tr class="separator:af76c8e4ca085d06236bab2f1caf79db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>When we need to walk through a container, we use an <a class="el" href="../../d9/d97/structao2__iterator.html" title="When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...">ao2_iterator</a> to keep track of the current position. </p>
<p>Because the navigation is typically done without holding the lock on the container across the loop, objects can be inserted or deleted or moved while we work. As a consequence, there is no guarantee that we manage to touch all the elements in the container, and it is possible that we touch the same object multiple times.</p>
<p>An iterator must be first initialized with <a class="el" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6" title="Create an iterator for a container. ">ao2_iterator_init()</a>, then we can use o = <a class="el" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next()</a> to move from one element to the next. Remember that the object returned by <a class="el" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next()</a> has its refcount incremented, and the reference must be explicitly released when done with it.</p>
<p>In addition, <a class="el" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6" title="Create an iterator for a container. ">ao2_iterator_init()</a> will hold a reference to the container being iterated and the last container node found. Thes objects will be unreffed when <a class="el" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a" title="Destroy a container iterator. ">ao2_iterator_destroy()</a> is called to free up the resources used by the iterator (if any).</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d9/d97/structao2__iterator.html#add66ef9875bb0ff1bd4747707d6f3333">c</a> = ... <span class="comment">// the container we want to iterate on</span></div><div class="line"><span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><span class="keyword">struct </span>my_obj *o;</div><div class="line"></div><div class="line">i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(c, <a class="code" href="../../d9/d97/structao2__iterator.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div><div class="line"></div><div class="line"><span class="keywordflow">while</span> ((o = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line">   ... <span class="keywordflow">do</span> something on o ...</div><div class="line">   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(o, -1);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="../../d5/da5/astobj2_8h.html#a955f0eaa56fb0429209b68367d0a5246">ao2_iterator_restart</a>(&amp;i);</div><div class="line"><span class="keywordflow">while</span> ((o = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line">   ... <span class="keywordflow">do</span> something on o ...</div><div class="line">   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(o, -1);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div></div><!-- fragment --><p>The <a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> iterator</p>
<dl class="section note"><dt>Note</dt><dd>You are not supposed to know the internals of an iterator! We would like the iterator to be opaque, unfortunately its size needs to be known if we want to store it around without too much trouble. Anyways... The iterator has a pointer to the container, and a flags field specifying various things e.g. whether the container should be locked or not while navigating on it. The iterator "points" to the current container node.</dd></dl>
<p>Details are in the implementation of <a class="el" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01841">1841</a> of file <a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="add66ef9875bb0ff1bd4747707d6f3333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add66ef9875bb0ff1bd4747707d6f3333">&#9670;&nbsp;</a></span>c</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* c</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The container (Has a reference) </p>

<p class="definition">Definition at line <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01843">1843</a> of file <a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00556">__ao2_iterator_next()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00630">ao2_iterator_count()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, and <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00497">ao2_iterator_restart()</a>.</p>

</div>
</div>
<a id="a520408f4775914f7510cc59db5a60b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a520408f4775914f7510cc59db5a60b38">&#9670;&nbsp;</a></span>complete</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int complete</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Nonzero if the iteration has completed. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01847">1847</a> of file <a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00556">__ao2_iterator_next()</a>, and <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00497">ao2_iterator_restart()</a>.</p>

</div>
</div>
<a id="ac8bf36fe0577cba66bccda3a6f7e80a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8bf36fe0577cba66bccda3a6f7e80a4">&#9670;&nbsp;</a></span>flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flags</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>operation flags (enum ao2_iterator_flags) </p>

<p class="definition">Definition at line <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01849">1849</a> of file <a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00556">__ao2_iterator_next()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, and <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00497">ao2_iterator_restart()</a>.</p>

</div>
</div>
<a id="af76c8e4ca085d06236bab2f1caf79db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af76c8e4ca085d06236bab2f1caf79db9">&#9670;&nbsp;</a></span>last_node</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* last_node</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Last container node (Has a reference) </p>

<p class="definition">Definition at line <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01845">1845</a> of file <a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00556">__ao2_iterator_next()</a>, and <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00497">ao2_iterator_restart()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../d5/da5/astobj2_8h_source.html">astobj2.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:47:18 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
