<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: pbx_spool.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b304eca70ab284d1e36606462b52a069.html">pbx</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pbx_spool.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Full-featured outgoing call spool support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../de/df7/time_8h_source.html">time.h</a>&gt;</code><br />
<code>#include &lt;utime.h&gt;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &lt;sys/inotify.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dd/df2/paths_8h_source.html">asterisk/paths.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d42/lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d4d/file_8h_source.html">asterisk/file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d8c/logger_8h_source.html">asterisk/logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d5b/options_8h_source.html">asterisk/options.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d0a/format_8h_source.html">asterisk/format.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1c/format__cache_8h_source.html">asterisk/format_cache.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pbx_spool.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/dc9/pbx__spool_8c__incl.png" border="0" usemap="#pbx__spool_8c" alt=""/></div>
<map name="pbx__spool_8c" id="pbx__spool_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="179,379,263,405"/>
<area shape="rect" id="node10" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="945,528,1007,555"/>
<area shape="rect" id="node16" href="../../dd/df2/paths_8h.html" title="Asterisk file paths, configured in asterisk.conf. " alt="" coords="3090,80,3214,107"/>
<area shape="rect" id="node17" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1399,453,1513,480"/>
<area shape="rect" id="node22" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="2015,528,2142,555"/>
<area shape="rect" id="node23" href="../../d7/d5b/options_8h.html" title="Options provided by main asterisk program. " alt="" coords="2043,603,2178,629"/>
<area shape="rect" id="node24" href="../../d2/d4d/file_8h.html" title="Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. " alt="" coords="3239,80,3345,107"/>
<area shape="rect" id="node27" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1285,155,1424,181"/>
<area shape="rect" id="node29" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1921,304,2036,331"/>
<area shape="rect" id="node32" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="2399,379,2529,405"/>
<area shape="rect" id="node47" href="../../de/d47/callerid_8h.html" title="CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr..." alt="" coords="2364,155,2497,181"/>
<area shape="rect" id="node48" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="2010,80,2121,107"/>
<area shape="rect" id="node49" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="2204,155,2340,181"/>
<area shape="rect" id="node50" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="3369,80,3545,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="899,677,1053,704"/>
<area shape="rect" id="node4" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="1191,453,1329,480"/>
<area shape="rect" id="node8" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="259,453,394,480"/>
<area shape="rect" id="node5" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1083,528,1226,555"/>
<area shape="rect" id="node12" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1872,603,2019,629"/>
<area shape="rect" id="node21" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1687,528,1838,555"/>
<area shape="rect" id="node28" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="1748,229,1892,256"/>
<area shape="rect" id="node30" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2217,379,2375,405"/>
<area shape="rect" id="node31" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="1647,304,1806,331"/>
<area shape="rect" id="node33" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1019,304,1154,331"/>
<area shape="rect" id="node34" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="625,379,775,405"/>
<area shape="rect" id="node35" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="865,229,1029,256"/>
<area shape="rect" id="node36" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="809,304,935,331"/>
<area shape="rect" id="node37" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="309,229,456,256"/>
<area shape="rect" id="node38" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="2117,229,2243,256"/>
<area shape="rect" id="node39" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="1053,229,1160,256"/>
<area shape="rect" id="node40" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="582,304,733,331"/>
<area shape="rect" id="node41" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="1185,229,1346,256"/>
<area shape="rect" id="node42" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="93,304,264,331"/>
<area shape="rect" id="node43" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="339,304,455,331"/>
<area shape="rect" id="node44" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="632,229,789,256"/>
<area shape="rect" id="node45" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1916,229,2041,256"/>
<area shape="rect" id="node46" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1370,229,1521,256"/>
</map>
</div>
</div>
<p><a href="../../d9/dd4/pbx__spool_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d4c/structcreatelist.html">createlist</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d22/structdirentry.html">direntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d8d/structdirlist.html">dirlist</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/de9/structopenlist.html">openlist</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afa0499dcb85922b683da3918f512adb6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#afa0499dcb85922b683da3918f512adb6">LINE_BUFFER_SIZE</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:afa0499dcb85922b683da3918f512adb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a92a045b44579eea64c064cfe975a2253"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a> = (1 &lt;&lt; 0), 
<a class="el" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a> = (1 &lt;&lt; 1), 
<a class="el" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a> = (1 &lt;&lt; 2)
 }</td></tr>
<tr class="separator:a92a045b44579eea64c064cfe975a2253"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02dc4c1efea1e4aca262eebf980ea6e1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a02dc4c1efea1e4aca262eebf980ea6e1">append_variable</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *<a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>)</td></tr>
<tr class="separator:a02dc4c1efea1e4aca262eebf980ea6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4bebde68928965e1fc6a7189991d238"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#af4bebde68928965e1fc6a7189991d238">apply_outgoing</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o, FILE *f)</td></tr>
<tr class="separator:af4bebde68928965e1fc6a7189991d238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a68d0622f6db212f1f50e10268905d"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#aa7a68d0622f6db212f1f50e10268905d">attempt_thread</a> (void *data)</td></tr>
<tr class="separator:aa7a68d0622f6db212f1f50e10268905d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25da8535544761b80644470bb43e2798"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o)</td></tr>
<tr class="separator:a25da8535544761b80644470bb43e2798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56de20a1d449ec5c3f5bcdebd41656f7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a56de20a1d449ec5c3f5bcdebd41656f7">launch_service</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o)</td></tr>
<tr class="separator:a56de20a1d449ec5c3f5bcdebd41656f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09be07be92b99d80ff05cdbeb20dd321"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a09be07be92b99d80ff05cdbeb20dd321">new_outgoing</a> (const char *fn)</td></tr>
<tr class="separator:a09be07be92b99d80ff05cdbeb20dd321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae181372e801ddadef5e74118188b245e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ae181372e801ddadef5e74118188b245e">parse_line</a> (char *line, unsigned int lineno, struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o)</td></tr>
<tr class="separator:ae181372e801ddadef5e74118188b245e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31d65747257ce6b8ce63d28cc66a9ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#af31d65747257ce6b8ce63d28cc66a9ca">queue_created_files</a> (void)</td></tr>
<tr class="separator:af31d65747257ce6b8ce63d28cc66a9ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac9b4f318b47270021bafdfe747bc8e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a> (const char *filename, time_t when)</td></tr>
<tr class="separator:a9ac9b4f318b47270021bafdfe747bc8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8d593448c66c670dda2fc5949ddc26"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a4b8d593448c66c670dda2fc5949ddc26">queue_file_create</a> (const char *filename)</td></tr>
<tr class="separator:a4b8d593448c66c670dda2fc5949ddc26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbebfe4330dea5fd5f86c8b335c6c06"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#acbbebfe4330dea5fd5f86c8b335c6c06">queue_file_open</a> (const char *filename)</td></tr>
<tr class="separator:acbbebfe4330dea5fd5f86c8b335c6c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e06c8822d41475d2fc1a30b30a5cdd8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a1e06c8822d41475d2fc1a30b30a5cdd8">queue_file_write</a> (const char *filename)</td></tr>
<tr class="separator:a1e06c8822d41475d2fc1a30b30a5cdd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af79325470445e6e4d889a461ea654873"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o, const char *<a class="el" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</td></tr>
<tr class="memdesc:af79325470445e6e4d889a461ea654873"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a call file from the outgoing queue optionally moving it in the archive dir.  <a href="#af79325470445e6e4d889a461ea654873">More...</a><br /></td></tr>
<tr class="separator:af79325470445e6e4d889a461ea654873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a40f55167da57243f6865030c9a83e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a> (struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *o, time_t now, char *s)</td></tr>
<tr class="separator:a42a40f55167da57243f6865030c9a83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d52c7908eed4b3c37b09bd759e8b61"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ad5d52c7908eed4b3c37b09bd759e8b61">scan_service</a> (const char *fn, time_t now)</td></tr>
<tr class="separator:ad5d52c7908eed4b3c37b09bd759e8b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55635376623ac9afd203650fb458907a"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a55635376623ac9afd203650fb458907a">scan_thread</a> (void *unused)</td></tr>
<tr class="separator:a55635376623ac9afd203650fb458907a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;Outgoing Spool Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_DEFAULT, .support_level = AST_MODULE_SUPPORT_CORE, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ffbecd9160d386e6c1414eae04f087d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d4c/structcreatelist.html">createlist</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a9ffbecd9160d386e6c1414eae04f087d">createlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, }</td></tr>
<tr class="separator:a9ffbecd9160d386e6c1414eae04f087d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788ba1da14f1bbe39329cb80fcd8b891"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/d8d/structdirlist.html">dirlist</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a788ba1da14f1bbe39329cb80fcd8b891">dirlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:a788ba1da14f1bbe39329cb80fcd8b891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42ec25c70b7377d1af44bdf8172740e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/de9/structopenlist.html">openlist</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#aa42ec25c70b7377d1af44bdf8172740e">openlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, }</td></tr>
<tr class="separator:aa42ec25c70b7377d1af44bdf8172740e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03acec5c3fd04176854f6c7104e60398"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a> [255]</td></tr>
<tr class="separator:a03acec5c3fd04176854f6c7104e60398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fba478e22f3c9ba363a2ab697c72c74"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a> [255]</td></tr>
<tr class="separator:a9fba478e22f3c9ba363a2ab697c72c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Full-featured outgoing call spool support. </p>

<p class="definition">Definition in file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afa0499dcb85922b683da3918f512adb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0499dcb85922b683da3918f512adb6">&#9670;&nbsp;</a></span>LINE_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LINE_BUFFER_SIZE&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00294">294</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00296">apply_outgoing()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a92a045b44579eea64c064cfe975a2253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92a045b44579eea64c064cfe975a2253">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734"></a>SPOOL_FLAG_ALWAYS_DELETE&#160;</td><td class="fielddoc"><p>Always delete the call file after a call succeeds or the maximum number of retries is exceeded, even if the modification time of the call file is in the future. </p>
</td></tr>
<tr><td class="fieldname"><a id="a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304"></a>SPOOL_FLAG_ARCHIVE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd"></a>SPOOL_FLAG_EARLY_MEDIA&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00062">62</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;     {<span class="comment"></span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">   /*! Always delete the call file after a call succeeds or the</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    * maximum number of retries is exceeded, even if the</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    * modification time of the call file is in the future.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="comment">/* Don&#39;t unlink the call file after processing, move in qdonedir */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a> = (1 &lt;&lt; 1),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="comment">/* Connect the channel with the outgoing extension once early media is received */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a> = (1 &lt;&lt; 2),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;};</div><div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00071">pbx_spool.c:71</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00067">pbx_spool.c:67</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00069">pbx_spool.c:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00965">965</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00965">965</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="a02dc4c1efea1e4aca262eebf980ea6e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02dc4c1efea1e4aca262eebf980ea6e1">&#9670;&nbsp;</a></span>append_variable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void append_variable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00164">164</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00949">ast_variable_list_append</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">ast_variable_new</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00614">var</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00097">outgoing::vars</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00296">apply_outgoing()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00177">parse_line()</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a> = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">if</span> (!var) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="comment">/* Always insert at the end, because some people want to treat the spool</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">    * file as a script */</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a7af2e88e6e3812ec80facb1b41df43de">ast_variable_list_append</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, var);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="structoutgoing_html_a134fe67053d035e763d6cf99916c1bf8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">outgoing::vars</a></div><div class="ttdeci">struct ast_variable * vars</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00097">pbx_spool.c:97</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a66581086d34dfe7ea86b0644bacef239"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a></div><div class="ttdeci">#define ast_variable_new(name, value, filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">include/asterisk/config.h:914</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a7af2e88e6e3812ec80facb1b41df43de"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a7af2e88e6e3812ec80facb1b41df43de">ast_variable_list_append</a></div><div class="ttdeci">#define ast_variable_list_append(head, new_var)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00949">include/asterisk/config.h:949</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4bebde68928965e1fc6a7189991d238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4bebde68928965e1fc6a7189991d238">&#9670;&nbsp;</a></span>apply_outgoing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int apply_outgoing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00296">296</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::app</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00164">append_variable()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::dest</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::exten</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00294">LINE_BUFFER_SIZE</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00095">ast_variable::lineno</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00177">parse_line()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00078">outgoing::retries</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::tech</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[<a class="code" href="../../d9/dd4/pbx__spool_8c.html#afa0499dcb85922b683da3918f512adb6">LINE_BUFFER_SIZE</a>];</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a> = 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), f)) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(buf);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      lineno++;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (buf[len - 1] == <span class="charliteral">&#39;\n&#39;</span> || feof(f)) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         <span class="comment">/* We have a line, parse it */</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#ae181372e801ddadef5e74118188b245e">parse_line</a>(buf, lineno, o);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">/* Crazy long line, skip it */</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Skipping extremely long line at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">/* Consume the rest of the problematic line */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), f)) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         len = strlen(buf);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         <span class="keywordflow">if</span> (buf[len - 1] == <span class="charliteral">&#39;\n&#39;</span> || feof(f)) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      || (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aaee31f4cc48985167efcd38ab252dac8">exten</a>))) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;At least one of app or extension must be specified, &quot;</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         <span class="stringliteral">&quot;along with tech and dest in file %s\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;%d&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> + 1) &lt; <span class="keyword">sizeof</span>(buf)) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a02dc4c1efea1e4aca262eebf980ea6e1">append_variable</a>(o, <span class="stringliteral">&quot;AST_OUTGOING_ATTEMPT&quot;</span>, buf);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__variable_html_a501b314f49b3a9ff6e7be599d94686ee"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">ast_variable::lineno</a></div><div class="ttdeci">int lineno</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00095">include/asterisk/config.h:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a66066052ae6571f5495a4e7f8df6c0bb"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">outgoing::app</a></div><div class="ttdeci">const ast_string_field app</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a8ba735ab56b2afeb844916994c86f3f5"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">outgoing::retries</a></div><div class="ttdeci">int retries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00078">pbx_spool.c:78</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_afa0499dcb85922b683da3918f512adb6"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#afa0499dcb85922b683da3918f512adb6">LINE_BUFFER_SIZE</a></div><div class="ttdeci">#define LINE_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00294">pbx_spool.c:294</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structoutgoing_html_aaee31f4cc48985167efcd38ab252dac8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aaee31f4cc48985167efcd38ab252dac8">outgoing::exten</a></div><div class="ttdeci">const ast_string_field exten</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_ae181372e801ddadef5e74118188b245e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#ae181372e801ddadef5e74118188b245e">parse_line</a></div><div class="ttdeci">static void parse_line(char *line, unsigned int lineno, struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00177">pbx_spool.c:177</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a02dc4c1efea1e4aca262eebf980ea6e1"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a02dc4c1efea1e4aca262eebf980ea6e1">append_variable</a></div><div class="ttdeci">static void append_variable(struct outgoing *o, const char *name, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00164">pbx_spool.c:164</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_aed48c29baf79b703d3f84d791e08ac4f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">outgoing::dest</a></div><div class="ttdeci">const ast_string_field dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">outgoing::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00965">965</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="aa7a68d0622f6db212f1f50e10268905d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a68d0622f6db212f1f50e10268905d">&#9670;&nbsp;</a></span>attempt_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* attempt_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">431</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::account</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::app</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05913">ast_channel_reason2str()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../db/de0/pbx_8h_source.html#l01154">AST_OUTGOING_WAIT_COMPLETE</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08015">ast_pbx_outgoing_app()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l07951">ast_pbx_outgoing_exten()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00083">outgoing::capabilities</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::cid_name</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::cid_num</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::context</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::data</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::dest</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::exten</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00114">free_outgoing()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00079">outgoing::maxretries</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00099">outgoing::options</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00096">outgoing::priority</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">queue_file()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00363">remove_from_queue()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00078">outgoing::retries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00080">outgoing::retrytime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00339">safe_append()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00071">SPOOL_FLAG_EARLY_MEDIA</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::tech</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00097">outgoing::vars</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00081">outgoing::waittime</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00470">launch_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a> *o = <a class="code" href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">data</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keywordtype">int</span> res, reason;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>)) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Attempting call on %s/%s for application %s(%s) (Retry %d)\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">data</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#a2afffb175879297ed07ec21df02fa6dc">ast_pbx_outgoing_app</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a> * 1000, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">data</a>, &amp;reason,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916ad1f109b734f3cb4d20937f283eb98d69">AST_OUTGOING_WAIT_COMPLETE</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a626176754f57f4dc291e44916a5354f8">account</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Attempting call on %s/%s for %s@%s:%d (Retry %d)\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aaee31f4cc48985167efcd38ab252dac8">exten</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a7faec841658b88ad0cfbc684853acad3">context</a>,o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#a6c3a35983760904213206a8f0a7df9c9">ast_pbx_outgoing_exten</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a> * 1000, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a7faec841658b88ad0cfbc684853acad3">context</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aaee31f4cc48985167efcd38ab252dac8">exten</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>, &amp;reason,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916ad1f109b734f3cb4d20937f283eb98d69">AST_OUTGOING_WAIT_COMPLETE</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a626176754f57f4dc291e44916a5354f8">account</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a>),</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;         <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Call failed to go through, reason (%d) %s\n&quot;</span>, reason, <a class="code" href="../../d5/d7b/channel_8h.html#a25ec12c3abdc7ad6d7971f4ad3737d94">ast_channel_reason2str</a>(reason));</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> &gt;= o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">maxretries</a> + 1) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         <span class="comment">/* Max retries exceeded */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Queued call to %s/%s expired without completion after %d attempt%s\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> - 1, ((o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> - 1) != 1) ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a>(o, <span class="stringliteral">&quot;Expired&quot;</span>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <span class="comment">/* Notate that the call is still active */</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a>(o, time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <span class="stringliteral">&quot;EndRetry&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#if defined(HAVE_INOTIFY) || defined(HAVE_KQUEUE)</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) + o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Call completed to %s/%s\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a>(o, <span class="stringliteral">&quot;Completed&quot;</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="structoutgoing_html_acea391ea9b4b2ee61b5b84bce2187f12"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#acea391ea9b4b2ee61b5b84bce2187f12">outgoing::cid_name</a></div><div class="ttdeci">const ast_string_field cid_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00071">pbx_spool.c:71</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="structoutgoing_html_ac35730743cfe5d3cb0971c186fb1788a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">outgoing::maxretries</a></div><div class="ttdeci">int maxretries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00079">pbx_spool.c:79</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_af79325470445e6e4d889a461ea654873"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a></div><div class="ttdeci">static int remove_from_queue(struct outgoing *o, const char *status)</div><div class="ttdoc">Remove a call file from the outgoing queue optionally moving it in the archive dir. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00363">pbx_spool.c:363</a></div></div>
<div class="ttc" id="structoutgoing_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">outgoing::priority</a></div><div class="ttdeci">int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00096">pbx_spool.c:96</a></div></div>
<div class="ttc" id="structoutgoing_html_a6044abdba0f2d5658d4d8ecf083060cf"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">outgoing::waittime</a></div><div class="ttdeci">int waittime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00081">pbx_spool.c:81</a></div></div>
<div class="ttc" id="structoutgoing_html_a1db41d2bb5281151490fa74f8f8de95d"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a1db41d2bb5281151490fa74f8f8de95d">outgoing::cid_num</a></div><div class="ttdeci">const ast_string_field cid_num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a66066052ae6571f5495a4e7f8df6c0bb"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a66066052ae6571f5495a4e7f8df6c0bb">outgoing::app</a></div><div class="ttdeci">const ast_string_field app</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a8ba735ab56b2afeb844916994c86f3f5"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">outgoing::retries</a></div><div class="ttdeci">int retries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00078">pbx_spool.c:78</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a25da8535544761b80644470bb43e2798"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a></div><div class="ttdeci">static void free_outgoing(struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00114">pbx_spool.c:114</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="pbx_8h_html_a6c3a35983760904213206a8f0a7df9c9"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6c3a35983760904213206a8f0a7df9c9">ast_pbx_outgoing_exten</a></div><div class="ttdeci">int ast_pbx_outgoing_exten(const char *type, struct ast_format_cap *cap, const char *addr, int timeout, const char *context, const char *exten, int priority, int *reason, int synchronous, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel, int early_media, const struct ast_assigned_ids *assignedids)</div><div class="ttdoc">Synchronously or asynchronously make an outbound call and send it to a particular extension...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l07951">pbx.c:7951</a></div></div>
<div class="ttc" id="structoutgoing_html_a7faec841658b88ad0cfbc684853acad3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a7faec841658b88ad0cfbc684853acad3">outgoing::context</a></div><div class="ttdeci">const ast_string_field context</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structoutgoing_html_aaee31f4cc48985167efcd38ab252dac8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aaee31f4cc48985167efcd38ab252dac8">outgoing::exten</a></div><div class="ttdeci">const ast_string_field exten</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9ac9b4f318b47270021bafdfe747bc8e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a></div><div class="ttdeci">static void queue_file(const char *filename, time_t when)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00560">pbx_spool.c:560</a></div></div>
<div class="ttc" id="pbx_8h_html_a24a619e5cc5e3f683322295991c57916ad1f109b734f3cb4d20937f283eb98d69"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916ad1f109b734f3cb4d20937f283eb98d69">AST_OUTGOING_WAIT_COMPLETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l01154">pbx.h:1154</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structoutgoing_html_a7870f447ef3c43ebf148da15363b25dd"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">outgoing::data</a></div><div class="ttdeci">const ast_string_field data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a134fe67053d035e763d6cf99916c1bf8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">outgoing::vars</a></div><div class="ttdeci">struct ast_variable * vars</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00097">pbx_spool.c:97</a></div></div>
<div class="ttc" id="structoutgoing_html_a626176754f57f4dc291e44916a5354f8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a626176754f57f4dc291e44916a5354f8">outgoing::account</a></div><div class="ttdeci">const ast_string_field account</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html"><div class="ttname"><a href="../../de/dcd/structoutgoing.html">outgoing</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00077">pbx_spool.c:77</a></div></div>
<div class="ttc" id="structoutgoing_html_a5675a902ed1cbfcd7b797f0774c17120"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">outgoing::options</a></div><div class="ttdeci">struct ast_flags options</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00099">pbx_spool.c:99</a></div></div>
<div class="ttc" id="structoutgoing_html_ad8e6afe89e3ec022b30cdda570dcb1d3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">outgoing::retrytime</a></div><div class="ttdeci">int retrytime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00080">pbx_spool.c:80</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="pbx_8h_html_a2afffb175879297ed07ec21df02fa6dc"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a2afffb175879297ed07ec21df02fa6dc">ast_pbx_outgoing_app</a></div><div class="ttdeci">int ast_pbx_outgoing_app(const char *type, struct ast_format_cap *cap, const char *addr, int timeout, const char *app, const char *appdata, int *reason, int synchronous, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel, const struct ast_assigned_ids *assignedids)</div><div class="ttdoc">Synchronously or asynchronously make an outbound call and execute an application on the channel...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l08015">pbx.c:8015</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_aed48c29baf79b703d3f84d791e08ac4f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">outgoing::dest</a></div><div class="ttdeci">const ast_string_field dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">outgoing::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a42a40f55167da57243f6865030c9a83e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a></div><div class="ttdeci">static void safe_append(struct outgoing *o, time_t now, char *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00339">pbx_spool.c:339</a></div></div>
<div class="ttc" id="structoutgoing_html_a0f943c30fc292bd35c9619493661920f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">outgoing::capabilities</a></div><div class="ttdeci">struct ast_format_cap * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00083">pbx_spool.c:83</a></div></div>
<div class="ttc" id="channel_8h_html_a25ec12c3abdc7ad6d7971f4ad3737d94"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25ec12c3abdc7ad6d7971f4ad3737d94">ast_channel_reason2str</a></div><div class="ttdeci">const char * ast_channel_reason2str(int reason)</div><div class="ttdoc">return an english explanation of the code returned thru __ast_request_and_dial&amp;#39;s &amp;#39;outstate&amp;#39; argument ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05913">channel.c:5913</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25da8535544761b80644470bb43e2798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25da8535544761b80644470bb43e2798">&#9670;&nbsp;</a></span>free_outgoing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_outgoing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00114">114</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00368">ast_string_field_free_memory</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01263">ast_variables_destroy()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00083">outgoing::capabilities</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00097">outgoing::vars</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">attempt_thread()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00470">launch_service()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00124">new_outgoing()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(o);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="include_2asterisk_2config_8h_html_adea5390496e5477192d86f340d512d04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a></div><div class="ttdeci">void ast_variables_destroy(struct ast_variable *var)</div><div class="ttdoc">Free variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01263">extconf.c:1263</a></div></div>
<div class="ttc" id="structoutgoing_html_a134fe67053d035e763d6cf99916c1bf8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a134fe67053d035e763d6cf99916c1bf8">outgoing::vars</a></div><div class="ttdeci">struct ast_variable * vars</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00097">pbx_spool.c:97</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structoutgoing_html_a0f943c30fc292bd35c9619493661920f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">outgoing::capabilities</a></div><div class="ttdeci">struct ast_format_cap * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00083">pbx_spool.c:83</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56de20a1d449ec5c3f5bcdebd41656f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56de20a1d449ec5c3f5bcdebd41656f7">&#9670;&nbsp;</a></span>launch_service()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void launch_service </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00470">470</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00563">ast_pthread_create_detached</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">attempt_thread()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00114">free_outgoing()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;{</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   pthread_t t;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="keywordflow">if</span> ((ret = <a class="code" href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a>(&amp;t, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#aa7a68d0622f6db212f1f50e10268905d">attempt_thread</a>, o))) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create thread :( (returned error: %d)\n&quot;</span>, ret);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div><div class="ttc" id="utils_8h_html_a832647380b1f97e7ac1b4492f8816d46"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a></div><div class="ttdeci">#define ast_pthread_create_detached(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00563">utils.h:563</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_aa7a68d0622f6db212f1f50e10268905d"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#aa7a68d0622f6db212f1f50e10268905d">attempt_thread</a></div><div class="ttdeci">static void * attempt_thread(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00431">pbx_spool.c:431</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a25da8535544761b80644470bb43e2798"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a></div><div class="ttdeci">static void free_outgoing(struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00114">pbx_spool.c:114</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00946">946</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00154">ast_config_AST_SPOOL_DIR</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02231">ast_mkdir()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00102">AST_MODULE_LOAD_FAILURE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00572">ast_pthread_create_detached_background</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>, and <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01089">thread</a>.</p>
<div class="fragment"><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;{</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   pthread_t <a class="code" href="../../df/d44/app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   snprintf(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a>, <span class="stringliteral">&quot;outgoing&quot;</span>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a>(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, 0777)) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create queue directory %s -- outgoing spool disabled\n&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   snprintf(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a>, <span class="stringliteral">&quot;outgoing_done&quot;</span>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="keywordflow">if</span> ((ret = <a class="code" href="../../d5/d60/utils_8h.html#aa73be876e3a4024b91ce2e09d8b945d1">ast_pthread_create_detached_background</a>(&amp;thread, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a55635376623ac9afd203650fb458907a">scan_thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create thread :( (returned error: %d)\n&quot;</span>, ret);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a>;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div><div class="ttc" id="app__meetme_8c_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01089">app_meetme.c:1089</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9fba478e22f3c9ba363a2ab697c72c74"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a></div><div class="ttdeci">static char qdonedir[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00075">pbx_spool.c:75</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a03acec5c3fd04176854f6c7104e60398"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a></div><div class="ttdeci">static char qdir[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00074">pbx_spool.c:74</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_aa73be876e3a4024b91ce2e09d8b945d1"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aa73be876e3a4024b91ce2e09d8b945d1">ast_pthread_create_detached_background</a></div><div class="ttdeci">#define ast_pthread_create_detached_background(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00572">utils.h:572</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a></div><div class="ttdoc">Module could not be loaded properly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00102">module.h:102</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="paths_8h_html_a95c5b4ffe620dc96d1ea9311b35c4d4f"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a></div><div class="ttdeci">const char * ast_config_AST_SPOOL_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00154">options.c:154</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a55635376623ac9afd203650fb458907a"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a55635376623ac9afd203650fb458907a">scan_thread</a></div><div class="ttdeci">static void * scan_thread(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00690">pbx_spool.c:690</a></div></div>
<div class="ttc" id="utils_8h_html_a7c38859ed90e96df2b0a0fdf843769d0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a></div><div class="ttdeci">int ast_mkdir(const char *path, int mode)</div><div class="ttdoc">Recursively create directory path. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02231">main/utils.c:2231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a09be07be92b99d80ff05cdbeb20dd321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09be07be92b99d80ff05cdbeb20dd321">&#9670;&nbsp;</a></span>new_outgoing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a>* new_outgoing </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00124">124</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00103">ast_format_cap_append</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00041">ast_format_slin</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00070">ast_set_flag</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00353">ast_string_field_init</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00083">outgoing::capabilities</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00114">free_outgoing()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00099">outgoing::options</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00096">outgoing::priority</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00080">outgoing::retrytime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00067">SPOOL_FLAG_ALWAYS_DELETE</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00081">outgoing::waittime</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a> *o;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   o = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*o));</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">if</span> (!o) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="comment">/* Initialize the new object. */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = 1;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a> = 300;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a> = 45;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(o, 128)) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">       * No need to call free_outgoing here since the failure was to</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">       * allocate string fields and no variables have been allocated</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">       * yet.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, <a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>)) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">/* String field set failed.  Since this string is important we must fail. */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a> = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, <a class="code" href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a>, 0);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="ttc" id="utils_8h_html_ab5033a1f3d781d45e7ccc27598114510"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a></div><div class="ttdeci">#define ast_set_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00070">utils.h:70</a></div></div>
<div class="ttc" id="structoutgoing_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">outgoing::priority</a></div><div class="ttdeci">int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00096">pbx_spool.c:96</a></div></div>
<div class="ttc" id="structoutgoing_html_a6044abdba0f2d5658d4d8ecf083060cf"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">outgoing::waittime</a></div><div class="ttdeci">int waittime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00081">pbx_spool.c:81</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a25da8535544761b80644470bb43e2798"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a></div><div class="ttdeci">static void free_outgoing(struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00114">pbx_spool.c:114</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00067">pbx_spool.c:67</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="structoutgoing_html"><div class="ttname"><a href="../../de/dcd/structoutgoing.html">outgoing</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00077">pbx_spool.c:77</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="structoutgoing_html_a5675a902ed1cbfcd7b797f0774c17120"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">outgoing::options</a></div><div class="ttdeci">struct ast_flags options</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00099">pbx_spool.c:99</a></div></div>
<div class="ttc" id="structoutgoing_html_ad8e6afe89e3ec022b30cdda570dcb1d3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">outgoing::retrytime</a></div><div class="ttdeci">int retrytime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00080">pbx_spool.c:80</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a0f943c30fc292bd35c9619493661920f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">outgoing::capabilities</a></div><div class="ttdeci">struct ast_format_cap * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00083">pbx_spool.c:83</a></div></div>
<div class="ttc" id="format__cache_8h_html_a771d7c34570e8e492c25a0c2eb41889d"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a></div><div class="ttdeci">struct ast_format * ast_format_slin</div><div class="ttdoc">Built-in cached signed linear 8kHz format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00041">format_cache.c:41</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae181372e801ddadef5e74118188b245e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae181372e801ddadef5e74118188b245e">&#9670;&nbsp;</a></span>parse_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_line </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00177">177</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::account</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::app</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00164">append_variable()</a>, <a class="el" href="../../dc/dd5/callerid_8c_source.html#l01092">ast_callerid_split()</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00320">ast_format_cap_update_by_allow_disallow()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00094">ast_set2_flag</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00157">ast_skip_blanks()</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00182">ast_trim_blanks()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l01951">ast_true()</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00082">outgoing::callingpid</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00083">outgoing::capabilities</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::cid_name</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::cid_num</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::context</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::data</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::dest</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::exten</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00079">outgoing::maxretries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00099">outgoing::options</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00096">outgoing::priority</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00078">outgoing::retries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00080">outgoing::retrytime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00067">SPOOL_FLAG_ALWAYS_DELETE</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00069">SPOOL_FLAG_ARCHIVE</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00071">SPOOL_FLAG_EARLY_MEDIA</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::tech</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00081">outgoing::waittime</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00296">apply_outgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="comment">/* Trim comments */</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   c = line;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordflow">while</span> ((c = strchr(c, <span class="charliteral">&#39;#&#39;</span>))) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> ((c == line) || (*(c-1) == <span class="charliteral">&#39; &#39;</span>) || (*(c-1) == <span class="charliteral">&#39;\t&#39;</span>)) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         *c = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      c++;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   c = line;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">while</span> ((c = strchr(c, <span class="charliteral">&#39;;&#39;</span>))) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> ((c &gt; line) &amp;&amp; (c[-1] == <span class="charliteral">&#39;\\&#39;</span>)) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         memmove(c - 1, c, strlen(c) + 1);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         *c = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="comment">/* Trim trailing white space */</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a>(line);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(line)) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   c = strchr(line, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="keywordflow">if</span> (!c) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Syntax error at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   *c = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   c = <a class="code" href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a>(c + 1);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   printf(<span class="stringliteral">&quot;&#39;%s&#39; is &#39;%s&#39; at line %d\n&quot;</span>, line, c, lineno);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;channel&quot;</span>)) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordtype">char</span> *c2;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span> ((c2 = strchr(c, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         *c2 = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         c2++;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, c);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, c2);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Channel should be in form Tech/Dest at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;callerid&quot;</span>)) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a>[80] = {0}, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>[80] = {0};</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="../../de/d47/callerid_8h.html#af33ee38631fe79ab21d91bcd0634903a">ast_callerid_split</a>(c, cid_name, <span class="keyword">sizeof</span>(cid_name), <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, cid_name, cid_name);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;application&quot;</span>)) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, c);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;data&quot;</span>)) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">data</a>, c);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;maxretries&quot;</span>)) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">if</span> (sscanf(c, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">maxretries</a>) != 1) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid max retries at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">maxretries</a> = 0;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;codecs&quot;</span>)) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a26c6676e9f2dd9535ea0d5bbd45f98b6">ast_format_cap_update_by_allow_disallow</a>(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, c, 1);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;context&quot;</span>)) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, c);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;extension&quot;</span>)) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, c);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;priority&quot;</span>)) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">if</span> ((sscanf(c, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>) != 1) || (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> &lt; 1)) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid priority at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = 1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;retrytime&quot;</span>)) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">if</span> ((sscanf(c, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a>) != 1) || (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a> &lt; 1)) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid retrytime at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a> = 300;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;waittime&quot;</span>)) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">if</span> ((sscanf(c, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a>) != 1) || (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a> &lt; 1)) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid waittime at line %d of %s\n&quot;</span>, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">waittime</a> = 45;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;retry&quot;</span>)) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>++;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;startretry&quot;</span>)) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span> (sscanf(c, <span class="stringliteral">&quot;%30ld&quot;</span>, &amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a>) != 1) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to retrieve calling PID!\n&quot;</span>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a> = 0;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;endretry&quot;</span>) || !strcasecmp(line, <span class="stringliteral">&quot;abortretry&quot;</span>)) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a> = 0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>++;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;delayedretry&quot;</span>)) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;setvar&quot;</span>) || !strcasecmp(line, <span class="stringliteral">&quot;set&quot;</span>)) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordtype">char</span> *c2 = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;c2, <span class="stringliteral">&quot;=&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span> (c2) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a02dc4c1efea1e4aca262eebf980ea6e1">append_variable</a>(o, c, c2);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Malformed \&quot;%s\&quot; argument.  Should be \&quot;%s: variable=value\&quot;\n&quot;</span>, line, line);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;account&quot;</span>)) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(o, <a class="code" href="../../de/dcd/structoutgoing.html#a626176754f57f4dc291e44916a5354f8">account</a>, c);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;alwaysdelete&quot;</span>)) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a67b6713ff86cf82aaed821e9a87d1c21">ast_set2_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(c), <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;archive&quot;</span>)) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a67b6713ff86cf82aaed821e9a87d1c21">ast_set2_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(c), <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(line, <span class="stringliteral">&quot;early_media&quot;</span>)) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a67b6713ff86cf82aaed821e9a87d1c21">ast_set2_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(c), <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown keyword &#39;%s&#39; at line %d of %s\n&quot;</span>, line, lineno, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="callerid_8h_html_af33ee38631fe79ab21d91bcd0634903a"><div class="ttname"><a href="../../de/d47/callerid_8h.html#af33ee38631fe79ab21d91bcd0634903a">ast_callerid_split</a></div><div class="ttdeci">int ast_callerid_split(const char *src, char *name, int namelen, char *num, int numlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01092">callerid.c:1092</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a5b4491fac0cfd164f1bfe2fde5b29dcd">SPOOL_FLAG_EARLY_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00071">pbx_spool.c:71</a></div></div>
<div class="ttc" id="utils_8h_html_a67b6713ff86cf82aaed821e9a87d1c21"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a67b6713ff86cf82aaed821e9a87d1c21">ast_set2_flag</a></div><div class="ttdeci">#define ast_set2_flag(p, value, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00094">utils.h:94</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structoutgoing_html_ac35730743cfe5d3cb0971c186fb1788a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">outgoing::maxretries</a></div><div class="ttdeci">int maxretries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00079">pbx_spool.c:79</a></div></div>
<div class="ttc" id="structoutgoing_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#acec9ce2df15222151ad66fcb1d74eb9f">outgoing::priority</a></div><div class="ttdeci">int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00096">pbx_spool.c:96</a></div></div>
<div class="ttc" id="structoutgoing_html_a6044abdba0f2d5658d4d8ecf083060cf"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6044abdba0f2d5658d4d8ecf083060cf">outgoing::waittime</a></div><div class="ttdeci">int waittime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00081">pbx_spool.c:81</a></div></div>
<div class="ttc" id="structoutgoing_html_a8ba735ab56b2afeb844916994c86f3f5"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">outgoing::retries</a></div><div class="ttdeci">int retries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00078">pbx_spool.c:78</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a29e973bd94bfbaf59d939bd1bc988c32"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a></div><div class="ttdeci">static char cid_num[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00164">chan_mgcp.c:164</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00067">pbx_spool.c:67</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a26c6676e9f2dd9535ea0d5bbd45f98b6"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a26c6676e9f2dd9535ea0d5bbd45f98b6">ast_format_cap_update_by_allow_disallow</a></div><div class="ttdeci">int ast_format_cap_update_by_allow_disallow(struct ast_format_cap *cap, const char *list, int allowing)</div><div class="ttdoc">Parse an &quot;allow&quot; or &quot;deny&quot; list and modify a format capabilities structure accordingly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00320">format_cap.c:320</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structoutgoing_html_a7870f447ef3c43ebf148da15363b25dd"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a7870f447ef3c43ebf148da15363b25dd">outgoing::data</a></div><div class="ttdeci">const ast_string_field data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a626176754f57f4dc291e44916a5354f8"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a626176754f57f4dc291e44916a5354f8">outgoing::account</a></div><div class="ttdeci">const ast_string_field account</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a02dc4c1efea1e4aca262eebf980ea6e1"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a02dc4c1efea1e4aca262eebf980ea6e1">append_variable</a></div><div class="ttdeci">static void append_variable(struct outgoing *o, const char *name, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00164">pbx_spool.c:164</a></div></div>
<div class="ttc" id="structoutgoing_html_a5675a902ed1cbfcd7b797f0774c17120"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">outgoing::options</a></div><div class="ttdeci">struct ast_flags options</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00099">pbx_spool.c:99</a></div></div>
<div class="ttc" id="strings_8h_html_a387a69b3871ca31061566a73f45d20f4"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a></div><div class="ttdeci">int attribute_pure ast_true(const char *val)</div><div class="ttdoc">Make sure something is true. Determine if a string containing a boolean value is &quot;true&quot;. This function checks to see whether a string passed to it is an indication of an &quot;true&quot; value. It checks to see if the string is &quot;yes&quot;, &quot;true&quot;, &quot;y&quot;, &quot;t&quot;, &quot;on&quot; or &quot;1&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01951">main/utils.c:1951</a></div></div>
<div class="ttc" id="structoutgoing_html_ad8e6afe89e3ec022b30cdda570dcb1d3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">outgoing::retrytime</a></div><div class="ttdeci">int retrytime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00080">pbx_spool.c:80</a></div></div>
<div class="ttc" id="strings_8h_html_af5693da955fa3bc73bc49c47b601fc7a"><div class="ttname"><a href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a></div><div class="ttdeci">char * ast_skip_blanks(const char *str)</div><div class="ttdoc">Gets a pointer to the first non-whitespace character in a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00157">strings.h:157</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="strings_8h_html_abe38193be148775f7559f8fff6e0c17e"><div class="ttname"><a href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a></div><div class="ttdeci">char * ast_trim_blanks(char *str)</div><div class="ttdoc">Trims trailing whitespace characters from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00182">strings.h:182</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_ade5a89f9bee15a492c760ec1765a292d"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a></div><div class="ttdeci">static char cid_name[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">chan_mgcp.c:165</a></div></div>
<div class="ttc" id="structoutgoing_html_aed48c29baf79b703d3f84d791e08ac4f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">outgoing::dest</a></div><div class="ttdeci">const ast_string_field dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">outgoing::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="structoutgoing_html_a9b1da606e4cbafee7516346240cfe6fe"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">outgoing::callingpid</a></div><div class="ttdeci">long callingpid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00082">pbx_spool.c:82</a></div></div>
<div class="ttc" id="structoutgoing_html_a0f943c30fc292bd35c9619493661920f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a0f943c30fc292bd35c9619493661920f">outgoing::capabilities</a></div><div class="ttdeci">struct ast_format_cap * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00083">pbx_spool.c:83</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="app__mysql_8c_html_a1d9b1eccfc259a14525ce817482a3f88"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a></div><div class="ttdeci">static const char app[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00062">app_mysql.c:62</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00069">pbx_spool.c:69</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af31d65747257ce6b8ce63d28cc66a9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31d65747257ce6b8ce63d28cc66a9ca">&#9670;&nbsp;</a></span>queue_created_files()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_created_files </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00657">657</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00105">direntry::mtime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">queue_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d8/d4c/structcreatelist.html">createlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">mtime</a> &gt; now) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, 0);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cur);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;}</div><div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="structdirentry_html_a2b474ce747b7fff9dd1e97ef662cd72a"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a></div><div class="ttdeci">struct direntry::@445 list</div></div>
<div class="ttc" id="structcreatelist_html"><div class="ttname"><a href="../../d8/d4c/structcreatelist.html">createlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00554">pbx_spool.c:554</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9ac9b4f318b47270021bafdfe747bc8e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a></div><div class="ttdeci">static void queue_file(const char *filename, time_t when)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00560">pbx_spool.c:560</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structdirentry_html_a4a2d3a53446ef3217564ced73636f9bf"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">direntry::mtime</a></div><div class="ttdeci">time_t mtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00105">pbx_spool.c:105</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ac9b4f318b47270021bafdfe747bc8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac9b4f318b47270021bafdfe747bc8e">&#9670;&nbsp;</a></span>queue_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>when</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">560</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00598">AST_LIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00710">AST_LIST_INSERT_HEAD</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00105">direntry::mtime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">attempt_thread()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00657">queue_created_files()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00674">queue_file_write()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur, *<span class="keyword">new</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="keywordflow">if</span> (!strchr(filename, <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordtype">char</span> *fn = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(strlen(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>) + strlen(filename) + 2);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      sprintf(fn, <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, filename); <span class="comment">/* SAFE */</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      filename = fn;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keywordflow">if</span> (when == 0) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (stat(filename, &amp;st)) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to stat %s: %s\n&quot;</span>, filename, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">if</span> (!S_ISREG(st.st_mode)) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      when = st.st_mtime;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="comment">/* Need to check the existing list in order to avoid duplicates. */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">mtime</a> == when &amp;&amp; !strcmp(filename, cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>)) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">if</span> ((res = when) &gt; now || (res = <a class="code" href="../../d9/dd4/pbx__spool_8c.html#ad5d52c7908eed4b3c37b09bd759e8b61">scan_service</a>(filename, now)) &gt; 0) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">if</span> (!(<span class="keyword">new</span> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*<span class="keyword">new</span>) + strlen(filename) + 1))) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keyword">new</span>-&gt;mtime = res;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      strcpy(new-&gt;name, filename);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">/* List is ordered by mtime */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>)) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, <span class="keyword">new</span>, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">mtime</a> &gt; new-&gt;mtime) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#a83227c4f8c836f0452b607507c55752f">AST_LIST_INSERT_BEFORE_CURRENT</a>(<span class="keyword">new</span>, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;               found = 1;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;         <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, <span class="keyword">new</span>, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;         }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div><div class="ttc" id="pbx__spool_8c_html_ad5d52c7908eed4b3c37b09bd759e8b61"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#ad5d52c7908eed4b3c37b09bd759e8b61">scan_service</a></div><div class="ttdeci">static int scan_service(const char *fn, time_t now)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00482">pbx_spool.c:482</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a9140a4e4d781264fa9469c52b1adae40"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a></div><div class="ttdeci">#define AST_LIST_LOCK(head)</div><div class="ttdoc">Locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00039">linkedlists.h:39</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a03acec5c3fd04176854f6c7104e60398"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a></div><div class="ttdeci">static char qdir[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00074">pbx_spool.c:74</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ab48cb9e1e612dd486b747ba1c5d68d01"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a></div><div class="ttdeci">#define AST_LIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00139">linkedlists.h:139</a></div></div>
<div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="structdirentry_html_a2b474ce747b7fff9dd1e97ef662cd72a"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a></div><div class="ttdeci">struct direntry::@445 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa2ded2af046bb513f77056c27c083307"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_LIST_INSERT_HEAD(head, elm, field)</div><div class="ttdoc">Inserts a list entry at the head of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00710">linkedlists.h:710</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structdirentry_html_a4a2d3a53446ef3217564ced73636f9bf"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">direntry::mtime</a></div><div class="ttdeci">time_t mtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00105">pbx_spool.c:105</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a83227c4f8c836f0452b607507c55752f"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a83227c4f8c836f0452b607507c55752f">AST_LIST_INSERT_BEFORE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_INSERT_BEFORE_CURRENT(elm, field)</div><div class="ttdoc">Inserts a list entry before the current entry during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00598">linkedlists.h:598</a></div></div>
<div class="ttc" id="structdirlist_html"><div class="ttname"><a href="../../df/d8d/structdirlist.html">dirlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00109">pbx_spool.c:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b8d593448c66c670dda2fc5949ddc26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b8d593448c66c670dda2fc5949ddc26">&#9670;&nbsp;</a></span>queue_file_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_file_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00624">624</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00105">direntry::mtime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;{</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../d8/d4c/structcreatelist.html">createlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span> (!strcmp(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, filename)) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <span class="keywordflow">if</span> (!(cur = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*cur) + strlen(filename) + 1))) {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   strcpy(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, filename);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="comment">/* We&#39;ll handle this file unless an IN_OPEN event occurs within 2 seconds */</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">mtime</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) + 2;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d8/d4c/structcreatelist.html">createlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div><div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="structdirentry_html_a2b474ce747b7fff9dd1e97ef662cd72a"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a></div><div class="ttdeci">struct direntry::@445 list</div></div>
<div class="ttc" id="structcreatelist_html"><div class="ttname"><a href="../../d8/d4c/structcreatelist.html">createlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00554">pbx_spool.c:554</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structdirentry_html_a4a2d3a53446ef3217564ced73636f9bf"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">direntry::mtime</a></div><div class="ttdeci">time_t mtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00105">pbx_spool.c:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbbebfe4330dea5fd5f86c8b335c6c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbbebfe4330dea5fd5f86c8b335c6c06">&#9670;&nbsp;</a></span>queue_file_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_file_open </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00643">643</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;{</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d8/d4c/structcreatelist.html">createlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">if</span> (!strcmp(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, filename)) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d4/de9/structopenlist.html">openlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div><div class="ttc" id="structopenlist_html"><div class="ttname"><a href="../../d4/de9/structopenlist.html">openlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00555">pbx_spool.c:555</a></div></div>
<div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="structdirentry_html_a2b474ce747b7fff9dd1e97ef662cd72a"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a></div><div class="ttdeci">struct direntry::@445 list</div></div>
<div class="ttc" id="structcreatelist_html"><div class="ttname"><a href="../../d8/d4c/structcreatelist.html">createlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00554">pbx_spool.c:554</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e06c8822d41475d2fc1a30b30a5cdd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e06c8822d41475d2fc1a30b30a5cdd8">&#9670;&nbsp;</a></span>queue_file_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_file_write </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00674">674</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">queue_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;{</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="comment">/* Only queue entries where an IN_CREATE preceded the IN_CLOSE_WRITE */</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d4/de9/structopenlist.html">openlist</a>, cur, <a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">if</span> (!strcmp(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, filename)) {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">list</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cur);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(filename, 0);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div><div class="ttc" id="structopenlist_html"><div class="ttname"><a href="../../d4/de9/structopenlist.html">openlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00555">pbx_spool.c:555</a></div></div>
<div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="structdirentry_html_a2b474ce747b7fff9dd1e97ef662cd72a"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a2b474ce747b7fff9dd1e97ef662cd72a">direntry::list</a></div><div class="ttdeci">struct direntry::@445 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9ac9b4f318b47270021bafdfe747bc8e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a></div><div class="ttdeci">static void queue_file(const char *filename, time_t when)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00560">pbx_spool.c:560</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af79325470445e6e4d889a461ea654873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af79325470445e6e4d889a461ea654873">&#9670;&nbsp;</a></span>remove_from_queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int remove_from_queue </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove a call file from the outgoing queue optionally moving it in the archive dir. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>the pointer to outgoing struct </td></tr>
    <tr><td class="paramname">status</td><td>the exit status of the call. Can be "Completed", "Failed" or "Expired" </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00363">363</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02231">ast_mkdir()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00099">outgoing::options</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00067">SPOOL_FLAG_ALWAYS_DELETE</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00069">SPOOL_FLAG_ARCHIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">attempt_thread()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   FILE *f;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordtype">char</span> newfn[256];</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *bname;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#if defined(HAVE_INOTIFY) || defined(HAVE_KQUEUE)</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a>)) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keyword">struct </span>stat current_file_status;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">if</span> (!stat(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, &amp;current_file_status)) {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         <span class="keywordflow">if</span> (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; current_file_status.st_mtime) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#if defined(HAVE_INOTIFY) || defined(HAVE_KQUEUE)</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, cur, list) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (!strcmp(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>)) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cur);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">options</a>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a>)) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      unlink(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a>(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a>, 0777)) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create queue directory %s -- outgoing spool archiving disabled\n&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      unlink(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keywordflow">if</span> (!(bname = strrchr(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      bname = o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      bname++;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   snprintf(newfn, <span class="keyword">sizeof</span>(newfn), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a>, bname);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="comment">/* If there is already a call file with the name in the archive dir, it will be overwritten. */</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   unlink(newfn);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordflow">if</span> (rename(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, newfn) != 0) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      unlink(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="comment">/* Only append to the file AFTER we move it out of the watched directory,</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">    * otherwise the fclose() causes another event for inotify(7) */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">if</span> ((f = fopen(newfn, <span class="stringliteral">&quot;a&quot;</span>))) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      fprintf(f, <span class="stringliteral">&quot;Status: %s\n&quot;</span>, <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      fclose(f);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a9140a4e4d781264fa9469c52b1adae40"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a></div><div class="ttdeci">#define AST_LIST_LOCK(head)</div><div class="ttdoc">Locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00039">linkedlists.h:39</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9fba478e22f3c9ba363a2ab697c72c74"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9fba478e22f3c9ba363a2ab697c72c74">qdonedir</a></div><div class="ttdeci">static char qdonedir[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00075">pbx_spool.c:75</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ab48cb9e1e612dd486b747ba1c5d68d01"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a></div><div class="ttdeci">#define AST_LIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00139">linkedlists.h:139</a></div></div>
<div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a14e84f6cdcd0ed15b748cc08a65b1734">SPOOL_FLAG_ALWAYS_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00067">pbx_spool.c:67</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="structoutgoing_html_a5675a902ed1cbfcd7b797f0774c17120"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a5675a902ed1cbfcd7b797f0774c17120">outgoing::options</a></div><div class="ttdeci">struct ast_flags options</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00099">pbx_spool.c:99</a></div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="structdirlist_html"><div class="ttname"><a href="../../df/d8d/structdirlist.html">dirlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00109">pbx_spool.c:109</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a92a045b44579eea64c064cfe975a2253a97b25e061a292ff951dcff7a39959304">SPOOL_FLAG_ARCHIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00069">pbx_spool.c:69</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="utils_8h_html_a7c38859ed90e96df2b0a0fdf843769d0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a></div><div class="ttdeci">int ast_mkdir(const char *path, int mode)</div><div class="ttdoc">Recursively create directory path. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02231">main/utils.c:2231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42a40f55167da57243f6865030c9a83e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42a40f55167da57243f6865030c9a83e">&#9670;&nbsp;</a></span>safe_append()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void safe_append </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dcd/structoutgoing.html">outgoing</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00339">339</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l00315">ast_mainpid</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::dest</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00078">outgoing::retries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00080">outgoing::retrytime</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::tech</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00431">attempt_thread()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   FILE *f;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keyword">struct </span>utimbuf tbuf = { .actime = now, .modtime = now + o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a> };</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Outgoing %s/%s: %s\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, s);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">if</span> ((f = fopen(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, <span class="stringliteral">&quot;a&quot;</span>))) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      fprintf(f, <span class="stringliteral">&quot;\n%s: %ld %d (%ld)\n&quot;</span>, s, (<span class="keywordtype">long</span>)<a class="code" href="../../d7/d5b/options_8h.html#ae1517891417ae2f6e398e95ae79dadf1">ast_mainpid</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>, (<span class="keywordtype">long</span>) now);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      fclose(f);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="comment">/* Update the file time */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">if</span> (utime(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, &amp;tbuf)) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to set utime on %s: %s\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structoutgoing_html_a8ba735ab56b2afeb844916994c86f3f5"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">outgoing::retries</a></div><div class="ttdeci">int retries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00078">pbx_spool.c:78</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structoutgoing_html_ad8e6afe89e3ec022b30cdda570dcb1d3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">outgoing::retrytime</a></div><div class="ttdeci">int retrytime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00080">pbx_spool.c:80</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_aed48c29baf79b703d3f84d791e08ac4f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">outgoing::dest</a></div><div class="ttdeci">const ast_string_field dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">outgoing::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="options_8h_html_ae1517891417ae2f6e398e95ae79dadf1"><div class="ttname"><a href="../../d7/d5b/options_8h.html#ae1517891417ae2f6e398e95ae79dadf1">ast_mainpid</a></div><div class="ttdeci">pid_t ast_mainpid</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00315">asterisk.c:315</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5d52c7908eed4b3c37b09bd759e8b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d52c7908eed4b3c37b09bd759e8b61">&#9670;&nbsp;</a></span>scan_service()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int scan_service </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000081">Todo:</a></b></dt><dd>XXX There is some odd delayed duplicate servicing of call files going on. We need to suppress the error message if the file does not exist as a result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">482</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00296">apply_outgoing()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l00315">ast_mainpid</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00082">outgoing::callingpid</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::dest</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00114">free_outgoing()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00470">launch_service()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00079">outgoing::maxretries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00124">new_outgoing()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00363">remove_from_queue()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00078">outgoing::retries</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00080">outgoing::retrytime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00339">safe_append()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::tech</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">queue_file()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">scan_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a> *o;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   FILE *f;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   o = <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a09be07be92b99d80ff05cdbeb20dd321">new_outgoing</a>(<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">if</span> (!o) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="comment">/* Attempt to open the file */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   f = fopen(o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#if defined(HAVE_INOTIFY) || defined(HAVE_KQUEUE)</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">      /*!</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">       * \todo XXX There is some odd delayed duplicate servicing of</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">       * call files going on.  We need to suppress the error message</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">       * if the file does not exist as a result.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != ENOENT)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open %s: &#39;%s&#39;(%d), deleting\n&quot;</span>,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>), (<span class="keywordtype">int</span>) <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a>(o, <span class="stringliteral">&quot;Failed&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">/* Read in and verify the contents */</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   res = <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af4bebde68928965e1fc6a7189991d238">apply_outgoing</a>(o, f);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   fclose(f);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid file contents in %s, deleting\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a>(o, <span class="stringliteral">&quot;Failed&quot;</span>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Filename: %s, Retries: %d, max: %d\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">maxretries</a>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> &lt;= o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">maxretries</a>) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      now += o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">retrytime</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a> &amp;&amp; (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a> == <a class="code" href="../../d7/d5b/options_8h.html#ae1517891417ae2f6e398e95ae79dadf1">ast_mainpid</a>)) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a>(o, time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <span class="stringliteral">&quot;DelayedRetry&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Delaying retry since we&#39;re currently running &#39;%s&#39;\n&quot;</span>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">fn</a>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         <span class="comment">/* Increment retries */</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>++;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         <span class="comment">/* If someone else was calling, they&#39;re presumably gone now</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">            so abort their retry and continue as we were... */</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">callingpid</a>)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a>(o, time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <span class="stringliteral">&quot;AbortRetry&quot;</span>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a>(o, now, <span class="stringliteral">&quot;StartRetry&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a56de20a1d449ec5c3f5bcdebd41656f7">launch_service</a>(o);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">return</span> now;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Queued call to %s/%s expired without completion after %d attempt%s\n&quot;</span>,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">dest</a>, o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> - 1, ((o-&gt;<a class="code" href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a> - 1) != 1) ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a>(o, <span class="stringliteral">&quot;Expired&quot;</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a>(o);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="ttc" id="pbx__spool_8c_html_a09be07be92b99d80ff05cdbeb20dd321"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a09be07be92b99d80ff05cdbeb20dd321">new_outgoing</a></div><div class="ttdeci">static struct outgoing * new_outgoing(const char *fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00124">pbx_spool.c:124</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_af4bebde68928965e1fc6a7189991d238"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#af4bebde68928965e1fc6a7189991d238">apply_outgoing</a></div><div class="ttdeci">static int apply_outgoing(struct outgoing *o, FILE *f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00296">pbx_spool.c:296</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structoutgoing_html_ac35730743cfe5d3cb0971c186fb1788a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ac35730743cfe5d3cb0971c186fb1788a">outgoing::maxretries</a></div><div class="ttdeci">int maxretries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00079">pbx_spool.c:79</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_af79325470445e6e4d889a461ea654873"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#af79325470445e6e4d889a461ea654873">remove_from_queue</a></div><div class="ttdeci">static int remove_from_queue(struct outgoing *o, const char *status)</div><div class="ttdoc">Remove a call file from the outgoing queue optionally moving it in the archive dir. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00363">pbx_spool.c:363</a></div></div>
<div class="ttc" id="structoutgoing_html_a8ba735ab56b2afeb844916994c86f3f5"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a8ba735ab56b2afeb844916994c86f3f5">outgoing::retries</a></div><div class="ttdeci">int retries</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00078">pbx_spool.c:78</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a25da8535544761b80644470bb43e2798"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a25da8535544761b80644470bb43e2798">free_outgoing</a></div><div class="ttdeci">static void free_outgoing(struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00114">pbx_spool.c:114</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a56de20a1d449ec5c3f5bcdebd41656f7"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a56de20a1d449ec5c3f5bcdebd41656f7">launch_service</a></div><div class="ttdeci">static void launch_service(struct outgoing *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00470">pbx_spool.c:470</a></div></div>
<div class="ttc" id="structoutgoing_html"><div class="ttname"><a href="../../de/dcd/structoutgoing.html">outgoing</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00077">pbx_spool.c:77</a></div></div>
<div class="ttc" id="structoutgoing_html_ad8e6afe89e3ec022b30cdda570dcb1d3"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#ad8e6afe89e3ec022b30cdda570dcb1d3">outgoing::retrytime</a></div><div class="ttdeci">int retrytime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00080">pbx_spool.c:80</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="structoutgoing_html_a395945c81e0dba8b61668da661d5b01a"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a395945c81e0dba8b61668da661d5b01a">outgoing::fn</a></div><div class="ttdeci">const ast_string_field fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_aed48c29baf79b703d3f84d791e08ac4f"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#aed48c29baf79b703d3f84d791e08ac4f">outgoing::dest</a></div><div class="ttdeci">const ast_string_field dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a6379def8cefd9afdea29d5ed673cf8a0">outgoing::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00095">pbx_spool.c:95</a></div></div>
<div class="ttc" id="structoutgoing_html_a9b1da606e4cbafee7516346240cfe6fe"><div class="ttname"><a href="../../de/dcd/structoutgoing.html#a9b1da606e4cbafee7516346240cfe6fe">outgoing::callingpid</a></div><div class="ttdeci">long callingpid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00082">pbx_spool.c:82</a></div></div>
<div class="ttc" id="options_8h_html_ae1517891417ae2f6e398e95ae79dadf1"><div class="ttname"><a href="../../d7/d5b/options_8h.html#ae1517891417ae2f6e398e95ae79dadf1">ast_mainpid</a></div><div class="ttdeci">pid_t ast_mainpid</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00315">asterisk.c:315</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a42a40f55167da57243f6865030c9a83e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a42a40f55167da57243f6865030c9a83e">safe_append</a></div><div class="ttdeci">static void safe_append(struct outgoing *o, time_t now, char *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00339">pbx_spool.c:339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55635376623ac9afd203650fb458907a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55635376623ac9afd203650fb458907a">&#9670;&nbsp;</a></span>scan_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* scan_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>unused</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00690">690</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d7/d5b/options_8h_source.html#l00115">ast_fully_booted</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00420">AST_LIST_FIRST</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00095">outgoing::fn</a>, <a class="el" href="../../d8/d20/autoconfig_8h_source.html#l00391">HAVE_INOTIFY</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l00351">inotify_fd</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01092">last</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00105">direntry::mtime</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00106">direntry::name</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00104">direntry::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00657">queue_created_files()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00560">queue_file()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00624">queue_file_create()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00643">queue_file_open()</a>, <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00674">queue_file_write()</a>, and <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00482">scan_service()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00946">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   DIR *dir;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <span class="keyword">struct </span>dirent *de;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   time_t now;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="keyword">struct </span>timespec ts = { .tv_sec = 1 };</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor">#ifdef HAVE_INOTIFY</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   ssize_t res;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/df8/localtime_8c.html#ae599f7dc7f8671cdf24ac722c6f4c26a">inotify_fd</a> = inotify_init();</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keyword">struct </span>inotify_event *iev;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[8192] __attribute__((aligned (<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))));</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keyword">struct </span>pollfd pfd = { .fd = <a class="code" href="../../d9/df8/localtime_8c.html#ae599f7dc7f8671cdf24ac722c6f4c26a">inotify_fd</a>, .events = POLLIN };</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keyword">struct </span>timespec nowait = { .tv_sec = 0, .tv_nsec = 1 };</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keywordtype">int</span> inotify_fd = kqueue();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keyword">struct </span>kevent kev;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <span class="keyword">struct </span>kevent <a class="code" href="../../df/d7d/structevent.html">event</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d22/structdirentry.html">direntry</a> *cur;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="keywordflow">while</span> (!<a class="code" href="../../d7/d5b/options_8h.html#a6da2c0ee84c135b777b761b443861f19">ast_fully_booted</a>) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      nanosleep(&amp;ts, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordflow">if</span> (inotify_fd &lt; 0) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to initialize &quot;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;#ifdef <a class="code" href="../../d8/d20/autoconfig_8h.html#af07aa056746f0fed2487a4e4b56e683f">HAVE_INOTIFY</a></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         <span class="stringliteral">&quot;inotify(7)&quot;</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;#<span class="keywordflow">else</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;         <span class="stringliteral">&quot;kqueue(2)&quot;</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;#endif</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="preprocessor">#ifdef HAVE_INOTIFY</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   inotify_add_watch(inotify_fd, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, IN_CREATE | IN_OPEN | IN_CLOSE_WRITE | IN_MOVED_TO);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="comment">/* First, run through the directory and clear existing entries */</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">if</span> (!(dir = opendir(<a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>))) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to open directory %s: %s\n&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">#ifndef HAVE_INOTIFY</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   EV_SET(&amp;kev, dirfd(dir), EVFILT_VNODE, EV_ADD | EV_ENABLE | EV_CLEAR, NOTE_WRITE, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">if</span> (kevent(inotify_fd, &amp;kev, 1, &amp;<a class="code" href="../../df/d7d/structevent.html">event</a>, 1, &amp;nowait) &lt; 0 &amp;&amp; <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != 0) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to watch directory %s: %s\n&quot;</span>, <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">while</span> ((de = readdir(dir))) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(de-&gt;d_name, 0);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor">#ifdef HAVE_INOTIFY</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="comment">/* Directory needs to remain open for kqueue(2) */</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   closedir(dir);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="comment">/* Wait for either a) next timestamp to occur, or b) a change to happen */</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keywordflow">for</span> (;<span class="comment">/* ever */</span>;) {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      time_t <a class="code" href="../../dc/d22/structdirentry.html#a0cda3f60fa2bf051c2a3bf47f3ae9ab6">next</a> = <a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>) ? INT_MAX : <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>)-&gt;mtime;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      time(&amp;now);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (next &gt; now) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#ifdef HAVE_INOTIFY</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         <span class="keywordtype">int</span> stage = 0;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;         <span class="comment">/* Convert from seconds to milliseconds, unless there&#39;s nothing</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">          * in the queue already, in which case, we wait forever. */</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;         <span class="keywordtype">int</span> waittime = next == INT_MAX ? -1 : (next - now) * 1000;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;<a class="code" href="../../d8/d4c/structcreatelist.html">createlist</a>)) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            waittime = 1000;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;         }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         <span class="comment">/* When a file arrives, add it to the queue, in mtime order. */</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;         <span class="keywordflow">if</span> ((res = poll(&amp;pfd, 1, waittime)) &gt; 0 &amp;&amp; (stage = 1) &amp;&amp;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            (res = read(inotify_fd, &amp;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>))) &gt;= <span class="keyword">sizeof</span>(*iev)) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            ssize_t <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = 0;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="comment">/* File(s) added to directory, add them to my list */</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">for</span> (iev = (<span class="keywordtype">void</span> *) <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>; res &gt;= <span class="keyword">sizeof</span>(*iev); iev = (<span class="keyword">struct </span>inotify_event *) (((<span class="keywordtype">char</span> *) iev) + len)) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;               <span class="comment">/* For an IN_MOVED_TO event, simply process the file. However, if</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">                * we get an IN_CREATE event it *might* be an open(O_CREAT) or it</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">                * might be a hardlink (like smsq does, since rename() might</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">                * overwrite an existing file). So we have to see if we get a</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">                * subsequent IN_OPEN event on the same file. If we do, keep it</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">                * on the openlist and wait for the corresponding IN_CLOSE_WRITE.</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">                * If we *don&#39;t* see an IN_OPEN event, then it was a hard link so</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">                * it can be processed immediately.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">                *</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">                * Unfortunately, although open(O_CREAT) is an atomic file system</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">                * operation, the inotify subsystem doesn&#39;t give it to us in a</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">                * single event with both IN_CREATE|IN_OPEN set. It&#39;s two separate</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">                * events, and the kernel doesn&#39;t even give them to us at the same</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">                * time. We can read() from inotify_fd after the IN_CREATE event,</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">                * and get *nothing* from it. The IN_OPEN arrives only later! So</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">                * we have a very short timeout of 2 seconds. */</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;               <span class="keywordflow">if</span> (iev-&gt;mask &amp; IN_CREATE) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a4b8d593448c66c670dda2fc5949ddc26">queue_file_create</a>(iev-&gt;name);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iev-&gt;mask &amp; IN_OPEN) {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  <a class="code" href="../../d9/dd4/pbx__spool_8c.html#acbbebfe4330dea5fd5f86c8b335c6c06">queue_file_open</a>(iev-&gt;name);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iev-&gt;mask &amp; IN_CLOSE_WRITE) {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                  <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a1e06c8822d41475d2fc1a30b30a5cdd8">queue_file_write</a>(iev-&gt;name);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iev-&gt;mask &amp; IN_MOVED_TO) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                  <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(iev-&gt;name, 0);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unexpected event %d for file &#39;%s&#39;\n&quot;</span>, (<span class="keywordtype">int</span>) iev-&gt;mask, iev-&gt;name);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;               }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;               len = <span class="keyword">sizeof</span>(*iev) + iev-&gt;len;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;               res -= <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res &lt; 0 &amp;&amp; <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != EINTR &amp;&amp; <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != EAGAIN) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Got an error back from %s(2): %s\n&quot;</span>, stage ? <span class="stringliteral">&quot;read&quot;</span> : <span class="stringliteral">&quot;poll&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         time(&amp;now);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="../../d9/dd4/pbx__spool_8c.html#af31d65747257ce6b8ce63d28cc66a9ca">queue_created_files</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         <span class="keywordtype">int</span> num_events;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;         <span class="comment">/* If queue empty then wait forever */</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         <span class="keywordflow">if</span> (next == INT_MAX) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            num_events = kevent(inotify_fd, &amp;kev, 1, &amp;<a class="code" href="../../df/d7d/structevent.html">event</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keyword">struct </span>timespec ts2 = { .tv_sec = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int)(next - now), .tv_nsec = 0 };</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            num_events = kevent(inotify_fd, &amp;kev, 1, &amp;<a class="code" href="../../df/d7d/structevent.html">event</a>, 1, &amp;ts2);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;         <span class="keywordflow">if</span> ((num_events &lt; 0) || (<a class="code" href="../../df/d7d/structevent.html">event</a>.flags == EV_ERROR)) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(10, <span class="stringliteral">&quot;KEvent error %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_events == 0) {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="comment">/* Interrupt or timeout, restart calculations */</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">/* Directory changed, rescan */</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            rewinddir(dir);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">while</span> ((de = readdir(dir))) {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;               <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(de-&gt;d_name, 0);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         time(&amp;now);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="comment">/* Empty the list of all entries ready to be processed */</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>) &amp;&amp; <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>)-&gt;mtime &lt;= now) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         cur = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>, list);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;         <a class="code" href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a>(cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, cur-&gt;<a class="code" href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">mtime</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cur);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structdirlist.html">dirlist</a>);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a9140a4e4d781264fa9469c52b1adae40"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a></div><div class="ttdeci">#define AST_LIST_LOCK(head)</div><div class="ttdoc">Locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00039">linkedlists.h:39</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_af31d65747257ce6b8ce63d28cc66a9ca"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#af31d65747257ce6b8ce63d28cc66a9ca">queue_created_files</a></div><div class="ttdeci">static void queue_created_files(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00657">pbx_spool.c:657</a></div></div>
<div class="ttc" id="linkedlists_8h_html_adf1959c5c03a3a706da97ad2f49617e5"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a></div><div class="ttdeci">#define AST_LIST_FIRST(head)</div><div class="ttdoc">Returns the first entry contained in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00420">linkedlists.h:420</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a03acec5c3fd04176854f6c7104e60398"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a03acec5c3fd04176854f6c7104e60398">qdir</a></div><div class="ttdeci">static char qdir[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00074">pbx_spool.c:74</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ab48cb9e1e612dd486b747ba1c5d68d01"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a></div><div class="ttdeci">#define AST_LIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00139">linkedlists.h:139</a></div></div>
<div class="ttc" id="structdirentry_html"><div class="ttname"><a href="../../dc/d22/structdirentry.html">direntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00103">pbx_spool.c:103</a></div></div>
<div class="ttc" id="autoconfig_8h_html_af07aa056746f0fed2487a4e4b56e683f"><div class="ttname"><a href="../../d8/d20/autoconfig_8h.html#af07aa056746f0fed2487a4e4b56e683f">HAVE_INOTIFY</a></div><div class="ttdeci">#define HAVE_INOTIFY</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d20/autoconfig_8h_source.html#l00391">autoconfig.h:391</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="structcreatelist_html"><div class="ttname"><a href="../../d8/d4c/structcreatelist.html">createlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00554">pbx_spool.c:554</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a1e06c8822d41475d2fc1a30b30a5cdd8"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a1e06c8822d41475d2fc1a30b30a5cdd8">queue_file_write</a></div><div class="ttdeci">static void queue_file_write(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00674">pbx_spool.c:674</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a9ac9b4f318b47270021bafdfe747bc8e"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a9ac9b4f318b47270021bafdfe747bc8e">queue_file</a></div><div class="ttdeci">static void queue_file(const char *filename, time_t when)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00560">pbx_spool.c:560</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="localtime_8c_html_ae599f7dc7f8671cdf24ac722c6f4c26a"><div class="ttname"><a href="../../d9/df8/localtime_8c.html#ae599f7dc7f8671cdf24ac722c6f4c26a">inotify_fd</a></div><div class="ttdeci">static int inotify_fd</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00351">localtime.c:351</a></div></div>
<div class="ttc" id="options_8h_html_a6da2c0ee84c135b777b761b443861f19"><div class="ttname"><a href="../../d7/d5b/options_8h.html#a6da2c0ee84c135b777b761b443861f19">ast_fully_booted</a></div><div class="ttdeci">#define ast_fully_booted</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5b/options_8h_source.html#l00115">options.h:115</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structdirentry_html_a0cda3f60fa2bf051c2a3bf47f3ae9ab6"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a0cda3f60fa2bf051c2a3bf47f3ae9ab6">direntry::next</a></div><div class="ttdeci">struct direntry * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00104">pbx_spool.c:104</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structdirentry_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../dc/d22/structdirentry.html#afd3f693e384b1ee0a0c44d58351eb87d">direntry::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00106">pbx_spool.c:106</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structdirentry_html_a4a2d3a53446ef3217564ced73636f9bf"><div class="ttname"><a href="../../dc/d22/structdirentry.html#a4a2d3a53446ef3217564ced73636f9bf">direntry::mtime</a></div><div class="ttdeci">time_t mtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00105">pbx_spool.c:105</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_a4b8d593448c66c670dda2fc5949ddc26"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#a4b8d593448c66c670dda2fc5949ddc26">queue_file_create</a></div><div class="ttdeci">static void queue_file_create(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00624">pbx_spool.c:624</a></div></div>
<div class="ttc" id="pbx__spool_8c_html_acbbebfe4330dea5fd5f86c8b335c6c06"><div class="ttname"><a href="../../d9/dd4/pbx__spool_8c.html#acbbebfe4330dea5fd5f86c8b335c6c06">queue_file_open</a></div><div class="ttdeci">static void queue_file_open(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00643">pbx_spool.c:643</a></div></div>
<div class="ttc" id="structdirlist_html"><div class="ttname"><a href="../../df/d8d/structdirlist.html">dirlist</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00109">pbx_spool.c:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00941">941</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;{</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;Outgoing Spool Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_DEFAULT, .support_level = AST_MODULE_SUPPORT_CORE, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00965">965</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00965">965</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="a9ffbecd9160d386e6c1414eae04f087d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ffbecd9160d386e6c1414eae04f087d">&#9670;&nbsp;</a></span>createlist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d4c/structcreatelist.html">createlist</a>   <a class="el" href="../../d8/d4c/structcreatelist.html">createlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a788ba1da14f1bbe39329cb80fcd8b891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788ba1da14f1bbe39329cb80fcd8b891">&#9670;&nbsp;</a></span>dirlist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/d8d/structdirlist.html">dirlist</a>   <a class="el" href="../../df/d8d/structdirlist.html">dirlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa42ec25c70b7377d1af44bdf8172740e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa42ec25c70b7377d1af44bdf8172740e">&#9670;&nbsp;</a></span>openlist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/de9/structopenlist.html">openlist</a>   <a class="el" href="../../d4/de9/structopenlist.html">openlist</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a03acec5c3fd04176854f6c7104e60398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03acec5c3fd04176854f6c7104e60398">&#9670;&nbsp;</a></span>qdir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char qdir[255]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00074">74</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
<a id="a9fba478e22f3c9ba363a2ab697c72c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fba478e22f3c9ba363a2ab697c72c74">&#9670;&nbsp;</a></span>qdonedir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char qdonedir[255]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html#l00075">75</a> of file <a class="el" href="../../d9/dd4/pbx__spool_8c_source.html">pbx_spool.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:14 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
