<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_prometheus.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_prometheus.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Core Prometheus metrics API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d68/vector_8h_source.html">asterisk/vector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d56/http_8h_source.html">asterisk/http.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/dfe/config__options_8h_source.html">asterisk/config_options.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/db9/ast__version_8h_source.html">asterisk/ast_version.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d35/buildinfo_8h_source.html">asterisk/buildinfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/db1/res__prometheus_8h_source.html">asterisk/res_prometheus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d89/prometheus__internal_8h_source.html">prometheus/prometheus_internal.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_prometheus.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/dc8/res__prometheus_8c__incl.png" border="0" usemap="#res__prometheus_8c" alt=""/></div>
<map name="res__prometheus_8c" id="res__prometheus_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="929,319,1013,345"/>
<area shape="rect" id="node22" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1704,169,1840,196"/>
<area shape="rect" id="node33" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="2035,468,2162,495"/>
<area shape="rect" id="node37" href="../../dd/d56/http_8h.html" title="Support for Private Asterisk HTTP Servers. " alt="" coords="2240,87,2355,114"/>
<area shape="rect" id="node42" href="../../db/dfe/config__options_8h.html" title="Configuration option&#45;handling. " alt="" coords="1582,87,1762,114"/>
<area shape="rect" id="node44" href="../../d5/db9/ast__version_8h.html" title="Asterisk version information. " alt="" coords="1889,87,2050,114"/>
<area shape="rect" id="node45" href="../../de/d35/buildinfo_8h.html" title="asterisk/buildinfo.h" alt="" coords="2075,87,2216,114"/>
<area shape="rect" id="node46" href="../../d0/db1/res__prometheus_8h.html" title="asterisk/res_prometheus.h" alt="" coords="1447,319,1641,345"/>
<area shape="rect" id="node47" href="../../d0/d89/prometheus__internal_8h.html" title="prometheus/prometheus\l_internal.h" alt="" coords="2379,80,2562,121"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="519,692,673,719"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="715,468,853,495"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="903,393,1038,420"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="523,767,669,793"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1363,617,1506,644"/>
<area shape="rect" id="node23" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1887,244,2001,271"/>
<area shape="rect" id="node24" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="1716,319,1855,345"/>
<area shape="rect" id="node25" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1530,617,1593,644"/>
<area shape="rect" id="node27" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1677,543,1790,569"/>
<area shape="rect" id="node30" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1919,617,2046,644"/>
<area shape="rect" id="node31" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1879,319,2025,345"/>
<area shape="rect" id="node32" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2020,393,2177,420"/>
<area shape="rect" id="node34" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1241,319,1372,345"/>
<area shape="rect" id="node26" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1660,692,1807,719"/>
<area shape="rect" id="node35" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1447,393,1582,420"/>
<area shape="rect" id="node36" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1658,468,1809,495"/>
<area shape="rect" id="node38" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="2239,169,2366,196"/>
<area shape="rect" id="node39" href="../../d4/ddf/tcptls_8h.html" title="Generic support for tcp/tls servers in Asterisk. " alt="" coords="2092,169,2215,196"/>
<area shape="rect" id="node40" href="../../dd/d27/iostream_8h.html" title="Generic abstraction for input/output streams. " alt="" coords="1717,244,1862,271"/>
<area shape="rect" id="node41" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2121,244,2268,271"/>
</map>
</div>
</div>
<p><a href="../../d7/d1b/res__prometheus_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afc7978ad9b344a3a8d32f335a1cc7bcc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#afc7978ad9b344a3a8d32f335a1cc7bcc">AST_MODULE_SELF_SYM</a>&#160;&#160;&#160;<a class="el" href="../../d7/d1b/res__prometheus_8c.html#a4d009c0eca8914334ce0ac3cb94fdc14">__internal_res_prometheus_self</a></td></tr>
<tr class="separator:afc7978ad9b344a3a8d32f335a1cc7bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01817d0c87120fdc8d23caf10abac14e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a01817d0c87120fdc8d23caf10abac14e">CORE_LAST_RELOAD_HELP</a>&#160;&#160;&#160;&quot;Time since <a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> Asterisk <a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> seconds.&quot;</td></tr>
<tr class="separator:a01817d0c87120fdc8d23caf10abac14e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13c7fc32b095e443e6b56a5482d8add"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ae13c7fc32b095e443e6b56a5482d8add">CORE_METRICS_SCRAPE_TIME_HELP</a>&#160;&#160;&#160;&quot;Total time taken to collect metrics, <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> milliseconds&quot;</td></tr>
<tr class="separator:ae13c7fc32b095e443e6b56a5482d8add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad85b83bbf542fc0f2a60381756abc89d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ad85b83bbf542fc0f2a60381756abc89d">CORE_PROPERTIES_HELP</a>&#160;&#160;&#160;&quot;Asterisk instance properties. The <a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a> of this will always <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> 1.&quot;</td></tr>
<tr class="separator:ad85b83bbf542fc0f2a60381756abc89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26a33abc94e077495f20c68ef9fcd9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#aa26a33abc94e077495f20c68ef9fcd9c">CORE_UPTIME_HELP</a>&#160;&#160;&#160;&quot;Asterisk instance uptime <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> seconds.&quot;</td></tr>
<tr class="separator:aa26a33abc94e077495f20c68ef9fcd9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af856435d90c99074a4611c7d91c1e3e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#af856435d90c99074a4611c7d91c1e3e0">METRIC_CORE_PROPS_ARRAY_INDEX</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:af856435d90c99074a4611c7d91c1e3e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4d009c0eca8914334ce0ac3cb94fdc14"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a4d009c0eca8914334ce0ac3cb94fdc14">__internal_res_prometheus_self</a> (void)</td></tr>
<tr class="separator:a4d009c0eca8914334ce0ac3cb94fdc14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b68b5417fa2dd75552ccd350a34669"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a78b68b5417fa2dd75552ccd350a34669">AO2_GLOBAL_OBJ_STATIC</a> (<a class="el" href="../../d2/db1/structglobal__config.html">global_config</a>)</td></tr>
<tr class="memdesc:a78b68b5417fa2dd75552ccd350a34669"><td class="mdescLeft">&#160;</td><td class="mdescRight">The module configuration container.  <a href="#a78b68b5417fa2dd75552ccd350a34669">More...</a><br /></td></tr>
<tr class="separator:a78b68b5417fa2dd75552ccd350a34669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316adf476572e46719496b3e74f46db7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a316adf476572e46719496b3e74f46db7">AST_VECTOR</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *)</td></tr>
<tr class="memdesc:a316adf476572e46719496b3e74f46db7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual module config.  <a href="#a316adf476572e46719496b3e74f46db7">More...</a><br /></td></tr>
<tr class="separator:a316adf476572e46719496b3e74f46db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194037c2de1936ac73d7e62d7a50876c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a194037c2de1936ac73d7e62d7a50876c">CONFIG_INFO_STANDARD</a> (cfg_info, <a class="el" href="../../d2/db1/structglobal__config.html">global_config</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c.html#ae006c692706bf9b5e8a21e8140382c75">module_config_alloc</a>,.files=<a class="el" href="../../db/dfe/config__options_8h.html#a60d2944aab4537720434ab9c90e12418">ACO_FILES</a>(&amp;<a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac8330cf9666b8a458ae64845333bff62">prometheus_conf</a>),.pre_apply_config=<a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac853a42ee2aaf0e2cb49caa91af83c73">prometheus_config_pre_apply</a>,.post_apply_config=<a class="el" href="../../d7/d1b/res__prometheus_8c.html#a525b72c6fbe7e11eaeb5a0b279d0014d">prometheus_config_post_apply</a>,)</td></tr>
<tr class="memdesc:a194037c2de1936ac73d7e62d7a50876c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register information about the configs being processed by this module.  <a href="#a194037c2de1936ac73d7e62d7a50876c">More...</a><br /></td></tr>
<tr class="separator:a194037c2de1936ac73d7e62d7a50876c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c5bed838e85d25b304793ac5ca7ccb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a32c5bed838e85d25b304793ac5ca7ccb">get_core_uptime_cb</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="separator:a32c5bed838e85d25b304793ac5ca7ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0a453293b84f22469f31fe9b80aca0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a8c0a453293b84f22469f31fe9b80aca0">get_last_reload_cb</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="separator:a8c0a453293b84f22469f31fe9b80aca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af291d12b8e3d76b8341d4b9a5e7983"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a3af291d12b8e3d76b8341d4b9a5e7983">http_callback</a> (struct <a class="el" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, const struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, const char *uri, enum <a class="el" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</td></tr>
<tr class="separator:a3af291d12b8e3d76b8341d4b9a5e7983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae006c692706bf9b5e8a21e8140382c75"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ae006c692706bf9b5e8a21e8140382c75">module_config_alloc</a> (void)</td></tr>
<tr class="memdesc:ae006c692706bf9b5e8a21e8140382c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Module config constructor.  <a href="#ae006c692706bf9b5e8a21e8140382c75">More...</a><br /></td></tr>
<tr class="separator:ae006c692706bf9b5e8a21e8140382c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4561183c565a8df510400ec5b4362be"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#aa4561183c565a8df510400ec5b4362be">module_config_dtor</a> (void *obj)</td></tr>
<tr class="memdesc:aa4561183c565a8df510400ec5b4362be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration object destructor.  <a href="#aa4561183c565a8df510400ec5b4362be">More...</a><br /></td></tr>
<tr class="separator:aa4561183c565a8df510400ec5b4362be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28fee05e158456c0b5e7d236fc20d40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ae28fee05e158456c0b5e7d236fc20d40">prometheus_callback_register</a> (struct <a class="el" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *callback)</td></tr>
<tr class="separator:ae28fee05e158456c0b5e7d236fc20d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af890c773bfd39b4979937b73c1f401"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a8af890c773bfd39b4979937b73c1f401">prometheus_callback_unregister</a> (struct <a class="el" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *callback)</td></tr>
<tr class="memdesc:a8af890c773bfd39b4979937b73c1f401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a registered callback.  <a href="#a8af890c773bfd39b4979937b73c1f401">More...</a><br /></td></tr>
<tr class="separator:a8af890c773bfd39b4979937b73c1f401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525b72c6fbe7e11eaeb5a0b279d0014d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a525b72c6fbe7e11eaeb5a0b279d0014d">prometheus_config_post_apply</a> (void)</td></tr>
<tr class="memdesc:a525b72c6fbe7e11eaeb5a0b279d0014d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-apply callback for the config framework.  <a href="#a525b72c6fbe7e11eaeb5a0b279d0014d">More...</a><br /></td></tr>
<tr class="separator:a525b72c6fbe7e11eaeb5a0b279d0014d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac853a42ee2aaf0e2cb49caa91af83c73"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac853a42ee2aaf0e2cb49caa91af83c73">prometheus_config_pre_apply</a> (void)</td></tr>
<tr class="memdesc:ac853a42ee2aaf0e2cb49caa91af83c73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-apply callback for the config framework.  <a href="#ac853a42ee2aaf0e2cb49caa91af83c73">More...</a><br /></td></tr>
<tr class="separator:ac853a42ee2aaf0e2cb49caa91af83c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ce4a778dc12b1b14097b3bfd23a248"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#aa8ce4a778dc12b1b14097b3bfd23a248">prometheus_counter_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *help)</td></tr>
<tr class="memdesc:aa8ce4a778dc12b1b14097b3bfd23a248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a malloc'd counter metric.  <a href="#aa8ce4a778dc12b1b14097b3bfd23a248">More...</a><br /></td></tr>
<tr class="separator:aa8ce4a778dc12b1b14097b3bfd23a248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437e2859b1d632b1ee413bad2c42db52"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *help)</td></tr>
<tr class="memdesc:a437e2859b1d632b1ee413bad2c42db52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a malloc'd gauge metric.  <a href="#a437e2859b1d632b1ee413bad2c42db52">More...</a><br /></td></tr>
<tr class="separator:a437e2859b1d632b1ee413bad2c42db52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbfa9427d40e32fe0111a3746d95133c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#adbfa9427d40e32fe0111a3746d95133c">prometheus_general_config_alloc</a> (void)</td></tr>
<tr class="memdesc:adbfa9427d40e32fe0111a3746d95133c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new configuration object.  <a href="#adbfa9427d40e32fe0111a3746d95133c">More...</a><br /></td></tr>
<tr class="separator:adbfa9427d40e32fe0111a3746d95133c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4226c5e9ffbee3d34714aaabd6c5c848"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a4226c5e9ffbee3d34714aaabd6c5c848">prometheus_general_config_dtor</a> (void *obj)</td></tr>
<tr class="separator:a4226c5e9ffbee3d34714aaabd6c5c848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b2557ffd682d4efec2d3094a01d104"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a62b2557ffd682d4efec2d3094a01d104">prometheus_general_config_get</a> (void)</td></tr>
<tr class="memdesc:a62b2557ffd682d4efec2d3094a01d104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the current configuration of the module.  <a href="#a62b2557ffd682d4efec2d3094a01d104">More...</a><br /></td></tr>
<tr class="separator:a62b2557ffd682d4efec2d3094a01d104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25507755e82d34f73b054fac5087d582"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a> (struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="el" href="../../d0/d8a/muted_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>)</td></tr>
<tr class="memdesc:a25507755e82d34f73b054fac5087d582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the configuration for the module.  <a href="#a25507755e82d34f73b054fac5087d582">More...</a><br /></td></tr>
<tr class="separator:a25507755e82d34f73b054fac5087d582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b9fac7324225a514f786b91b7c66e3"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ab0b9fac7324225a514f786b91b7c66e3">prometheus_last_scrape_duration_get</a> (void)</td></tr>
<tr class="memdesc:ab0b9fac7324225a514f786b91b7c66e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the amount of time it took to perform the last scrape.  <a href="#ab0b9fac7324225a514f786b91b7c66e3">More...</a><br /></td></tr>
<tr class="separator:ab0b9fac7324225a514f786b91b7c66e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a81b00149e0574228e695029439f842"><td class="memItemLeft" align="right" valign="top">struct timeval&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a7a81b00149e0574228e695029439f842">prometheus_last_scrape_time_get</a> (void)</td></tr>
<tr class="memdesc:a7a81b00149e0574228e695029439f842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the timestamp when the last scrape occurred.  <a href="#a7a81b00149e0574228e695029439f842">More...</a><br /></td></tr>
<tr class="separator:a7a81b00149e0574228e695029439f842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f12e3c3321fe61700762cea21e0974"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *left, struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *right)</td></tr>
<tr class="separator:a91f12e3c3321fe61700762cea21e0974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a334a70b8df4aae192739359d6e435e6e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a334a70b8df4aae192739359d6e435e6e">prometheus_metric_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *help)</td></tr>
<tr class="separator:a334a70b8df4aae192739359d6e435e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8409a6e51c0e44c5802261465034a57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="memdesc:ab8409a6e51c0e44c5802261465034a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a metric and all its children.  <a href="#ab8409a6e51c0e44c5802261465034a57">More...</a><br /></td></tr>
<tr class="separator:ab8409a6e51c0e44c5802261465034a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2efa631e53b5ece9e87b1df3a0a40e10"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a2efa631e53b5ece9e87b1df3a0a40e10">prometheus_metric_full_to_string</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric, struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **output)</td></tr>
<tr class="separator:a2efa631e53b5ece9e87b1df3a0a40e10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a466676f24c8935739be58c2c3aab6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="separator:a12a466676f24c8935739be58c2c3aab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a152734c2aa84df297edd115b921e6906"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a> (void)</td></tr>
<tr class="separator:a152734c2aa84df297edd115b921e6906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd25ff5603091eef2d7bf3fed8f7474a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric, struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **output)</td></tr>
<tr class="memdesc:abd25ff5603091eef2d7bf3fed8f7474a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a metric (and its children) into Prometheus compatible text.  <a href="#abd25ff5603091eef2d7bf3fed8f7474a">More...</a><br /></td></tr>
<tr class="separator:abd25ff5603091eef2d7bf3fed8f7474a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeadb37bd14fc6df8821b9134613c341"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#abeadb37bd14fc6df8821b9134613c341">prometheus_metric_type_to_string</a> (enum <a class="el" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932">prometheus_metric_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="separator:abeadb37bd14fc6df8821b9134613c341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02a3a2b23615b19bdc4ab8a9ab396dba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="memdesc:a02a3a2b23615b19bdc4ab8a9ab396dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a registered metric.  <a href="#a02a3a2b23615b19bdc4ab8a9ab396dba">More...</a><br /></td></tr>
<tr class="separator:a02a3a2b23615b19bdc4ab8a9ab396dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9324bd9603be11341b0d982095a2c50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac9324bd9603be11341b0d982095a2c50">prometheus_metrics_provider_register</a> (const struct <a class="el" href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a> *<a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a>)</td></tr>
<tr class="memdesc:ac9324bd9603be11341b0d982095a2c50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a metrics provider.  <a href="#ac9324bd9603be11341b0d982095a2c50">More...</a><br /></td></tr>
<tr class="separator:ac9324bd9603be11341b0d982095a2c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a98b32e9e582d8fc6e0e5a4b7947af"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a77a98b32e9e582d8fc6e0e5a4b7947af">prometheus_scrape_to_string</a> (void)</td></tr>
<tr class="memdesc:a77a98b32e9e582d8fc6e0e5a4b7947af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the raw output of what a scrape would produce.  <a href="#a77a98b32e9e582d8fc6e0e5a4b7947af">More...</a><br /></td></tr>
<tr class="separator:a77a98b32e9e582d8fc6e0e5a4b7947af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0bf9da827c93bf5d2eb27e80e642517"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#af0bf9da827c93bf5d2eb27e80e642517">scrape_metrics</a> (struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **response)</td></tr>
<tr class="separator:af0bf9da827c93bf5d2eb27e80e642517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;Asterisk Prometheus Module&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a9f8870a5687abe3d9a6b0b3fbc89a800">AST_MODULE_SUPPORT_EXTENDED</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .load_pri = <a class="el" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a1d1eb207e01a2d3bf6aa6ba271c27dee">AST_MODPRI_DEFAULT</a>, #ifdef 1 .requires = &quot;res_pjsip&quot;, #endif }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edeed6c8470271ed37782ea5ac1a500"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a> []</td></tr>
<tr class="memdesc:a5edeed6c8470271ed37782ea5ac1a500"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core metrics to scrape.  <a href="#a5edeed6c8470271ed37782ea5ac1a500">More...</a><br /></td></tr>
<tr class="separator:a5edeed6c8470271ed37782ea5ac1a500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d658c0c628873c1c13a41b3d8076220"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a></td></tr>
<tr class="memdesc:a8d658c0c628873c1c13a41b3d8076220"><td class="mdescLeft">&#160;</td><td class="mdescRight">The scrape duration metric.  <a href="#a8d658c0c628873c1c13a41b3d8076220">More...</a><br /></td></tr>
<tr class="separator:a8d658c0c628873c1c13a41b3d8076220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab1543f7ac14f52ba5148960429e849"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d71/structaco__type.html">aco_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#aeab1543f7ac14f52ba5148960429e849">global_option</a></td></tr>
<tr class="separator:aeab1543f7ac14f52ba5148960429e849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b71d76cff3ccd9fe2a0c4a16d21271"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d71/structaco__type.html">aco_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a> [] = <a class="el" href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a>(&amp;<a class="el" href="../../dc/d6b/res__xmpp_8c.html#aeab1543f7ac14f52ba5148960429e849">global_option</a>)</td></tr>
<tr class="separator:a05b71d76cff3ccd9fe2a0c4a16d21271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8330cf9666b8a458ae64845333bff62"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d9c/structaco__file.html">aco_file</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac8330cf9666b8a458ae64845333bff62">prometheus_conf</a></td></tr>
<tr class="separator:ac8330cf9666b8a458ae64845333bff62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38f0f4a2a6b16f65dd23d70219ac101"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a></td></tr>
<tr class="separator:ab38f0f4a2a6b16f65dd23d70219ac101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52907b32ce3af257e0ae090387c51545"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dd/d42/lock_8h.html#a44a55ccb432d858a224b401116277e93">ast_mutex_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a> = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} }</td></tr>
<tr class="memdesc:a52907b32ce3af257e0ae090387c51545"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock that protects data structures during an HTTP scrape.  <a href="#a52907b32ce3af257e0ae090387c51545">More...</a><br /></td></tr>
<tr class="separator:a52907b32ce3af257e0ae090387c51545"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Core Prometheus metrics API. </p>
<dl class="section author"><dt>Author</dt><dd>Matt Jordan <a href="#" onclick="location.href='mai'+'lto:'+'mjo'+'rd'+'an@'+'di'+'giu'+'m.'+'com'; return false;">mjord<span style="display: none;">.nosp@m.</span>an@d<span style="display: none;">.nosp@m.</span>igium<span style="display: none;">.nosp@m.</span>.com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afc7978ad9b344a3a8d32f335a1cc7bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7978ad9b344a3a8d32f335a1cc7bcc">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_MODULE_SELF_SYM&#160;&#160;&#160;<a class="el" href="../../d7/d1b/res__prometheus_8c.html#a4d009c0eca8914334ce0ac3cb94fdc14">__internal_res_prometheus_self</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00121">121</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a01817d0c87120fdc8d23caf10abac14e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01817d0c87120fdc8d23caf10abac14e">&#9670;&nbsp;</a></span>CORE_LAST_RELOAD_HELP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORE_LAST_RELOAD_HELP&#160;&#160;&#160;&quot;Time since <a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> Asterisk <a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> seconds.&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00184">184</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="ae13c7fc32b095e443e6b56a5482d8add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae13c7fc32b095e443e6b56a5482d8add">&#9670;&nbsp;</a></span>CORE_METRICS_SCRAPE_TIME_HELP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORE_METRICS_SCRAPE_TIME_HELP&#160;&#160;&#160;&quot;Total time taken to collect metrics, <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> milliseconds&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00186">186</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="ad85b83bbf542fc0f2a60381756abc89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad85b83bbf542fc0f2a60381756abc89d">&#9670;&nbsp;</a></span>CORE_PROPERTIES_HELP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORE_PROPERTIES_HELP&#160;&#160;&#160;&quot;Asterisk instance properties. The <a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a> of this will always <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> 1.&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00180">180</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="aa26a33abc94e077495f20c68ef9fcd9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa26a33abc94e077495f20c68ef9fcd9c">&#9670;&nbsp;</a></span>CORE_UPTIME_HELP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORE_UPTIME_HELP&#160;&#160;&#160;&quot;Asterisk instance uptime <a class="el" href="../../da/d7c/utils_2frame_8h.html#aca392a8d3941cd0740aef3ad92545d67">in</a> seconds.&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00182">182</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="af856435d90c99074a4611c7d91c1e3e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af856435d90c99074a4611c7d91c1e3e0">&#9670;&nbsp;</a></span>METRIC_CORE_PROPS_ARRAY_INDEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METRIC_CORE_PROPS_ARRAY_INDEX&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00220">220</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00827">prometheus_config_post_apply()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4d009c0eca8914334ce0ac3cb94fdc14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d009c0eca8914334ce0ac3cb94fdc14">&#9670;&nbsp;</a></span>__internal_res_prometheus_self()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* __internal_res_prometheus_self </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a78b68b5417fa2dd75552ccd350a34669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b68b5417fa2dd75552ccd350a34669">&#9670;&nbsp;</a></span>AO2_GLOBAL_OBJ_STATIC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static AO2_GLOBAL_OBJ_STATIC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/db1/structglobal__config.html">global_config</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The module configuration container. </p>

</div>
</div>
<a id="a316adf476572e46719496b3e74f46db7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316adf476572e46719496b3e74f46db7">&#9670;&nbsp;</a></span>AST_VECTOR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_VECTOR </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The actual module config. </p>
<p>General settings </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00138">138</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                     {<span class="comment"></span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">   /*! \brief General settings */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *general;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;};</div><div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a194037c2de1936ac73d7e62d7a50876c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194037c2de1936ac73d7e62d7a50876c">&#9670;&nbsp;</a></span>CONFIG_INFO_STANDARD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CONFIG_INFO_STANDARD </td>
          <td>(</td>
          <td class="paramtype">cfg_info&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/db1/structglobal__config.html">global_config</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ae006c692706bf9b5e8a21e8140382c75">module_config_alloc</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">.&#160;</td>
          <td class="paramname"><em>files</em> = <code><a class="el" href="../../db/dfe/config__options_8h.html#a60d2944aab4537720434ab9c90e12418">ACO_FILES</a>(&amp;<a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac8330cf9666b8a458ae64845333bff62">prometheus_conf</a>)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">.&#160;</td>
          <td class="paramname"><em>pre_apply_config</em> = <code><a class="el" href="../../d7/d1b/res__prometheus_8c.html#ac853a42ee2aaf0e2cb49caa91af83c73">prometheus_config_pre_apply</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">.&#160;</td>
          <td class="paramname"><em>post_apply_config</em> = <code><a class="el" href="../../d7/d1b/res__prometheus_8c.html#a525b72c6fbe7e11eaeb5a0b279d0014d">prometheus_config_post_apply</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register information about the configs being processed by this module. </p>

</div>
</div>
<a id="a32c5bed838e85d25b304793ac5ca7ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32c5bed838e85d25b304793ac5ca7ccb">&#9670;&nbsp;</a></span>get_core_uptime_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void get_core_uptime_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00188">188</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d03/asterisk_8c_source.html#l00336">ast_startuptime</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00064">ast_tvdiff_sec()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   int64_t duration = <a class="code" href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a>(now, <a class="code" href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   snprintf(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>, <span class="keyword">sizeof</span>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>), <span class="stringliteral">&quot;%&quot;</span> PRIu64, duration);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div><div class="ttc" id="time_8h_html_a39af1febe8b93cb6f7cd59b76fc39e8f"><div class="ttname"><a href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a></div><div class="ttdeci">int64_t ast_tvdiff_sec(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in seconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00064">time.h:64</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
<div class="ttc" id="options_8h_html_acd462f81fa607939af36a9fa33cdbf9d"><div class="ttname"><a href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a></div><div class="ttdeci">struct timeval ast_startuptime</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00336">asterisk.c:336</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0a453293b84f22469f31fe9b80aca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0a453293b84f22469f31fe9b80aca0">&#9670;&nbsp;</a></span>get_last_reload_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void get_last_reload_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00196">196</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d03/asterisk_8c_source.html#l00337">ast_lastreloadtime</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00064">ast_tvdiff_sec()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   int64_t duration = <a class="code" href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a>(now, <a class="code" href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   snprintf(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>, <span class="keyword">sizeof</span>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>), <span class="stringliteral">&quot;%&quot;</span> PRIu64, duration);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="ttc" id="time_8h_html_a39af1febe8b93cb6f7cd59b76fc39e8f"><div class="ttname"><a href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a></div><div class="ttdeci">int64_t ast_tvdiff_sec(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in seconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00064">time.h:64</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="options_8h_html_a7cdafc5a121e87659887ffc9abe36760"><div class="ttname"><a href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a></div><div class="ttdeci">struct timeval ast_lastreloadtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00337">asterisk.c:337</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3af291d12b8e3d76b8341d4b9a5e7983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af291d12b8e3d76b8341d4b9a5e7983">&#9670;&nbsp;</a></span>http_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int http_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *&#160;</td>
          <td class="paramname"><em>ser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *&#160;</td>
          <td class="paramname"><em>urih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>get_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>headers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00593">593</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l01579">ast_http_get_auth()</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00456">ast_http_send()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/d56/http_8h_source.html#l00127">ast_http_auth::password</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00563">scrape_metrics()</a>, <a class="el" href="../../dd/d56/http_8h_source.html#l00125">ast_http_auth::userid</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *, mod_cfg, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d2/db1/structglobal__config.html">global_config</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *response = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <span class="keyword">struct </span>timeval start;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keyword">struct </span>timeval <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="comment">/* If there is no module config or we&#39;re not enabled, we can&#39;t handle requests */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">if</span> (!mod_cfg || !mod_cfg-&gt;general-&gt;enabled) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">goto</span> err503;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mod_cfg-&gt;general-&gt;auth_username)) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dbf/structast__http__auth.html">ast_http_auth</a> *http_auth;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      http_auth = <a class="code" href="../../dd/d56/http_8h.html#a9a7ef71bdba2a4f83b40dd7fad426207">ast_http_get_auth</a>(headers);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">if</span> (!http_auth) {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         <span class="keywordflow">goto</span> err401;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordflow">if</span> (strcmp(http_auth-&gt;<a class="code" href="../../d5/dbf/structast__http__auth.html#a73d34d9d434bc914f9fcad3427632609">userid</a>, mod_cfg-&gt;general-&gt;auth_username)) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Invalid username provided for auth request: %s\n&quot;</span>, http_auth-&gt;<a class="code" href="../../d5/dbf/structast__http__auth.html#a73d34d9d434bc914f9fcad3427632609">userid</a>);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(http_auth, -1);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;         <span class="keywordflow">goto</span> err401;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (strcmp(http_auth-&gt;<a class="code" href="../../d5/dbf/structast__http__auth.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>, mod_cfg-&gt;general-&gt;auth_password)) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Invalid password provided for auth request: %s\n&quot;</span>, http_auth-&gt;<a class="code" href="../../d5/dbf/structast__http__auth.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(http_auth, -1);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;         <span class="keywordflow">goto</span> err401;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(http_auth, -1);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   response = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(512);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <span class="keywordflow">if</span> (!response) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">goto</span> err500;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   start = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   last_scrape = start;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <a class="code" href="../../d7/d1b/res__prometheus_8c.html#af0bf9da827c93bf5d2eb27e80e642517">scrape_metrics</a>(&amp;response);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keywordflow">if</span> (mod_cfg-&gt;general-&gt;core_metrics_enabled) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      int64_t duration;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      duration = <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, start);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      snprintf(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a>.<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>,</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a>.<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>),</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         <span class="stringliteral">&quot;%&quot;</span> PRIu64,</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         duration);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a>, &amp;response);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, 200, <span class="stringliteral">&quot;OK&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, response, 0, 0);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;err401:</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *auth_challenge_headers;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      auth_challenge_headers = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">if</span> (!auth_challenge_headers) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         <span class="keywordflow">goto</span> err500;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;auth_challenge_headers, 0,</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;         <span class="stringliteral">&quot;WWW-Authenticate: Basic realm=\&quot;%s\&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         mod_cfg-&gt;general-&gt;auth_realm);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="comment">/* ast_http_send takes ownership of the ast_str */</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, 401, <span class="stringliteral">&quot;Unauthorized&quot;</span>, auth_challenge_headers, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(response);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;err503:</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, 503, <span class="stringliteral">&quot;Service Unavailable&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(response);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;err500:</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(response);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="ttc" id="structast__http__auth_html_a73d34d9d434bc914f9fcad3427632609"><div class="ttname"><a href="../../d5/dbf/structast__http__auth.html#a73d34d9d434bc914f9fcad3427632609">ast_http_auth::userid</a></div><div class="ttdeci">char * userid</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00125">http.h:125</a></div></div>
<div class="ttc" id="structglobal__config_html"><div class="ttname"><a href="../../d2/db1/structglobal__config.html">global_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00068">config_global.c:68</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="http_8h_html_a0448c9f4a66b6ee7994870b187e185b4"><div class="ttname"><a href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a></div><div class="ttdeci">void ast_http_send(struct ast_tcptls_session_instance *ser, enum ast_http_method method, int status_code, const char *status_title, struct ast_str *http_header, struct ast_str *out, int fd, unsigned int static_content)</div><div class="ttdoc">Generic function for sending HTTP/1.1 response. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00456">http.c:456</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
<div class="ttc" id="structast__http__auth_html_a59460a3ff2c12443d1022e5cc0fba85c"><div class="ttname"><a href="../../d5/dbf/structast__http__auth.html#a59460a3ff2c12443d1022e5cc0fba85c">ast_http_auth::password</a></div><div class="ttdeci">char * password</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00127">http.h:127</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_abd25ff5603091eef2d7bf3fed8f7474a"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a></div><div class="ttdeci">void prometheus_metric_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdoc">Convert a metric (and its children) into Prometheus compatible text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00521">res_prometheus.c:521</a></div></div>
<div class="ttc" id="structast__http__auth_html"><div class="ttname"><a href="../../d5/dbf/structast__http__auth.html">ast_http_auth</a></div><div class="ttdoc">HTTP authentication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00123">http.h:123</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="http_8h_html_a9a7ef71bdba2a4f83b40dd7fad426207"><div class="ttname"><a href="../../dd/d56/http_8h.html#a9a7ef71bdba2a4f83b40dd7fad426207">ast_http_get_auth</a></div><div class="ttdeci">struct ast_http_auth * ast_http_get_auth(struct ast_variable *headers)</div><div class="ttdoc">Get HTTP authentication information from headers. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l01579">http.c:1579</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_af0bf9da827c93bf5d2eb27e80e642517"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#af0bf9da827c93bf5d2eb27e80e642517">scrape_metrics</a></div><div class="ttdeci">static void scrape_metrics(struct ast_str **response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00563">res_prometheus.c:563</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a8d658c0c628873c1c13a41b3d8076220"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a></div><div class="ttdeci">static struct prometheus_metric core_scrape_metric</div><div class="ttdoc">The scrape duration metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00213">res_prometheus.c:213</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00945">945</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/dfe/config__options_8h_source.html#l00064">ACO_EXACT</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00910">aco_info_destroy()</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00877">aco_info_init()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00623">aco_option_register</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00652">aco_process_config()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00527">ACO_PROCESS_ERROR</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00673">ast_http_uri_link()</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00705">ast_http_uri_unlink()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00316">AST_MODFLAG_GLOBAL_SYMBOLS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00332">AST_MODPRI_DEFAULT</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00122">AST_MODULE_SUPPORT_EXTENDED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00183">bridge_metrics_init()</a>, <a class="el" href="../../df/d8d/channels_8c_source.html#l00241">channel_metrics_init()</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">cleanup()</a>, <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00137">cli_init()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00091">enabled</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00198">endpoint_metrics_init()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d8/d20/autoconfig_8h_source.html#l00629">HAVE_PJPROJECT</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00294">OPT_BOOL_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00435">OPT_STRINGFIELD_T</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00342">pjsip_outbound_registration_metrics_init()</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c_source.html#l00272">providers</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00910">reload_module()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00827">STRFLDSET</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00876">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;{</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;metrics, 64)) {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;callbacks, 8)) {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>, 8)) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a>(&amp;cfg_info)) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;enabled&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, <a class="code" href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>));</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;core_metrics_enabled&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, core_metrics_enabled));</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;uri&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, uri));</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;auth_username&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, auth_username));</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;auth_password&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, auth_password));</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;auth_realm&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a>, <span class="stringliteral">&quot;Asterisk Prometheus Metrics&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>, auth_realm));</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a>(&amp;cfg_info, 0) == <a class="code" href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a>) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/db8/res_2prometheus_2cli_8c.html#a8344521e6d0a510224cc68f40e97c7ca">cli_init</a>()</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      || <a class="code" href="../../df/d8d/channels_8c.html#a1e66902318cc97373d88db1e0aecf4d2">channel_metrics_init</a>()</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      || <a class="code" href="../../d6/d2c/res_2prometheus_2endpoints_8c.html#af9f2265acbc16ea23195efc98f72ae88">endpoint_metrics_init</a>()</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      || <a class="code" href="../../d8/d3a/bridges_8c.html#aecd310ab6f7c7d2536f3156541891b47">bridge_metrics_init</a>()</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      || <a class="code" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a050053af11b48dc9a115dd03d1e92346">pjsip_outbound_registration_metrics_init</a>()) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>)) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a>(&amp;cfg_info);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;metrics);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;callbacks);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="config__options_8h_html_a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00064">config_options.h:64</a></div></div>
<div class="ttc" id="pjsip__outbound__registrations_8c_html_a050053af11b48dc9a115dd03d1e92346"><div class="ttname"><a href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a050053af11b48dc9a115dd03d1e92346">pjsip_outbound_registration_metrics_init</a></div><div class="ttdeci">int pjsip_outbound_registration_metrics_init(void)</div><div class="ttdoc">Initialize PJSIP outbound registration metrics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00342">pjsip_outbound_registrations.c:342</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="http_8h_html_ac99d56925cf94f8cf3ed0acac52e2d75"><div class="ttname"><a href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a></div><div class="ttdeci">int ast_http_uri_link(struct ast_http_uri *urihandler)</div><div class="ttdoc">Register a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00673">http.c:673</a></div></div>
<div class="ttc" id="config__options_8h_html_a60d17d3e9451ddcb5aa861339c757bed"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a></div><div class="ttdeci">#define aco_option_register(info, name, matchtype, types, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a config option. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00623">config_options.h:623</a></div></div>
<div class="ttc" id="http_8h_html_a33e436ed8aeb33287f1e6cb1c5288a14"><div class="ttname"><a href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a></div><div class="ttdeci">void ast_http_uri_unlink(struct ast_http_uri *urihandler)</div><div class="ttdoc">Unregister a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00705">http.c:705</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab38f0f4a2a6b16f65dd23d70219ac101"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a></div><div class="ttdeci">static struct ast_http_uri prometheus_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00791">res_prometheus.c:791</a></div></div>
<div class="ttc" id="config__options_8h_html_af28935f8c2547723d5922ebed1c71898"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a></div><div class="ttdeci">enum aco_process_status aco_process_config(struct aco_info *info, int reload)</div><div class="ttdoc">Process a config info via the options registered with an aco_info. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00652">config_options.c:652</a></div></div>
<div class="ttc" id="res_2prometheus_2endpoints_8c_html_af9f2265acbc16ea23195efc98f72ae88"><div class="ttname"><a href="../../d6/d2c/res_2prometheus_2endpoints_8c.html#af9f2265acbc16ea23195efc98f72ae88">endpoint_metrics_init</a></div><div class="ttdeci">int endpoint_metrics_init(void)</div><div class="ttdoc">Initialize endpoint metrics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00198">res/prometheus/endpoints.c:198</a></div></div>
<div class="ttc" id="res_2prometheus_2cli_8c_html_a8344521e6d0a510224cc68f40e97c7ca"><div class="ttname"><a href="../../d5/db8/res_2prometheus_2cli_8c.html#a8344521e6d0a510224cc68f40e97c7ca">cli_init</a></div><div class="ttdeci">int cli_init(void)</div><div class="ttdoc">Initialize CLI command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00137">res/prometheus/cli.c:137</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="config__options_8h_html_a3f40a7cffea07c21a21faaee64d24398"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a></div><div class="ttdeci">int aco_info_init(struct aco_info *info)</div><div class="ttdoc">Initialize an aco_info structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00877">config_options.c:877</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_ade65b780dfb3ed391547716236573f6b"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a></div><div class="ttdeci">struct ao2_container * providers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00272">res_phoneprov.c:272</a></div></div>
<div class="ttc" id="config__options_8h_html_a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a></div><div class="ttdoc">Their was an error and no changes were applied. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00527">config_options.h:527</a></div></div>
<div class="ttc" id="config__options_8h_html_a21b11339ca4d0b1167c956a9f816bd19"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a></div><div class="ttdeci">void aco_info_destroy(struct aco_info *info)</div><div class="ttdoc">Destroy an initialized aco_info struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00910">config_options.c:910</a></div></div>
<div class="ttc" id="channels_8c_html_a1e66902318cc97373d88db1e0aecf4d2"><div class="ttname"><a href="../../df/d8d/channels_8c.html#a1e66902318cc97373d88db1e0aecf4d2">channel_metrics_init</a></div><div class="ttdeci">int channel_metrics_init(void)</div><div class="ttdoc">Initialize channel metrics. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d8d/channels_8c_source.html#l00241">channels.c:241</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00294">config_options.h:294</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a05b71d76cff3ccd9fe2a0c4a16d21271"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a05b71d76cff3ccd9fe2a0c4a16d21271">global_options</a></div><div class="ttdeci">struct aco_type * global_options[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00160">res_prometheus.c:160</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="bridges_8c_html_aecd310ab6f7c7d2536f3156541891b47"><div class="ttname"><a href="../../d8/d3a/bridges_8c.html#aecd310ab6f7c7d2536f3156541891b47">bridge_metrics_init</a></div><div class="ttdeci">int bridge_metrics_init(void)</div><div class="ttdoc">Initialize bridge metrics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/bridges_8c_source.html#l00183">bridges.c:183</a></div></div>
<div class="ttc" id="dnsmgr_8c_html_a03e6cca0c879c0443efb431c30c14f76"><div class="ttname"><a href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a></div><div class="ttdeci">static int enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5d/dnsmgr_8c_source.html#l00091">dnsmgr.c:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae006c692706bf9b5e8a21e8140382c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae006c692706bf9b5e8a21e8140382c75">&#9670;&nbsp;</a></span>module_config_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * module_config_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Module config constructor. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00773">773</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l00223">module_config::general</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00763">module_config_dtor()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00726">prometheus_general_config_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;{</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   config = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*config), <a class="code" href="../../d7/d1b/res__prometheus_8c.html#aa4561183c565a8df510400ec5b4362be">module_config_dtor</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a> = <a class="code" href="../../d7/d1b/res__prometheus_8c.html#adbfa9427d40e32fe0111a3746d95133c">prometheus_general_config_alloc</a>();</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <span class="keywordflow">if</span> (!config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(config, -1);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      config = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_adbfa9427d40e32fe0111a3746d95133c"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#adbfa9427d40e32fe0111a3746d95133c">prometheus_general_config_alloc</a></div><div class="ttdeci">void * prometheus_general_config_alloc(void)</div><div class="ttdoc">Allocate a new configuration object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00726">res_prometheus.c:726</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_aa4561183c565a8df510400ec5b4362be"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#aa4561183c565a8df510400ec5b4362be">module_config_dtor</a></div><div class="ttdeci">static void module_config_dtor(void *obj)</div><div class="ttdoc">Configuration object destructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00763">res_prometheus.c:763</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structmodule__config_html_a95699733ba47a55e25760adf5c51e59a"><div class="ttname"><a href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">module_config::general</a></div><div class="ttdeci">struct ast_cdr_config * general</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00223">cdr.c:223</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4561183c565a8df510400ec5b4362be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4561183c565a8df510400ec5b4362be">&#9670;&nbsp;</a></span>module_config_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void module_config_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configuration object destructor. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00763">763</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, and <a class="el" href="../../dc/df2/cdr_8c_source.html#l00223">module_config::general</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00773">module_config_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;{</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = obj;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">if</span> (config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>, -1);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="structmodule__config_html_a95699733ba47a55e25760adf5c51e59a"><div class="ttname"><a href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">module_config::general</a></div><div class="ttdeci">struct ast_cdr_config * general</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00223">cdr.c:223</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae28fee05e158456c0b5e7d236fc20d40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28fee05e158456c0b5e7d236fc20d40">&#9670;&nbsp;</a></span>prometheus_callback_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prometheus_callback_register </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a metric callback</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The callback to register</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00535">535</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00421">prometheus_callback::callback_fn</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00417">prometheus_callback::name</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00202">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00183">bridge_metrics_init()</a>, <a class="el" href="../../df/d8d/channels_8c_source.html#l00241">channel_metrics_init()</a>, and <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00198">endpoint_metrics_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keywordflow">if</span> (!callback || !callback-&gt;<a class="code" href="../../d5/d3d/structprometheus__callback.html#a9fb6e51a66967a6bda60805952b124a3">callback_fn</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(callback-&gt;<a class="code" href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;callbacks, callback);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="structprometheus__callback_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">prometheus_callback::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of our callback (always useful for debugging) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00417">res_prometheus.h:417</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structprometheus__callback_html_a9fb6e51a66967a6bda60805952b124a3"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html#a9fb6e51a66967a6bda60805952b124a3">prometheus_callback::callback_fn</a></div><div class="ttdeci">void(* callback_fn)(struct ast_str **output)</div><div class="ttdoc">The callback function to invoke. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00421">res_prometheus.h:421</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8af890c773bfd39b4979937b73c1f401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af890c773bfd39b4979937b73c1f401">&#9670;&nbsp;</a></span>prometheus_callback_unregister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prometheus_callback_unregister </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a registered callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The callback to unregister </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00548">548</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00412">AST_VECTOR_REMOVE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00417">prometheus_callback::name</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00202">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00169">bridge_metrics_unload_cb()</a>, <a class="el" href="../../df/d8d/channels_8c_source.html#l00227">channel_metrics_unload_cb()</a>, and <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00184">endpoint_metrics_unload_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;{</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;callbacks); i++) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;callbacks, i);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">if</span> (!strcmp(callback-&gt;<a class="code" href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, entry-&gt;<a class="code" href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a>(&amp;callbacks, i, 1);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div><div class="ttc" id="structprometheus__callback_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">prometheus_callback::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of our callback (always useful for debugging) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00417">res_prometheus.h:417</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="vector_8h_html_abe6d979239bef1a97d069b1a10c7d35c"><div class="ttname"><a href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE(vec, idx, preserve_ordered)</div><div class="ttdoc">Remove an element from a vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00412">vector.h:412</a></div></div>
<div class="ttc" id="structprometheus__callback_html"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a></div><div class="ttdoc">Defines a callback that will be invoked when the HTTP route is called. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00413">res_prometheus.h:413</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a525b72c6fbe7e11eaeb5a0b279d0014d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525b72c6fbe7e11eaeb5a0b279d0014d">&#9670;&nbsp;</a></span>prometheus_config_post_apply()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prometheus_config_post_apply </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-apply callback for the config framework. </p>
<p>This sets any run-time information derived from the configuration </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00827">827</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d4/d42/buildinfo_8c_source.html#l00033">ast_build_date</a>, <a class="el" href="../../d4/d42/buildinfo_8c_source.html#l00029">ast_build_hostname</a>, <a class="el" href="../../d4/d42/buildinfo_8c_source.html#l00030">ast_build_kernel</a>, <a class="el" href="../../d4/d42/buildinfo_8c_source.html#l00032">ast_build_os</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02587">ast_eid_to_str()</a>, <a class="el" href="../../d2/d0b/version_8c_source.html#l00026">ast_get_build_opts()</a>, <a class="el" href="../../d2/d0b/version_8c_source.html#l00016">ast_get_version()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00220">METRIC_CORE_PROPS_ARRAY_INDEX</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">prometheus_metric_register()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00321">PROMETHEUS_METRIC_SET_LABEL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/d56/http_8h_source.html#l00103">ast_http_uri::uri</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *, mod_cfg, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d2/db1/structglobal__config.html">global_config</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="comment">/* We can get away with this as the lifetime of the URI</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">    * registered with the HTTP core is contained within</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">    * the lifetime of the module configuration</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>.<a class="code" href="../../d0/d6c/structast__http__uri.html#a69ec24fb2d0a5f5e532deb9adaab81d6">uri</a> = mod_cfg-&gt;general-&gt;uri;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="comment">/* Re-register the core metrics */</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>); i++) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[i]);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">if</span> (mod_cfg-&gt;general-&gt;core_metrics_enabled) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordtype">char</span> eid_str[32];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a>(eid_str, <span class="keyword">sizeof</span>(eid_str), &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a>, 0, <span class="stringliteral">&quot;eid&quot;</span>, eid_str);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[<a class="code" href="../../d7/d1b/res__prometheus_8c.html#af856435d90c99074a4611c7d91c1e3e0">METRIC_CORE_PROPS_ARRAY_INDEX</a>],</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         1, <span class="stringliteral">&quot;version&quot;</span>, <a class="code" href="../../d5/db9/ast__version_8h.html#a7765c608aea948584928643ab3963b2a">ast_get_version</a>());</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX],</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         2, <span class="stringliteral">&quot;build_options&quot;</span>, <a class="code" href="../../d5/db9/ast__version_8h.html#a8a80e93d07dd404319c28c0eaa216672">ast_get_build_opts</a>());</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX],</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         3, <span class="stringliteral">&quot;build_date&quot;</span>, <a class="code" href="../../de/d35/buildinfo_8h.html#af1708cda257f6db95f77b34f112ef64b">ast_build_date</a>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX],</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         4, <span class="stringliteral">&quot;build_os&quot;</span>, <a class="code" href="../../de/d35/buildinfo_8h.html#a00b5464ec2f306ae8f17f73a0a81f28d">ast_build_os</a>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX],</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         5, <span class="stringliteral">&quot;build_kernel&quot;</span>, <a class="code" href="../../de/d35/buildinfo_8h.html#af89b2913397f19dc15adb9014bcb5d5a">ast_build_kernel</a>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX],</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         6, <span class="stringliteral">&quot;build_host&quot;</span>, <a class="code" href="../../de/d35/buildinfo_8h.html#aae3c7406e483c475f34063c84048ab89">ast_build_hostname</a>);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      snprintf(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX].<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>,</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[METRIC_CORE_PROPS_ARRAY_INDEX].value),</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;         <span class="stringliteral">&quot;%d&quot;</span>, 1);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>); i++) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;         <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[i], 0, <span class="stringliteral">&quot;eid&quot;</span>, eid_str);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;         <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a>[i]);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div><div class="ttc" id="res__prometheus_8c_html_a02a3a2b23615b19bdc4ab8a9ab396dba"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a></div><div class="ttdeci">int prometheus_metric_unregister(struct prometheus_metric *metric)</div><div class="ttdoc">Remove a registered metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00334">res_prometheus.c:334</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="utils_8h_html_a8ebf6841073ea2a063a0c86a5092a85b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a></div><div class="ttdeci">char * ast_eid_to_str(char *s, int maxlen, struct ast_eid *eid)</div><div class="ttdoc">Convert an EID to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02587">main/utils.c:2587</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_af856435d90c99074a4611c7d91c1e3e0"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#af856435d90c99074a4611c7d91c1e3e0">METRIC_CORE_PROPS_ARRAY_INDEX</a></div><div class="ttdeci">#define METRIC_CORE_PROPS_ARRAY_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00220">res_prometheus.c:220</a></div></div>
<div class="ttc" id="ast__version_8h_html_a7765c608aea948584928643ab3963b2a"><div class="ttname"><a href="../../d5/db9/ast__version_8h.html#a7765c608aea948584928643ab3963b2a">ast_get_version</a></div><div class="ttdeci">const char * ast_get_version(void)</div><div class="ttdoc">Retrieve the Asterisk version string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0b/version_8c_source.html#l00016">version.c:16</a></div></div>
<div class="ttc" id="structglobal__config_html"><div class="ttname"><a href="../../d2/db1/structglobal__config.html">global_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00068">config_global.c:68</a></div></div>
<div class="ttc" id="buildinfo_8h_html_af1708cda257f6db95f77b34f112ef64b"><div class="ttname"><a href="../../de/d35/buildinfo_8h.html#af1708cda257f6db95f77b34f112ef64b">ast_build_date</a></div><div class="ttdeci">const char * ast_build_date</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/buildinfo_8c_source.html#l00033">buildinfo.c:33</a></div></div>
<div class="ttc" id="ast__version_8h_html_a8a80e93d07dd404319c28c0eaa216672"><div class="ttname"><a href="../../d5/db9/ast__version_8h.html#a8a80e93d07dd404319c28c0eaa216672">ast_get_build_opts</a></div><div class="ttdeci">const char * ast_get_build_opts(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0b/version_8c_source.html#l00026">version.c:26</a></div></div>
<div class="ttc" id="buildinfo_8h_html_a00b5464ec2f306ae8f17f73a0a81f28d"><div class="ttname"><a href="../../de/d35/buildinfo_8h.html#a00b5464ec2f306ae8f17f73a0a81f28d">ast_build_os</a></div><div class="ttdeci">const char * ast_build_os</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/buildinfo_8c_source.html#l00032">buildinfo.c:32</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab38f0f4a2a6b16f65dd23d70219ac101"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a></div><div class="ttdeci">static struct ast_http_uri prometheus_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00791">res_prometheus.c:791</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="buildinfo_8h_html_aae3c7406e483c475f34063c84048ab89"><div class="ttname"><a href="../../de/d35/buildinfo_8h.html#aae3c7406e483c475f34063c84048ab89">ast_build_hostname</a></div><div class="ttdeci">const char * ast_build_hostname</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/buildinfo_8c_source.html#l00029">buildinfo.c:29</a></div></div>
<div class="ttc" id="buildinfo_8h_html_af89b2913397f19dc15adb9014bcb5d5a"><div class="ttname"><a href="../../de/d35/buildinfo_8h.html#af89b2913397f19dc15adb9014bcb5d5a">ast_build_kernel</a></div><div class="ttdeci">const char * ast_build_kernel</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/buildinfo_8c_source.html#l00030">buildinfo.c:30</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a127df8440ec5752a07056868c7a470b5"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_SET_LABEL(metric, label, n, v)</div><div class="ttdoc">Convenience macro for setting a label / value in a metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00321">res_prometheus.h:321</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a12a466676f24c8935739be58c2c3aab6"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a></div><div class="ttdeci">int prometheus_metric_register(struct prometheus_metric *metric)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00287">res_prometheus.c:287</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a5edeed6c8470271ed37782ea5ac1a500"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a5edeed6c8470271ed37782ea5ac1a500">core_metrics</a></div><div class="ttdeci">static struct prometheus_metric core_metrics[]</div><div class="ttdoc">Core metrics to scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00224">res_prometheus.c:224</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__http__uri_html_a69ec24fb2d0a5f5e532deb9adaab81d6"><div class="ttname"><a href="../../d0/d6c/structast__http__uri.html#a69ec24fb2d0a5f5e532deb9adaab81d6">ast_http_uri::uri</a></div><div class="ttdeci">const char * uri</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00103">http.h:103</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a8d658c0c628873c1c13a41b3d8076220"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a></div><div class="ttdeci">static struct prometheus_metric core_scrape_metric</div><div class="ttdoc">The scrape duration metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00213">res_prometheus.c:213</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac853a42ee2aaf0e2cb49caa91af83c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac853a42ee2aaf0e2cb49caa91af83c73">&#9670;&nbsp;</a></span>prometheus_config_pre_apply()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int prometheus_config_pre_apply </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pre-apply callback for the config framework. </p>
<p>This validates that required fields exist and are populated. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00804">804</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00103">aco_pending_config()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00290">AST_LOG_ERROR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, and <a class="el" href="../../dc/df2/cdr_8c_source.html#l00223">module_config::general</a>.</p>
<div class="fragment"><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;{</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = <a class="code" href="../../db/dfe/config__options_8h.html#a89d26f05dbb795e34651b889f0864e3a">aco_pending_config</a>(&amp;cfg_info);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   <span class="keywordflow">if</span> (!config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>-&gt;enabled) {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">/* If we&#39;re not enabled, we don&#39;t care about anything else */</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>-&gt;auth_username)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">general</a>-&gt;auth_password)) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;&#39;auth_username&#39; set without a corresponding &#39;auth_password&#39;\n&quot;</span>);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_a2fdd5bff193a29ec6c7278da2851ea56"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a></div><div class="ttdeci">#define AST_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00290">logger.h:290</a></div></div>
<div class="ttc" id="config__options_8h_html_a89d26f05dbb795e34651b889f0864e3a"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a89d26f05dbb795e34651b889f0864e3a">aco_pending_config</a></div><div class="ttdeci">void * aco_pending_config(struct aco_info *info)</div><div class="ttdoc">Get pending config changes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00103">config_options.c:103</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="structmodule__config_html_a95699733ba47a55e25760adf5c51e59a"><div class="ttname"><a href="../../db/d57/structmodule__config.html#a95699733ba47a55e25760adf5c51e59a">module_config::general</a></div><div class="ttdeci">struct ast_cdr_config * general</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00223">cdr.c:223</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8ce4a778dc12b1b14097b3bfd23a248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ce4a778dc12b1b14097b3bfd23a248">&#9670;&nbsp;</a></span>prometheus_counter_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a>* prometheus_counter_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>help</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a malloc'd counter metric. </p>
<dl class="section note"><dt>Note</dt><dd>The metric must be registered after creation</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the metric </td></tr>
    <tr><td class="paramname">help</td><td>Help text for the metric</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../de/d94/structprometheus__metric.html" title="An actual, honest to god, metric. ">prometheus_metric</a></td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00452">452</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00422">prometheus_metric_create()</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00200">prometheus_metric::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   metric = <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a334a70b8df4aae192739359d6e435e6e">prometheus_metric_create</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">help</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">type</a> = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="keywordflow">return</span> metric;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="structprometheus__metric_html_aeefacacbfc41d8efd691e0fd6babeb38"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">prometheus_metric::type</a></div><div class="ttdeci">enum prometheus_metric_type type</div><div class="ttdoc">What type of metric we are. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00200">res_prometheus.h:200</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a334a70b8df4aae192739359d6e435e6e"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a334a70b8df4aae192739359d6e435e6e">prometheus_metric_create</a></div><div class="ttdeci">static struct prometheus_metric * prometheus_metric_create(const char *name, const char *help)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00422">res_prometheus.c:422</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ad7ec84b4d1c84a2d1af0c0de9ea5b86f"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">prometheus_metric::help</a></div><div class="ttdeci">const char * help</div><div class="ttdoc">Pointer to a static string defining this metric&amp;#39;s help text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00214">res_prometheus.h:214</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a437e2859b1d632b1ee413bad2c42db52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437e2859b1d632b1ee413bad2c42db52">&#9670;&nbsp;</a></span>prometheus_gauge_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a>* prometheus_gauge_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>help</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a malloc'd gauge metric. </p>
<dl class="section note"><dt>Note</dt><dd>The metric must be registered after creation</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the metric </td></tr>
    <tr><td class="paramname">help</td><td>Help text for the metric</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../de/d94/structprometheus__metric.html" title="An actual, honest to god, metric. ">prometheus_metric</a></td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00439">439</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00422">prometheus_metric_create()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00132">PROMETHEUS_METRIC_GAUGE</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00200">prometheus_metric::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00267">registry_message_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   metric = <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a334a70b8df4aae192739359d6e435e6e">prometheus_metric_create</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">help</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">type</a> = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">return</span> metric;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metric_html_aeefacacbfc41d8efd691e0fd6babeb38"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">prometheus_metric::type</a></div><div class="ttdeci">enum prometheus_metric_type type</div><div class="ttdoc">What type of metric we are. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00200">res_prometheus.h:200</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a334a70b8df4aae192739359d6e435e6e"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a334a70b8df4aae192739359d6e435e6e">prometheus_metric_create</a></div><div class="ttdeci">static struct prometheus_metric * prometheus_metric_create(const char *name, const char *help)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00422">res_prometheus.c:422</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ad7ec84b4d1c84a2d1af0c0de9ea5b86f"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">prometheus_metric::help</a></div><div class="ttdeci">const char * help</div><div class="ttdoc">Pointer to a static string defining this metric&amp;#39;s help text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00214">res_prometheus.h:214</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00132">res_prometheus.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbfa9427d40e32fe0111a3746d95133c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbfa9427d40e32fe0111a3746d95133c">&#9670;&nbsp;</a></span>prometheus_general_config_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* prometheus_general_config_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new configuration object. </p>
<p>The returned object is an AO2 ref counted object</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
    <tr><td class="paramname">config</td><td>on success </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00726">726</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00353">ast_string_field_init</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00719">prometheus_general_config_dtor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">config_alloc()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00773">module_config_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;{</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   config = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*config), <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a4226c5e9ffbee3d34714aaabd6c5c848">prometheus_general_config_dtor</a>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="keywordflow">if</span> (!config || <a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(config, 32)) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a4226c5e9ffbee3d34714aaabd6c5c848"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a4226c5e9ffbee3d34714aaabd6c5c848">prometheus_general_config_dtor</a></div><div class="ttdeci">static void prometheus_general_config_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00719">res_prometheus.c:719</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4226c5e9ffbee3d34714aaabd6c5c848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4226c5e9ffbee3d34714aaabd6c5c848">&#9670;&nbsp;</a></span>prometheus_general_config_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prometheus_general_config_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00719">719</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00368">ast_string_field_free_memory</a>, and <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00726">prometheus_general_config_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = obj;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(config);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62b2557ffd682d4efec2d3094a01d104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b2557ffd682d4efec2d3094a01d104">&#9670;&nbsp;</a></span>prometheus_general_config_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>* prometheus_general_config_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the current configuration of the module. </p>
<dl class="section note"><dt>Note</dt><dd>This should primarily be done for testing purposes.</dd></dl>
<p>config is an AO2 ref counted object</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
    <tr><td class="paramname">config</td><td>on success </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00738">738</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00063">prometheus_show_status()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00910">reload_module()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">test_init_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *, mod_cfg, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d2/db1/structglobal__config.html">global_config</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">if</span> (!mod_cfg) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(mod_cfg-&gt;general);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="keywordflow">return</span> mod_cfg-&gt;general;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div><div class="ttc" id="structglobal__config_html"><div class="ttname"><a href="../../d2/db1/structglobal__config.html">global_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00068">config_global.c:68</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25507755e82d34f73b054fac5087d582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25507755e82d34f73b054fac5087d582">&#9670;&nbsp;</a></span>prometheus_general_config_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prometheus_general_config_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the configuration for the module. </p>
<dl class="section note"><dt>Note</dt><dd>This should primarily be done for testing purposes</dd></dl>
<p>This is not a ref-stealing function. The reference count to <code>config</code> will be incremented as a result of calling this method. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">750</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00827">prometheus_config_post_apply()</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00520">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00768">test_cleanup_cb()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">test_init_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;{</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d57/structmodule__config.html">module_config</a> *, mod_cfg, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d2/db1/structglobal__config.html">global_config</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="keywordflow">if</span> (!mod_cfg) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(mod_cfg-&gt;general, config);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a525b72c6fbe7e11eaeb5a0b279d0014d">prometheus_config_post_apply</a>();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div><div class="ttc" id="structglobal__config_html"><div class="ttname"><a href="../../d2/db1/structglobal__config.html">global_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00068">config_global.c:68</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a525b72c6fbe7e11eaeb5a0b279d0014d"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a525b72c6fbe7e11eaeb5a0b279d0014d">prometheus_config_post_apply</a></div><div class="ttdeci">static void prometheus_config_post_apply(void)</div><div class="ttdoc">Post-apply callback for the config framework. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00827">res_prometheus.c:827</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0b9fac7324225a514f786b91b7c66e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b9fac7324225a514f786b91b7c66e3">&#9670;&nbsp;</a></span>prometheus_last_scrape_duration_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t prometheus_last_scrape_duration_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the amount of time it took to perform the last scrape. </p>
<p>Time returned is in milliseconds</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>scrape duration, in milliseconds </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00701">701</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00063">prometheus_show_status()</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   int64_t duration;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordflow">if</span> (sscanf(<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a>.<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>, <span class="stringliteral">&quot;%&quot;</span> PRIu64, &amp;duration) != 1) {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keywordflow">return</span> duration;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a8d658c0c628873c1c13a41b3d8076220"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a8d658c0c628873c1c13a41b3d8076220">core_scrape_metric</a></div><div class="ttdeci">static struct prometheus_metric core_scrape_metric</div><div class="ttdoc">The scrape duration metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00213">res_prometheus.c:213</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a81b00149e0574228e695029439f842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a81b00149e0574228e695029439f842">&#9670;&nbsp;</a></span>prometheus_last_scrape_time_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval prometheus_last_scrape_time_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the timestamp when the last scrape occurred. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>time when the last scrape occurred </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00712">712</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00063">prometheus_show_status()</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="keywordflow">return</span> last_scrape;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div><div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91f12e3c3321fe61700762cea21e0974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f12e3c3321fe61700762cea21e0974">&#9670;&nbsp;</a></span>prometheus_metric_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int prometheus_metric_cmp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00252">252</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00222">prometheus_metric::labels</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00158">prometheus_label::name</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00039">PROMETHEUS_MAX_LABELS</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00162">prometheus_label::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">prometheus_metric_register()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Comparison: Names %s == %s\n&quot;</span>, left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="keywordflow">if</span> (strcmp(left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>)) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/db1/res__prometheus_8h.html#ab0a3c3feb485592fc9c07a801a0560af">PROMETHEUS_MAX_LABELS</a>; i++) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Comparison: Label %d Names %s == %s\n&quot;</span>, i,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span> (strcmp(left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>)) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Comparison: Label %d Values %s == %s\n&quot;</span>, i,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">value</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">value</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">if</span> (strcmp(left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">value</a>, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">value</a>)) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Copmarison: %s (%p) is equal to %s (%p)\n&quot;</span>,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      left-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, left, right-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, right);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_ab0a3c3feb485592fc9c07a801a0560af"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#ab0a3c3feb485592fc9c07a801a0560af">PROMETHEUS_MAX_LABELS</a></div><div class="ttdeci">#define PROMETHEUS_MAX_LABELS</div><div class="ttdoc">How many labels a single metric can have. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00039">res_prometheus.h:39</a></div></div>
<div class="ttc" id="structprometheus__label_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_label::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">The name of the label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00158">res_prometheus.h:158</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a66c2c891e92a03115c64177cb09bc96b"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">prometheus_metric::labels</a></div><div class="ttdeci">struct prometheus_label labels[PROMETHEUS_MAX_LABELS]</div><div class="ttdoc">The metric&amp;#39;s labels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00222">res_prometheus.h:222</a></div></div>
<div class="ttc" id="structprometheus__label_html_a3e07ee12d0edfc6d924e1b92f9176dfb"><div class="ttname"><a href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">prometheus_label::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_LABEL_LENGTH]</div><div class="ttdoc">The value of the label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00162">res_prometheus.h:162</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a334a70b8df4aae192739359d6e435e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a334a70b8df4aae192739359d6e435e6e">&#9670;&nbsp;</a></span>prometheus_metric_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a>* prometheus_metric_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>help</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00422">422</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00204">prometheus_metric::allocation_strategy</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00184">ast_mutex_init</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00214">prometheus_metric::help</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00210">prometheus_metric::lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00148">PROMETHEUS_METRIC_MALLOCD</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00452">prometheus_counter_create()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00439">prometheus_gauge_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   metric = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*metric));</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aa794b1bff0439ba630beb00ef1e37f58">allocation_strategy</a> = <a class="code" href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="keyword">sizeof</span>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>));</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">help</a> = <a class="code" href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">help</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">return</span> metric;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metric_html_aa794b1bff0439ba630beb00ef1e37f58"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#aa794b1bff0439ba630beb00ef1e37f58">prometheus_metric::allocation_strategy</a></div><div class="ttdeci">enum prometheus_metric_allocation_strategy allocation_strategy</div><div class="ttdoc">How this metric was allocated. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00204">res_prometheus.h:204</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ad7ec84b4d1c84a2d1af0c0de9ea5b86f"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">prometheus_metric::help</a></div><div class="ttdeci">const char * help</div><div class="ttdoc">Pointer to a static string defining this metric&amp;#39;s help text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00214">res_prometheus.h:214</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structprometheus__metric_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">prometheus_metric::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdoc">A lock protecting the metric value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00210">res_prometheus.h:210</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a></div><div class="ttdoc">The metric was allocated on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00148">res_prometheus.h:148</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8409a6e51c0e44c5802261465034a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8409a6e51c0e44c5802261465034a57">&#9670;&nbsp;</a></span>prometheus_metric_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prometheus_metric_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy a metric and all its children. </p>
<dl class="section note"><dt>Note</dt><dd>If you still want the children, make sure you remove the head of the <code>children</code> list first.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metric</td><td>The metric to destroy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00392">392</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00204">prometheus_metric::allocation_strategy</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00186">ast_mutex_destroy</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00210">prometheus_metric::lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00144">PROMETHEUS_METRIC_ALLOCD</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00148">PROMETHEUS_METRIC_MALLOCD</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">prometheus_metric_free_wrapper()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00876">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *child;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">while</span> ((child = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, <a class="code" href="../../d3/d96/structentry.html">entry</a>))) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(child);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">if</span> (metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aa794b1bff0439ba630beb00ef1e37f58">allocation_strategy</a> == <a class="code" href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998bea47d88bb314e407697d9574a2735221ab">PROMETHEUS_METRIC_ALLOCD</a>) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aa794b1bff0439ba630beb00ef1e37f58">allocation_strategy</a> == <a class="code" href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a>) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(metric);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metric_html_aa794b1bff0439ba630beb00ef1e37f58"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#aa794b1bff0439ba630beb00ef1e37f58">prometheus_metric::allocation_strategy</a></div><div class="ttdeci">enum prometheus_metric_allocation_strategy allocation_strategy</div><div class="ttdoc">How this metric was allocated. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00204">res_prometheus.h:204</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_af1732dbbefdac1b3c42ff4e86a9998bea47d88bb314e407697d9574a2735221ab"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998bea47d88bb314e407697d9574a2735221ab">PROMETHEUS_METRIC_ALLOCD</a></div><div class="ttdoc">The metric was allocated on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00144">res_prometheus.h:144</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structprometheus__metric_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">prometheus_metric::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdoc">A lock protecting the metric value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00210">res_prometheus.h:210</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a></div><div class="ttdoc">The metric was allocated on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00148">res_prometheus.h:148</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab8409a6e51c0e44c5802261465034a57"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a></div><div class="ttdeci">void prometheus_metric_free(struct prometheus_metric *metric)</div><div class="ttdoc">Destroy a metric and all its children. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00392">res_prometheus.c:392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2efa631e53b5ece9e87b1df3a0a40e10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2efa631e53b5ece9e87b1df3a0a40e10">&#9670;&nbsp;</a></span>prometheus_metric_full_to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prometheus_metric_full_to_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00485">485</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00222">prometheus_metric::labels</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00158">prometheus_label::name</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00039">PROMETHEUS_MAX_LABELS</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00162">prometheus_label::value</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordtype">int</span> labels_exist = 0;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;%s&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/db1/res__prometheus_8h.html#ab0a3c3feb485592fc9c07a801a0560af">PROMETHEUS_MAX_LABELS</a>; i++) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>)) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         labels_exist = 1;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         <span class="keywordflow">if</span> (i == 0) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;{&quot;</span>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;%s=\&quot;%s\&quot;&quot;</span>,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">name</a>,</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">labels</a>[i].<a class="code" href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">value</a>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="keywordflow">if</span> (labels_exist) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">    * If no value exists, put in a 0. That ensures we don&#39;t anger Prometheus.</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>)) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot; 0\n&quot;</span>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot; %s\n&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_ab0a3c3feb485592fc9c07a801a0560af"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#ab0a3c3feb485592fc9c07a801a0560af">PROMETHEUS_MAX_LABELS</a></div><div class="ttdeci">#define PROMETHEUS_MAX_LABELS</div><div class="ttdoc">How many labels a single metric can have. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00039">res_prometheus.h:39</a></div></div>
<div class="ttc" id="structprometheus__label_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../d5/d5b/structprometheus__label.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_label::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">The name of the label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00158">res_prometheus.h:158</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a66c2c891e92a03115c64177cb09bc96b"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a66c2c891e92a03115c64177cb09bc96b">prometheus_metric::labels</a></div><div class="ttdeci">struct prometheus_label labels[PROMETHEUS_MAX_LABELS]</div><div class="ttdoc">The metric&amp;#39;s labels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00222">res_prometheus.h:222</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
<div class="ttc" id="structprometheus__label_html_a3e07ee12d0edfc6d924e1b92f9176dfb"><div class="ttname"><a href="../../d5/d5b/structprometheus__label.html#a3e07ee12d0edfc6d924e1b92f9176dfb">prometheus_label::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_LABEL_LENGTH]</div><div class="ttdoc">The value of the label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00162">res_prometheus.h:162</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a12a466676f24c8935739be58c2c3aab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12a466676f24c8935739be58c2c3aab6">&#9670;&nbsp;</a></span>prometheus_metric_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prometheus_metric_register </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a metric for collection</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metric</td><td>The metric to register</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">287</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00268">AST_LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00279">AST_LOG_WARNING</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00252">prometheus_metric_cmp()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00827">prometheus_config_post_apply()</a>, and <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00267">registry_message_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;metrics); i++) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *existing = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;metrics, i);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *child;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a>(existing, metric)) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="stringliteral">&quot;Refusing registration of existing Prometheus metric: %s\n&quot;</span>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, child, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a>(child, metric)) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               <span class="stringliteral">&quot;Refusing registration of existing Prometheus metric: %s\n&quot;</span>,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;               metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">if</span> (!strcmp(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>)) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Nesting metric &#39;%s&#39; as child (%p) under existing (%p)\n&quot;</span>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, metric, existing);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, metric, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Tracking new root metric &#39;%s&#39;\n&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;metrics, metric)) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to grow vector to make room for Prometheus metric: %s\n&quot;</span>,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="logger_8h_html_ad6810d73cb786e5e74c55c8bd8688e05"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a></div><div class="ttdeci">#define AST_LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00268">logger.h:268</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a91f12e3c3321fe61700762cea21e0974"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a></div><div class="ttdeci">static int prometheus_metric_cmp(struct prometheus_metric *left, struct prometheus_metric *right)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00252">res_prometheus.c:252</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a152734c2aa84df297edd115b921e6906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a152734c2aa84df297edd115b921e6906">&#9670;&nbsp;</a></span>prometheus_metric_registered_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prometheus_metric_registered_count </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The current number of registered metrics</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>current number of registered metrics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00280">280</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;metrics);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd25ff5603091eef2d7bf3fed8f7474a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd25ff5603091eef2d7bf3fed8f7474a">&#9670;&nbsp;</a></span>prometheus_metric_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prometheus_metric_to_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a metric (and its children) into Prometheus compatible text. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metric</td><td>The metric to convert to a string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>The <code><a class="el" href="../../dd/da2/structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...">ast_str</a></code> string to populate with the metric(s) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">521</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00214">prometheus_metric::help</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00485">prometheus_metric_full_to_string()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00465">prometheus_metric_type_to_string()</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00200">prometheus_metric::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00354">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00078">bridges_scrape_cb()</a>, <a class="el" href="../../df/d8d/channels_8c_source.html#l00130">channels_scrape_cb()</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00097">endpoints_scrape_cb()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00593">http_callback()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00191">prometheus_metric_callback()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00563">scrape_metrics()</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *child;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;# HELP %s %s\n&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">help</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(output, 0, <span class="stringliteral">&quot;# TYPE %s %s\n&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#abeadb37bd14fc6df8821b9134613c341">prometheus_metric_type_to_string</a>(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">type</a>));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a2efa631e53b5ece9e87b1df3a0a40e10">prometheus_metric_full_to_string</a>(metric, output);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, child, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a2efa631e53b5ece9e87b1df3a0a40e10">prometheus_metric_full_to_string</a>(child, output);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metric_html_aeefacacbfc41d8efd691e0fd6babeb38"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#aeefacacbfc41d8efd691e0fd6babeb38">prometheus_metric::type</a></div><div class="ttdeci">enum prometheus_metric_type type</div><div class="ttdoc">What type of metric we are. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00200">res_prometheus.h:200</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a2efa631e53b5ece9e87b1df3a0a40e10"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a2efa631e53b5ece9e87b1df3a0a40e10">prometheus_metric_full_to_string</a></div><div class="ttdeci">static void prometheus_metric_full_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00485">res_prometheus.c:485</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ad7ec84b4d1c84a2d1af0c0de9ea5b86f"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ad7ec84b4d1c84a2d1af0c0de9ea5b86f">prometheus_metric::help</a></div><div class="ttdeci">const char * help</div><div class="ttdoc">Pointer to a static string defining this metric&amp;#39;s help text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00214">res_prometheus.h:214</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_abeadb37bd14fc6df8821b9134613c341"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#abeadb37bd14fc6df8821b9134613c341">prometheus_metric_type_to_string</a></div><div class="ttdeci">static const char * prometheus_metric_type_to_string(enum prometheus_metric_type type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00465">res_prometheus.c:465</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abeadb37bd14fc6df8821b9134613c341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeadb37bd14fc6df8821b9134613c341">&#9670;&nbsp;</a></span>prometheus_metric_type_to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* prometheus_metric_type_to_string </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932">prometheus_metric_type</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00465">465</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00132">PROMETHEUS_METRIC_GAUGE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>:</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;counter&quot;</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>:</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;gauge&quot;</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00132">res_prometheus.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02a3a2b23615b19bdc4ab8a9ab396dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02a3a2b23615b19bdc4ab8a9ab396dba">&#9670;&nbsp;</a></span>prometheus_metric_unregister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prometheus_metric_unregister </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a registered metric. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metric</td><td>The metric to unregister</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Unregistering also destroys the metric, if found</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The metric was found, unregistered, and disposed of </td></tr>
    <tr><td class="paramname">-1</td><td>The metric was not found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">334</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00338">AST_VECTOR_INSERT_AT</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00412">AST_VECTOR_REMOVE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00218">prometheus_metric::name</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00252">prometheus_metric_cmp()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00392">prometheus_metric_free()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00827">prometheus_config_post_apply()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">prometheus_metric_free_wrapper()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00151">registration_deleted_observer()</a>, and <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00212">registration_loaded_observer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Removing metric &#39;%s&#39;\n&quot;</span>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;metrics); i++) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *existing = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;metrics, i);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">          * If this is a complete match, remove the matching metric</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">          * and place its children back into the list</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a>(existing, metric)) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *root;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <a class="code" href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a>(&amp;metrics, i, 1);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            root = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">if</span> (root) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;               <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *child;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, child, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;root-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, child, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;               }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               <a class="code" href="../../d6/d68/vector_8h.html#a341e85fccd22eb03cc2b0dd47188f821">AST_VECTOR_INSERT_AT</a>(&amp;metrics, i, root);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(existing);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">          * Name match, but labels don&#39;t match. Find the matching entry with</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">          * labels and remove it along with all of its children</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         <span class="keywordflow">if</span> (!strcmp(existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>, metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">name</a>)) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *child;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;existing-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, child, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a>(child, metric)) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                  <a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(child);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;               }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a11962b292869f13ae7f8c28f99b800fa"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a11962b292869f13ae7f8c28f99b800fa">prometheus_metric::name</a></div><div class="ttdeci">char name[PROMETHEUS_MAX_NAME_LENGTH]</div><div class="ttdoc">Our metric name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00218">res_prometheus.h:218</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a91f12e3c3321fe61700762cea21e0974"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a91f12e3c3321fe61700762cea21e0974">prometheus_metric_cmp</a></div><div class="ttdeci">static int prometheus_metric_cmp(struct prometheus_metric *left, struct prometheus_metric *right)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00252">res_prometheus.c:252</a></div></div>
<div class="ttc" id="vector_8h_html_a341e85fccd22eb03cc2b0dd47188f821"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a341e85fccd22eb03cc2b0dd47188f821">AST_VECTOR_INSERT_AT</a></div><div class="ttdeci">#define AST_VECTOR_INSERT_AT(vec, idx, elem)</div><div class="ttdoc">Insert an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00338">vector.h:338</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab8409a6e51c0e44c5802261465034a57"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a></div><div class="ttdeci">void prometheus_metric_free(struct prometheus_metric *metric)</div><div class="ttdoc">Destroy a metric and all its children. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00392">res_prometheus.c:392</a></div></div>
<div class="ttc" id="vector_8h_html_abe6d979239bef1a97d069b1a10c7d35c"><div class="ttname"><a href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE(vec, idx, preserve_ordered)</div><div class="ttdoc">Remove an element from a vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00412">vector.h:412</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9324bd9603be11341b0d982095a2c50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9324bd9603be11341b0d982095a2c50">&#9670;&nbsp;</a></span>prometheus_metrics_provider_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prometheus_metrics_provider_register </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a> *&#160;</td>
          <td class="paramname"><em>provider</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a metrics provider. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">provider</td><td>The provider function table to register </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00871">871</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, and <a class="el" href="../../d9/de9/res__phoneprov_8c_source.html#l00272">providers</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00183">bridge_metrics_init()</a>, <a class="el" href="../../df/d8d/channels_8c_source.html#l00241">channel_metrics_init()</a>, <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00137">cli_init()</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00198">endpoint_metrics_init()</a>, and <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00342">pjsip_outbound_registration_metrics_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;{</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>, provider);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_ade65b780dfb3ed391547716236573f6b"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a></div><div class="ttdeci">struct ao2_container * providers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00272">res_phoneprov.c:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77a98b32e9e582d8fc6e0e5a4b7947af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a98b32e9e582d8fc6e0e5a4b7947af">&#9670;&nbsp;</a></span>prometheus_scrape_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a>* prometheus_scrape_to_string </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the raw output of what a scrape would produce. </p>
<p>It can be useful to dump what a scrape will look like. This function returns the raw string representation of the metrics.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
    <tr><td class="paramname">Malloc'd</td><td><a class="el" href="../../dd/da2/structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...">ast_str</a> on success </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00685">685</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00563">scrape_metrics()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/db8/res_2prometheus_2cli_8c_source.html#l00033">prometheus_show_metrics()</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;{</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *response;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   response = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(512);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="keywordflow">if</span> (!response) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <a class="code" href="../../d7/d1b/res__prometheus_8c.html#af0bf9da827c93bf5d2eb27e80e642517">scrape_metrics</a>(&amp;response);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">return</span> response;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_af0bf9da827c93bf5d2eb27e80e642517"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#af0bf9da827c93bf5d2eb27e80e642517">scrape_metrics</a></div><div class="ttdeci">static void scrape_metrics(struct ast_str **response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00563">res_prometheus.c:563</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00910">910</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00652">aco_process_config()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00527">ACO_PROCESS_ERROR</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00673">ast_http_uri_link()</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00705">ast_http_uri_unlink()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00279">AST_LOG_WARNING</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00100">prometheus_metrics_provider::name</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00738">prometheus_general_config_get()</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00178">provider</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c_source.html#l00272">providers</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00109">prometheus_metrics_provider::reload_cb</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00945">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                               {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *general_config;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a>(&amp;cfg_info, 1) == <a class="code" href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a>) {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   <span class="comment">/* Our config should be all reloaded now */</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   general_config = <a class="code" href="../../d7/d1b/res__prometheus_8c.html#a62b2557ffd682d4efec2d3094a01d104">prometheus_general_config_get</a>();</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>); i++) {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a> *<a class="code" href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a> = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>, i);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">if</span> (!provider-&gt;<a class="code" href="../../d1/d64/structprometheus__metrics__provider.html#a8cff7618c8187ee8d85f13fa2bf8d513">reload_cb</a>) {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">if</span> (provider-&gt;<a class="code" href="../../d1/d64/structprometheus__metrics__provider.html#a8cff7618c8187ee8d85f13fa2bf8d513">reload_cb</a>(general_config)) {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to reload metrics provider %s\n&quot;</span>, provider-&gt;<a class="code" href="../../d1/d64/structprometheus__metrics__provider.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(general_config, -1);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(general_config, -1);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>)) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to re-register Prometheus Metrics URI during reload\n&quot;</span>);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div><div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a62b2557ffd682d4efec2d3094a01d104"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a62b2557ffd682d4efec2d3094a01d104">prometheus_general_config_get</a></div><div class="ttdeci">struct prometheus_general_config * prometheus_general_config_get(void)</div><div class="ttdoc">Retrieve the current configuration of the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00738">res_prometheus.c:738</a></div></div>
<div class="ttc" id="http_8h_html_ac99d56925cf94f8cf3ed0acac52e2d75"><div class="ttname"><a href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a></div><div class="ttdeci">int ast_http_uri_link(struct ast_http_uri *urihandler)</div><div class="ttdoc">Register a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00673">http.c:673</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="http_8h_html_a33e436ed8aeb33287f1e6cb1c5288a14"><div class="ttname"><a href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a></div><div class="ttdeci">void ast_http_uri_unlink(struct ast_http_uri *urihandler)</div><div class="ttdoc">Unregister a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00705">http.c:705</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab38f0f4a2a6b16f65dd23d70219ac101"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a></div><div class="ttdeci">static struct ast_http_uri prometheus_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00791">res_prometheus.c:791</a></div></div>
<div class="ttc" id="config__options_8h_html_af28935f8c2547723d5922ebed1c71898"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a></div><div class="ttdeci">enum aco_process_status aco_process_config(struct aco_info *info, int reload)</div><div class="ttdoc">Process a config info via the options registered with an aco_info. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00652">config_options.c:652</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_ade65b780dfb3ed391547716236573f6b"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a></div><div class="ttdeci">struct ao2_container * providers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00272">res_phoneprov.c:272</a></div></div>
<div class="ttc" id="config__options_8h_html_a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a></div><div class="ttdoc">Their was an error and no changes were applied. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00527">config_options.h:527</a></div></div>
<div class="ttc" id="structprometheus__metrics__provider_html_a8cff7618c8187ee8d85f13fa2bf8d513"><div class="ttname"><a href="../../d1/d64/structprometheus__metrics__provider.html#a8cff7618c8187ee8d85f13fa2bf8d513">prometheus_metrics_provider::reload_cb</a></div><div class="ttdeci">int(*const reload_cb)(struct prometheus_general_config *config)</div><div class="ttdoc">Reload callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00109">res_prometheus.h:109</a></div></div>
<div class="ttc" id="structprometheus__metrics__provider_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d1/d64/structprometheus__metrics__provider.html#a8f8f80d37794cde9472343e4487ba3eb">prometheus_metrics_provider::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">Handy name of the provider for debugging purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00100">res_prometheus.h:100</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structprometheus__metrics__provider_html"><div class="ttname"><a href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a></div><div class="ttdoc">A function table for a metrics provider. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00096">res_prometheus.h:96</a></div></div>
<div class="ttc" id="bridges_8c_html_ab1760b9a6a6c8d063d49ab9b5bcdfa49"><div class="ttname"><a href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a></div><div class="ttdeci">static struct prometheus_metrics_provider provider</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/bridges_8c_source.html#l00178">bridges.c:178</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0bf9da827c93bf5d2eb27e80e642517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0bf9da827c93bf5d2eb27e80e642517">&#9670;&nbsp;</a></span>scrape_metrics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void scrape_metrics </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>response</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00563">563</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00421">prometheus_callback::callback_fn</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00237">prometheus_metric::get_metric_value</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00210">prometheus_metric::lock</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00593">http_callback()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00685">prometheus_scrape_to_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;callbacks); i++) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> *callback = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;callbacks, i);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">if</span> (!callback) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      callback-&gt;<a class="code" href="../../d5/d3d/structprometheus__callback.html#a9fb6e51a66967a6bda60805952b124a3">callback_fn</a>(response);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;metrics); i++) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;metrics, i);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">if</span> (!metric) {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">if</span> (metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a70a0c038284d1c128450fa59842c2fea">get_metric_value</a>) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;         metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#a70a0c038284d1c128450fa59842c2fea">get_metric_value</a>(metric);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a>(metric, response);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metric_html_a70a0c038284d1c128450fa59842c2fea"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#a70a0c038284d1c128450fa59842c2fea">prometheus_metric::get_metric_value</a></div><div class="ttdeci">void(* get_metric_value)(struct prometheus_metric *metric)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00237">res_prometheus.h:237</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="structprometheus__callback_html_a9fb6e51a66967a6bda60805952b124a3"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html#a9fb6e51a66967a6bda60805952b124a3">prometheus_callback::callback_fn</a></div><div class="ttdeci">void(* callback_fn)(struct ast_str **output)</div><div class="ttdoc">The callback function to invoke. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00421">res_prometheus.h:421</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_abd25ff5603091eef2d7bf3fed8f7474a"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a></div><div class="ttdeci">void prometheus_metric_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdoc">Convert a metric (and its children) into Prometheus compatible text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00521">res_prometheus.c:521</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structprometheus__metric_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#adf04f66344e3fb0a6f6a69bf39d19902">prometheus_metric::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdoc">A lock protecting the metric value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00210">res_prometheus.h:210</a></div></div>
<div class="ttc" id="structprometheus__callback_html"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a></div><div class="ttdoc">Defines a callback that will be invoked when the HTTP route is called. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00413">res_prometheus.h:413</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00876">876</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00910">aco_info_destroy()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00865">ao2_global_obj_release</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00705">ast_http_uri_unlink()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00392">prometheus_metric_free()</a>, <a class="el" href="../../d8/d3a/bridges_8c_source.html#l00178">provider</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c_source.html#l00272">providers</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00587">SCOPED_MUTEX</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">scrape_lock</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00113">prometheus_metrics_provider::unload_cb</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00945">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a>);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>); i++) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a> *<a class="code" href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a> = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>, i);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">if</span> (!provider-&gt;<a class="code" href="../../d1/d64/structprometheus__metrics__provider.html#a28e02509299bdd017eef3d64a1ceb9ef">unload_cb</a>) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      provider-&gt;<a class="code" href="../../d1/d64/structprometheus__metrics__provider.html#a28e02509299bdd017eef3d64a1ceb9ef">unload_cb</a>();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;metrics); i++) {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;metrics, i);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <a class="code" href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(metric);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;metrics);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;callbacks);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a>);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a>(&amp;cfg_info);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(<a class="code" href="../../d2/db1/structglobal__config.html">global_config</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="structprometheus__metrics__provider_html_a28e02509299bdd017eef3d64a1ceb9ef"><div class="ttname"><a href="../../d1/d64/structprometheus__metrics__provider.html#a28e02509299bdd017eef3d64a1ceb9ef">prometheus_metrics_provider::unload_cb</a></div><div class="ttdeci">void(*const unload_cb)(void)</div><div class="ttdoc">Unload callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00113">res_prometheus.h:113</a></div></div>
<div class="ttc" id="structglobal__config_html"><div class="ttname"><a href="../../d2/db1/structglobal__config.html">global_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00068">config_global.c:68</a></div></div>
<div class="ttc" id="http_8h_html_a33e436ed8aeb33287f1e6cb1c5288a14"><div class="ttname"><a href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a></div><div class="ttdeci">void ast_http_uri_unlink(struct ast_http_uri *urihandler)</div><div class="ttdoc">Unregister a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00705">http.c:705</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab38f0f4a2a6b16f65dd23d70219ac101"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab38f0f4a2a6b16f65dd23d70219ac101">prometheus_uri</a></div><div class="ttdeci">static struct ast_http_uri prometheus_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00791">res_prometheus.c:791</a></div></div>
<div class="ttc" id="lock_8h_html_ab13590ad27fac3b9c7c7b792c603c9b3"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab13590ad27fac3b9c7c7b792c603c9b3">SCOPED_MUTEX</a></div><div class="ttdeci">#define SCOPED_MUTEX(varname, lock)</div><div class="ttdoc">scoped lock specialization for mutexes </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00587">lock.h:587</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_ade65b780dfb3ed391547716236573f6b"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#ade65b780dfb3ed391547716236573f6b">providers</a></div><div class="ttdeci">struct ao2_container * providers</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00272">res_phoneprov.c:272</a></div></div>
<div class="ttc" id="config__options_8h_html_a21b11339ca4d0b1167c956a9f816bd19"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a></div><div class="ttdeci">void aco_info_destroy(struct aco_info *info)</div><div class="ttdoc">Destroy an initialized aco_info struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00910">config_options.c:910</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_a52907b32ce3af257e0ae090387c51545"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#a52907b32ce3af257e0ae090387c51545">scrape_lock</a></div><div class="ttdeci">static ast_mutex_t scrape_lock</div><div class="ttdoc">Lock that protects data structures during an HTTP scrape. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00136">res_prometheus.c:136</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structprometheus__metrics__provider_html"><div class="ttname"><a href="../../d1/d64/structprometheus__metrics__provider.html">prometheus_metrics_provider</a></div><div class="ttdoc">A function table for a metrics provider. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00096">res_prometheus.h:96</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_ab8409a6e51c0e44c5802261465034a57"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a></div><div class="ttdeci">void prometheus_metric_free(struct prometheus_metric *metric)</div><div class="ttdoc">Destroy a metric and all its children. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00392">res_prometheus.c:392</a></div></div>
<div class="ttc" id="bridges_8c_html_ab1760b9a6a6c8d063d49ab9b5bcdfa49"><div class="ttname"><a href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a></div><div class="ttdeci">static struct prometheus_metrics_provider provider</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/bridges_8c_source.html#l00178">bridges.c:178</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;Asterisk Prometheus Module&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a9f8870a5687abe3d9a6b0b3fbc89a800">AST_MODULE_SUPPORT_EXTENDED</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .load_pri = <a class="el" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a1d1eb207e01a2d3bf6aa6ba271c27dee">AST_MODPRI_DEFAULT</a>, #ifdef 1 .requires = &quot;res_pjsip&quot;, #endif }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a5edeed6c8470271ed37782ea5ac1a500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5edeed6c8470271ed37782ea5ac1a500">&#9670;&nbsp;</a></span>core_metrics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> core_metrics[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core metrics to scrape. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00224">224</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a8d658c0c628873c1c13a41b3d8076220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d658c0c628873c1c13a41b3d8076220">&#9670;&nbsp;</a></span>core_scrape_metric</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> core_scrape_metric</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The scrape duration metric. </p>
<p>This metric is special in that it should never be registered. Instead, the HTTP callback function that walks the metrics will always populate this metric explicitly if core metrics are enabled. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00213">213</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="aeab1543f7ac14f52ba5148960429e849"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab1543f7ac14f52ba5148960429e849">&#9670;&nbsp;</a></span>global_option</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d71/structaco__type.html">aco_type</a> global_option</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00152">152</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a05b71d76cff3ccd9fe2a0c4a16d21271"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b71d76cff3ccd9fe2a0c4a16d21271">&#9670;&nbsp;</a></span>global_options</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d71/structaco__type.html">aco_type</a>* global_options[] = <a class="el" href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a>(&amp;<a class="el" href="../../dc/d6b/res__xmpp_8c.html#aeab1543f7ac14f52ba5148960429e849">global_option</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00160">160</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="ac8330cf9666b8a458ae64845333bff62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8330cf9666b8a458ae64845333bff62">&#9670;&nbsp;</a></span>prometheus_conf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d9c/structaco__file.html">aco_file</a> prometheus_conf</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .filename = <span class="stringliteral">&quot;prometheus.conf&quot;</span>,</div><div class="line">   .types = <a class="code" href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a>(&amp;<a class="code" href="../../d7/d1b/res__prometheus_8c.html#aeab1543f7ac14f52ba5148960429e849">global_option</a>),</div><div class="line">}</div><div class="ttc" id="config__options_8h_html_af773eedd7f94d718752798605c687c4b"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a></div><div class="ttdeci">#define ACO_TYPES(...)</div><div class="ttdoc">A helper macro to ensure that aco_info types always have a sentinel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00181">config_options.h:181</a></div></div>
<div class="ttc" id="res__prometheus_8c_html_aeab1543f7ac14f52ba5148960429e849"><div class="ttname"><a href="../../d7/d1b/res__prometheus_8c.html#aeab1543f7ac14f52ba5148960429e849">global_option</a></div><div class="ttdeci">static struct aco_type global_option</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00152">res_prometheus.c:152</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00162">162</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="ab38f0f4a2a6b16f65dd23d70219ac101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38f0f4a2a6b16f65dd23d70219ac101">&#9670;&nbsp;</a></span>prometheus_uri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> prometheus_uri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00791">791</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

</div>
</div>
<a id="a52907b32ce3af257e0ae090387c51545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52907b32ce3af257e0ae090387c51545">&#9670;&nbsp;</a></span>scrape_lock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d42/lock_8h.html#a44a55ccb432d858a224b401116277e93">ast_mutex_t</a> scrape_lock = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lock that protects data structures during an HTTP scrape. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00136">136</a> of file <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html">res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00593">http_callback()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00945">load_module()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00535">prometheus_callback_register()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00548">prometheus_callback_unregister()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00712">prometheus_last_scrape_time_get()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">prometheus_metric_register()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00280">prometheus_metric_registered_count()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00685">prometheus_scrape_to_string()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00910">reload_module()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00876">unload_module()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:36 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
