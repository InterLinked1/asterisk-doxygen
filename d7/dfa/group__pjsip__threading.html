<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: PJSIP Threading Model</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PJSIP Threading Model</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga03d77afe873d5e87809639c520ef2dd0"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga03d77afe873d5e87809639c520ef2dd0">ast_sip_task</a>) (void *user_data)</td></tr>
<tr class="separator:ga03d77afe873d5e87809639c520ef2dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga478c7100d82665dc492845e4213ebc40"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga478c7100d82665dc492845e4213ebc40">ast_sip_scheduler_task_flags</a> { <br />
&#160;&#160;<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a81c4a53b77f84fb06b3e6f103d48109a">AST_SIP_SCHED_TASK_DEFAULTS</a> = (0 &lt;&lt; 0), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212">AST_SIP_SCHED_TASK_FIXED</a> = (0 &lt;&lt; 0), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae42fe4e3f352a348a815e0f4c9b67460">AST_SIP_SCHED_TASK_VARIABLE</a> = (1 &lt;&lt; 0), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2381094c68917aa3309e47effd7750ce">AST_SIP_SCHED_TASK_ONESHOT</a> = (1 &lt;&lt; 6), 
<br />
&#160;&#160;<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a62bbc48c569426c983047dc3663d8f55">AST_SIP_SCHED_TASK_DATA_NOT_AO2</a> = (0 &lt;&lt; 1), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a> = (1 &lt;&lt; 1), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae41e93fe2c64bd4648c3f28fc66db39b">AST_SIP_SCHED_TASK_DATA_NO_CLEANUP</a> = (0 &lt;&lt; 3), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac902b216ddde8a3ab715dcfeeb9b6dcc">AST_SIP_SCHED_TASK_DATA_FREE</a> = ( 1 &lt;&lt; 3 ), 
<br />
&#160;&#160;<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a98c1298ee39720ed9ac1d6af774c4124">AST_SIP_SCHED_TASK_PERIODIC</a> = (0 &lt;&lt; 4), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a> = (1 &lt;&lt; 4), 
<a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709">AST_SIP_SCHED_TASK_TRACK</a> = (1 &lt;&lt; 5)
<br />
 }<tr class="memdesc:ga478c7100d82665dc492845e4213ebc40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task flags for the res_pjsip scheduler.  <a href="../../d7/dfa/group__pjsip__threading.html#ga478c7100d82665dc492845e4213ebc40">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ga478c7100d82665dc492845e4213ebc40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad57aa0b914fbd6adbf8ee2fe176e1fb1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:gad57aa0b914fbd6adbf8ee2fe176e1fb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new serializer for SIP tasks.  <a href="#gad57aa0b914fbd6adbf8ee2fe176e1fb1">More...</a><br /></td></tr>
<tr class="separator:gad57aa0b914fbd6adbf8ee2fe176e1fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga575cb798179c82d92b24415d3e174b5b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga575cb798179c82d92b24415d3e174b5b">ast_sip_create_serializer_group</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct <a class="el" href="../../dc/d82/structast__serializer__shutdown__group.html">ast_serializer_shutdown_group</a> *<a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>)</td></tr>
<tr class="memdesc:ga575cb798179c82d92b24415d3e174b5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new serializer for SIP tasks.  <a href="#ga575cb798179c82d92b24415d3e174b5b">More...</a><br /></td></tr>
<tr class="separator:ga575cb798179c82d92b24415d3e174b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f70e0cb65924cc6ace6a1a0b64a87ef"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga8f70e0cb65924cc6ace6a1a0b64a87ef">ast_sip_dialog_get_endpoint</a> (pjsip_dialog *dlg)</td></tr>
<tr class="memdesc:ga8f70e0cb65924cc6ace6a1a0b64a87ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the endpoint associated with this dialog.  <a href="#ga8f70e0cb65924cc6ace6a1a0b64a87ef">More...</a><br /></td></tr>
<tr class="separator:ga8f70e0cb65924cc6ace6a1a0b64a87ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d8415024c851216fa63fbb94d0aadcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a> (pjsip_dialog *dlg, struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint)</td></tr>
<tr class="memdesc:ga6d8415024c851216fa63fbb94d0aadcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup.  <a href="#ga6d8415024c851216fa63fbb94d0aadcf">More...</a><br /></td></tr>
<tr class="separator:ga6d8415024c851216fa63fbb94d0aadcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86c62fe22e3b7fb409c13ec7fd4fee2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a> (pjsip_dialog *dlg, struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>)</td></tr>
<tr class="memdesc:ga86c62fe22e3b7fb409c13ec7fd4fee2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a serializer on a SIP dialog so requests and responses are automatically serialized.  <a href="#ga86c62fe22e3b7fb409c13ec7fd4fee2d">More...</a><br /></td></tr>
<tr class="separator:ga86c62fe22e3b7fb409c13ec7fd4fee2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga506c31bc071963fa7ef3ed517fa0a533"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:ga506c31bc071963fa7ef3ed517fa0a533"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the distributor serializer for the SIP message.  <a href="#ga506c31bc071963fa7ef3ed517fa0a533">More...</a><br /></td></tr>
<tr class="separator:ga506c31bc071963fa7ef3ed517fa0a533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f0a0629fa2ca084812772356d8e3565"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>, int(*sip_task)(void *), void *<a class="el" href="../../d1/dd9/structtask__data.html">task_data</a>)</td></tr>
<tr class="memdesc:ga4f0a0629fa2ca084812772356d8e3565"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pushes a task to SIP servants.  <a href="#ga4f0a0629fa2ca084812772356d8e3565">More...</a><br /></td></tr>
<tr class="separator:ga4f0a0629fa2ca084812772356d8e3565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad5575540c19832939a6b858a93cd5ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gaad5575540c19832939a6b858a93cd5ab">ast_sip_push_task_synchronous</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>, int(*sip_task)(void *), void *<a class="el" href="../../d1/dd9/structtask__data.html">task_data</a>)</td></tr>
<tr class="memdesc:gaad5575540c19832939a6b858a93cd5ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push a task to SIP servants and wait for it to complete.  <a href="#gaad5575540c19832939a6b858a93cd5ab">More...</a><br /></td></tr>
<tr class="separator:gaad5575540c19832939a6b858a93cd5ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac231880459dcf8feacf1bb272b60472a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>, int(*sip_task)(void *), void *<a class="el" href="../../d1/dd9/structtask__data.html">task_data</a>)</td></tr>
<tr class="memdesc:gac231880459dcf8feacf1bb272b60472a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push a task to the serializer and wait for it to complete.  <a href="#gac231880459dcf8feacf1bb272b60472a">More...</a><br /></td></tr>
<tr class="separator:gac231880459dcf8feacf1bb272b60472a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8c82412fe0432a91d5c7985cfdf9b59"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>, int(*sip_task)(void *), void *<a class="el" href="../../d1/dd9/structtask__data.html">task_data</a>)</td></tr>
<tr class="memdesc:gab8c82412fe0432a91d5c7985cfdf9b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push a task to SIP servants and wait for it to complete.  <a href="#gab8c82412fe0432a91d5c7985cfdf9b59">More...</a><br /></td></tr>
<tr class="separator:gab8c82412fe0432a91d5c7985cfdf9b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7738011322c50e875837b7550479b88b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga7738011322c50e875837b7550479b88b">ast_sip_sched_is_task_running</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd)</td></tr>
<tr class="memdesc:ga7738011322c50e875837b7550479b88b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the task is currently running.  <a href="#ga7738011322c50e875837b7550479b88b">More...</a><br /></td></tr>
<tr class="separator:ga7738011322c50e875837b7550479b88b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9666f4c419f7d29a423e41366c9866a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gad9666f4c419f7d29a423e41366c9866a">ast_sip_sched_is_task_running_by_name</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:gad9666f4c419f7d29a423e41366c9866a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the task is currently running.  <a href="#gad9666f4c419f7d29a423e41366c9866a">More...</a><br /></td></tr>
<tr class="separator:gad9666f4c419f7d29a423e41366c9866a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74acadc4e87ea1cea9cdddba4734bccc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd)</td></tr>
<tr class="memdesc:ga74acadc4e87ea1cea9cdddba4734bccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels the next invocation of a task.  <a href="#ga74acadc4e87ea1cea9cdddba4734bccc">More...</a><br /></td></tr>
<tr class="separator:ga74acadc4e87ea1cea9cdddba4734bccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bf515a47d663f1762ac337c9167b8e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga4bf515a47d663f1762ac337c9167b8e2">ast_sip_sched_task_cancel_by_name</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:ga4bf515a47d663f1762ac337c9167b8e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels the next invocation of a task by name.  <a href="#ga4bf515a47d663f1762ac337c9167b8e2">More...</a><br /></td></tr>
<tr class="separator:ga4bf515a47d663f1762ac337c9167b8e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78b7691fb1bf1717a7961a68ceed5886"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga78b7691fb1bf1717a7961a68ceed5886">ast_sip_sched_task_get_name</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd, char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, size_t maxlen)</td></tr>
<tr class="memdesc:ga78b7691fb1bf1717a7961a68ceed5886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the task name.  <a href="#ga78b7691fb1bf1717a7961a68ceed5886">More...</a><br /></td></tr>
<tr class="separator:ga78b7691fb1bf1717a7961a68ceed5886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a0f4a262534b770d745c4e4d99954be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga7a0f4a262534b770d745c4e4d99954be">ast_sip_sched_task_get_next_run</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd)</td></tr>
<tr class="memdesc:ga7a0f4a262534b770d745c4e4d99954be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of milliseconds until the next invocation.  <a href="#ga7a0f4a262534b770d745c4e4d99954be">More...</a><br /></td></tr>
<tr class="separator:ga7a0f4a262534b770d745c4e4d99954be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe1d1904d9e3f338f656203cc8f88a74"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gabe1d1904d9e3f338f656203cc8f88a74">ast_sip_sched_task_get_next_run_by_name</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:gabe1d1904d9e3f338f656203cc8f88a74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of milliseconds until the next invocation.  <a href="#gabe1d1904d9e3f338f656203cc8f88a74">More...</a><br /></td></tr>
<tr class="separator:gabe1d1904d9e3f338f656203cc8f88a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5f6f4fabd4f24b1958e08530e71aaed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gab5f6f4fabd4f24b1958e08530e71aaed">ast_sip_sched_task_get_times</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd, struct timeval *when_queued, struct timeval *last_start, struct timeval *last_end)</td></tr>
<tr class="memdesc:gab5f6f4fabd4f24b1958e08530e71aaed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the last start and end times of the task.  <a href="#gab5f6f4fabd4f24b1958e08530e71aaed">More...</a><br /></td></tr>
<tr class="separator:gab5f6f4fabd4f24b1958e08530e71aaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11e333026826de2a22d2a33bb3e0bd01"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a> (struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd, struct timeval *when_queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</td></tr>
<tr class="memdesc:ga11e333026826de2a22d2a33bb3e0bd01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the queued, last start, last_end, time left, interval, next run.  <a href="#ga11e333026826de2a22d2a33bb3e0bd01">More...</a><br /></td></tr>
<tr class="separator:ga11e333026826de2a22d2a33bb3e0bd01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbe3526da1e7a11a4d05173ec3ad70f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gafbe3526da1e7a11a4d05173ec3ad70f7">ast_sip_sched_task_get_times_by_name</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct timeval *when_queued, struct timeval *last_start, struct timeval *last_end)</td></tr>
<tr class="memdesc:gafbe3526da1e7a11a4d05173ec3ad70f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the last start and end times of the task by name.  <a href="#gafbe3526da1e7a11a4d05173ec3ad70f7">More...</a><br /></td></tr>
<tr class="separator:gafbe3526da1e7a11a4d05173ec3ad70f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadac4ed564a9f6e11c2436ee897718a38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gadac4ed564a9f6e11c2436ee897718a38">ast_sip_sched_task_get_times_by_name2</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct timeval *when_queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</td></tr>
<tr class="memdesc:gadac4ed564a9f6e11c2436ee897718a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the queued, last start, last_end, time left, interval, next run by task name.  <a href="#gadac4ed564a9f6e11c2436ee897718a38">More...</a><br /></td></tr>
<tr class="separator:gadac4ed564a9f6e11c2436ee897718a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47a9130b20e7724a51d5eeebbc0a516b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga47a9130b20e7724a51d5eeebbc0a516b">ast_sip_schedule_task</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="el" href="../../d9/d47/structserializer.html">serializer</a>, int interval, <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga03d77afe873d5e87809639c520ef2dd0">ast_sip_task</a> sip_task, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, void *<a class="el" href="../../d1/dd9/structtask__data.html">task_data</a>, enum <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga478c7100d82665dc492845e4213ebc40">ast_sip_scheduler_task_flags</a> flags)</td></tr>
<tr class="memdesc:ga47a9130b20e7724a51d5eeebbc0a516b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule a task to run in the res_pjsip thread pool.  <a href="#ga47a9130b20e7724a51d5eeebbc0a516b">More...</a><br /></td></tr>
<tr class="separator:ga47a9130b20e7724a51d5eeebbc0a516b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77c1258c88c9e98d907a2299934d8de1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga77c1258c88c9e98d907a2299934d8de1">ast_sip_thread_is_servant</a> (void)</td></tr>
<tr class="memdesc:ga77c1258c88c9e98d907a2299934d8de1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the current thread is a SIP servant thread.  <a href="#ga77c1258c88c9e98d907a2299934d8de1">More...</a><br /></td></tr>
<tr class="separator:ga77c1258c88c9e98d907a2299934d8de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>


<h3><a id="PJSIP"></a>PJSIP Threading Model</h3><div class="textblock">There are three major types of threads that SIP will have to deal with: </p><ul>
<li>Asterisk threads </li>
<li>PJSIP threads </li>
<li>SIP threadpool threads (a.k.a. "servants")</li>
</ul>
<dl class="section user"><dt>Asterisk Threads</dt><dd></dd></dl>
<p>Asterisk threads are those that originate from outside of SIP but within Asterisk. The most common of these threads are PBX (channel) threads and the autoservice thread. Most interaction with these threads will be through channel technology callbacks. Within these threads, it is fine to handle Asterisk data from outside of SIP, but any handling of SIP data should be left to servants, <b>especially</b> if you wish to call into PJSIP for anything. Asterisk threads are not registered with PJLIB, so attempting to call into PJSIP will cause an assertion to be triggered, thus causing the program to crash.<dl class="section user"><dt>PJSIP Threads</dt><dd></dd></dl>
<p>PJSIP threads are those that originate from handling of PJSIP events, such as an incoming SIP request or response, or a transaction timeout. The role of these threads is to process information as quickly as possible so that the next item on the SIP socket(s) can be serviced. On incoming messages, Asterisk automatically will push the request to a servant thread. When your module callback is called, processing will already be in a servant. However, for other PJSIP events, such as transaction state changes due to timer expirations, your module will be called into from a PJSIP thread. If you are called into from a PJSIP thread, then you should push whatever processing is needed to a servant as soon as possible. You can discern if you are currently in a SIP servant thread using the <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga77c1258c88c9e98d907a2299934d8de1">ast_sip_thread_is_servant</a> function.<dl class="section user"><dt>Servants</dt><dd></dd></dl>
<p>Servants are where the bulk of SIP work should be performed. These threads exist in order to do the work that Asterisk threads and PJSIP threads hand off to them. Servant threads register themselves with PJLIB, meaning that they are capable of calling PJSIP and PJLIB functions if they wish.<dl class="section user"><dt>Serializer</dt><dd></dd></dl>
<p>Tasks are handed off to servant threads using the API call <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>. The first parameter of this call is a serializer. If this pointer is NULL, then the work will be handed off to whatever servant can currently handle the task. If this pointer is non-NULL, then the task will not be executed until previous tasks pushed with the same serializer have completed. For more information on serializers and the benefits they provide, see <a class="el" href="../../d1/dc7/threadpool_8c.html#a6e86f51d34ae17fd6f38b8379883bf87">ast_threadpool_serializer</a><dl class="section user"><dt>Scheduler</dt><dd></dd></dl>
<p>Some situations require that a task run periodically or at a future time. Normally the ast_sched functionality would be used but ast_sched only uses 1 thread for all tasks and that thread isn't registered with PJLIB and therefore can't do any PJSIP related work.ast_sip_sched uses ast_sched only as a scheduled queue. When a task is ready to run, it's pushed to a Serializer to be invoked asynchronously by a Servant. This ensures that the task is executed in a PJLIB registered thread and allows the ast_sched thread to immediately continue processing the queue. The Serializer used by ast_sip_sched is one of your choosing or a random one from the res_pjsip pool if you don't choose one.<dl class="section note"><dt>Note</dt><dd></dd></dl>
<p>Do not make assumptions about individual threads based on a corresponding serializer. In other words, just because several tasks use the same serializer when being pushed to servants, it does not mean that the same thread is necessarily going to execute those tasks, even though they are all guaranteed to be executed in sequence. </div><h2 class="groupheader">Typedef Documentation</h2>
<a id="ga03d77afe873d5e87809639c520ef2dd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga03d77afe873d5e87809639c520ef2dd0">&#9670;&nbsp;</a></span>ast_sip_task</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sip_task) (void *user_data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01573">1573</a> of file <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">res_pjsip.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga478c7100d82665dc492845e4213ebc40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga478c7100d82665dc492845e4213ebc40">&#9670;&nbsp;</a></span>ast_sip_scheduler_task_flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga478c7100d82665dc492845e4213ebc40">ast_sip_scheduler_task_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task flags for the res_pjsip scheduler. </p>
<p>The default is AST_SIP_SCHED_TASK_FIXED | AST_SIP_SCHED_TASK_DATA_NOT_AO2 | AST_SIP_SCHED_TASK_DATA_NO_CLEANUP | AST_SIP_SCHED_TASK_PERIODIC </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a81c4a53b77f84fb06b3e6f103d48109a"></a>AST_SIP_SCHED_TASK_DEFAULTS&#160;</td><td class="fielddoc"><p>The defaults </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212"></a>AST_SIP_SCHED_TASK_FIXED&#160;</td><td class="fielddoc"><p>Run at a fixed interval. Stop scheduling if the callback returns &lt;= 0. Any other value is ignored. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40ae42fe4e3f352a348a815e0f4c9b67460"></a>AST_SIP_SCHED_TASK_VARIABLE&#160;</td><td class="fielddoc"><p>Run at a variable interval. Stop scheduling if the callback returns &lt;= 0. Any other return value is used as the new interval. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a2381094c68917aa3309e47effd7750ce"></a>AST_SIP_SCHED_TASK_ONESHOT&#160;</td><td class="fielddoc"><p>Run just once. Return values are ignored. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a62bbc48c569426c983047dc3663d8f55"></a>AST_SIP_SCHED_TASK_DATA_NOT_AO2&#160;</td><td class="fielddoc"><p>The task data is not an AO2 object. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a"></a>AST_SIP_SCHED_TASK_DATA_AO2&#160;</td><td class="fielddoc"><p>The task data is an AO2 object. A reference count will be held by the scheduler until after the task has run for the final time (if ever). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40ae41e93fe2c64bd4648c3f28fc66db39b"></a>AST_SIP_SCHED_TASK_DATA_NO_CLEANUP&#160;</td><td class="fielddoc"><p>Don't take any cleanup action on the data </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40ac902b216ddde8a3ab715dcfeeb9b6dcc"></a>AST_SIP_SCHED_TASK_DATA_FREE&#160;</td><td class="fielddoc"><p>If AST_SIP_SCHED_TASK_DATA_AO2 is set, decrement the reference count otherwise call ast_free on it. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a98c1298ee39720ed9ac1d6af774c4124"></a>AST_SIP_SCHED_TASK_PERIODIC&#160;</td><td class="fielddoc"><p>The task is scheduled at multiples of interval. </p>
<dl class="section see"><dt>See also</dt><dd>Interval </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a"></a>AST_SIP_SCHED_TASK_DELAY&#160;</td><td class="fielddoc"><p>The next invocation of the task is at last finish + interval. </p>
<dl class="section see"><dt>See also</dt><dd>Interval </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709"></a>AST_SIP_SCHED_TASK_TRACK&#160;</td><td class="fielddoc"><p>The scheduled task's events are tracked in the debug log. </p>
<p>Schedule events such as scheduling, running, rescheduling, canceling, and destroying are logged about the task. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01767">1767</a> of file <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">res_pjsip.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                  {<span class="comment"></span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">    * The defaults</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a81c4a53b77f84fb06b3e6f103d48109a">AST_SIP_SCHED_TASK_DEFAULTS</a> = (0 &lt;&lt; 0),</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">    * Run at a fixed interval.</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">    * Stop scheduling if the callback returns &lt;= 0.</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">    * Any other value is ignored.</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212">AST_SIP_SCHED_TASK_FIXED</a> = (0 &lt;&lt; 0),<span class="comment"></span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment">    * Run at a variable interval.</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment">    * Stop scheduling if the callback returns &lt;= 0.</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">    * Any other return value is used as the new interval.</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae42fe4e3f352a348a815e0f4c9b67460">AST_SIP_SCHED_TASK_VARIABLE</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">    * Run just once.</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">    * Return values are ignored.</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2381094c68917aa3309e47effd7750ce">AST_SIP_SCHED_TASK_ONESHOT</a> = (1 &lt;&lt; 6),</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">    * The task data is not an AO2 object.</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a62bbc48c569426c983047dc3663d8f55">AST_SIP_SCHED_TASK_DATA_NOT_AO2</a> = (0 &lt;&lt; 1),<span class="comment"></span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">    * The task data is an AO2 object.</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">    * A reference count will be held by the scheduler until</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">    * after the task has run for the final time (if ever).</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a> = (1 &lt;&lt; 1),</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">    * Don&#39;t take any cleanup action on the data</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae41e93fe2c64bd4648c3f28fc66db39b">AST_SIP_SCHED_TASK_DATA_NO_CLEANUP</a> = (0 &lt;&lt; 3),<span class="comment"></span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">    * If AST_SIP_SCHED_TASK_DATA_AO2 is set, decrement the reference count</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">    * otherwise call ast_free on it.</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac902b216ddde8a3ab715dcfeeb9b6dcc">AST_SIP_SCHED_TASK_DATA_FREE</a> = ( 1 &lt;&lt; 3 ),</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">    * \brief The task is scheduled at multiples of interval</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">    * \see Interval</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">    */</span></div><div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ae41e93fe2c64bd4648c3f28fc66db39b"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae41e93fe2c64bd4648c3f28fc66db39b">AST_SIP_SCHED_TASK_DATA_NO_CLEANUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01806">res_pjsip.h:1806</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a81c4a53b77f84fb06b3e6f103d48109a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a81c4a53b77f84fb06b3e6f103d48109a">AST_SIP_SCHED_TASK_DEFAULTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01771">res_pjsip.h:1771</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a2381094c68917aa3309e47effd7750ce"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2381094c68917aa3309e47effd7750ce">AST_SIP_SCHED_TASK_ONESHOT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01790">res_pjsip.h:1790</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a8d01d6eb6543f97d3289df2cbe6de212">AST_SIP_SCHED_TASK_FIXED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01778">res_pjsip.h:1778</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a62bbc48c569426c983047dc3663d8f55"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a62bbc48c569426c983047dc3663d8f55">AST_SIP_SCHED_TASK_DATA_NOT_AO2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01795">res_pjsip.h:1795</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ae42fe4e3f352a348a815e0f4c9b67460"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ae42fe4e3f352a348a815e0f4c9b67460">AST_SIP_SCHED_TASK_VARIABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01784">res_pjsip.h:1784</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ac902b216ddde8a3ab715dcfeeb9b6dcc"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac902b216ddde8a3ab715dcfeeb9b6dcc">AST_SIP_SCHED_TASK_DATA_FREE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01811">res_pjsip.h:1811</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01801">res_pjsip.h:1801</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gad57aa0b914fbd6adbf8ee2fe176e1fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad57aa0b914fbd6adbf8ee2fe176e1fb1">&#9670;&nbsp;</a></span>ast_sip_create_serializer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_sip_create_serializer </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new serializer for SIP tasks. </p>
<dl class="section since"><dt>Since</dt><dd>13.8.0</dd></dl>
<p>See <a class="el" href="../../d1/dc7/threadpool_8c.html#a6e86f51d34ae17fd6f38b8379883bf87">ast_threadpool_serializer</a> for more information on serializers. SIP creates serializers so that tasks operating on similar data will run in sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the serializer. (must be unique)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly-created serializer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">5133</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05128">ast_sip_create_serializer_group()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02918">ast_res_pjsip_init_options_handling()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d2/db8/res__pjsip__transport__websocket_8c_source.html#l00349">create_websocket_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01243">distributor_pool_setup()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00960">load_module()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00382">refer_progress_alloc()</a>, and <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00102">scheduler()</a>.</p>
<div class="fragment"><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;{</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga575cb798179c82d92b24415d3e174b5b">ast_sip_create_serializer_group</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga575cb798179c82d92b24415d3e174b5b"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga575cb798179c82d92b24415d3e174b5b">ast_sip_create_serializer_group</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer_group(const char *name, struct ast_serializer_shutdown_group *shutdown_group)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05128">res_pjsip.c:5128</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga575cb798179c82d92b24415d3e174b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga575cb798179c82d92b24415d3e174b5b">&#9670;&nbsp;</a></span>ast_sip_create_serializer_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_sip_create_serializer_group </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dc/d82/structast__serializer__shutdown__group.html">ast_serializer_shutdown_group</a> *&#160;</td>
          <td class="paramname"><em>shutdown_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new serializer for SIP tasks. </p>
<dl class="section since"><dt>Since</dt><dd>13.8.0</dd></dl>
<p>See <a class="el" href="../../d1/dc7/threadpool_8c.html#a6e86f51d34ae17fd6f38b8379883bf87">ast_threadpool_serializer</a> for more information on serializers. SIP creates serializers so that tasks operating on similar data will run in sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the serializer. (must be unique) </td></tr>
    <tr><td class="paramname">shutdown_group</td><td>Group shutdown controller. (NULL if no group association)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly-created serializer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05128">5128</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01402">ast_threadpool_serializer_group()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">ast_sip_create_serializer()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00963">sip_options_aor_alloc()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01033">sip_outbound_publisher_alloc()</a>, and <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01314">sip_outbound_registration_state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;{</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d40/threadpool_8h.html#a49b8fabf465ce8e4f325ceecda8ccd16">ast_threadpool_serializer_group</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../de/d96/res__pjsip_8c.html#a714a1bebd7d5fe9712c059a60e3f5f20">sip_threadpool</a>, shutdown_group);</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;}</div><div class="ttc" id="res__pjsip_8c_html_a714a1bebd7d5fe9712c059a60e3f5f20"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a714a1bebd7d5fe9712c059a60e3f5f20">sip_threadpool</a></div><div class="ttdeci">static struct ast_threadpool * sip_threadpool</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03274">res_pjsip.c:3274</a></div></div>
<div class="ttc" id="threadpool_8h_html_a49b8fabf465ce8e4f325ceecda8ccd16"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#a49b8fabf465ce8e4f325ceecda8ccd16">ast_threadpool_serializer_group</a></div><div class="ttdeci">struct ast_taskprocessor * ast_threadpool_serializer_group(const char *name, struct ast_threadpool *pool, struct ast_serializer_shutdown_group *shutdown_group)</div><div class="ttdoc">Serialized execution of tasks within a ast_threadpool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01402">threadpool.c:1402</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8f70e0cb65924cc6ace6a1a0b64a87ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f70e0cb65924cc6ace6a1a0b64a87ef">&#9670;&nbsp;</a></span>ast_sip_dialog_get_endpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* ast_sip_dialog_get_endpoint </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the endpoint associated with this dialog. </p>
<p>This function increases the refcount of the endpoint by one. Release the reference once you are finished with the endpoint.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlg</td><td>The SIP dialog from which to retrieve the endpoint </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>No endpoint associated with this dialog </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The endpoint. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00322">322</a> of file <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html">pjsip_distributor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">distributor_dialog_data::endpoint</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d61/res__pjsip__outbound__authenticator__digest_8c_source.html#l00410">digest_create_request_with_auth()</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a> *dist;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   dist = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, dlg, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordflow">if</span> (dist) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(dist);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      endpoint = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(dist);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(dist, -1);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_af657e13220576238494c516b91337a6b"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a></div><div class="ttdeci">static struct ao2_container * dialog_associations</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00164">pjsip_distributor.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">distributor_dialog_data::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">pjsip_distributor.c:159</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00153">pjsip_distributor.c:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6d8415024c851216fa63fbb94d0aadcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6d8415024c851216fa63fbb94d0aadcf">&#9670;&nbsp;</a></span>ast_sip_dialog_set_endpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_dialog_set_endpoint </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlg</td><td>The SIP dialog itself </td></tr>
    <tr><td class="paramname">endpoint</td><td>The endpoint that this dialog is communicating with </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">294</a> of file <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html">pjsip_distributor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01622">ao2_unlink_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00720">ao2_wrlock</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00155">distributor_dialog_data::dlg</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">distributor_dialog_data::endpoint</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00157">distributor_dialog_data::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">subscription_setup_dialog()</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a> *dist;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   dist = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">if</span> (!dist) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">if</span> (endpoint) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         dist = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*dist), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;         <span class="keywordflow">if</span> (dist) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, dist, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(dist, -1);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(dist);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">if</span> (!dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> &amp;&amp; !dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, dist, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(dist);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(dist, -1);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3498e30d6154a052e7b64b7a96da8b4b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a></div><div class="ttdeci">#define ao2_wrlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00720">astobj2.h:720</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_af657e13220576238494c516b91337a6b"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a></div><div class="ttdeci">static struct ao2_container * dialog_associations</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00164">pjsip_distributor.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">distributor_dialog_data::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">pjsip_distributor.c:159</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">distributor_dialog_data::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00157">pjsip_distributor.c:157</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00153">pjsip_distributor.c:153</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">distributor_dialog_data::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00155">pjsip_distributor.c:155</a></div></div>
<div class="ttc" id="astobj2_8h_html_a77df7775a2a8b6cbef307e211dbf045c"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a></div><div class="ttdeci">#define ao2_unlink_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01622">astobj2.h:1622</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga86c62fe22e3b7fb409c13ec7fd4fee2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga86c62fe22e3b7fb409c13ec7fd4fee2d">&#9670;&nbsp;</a></span>ast_sip_dialog_set_serializer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_dialog_set_serializer </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a serializer on a SIP dialog so requests and responses are automatically serialized. </p>
<p>Passing a NULL serializer is a way to remove a serializer from a dialog.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlg</td><td>The SIP dialog itself </td></tr>
    <tr><td class="paramname">serializer</td><td>The serializer to use </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">266</a> of file <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html">pjsip_distributor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01622">ao2_unlink_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00720">ao2_wrlock</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00155">distributor_dialog_data::dlg</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">distributor_dialog_data::endpoint</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00157">distributor_dialog_data::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01396">subscription_setup_dialog()</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a> *dist;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   dist = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">if</span> (!dist) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (serializer) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         dist = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*dist), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <span class="keywordflow">if</span> (dist) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">dlg</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, dist, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(dist, -1);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(dist);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">if</span> (!dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> &amp;&amp; !dist-&gt;<a class="code" href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>, dist, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(dist);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(dist, -1);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3498e30d6154a052e7b64b7a96da8b4b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a></div><div class="ttdeci">#define ao2_wrlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00720">astobj2.h:720</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_af657e13220576238494c516b91337a6b"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#af657e13220576238494c516b91337a6b">dialog_associations</a></div><div class="ttdeci">static struct ao2_container * dialog_associations</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00164">pjsip_distributor.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#a3960205b2a4e7e012dc9f0eae1855f01">distributor_dialog_data::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00159">pjsip_distributor.c:159</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#ac23e23ba60f358de78a893d537c0afa4">distributor_dialog_data::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00157">pjsip_distributor.c:157</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html">distributor_dialog_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00153">pjsip_distributor.c:153</a></div></div>
<div class="ttc" id="structdistributor__dialog__data_html_a9d867cb404dff4c9d88a624e78a0e4d0"><div class="ttname"><a href="../../d3/d65/structdistributor__dialog__data.html#a9d867cb404dff4c9d88a624e78a0e4d0">distributor_dialog_data::dlg</a></div><div class="ttdeci">pjsip_dialog * dlg</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00155">pjsip_distributor.c:155</a></div></div>
<div class="ttc" id="astobj2_8h_html_a77df7775a2a8b6cbef307e211dbf045c"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a></div><div class="ttdeci">#define ao2_unlink_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01622">astobj2.h:1622</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga506c31bc071963fa7ef3ed517fa0a533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga506c31bc071963fa7ef3ed517fa0a533">&#9670;&nbsp;</a></span>ast_sip_get_distributor_serializer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_sip_get_distributor_serializer </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the distributor serializer for the SIP message. </p>
<dl class="section since"><dt>Since</dt><dd>13.10.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rdata</td><td>The incoming message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Calculated</td><td>distributor serializer on success. </td></tr>
    <tr><td class="paramname">NULL</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">448</a> of file <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html">pjsip_distributor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01193">ast_str_hash_restrict()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00906">ast_taskprocessor_name()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00718">endpoint_lookup()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00443">pjstr_hash()</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00426">pjstr_hash_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">subscription_persistence_recreate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;{</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordtype">int</span> hash;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   pj_str_t *remote_tag;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *<a class="code" href="../../d9/d47/structserializer.html">serializer</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordflow">if</span> (!rdata-&gt;msg_info.msg) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;type == PJSIP_REQUEST_MSG) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      remote_tag = &amp;rdata-&gt;msg_info.from-&gt;tag;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      remote_tag = &amp;rdata-&gt;msg_info.to-&gt;tag;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <span class="comment">/* Compute the hash from the SIP message call-id and remote-tag */</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   hash = <a class="code" href="../../d7/dad/pjsip__distributor_8c.html#ac05f722c5e4362d8ee003f43bd784ffd">pjstr_hash</a>(&amp;rdata-&gt;msg_info.cid-&gt;id);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   hash = <a class="code" href="../../d7/dad/pjsip__distributor_8c.html#a7583afd21cb84f522c01c6c5e38b35bb">pjstr_hash_add</a>(remote_tag, hash);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   hash = <a class="code" href="../../d6/d90/strings_8h.html#a7a7eb843162c5e29c59951d07d08fa57">ast_str_hash_restrict</a>(hash);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   serializer = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#ad7db42e2b48aac82b7ba080f12fe5dd0">distributor_pool</a>[hash % <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#ad7db42e2b48aac82b7ba080f12fe5dd0">distributor_pool</a>)]);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keywordflow">if</span> (serializer) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Calculated serializer %s to use for %s\n&quot;</span>,</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         <a class="code" href="../../d0/d1e/taskprocessor_8h.html#aaa6541086de52447afa994cbfcb792ec">ast_taskprocessor_name</a>(serializer), pjsip_rx_data_get_info(rdata));</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">return</span> serializer;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_aaa6541086de52447afa994cbfcb792ec"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#aaa6541086de52447afa994cbfcb792ec">ast_taskprocessor_name</a></div><div class="ttdeci">const char * ast_taskprocessor_name(struct ast_taskprocessor *tps)</div><div class="ttdoc">Return the name of the taskprocessor singleton. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00906">taskprocessor.c:906</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structserializer_html"><div class="ttname"><a href="../../d9/d47/structserializer.html">serializer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01315">threadpool.c:1315</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_a7583afd21cb84f522c01c6c5e38b35bb"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#a7583afd21cb84f522c01c6c5e38b35bb">pjstr_hash_add</a></div><div class="ttdeci">static int pjstr_hash_add(pj_str_t *str, int hash)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00426">pjsip_distributor.c:426</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_ad7db42e2b48aac82b7ba080f12fe5dd0"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#ad7db42e2b48aac82b7ba080f12fe5dd0">distributor_pool</a></div><div class="ttdeci">static struct ast_taskprocessor * distributor_pool[DISTRIBUTOR_POOL_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00066">pjsip_distributor.c:66</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_ac05f722c5e4362d8ee003f43bd784ffd"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#ac05f722c5e4362d8ee003f43bd784ffd">pjstr_hash</a></div><div class="ttdeci">static int pjstr_hash(pj_str_t *str)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00443">pjsip_distributor.c:443</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="strings_8h_html_a7a7eb843162c5e29c59951d07d08fa57"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7a7eb843162c5e29c59951d07d08fa57">ast_str_hash_restrict</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash_restrict(unsigned int hash)</div><div class="ttdoc">Restrict hash value range. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01193">strings.h:1193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4f0a0629fa2ca084812772356d8e3565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f0a0629fa2ca084812772356d8e3565">&#9670;&nbsp;</a></span>ast_sip_push_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_push_task </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&#160;</td>
          <td class="paramname"><em>sip_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pushes a task to SIP servants. </p>
<p>This uses the serializer provided to determine how to push the task. If the serializer is NULL, then the task will be pushed to the servants directly. If the serializer is non-NULL, then the task will be queued behind other tasks associated with the same serializer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serializer</td><td>The serializer to which the task belongs. Can be NULL </td></tr>
    <tr><td class="paramname">sip_task</td><td>The task to execute </td></tr>
    <tr><td class="paramname"><a class="el" href="../../d1/dd9/structtask__data.html" title="userdata associated with baseline taskprocessor test ">task_data</a></td><td>The parameter to pass to the task when it executes </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">5138</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00127">ast_serializer_pool_get()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01175">ast_taskprocessor_push()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01090">cond</a>, and <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05176">ast_sip_push_task_wait()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02332">auth_observer()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01152">cancel_and_unpublish()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02385">chan_pjsip_call()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02262">chan_pjsip_digit_end()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02516">chan_pjsip_hangup()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01612">chan_pjsip_indicate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02815">chan_pjsip_sendtext_data()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00448">chan_pjsip_set_rtp_peer()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02131">chan_pjsip_transfer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01582">check_delayed_requests()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02225">contact_observer_updated()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00699">exten_state_publisher_state_cb()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01592">handle_topology_request_change()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01553">load_module()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01483">mwi_startup_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01156">mwi_stasis_cb()</a>, <a class="el" href="../../d3/dea/res__pjsip__history_8c_source.html#l01311">pjsip_set_history()</a>, <a class="el" href="../../d3/dea/res__pjsip__history_8c_source.html#l01217">pjsip_show_history()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03312">publish_expire()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00796">publisher_client_send()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03989">pubsub_on_client_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02969">pubsub_on_rx_subscribe_request()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l04002">pubsub_on_server_timeout()</a>, <a class="el" href="../../d8/d41/res__pjsip__notify_8c_source.html#l00803">push_notify()</a>, <a class="el" href="../../d8/d41/res__pjsip__notify_8c_source.html#l00851">push_notify_channel()</a>, <a class="el" href="../../d8/d41/res__pjsip__notify_8c_source.html#l00830">push_notify_uri()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00157">push_to_serializer()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00786">qualify_contact_cb()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01893">queue_register()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01882">queue_unregister()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00553">refer_attended_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00625">refer_blind_callback()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l01088">refer_incoming_refer_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00181">refer_progress_bridge()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00349">refer_progress_destroy()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00236">refer_progress_framehook()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00297">refer_progress_framehook_destroy()</a>, <a class="el" href="../../d3/db0/res__pjsip__registrar_8c_source.html#l00369">register_contact_transport_shutdown_cb()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00939">registration_transport_shutdown_cb()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">resend_reinvite()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02500">sched_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01343">send_contact_notify()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01142">send_notify()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04701">session_end_if_disconnected()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">session_termination_cb()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00449">sip_options_contact_status_update()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01260">sip_outbound_publish_callback()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01085">sip_outbound_publish_client_add_publisher()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01744">sip_outbound_registration_apply()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01207">sip_outbound_registration_response_cb()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01276">sip_outbound_registration_state_destroy()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l00703">sip_outbound_registration_timer_cb()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00749">sip_publisher_service_queue()</a>, <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00268">sip_resolve_callback()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00333">state_changed()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01556">sub_persistence_recreate()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l00603">sub_tree_transport_cb()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00221">t38_automatic_reject_timer_cb()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00537">t38_framehook()</a>.</p>
<div class="fragment"><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;{</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;   <span class="keywordflow">if</span> (!serializer) {</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;      serializer = <a class="code" href="../../dd/d5f/serializer_8h.html#a57044062c5e192e675109fa621c1588d">ast_serializer_pool_get</a>(<a class="code" href="../../de/d96/res__pjsip_8c.html#af9d81933501c8c6d11f8fb3af5656093">sip_serializer_pool</a>);</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;   }</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a6b2508ba0a6b8f43ae6d3963f3189585">ast_taskprocessor_push</a>(serializer, sip_task, <a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;}</div><div class="ttc" id="structtask__data_html"><div class="ttname"><a href="../../d1/dd9/structtask__data.html">task_data</a></div><div class="ttdoc">userdata associated with baseline taskprocessor test </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/test__taskprocessor_8c_source.html#l00044">test_taskprocessor.c:44</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_af9d81933501c8c6d11f8fb3af5656093"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#af9d81933501c8c6d11f8fb3af5656093">sip_serializer_pool</a></div><div class="ttdeci">static struct ast_serializer_pool * sip_serializer_pool</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03270">res_pjsip.c:3270</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a6b2508ba0a6b8f43ae6d3963f3189585"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a6b2508ba0a6b8f43ae6d3963f3189585">ast_taskprocessor_push</a></div><div class="ttdeci">int ast_taskprocessor_push(struct ast_taskprocessor *tps, int(*task_exe)(void *datap), void *datap) attribute_warn_unused_result</div><div class="ttdoc">Push a task into the specified taskprocessor queue and signal the taskprocessor thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01175">taskprocessor.c:1175</a></div></div>
<div class="ttc" id="serializer_8h_html_a57044062c5e192e675109fa621c1588d"><div class="ttname"><a href="../../dd/d5f/serializer_8h.html#a57044062c5e192e675109fa621c1588d">ast_serializer_pool_get</a></div><div class="ttdeci">struct ast_taskprocessor * ast_serializer_pool_get(struct ast_serializer_pool *pool)</div><div class="ttdoc">Retrieve a serializer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00127">serializer.c:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaad5575540c19832939a6b858a93cd5ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad5575540c19832939a6b858a93cd5ab">&#9670;&nbsp;</a></span>ast_sip_push_task_synchronous()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_push_task_synchronous </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&#160;</td>
          <td class="paramname"><em>sip_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push a task to SIP servants and wait for it to complete. </p>
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000009">Deprecated:</a></b></dt><dd>Replaced with <a class="el" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59" title="Push a task to SIP servants and wait for it to complete. ">ast_sip_push_task_wait_servant()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05213">5213</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05204">ast_sip_push_task_wait_servant()</a>.</p>
<div class="fragment"><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;{</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a>(serializer, sip_task, <a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;}</div><div class="ttc" id="group__pjsip__threading_html_gab8c82412fe0432a91d5c7985cfdf9b59"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59">ast_sip_push_task_wait_servant</a></div><div class="ttdeci">int ast_sip_push_task_wait_servant(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to SIP servants and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05204">res_pjsip.c:5204</a></div></div>
<div class="ttc" id="structtask__data_html"><div class="ttname"><a href="../../d1/dd9/structtask__data.html">task_data</a></div><div class="ttdoc">userdata associated with baseline taskprocessor test </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/test__taskprocessor_8c_source.html#l00044">test_taskprocessor.c:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac231880459dcf8feacf1bb272b60472a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac231880459dcf8feacf1bb272b60472a">&#9670;&nbsp;</a></span>ast_sip_push_task_wait_serializer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_push_task_wait_serializer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&#160;</td>
          <td class="paramname"><em>sip_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push a task to the serializer and wait for it to complete. </p>
<p>Like <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a> except that it blocks until the task is completed by the specified serializer. If the specified serializer is the current thread then the task executes immediately.</p>
<dl class="section note"><dt>Note</dt><dd>PJPROJECT callbacks tend to have locks already held when called.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><b>Never</b> hold locks that may be acquired by a SIP servant thread when calling this function. Doing so may cause a deadlock if all SIP servant threads are blocked waiting to acquire the lock while the thread holding the lock is waiting for a free SIP servant thread for the serializer to execute in.</dd>
<dd>
<b>Never</b> hold locks that may be acquired by the serializer when calling this function. Doing so will cause a deadlock.</dd>
<dd>
<b>Never</b> use this function in the pjsip monitor thread (It is a SIP servant thread). This is likely to cause a deadlock.</dd>
<dd>
<b>Use</b> of this function in an ao2 destructor callback is a bad idea. You don't have control over which thread executes the destructor. Attempting to shift execution to another thread with this function is likely to cause deadlock.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serializer</td><td>The SIP serializer to execute the task. NULL if any of the default serializers can be used. </td></tr>
    <tr><td class="paramname">sip_task</td><td>The task to execute </td></tr>
    <tr><td class="paramname"><a class="el" href="../../d1/dd9/structtask__data.html" title="userdata associated with baseline taskprocessor test ">task_data</a></td><td>The parameter to pass to the task when it executes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is generally better to call <a class="el" href="../../d7/dfa/group__pjsip__threading.html#gab8c82412fe0432a91d5c7985cfdf9b59" title="Push a task to SIP servants and wait for it to complete. ">ast_sip_push_task_wait_servant()</a> if you pass NULL for the serializer parameter.</dd>
<dd>
The sip_task() return value may need to be distinguished from the failure to push the task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>sip_task() return value on success. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>Failure to push the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05218">5218</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00127">ast_serializer_pool_get()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05176">ast_sip_push_task_wait()</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01266">ast_taskprocessor_is_task()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02666">ami_sip_qualify()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02046">aor_observer_deleted()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02015">aor_observer_modified()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02835">ast_res_pjsip_cleanup_options_handling()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02918">ast_res_pjsip_init_options_handling()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00726">chan_pjsip_answer()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02346">cli_qualify()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02630">cli_reload_qualify_aor()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02576">cli_reload_qualify_endpoint()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02187">contact_observer_created()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02333">contact_observer_deleted()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02225">contact_observer_updated()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01883">endpoint_observer_deleted()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01915">endpoint_observer_modified()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00442">func_read_header()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00501">func_write_header()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l00916">pjsip_acf_channel_read()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01530">pjsip_acf_dtmf_mode_write()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01400">pjsip_acf_media_offer_write()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01197">pjsip_acf_parse_uri_read()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01671">pjsip_acf_session_refresh_write()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00969">refer_incoming_invite_request()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01352">sip_msg_send()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02025">sip_options_aor_observer_deleted_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01960">sip_options_aor_observer_modified_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02815">sip_options_cleanup_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02154">sip_options_contact_add_management_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02313">sip_options_contact_delete_management_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01819">sip_options_endpoint_unlink_aor_feeders()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01805">sip_options_synchronize()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01421">sip_options_synchronize_aor()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01584">sip_options_synchronize_endpoint()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01707">sip_options_unused_aor()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01744">sip_outbound_registration_apply()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">subscription_persistence_recreate()</a>, and <a class="el" href="../../d2/db8/res__pjsip__transport__websocket_8c_source.html#l00360">websocket_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;{</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;   <span class="keywordflow">if</span> (!serializer) {</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="comment">/* Caller doesn&#39;t care which PJSIP serializer the task executes under. */</span></div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      serializer = <a class="code" href="../../dd/d5f/serializer_8h.html#a57044062c5e192e675109fa621c1588d">ast_serializer_pool_get</a>(<a class="code" href="../../de/d96/res__pjsip_8c.html#af9d81933501c8c6d11f8fb3af5656093">sip_serializer_pool</a>);</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;      <span class="keywordflow">if</span> (!serializer) {</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;         <span class="comment">/* No serializer picked to execute the task */</span></div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;      }</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;   }</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a>(serializer)) {</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;<span class="comment">       * We are the requested serializer so we must execute</span></div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="comment">       * the task now or deadlock waiting on ourself to</span></div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="comment">       * execute it.</span></div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;      <span class="keywordflow">return</span> sip_task(<a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;   }</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d96/res__pjsip_8c.html#a3d0e736f5afb58090c07900cfc4d57e6">ast_sip_push_task_wait</a>(serializer, sip_task, <a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;}</div><div class="ttc" id="res__pjsip_8c_html_a3d0e736f5afb58090c07900cfc4d57e6"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a3d0e736f5afb58090c07900cfc4d57e6">ast_sip_push_task_wait</a></div><div class="ttdeci">static int ast_sip_push_task_wait(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05176">res_pjsip.c:5176</a></div></div>
<div class="ttc" id="structtask__data_html"><div class="ttname"><a href="../../d1/dd9/structtask__data.html">task_data</a></div><div class="ttdoc">userdata associated with baseline taskprocessor test </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/test__taskprocessor_8c_source.html#l00044">test_taskprocessor.c:44</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_af9d81933501c8c6d11f8fb3af5656093"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#af9d81933501c8c6d11f8fb3af5656093">sip_serializer_pool</a></div><div class="ttdeci">static struct ast_serializer_pool * sip_serializer_pool</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03270">res_pjsip.c:3270</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a4a66670abd8be00ab53bd9125a57574f"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a></div><div class="ttdeci">int ast_taskprocessor_is_task(struct ast_taskprocessor *tps)</div><div class="ttdoc">Am I the given taskprocessor&amp;#39;s current task. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01266">taskprocessor.c:1266</a></div></div>
<div class="ttc" id="serializer_8h_html_a57044062c5e192e675109fa621c1588d"><div class="ttname"><a href="../../dd/d5f/serializer_8h.html#a57044062c5e192e675109fa621c1588d">ast_serializer_pool_get</a></div><div class="ttdeci">struct ast_taskprocessor * ast_serializer_pool_get(struct ast_serializer_pool *pool)</div><div class="ttdoc">Retrieve a serializer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00127">serializer.c:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab8c82412fe0432a91d5c7985cfdf9b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab8c82412fe0432a91d5c7985cfdf9b59">&#9670;&nbsp;</a></span>ast_sip_push_task_wait_servant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_push_task_wait_servant </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&#160;</td>
          <td class="paramname"><em>sip_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push a task to SIP servants and wait for it to complete. </p>
<p>Like <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a> except that it blocks until the task completes. If the current thread is a SIP servant thread then the task executes immediately. Otherwise, the specified serializer executes the task and the current thread waits for it to complete.</p>
<dl class="section note"><dt>Note</dt><dd>PJPROJECT callbacks tend to have locks already held when called.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><b>Never</b> hold locks that may be acquired by a SIP servant thread when calling this function. Doing so may cause a deadlock if all SIP servant threads are blocked waiting to acquire the lock while the thread holding the lock is waiting for a free SIP servant thread.</dd>
<dd>
<b>Use</b> of this function in an ao2 destructor callback is a bad idea. You don't have control over which thread executes the destructor. Attempting to shift execution to another thread with this function is likely to cause deadlock.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serializer</td><td>The SIP serializer to execute the task if the current thread is not a SIP servant. NULL if any of the default serializers can be used. </td></tr>
    <tr><td class="paramname">sip_task</td><td>The task to execute </td></tr>
    <tr><td class="paramname"><a class="el" href="../../d1/dd9/structtask__data.html" title="userdata associated with baseline taskprocessor test ">task_data</a></td><td>The parameter to pass to the task when it executes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The sip_task() return value may need to be distinguished from the failure to push the task.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>sip_task() return value on success. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>Failure to push the task. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05204">5204</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05176">ast_sip_push_task_wait()</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05321">ast_sip_thread_is_servant()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l02171">ami_outbound_registration_detail()</a>, <a class="el" href="../../df/dfd/config__system_8c_source.html#l00314">ast_sip_initialize_dns()</a>, <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00708">ast_sip_initialize_resolver()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05213">ast_sip_push_task_synchronous()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03315">ast_sip_register_service()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02667">chan_pjsip_request_with_stream_topology()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03569">cli_dump_endpt()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01492">current_state_reusable()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05923">reload_module()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01033">sip_outbound_publisher_alloc()</a>, <a class="el" href="../../d3/d17/config__transport_8c_source.html#l00436">sip_transport_state_destroy()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">subscription_tree_destructor()</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05937">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;{</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga77c1258c88c9e98d907a2299934d8de1">ast_sip_thread_is_servant</a>()) {</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      <span class="keywordflow">return</span> sip_task(<a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;   }</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d96/res__pjsip_8c.html#a3d0e736f5afb58090c07900cfc4d57e6">ast_sip_push_task_wait</a>(serializer, sip_task, <a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>);</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;}</div><div class="ttc" id="res__pjsip_8c_html_a3d0e736f5afb58090c07900cfc4d57e6"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a3d0e736f5afb58090c07900cfc4d57e6">ast_sip_push_task_wait</a></div><div class="ttdeci">static int ast_sip_push_task_wait(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05176">res_pjsip.c:5176</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga77c1258c88c9e98d907a2299934d8de1"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga77c1258c88c9e98d907a2299934d8de1">ast_sip_thread_is_servant</a></div><div class="ttdeci">int ast_sip_thread_is_servant(void)</div><div class="ttdoc">Determine if the current thread is a SIP servant thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05321">res_pjsip.c:5321</a></div></div>
<div class="ttc" id="structtask__data_html"><div class="ttname"><a href="../../d1/dd9/structtask__data.html">task_data</a></div><div class="ttdoc">userdata associated with baseline taskprocessor test </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/test__taskprocessor_8c_source.html#l00044">test_taskprocessor.c:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7738011322c50e875837b7550479b88b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7738011322c50e875837b7550479b88b">&#9670;&nbsp;</a></span>ast_sip_sched_is_task_running()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_is_task_running </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the task is currently running. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>not running </td></tr>
    <tr><td class="paramname">1</td><td>running </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00375">375</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">ast_sip_sched_task::is_running</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00225">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordflow">return</span> schtd ? schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">is_running</a> : 0;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_a3ef6fa64af1fbb7665dd8da1bef3fb6e"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">ast_sip_sched_task::is_running</a></div><div class="ttdeci">int is_running</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">pjsip_scheduler.c:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad9666f4c419f7d29a423e41366c9866a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9666f4c419f7d29a423e41366c9866a">&#9670;&nbsp;</a></span>ast_sip_sched_is_task_running_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_is_task_running_by_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the task is currently running. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The task name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>not running or not found </td></tr>
    <tr><td class="paramname">1</td><td>running </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00380">380</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">ast_sip_sched_task::is_running</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00276">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordtype">int</span> is_running;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   schtd = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keywordflow">if</span> (!schtd) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   is_running = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">is_running</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(schtd, -1);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">is_running</a>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00041">pjsip_scheduler.c:41</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a3ef6fa64af1fbb7665dd8da1bef3fb6e"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">ast_sip_sched_task::is_running</a></div><div class="ttdeci">int is_running</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">pjsip_scheduler.c:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga74acadc4e87ea1cea9cdddba4734bccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga74acadc4e87ea1cea9cdddba4734bccc">&#9670;&nbsp;</a></span>ast_sip_sched_task_cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancels the next invocation of a task. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Only cancels future invocations not the currently running invocation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">191</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01598">ao2_unlink</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00610">ast_sched_del()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01829">AST_SIP_SCHED_TASK_TRACK</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00059">ast_sip_sched_task::current_scheduler_id</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">ast_sip_sched_task::flags</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">ast_sip_sched_task::interval</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00241">LOG_DEBUG</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">ast_sip_sched_task::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00642">ast_sip_destroy_scheduler()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00218">ast_sip_sched_task_cancel_by_name()</a>, <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00326">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>, <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00102">scheduler()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01688">sip_options_aor_remove_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01240">sip_options_apply_aor_configuration()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02794">sip_options_cleanup_aor_task()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02094">sip_options_contact_add_task()</a>, and <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02273">sip_options_contact_delete_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/dab/structsched__id.html">sched_id</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span> (schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> &amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709">AST_SIP_SCHED_TASK_TRACK</a>) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Sched %p: Canceling %s\n&quot;</span>, schtd, schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">    * Prevent any tasks in the serializer queue from</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    * running and restarting the scheduled item on us</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">    * first.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(schtd);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a> = 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   sched_id = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#aa637135f34fe2c4ba8914104b0ba9685">current_scheduler_id</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#aa637135f34fe2c4ba8914104b0ba9685">current_scheduler_id</a> = -1;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(schtd);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   res = <a class="code" href="../../d7/d00/sched_8h.html#a3a093634fe17bd0ac4eb6f518aa0782e">ast_sched_del</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#a727b773f6b56ad9d252dc91b86688495">scheduler_context</a>, sched_id);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, schtd);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_ae0c690118932b32ef40a74bb6a259acd"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">ast_sip_sched_task::interval</a></div><div class="ttdeci">int interval</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">pjsip_scheduler.c:57</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_a727b773f6b56ad9d252dc91b86688495"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#a727b773f6b56ad9d252dc91b86688495">scheduler_context</a></div><div class="ttdeci">static struct ast_sched_context * scheduler_context</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00037">pjsip_scheduler.c:37</a></div></div>
<div class="ttc" id="structsched__id_html"><div class="ttname"><a href="../../d1/dab/structsched__id.html">sched_id</a></div><div class="ttdoc">Scheduler ID holder. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00070">sched.c:70</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="logger_8h_html_a6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00241">logger.h:241</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_aa637135f34fe2c4ba8914104b0ba9685"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#aa637135f34fe2c4ba8914104b0ba9685">ast_sip_sched_task::current_scheduler_id</a></div><div class="ttdeci">int current_scheduler_id</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00059">pjsip_scheduler.c:59</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ae21ae1861f048e6bb699f47cbdbeb2b6"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">ast_sip_sched_task::flags</a></div><div class="ttdeci">enum ast_sip_scheduler_task_flags flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">pjsip_scheduler.c:65</a></div></div>
<div class="ttc" id="sched_8h_html_a3a093634fe17bd0ac4eb6f518aa0782e"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a3a093634fe17bd0ac4eb6f518aa0782e">ast_sched_del</a></div><div class="ttdeci">int ast_sched_del(struct ast_sched_context *con, int id) attribute_warn_unused_result</div><div class="ttdoc">Deletes a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00610">sched.c:610</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709">AST_SIP_SCHED_TASK_TRACK</a></div><div class="ttdoc">The scheduled task&amp;#39;s events are tracked in the debug log. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01829">res_pjsip.h:1829</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">ast_sip_sched_task::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">pjsip_scheduler.c:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4bf515a47d663f1762ac337c9167b8e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4bf515a47d663f1762ac337c9167b8e2">&#9670;&nbsp;</a></span>ast_sip_sched_task_cancel_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_cancel_by_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancels the next invocation of a task by name. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The task name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Only cancels future invocations not the currently running invocation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00218">218</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">ast_sip_sched_task_cancel()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00276">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   schtd = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordflow">if</span> (!schtd) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   res = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a>(schtd);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(schtd, -1);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga74acadc4e87ea1cea9cdddba4734bccc"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga74acadc4e87ea1cea9cdddba4734bccc">ast_sip_sched_task_cancel</a></div><div class="ttdeci">int ast_sip_sched_task_cancel(struct ast_sip_sched_task *schtd)</div><div class="ttdoc">Cancels the next invocation of a task. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">pjsip_scheduler.c:191</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00041">pjsip_scheduler.c:41</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga78b7691fb1bf1717a7961a68ceed5886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78b7691fb1bf1717a7961a68ceed5886">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the task name. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00334">334</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">ast_sip_sched_task::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03807">pubsub_on_evsub_state()</a>, and <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03911">pubsub_on_rx_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">if</span> (maxlen &lt;= 0) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(schtd);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, maxlen);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(schtd);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">ast_sip_sched_task::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">pjsip_scheduler.c:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7a0f4a262534b770d745c4e4d99954be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a0f4a262534b770d745c4e4d99954be">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_next_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_next_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of milliseconds until the next invocation. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of milliseconds until the next invocation or -1 if the task isn't scheduled </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00347">347</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">ast_sip_sched_task_get_times2()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00356">ast_sip_sched_task_get_next_run_by_name()</a>, <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00225">AST_TEST_DEFINE()</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00490">cli_show_tasks()</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="keywordtype">int</span> delay;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a>(schtd, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;delay, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="keywordflow">return</span> delay;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga11e333026826de2a22d2a33bb3e0bd01"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a></div><div class="ttdeci">int ast_sip_sched_task_get_times2(struct ast_sip_sched_task *schtd, struct timeval *queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</div><div class="ttdoc">Gets the queued, last start, last_end, time left, interval, next run. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">pjsip_scheduler.c:237</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gabe1d1904d9e3f338f656203cc8f88a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe1d1904d9e3f338f656203cc8f88a74">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_next_run_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_next_run_by_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of milliseconds until the next invocation. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The task name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of milliseconds until the next invocation or -1 if the task isn't scheduled </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00356">356</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00347">ast_sip_sched_task_get_next_run()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00276">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;{</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keywordtype">int</span> next_run;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   schtd = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">if</span> (!schtd) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   next_run = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga7a0f4a262534b770d745c4e4d99954be">ast_sip_sched_task_get_next_run</a>(schtd);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(schtd, -1);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keywordflow">return</span> next_run;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00041">pjsip_scheduler.c:41</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga7a0f4a262534b770d745c4e4d99954be"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga7a0f4a262534b770d745c4e4d99954be">ast_sip_sched_task_get_next_run</a></div><div class="ttdeci">int ast_sip_sched_task_get_next_run(struct ast_sip_sched_task *schtd)</div><div class="ttdoc">Gets the number of milliseconds until the next invocation. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00347">pjsip_scheduler.c:347</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab5f6f4fabd4f24b1958e08530e71aaed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5f6f4fabd4f24b1958e08530e71aaed">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_times </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>when_queued</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the last start and end times of the task. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">when_queued</td><td>Pointer to a timeval structure to contain the time when queued </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_start</td><td>Pointer to a timeval structure to contain the time when last started </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the time when last ended </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Any of the pointers can be NULL if you don't need them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00299">299</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">ast_sip_sched_task_get_times2()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00102">scheduler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a>(schtd, queued, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_a3dbd983b58b4e4c19bec9f9535622e1f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">ast_sip_sched_task::last_start</a></div><div class="ttdeci">struct timeval last_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">pjsip_scheduler.c:51</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga11e333026826de2a22d2a33bb3e0bd01"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a></div><div class="ttdeci">int ast_sip_sched_task_get_times2(struct ast_sip_sched_task *schtd, struct timeval *queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</div><div class="ttdoc">Gets the queued, last start, last_end, time left, interval, next run. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">pjsip_scheduler.c:237</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ac0ed70466949417ad6cb7bee2f77e12f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">ast_sip_sched_task::last_end</a></div><div class="ttdeci">struct timeval last_end</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00053">pjsip_scheduler.c:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga11e333026826de2a22d2a33bb3e0bd01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11e333026826de2a22d2a33bb3e0bd01">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_times2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_times2 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *&#160;</td>
          <td class="paramname"><em>schtd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>when_queued</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>time_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>next_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the queued, last start, last_end, time left, interval, next run. </p>
<dl class="section since"><dt>Since</dt><dd>16.15.0 </dd>
<dd>
18.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">schtd</td><td>The task structure pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">when_queued</td><td>Pointer to a timeval structure to contain the time when queued </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_start</td><td>Pointer to a timeval structure to contain the time when last started </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the time when last ended </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">interval</td><td>Pointer to an int to contain the interval in ms </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">time_left</td><td>Pointer to an int to contain the ms left to the next run </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the next run time </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Any of the pointers can be NULL if you don't need them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">237</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01822">AST_SIP_SCHED_TASK_DELAY</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00226">ast_tv()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l02283">ast_tvadd()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">ast_sip_sched_task::flags</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">ast_sip_sched_task::interval</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">ast_sip_sched_task::is_running</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00053">ast_sip_sched_task::last_end</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">ast_sip_sched_task::last_start</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00049">ast_sip_sched_task::when_queued</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00347">ast_sip_sched_task_get_next_run()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00299">ast_sip_sched_task_get_times()</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00305">ast_sip_sched_task_get_times_by_name2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(schtd);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keywordflow">if</span> (queued) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      memcpy(queued, &amp;schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">when_queued</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      memcpy(<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>, &amp;schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      memcpy(<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>, &amp;schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      *<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a> = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="keywordflow">if</span> (time_left || next_start) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordtype">int</span> delay;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keyword">struct </span>timeval since_when;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keyword">struct </span>timeval now;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">struct </span>timeval next;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordflow">if</span> (schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         delay = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;         now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         <span class="keywordflow">if</span> (schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> &amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a>) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            since_when = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">is_running</a> ? now : schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            since_when = schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>.tv_sec ? schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a> : schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">when_queued</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;         }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;         delay -= <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(now, since_when);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         delay = delay &lt; 0 ? 0 : delay;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <span class="keywordflow">if</span> (time_left) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            *time_left = delay;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="keywordflow">if</span> (next_start) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            next = <a class="code" href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a>(now, <a class="code" href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a>(delay / 1000, (delay % 1000) * 1000));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            memcpy(next_start, &amp;next, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keywordflow">if</span> (time_left) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            *time_left = -1;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(schtd);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_ae0c690118932b32ef40a74bb6a259acd"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">ast_sip_sched_task::interval</a></div><div class="ttdeci">int interval</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">pjsip_scheduler.c:57</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a3dbd983b58b4e4c19bec9f9535622e1f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">ast_sip_sched_task::last_start</a></div><div class="ttdeci">struct timeval last_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">pjsip_scheduler.c:51</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_abb0fce83fa1f6da89603c088e0f411d7"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">ast_sip_sched_task::when_queued</a></div><div class="ttdeci">struct timeval when_queued</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00049">pjsip_scheduler.c:49</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ae21ae1861f048e6bb699f47cbdbeb2b6"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">ast_sip_sched_task::flags</a></div><div class="ttdeci">enum ast_sip_scheduler_task_flags flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">pjsip_scheduler.c:65</a></div></div>
<div class="ttc" id="time_8h_html_a97e1bb8fbd7a103212789e87e7ed6073"><div class="ttname"><a href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a></div><div class="ttdeci">struct timeval ast_tvadd(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the sum of two timevals a + b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02283">extconf.c:2283</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a></div><div class="ttdoc">The next invocation of the task is at last finish + interval. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01822">res_pjsip.h:1822</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ac0ed70466949417ad6cb7bee2f77e12f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">ast_sip_sched_task::last_end</a></div><div class="ttdeci">struct timeval last_end</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00053">pjsip_scheduler.c:53</a></div></div>
<div class="ttc" id="time_8h_html_aebf04439f206cc509472ce4b6da48a5a"><div class="ttname"><a href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a></div><div class="ttdeci">struct timeval ast_tv(ast_time_t sec, ast_suseconds_t usec)</div><div class="ttdoc">Returns a timeval from sec, usec. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00226">time.h:226</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a3ef6fa64af1fbb7665dd8da1bef3fb6e"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3ef6fa64af1fbb7665dd8da1bef3fb6e">ast_sip_sched_task::is_running</a></div><div class="ttdeci">int is_running</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00061">pjsip_scheduler.c:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gafbe3526da1e7a11a4d05173ec3ad70f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafbe3526da1e7a11a4d05173ec3ad70f7">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_times_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_times_by_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>when_queued</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the last start and end times of the task by name. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">name</td><td>The task name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">when_queued</td><td>Pointer to a timeval structure to contain the time when queued </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_start</td><td>Pointer to a timeval structure to contain the time when last started </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the time when last ended </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Any of the pointers can be NULL if you don't need them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00327">327</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00305">ast_sip_sched_task_get_times_by_name2()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gadac4ed564a9f6e11c2436ee897718a38">ast_sip_sched_task_get_times_by_name2</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, queued, last_start, last_end,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gadac4ed564a9f6e11c2436ee897718a38"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gadac4ed564a9f6e11c2436ee897718a38">ast_sip_sched_task_get_times_by_name2</a></div><div class="ttdeci">int ast_sip_sched_task_get_times_by_name2(const char *name, struct timeval *queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</div><div class="ttdoc">Gets the queued, last start, last_end, time left, interval, next run by task name. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00305">pjsip_scheduler.c:305</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gadac4ed564a9f6e11c2436ee897718a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadac4ed564a9f6e11c2436ee897718a38">&#9670;&nbsp;</a></span>ast_sip_sched_task_get_times_by_name2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_sched_task_get_times_by_name2 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>when_queued</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>last_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>time_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>next_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the queued, last start, last_end, time left, interval, next run by task name. </p>
<dl class="section since"><dt>Since</dt><dd>16.15.0 </dd>
<dd>
18.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">name</td><td>The task name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">when_queued</td><td>Pointer to a timeval structure to contain the time when queued </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_start</td><td>Pointer to a timeval structure to contain the time when last started </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the time when last ended </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">interval</td><td>Pointer to an int to contain the interval in ms </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">time_left</td><td>Pointer to an int to contain the ms left to the next run </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_end</td><td>Pointer to a timeval structure to contain the next run time </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Any of the pointers can be NULL if you don't need them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00305">305</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">ast_sip_sched_task_get_times2()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00327">ast_sip_sched_task_get_times_by_name()</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   schtd = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="keywordflow">if</span> (!schtd) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   res = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a>(schtd, queued, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a>, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">last_end</a>, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>, time_left,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      next_start);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(schtd, -1);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_ae0c690118932b32ef40a74bb6a259acd"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">ast_sip_sched_task::interval</a></div><div class="ttdeci">int interval</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">pjsip_scheduler.c:57</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a3dbd983b58b4e4c19bec9f9535622e1f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">ast_sip_sched_task::last_start</a></div><div class="ttdeci">struct timeval last_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">pjsip_scheduler.c:51</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00041">pjsip_scheduler.c:41</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga11e333026826de2a22d2a33bb3e0bd01"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga11e333026826de2a22d2a33bb3e0bd01">ast_sip_sched_task_get_times2</a></div><div class="ttdeci">int ast_sip_sched_task_get_times2(struct ast_sip_sched_task *schtd, struct timeval *queued, struct timeval *last_start, struct timeval *last_end, int *interval, int *time_left, struct timeval *next_start)</div><div class="ttdoc">Gets the queued, last start, last_end, time left, interval, next run. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00237">pjsip_scheduler.c:237</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ac0ed70466949417ad6cb7bee2f77e12f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ac0ed70466949417ad6cb7bee2f77e12f">ast_sip_sched_task::last_end</a></div><div class="ttdeci">struct timeval last_end</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00053">pjsip_scheduler.c:53</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga47a9130b20e7724a51d5eeebbc0a516b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47a9130b20e7724a51d5eeebbc0a516b">&#9670;&nbsp;</a></span>ast_sip_schedule_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a>* ast_sip_schedule_task </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga03d77afe873d5e87809639c520ef2dd0">ast_sip_task</a>&#160;</td>
          <td class="paramname"><em>sip_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d7/dfa/group__pjsip__threading.html#ga478c7100d82665dc492845e4213ebc40">ast_sip_scheduler_task_flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedule a task to run in the res_pjsip thread pool. </p>
<dl class="section since"><dt>Since</dt><dd>13.9.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serializer</td><td>The serializer to use. If NULL, don't use a serializer (see note below) </td></tr>
    <tr><td class="paramname">interval</td><td>The invocation interval in milliseconds (see note below) </td></tr>
    <tr><td class="paramname">sip_task</td><td>The task to invoke </td></tr>
    <tr><td class="paramname">name</td><td>An optional name to associate with the task </td></tr>
    <tr><td class="paramname"><a class="el" href="../../d1/dd9/structtask__data.html" title="userdata associated with baseline taskprocessor test ">task_data</a></td><td>Optional data to pass to the task </td></tr>
    <tr><td class="paramname">flags</td><td>One of enum ast_sip_scheduler_task_type</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to <a class="el" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> ao2 object which must be dereferenced when done.</dd></dl>
<p>Specifying a serializer guarantees serialized execution but NOT specifying a serializer may still result in tasks being effectively serialized if the thread pool is busy. The point of the serializer BTW is not to prevent parallel executions of the SAME task. That happens automatically (see below). It's to prevent the task from running at the same time as other work using the same serializer, whether or not it's being run by the scheduler.</p>
<p>The interval is used to calculate the next time the task should run. There are two models.</p>
<p><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a98c1298ee39720ed9ac1d6af774c4124">AST_SIP_SCHED_TASK_PERIODIC</a> specifies that the invocations of the task occur at the specific interval. That is, every "interval" milliseconds, regardless of how long the task takes. If the task takes longer than interval, it will be scheduled at the next available multiple of interval. For exmaple: If the task has an interval of 60 seconds and the task takes 70 seconds, the next invocation will happen at 120 seconds.</p>
<p><a class="el" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a> specifies that the next invocation of the task should start at interval milliseconds after the current invocation has finished. </p>

<p class="definition">Definition at line <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00415">415</a> of file <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html">pjsip_scheduler.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01598">ao2_unlink</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00238">ast_samp2tv()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01801">AST_SIP_SCHED_TASK_DATA_AO2</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01822">AST_SIP_SCHED_TASK_DELAY</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01829">AST_SIP_SCHED_TASK_TRACK</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00226">ast_tv()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l02283">ast_tvadd()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00059">ast_sip_sched_task::current_scheduler_id</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">ast_sip_sched_task::flags</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c.html#ad67b99fde0615f584720d61f0fcf0937">ID_LEN</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">ast_sip_sched_task::interval</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">ast_sip_sched_task::last_start</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00241">LOG_DEBUG</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">ast_sip_sched_task::name</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00055">ast_sip_sched_task::next_periodic</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00157">push_to_serializer()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00399">schtd_dtor()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00043">ast_sip_sched_task::serializer</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00047">ast_sip_sched_task::task</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00039">task_count</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00045">ast_sip_sched_task::task_data</a>, and <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00049">ast_sip_sched_task::when_queued</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00225">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02929">initial_notify_task()</a>, <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00102">scheduler()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01240">sip_options_apply_aor_configuration()</a>, and <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02094">sip_options_contact_add_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#define ID_LEN 13 </span><span class="comment">/* task_deadbeef */</span><span class="preprocessor"></span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a> *schtd;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a> &lt;= 0) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   schtd = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>((<span class="keyword">sizeof</span>(*schtd) + (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) ? strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) : <a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ad67b99fde0615f584720d61f0fcf0937">ID_LEN</a>) + 1),</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac3cb1b6f9ca3dba3a37b98dc4718b6fa">schtd_dtor</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="keywordflow">if</span> (!schtd) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(serializer);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a63c003da15a293e243af033bc76dfc95">task_data</a> = <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a63c003da15a293e243af033bc76dfc95">task_data</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a2bf3d08fe7db52d3789ccd2ed0ebc1b9">task</a> = sip_task;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a> = <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> = <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">last_start</a> = <a class="code" href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a>(0, 0);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      strcpy(schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>); <span class="comment">/* Safe */</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      uint32_t task_id;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      task_id = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#a860b79007ec25f6298d0e1437c29aba8">task_count</a>, 1);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      sprintf(schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>, <span class="stringliteral">&quot;task_%08x&quot;</span>, task_id);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="keywordflow">if</span> (schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> &amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709">AST_SIP_SCHED_TASK_TRACK</a>) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Sched %p: Scheduling %s for %d ms\n&quot;</span>, schtd, schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">when_queued</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordflow">if</span> (!(schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> &amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a>)) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#aaa0c25bd03f78f9f939f2acfba61893f">next_periodic</a> = <a class="code" href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a>(schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">when_queued</a>,</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         <a class="code" href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a>(schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>, 1000));</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">flags</a> &amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a>) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d1/dd9/structtask__data.html">task_data</a>, +1);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">    * We must put it in the &#39;tasks&#39; container before scheduling</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">    * the task because we don&#39;t want the push_to_serializer()</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">    * sched task to &quot;remove&quot; it on failure before we even put</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    * it in.  If this happens then nothing would remove it from</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">    * the &#39;tasks&#39; container.</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, schtd);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">    * Lock so we are guaranteed to get the sched id set before</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">    * the push_to_serializer() sched task can clear it.</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(schtd);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   res = <a class="code" href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#a727b773f6b56ad9d252dc91b86688495">scheduler_context</a>, <a class="code" href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">interval</a>, <a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#addc77ecc8c8c715bfae6baabcd51e925">push_to_serializer</a>, schtd);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   schtd-&gt;<a class="code" href="../../d5/d3b/structast__sip__sched__task.html#aa637135f34fe2c4ba8914104b0ba9685">current_scheduler_id</a> = res;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(schtd);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(<a class="code" href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a>, schtd);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(schtd, -1);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keywordflow">return</span> schtd;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#undef ID_LEN</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div><div class="ttc" id="structast__sip__sched__task_html_ae0c690118932b32ef40a74bb6a259acd"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae0c690118932b32ef40a74bb6a259acd">ast_sip_sched_task::interval</a></div><div class="ttdeci">int interval</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00057">pjsip_scheduler.c:57</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a3dbd983b58b4e4c19bec9f9535622e1f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a3dbd983b58b4e4c19bec9f9535622e1f">ast_sip_sched_task::last_start</a></div><div class="ttdeci">struct timeval last_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00051">pjsip_scheduler.c:51</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_a727b773f6b56ad9d252dc91b86688495"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#a727b773f6b56ad9d252dc91b86688495">scheduler_context</a></div><div class="ttdeci">static struct ast_sched_context * scheduler_context</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00037">pjsip_scheduler.c:37</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_abb0fce83fa1f6da89603c088e0f411d7"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#abb0fce83fa1f6da89603c088e0f411d7">ast_sip_sched_task::when_queued</a></div><div class="ttdeci">struct timeval when_queued</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00049">pjsip_scheduler.c:49</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a2bf3d08fe7db52d3789ccd2ed0ebc1b9"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a2bf3d08fe7db52d3789ccd2ed0ebc1b9">ast_sip_sched_task::task</a></div><div class="ttdeci">ast_sip_task task</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00047">pjsip_scheduler.c:47</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ad67b99fde0615f584720d61f0fcf0937"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ad67b99fde0615f584720d61f0fcf0937">ID_LEN</a></div><div class="ttdeci">#define ID_LEN</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00241">logger.h:241</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_a63c003da15a293e243af033bc76dfc95"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#a63c003da15a293e243af033bc76dfc95">ast_sip_sched_task::task_data</a></div><div class="ttdeci">void * task_data</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00045">pjsip_scheduler.c:45</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_aa637135f34fe2c4ba8914104b0ba9685"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#aa637135f34fe2c4ba8914104b0ba9685">ast_sip_sched_task::current_scheduler_id</a></div><div class="ttdeci">int current_scheduler_id</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00059">pjsip_scheduler.c:59</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_addc77ecc8c8c715bfae6baabcd51e925"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#addc77ecc8c8c715bfae6baabcd51e925">push_to_serializer</a></div><div class="ttdeci">static int push_to_serializer(const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00157">pjsip_scheduler.c:157</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_aaa0c25bd03f78f9f939f2acfba61893f"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#aaa0c25bd03f78f9f939f2acfba61893f">ast_sip_sched_task::next_periodic</a></div><div class="ttdeci">struct timeval next_periodic</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00055">pjsip_scheduler.c:55</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html">ast_sip_sched_task</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00041">pjsip_scheduler.c:41</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="time_8h_html_a1d774df72e3dbb623475783e06ce4f61"><div class="ttname"><a href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a></div><div class="ttdeci">struct timeval ast_samp2tv(unsigned int _nsamp, unsigned int _rate)</div><div class="ttdoc">Returns a timeval corresponding to the duration of n samples at rate r. Useful to convert samples to ...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00238">time.h:238</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ae21ae1861f048e6bb699f47cbdbeb2b6"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ae21ae1861f048e6bb699f47cbdbeb2b6">ast_sip_sched_task::flags</a></div><div class="ttdeci">enum ast_sip_scheduler_task_flags flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00065">pjsip_scheduler.c:65</a></div></div>
<div class="ttc" id="time_8h_html_a97e1bb8fbd7a103212789e87e7ed6073"><div class="ttname"><a href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a></div><div class="ttdeci">struct timeval ast_tvadd(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the sum of two timevals a + b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02283">extconf.c:2283</a></div></div>
<div class="ttc" id="structtask__data_html"><div class="ttname"><a href="../../d1/dd9/structtask__data.html">task_data</a></div><div class="ttdoc">userdata associated with baseline taskprocessor test </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/test__taskprocessor_8c_source.html#l00044">test_taskprocessor.c:44</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a2f8d5921c4490ee4619824ba6985c29a">AST_SIP_SCHED_TASK_DELAY</a></div><div class="ttdoc">The next invocation of the task is at last finish + interval. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01822">res_pjsip.h:1822</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_a860b79007ec25f6298d0e1437c29aba8"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#a860b79007ec25f6298d0e1437c29aba8">task_count</a></div><div class="ttdeci">static int task_count</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00039">pjsip_scheduler.c:39</a></div></div>
<div class="ttc" id="sched_8h_html_a7a43dcf8be6b2ed7f96f3867fbcb4082"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a></div><div class="ttdeci">int ast_sched_add(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data) attribute_warn_unused_result</div><div class="ttdoc">Adds a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00565">sched.c:565</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40a456eb70a4d55688073e2ec56c3c2c709">AST_SIP_SCHED_TASK_TRACK</a></div><div class="ttdoc">The scheduled task&amp;#39;s events are tracked in the debug log. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01829">res_pjsip.h:1829</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac97df1fe57028a161625f19640582c85"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac97df1fe57028a161625f19640582c85">tasks</a></div><div class="ttdeci">static struct ao2_container * tasks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00038">pjsip_scheduler.c:38</a></div></div>
<div class="ttc" id="time_8h_html_aebf04439f206cc509472ce4b6da48a5a"><div class="ttname"><a href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a></div><div class="ttdeci">struct timeval ast_tv(ast_time_t sec, ast_suseconds_t usec)</div><div class="ttdoc">Returns a timeval from sec, usec. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00226">time.h:226</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_sched_task::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00043">pjsip_scheduler.c:43</a></div></div>
<div class="ttc" id="pjsip__scheduler_8c_html_ac3cb1b6f9ca3dba3a37b98dc4718b6fa"><div class="ttname"><a href="../../de/dfa/pjsip__scheduler_8c.html#ac3cb1b6f9ca3dba3a37b98dc4718b6fa">schtd_dtor</a></div><div class="ttdeci">static void schtd_dtor(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00399">pjsip_scheduler.c:399</a></div></div>
<div class="ttc" id="structast__sip__sched__task_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../d5/d3b/structast__sip__sched__task.html#afd3f693e384b1ee0a0c44d58351eb87d">ast_sip_sched_task::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfa/pjsip__scheduler_8c_source.html#l00067">pjsip_scheduler.c:67</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gga478c7100d82665dc492845e4213ebc40ac5773e910b212c28550aee8a0a42a22a">AST_SIP_SCHED_TASK_DATA_AO2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01801">res_pjsip.h:1801</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga77c1258c88c9e98d907a2299934d8de1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga77c1258c88c9e98d907a2299934d8de1">&#9670;&nbsp;</a></span>ast_sip_thread_is_servant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_thread_is_servant </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the current thread is a SIP servant thread. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>This is not a SIP servant thread </td></tr>
    <tr><td class="paramname">1</td><td>This is a SIP servant thread </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05321">5321</a> of file <a class="el" href="../../de/d96/res__pjsip_8c_source.html">res_pjsip.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7d/threadstorage_8h_source.html#l00197">ast_threadstorage_get()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05293">servant_id_storage</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05294">SIP_SERVANT_ID</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05204">ast_sip_push_task_wait_servant()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00349">refer_progress_destroy()</a>, and <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00063">task_1()</a>.</p>
<div class="fragment"><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;{</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;   uint32_t *servant_id;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d96/res__pjsip_8c.html#a5614ba9f86518c2f28300f340b88f2e7">monitor_thread</a> &amp;&amp;</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;         pthread_self() == *(pthread_t *)pj_thread_get_os_handle(<a class="code" href="../../de/d96/res__pjsip_8c.html#a5614ba9f86518c2f28300f340b88f2e7">monitor_thread</a>)) {</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   }</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   servant_id = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../de/d96/res__pjsip_8c.html#ae18a720e05208f389355777d6b9a1db7">servant_id_storage</a>, <span class="keyword">sizeof</span>(*servant_id));</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordflow">if</span> (!servant_id) {</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;   }</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;   <span class="keywordflow">return</span> *servant_id == <a class="code" href="../../de/d96/res__pjsip_8c.html#a65ff7a79c301b471ec3ea43b533121e9">SIP_SERVANT_ID</a>;</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;}</div><div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a5614ba9f86518c2f28300f340b88f2e7"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a5614ba9f86518c2f28300f340b88f2e7">monitor_thread</a></div><div class="ttdeci">pj_thread_t * monitor_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05274">res_pjsip.c:5274</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a65ff7a79c301b471ec3ea43b533121e9"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a65ff7a79c301b471ec3ea43b533121e9">SIP_SERVANT_ID</a></div><div class="ttdeci">#define SIP_SERVANT_ID</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05294">res_pjsip.c:5294</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_ae18a720e05208f389355777d6b9a1db7"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#ae18a720e05208f389355777d6b9a1db7">servant_id_storage</a></div><div class="ttdeci">static struct ast_threadstorage servant_id_storage</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05293">res_pjsip.c:5293</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:47:15 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
