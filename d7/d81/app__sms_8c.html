<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: app_sms.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">app_sms.c File Reference<div class="ingroups"><a class="el" href="../../d9/dc9/group__applications.html">Dial plan applications</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>SMS application - ETSI ES 201 912 protocol 1 implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dd/df2/paths_8h_source.html">asterisk/paths.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d42/lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d4d/file_8h_source.html">asterisk/file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/db5/alaw_8h_source.html">asterisk/alaw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d93/include_2asterisk_2app_8h_source.html">asterisk/app.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1c/format__cache_8h_source.html">asterisk/format_cache.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for app_sms.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d60/app__sms_8c__incl.png" border="0" usemap="#app__sms_8c" alt=""/></div>
<map name="app__sms_8c" id="app__sms_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="193,453,277,480"/>
<area shape="rect" id="node11" href="../../dd/df2/paths_8h.html" title="Asterisk file paths, configured in asterisk.conf. " alt="" coords="1282,80,1406,107"/>
<area shape="rect" id="node12" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="715,453,829,480"/>
<area shape="rect" id="node20" href="../../d2/d4d/file_8h.html" title="Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. " alt="" coords="2348,304,2455,331"/>
<area shape="rect" id="node23" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1132,155,1271,181"/>
<area shape="rect" id="node25" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1652,379,1767,405"/>
<area shape="rect" id="node43" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="1533,80,1643,107"/>
<area shape="rect" id="node46" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1831,155,1967,181"/>
<area shape="rect" id="node47" href="../../d6/db5/alaw_8h.html" title="A&#45;Law to Signed linear conversion. " alt="" coords="2092,80,2207,107"/>
<area shape="rect" id="node48" href="../../de/d47/callerid_8h.html" title="CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr..." alt="" coords="2231,80,2364,107"/>
<area shape="rect" id="node49" href="../../d3/d93/include_2asterisk_2app_8h.html" title="Application convenience functions, designed to give consistent look and feel to Asterisk apps..." alt="" coords="2060,229,2172,256"/>
<area shape="rect" id="node50" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="2439,80,2615,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="741,603,896,629"/>
<area shape="rect" id="node4" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="179,528,317,555"/>
<area shape="rect" id="node7" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="21,528,155,555"/>
<area shape="rect" id="node5" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="346,603,489,629"/>
<area shape="rect" id="node14" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1014,528,1077,555"/>
<area shape="rect" id="node15" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1244,603,1391,629"/>
<area shape="rect" id="node18" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="839,528,990,555"/>
<area shape="rect" id="node19" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1153,528,1279,555"/>
<area shape="rect" id="node24" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="1393,304,1537,331"/>
<area shape="rect" id="node26" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2131,453,2288,480"/>
<area shape="rect" id="node27" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="1366,229,1525,256"/>
<area shape="rect" id="node28" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="705,304,839,331"/>
<area shape="rect" id="node29" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1174,379,1325,405"/>
<area shape="rect" id="node30" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="1549,229,1713,256"/>
<area shape="rect" id="node31" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="966,304,1093,331"/>
<area shape="rect" id="node32" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1737,229,1884,256"/>
<area shape="rect" id="node33" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="1994,304,2121,331"/>
<area shape="rect" id="node34" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="336,229,443,256"/>
<area shape="rect" id="node35" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="1117,304,1267,331"/>
<area shape="rect" id="node36" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="467,229,629,256"/>
<area shape="rect" id="node37" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="136,379,307,405"/>
<area shape="rect" id="node38" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="195,229,311,256"/>
<area shape="rect" id="node40" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="931,229,1088,256"/>
<area shape="rect" id="node41" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1743,304,1868,331"/>
<area shape="rect" id="node42" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="705,229,855,256"/>
<area shape="rect" id="node39" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="144,304,307,331"/>
<area shape="rect" id="node44" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="1423,155,1550,181"/>
<area shape="rect" id="node45" href="../../d6/dd7/presencestate_8h.html" title="Presence state management. " alt="" coords="1626,155,1806,181"/>
</map>
</div>
</div>
<p><a href="../../d7/d81/app__sms_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/de0/structsms__s.html">sms_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a534407082ad8ffdc07f2143b239e17c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a534407082ad8ffdc07f2143b239e17c6">__OUT_FMT</a>&#160;&#160;&#160;<a class="el" href="../../d9/d29/format__cache_8c.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a></td></tr>
<tr class="separator:a534407082ad8ffdc07f2143b239e17c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fbf8951a3590171e5def3f7d4cd666"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aa4fbf8951a3590171e5def3f7d4cd666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af85a8c6a09856dbb3bc88c829432db58"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#af85a8c6a09856dbb3bc88c829432db58">DIR_TX</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:af85a8c6a09856dbb3bc88c829432db58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c597ad0ac2a2eea8e6653e622742287"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a6c597ad0ac2a2eea8e6653e622742287">DLL2_ACK</a>(h)&#160;&#160;&#160;((h-&gt;framenumber &amp; 1) ? DLL2_SMS_ACK1: <a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a>)</td></tr>
<tr class="separator:a6c597ad0ac2a2eea8e6653e622742287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdd552aa3abf01b520c87815e1c2b24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a8bdd552aa3abf01b520c87815e1c2b24">is16bit</a>(dcs)&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? 0               : (((dcs) &amp; 0xc) == 8) )</td></tr>
<tr class="separator:a8bdd552aa3abf01b520c87815e1c2b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39743cbea53fca38237f049acd4cb834"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a>(dcs)&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? (!((dcs) &amp; 4) ) : (((dcs) &amp; 0xc) == 0) )</td></tr>
<tr class="separator:a39743cbea53fca38237f049acd4cb834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f533f0d22e8b3eac586398fbae67636"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a>(dcs)&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? ( ((dcs) &amp; 4) ) : (((dcs) &amp; 0xc) == 4) )</td></tr>
<tr class="separator:a5f533f0d22e8b3eac586398fbae67636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad88625c032fc5b3a096a60ddd129e2f4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad88625c032fc5b3a096a60ddd129e2f4">MAX_DEBUG_LEN</a>&#160;&#160;&#160;300</td></tr>
<tr class="separator:ad88625c032fc5b3a096a60ddd129e2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6706e49765398fb7ec5e9e4bb66c3e64"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a>&#160;&#160;&#160;(800)</td></tr>
<tr class="separator:a6706e49765398fb7ec5e9e4bb66c3e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ea1fb3f3d1fdc8111f0c54d71afb1c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ae0ea1fb3f3d1fdc8111f0c54d71afb1c">OSYNC_BITS</a>&#160;&#160;&#160;80                      /* initial sync bits */</td></tr>
<tr class="separator:ae0ea1fb3f3d1fdc8111f0c54d71afb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92bf696f8279259f5741564c2c2b2af2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:a92bf696f8279259f5741564c2c2b2af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59f0c328bf0668e86f21b74183de226"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>&#160;&#160;&#160;140</td></tr>
<tr class="separator:ac59f0c328bf0668e86f21b74183de226"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4008af70ba477f60e932df6815dac38d"><td class="memItemLeft" align="right" valign="top">typedef signed short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a></td></tr>
<tr class="separator:a4008af70ba477f60e932df6815dac38d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03faa096cd1695c08d2134dc6ae7d1fe"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d6/de0/structsms__s.html">sms_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a></td></tr>
<tr class="separator:a03faa096cd1695c08d2134dc6ae7d1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aadad57a8949618b7d23705b7d718c9f9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9">message_types</a> { <br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a> = 0x7f, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3494ff7bd605a6ca055b31309459c65a">DLL1_SMS_DATA</a> = 0x11, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a24bdd3ee7147c8b7eb741cec3198925c">DLL1_SMS_ERROR</a> = 0x12, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626">DLL1_SMS_EST</a> = 0x13, 
<br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9af63c95cbe39f23e6ad26f2ba0e9923f8">DLL1_SMS_REL</a> = 0x14, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a79172f5903fec0db6f4db43c6d985969">DLL1_SMS_ACK</a> = 0x15, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5ea467e78e6a31d09860fcb35dec1338">DLL1_SMS_NACK</a> = 0x16, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4">DLL1_SMS_COMPLETE</a> = 0x80, 
<br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a1f477137c2be1ae63f113d7f08683e51">DLL1_SMS_MORE</a> = 0x00, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a> = 0x7f, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5">DLL2_SMS_INFO_MO</a> = 0x10, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b">DLL2_SMS_INFO_MT</a> = 0x11, 
<br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a250be9e2438762a2a98cfa0c90db9f82">DLL2_SMS_INFO_STA</a> = 0x12, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8">DLL2_SMS_NACK</a> = 0x13, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855">DLL2_SMS_ACK0</a> = 0x14, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a> = 0x15, 
<br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae8e8868e7f35bd6dff10f69df0e2b652">DLL2_SMS_ENQ</a> = 0x16, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a> = 0x17, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9adcb4bce99e6a020f51aaad2aa1310735">DLL2_SMS_COMPLETE</a> = 0x00, 
<a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a316b96f57093ff10ba8b88d474e27ed4">DLL2_SMS_MORE</a> = 0x80
<br />
 }</td></tr>
<tr class="separator:aadad57a8949618b7d23705b7d718c9f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aababa9181261edb84572cc841b406377"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377">sms_flags</a> { <br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a> = (1 &lt;&lt; 0), 
<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a> = (1 &lt;&lt; 1), 
<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a> = (1 &lt;&lt; 2), 
<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e">OPTION_PAUSE</a> = (1 &lt;&lt; 3), 
<br />
&#160;&#160;<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a> = (1 &lt;&lt; 4), 
<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a> = (1 &lt;&lt; 5), 
<a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a> = (1 &lt;&lt; 6)
<br />
 }</td></tr>
<tr class="separator:aababa9181261edb84572cc841b406377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30018397b8c531631257fc773ce07f27"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27">sms_opt_args</a> { <a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a> = 0, 
<a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b">OPTION_ARG_ARRAY_SIZE</a>
 }</td></tr>
<tr class="separator:a30018397b8c531631257fc773ce07f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adfb54a6105314c1847b33ff2b7f24fb9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, unsigned char msg, char *data, int size)</td></tr>
<tr class="separator:adfb54a6105314c1847b33ff2b7f24fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63ec69d41a470033bb3b274745c9a2c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a63ec69d41a470033bb3b274745c9a2c1">AST_MODULE_INFO_STANDARD_EXTENDED</a> (<a class="el" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, &quot;SMS/PSTN <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>&quot;)</td></tr>
<tr class="separator:a63ec69d41a470033bb3b274745c9a2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82dbf6bb6292091b6f9ac19cc841428"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a> (time_t t, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="memdesc:aa82dbf6bb6292091b6f9ac19cc841428"><td class="mdescLeft">&#160;</td><td class="mdescRight">static, return a date/time in ISO format  <a href="#aa82dbf6bb6292091b6f9ac19cc841428">More...</a><br /></td></tr>
<tr class="separator:aa82dbf6bb6292091b6f9ac19cc841428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660b5407faba61b0835356de97c78a0c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a660b5407faba61b0835356de97c78a0c">numcpy</a> (char *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, char *s)</td></tr>
<tr class="memdesc:a660b5407faba61b0835356de97c78a0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">copy number, skipping non digits apart from leading +  <a href="#a660b5407faba61b0835356de97c78a0c">More...</a><br /></td></tr>
<tr class="separator:a660b5407faba61b0835356de97c78a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea46af6597884cf32d85f18a52129711"><td class="memItemLeft" align="right" valign="top">static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aea46af6597884cf32d85f18a52129711">packaddress</a> (unsigned char *o, char *i)</td></tr>
<tr class="memdesc:aea46af6597884cf32d85f18a52129711"><td class="mdescLeft">&#160;</td><td class="mdescRight">store an address at o, and return number of bytes used  <a href="#aea46af6597884cf32d85f18a52129711">More...</a><br /></td></tr>
<tr class="separator:aea46af6597884cf32d85f18a52129711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a902aeb4504023853fd6f91429a2855e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a902aeb4504023853fd6f91429a2855e3">packdate</a> (unsigned char *o, time_t w)</td></tr>
<tr class="memdesc:a902aeb4504023853fd6f91429a2855e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">pack a date and return  <a href="#a902aeb4504023853fd6f91429a2855e3">More...</a><br /></td></tr>
<tr class="separator:a902aeb4504023853fd6f91429a2855e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e1bebc872822985359d2e36c1c0448"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a38e1bebc872822985359d2e36c1c0448">packsms</a> (unsigned char dcs, unsigned char *base, unsigned int udhl, unsigned char *udh, int udl, unsigned short *ud)</td></tr>
<tr class="memdesc:a38e1bebc872822985359d2e36c1c0448"><td class="mdescLeft">&#160;</td><td class="mdescRight">general pack, with length and data, returns number of bytes of target used  <a href="#a38e1bebc872822985359d2e36c1c0448">More...</a><br /></td></tr>
<tr class="separator:a38e1bebc872822985359d2e36c1c0448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ab80a9e6251174378df1f59b5dbc44"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a> (unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</td></tr>
<tr class="memdesc:a77ab80a9e6251174378df1f59b5dbc44"><td class="mdescLeft">&#160;</td><td class="mdescRight">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using 16 bit UCS-2 character codes The return value is the number of bytes packed in to o, which is internally limited to 140 o can be null, in which case this is used to validate or count only if the input contains invalid characters then the return value is -1  <a href="#a77ab80a9e6251174378df1f59b5dbc44">More...</a><br /></td></tr>
<tr class="separator:a77ab80a9e6251174378df1f59b5dbc44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172d0c2bb9c8a56df817acb5ce7bfe3c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a> (unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</td></tr>
<tr class="memdesc:a172d0c2bb9c8a56df817acb5ce7bfe3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using SMS 7 bit character codes  <a href="#a172d0c2bb9c8a56df817acb5ce7bfe3c">More...</a><br /></td></tr>
<tr class="separator:a172d0c2bb9c8a56df817acb5ce7bfe3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3645875887568a20059ae86c7a66f74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a> (unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</td></tr>
<tr class="memdesc:aa3645875887568a20059ae86c7a66f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using 8 bit character codes. The return value is the number of bytes packed in to o, which is internally limited to 140. o can be null, in which case this is used to validate or count only. if the input contains invalid characters then the return value is -1  <a href="#aa3645875887568a20059ae86c7a66f74">More...</a><br /></td></tr>
<tr class="separator:aa3645875887568a20059ae86c7a66f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70757b19c8a274d21a1f935767d41426"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a70757b19c8a274d21a1f935767d41426">putdummydata_proto2</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="separator:a70757b19c8a274d21a1f935767d41426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8206bb9c2adf04e478cd8e01bd5a94"><td class="memItemLeft" align="right" valign="top">static struct dirent *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#abe8206bb9c2adf04e478cd8e01bd5a94">readdirqueue</a> (DIR *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, char *queue)</td></tr>
<tr class="memdesc:abe8206bb9c2adf04e478cd8e01bd5a94"><td class="mdescLeft">&#160;</td><td class="mdescRight">read dir skipping dot files...  <a href="#abe8206bb9c2adf04e478cd8e01bd5a94">More...</a><br /></td></tr>
<tr class="separator:abe8206bb9c2adf04e478cd8e01bd5a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ab7b172d33e28647b2383346814b9f"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a44ab7b172d33e28647b2383346814b9f">sms_alloc</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, void *sms_t_ptr)</td></tr>
<tr class="separator:a44ab7b172d33e28647b2383346814b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184a0ba43954b42a5db9a1b1a4854ccb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a184a0ba43954b42a5db9a1b1a4854ccb">sms_compose1</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, int more)</td></tr>
<tr class="memdesc:a184a0ba43954b42a5db9a1b1a4854ccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">compose a message for protocol 1  <a href="#a184a0ba43954b42a5db9a1b1a4854ccb">More...</a><br /></td></tr>
<tr class="separator:a184a0ba43954b42a5db9a1b1a4854ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cea080950ce2066ed4987ee16fcb8d5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a4cea080950ce2066ed4987ee16fcb8d5">sms_compose2</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, int more)</td></tr>
<tr class="separator:a4cea080950ce2066ed4987ee16fcb8d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1ab10167ae5ed9af8793c90c10c475"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aec1ab10167ae5ed9af8793c90c10c475">sms_debug</a> (int dir, <a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="separator:aec1ab10167ae5ed9af8793c90c10c475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953a457af7be98e271a1cac368c71e67"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a953a457af7be98e271a1cac368c71e67">sms_exec</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *data)</td></tr>
<tr class="separator:a953a457af7be98e271a1cac368c71e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda4211248e1b0e0083be7bd80a7d4b0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#afda4211248e1b0e0083be7bd80a7d4b0">sms_generate</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, void *data, int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, int samples)</td></tr>
<tr class="separator:afda4211248e1b0e0083be7bd80a7d4b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43baf6d9daec56e893ebc9c204d852f3"><td class="memItemLeft" align="right" valign="top">static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a43baf6d9daec56e893ebc9c204d852f3">sms_handleincoming</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="memdesc:a43baf6d9daec56e893ebc9c204d852f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">handle the incoming message  <a href="#a43baf6d9daec56e893ebc9c204d852f3">More...</a><br /></td></tr>
<tr class="separator:a43baf6d9daec56e893ebc9c204d852f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3cb96a3f20c144ab6eabc4f6f7304e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ace3cb96a3f20c144ab6eabc4f6f7304e">sms_handleincoming_proto2</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="memdesc:ace3cb96a3f20c144ab6eabc4f6f7304e"><td class="mdescLeft">&#160;</td><td class="mdescRight">sms_handleincoming_proto2: handle the incoming message  <a href="#ace3cb96a3f20c144ab6eabc4f6f7304e">More...</a><br /></td></tr>
<tr class="separator:ace3cb96a3f20c144ab6eabc4f6f7304e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9bfb13333d20c981dfa1de202ee13f"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a5f9bfb13333d20c981dfa1de202ee13f">sms_hexdump</a> (unsigned char <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[], int size, char *s)</td></tr>
<tr class="separator:a5f9bfb13333d20c981dfa1de202ee13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e0ab37f40bc7f8885617847ffd3fee"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, char <a class="el" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</td></tr>
<tr class="memdesc:ad5e0ab37f40bc7f8885617847ffd3fee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log the output, and remove file.  <a href="#ad5e0ab37f40bc7f8885617847ffd3fee">More...</a><br /></td></tr>
<tr class="separator:ad5e0ab37f40bc7f8885617847ffd3fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b70dbd9b6b663969974c877a202d61"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a24b70dbd9b6b663969974c877a202d61">sms_messagerx</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="separator:a24b70dbd9b6b663969974c877a202d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92b5f49b3da5a82098a3011f8bb7947"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa92b5f49b3da5a82098a3011f8bb7947">sms_messagerx2</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="separator:aa92b5f49b3da5a82098a3011f8bb7947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47041feede8f04106f4d6221af763e9d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="separator:a47041feede8f04106f4d6221af763e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb45147ec48b5972784c3cf3086d147"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="memdesc:aacb45147ec48b5972784c3cf3086d147"><td class="mdescLeft">&#160;</td><td class="mdescRight">find and fill in next message, or send a REL if none waiting  <a href="#aacb45147ec48b5972784c3cf3086d147">More...</a><br /></td></tr>
<tr class="separator:aacb45147ec48b5972784c3cf3086d147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1cc2166cf9b6a4496caf3bb1d11cb6e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa1cc2166cf9b6a4496caf3bb1d11cb6e">sms_process</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, int samples, signed short *data)</td></tr>
<tr class="separator:aa1cc2166cf9b6a4496caf3bb1d11cb6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35be9014d402309539c591ab37a4e7c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a35be9014d402309539c591ab37a4e7c4">sms_readfile</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h, char *fn)</td></tr>
<tr class="memdesc:a35be9014d402309539c591ab37a4e7c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">parse and delete a file  <a href="#a35be9014d402309539c591ab37a4e7c4">More...</a><br /></td></tr>
<tr class="separator:a35be9014d402309539c591ab37a4e7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0fd8690c8108023eafe2da490478f56"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ab0fd8690c8108023eafe2da490478f56">sms_release</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, void *data)</td></tr>
<tr class="separator:ab0fd8690c8108023eafe2da490478f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45fa5279582c213474672cf0684d219"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a> (<a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *h)</td></tr>
<tr class="memdesc:af45fa5279582c213474672cf0684d219"><td class="mdescLeft">&#160;</td><td class="mdescRight">white a received text message to a file  <a href="#af45fa5279582c213474672cf0684d219">More...</a><br /></td></tr>
<tr class="separator:af45fa5279582c213474672cf0684d219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad38c7ea91c75338009d7ef07df937ee9"><td class="memItemLeft" align="right" valign="top">static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad38c7ea91c75338009d7ef07df937ee9">unpackaddress</a> (char *o, unsigned char *i)</td></tr>
<tr class="memdesc:ad38c7ea91c75338009d7ef07df937ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpack an address from i, return byte length, unpack to o  <a href="#ad38c7ea91c75338009d7ef07df937ee9">More...</a><br /></td></tr>
<tr class="separator:ad38c7ea91c75338009d7ef07df937ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c221ca909fed50cb51bd59b0855bc68"><td class="memItemLeft" align="right" valign="top">static struct timeval&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a7c221ca909fed50cb51bd59b0855bc68">unpackdate</a> (unsigned char *i)</td></tr>
<tr class="memdesc:a7c221ca909fed50cb51bd59b0855bc68"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpack a date and return  <a href="#a7c221ca909fed50cb51bd59b0855bc68">More...</a><br /></td></tr>
<tr class="separator:a7c221ca909fed50cb51bd59b0855bc68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec2365c36d7af29acf3bdaad02b082a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a0ec2365c36d7af29acf3bdaad02b082a">unpacksms</a> (unsigned char dcs, unsigned char *i, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</td></tr>
<tr class="memdesc:a0ec2365c36d7af29acf3bdaad02b082a"><td class="mdescLeft">&#160;</td><td class="mdescRight">general unpack - starts with length byte (octet or septet) and returns number of bytes used, inc length  <a href="#a0ec2365c36d7af29acf3bdaad02b082a">More...</a><br /></td></tr>
<tr class="separator:a0ec2365c36d7af29acf3bdaad02b082a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53eb989ad561eab70f9002277d99703"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ab53eb989ad561eab70f9002277d99703">unpacksms16</a> (unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</td></tr>
<tr class="memdesc:ab53eb989ad561eab70f9002277d99703"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpacks bytes (16 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set  <a href="#ab53eb989ad561eab70f9002277d99703">More...</a><br /></td></tr>
<tr class="separator:ab53eb989ad561eab70f9002277d99703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa65901d23702596493c076cac99112f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#aa65901d23702596493c076cac99112f0">unpacksms7</a> (unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</td></tr>
<tr class="memdesc:aa65901d23702596493c076cac99112f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpacks bytes (7 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set  <a href="#aa65901d23702596493c076cac99112f0">More...</a><br /></td></tr>
<tr class="separator:aa65901d23702596493c076cac99112f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1ce90cce234e2c4dc75da9046c21b5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a6b1ce90cce234e2c4dc75da9046c21b5">unpacksms8</a> (unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</td></tr>
<tr class="memdesc:a6b1ce90cce234e2c4dc75da9046c21b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpacks bytes (8 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set.  <a href="#a6b1ce90cce234e2c4dc75da9046c21b5">More...</a><br /></td></tr>
<tr class="separator:a6b1ce90cce234e2c4dc75da9046c21b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375cda00ad33985349625ad6f8ae70ef"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a375cda00ad33985349625ad6f8ae70ef">utf8decode</a> (unsigned char **pp)</td></tr>
<tr class="memdesc:a375cda00ad33985349625ad6f8ae70ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads next UCS character from NUL terminated UTF-8 string and advance pointer.  <a href="#a375cda00ad33985349625ad6f8ae70ef">More...</a><br /></td></tr>
<tr class="separator:a375cda00ad33985349625ad6f8ae70ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9e5f57131367eff409b9e0bd7b31aa1a"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a> = &quot;SMS&quot;</td></tr>
<tr class="separator:a9e5f57131367eff409b9e0bd7b31aa1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34ddced579016642f988389bc44752c0"><td class="memItemLeft" align="right" valign="top">static const unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a34ddced579016642f988389bc44752c0">defaultalphabet</a> []</td></tr>
<tr class="separator:a34ddced579016642f988389bc44752c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ca3c30c6f517d2f8ebd04edae4d892"><td class="memItemLeft" align="right" valign="top">static const unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a> []</td></tr>
<tr class="separator:a70ca3c30c6f517d2f8ebd04edae4d892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0345d4821606480fcb0e28327340660"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a> [255]</td></tr>
<tr class="separator:ad0345d4821606480fcb0e28327340660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e5e2d705fb17b7f583cd711a5d47467"><td class="memItemLeft" align="right" valign="top">static volatile unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a0e5e2d705fb17b7f583cd711a5d47467">message_ref</a></td></tr>
<tr class="separator:a0e5e2d705fb17b7f583cd711a5d47467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8514112da88a5d13451aaf8c9b064017"><td class="memItemLeft" align="right" valign="top">static volatile unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a></td></tr>
<tr class="separator:a8514112da88a5d13451aaf8c9b064017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f9cbcaee3a56eb068a387e9e6600e2"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../d2/d8d/structast__app__option.html">ast_app_option</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#ad4f9cbcaee3a56eb068a387e9e6600e2">sms_options</a> [128] = { [ 's' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a> }, [ '<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a> }, [ 't' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a> }, [ 'r' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a> }, [ 'o' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a> }, [ 'n' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a> }, [ 'p' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e">OPTION_PAUSE</a> , .arg_index = <a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a> + 1 }, }</td></tr>
<tr class="separator:ad4f9cbcaee3a56eb068a387e9e6600e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1905c14fd0a53bc591a77d9bb4d029ca"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2a/structast__generator.html">ast_generator</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a1905c14fd0a53bc591a77d9bb4d029ca">smsgen</a></td></tr>
<tr class="separator:a1905c14fd0a53bc591a77d9bb4d029ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe867fed599c026df3020fca010dafdd"><td class="memItemLeft" align="right" valign="top">static const signed short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a> []</td></tr>
<tr class="separator:abe867fed599c026df3020fca010dafdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6c81d0dd59e7e04ac232639a5db460"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d81/app__sms_8c.html#a1c6c81d0dd59e7e04ac232639a5db460">wave_out</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a></td></tr>
<tr class="separator:a1c6c81d0dd59e7e04ac232639a5db460"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SMS application - ETSI ES 201 912 protocol 1 implementation. </p>
<dl class="section user"><dt>Development notes</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>The ETSI standards are available free of charge from ETSI at <a href="http://pda.etsi.org/pda/queryform.asp">http://pda.etsi.org/pda/queryform.asp</a> Among the relevant documents here we have:</dd></dl>
<p>ES 201 912 SMS for PSTN/ISDN TS 123 040 Technical realization of SMS</p>
<dl class="section author"><dt>Author</dt><dd>Adrian Kennard (for the original protocol 1 code) </dd>
<dd>
Filippo Grassilli (Hyppo) - protocol 2 support Not fully tested, under development </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a534407082ad8ffdc07f2143b239e17c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a534407082ad8ffdc07f2143b239e17c6">&#9670;&nbsp;</a></span>__OUT_FMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __OUT_FMT&#160;&#160;&#160;<a class="el" href="../../d9/d29/format__cache_8c.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00149">149</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01604">sms_generate()</a>.</p>

</div>
</div>
<a id="aa4fbf8951a3590171e5def3f7d4cd666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4fbf8951a3590171e5def3f7d4cd666">&#9670;&nbsp;</a></span>DIR_RX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIR_RX&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01483">1483</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01485">sms_debug()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>.</p>

</div>
</div>
<a id="af85a8c6a09856dbb3bc88c829432db58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af85a8c6a09856dbb3bc88c829432db58">&#9670;&nbsp;</a></span>DIR_TX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIR_TX&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01484">1484</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>.</p>

</div>
</div>
<a id="a6c597ad0ac2a2eea8e6653e622742287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c597ad0ac2a2eea8e6653e622742287">&#9670;&nbsp;</a></span>DLL2_ACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DLL2_ACK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h</td><td>)</td>
          <td>&#160;&#160;&#160;((h-&gt;framenumber &amp; 1) ? DLL2_SMS_ACK1: <a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>.</p>

</div>
</div>
<a id="a8bdd552aa3abf01b520c87815e1c2b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bdd552aa3abf01b520c87815e1c2b24">&#9670;&nbsp;</a></span>is16bit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define is16bit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dcs</td><td>)</td>
          <td>&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? 0               : (((dcs) &amp; 0xc) == 8) )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00283">283</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>

</div>
</div>
<a id="a39743cbea53fca38237f049acd4cb834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39743cbea53fca38237f049acd4cb834">&#9670;&nbsp;</a></span>is7bit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define is7bit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dcs</td><td>)</td>
          <td>&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? (!((dcs) &amp; 4) ) : (((dcs) &amp; 0xc) == 0) )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00281">281</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>.</p>

</div>
</div>
<a id="a5f533f0d22e8b3eac586398fbae67636"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f533f0d22e8b3eac586398fbae67636">&#9670;&nbsp;</a></span>is8bit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define is8bit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dcs</td><td>)</td>
          <td>&#160;&#160;&#160;( ((dcs) &amp; 0xC0) ? ( ((dcs) &amp; 4) ) : (((dcs) &amp; 0xc) == 4) )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00282">282</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>.</p>

</div>
</div>
<a id="ad88625c032fc5b3a096a60ddd129e2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad88625c032fc5b3a096a60ddd129e2f4">&#9670;&nbsp;</a></span>MAX_DEBUG_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DEBUG_LEN&#160;&#160;&#160;300</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01248">1248</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01249">sms_hexdump()</a>.</p>

</div>
</div>
<a id="a6706e49765398fb7ec5e9e4bb66c3e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6706e49765398fb7ec5e9e4bb66c3e64">&#9670;&nbsp;</a></span>MAXSAMPLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXSAMPLES&#160;&#160;&#160;(800)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01604">sms_generate()</a>.</p>

</div>
</div>
<a id="ae0ea1fb3f3d1fdc8111f0c54d71afb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ea1fb3f3d1fdc8111f0c54d71afb1c">&#9670;&nbsp;</a></span>OSYNC_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSYNC_BITS&#160;&#160;&#160;80                      /* initial sync bits */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00152">152</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>.</p>

</div>
</div>
<a id="a92bf696f8279259f5741564c2c2b2af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92bf696f8279259f5741564c2c2b2af2">&#9670;&nbsp;</a></span>SMSLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMSLEN&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>max SMS length </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00215">215</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>

</div>
</div>
<a id="ac59f0c328bf0668e86f21b74183de226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac59f0c328bf0668e86f21b74183de226">&#9670;&nbsp;</a></span>SMSLEN_8</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMSLEN_8&#160;&#160;&#160;140</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>max SMS length for 8-bit char </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00216">216</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00485">packsms16()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00446">packsms8()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a4008af70ba477f60e932df6815dac38d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4008af70ba477f60e932df6815dac38d">&#9670;&nbsp;</a></span>output_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef signed short <a class="el" href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00147">147</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

</div>
</div>
<a id="a03faa096cd1695c08d2134dc6ae7d1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03faa096cd1695c08d2134dc6ae7d1fe">&#9670;&nbsp;</a></span>sms_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d6/de0/structsms__s.html">sms_s</a>  <a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aadad57a8949618b7d23705b7d718c9f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadad57a8949618b7d23705b7d718c9f9">&#9670;&nbsp;</a></span>message_types</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9">message_types</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The SMS spec ETSI ES 201 912 defines two protocols with different message types. Also note that the high bit is used to indicate whether the message is complete or not, but in two opposite ways: for Protocol 1, 0x80 means that the message is complete; for Protocol 2, 0x00 means that the message is complete; </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6"></a>DLL_SMS_MASK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a3494ff7bd605a6ca055b31309459c65a"></a>DLL1_SMS_DATA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a24bdd3ee7147c8b7eb741cec3198925c"></a>DLL1_SMS_ERROR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626"></a>DLL1_SMS_EST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9af63c95cbe39f23e6ad26f2ba0e9923f8"></a>DLL1_SMS_REL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a79172f5903fec0db6f4db43c6d985969"></a>DLL1_SMS_ACK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a5ea467e78e6a31d09860fcb35dec1338"></a>DLL1_SMS_NACK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4"></a>DLL1_SMS_COMPLETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a1f477137c2be1ae63f113d7f08683e51"></a>DLL1_SMS_MORE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f"></a>DLL2_SMS_EST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5"></a>DLL2_SMS_INFO_MO&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b"></a>DLL2_SMS_INFO_MT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a250be9e2438762a2a98cfa0c90db9f82"></a>DLL2_SMS_INFO_STA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8"></a>DLL2_SMS_NACK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855"></a>DLL2_SMS_ACK0&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a"></a>DLL2_SMS_ACK1&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9ae8e8868e7f35bd6dff10f69df0e2b652"></a>DLL2_SMS_ENQ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf"></a>DLL2_SMS_REL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9adcb4bce99e6a020f51aaad2aa1310735"></a>DLL2_SMS_COMPLETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aadad57a8949618b7d23705b7d718c9f9a316b96f57093ff10ba8b88d474e27ed4"></a>DLL2_SMS_MORE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00161">161</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                   {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a>        = 0x7f,             <span class="comment">/* mask for the valid bits */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="comment">/* Protocol 1 values */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3494ff7bd605a6ca055b31309459c65a">DLL1_SMS_DATA</a>       = 0x11,             <span class="comment">/* data packet */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a24bdd3ee7147c8b7eb741cec3198925c">DLL1_SMS_ERROR</a>      = 0x12,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626">DLL1_SMS_EST</a>        = 0x13,             <span class="comment">/* start the connection */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9af63c95cbe39f23e6ad26f2ba0e9923f8">DLL1_SMS_REL</a>        = 0x14,             <span class="comment">/* end the connection */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a79172f5903fec0db6f4db43c6d985969">DLL1_SMS_ACK</a>        = 0x15,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5ea467e78e6a31d09860fcb35dec1338">DLL1_SMS_NACK</a>       = 0x16,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4">DLL1_SMS_COMPLETE</a>   = 0x80,             <span class="comment">/* packet is complete */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a1f477137c2be1ae63f113d7f08683e51">DLL1_SMS_MORE</a>       = 0x00,             <span class="comment">/* more data to follow */</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="comment">/* Protocol 2 values */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a>        = 0x7f,             <span class="comment">/* magic number. No message body */</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5">DLL2_SMS_INFO_MO</a>    = 0x10,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b">DLL2_SMS_INFO_MT</a>    = 0x11,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a250be9e2438762a2a98cfa0c90db9f82">DLL2_SMS_INFO_STA</a>   = 0x12,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8">DLL2_SMS_NACK</a>       = 0x13,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855">DLL2_SMS_ACK0</a>       = 0x14,             <span class="comment">/* ack even-numbered frame */</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a>       = 0x15,             <span class="comment">/* ack odd-numbered frame */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae8e8868e7f35bd6dff10f69df0e2b652">DLL2_SMS_ENQ</a>        = 0x16,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a>        = 0x17,             <span class="comment">/* end the connection */</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9adcb4bce99e6a020f51aaad2aa1310735">DLL2_SMS_COMPLETE</a>   = 0x00,             <span class="comment">/* packet is complete */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a316b96f57093ff10ba8b88d474e27ed4">DLL2_SMS_MORE</a>       = 0x80,             <span class="comment">/* more data to follow */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;};</div><div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9af63c95cbe39f23e6ad26f2ba0e9923f8"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9af63c95cbe39f23e6ad26f2ba0e9923f8">DLL1_SMS_REL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00168">app_sms.c:168</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a24bdd3ee7147c8b7eb741cec3198925c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a24bdd3ee7147c8b7eb741cec3198925c">DLL1_SMS_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00166">app_sms.c:166</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8">DLL2_SMS_NACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00180">app_sms.c:180</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a79172f5903fec0db6f4db43c6d985969"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a79172f5903fec0db6f4db43c6d985969">DLL1_SMS_ACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00169">app_sms.c:169</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a1f477137c2be1ae63f113d7f08683e51"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a1f477137c2be1ae63f113d7f08683e51">DLL1_SMS_MORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00173">app_sms.c:173</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9adcb4bce99e6a020f51aaad2aa1310735"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9adcb4bce99e6a020f51aaad2aa1310735">DLL2_SMS_COMPLETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00186">app_sms.c:186</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a316b96f57093ff10ba8b88d474e27ed4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a316b96f57093ff10ba8b88d474e27ed4">DLL2_SMS_MORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00187">app_sms.c:187</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a250be9e2438762a2a98cfa0c90db9f82"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a250be9e2438762a2a98cfa0c90db9f82">DLL2_SMS_INFO_STA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00179">app_sms.c:179</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5">DLL2_SMS_INFO_MO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00177">app_sms.c:177</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4">DLL1_SMS_COMPLETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00172">app_sms.c:172</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855">DLL2_SMS_ACK0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00181">app_sms.c:181</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b">DLL2_SMS_INFO_MT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00178">app_sms.c:178</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00184">app_sms.c:184</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00182">app_sms.c:182</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00176">app_sms.c:176</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9ae8e8868e7f35bd6dff10f69df0e2b652"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae8e8868e7f35bd6dff10f69df0e2b652">DLL2_SMS_ENQ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00183">app_sms.c:183</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626">DLL1_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00167">app_sms.c:167</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00162">app_sms.c:162</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a3494ff7bd605a6ca055b31309459c65a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3494ff7bd605a6ca055b31309459c65a">DLL1_SMS_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00165">app_sms.c:165</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a5ea467e78e6a31d09860fcb35dec1338"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5ea467e78e6a31d09860fcb35dec1338">DLL1_SMS_NACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00170">app_sms.c:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aababa9181261edb84572cc841b406377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aababa9181261edb84572cc841b406377">&#9670;&nbsp;</a></span>sms_flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377">sms_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9"></a>OPTION_BE_SMSC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53"></a>OPTION_ANSWER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4"></a>OPTION_TWO&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e"></a>OPTION_PAUSE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695"></a>OPTION_SRR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781"></a>OPTION_DCS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70"></a>OPTIONS_NO_LOG&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01856">1856</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;               {</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a> = (1 &lt;&lt; 0),             <span class="comment">/* act as sms center */</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a>  = (1 &lt;&lt; 1),             <span class="comment">/* answer on incoming calls */</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a>  = (1 &lt;&lt; 2),                 <span class="comment">/* Use Protocol Two */</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e">OPTION_PAUSE</a>   = (1 &lt;&lt; 3),             <span class="comment">/* pause before sending data, in ms */</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a>  = (1 &lt;&lt; 4),                 <span class="comment">/* set srr */</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a>  = (1 &lt;&lt; 5),                 <span class="comment">/* set dcs */</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a> = (1 &lt;&lt; 6),             <span class="comment">/* Don&#39;t log SMS content */</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;};</div><div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01863">app_sms.c:1863</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01858">app_sms.c:1858</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e">OPTION_PAUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01860">app_sms.c:1860</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01861">app_sms.c:1861</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01859">app_sms.c:1859</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01857">app_sms.c:1857</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01862">app_sms.c:1862</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30018397b8c531631257fc773ce07f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30018397b8c531631257fc773ce07f27">&#9670;&nbsp;</a></span>sms_opt_args</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27">sms_opt_args</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567"></a>OPTION_ARG_PAUSE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b"></a>OPTION_ARG_ARRAY_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01866">1866</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                  {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a> = 0,</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b">OPTION_ARG_ARRAY_SIZE</a></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;};</div><div class="ttc" id="app__sms_8c_html_a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01867">app_sms.c:1867</a></div></div>
<div class="ttc" id="app__sms_8c_html_a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b">OPTION_ARG_ARRAY_SIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01868">app_sms.c:1868</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="adfb54a6105314c1847b33ff2b7f24fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb54a6105314c1847b33ff2b7f24fb9">&#9670;&nbsp;</a></span>adddata_proto2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void adddata_proto2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add data to a protocol 2 message. Use the length field (h-&gt;omsg[1]) as a pointer to the next free position. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01188">1188</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01205">putdummydata_proto2()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01213">sms_compose2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;{</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   <span class="keywordtype">int</span> x = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] + 2;                 <span class="comment">/* Get current position */</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   <span class="keywordflow">if</span> (x == 2) {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      x += 2;                             <span class="comment">/* First: skip Payload length (set later) */</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[x++] = msg;                     <span class="comment">/* Message code */</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[x++] = (<span class="keywordtype">unsigned</span> char)size;     <span class="comment">/* Data size Low */</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[x++] = 0;                       <span class="comment">/* Data size Hi */</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   <span class="keywordflow">for</span> (; size &gt; 0 ; size--) {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[x++] = *data++;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = x - 2;                     <span class="comment">/* Frame size */</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = x - 4;                     <span class="comment">/* Payload length (Lo) */</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[3] = 0;                         <span class="comment">/* Payload length (Hi) */</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;}</div><div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a63ec69d41a470033bb3b274745c9a2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63ec69d41a470033bb3b274745c9a2c1">&#9670;&nbsp;</a></span>AST_MODULE_INFO_STANDARD_EXTENDED()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_MODULE_INFO_STANDARD_EXTENDED </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;SMS/PSTN <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">load_module()</a>.</p>

</div>
</div>
<a id="aa82dbf6bb6292091b6f9ac19cc841428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa82dbf6bb6292091b6f9ac19cc841428">&#9670;&nbsp;</a></span>isodate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* isodate </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>static, return a date/time in ISO format </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00303">303</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/df8/localtime_8c_source.html#l01739">ast_localtime()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l02524">ast_strftime()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">sms_log()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">sms_writefile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> tm;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="keyword">struct </span>timeval local = { t, 0 };</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;local, &amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, <span class="stringliteral">&quot;%Y-%m-%dT%H:%M:%S&quot;</span>, &amp;tm);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="localtime_8h_html_aa8e63928b14a347bd3973d680b885f93"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a></div><div class="ttdeci">int ast_strftime(char *buf, size_t len, const char *format, const struct ast_tm *tm)</div><div class="ttdoc">Special version of strftime(3) that handles fractions of a second. Takes the same arguments as strfti...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02524">localtime.c:2524</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">2083</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00124">app</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00159">ast_config_AST_LOG_DIR</a>, <a class="el" href="../../d6/db5/alaw_8h_source.html#l00050">AST_LIN2A</a>, <a class="el" href="../../d7/d81/app__sms_8c.html#a63ec69d41a470033bb3b274745c9a2c1">AST_MODULE_INFO_STANDARD_EXTENDED()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00626">ast_register_application_xml</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00122">log_file</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00132">wave</a>.</p>
<div class="fragment"><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;{</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor">#ifdef OUTALAW</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   <span class="keywordtype">int</span> p;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <span class="keywordflow">for</span> (p = 0; p &lt; 80; p++) {</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      wavea[p] = <a class="code" href="../../d6/db5/alaw_8h.html#a45b65da856bb05f79d22425d41457e0f">AST_LIN2A</a>(<a class="code" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a>[p]);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   }</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   snprintf(<a class="code" href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a>), <span class="stringliteral">&quot;%s/sms&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a>);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(<a class="code" href="../../d7/d81/app__sms_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, <a class="code" href="../../d7/d81/app__sms_8c.html#a953a457af7be98e271a1cac368c71e67">sms_exec</a>);</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a9e5f57131367eff409b9e0bd7b31aa1a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a></div><div class="ttdeci">static char * app</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00124">app_sms.c:124</a></div></div>
<div class="ttc" id="app__sms_8c_html_a953a457af7be98e271a1cac368c71e67"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a953a457af7be98e271a1cac368c71e67">sms_exec</a></div><div class="ttdeci">static int sms_exec(struct ast_channel *chan, const char *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01881">app_sms.c:1881</a></div></div>
<div class="ttc" id="app__sms_8c_html_abe867fed599c026df3020fca010dafdd"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a></div><div class="ttdeci">static const signed short wave[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00132">app_sms.c:132</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad0345d4821606480fcb0e28327340660"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a></div><div class="ttdeci">static char log_file[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00122">app_sms.c:122</a></div></div>
<div class="ttc" id="paths_8h_html_aea5e16ca2517e2093fdfa0e7fd112f0f"><div class="ttname"><a href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a></div><div class="ttdeci">const char * ast_config_AST_LOG_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00159">options.c:159</a></div></div>
<div class="ttc" id="module_8h_html_afba4eb7a910b10969041ae4cd488729d"><div class="ttname"><a href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a></div><div class="ttdeci">#define ast_register_application_xml(app, execute)</div><div class="ttdoc">Register an application using XML documentation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00626">module.h:626</a></div></div>
<div class="ttc" id="alaw_8h_html_a45b65da856bb05f79d22425d41457e0f"><div class="ttname"><a href="../../d6/db5/alaw_8h.html#a45b65da856bb05f79d22425d41457e0f">AST_LIN2A</a></div><div class="ttdeci">#define AST_LIN2A(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db5/alaw_8h_source.html#l00050">alaw.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a660b5407faba61b0835356de97c78a0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660b5407faba61b0835356de97c78a0c">&#9670;&nbsp;</a></span>numcpy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void numcpy </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>copy number, skipping non digits apart from leading + </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00288">288</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;+&#39;</span>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>++ = *s++;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">while</span> (*s) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (isdigit(*s)) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>++ = *s;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      s++;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea46af6597884cf32d85f18a52129711"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea46af6597884cf32d85f18a52129711">&#9670;&nbsp;</a></span>packaddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char packaddress </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>store an address at o, and return number of bytes used </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00746">746</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">sms_compose1()</a>.</p>
<div class="fragment"><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;{</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p = 2;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   o[0] = 0;                               <span class="comment">/* number of bytes */</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <span class="keywordflow">if</span> (*i == <span class="charliteral">&#39;+&#39;</span>) {                        <span class="comment">/* record as bit 0 in byte 1 */</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      i++;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      o[1] = 0x91;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      o[1] = 0x81;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   <span class="keywordflow">for</span> ( ; *i ; i++) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">if</span> (!isdigit(*i)) {                 <span class="comment">/* ignore non-digits */</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">if</span> (o[0] &amp; 1) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;         o[p++] |= ((*i &amp; 0xF) &lt;&lt; 4);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;         o[p] = (*i &amp; 0xF);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      o[0]++;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">if</span> (o[0] &amp; 1) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      o[p++] |= 0xF0;                     <span class="comment">/* pad */</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a902aeb4504023853fd6f91429a2855e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a902aeb4504023853fd6f91429a2855e3">&#9670;&nbsp;</a></span>packdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void packdate </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>pack a date and return </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00553">553</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/df8/localtime_8c_source.html#l01739">ast_localtime()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00045">ast_tm::tm_gmtoff</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00038">ast_tm::tm_hour</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00039">ast_tm::tm_mday</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00037">ast_tm::tm_min</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00040">ast_tm::tm_mon</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00036">ast_tm::tm_sec</a>, and <a class="el" href="../../d5/deb/localtime_8h_source.html#l00041">ast_tm::tm_year</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">sms_compose1()</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> t;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keyword">struct </span>timeval topack = { w, 0 };</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="keywordtype">int</span> z;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;topack, &amp;t, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#if defined(__FreeBSD__) || defined(__OpenBSD__) || defined( __NetBSD__ ) || defined(__APPLE__) || defined(__CYGWIN__)</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   z = -t.tm_gmtoff / 60 / 15;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   z = timezone / 60 / 15;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   *o++ = ((t.tm_year % 10) &lt;&lt; 4) + (t.tm_year % 100) / 10;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   *o++ = (((t.tm_mon + 1) % 10) &lt;&lt; 4) + (t.tm_mon + 1) / 10;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   *o++ = ((t.tm_mday % 10) &lt;&lt; 4) + t.tm_mday / 10;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   *o++ = ((t.tm_hour % 10) &lt;&lt; 4) + t.tm_hour / 10;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   *o++ = ((t.tm_min % 10) &lt;&lt; 4) + t.tm_min / 10;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   *o++ = ((t.tm_sec % 10) &lt;&lt; 4) + t.tm_sec / 10;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keywordflow">if</span> (z &lt; 0) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      *o++ = (((-z) % 10) &lt;&lt; 4) + (-z) / 10 + 0x08;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      *o++ = ((z % 10) &lt;&lt; 4) + z / 10;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div><div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38e1bebc872822985359d2e36c1c0448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38e1bebc872822985359d2e36c1c0448">&#9670;&nbsp;</a></span>packsms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int packsms </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>dcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>general pack, with length and data, returns number of bytes of target used </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">520</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00281">is7bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00282">is8bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00485">packsms16()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00446">packsms8()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">sms_compose1()</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = base;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keywordflow">if</span> (udl == 0) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      *p++ = 0;                           <span class="comment">/* no user data */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordtype">int</span> l = 0;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a>(dcs)) {                  <span class="comment">/* 7 bit */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <span class="keywordflow">if</span> ((l = <a class="code" href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a>(p + 1, udhl, udh, udl, ud)) &lt; 0) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            l = 0;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         *p++ = l;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         p += (l * 7 + 7) / 8;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a>(dcs)) {           <span class="comment">/* 8 bit */</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <span class="keywordflow">if</span> ((l = <a class="code" href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a>(p + 1, udhl, udh, udl, ud)) &lt; 0) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            l = 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;         }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;         *p++ = l;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         p += l;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      } <span class="keywordflow">else</span> {                            <span class="comment">/* UCS-2 */</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         <span class="keywordflow">if</span> ((l = <a class="code" href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a>(p + 1, udhl, udh, udl, ud)) &lt; 0) {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            l = 0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         *p++ = l;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         p += l;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">return</span> p - base;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a39743cbea53fca38237f049acd4cb834"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a></div><div class="ttdeci">#define is7bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00281">app_sms.c:281</a></div></div>
<div class="ttc" id="app__sms_8c_html_a77ab80a9e6251174378df1f59b5dbc44"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a></div><div class="ttdeci">static int packsms16(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00485">app_sms.c:485</a></div></div>
<div class="ttc" id="app__sms_8c_html_a172d0c2bb9c8a56df817acb5ce7bfe3c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a></div><div class="ttdeci">static int packsms7(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00369">app_sms.c:369</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa3645875887568a20059ae86c7a66f74"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a></div><div class="ttdeci">static int packsms8(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00446">app_sms.c:446</a></div></div>
<div class="ttc" id="app__sms_8c_html_a5f533f0d22e8b3eac586398fbae67636"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a></div><div class="ttdeci">#define is8bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00282">app_sms.c:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77ab80a9e6251174378df1f59b5dbc44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77ab80a9e6251174378df1f59b5dbc44">&#9670;&nbsp;</a></span>packsms16()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int packsms16 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using 16 bit UCS-2 character codes The return value is the number of bytes packed in to o, which is internally limited to 140 o can be null, in which case this is used to validate or count only if the input contains invalid characters then the return value is -1 </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00485">485</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l00220">dummy()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00216">SMSLEN_8</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p = 0;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>[<a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordflow">if</span> (o == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      o = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="comment">/* header - no encoding */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordflow">if</span> (udhl) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      o[p++] = udhl;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">while</span> (udhl--) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         o[p++] = *udh++;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         <span class="keywordflow">if</span> (p &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">while</span> (udl--) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordtype">long</span> u;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      u = *ud++;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      o[p++] = (u &gt;&gt; 8);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (p &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         <span class="keywordflow">return</span> p - 1;                   <span class="comment">/* could not fit last character */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      o[p++] = u;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span> (p &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div><div class="ttc" id="chan__unistim_8c_html_abc0ce15d00b4bfb69266c5fd016dc88c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a></div><div class="ttdeci">static void dummy(char *unused,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00220">chan_unistim.c:220</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="app__sms_8c_html_ac59f0c328bf0668e86f21b74183de226"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a></div><div class="ttdeci">#define SMSLEN_8</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00216">app_sms.c:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a172d0c2bb9c8a56df817acb5ce7bfe3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a172d0c2bb9c8a56df817acb5ce7bfe3c">&#9670;&nbsp;</a></span>packsms7()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int packsms7 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using SMS 7 bit character codes </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">369</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">b</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00191">defaultalphabet</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l00220">dummy()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00204">escapes</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00215">SMSLEN</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p = 0;                    <span class="comment">/* output pointer (bytes) */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a> = 0;                    <span class="comment">/* bit position */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> n = 0;                    <span class="comment">/* output character count */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>[<a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>];</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordflow">if</span> (o == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {                        <span class="comment">/* output to a dummy buffer if o not set */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      o = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">if</span> (udhl) {                             <span class="comment">/* header */</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      o[p++] = udhl;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      b = 1;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      n = 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">while</span> (udhl--) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         o[p++] = *udh++;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         b += 8;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         <span class="keywordflow">while</span> (b &gt;= 7) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            b -= 7;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            n++;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;         }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         <span class="keywordflow">if</span> (n &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">return</span> n;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">if</span> (b) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         b = 7 - <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;         <span class="keywordflow">if</span> (++n &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">return</span> n;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      }                                   <span class="comment">/* filling to septet boundary */</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   o[p] = 0;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="comment">/* message */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <span class="keywordflow">while</span> (udl--) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordtype">long</span> u;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> v;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      u = *ud++;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">/* XXX 0 is invalid ? */</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">/* look up in defaultalphabet[]. If found, v is the 7-bit code */</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span> (v = 0; v &lt; 128 &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a34ddced579016642f988389bc44752c0">defaultalphabet</a>[v] != u; v++);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span> (v == 128 <span class="comment">/* not found */</span> &amp;&amp; u &amp;&amp; n + 1 &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         <span class="comment">/* if not found, look in the escapes table (we need 2 bytes) */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         <span class="keywordflow">for</span> (v = 0; v &lt; 128 &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a>[v] != u; v++);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="keywordflow">if</span> (v &lt; 128) { <span class="comment">/* escaped sequence, esc + v */</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">/* store the low (8-b) bits in o[p], the remaining bits in o[p+1] */</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            o[p] |= (27 &lt;&lt; <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>);          <span class="comment">/* the low bits go into o[p] */</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            b += 7;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">if</span> (b &gt;= 8) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;               b -= 8;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;               p++;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;               o[p] = (27 &gt;&gt; (7 - <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>));</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            n++;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;         }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span> (v == 128)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         <span class="keywordflow">return</span> -1;                      <span class="comment">/* invalid character */</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">/* store, same as above */</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      o[p] |= (v &lt;&lt; <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      b += 7;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (b &gt;= 8) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         b -= 8;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         p++;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         o[p] = (v &gt;&gt; (7 - <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>));</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">if</span> (++n &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         <span class="keywordflow">return</span> n;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="keywordflow">return</span> n;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a92bf696f8279259f5741564c2c2b2af2"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a></div><div class="ttdeci">#define SMSLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00215">app_sms.c:215</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abc0ce15d00b4bfb69266c5fd016dc88c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a></div><div class="ttdeci">static void dummy(char *unused,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00220">chan_unistim.c:220</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="app__sms_8c_html_a34ddced579016642f988389bc44752c0"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a34ddced579016642f988389bc44752c0">defaultalphabet</a></div><div class="ttdeci">static const unsigned short defaultalphabet[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00191">app_sms.c:191</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="app__sms_8c_html_a70ca3c30c6f517d2f8ebd04edae4d892"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a></div><div class="ttdeci">static const unsigned short escapes[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00204">app_sms.c:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3645875887568a20059ae86c7a66f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3645875887568a20059ae86c7a66f74">&#9670;&nbsp;</a></span>packsms8()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int packsms8 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o using 8 bit character codes. The return value is the number of bytes packed in to o, which is internally limited to 140. o can be null, in which case this is used to validate or count only. if the input contains invalid characters then the return value is -1 </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00446">446</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l00220">dummy()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00216">SMSLEN_8</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p = 0;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>[<a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>];</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordflow">if</span> (o == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      o = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="comment">/* header - no encoding */</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordflow">if</span> (udhl) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      o[p++] = udhl;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">while</span> (udhl--) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         o[p++] = *udh++;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="keywordflow">if</span> (p &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">while</span> (udl--) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordtype">long</span> u;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      u = *ud++;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">if</span> (u &lt; 0 || u &gt; 0xFF) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;         <span class="keywordflow">return</span> -1;                      <span class="comment">/* not valid */</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      o[p++] = u;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">if</span> (p &gt;= <a class="code" href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a>) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;         <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div><div class="ttc" id="chan__unistim_8c_html_abc0ce15d00b4bfb69266c5fd016dc88c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a></div><div class="ttdeci">static void dummy(char *unused,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00220">chan_unistim.c:220</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="app__sms_8c_html_ac59f0c328bf0668e86f21b74183de226"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ac59f0c328bf0668e86f21b74183de226">SMSLEN_8</a></div><div class="ttdeci">#define SMSLEN_8</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00216">app_sms.c:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a70757b19c8a274d21a1f935767d41426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70757b19c8a274d21a1f935767d41426">&#9670;&nbsp;</a></span>putdummydata_proto2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void putdummydata_proto2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01205">1205</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01188">adddata_proto2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00277">sms_s::udtxt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01213">sms_compose2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;{</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x10, <span class="stringliteral">&quot;\0&quot;</span>, 1);           <span class="comment">/* Media Identifier &gt; SMS */</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x11, <span class="stringliteral">&quot;\0\0\0\0\0\0&quot;</span>, 6); <span class="comment">/* Firmware version */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x12, <span class="stringliteral">&quot;\2\0\4&quot;</span>, 3);       <span class="comment">/* SMS provider ID */</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x13, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aaa5504977ac9f7302b9632878eb455e5">udtxt</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>);  <span class="comment">/* Body */</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div><div class="ttc" id="structsms__s_html_aaa5504977ac9f7302b9632878eb455e5"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aaa5504977ac9f7302b9632878eb455e5">sms_s::udtxt</a></div><div class="ttdeci">char udtxt[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00277">app_sms.c:277</a></div></div>
<div class="ttc" id="app__sms_8c_html_adfb54a6105314c1847b33ff2b7f24fb9"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a></div><div class="ttdeci">static void adddata_proto2(sms_t *h, unsigned char msg, char *data, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01188">app_sms.c:1188</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe8206bb9c2adf04e478cd8e01bd5a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe8206bb9c2adf04e478cd8e01bd5a94">&#9670;&nbsp;</a></span>readdirqueue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct dirent* readdirqueue </td>
          <td>(</td>
          <td class="paramtype">DIR *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>queue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>read dir skipping dot files... </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01102">1102</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;{</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <span class="keyword">struct </span>dirent *f;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      f = readdir(<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   } <span class="keywordflow">while</span> (f &amp;&amp; (*f-&gt;d_name == <span class="charliteral">&#39;.&#39;</span> || strncmp(f-&gt;d_name, queue, strlen(queue)) || f-&gt;d_name[strlen(queue)] != <span class="charliteral">&#39;.&#39;</span>));</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="keywordflow">return</span> f;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div><div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a44ab7b172d33e28647b2383346814b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ab7b172d33e28647b2383346814b9f">&#9670;&nbsp;</a></span>sms_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* sms_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>sms_t_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Just return the pointer to the descriptor that we received. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01684">1684</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;{</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   <span class="keywordflow">return</span> sms_t_ptr;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a184a0ba43954b42a5db9a1b1a4854ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184a0ba43954b42a5db9a1b1a4854ccb">&#9670;&nbsp;</a></span>sms_compose1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_compose1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>more</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>compose a message for protocol 1 </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">1400</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00230">sms_s::dcs</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00119">message_ref</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00746">packaddress()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00553">packdate()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00520">packsms()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00229">sms_s::pid</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00236">sms_s::rp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00234">sms_s::srr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00239">sms_s::udh</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00235">sms_s::udhi</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00237">sms_s::vp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;{</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 2;                     <span class="comment">/* next byte to write. Skip type and len */</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x91;                      <span class="comment">/* SMS_DATA */</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a>) {                          <span class="comment">/* deliver */</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = (more ? 4 : 0) + ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a> &gt; 0) ? 0x40 : 0);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      p += <a class="code" href="../../d7/d81/app__sms_8c.html#aea46af6597884cf32d85f18a52129711">packaddress</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a902aeb4504023853fd6f91429a2855e3">packdate</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>.tv_sec);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      p += 7;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      p += <a class="code" href="../../d7/d81/app__sms_8c.html#a38e1bebc872822985359d2e36c1c0448">packsms</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   } <span class="keywordflow">else</span> {                                <span class="comment">/* submit */</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] =</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         0x01 + (more ? 4 : 0) + (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> ? 0x20 : 0) + (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> ? 0x80 : 0) + (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> ? 0x10 : 0) + (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> ? 0x40 : 0);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> &lt; 0) {</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#a0e5e2d705fb17b7f583cd711a5d47467">message_ref</a>++;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      }</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a>;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      p += <a class="code" href="../../d7/d81/app__sms_8c.html#aea46af6597884cf32d85f18a52129711">packaddress</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a>;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a>) {                        <span class="comment">/* relative VP */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> &lt; 720) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> + 4) / 5 - 1;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> &lt; 1440) {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> - 720 + 29) / 30 + 143;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> &lt; 43200) {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> + 1439) / 1440 + 166;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> &lt; 635040) {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> + 10079) / 10080 + 192;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p++] = 255;         <span class="comment">/* max */</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;         }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      }</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      p += <a class="code" href="../../d7/d81/app__sms_8c.html#a38e1bebc872822985359d2e36c1c0448">packsms</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = p - 2;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;}</div><div class="ttc" id="structsms__s_html_aed8d77b45e82e228b7c993a844228e53"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">sms_s::vp</a></div><div class="ttdeci">unsigned int vp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00237">app_sms.c:237</a></div></div>
<div class="ttc" id="structsms__s_html_a74432ad1d458c890a5f136080c831d57"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">sms_s::udhl</a></div><div class="ttdeci">int udhl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00233">app_sms.c:233</a></div></div>
<div class="ttc" id="app__sms_8c_html_a902aeb4504023853fd6f91429a2855e3"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a902aeb4504023853fd6f91429a2855e3">packdate</a></div><div class="ttdeci">static void packdate(unsigned char *o, time_t w)</div><div class="ttdoc">pack a date and return </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00553">app_sms.c:553</a></div></div>
<div class="ttc" id="app__sms_8c_html_aea46af6597884cf32d85f18a52129711"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aea46af6597884cf32d85f18a52129711">packaddress</a></div><div class="ttdeci">static unsigned char packaddress(unsigned char *o, char *i)</div><div class="ttdoc">store an address at o, and return number of bytes used </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00746">app_sms.c:746</a></div></div>
<div class="ttc" id="structsms__s_html_a50b93d20a60c5ca8290725dff70be020"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">sms_s::udhi</a></div><div class="ttdeci">unsigned char udhi</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00235">app_sms.c:235</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_a0e5e2d705fb17b7f583cd711a5d47467"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a0e5e2d705fb17b7f583cd711a5d47467">message_ref</a></div><div class="ttdeci">static volatile unsigned char message_ref</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00119">app_sms.c:119</a></div></div>
<div class="ttc" id="structsms__s_html_a0f7adeccf32fc4c52946d5d20b34c1cd"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">sms_s::srr</a></div><div class="ttdeci">unsigned char srr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00234">app_sms.c:234</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="structsms__s_html_aa04ad9c90e68d8a6f92b612f798db482"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">sms_s::rp</a></div><div class="ttdeci">unsigned char rp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00236">app_sms.c:236</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="app__sms_8c_html_a38e1bebc872822985359d2e36c1c0448"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a38e1bebc872822985359d2e36c1c0448">packsms</a></div><div class="ttdeci">static int packsms(unsigned char dcs, unsigned char *base, unsigned int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">general pack, with length and data, returns number of bytes of target used </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00520">app_sms.c:520</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a1f0cc56d7098ac627c3a2ac4bd94b6d9"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">sms_s::dcs</a></div><div class="ttdeci">unsigned char dcs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00230">app_sms.c:230</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structsms__s_html_a2c7d9a176d66d466f3e8c54fd519460e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">sms_s::pid</a></div><div class="ttdeci">unsigned char pid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00229">app_sms.c:229</a></div></div>
<div class="ttc" id="structsms__s_html_a37cf044b446d0c9825730351ae1be8a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">sms_s::udh</a></div><div class="ttdeci">unsigned char udh[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00239">app_sms.c:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4cea080950ce2066ed4987ee16fcb8d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cea080950ce2066ed4987ee16fcb8d5">&#9670;&nbsp;</a></span>sms_compose2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_compose2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>more</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01213">1213</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01188">adddata_proto2()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l01739">ast_localtime()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01205">putdummydata_proto2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00038">ast_tm::tm_hour</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00039">ast_tm::tm_mday</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00037">ast_tm::tm_min</a>, and <a class="el" href="../../d5/deb/localtime_8h_source.html#l00040">ast_tm::tm_mon</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> tm;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <span class="keyword">struct </span>timeval now = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   <span class="keywordtype">char</span> stm[45];</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x00;                      <span class="comment">/* set later... */</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#a70757b19c8a274d21a1f935767d41426">putdummydata_proto2</a>(h);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a>) {                          <span class="comment">/* deliver */</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x11;                  <span class="comment">/* SMS_DELIVERY */</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="comment">/* Required: 10 11 12 13 14 15 17 (seems they must be ordered!) */</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      sprintf(stm, <span class="stringliteral">&quot;%02d%02d%02d%02d&quot;</span>, tm.tm_mon + 1, tm.tm_mday, tm.tm_hour, tm.tm_min);  <span class="comment">/* Date mmddHHMM */</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x14, stm, 8);    <span class="comment">/* Date */</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a> == 0) {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;         strcpy(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, <span class="stringliteral">&quot;00000000&quot;</span>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x15, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, strlen(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>)); <span class="comment">/* Originator */</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x17, <span class="stringliteral">&quot;\1&quot;</span>, 1);   <span class="comment">/* Calling Terminal ID */</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   } <span class="keywordflow">else</span> {                                <span class="comment">/* submit */</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x10;                  <span class="comment">/* SMS_SUBMIT */</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">/* Required: 10 11 12 13 17 18 1B 1C (seems they must be ordered!) */</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x17, <span class="stringliteral">&quot;\1&quot;</span>, 1);   <span class="comment">/* Calling Terminal ID */</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> == 0) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;         strcpy(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, <span class="stringliteral">&quot;00000000&quot;</span>);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x18, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, strlen(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>)); <span class="comment">/* Originator */</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x1B, <span class="stringliteral">&quot;\1&quot;</span>, 1);         <span class="comment">/* Called Terminal ID */</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a>(h, 0x1C, <span class="stringliteral">&quot;\0\0\0&quot;</span>, 3);    <span class="comment">/* Notification */</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;}</div><div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="app__sms_8c_html_adfb54a6105314c1847b33ff2b7f24fb9"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#adfb54a6105314c1847b33ff2b7f24fb9">adddata_proto2</a></div><div class="ttdeci">static void adddata_proto2(sms_t *h, unsigned char msg, char *data, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01188">app_sms.c:1188</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="app__sms_8c_html_a70757b19c8a274d21a1f935767d41426"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a70757b19c8a274d21a1f935767d41426">putdummydata_proto2</a></div><div class="ttdeci">static void putdummydata_proto2(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01205">app_sms.c:1205</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aec1ab10167ae5ed9af8793c90c10c475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1ab10167ae5ed9af8793c90c10c475">&#9670;&nbsp;</a></span>sms_debug()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_debug </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01485">1485</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01483">DIR_RX</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00266">sms_s::ibytep</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;{</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   <span class="keywordtype">char</span> txt[259 * 3 + 1];</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   <span class="keywordtype">char</span> *p = txt;                          <span class="comment">/* always long enough */</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *msg = (dir == <a class="code" href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a>) ? h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> : h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   <span class="keywordtype">int</span> n = (dir == <a class="code" href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a>) ? h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> : msg[1] + 2;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <span class="keywordtype">int</span> q = 0;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   <span class="keywordflow">while</span> (q &lt; n &amp;&amp; q &lt; 30) {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      sprintf(p, <span class="stringliteral">&quot; %02hhX&quot;</span>, msg[q++]);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      p += 3;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;   }</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <span class="keywordflow">if</span> (q &lt; n) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      sprintf(p, <span class="stringliteral">&quot;...&quot;</span>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS %s%s\n&quot;</span>, dir == <a class="code" href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a> ? <span class="stringliteral">&quot;RX&quot;</span> : <span class="stringliteral">&quot;TX&quot;</span>, txt);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;}</div><div class="ttc" id="structsms__s_html_a3130aa304b0c5b6b85bf740f27eeaac7"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">sms_s::ibytep</a></div><div class="ttdeci">unsigned char ibytep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00266">app_sms.c:266</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa4fbf8951a3590171e5def3f7d4cd666"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a></div><div class="ttdeci">#define DIR_RX</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01483">app_sms.c:1483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a953a457af7be98e271a1cac368c71e67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a953a457af7be98e271a1cac368c71e67">&#9670;&nbsp;</a></span>sms_exec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sms_exec </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">1881</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00149">__OUT_FMT</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02960">ast_activate_generator()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02814">ast_answer()</a>, <a class="el" href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01232">AST_APP_ARG</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l02906">ast_app_parse_options()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00888">ast_channel_caller()</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02902">ast_deactivate_generator()</a>, <a class="el" href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01249">AST_DECLARE_APP_ARGS</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00041">ast_format_slin</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l04302">ast_read()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05849">ast_set_read_format()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05890">ast_set_write_format()</a>, <a class="el" href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01285">AST_STANDARD_APP_ARGS</a>, <a class="el" href="../../d9/d95/channelstate_8h_source.html#l00042">AST_STATE_UP</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03171">ast_waitfor()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00240">sms_s::cli</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">d</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00230">sms_s::dcs</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00172">DLL1_SMS_COMPLETE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00167">DLL1_SMS_EST</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00176">DLL2_SMS_EST</a>, <a class="el" href="../../dc/dbf/test__amihooks_8c_source.html#l00048">done</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00220">sms_s::err</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00200">ast_flags::flags</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00276">sms_s::framenumber</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00219">sms_s::hangup</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00259">sms_s::ipc0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00260">sms_s::ipc1</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00283">is16bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00281">is7bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00282">is8bit</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00224">sms_s::nolog</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00273">sms_s::opause_0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01858">OPTION_ANSWER</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01868">OPTION_ARG_ARRAY_SIZE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01867">OPTION_ARG_PAUSE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01857">OPTION_BE_SMSC</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01862">OPTION_DCS</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01861">OPTION_SRR</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01859">OPTION_TWO</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01863">OPTIONS_NO_LOG</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00485">packsms16()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00446">packsms8()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l01872">parse()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00229">sms_s::pid</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00225">sms_s::queue</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00173">ast_frame::samples</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">sms_log()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01879">sms_options</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01712">sms_process()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">sms_writefile()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00215">SMSLEN</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00234">sms_s::srr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00239">sms_s::udh</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00315">utf8decode()</a>, and <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00894">while()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;{</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;   <a class="code" href="../../d6/de0/structsms__s.html">sms_t</a> h = { 0 };</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   <span class="comment">/* argument parsing support */</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> <a class="code" href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = { 0 };</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>, *sms_opts[<a class="code" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b">OPTION_ARG_ARRAY_SIZE</a>] = { 0, };</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(sms_args,</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queue);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(addr);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(body);</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;   );</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   <span class="keywordflow">if</span> (!data) {</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Requires queue name at least\n&quot;</span>);</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   }</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);              <span class="comment">/* create a local copy */</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(sms_args, parse);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;   <span class="keywordflow">if</span> (sms_args.argc &gt; 1) {</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a>(<a class="code" href="../../d7/d81/app__sms_8c.html#ad4f9cbcaee3a56eb068a387e9e6600e2">sms_options</a>, &amp;flags, sms_opts, sms_args.options);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   }</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;sms argc %u queue &lt;%s&gt; opts &lt;%s&gt; addr &lt;%s&gt; body &lt;%s&gt;\n&quot;</span>,</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      sms_args.argc, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(sms_args.queue, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(sms_args.options, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(sms_args.addr, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(sms_args.body, <span class="stringliteral">&quot;&quot;</span>) );</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   h.<a class="code" href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">ipc0</a> = h.<a class="code" href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">ipc1</a> = 20;                   <span class="comment">/* phase for cosine */</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   h.<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = 0xF1;                           <span class="comment">/* default */</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">cli</a>,</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(chan)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(chan)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">cli</a>));</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(sms_args.queue)) {</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Requires queue name\n&quot;</span>);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;   }</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <span class="keywordflow">if</span> (strlen(sms_args.queue) &gt;= <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>)) {</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Queue name too long\n&quot;</span>);</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   }</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>, sms_args.queue, <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>));</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="keywordflow">for</span> (p = h.<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>; *p; p++) {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keywordflow">if</span> (!isalnum(*p)) {</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         *p = <span class="charliteral">&#39;-&#39;</span>;                       <span class="comment">/* make very safe for filenames */</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      }</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;   }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   h.<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a> = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   h.<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a>) ? 2 : 1;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   h.<a class="code" href="../../d6/de0/structsms__s.html#a4e25ceb2cb34fddfa5c27adbf6c9a4ed">nolog</a> = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a>) ? 1 : 0;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(sms_opts[<a class="code" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a>])) {</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a> = atoi(sms_opts[OPTION_ARG_PAUSE]);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;   }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;   <span class="keywordflow">if</span> (h.<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a> &lt; 25 || h.<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a> &gt; 2000) {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a> = 300;                   <span class="comment">/* default 300ms */</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;initial delay %dms\n&quot;</span>, h.<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a>);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;   <span class="comment">/* the following apply if there is an arg3/4 and apply to the created message file */</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a>)) {</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = 1;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;   }</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a>)) {</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = 1;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>:</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>:</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>:</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;5&#39;</span>:</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;6&#39;</span>:</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;7&#39;</span>:                           <span class="comment">/* set the pid for saved local message */</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a> = 0x40 + (*<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> &amp; 0xF);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      }</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   <span class="keywordflow">if</span> (sms_args.argc &gt; 2) {</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *up;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="comment">/* submitting a message, not taking call. */</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="comment">/* deprecated, use smsq instead */</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(sms_args.addr) || strlen(sms_args.addr) &gt;= <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>)) {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Address too long %s\n&quot;</span>, sms_args.addr);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      }</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keywordflow">if</span> (h.<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a>) {</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, sms_args.addr, <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>));</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, sms_args.addr, <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>));</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">cli</a>, <span class="keyword">sizeof</span>(h.<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>));</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = 0;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(sms_args.body)) {</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing body for %s\n&quot;</span>, sms_args.addr);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      }</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      up = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)sms_args.body;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a> (*up &amp;&amp; h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>++] = <a class="code" href="../../d7/d81/app__sms_8c.html#a375cda00ad33985349625ad6f8ae70ef">utf8decode</a>(&amp;up);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      }</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a>(0, h.<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 7 bit GSM data\n&quot;</span>);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a>(0, h.<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 8 bit data\n&quot;</span>);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a8bdd552aa3abf01b520c87815e1c2b24">is16bit</a>(h.<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a>(0, h.<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h.<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 16 bit data\n&quot;</span>);</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      }</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = 0;                           <span class="comment">/* sent message */</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = -1;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a>(&amp;h);</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      res = h.<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a>;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;   }</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(chan) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {     <span class="comment">/* make sure channel is answered before any TX */</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a>(chan);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;   }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a>)) {</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      h.<a class="code" href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">framenumber</a> = 1;                  <span class="comment">/* Proto 2 */</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="comment">/* set up SMS_EST initial message */</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keywordflow">if</span> (h.<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2) {</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a>;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626">DLL1_SMS_EST</a> | <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4">DLL1_SMS_COMPLETE</a>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;         h.<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      }</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(&amp;h);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   }</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   res = <a class="code" href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a>(chan, <a class="code" href="../../d7/d81/app__sms_8c.html#a534407082ad8ffdc07f2143b239e17c6">__OUT_FMT</a>);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   <span class="keywordflow">if</span> (res &gt;= 0) {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      res = <a class="code" href="../../d5/d7b/channel_8h.html#a9107a83365cbf327cc0d12cb0dbd28d8">ast_set_read_format</a>(chan, <a class="code" href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a>);</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;   }</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to set to linear mode, giving up\n&quot;</span>);</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;   }</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   <span class="keywordflow">if</span> ( (res = <a class="code" href="../../d5/d7b/channel_8h.html#a12a58dda74a19f383f6b77cf7fa88b54">ast_activate_generator</a>(chan, &amp;<a class="code" href="../../d7/d81/app__sms_8c.html#a1905c14fd0a53bc591a77d9bb4d029ca">smsgen</a>, &amp;h)) &lt; 0) {</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to activate generator on &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   }</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="comment">/* Do our thing here */</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *f;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordtype">int</span> i = <a class="code" href="../../d5/d7b/channel_8h.html#a60e0bcaed001e8d5ed1ba0eb2644b3cc">ast_waitfor</a>(chan, -1);</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="keywordflow">if</span> (i &lt; 0) {</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;waitfor failed\n&quot;</span>);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      }</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordflow">if</span> (h.<a class="code" href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">hangup</a>) {</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;channel hangup\n&quot;</span>);</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      }</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      f = <a class="code" href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a>(chan);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;ast_read failed\n&quot;</span>);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      }</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#aa1cc2166cf9b6a4496caf3bb1d11cb6e">sms_process</a>(&amp;h, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      }</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   }</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   res = h.<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a>;                            <span class="comment">/* XXX */</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">    * The SMS generator data is on the stack.  We _MUST_ make sure the generator</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">    * is stopped before returning from this function.</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a7160355005776732fba88cc020f4a45b">ast_deactivate_generator</a>(chan);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(&amp;h, <span class="charliteral">&#39;?&#39;</span>);                       <span class="comment">/* log incomplete message */</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>:</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   <span class="keywordflow">return</span> (res);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;}</div><div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="app__sms_8c_html_a39743cbea53fca38237f049acd4cb834"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a></div><div class="ttdeci">#define is7bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00281">app_sms.c:281</a></div></div>
<div class="ttc" id="app__sms_8c_html_a47041feede8f04106f4d6221af763e9d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a></div><div class="ttdeci">static void sms_messagetx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01561">app_sms.c:1561</a></div></div>
<div class="ttc" id="structsms__s_html_ada449bf15f71bb79ab0e662561c78706"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">sms_s::hangup</a></div><div class="ttdeci">unsigned char hangup</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00219">app_sms.c:219</a></div></div>
<div class="ttc" id="structsms__s_html_a60ee36698e956201dc2fd920eacf25fe"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">sms_s::ipc1</a></div><div class="ttdeci">unsigned char ipc1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00260">app_sms.c:260</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01863">app_sms.c:1863</a></div></div>
<div class="ttc" id="structsms__s_html_a07d0d1d8e847071c2d9e766749c03da3"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">sms_s::opause_0</a></div><div class="ttdeci">int opause_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00273">app_sms.c:273</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="channel_8h_html_a12a58dda74a19f383f6b77cf7fa88b54"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a12a58dda74a19f383f6b77cf7fa88b54">ast_activate_generator</a></div><div class="ttdeci">int ast_activate_generator(struct ast_channel *chan, struct ast_generator *gen, void *params)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02960">channel.c:2960</a></div></div>
<div class="ttc" id="app__sms_8c_html_a375cda00ad33985349625ad6f8ae70ef"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a375cda00ad33985349625ad6f8ae70ef">utf8decode</a></div><div class="ttdeci">static long utf8decode(unsigned char **pp)</div><div class="ttdoc">Reads next UCS character from NUL terminated UTF-8 string and advance pointer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00315">app_sms.c:315</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="app__sms_8c_html_a92bf696f8279259f5741564c2c2b2af2"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a></div><div class="ttdeci">#define SMSLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00215">app_sms.c:215</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ac08f7eb1eb9476b30987c73e1052ada8"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a></div><div class="ttdeci">#define AST_STANDARD_APP_ARGS(args, parse)</div><div class="ttdoc">Performs the &amp;#39;standard&amp;#39; argument separation process for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01285">include/asterisk/app.h:1285</a></div></div>
<div class="ttc" id="structsms__s_html_a74432ad1d458c890a5f136080c831d57"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">sms_s::udhl</a></div><div class="ttdeci">int udhl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00233">app_sms.c:233</a></div></div>
<div class="ttc" id="structsms__s_html_adb1bd77faccb1c8198882df8475b5979"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">sms_s::ipc0</a></div><div class="ttdeci">unsigned char ipc0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00259">app_sms.c:259</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
<div class="ttc" id="structast__flags_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">ast_flags::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00200">utils.h:200</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="channel_8h_html_a7ef6737309dc9e8b6c4a7cb4800638b1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a></div><div class="ttdeci">struct ast_frame * ast_read(struct ast_channel *chan)</div><div class="ttdoc">Reads a frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04302">channel.c:4302</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a></div><div class="ttdeci">ast_channel_state</div><div class="ttdoc">ast_channel states </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00035">channelstate.h:35</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="structsms__s_html"><div class="ttname"><a href="../../d6/de0/structsms__s.html">sms_s</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00218">app_sms.c:218</a></div></div>
<div class="ttc" id="app__sms_8c_html_a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01867">app_sms.c:1867</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa1cc2166cf9b6a4496caf3bb1d11cb6e"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa1cc2166cf9b6a4496caf3bb1d11cb6e">sms_process</a></div><div class="ttdeci">static void sms_process(sms_t *h, int samples, signed short *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01712">app_sms.c:1712</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="test__amihooks_8c_html_a5992b274cfdcacdbc1fa8347fd01ebde"><div class="ttname"><a href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a></div><div class="ttdeci">int done</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dbf/test__amihooks_8c_source.html#l00048">test_amihooks.c:48</a></div></div>
<div class="ttc" id="structnumber_html"><div class="ttname"><a href="../../d6/d49/structnumber.html">number</a></div><div class="ttdoc">Number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d55/app__followme_8c_source.html#l00154">app_followme.c:154</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsms__s_html_ae029547c37a01a171c894cefb942743f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">sms_s::queue</a></div><div class="ttdeci">char queue[30]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00225">app_sms.c:225</a></div></div>
<div class="ttc" id="channel_8h_html_a9107a83365cbf327cc0d12cb0dbd28d8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9107a83365cbf327cc0d12cb0dbd28d8">ast_set_read_format</a></div><div class="ttdeci">int ast_set_read_format(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdoc">Sets read format on channel chan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05849">channel.c:5849</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a8fdafe3be7e00ce3d4f0cb50a9a5eb39"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a></div><div class="ttdeci">while(1)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00894">ast_expr2f.c:894</a></div></div>
<div class="ttc" id="app__sms_8c_html_a77ab80a9e6251174378df1f59b5dbc44"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a></div><div class="ttdeci">static int packsms16(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00485">app_sms.c:485</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad4f9cbcaee3a56eb068a387e9e6600e2"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad4f9cbcaee3a56eb068a387e9e6600e2">sms_options</a></div><div class="ttdeci">static const struct ast_app_option sms_options[128]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01879">app_sms.c:1879</a></div></div>
<div class="ttc" id="structsms__s_html_a0f7adeccf32fc4c52946d5d20b34c1cd"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">sms_s::srr</a></div><div class="ttdeci">unsigned char srr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00234">app_sms.c:234</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="channel_8h_html_abbdfb98077180544657b2d16c5d25f74"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a></div><div class="ttdeci">int ast_set_write_format(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdoc">Sets write format on channel chan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05890">channel.c:5890</a></div></div>
<div class="ttc" id="app__sms_8c_html_af45fa5279582c213474672cf0684d219"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a></div><div class="ttdeci">static void sms_writefile(sms_t *h)</div><div class="ttdoc">white a received text message to a file </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00998">app_sms.c:998</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_af40039f1c49c16d0f6fa33fe9c43a0cb"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a></div><div class="ttdeci">int ast_app_parse_options(const struct ast_app_option *options, struct ast_flags *flags, char **args, char *optstr)</div><div class="ttdoc">Parses a string containing application options and sets flags/arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l02906">main/app.c:2906</a></div></div>
<div class="ttc" id="app__sms_8c_html_a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27ad8be72595381ce66309dcc938077316b">OPTION_ARG_ARRAY_SIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01868">app_sms.c:1868</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01858">app_sms.c:1858</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a96e7ed27f789598728cae97a4f9abbe4">DLL1_SMS_COMPLETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00172">app_sms.c:172</a></div></div>
<div class="ttc" id="structsms__s_html_a4e25ceb2cb34fddfa5c27adbf6c9a4ed"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a4e25ceb2cb34fddfa5c27adbf6c9a4ed">sms_s::nolog</a></div><div class="ttdeci">unsigned char nolog</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00224">app_sms.c:224</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structsms__s_html_a68ed7cd4df73b8c9bf4b23d948d1e638"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">sms_s::framenumber</a></div><div class="ttdeci">int framenumber</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00276">app_sms.c:276</a></div></div>
<div class="ttc" id="app__sms_8c_html_a8bdd552aa3abf01b520c87815e1c2b24"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a8bdd552aa3abf01b520c87815e1c2b24">is16bit</a></div><div class="ttdeci">#define is16bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00283">app_sms.c:283</a></div></div>
<div class="ttc" id="structsms__s_html_a306f4c1d73939a3ccb91b0caf7127453"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">sms_s::cli</a></div><div class="ttdeci">char cli[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00240">app_sms.c:240</a></div></div>
<div class="ttc" id="app__sms_8c_html_a1905c14fd0a53bc591a77d9bb4d029ca"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a1905c14fd0a53bc591a77d9bb4d029ca">smsgen</a></div><div class="ttdeci">static struct ast_generator smsgen</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01694">app_sms.c:1694</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="app__sms_8c_html_a534407082ad8ffdc07f2143b239e17c6"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a534407082ad8ffdc07f2143b239e17c6">__OUT_FMT</a></div><div class="ttdeci">#define __OUT_FMT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00149">app_sms.c:149</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01861">app_sms.c:1861</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a2e006acff60d9b3d65d7d60f975d6747"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a></div><div class="ttdeci">static void parse(struct mgcp_request *req)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l01872">chan_mgcp.c:1872</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad5e0ab37f40bc7f8885617847ffd3fee"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a></div><div class="ttdeci">static void sms_log(sms_t *h, char status)</div><div class="ttdoc">Log the output, and remove file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00774">app_sms.c:774</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01859">app_sms.c:1859</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="channel_8h_html_a7160355005776732fba88cc020f4a45b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7160355005776732fba88cc020f4a45b">ast_deactivate_generator</a></div><div class="ttdeci">void ast_deactivate_generator(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02902">channel.c:2902</a></div></div>
<div class="ttc" id="structsms__s_html_a157434392012e4ce1590980a31f692ac"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">sms_s::err</a></div><div class="ttdeci">unsigned char err</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00220">app_sms.c:220</a></div></div>
<div class="ttc" id="app__sms_8c_html_a172d0c2bb9c8a56df817acb5ce7bfe3c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a></div><div class="ttdeci">static int packsms7(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00369">app_sms.c:369</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a1f0cc56d7098ac627c3a2ac4bd94b6d9"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">sms_s::dcs</a></div><div class="ttdeci">unsigned char dcs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00230">app_sms.c:230</a></div></div>
<div class="ttc" id="channel_8h_html_a60e0bcaed001e8d5ed1ba0eb2644b3cc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a60e0bcaed001e8d5ed1ba0eb2644b3cc">ast_waitfor</a></div><div class="ttdeci">int ast_waitfor(struct ast_channel *chan, int ms)</div><div class="ttdoc">Wait for input on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03171">channel.c:3171</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01857">app_sms.c:1857</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00176">app_sms.c:176</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="channel_8h_html_aec583a3e25358ee552a4f3df53914cd0"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a></div><div class="ttdeci">int ast_answer(struct ast_channel *chan)</div><div class="ttdoc">Answer a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02814">channel.c:2814</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa3645875887568a20059ae86c7a66f74"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a></div><div class="ttdeci">static int packsms8(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00446">app_sms.c:446</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9aa93cd3c00de7548f03cc83a73833b626">DLL1_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00167">app_sms.c:167</a></div></div>
<div class="ttc" id="format__cache_8h_html_a771d7c34570e8e492c25a0c2eb41889d"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a></div><div class="ttdeci">struct ast_format * ast_format_slin</div><div class="ttdoc">Built-in cached signed linear 8kHz format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00041">format_cache.c:41</a></div></div>
<div class="ttc" id="app__sms_8c_html_aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01862">app_sms.c:1862</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a80cd3f6f786b59b742bcecfc0b3be7c2"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a></div><div class="ttdeci">#define AST_DECLARE_APP_ARGS(name, arglist)</div><div class="ttdoc">Declare a structure to hold an application&amp;#39;s arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01249">include/asterisk/app.h:1249</a></div></div>
<div class="ttc" id="app__sms_8c_html_a5f533f0d22e8b3eac586398fbae67636"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a></div><div class="ttdeci">#define is8bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00282">app_sms.c:282</a></div></div>
<div class="ttc" id="structsms__s_html_a2c7d9a176d66d466f3e8c54fd519460e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">sms_s::pid</a></div><div class="ttdeci">unsigned char pid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00229">app_sms.c:229</a></div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
<div class="ttc" id="structast__frame_html_a37672e6b906143604cefd3e959777b31"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">ast_frame::samples</a></div><div class="ttdeci">int samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00173">include/asterisk/frame.h:173</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a037e9a5b28477b17e7c9acbe7ecb21d5"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a></div><div class="ttdeci">#define AST_APP_ARG(name)</div><div class="ttdoc">Define an application argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01232">include/asterisk/app.h:1232</a></div></div>
<div class="ttc" id="structsms__s_html_a37cf044b446d0c9825730351ae1be8a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">sms_s::udh</a></div><div class="ttdeci">unsigned char udh[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00239">app_sms.c:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afda4211248e1b0e0083be7bd80a7d4b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afda4211248e1b0e0083be7bd80a7d4b0">&#9670;&nbsp;</a></span>sms_generate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sms_generate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>outgoing data are produced by this generator function, that reads from the descriptor whether it has data to send and which ones. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01604">1604</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00149">__OUT_FMT</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00229">AST_FRIENDLY_OFFSET</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05189">ast_write()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">ast_frame::datalen</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00176">DLL2_SMS_EST</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00175">ast_frame::mallocd</a>, <a class="el" href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00245">sms_s::obitp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00243">sms_s::obyte</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00248">sms_s::obyten</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00247">sms_s::obytep</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00179">ast_frame::offset</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00244">sms_s::opause</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00241">sms_s::ophase</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00242">sms_s::ophasep</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00275">sms_s::oseizure</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00246">sms_s::osync</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00173">ast_frame::samples</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">ast_frame::src</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00148">wave_out</a>.</p>
<div class="fragment"><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;{</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { 0 };</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="preprocessor">#define MAXSAMPLES (800)</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   <a class="code" href="../../d6/de0/structsms__s.html">sms_t</a> *h = <a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   <span class="keywordtype">int</span> i, res;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> &gt; <a class="code" href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a>) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Only doing %d samples (%d requested)\n&quot;</span>,</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          <a class="code" href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a>, <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a>;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;   }</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;   <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> * <span class="keyword">sizeof</span>(*buf) + <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ac8f7380b8620c80443286b44481f641c">AST_FRIENDLY_OFFSET</a>;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#a534407082ad8ffdc07f2143b239e17c6">__OUT_FMT</a>;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> * <span class="keyword">sizeof</span>(*buf);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ac8f7380b8620c80443286b44481f641c">AST_FRIENDLY_OFFSET</a>;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = 0;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   f.<a class="code" href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = <span class="stringliteral">&quot;app_sms&quot;</span>;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   <span class="comment">/* create a buffer containing the digital sms pattern */</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>; i++) {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      buf[i] = <a class="code" href="../../d7/d81/app__sms_8c.html#a1c6c81d0dd59e7e04ac232639a5db460">wave_out</a>[0];               <span class="comment">/* default is silence */</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a>) {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a>--;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a> || h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a>) { <span class="comment">/* sending data */</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;         buf[i] = <a class="code" href="../../d7/d81/app__sms_8c.html#a1c6c81d0dd59e7e04ac232639a5db460">wave_out</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#af95b86d8613bac4c53c954205511ec23">ophase</a>];</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#af95b86d8613bac4c53c954205511ec23">ophase</a> += (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> &amp; 1) ? 13 : 21; <span class="comment">/* compute next phase */</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#af95b86d8613bac4c53c954205511ec23">ophase</a> &gt;= 80)</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#af95b86d8613bac4c53c954205511ec23">ophase</a> -= 80;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;         <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a55eba9c806e66b04fd52a4bdd09a3ce3">ophasep</a> += 12) &gt;= 80) { <span class="comment">/* time to send the next bit */</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a55eba9c806e66b04fd52a4bdd09a3ce3">ophasep</a> -= 80;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">oseizure</a> &gt; 0) {      <span class="comment">/* sending channel seizure (proto 2) */</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">oseizure</a>--;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> ^= 1;          <span class="comment">/* toggle low bit */</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a>) {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = 1;           <span class="comment">/* send mark as sync bit */</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a>--;             <span class="comment">/* sending sync bits */</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;               <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a> == 0 &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2 &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] == <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a>) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a> = 0; <span class="comment">/* we are done */</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;               }</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a>++;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;               <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a> == 1) {</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = 0;       <span class="comment">/* start bit; */</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a> == 2) {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a>];</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a> == 10) {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = 1; <span class="comment">/* stop bit */</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a> = 0;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a>++;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                  <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a> == h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a>) {</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a> = 0; <span class="comment">/* sent */</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a> = 10;   <span class="comment">/* trailing marks */</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                  }</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> &gt;&gt;= 1;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;               }</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;         }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      }</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   res = <a class="code" href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a>(chan, &amp;f);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(&amp;f);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to write frame to &#39;%s&#39;: %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;   }</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="preprocessor">#undef MAXSAMPLES</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;}</div><div class="ttc" id="structast__frame_html_aed7ea92f45bd273dde380a45ddced592"><div class="ttname"><a href="../../d0/d99/structast__frame.html#aed7ea92f45bd273dde380a45ddced592">ast_frame::offset</a></div><div class="ttdeci">int offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00179">include/asterisk/frame.h:179</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsms__s_html_a299a3166d8ff58de5a5510b0715c552c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">sms_s::obyten</a></div><div class="ttdeci">unsigned char obyten</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00248">app_sms.c:248</a></div></div>
<div class="ttc" id="structsms__s_html_af95b86d8613bac4c53c954205511ec23"><div class="ttname"><a href="../../d6/de0/structsms__s.html#af95b86d8613bac4c53c954205511ec23">sms_s::ophase</a></div><div class="ttdeci">unsigned char ophase</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00241">app_sms.c:241</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsms__s_html_aebe123f864a95e87c1178e3c295aba49"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">sms_s::obitp</a></div><div class="ttdeci">unsigned char obitp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00245">app_sms.c:245</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="structsms__s_html_a3fd2579a2aaf53083eb8d3d85094554c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">sms_s::osync</a></div><div class="ttdeci">unsigned char osync</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00246">app_sms.c:246</a></div></div>
<div class="ttc" id="structsms__s_html"><div class="ttname"><a href="../../d6/de0/structsms__s.html">sms_s</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00218">app_sms.c:218</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ac8f7380b8620c80443286b44481f641c"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ac8f7380b8620c80443286b44481f641c">AST_FRIENDLY_OFFSET</a></div><div class="ttdeci">#define AST_FRIENDLY_OFFSET</div><div class="ttdoc">Offset into a frame&amp;#39;s data buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00229">include/asterisk/frame.h:229</a></div></div>
<div class="ttc" id="structast__frame_html_af51e37c9331049b1e3d250a7c8bc3c26"><div class="ttname"><a href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">ast_frame::src</a></div><div class="ttdeci">const char * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">include/asterisk/frame.h:181</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="structsms__s_html_a91573120b8594c3c1581a187c1abbca3"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">sms_s::obyte</a></div><div class="ttdeci">unsigned char obyte</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00243">app_sms.c:243</a></div></div>
<div class="ttc" id="app__sms_8c_html_a1c6c81d0dd59e7e04ac232639a5db460"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a1c6c81d0dd59e7e04ac232639a5db460">wave_out</a></div><div class="ttdeci">static const output_t * wave_out</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00148">app_sms.c:148</a></div></div>
<div class="ttc" id="app__sms_8c_html_a4008af70ba477f60e932df6815dac38d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a></div><div class="ttdeci">signed short output_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00147">app_sms.c:147</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="structsms__s_html_a55eba9c806e66b04fd52a4bdd09a3ce3"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a55eba9c806e66b04fd52a4bdd09a3ce3">sms_s::ophasep</a></div><div class="ttdeci">unsigned char ophasep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00242">app_sms.c:242</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structsms__s_html_a8fa429a43fa2c62a852096b184fbcdc4"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">sms_s::obytep</a></div><div class="ttdeci">unsigned char obytep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00247">app_sms.c:247</a></div></div>
<div class="ttc" id="app__sms_8c_html_a534407082ad8ffdc07f2143b239e17c6"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a534407082ad8ffdc07f2143b239e17c6">__OUT_FMT</a></div><div class="ttdeci">#define __OUT_FMT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00149">app_sms.c:149</a></div></div>
<div class="ttc" id="structsms__s_html_a8468bed3bf799ea150212c167133e6ef"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">sms_s::oseizure</a></div><div class="ttdeci">int oseizure</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00275">app_sms.c:275</a></div></div>
<div class="ttc" id="channel_8h_html_a79c413d51b7135404d5cacf811649a61"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a></div><div class="ttdeci">int ast_write(struct ast_channel *chan, struct ast_frame *frame)</div><div class="ttdoc">Write a frame to a channel This function writes the given frame to the indicated channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05189">channel.c:5189</a></div></div>
<div class="ttc" id="structast__frame_html_aed16590d48f41d89f31e0cf347f5cd99"><div class="ttname"><a href="../../d0/d99/structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">ast_frame::mallocd</a></div><div class="ttdeci">int mallocd</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00175">include/asterisk/frame.h:175</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00176">app_sms.c:176</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structsms__s_html_a600d3882475c4c4c8e0855a8516562aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">sms_s::opause</a></div><div class="ttdeci">unsigned int opause</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00244">app_sms.c:244</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="app__sms_8c_html_a6706e49765398fb7ec5e9e4bb66c3e64"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a6706e49765398fb7ec5e9e4bb66c3e64">MAXSAMPLES</a></div><div class="ttdeci">#define MAXSAMPLES</div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
<div class="ttc" id="structast__frame_html_a37672e6b906143604cefd3e959777b31"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a37672e6b906143604cefd3e959777b31">ast_frame::samples</a></div><div class="ttdeci">int samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00173">include/asterisk/frame.h:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43baf6d9daec56e893ebc9c204d852f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43baf6d9daec56e893ebc9c204d852f3">&#9670;&nbsp;</a></span>sms_handleincoming()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char sms_handleincoming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>handle the incoming message </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">1112</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00240">sms_s::cli</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00230">sms_s::dcs</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00229">sms_s::pid</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00236">sms_s::rp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">sms_writefile()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00234">sms_s::srr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00239">sms_s::udh</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00235">sms_s::udhi</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00728">unpackaddress()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00579">unpackdate()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00237">sms_s::vp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>.</p>
<div class="fragment"><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;{</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p = 3;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a>) {                          <span class="comment">/* SMSC */</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 3) == 1) {        <span class="comment">/* SMS-SUBMIT */</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = 0;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = 0;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x20) ? 1 : 0);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x40) ? 1 : 0);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x80) ? 1 : 0);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">cli</a>, <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>));</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p++];</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         p += <a class="code" href="../../d7/d81/app__sms_8c.html#ad38c7ea91c75338009d7ef07df937ee9">unpackaddress</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> + p);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p++];</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p++];</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x18) == 0x10) {       <span class="comment">/* relative VP */</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] &lt; 144) {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] + 1) * 5;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] &lt; 168) {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = 720 + (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] - 143) * 30;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] &lt; 197) {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] - 166) * 1440;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p] - 192) * 10080;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            p++;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x18) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            p += 7;                     <span class="comment">/* ignore enhanced / absolute VP */</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         p += <a class="code" href="../../d7/d81/app__sms_8c.html#a0ec2365c36d7af29acf3bdaad02b082a">unpacksms</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a>);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = 1;                      <span class="comment">/* received message */</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a>(h);               <span class="comment">/* write the file */</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;         <span class="keywordflow">if</span> (p != h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] + 2) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Mismatch receive unpacking %d/%d\n&quot;</span>, p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] + 2);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">return</span> 0xFF;        <span class="comment">/* duh! */</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown message type %02hhX\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2]);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         <span class="keywordflow">return</span> 0xFF;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      }</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   } <span class="keywordflow">else</span> {                                <span class="comment">/* client */</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">if</span> (!(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 3)) {            <span class="comment">/* SMS-DELIVER */</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = 0;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x20) ? 1 : 0);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x40) ? 1 : 0);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] &amp; 0x80) ? 1 : 0);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = -1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;         p += <a class="code" href="../../d7/d81/app__sms_8c.html#ad38c7ea91c75338009d7ef07df937ee9">unpackaddress</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> + p);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p++];</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[p++];</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#a7c221ca909fed50cb51bd59b0855bc68">unpackdate</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> + p);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;         p += 7;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;         p += <a class="code" href="../../d7/d81/app__sms_8c.html#a0ec2365c36d7af29acf3bdaad02b082a">unpacksms</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a> + p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a>);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = 1;                      <span class="comment">/* received message */</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a>(h);               <span class="comment">/* write the file */</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;         <span class="keywordflow">if</span> (p != h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] + 2) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Mismatch receive unpacking %d/%d\n&quot;</span>, p, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] + 2);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">return</span> 0xFF;                <span class="comment">/* duh! */</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;         }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown message type %02hhX\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2]);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         <span class="keywordflow">return</span> 0xFF;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="keywordflow">return</span> 0;                               <span class="comment">/* no error */</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div><div class="ttc" id="structsms__s_html_aed8d77b45e82e228b7c993a844228e53"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">sms_s::vp</a></div><div class="ttdeci">unsigned int vp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00237">app_sms.c:237</a></div></div>
<div class="ttc" id="structsms__s_html_a74432ad1d458c890a5f136080c831d57"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">sms_s::udhl</a></div><div class="ttdeci">int udhl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00233">app_sms.c:233</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad38c7ea91c75338009d7ef07df937ee9"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad38c7ea91c75338009d7ef07df937ee9">unpackaddress</a></div><div class="ttdeci">static unsigned char unpackaddress(char *o, unsigned char *i)</div><div class="ttdoc">unpack an address from i, return byte length, unpack to o </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00728">app_sms.c:728</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="structsms__s_html_a50b93d20a60c5ca8290725dff70be020"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">sms_s::udhi</a></div><div class="ttdeci">unsigned char udhi</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00235">app_sms.c:235</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsms__s_html_a0f7adeccf32fc4c52946d5d20b34c1cd"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">sms_s::srr</a></div><div class="ttdeci">unsigned char srr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00234">app_sms.c:234</a></div></div>
<div class="ttc" id="app__sms_8c_html_af45fa5279582c213474672cf0684d219"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a></div><div class="ttdeci">static void sms_writefile(sms_t *h)</div><div class="ttdoc">white a received text message to a file </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00998">app_sms.c:998</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="structsms__s_html_aa04ad9c90e68d8a6f92b612f798db482"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">sms_s::rp</a></div><div class="ttdeci">unsigned char rp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00236">app_sms.c:236</a></div></div>
<div class="ttc" id="structsms__s_html_a306f4c1d73939a3ccb91b0caf7127453"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a306f4c1d73939a3ccb91b0caf7127453">sms_s::cli</a></div><div class="ttdeci">char cli[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00240">app_sms.c:240</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="app__sms_8c_html_a0ec2365c36d7af29acf3bdaad02b082a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a0ec2365c36d7af29acf3bdaad02b082a">unpacksms</a></div><div class="ttdeci">static int unpacksms(unsigned char dcs, unsigned char *i, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</div><div class="ttdoc">general unpack - starts with length byte (octet or septet) and returns number of bytes used...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00712">app_sms.c:712</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="app__sms_8c_html_a7c221ca909fed50cb51bd59b0855bc68"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a7c221ca909fed50cb51bd59b0855bc68">unpackdate</a></div><div class="ttdeci">static struct timeval unpackdate(unsigned char *i)</div><div class="ttdoc">unpack a date and return </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00579">app_sms.c:579</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a1f0cc56d7098ac627c3a2ac4bd94b6d9"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">sms_s::dcs</a></div><div class="ttdeci">unsigned char dcs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00230">app_sms.c:230</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structsms__s_html_a2c7d9a176d66d466f3e8c54fd519460e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">sms_s::pid</a></div><div class="ttdeci">unsigned char pid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00229">app_sms.c:229</a></div></div>
<div class="ttc" id="structsms__s_html_a37cf044b446d0c9825730351ae1be8a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">sms_s::udh</a></div><div class="ttdeci">unsigned char udh[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00239">app_sms.c:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace3cb96a3f20c144ab6eabc4f6f7304e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace3cb96a3f20c144ab6eabc4f6f7304e">&#9670;&nbsp;</a></span>sms_handleincoming_proto2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sms_handleincoming_proto2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sms_handleincoming_proto2: handle the incoming message </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">1262</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l01739">ast_localtime()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l02357">ast_mktime()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01248">MAX_DEBUG_LEN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01249">sms_hexdump()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">sms_writefile()</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00038">ast_tm::tm_hour</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00039">ast_tm::tm_mday</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00037">ast_tm::tm_min</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00040">ast_tm::tm_mon</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00036">ast_tm::tm_sec</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;{</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   <span class="keywordtype">int</span> f, i, sz = 0;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="keywordtype">int</span> msg, msgsz;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> tm;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   <span class="keyword">struct </span>timeval now = { 0, 0 };</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <span class="keywordtype">char</span> debug_buf[<a class="code" href="../../d7/d81/app__sms_8c.html#ad88625c032fc5b3a096a60ddd129e2f4">MAX_DEBUG_LEN</a> * 3 + 1];</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   sz = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] + 2;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   <span class="comment">/* ast_verb(3, &quot;SMS-P2 Frame: %s\n&quot;, sms_hexdump(h-&gt;imsg, sz, debug_buf)); */</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;   <span class="comment">/* Parse message body (called payload) */</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;   now = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   <span class="keywordflow">for</span> (f = 4; f &lt; sz; ) {</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      msg = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f++];</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      msgsz = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f++];</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      msgsz += (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f++] * 256);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">switch</span> (msg) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">case</span> 0x13:                          <span class="comment">/* Body */</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Body#%02X=[%.*s]\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, msgsz, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f]);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;         <span class="keywordflow">if</span> (msgsz &gt;= <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>)) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            msgsz = <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) - 1;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         }</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; msgsz; i++) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[i] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + i];</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;         }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = msgsz;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordflow">case</span> 0x14:                          <span class="comment">/* Date SCTS */</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;         now = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;         <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;         tm.tm_mon = ( (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f] * 10) + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 1] ) - 1;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;         tm.tm_mday = ( (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 2] * 10) + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 3] );</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;         tm.tm_hour = ( (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 4] * 10) + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 5] );</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;         tm.tm_min = ( (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 6] * 10) + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f + 7] );</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;         tm.tm_sec = 0;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a>(&amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Date#%02X=%02d/%02d %02d:%02d\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, tm.tm_mday, tm.tm_mon + 1, tm.tm_hour, tm.tm_min);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordflow">case</span> 0x15:                          <span class="comment">/* Calling line (from SMSC) */</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;         <span class="keywordflow">if</span> (msgsz &gt;= 20) {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            msgsz = 20 - 1;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;         }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Origin#%02X=[%.*s]\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, msgsz, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f]);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, (<span class="keywordtype">char</span> *)(&amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f]), msgsz + 1);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">case</span> 0x18:                          <span class="comment">/* Destination(from TE/phone) */</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;         <span class="keywordflow">if</span> (msgsz &gt;= 20) {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            msgsz = 20 - 1;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         }</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Destination#%02X=[%.*s]\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, msgsz, &amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f]);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, (<span class="keywordtype">char</span> *)(&amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f]), msgsz + 1);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keywordflow">case</span> 0x1C:                          <span class="comment">/* Notify */</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Notify#%02X=%s\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, <a class="code" href="../../d7/d81/app__sms_8c.html#a5f9bfb13333d20c981dfa1de202ee13f">sms_hexdump</a>(&amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f], 3, debug_buf));</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS-P2 Par#%02X [%d]: %s\n&quot;</span>, (<span class="keywordtype">unsigned</span>)msg, msgsz, <a class="code" href="../../d7/d81/app__sms_8c.html#a5f9bfb13333d20c981dfa1de202ee13f">sms_hexdump</a>(&amp;h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[f], msgsz, debug_buf));</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      }</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      f+=msgsz;                           <span class="comment">/* Skip to next */</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   }</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = 1;                              <span class="comment">/* received message */</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a>(h);                       <span class="comment">/* write the file */</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   <span class="keywordflow">return</span> 0;                               <span class="comment">/* no error */</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;}</div><div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="app__sms_8c_html_af45fa5279582c213474672cf0684d219"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#af45fa5279582c213474672cf0684d219">sms_writefile</a></div><div class="ttdeci">static void sms_writefile(sms_t *h)</div><div class="ttdoc">white a received text message to a file </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00998">app_sms.c:998</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="app__sms_8c_html_a5f9bfb13333d20c981dfa1de202ee13f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a5f9bfb13333d20c981dfa1de202ee13f">sms_hexdump</a></div><div class="ttdeci">static char * sms_hexdump(unsigned char buf[], int size, char *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01249">app_sms.c:1249</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad88625c032fc5b3a096a60ddd129e2f4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad88625c032fc5b3a096a60ddd129e2f4">MAX_DEBUG_LEN</a></div><div class="ttdeci">#define MAX_DEBUG_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01248">app_sms.c:1248</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="localtime_8h_html_ae0843e4dbbd1fed36d2676dda58e0c44"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a></div><div class="ttdeci">struct timeval ast_mktime(struct ast_tm *const tmp, const char *zone)</div><div class="ttdoc">Timezone-independent version of mktime(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02357">localtime.c:2357</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f9bfb13333d20c981dfa1de202ee13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f9bfb13333d20c981dfa1de202ee13f">&#9670;&nbsp;</a></span>sms_hexdump()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* sms_hexdump </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>buf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01249">1249</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01248">MAX_DEBUG_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;{</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   <span class="keywordtype">int</span> f;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="keywordflow">for</span> (p = s, f = 0; f &lt; size &amp;&amp; f &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#ad88625c032fc5b3a096a60ddd129e2f4">MAX_DEBUG_LEN</a>; f++, p += 3) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      sprintf(p, <span class="stringliteral">&quot;%02hhX &quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[f]);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <span class="keywordflow">return</span>(s);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad88625c032fc5b3a096a60ddd129e2f4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad88625c032fc5b3a096a60ddd129e2f4">MAX_DEBUG_LEN</a></div><div class="ttdeci">#define MAX_DEBUG_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01248">app_sms.c:1248</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5e0ab37f40bc7f8885617847ffd3fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e0ab37f40bc7f8885617847ffd3fee">&#9670;&nbsp;</a></span>sms_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log the output, and remove file. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">774</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db2/asterisk_8h_source.html#l00032">AST_FILE_MODE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00303">isodate()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00122">log_file</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00224">sms_s::nolog</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00225">sms_s::queue</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;{</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordtype">int</span> o;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a> == <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> == <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   o = open(<a class="code" href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a>, O_CREAT | O_APPEND | O_WRONLY, <a class="code" href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a>);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="keywordflow">if</span> (o &gt;= 0) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordtype">char</span> line[1000], mrs[3] = <span class="stringliteral">&quot;&quot;</span>, *p;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[30];</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> n;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> &gt;= 0) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;         snprintf(mrs, <span class="keyword">sizeof</span>(mrs), <span class="stringliteral">&quot;%02hhX&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      snprintf(line, <span class="keyword">sizeof</span>(line), <span class="stringliteral">&quot;%s %c%c%c%s %s %s %s &quot;</span>,</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a>(time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), buf, <span class="keyword">sizeof</span>(buf)),</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> ? <span class="charliteral">&#39;I&#39;</span> : <span class="charliteral">&#39;O&#39;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a> ? <span class="charliteral">&#39;S&#39;</span> : <span class="charliteral">&#39;M&#39;</span>, mrs, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, <span class="stringliteral">&quot;-&quot;</span>), <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, <span class="stringliteral">&quot;-&quot;</span>) );</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      p = line + strlen(line);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a4e25ceb2cb34fddfa5c27adbf6c9a4ed">nolog</a>) {</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;         p += snprintf(p, 1000 - strlen(line), <span class="stringliteral">&quot;udl=%d&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;         <span class="keywordflow">for</span> (n = 0; n &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>; n++) {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n] == <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;               *p++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               *p++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n] == <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;               *p++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;               *p++ = <span class="charliteral">&#39;n&#39;</span>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n] == <span class="charliteral">&#39;\r&#39;</span>) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;               *p++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;               *p++ = <span class="charliteral">&#39;r&#39;</span>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n] &lt; 32 || h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n] == 127) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;               *p++ = 0xbf;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;               *p++ = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[n];</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;         }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      *p++ = <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      *p = 0;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> (write(o, line, strlen(line)) &lt; 0) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;write() failed: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      close(o);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a> = *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = 0;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="asterisk_8h_html_aa6293b2dae52a2b470494df672a26c42"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a></div><div class="ttdeci">#define AST_FILE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00032">asterisk.h:32</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsms__s_html_ae029547c37a01a171c894cefb942743f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">sms_s::queue</a></div><div class="ttdeci">char queue[30]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00225">app_sms.c:225</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa82dbf6bb6292091b6f9ac19cc841428"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a></div><div class="ttdeci">static char * isodate(time_t t, char *buf, int len)</div><div class="ttdoc">static, return a date/time in ISO format </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00303">app_sms.c:303</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad0345d4821606480fcb0e28327340660"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad0345d4821606480fcb0e28327340660">log_file</a></div><div class="ttdeci">static char log_file[255]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00122">app_sms.c:122</a></div></div>
<div class="ttc" id="structsms__s_html_a4e25ceb2cb34fddfa5c27adbf6c9a4ed"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a4e25ceb2cb34fddfa5c27adbf6c9a4ed">sms_s::nolog</a></div><div class="ttdeci">unsigned char nolog</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00224">app_sms.c:224</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24b70dbd9b6b663969974c877a202d61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24b70dbd9b6b663969974c877a202d61">&#9670;&nbsp;</a></span>sms_messagerx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_messagerx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">1503</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01483">DIR_RX</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00220">sms_s::err</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00219">sms_s::hangup</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01485">sms_debug()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">sms_handleincoming()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">sms_log()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01712">sms_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;{</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   <span class="keywordtype">int</span> cause;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aec1ab10167ae5ed9af8793c90c10c475">sms_debug</a> (<a class="code" href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a>, h);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2) {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aa92b5f49b3da5a82098a3011f8bb7947">sms_messagerx2</a>(h);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;   }</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   <span class="comment">/* parse incoming message for Protocol 1 */</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   <span class="keywordflow">switch</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[0]) {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   <span class="keywordflow">case</span> 0x91:                              <span class="comment">/* SMS_DATA */</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      cause = <a class="code" href="../../d7/d81/app__sms_8c.html#a43baf6d9daec56e893ebc9c204d852f3">sms_handleincoming</a> (h);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">if</span> (!cause) {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(h, <span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x95;              <span class="comment">/* SMS_ACK */</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0x02;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = 0x00;              <span class="comment">/* deliver report */</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[3] = 0x00;              <span class="comment">/* no parameters */</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      } <span class="keywordflow">else</span> {                            <span class="comment">/* NACK */</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(h, <span class="charliteral">&#39;N&#39;</span>);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x96;              <span class="comment">/* SMS_NACK */</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 3;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = 0;                 <span class="comment">/* delivery report */</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[3] = cause;             <span class="comment">/* cause */</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[4] = 0;                 <span class="comment">/* no parameters */</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      }</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   <span class="keywordflow">case</span> 0x92:                              <span class="comment">/* SMS_ERROR */</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a> = 1;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);                   <span class="comment">/* send whatever we sent again */</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;   <span class="keywordflow">case</span> 0x93:                              <span class="comment">/* SMS_EST */</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (h);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="keywordflow">case</span> 0x94:                              <span class="comment">/* SMS_REL */</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">hangup</a> = 1;                      <span class="comment">/* hangup */</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   <span class="keywordflow">case</span> 0x95:                              <span class="comment">/* SMS_ACK */</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(h, <span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (h);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   <span class="keywordflow">case</span> 0x96:                              <span class="comment">/* SMS_NACK */</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a> = 1;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(h, <span class="charliteral">&#39;N&#39;</span>);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (h);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <span class="keywordflow">default</span>:                                <span class="comment">/* Unknown */</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x92;                  <span class="comment">/* SMS_ERROR */</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 1;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = 3;                     <span class="comment">/* unknown message type */</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;   }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a47041feede8f04106f4d6221af763e9d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a></div><div class="ttdeci">static void sms_messagetx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01561">app_sms.c:1561</a></div></div>
<div class="ttc" id="structsms__s_html_ada449bf15f71bb79ab0e662561c78706"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">sms_s::hangup</a></div><div class="ttdeci">unsigned char hangup</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00219">app_sms.c:219</a></div></div>
<div class="ttc" id="app__sms_8c_html_aec1ab10167ae5ed9af8793c90c10c475"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aec1ab10167ae5ed9af8793c90c10c475">sms_debug</a></div><div class="ttdeci">static void sms_debug(int dir, sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01485">app_sms.c:1485</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa4fbf8951a3590171e5def3f7d4cd666"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa4fbf8951a3590171e5def3f7d4cd666">DIR_RX</a></div><div class="ttdeci">#define DIR_RX</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01483">app_sms.c:1483</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad5e0ab37f40bc7f8885617847ffd3fee"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a></div><div class="ttdeci">static void sms_log(sms_t *h, char status)</div><div class="ttdoc">Log the output, and remove file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00774">app_sms.c:774</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa92b5f49b3da5a82098a3011f8bb7947"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa92b5f49b3da5a82098a3011f8bb7947">sms_messagerx2</a></div><div class="ttdeci">static void sms_messagerx2(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01343">app_sms.c:1343</a></div></div>
<div class="ttc" id="structsms__s_html_a157434392012e4ce1590980a31f692ac"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">sms_s::err</a></div><div class="ttdeci">unsigned char err</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00220">app_sms.c:220</a></div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
<div class="ttc" id="app__sms_8c_html_aacb45147ec48b5972784c3cf3086d147"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a></div><div class="ttdeci">static void sms_nextoutgoing(sms_t *h)</div><div class="ttdoc">find and fill in next message, or send a REL if none waiting </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01442">app_sms.c:1442</a></div></div>
<div class="ttc" id="app__sms_8c_html_a43baf6d9daec56e893ebc9c204d852f3"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a43baf6d9daec56e893ebc9c204d852f3">sms_handleincoming</a></div><div class="ttdeci">static unsigned char sms_handleincoming(sms_t *h)</div><div class="ttdoc">handle the incoming message </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01112">app_sms.c:1112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa92b5f49b3da5a82098a3011f8bb7947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa92b5f49b3da5a82098a3011f8bb7947">&#9670;&nbsp;</a></span>sms_messagerx2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_messagerx2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">1343</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/d81/app__sms_8c.html#a6c597ad0ac2a2eea8e6653e622742287">DLL2_ACK</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00181">DLL2_SMS_ACK0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00182">DLL2_SMS_ACK1</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00176">DLL2_SMS_EST</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00177">DLL2_SMS_INFO_MO</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00178">DLL2_SMS_INFO_MT</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00180">DLL2_SMS_NACK</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00184">DLL2_SMS_REL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00162">DLL_SMS_MASK</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00219">sms_s::hangup</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">sms_log()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>.</p>
<div class="fragment"><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;{</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;   <span class="keywordtype">int</span> p = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[0] &amp; <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a> ; <span class="comment">/* mask the high bit */</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   <span class="keywordtype">int</span> cause;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="preprocessor">#define DLL2_ACK(h) ((h-&gt;framenumber &amp; 1) ? DLL2_SMS_ACK1: DLL2_SMS_ACK1)</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;   <span class="keywordflow">switch</span> (p) {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a>:                      <span class="comment">/* Protocol 2: Connection ready (fake): send message  */</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (h);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="comment">/* smssend(h,&quot;11 29 27 00 10 01 00 00 11 06 00 00 00 00 00 00 00 12 03 00 02 00 04 13 01 00 41 14 08 00 30 39 31 35 30 02 30 02 15 02 00 39 30 &quot;); */</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5">DLL2_SMS_INFO_MO</a>:                  <span class="comment">/* transport SMS_SUBMIT */</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b">DLL2_SMS_INFO_MT</a>:                  <span class="comment">/* transport SMS_DELIVERY */</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      cause = <a class="code" href="../../d7/d81/app__sms_8c.html#ace3cb96a3f20c144ab6eabc4f6f7304e">sms_handleincoming_proto2</a>(h);</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">if</span> (!cause) {                       <span class="comment">/* ACK */</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a>(h, <span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = <a class="code" href="../../d7/d81/app__sms_8c.html#a6c597ad0ac2a2eea8e6653e622742287">DLL2_ACK</a>(h);</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0x06;                  <span class="comment">/* msg len */</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = 0x04;                  <span class="comment">/* payload len */</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[3] = 0x00;                  <span class="comment">/* payload len */</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[4] = 0x1f;                  <span class="comment">/* Response type */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[5] = 0x01;                  <span class="comment">/* parameter len */</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[6] = 0x00;                  <span class="comment">/* parameter len */</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[7] = cause;                 <span class="comment">/* CONFIRM or error */</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8">DLL2_SMS_NACK</a>:                     <span class="comment">/* Protocol 2: SMS_NAK */</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a>;          <span class="comment">/* SMS_REL */</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0x00;                  <span class="comment">/* msg len */</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855">DLL2_SMS_ACK0</a>:</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a>:</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="comment">/* SMS_ACK also transport SMS_SUBMIT or SMS_DELIVERY */</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">if</span> ( (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] &amp; <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a>) == <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a>) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;         <span class="comment">/* a response to our Release, just hangup */</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">hangup</a> = 1;                  <span class="comment">/* hangup */</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;         <span class="comment">/* XXX depending on what we are.. */</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;SMS_SUBMIT or SMS_DELIVERY\n&quot;</span>);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a> (h);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a>:                      <span class="comment">/* Protocol 2: SMS_REL (hangup req) */</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = <a class="code" href="../../d7/d81/app__sms_8c.html#a6c597ad0ac2a2eea8e6653e622742287">DLL2_ACK</a>(h);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;   }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a47041feede8f04106f4d6221af763e9d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a></div><div class="ttdeci">static void sms_messagetx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01561">app_sms.c:1561</a></div></div>
<div class="ttc" id="structsms__s_html_ada449bf15f71bb79ab0e662561c78706"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">sms_s::hangup</a></div><div class="ttdeci">unsigned char hangup</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00219">app_sms.c:219</a></div></div>
<div class="ttc" id="app__sms_8c_html_ace3cb96a3f20c144ab6eabc4f6f7304e"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ace3cb96a3f20c144ab6eabc4f6f7304e">sms_handleincoming_proto2</a></div><div class="ttdeci">static int sms_handleincoming_proto2(sms_t *h)</div><div class="ttdoc">sms_handleincoming_proto2: handle the incoming message </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01262">app_sms.c:1262</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ae7948b7f83c79737c57370e63d2b6ea8">DLL2_SMS_NACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00180">app_sms.c:180</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a3d9593f4f21b1e09861ef6ff8787b3e5">DLL2_SMS_INFO_MO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00177">app_sms.c:177</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a20c3011fb7a87c560c2defa4de284855">DLL2_SMS_ACK0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00181">app_sms.c:181</a></div></div>
<div class="ttc" id="app__sms_8c_html_a6c597ad0ac2a2eea8e6653e622742287"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a6c597ad0ac2a2eea8e6653e622742287">DLL2_ACK</a></div><div class="ttdeci">#define DLL2_ACK(h)</div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a01cbc78b9b22bc743fa76b52bc31b99b">DLL2_SMS_INFO_MT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00178">app_sms.c:178</a></div></div>
<div class="ttc" id="app__sms_8c_html_ad5e0ab37f40bc7f8885617847ffd3fee"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ad5e0ab37f40bc7f8885617847ffd3fee">sms_log</a></div><div class="ttdeci">static void sms_log(sms_t *h, char status)</div><div class="ttdoc">Log the output, and remove file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00774">app_sms.c:774</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a4beada5edbf9c5838f1bbc26eb74b8bf">DLL2_SMS_REL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00184">app_sms.c:184</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a0939445034985054325921b2b0e8403a">DLL2_SMS_ACK1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00182">app_sms.c:182</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9a5df5d537055950e483ab1b368c26d73f">DLL2_SMS_EST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00176">app_sms.c:176</a></div></div>
<div class="ttc" id="app__sms_8c_html_aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aadad57a8949618b7d23705b7d718c9f9ab52fa5194e2be3c8953de452277a1ae6">DLL_SMS_MASK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00162">app_sms.c:162</a></div></div>
<div class="ttc" id="app__sms_8c_html_aacb45147ec48b5972784c3cf3086d147"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aacb45147ec48b5972784c3cf3086d147">sms_nextoutgoing</a></div><div class="ttdeci">static void sms_nextoutgoing(sms_t *h)</div><div class="ttdoc">find and fill in next message, or send a REL if none waiting </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01442">app_sms.c:1442</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47041feede8f04106f4d6221af763e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47041feede8f04106f4d6221af763e9d">&#9670;&nbsp;</a></span>sms_messagetx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_messagetx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">1561</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01484">DIR_TX</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00276">sms_s::framenumber</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00245">sms_s::obitp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00243">sms_s::obyte</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00248">sms_s::obyten</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00247">sms_s::obytep</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00244">sms_s::opause</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00273">sms_s::opause_0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00275">sms_s::oseizure</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00246">sms_s::osync</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00152">OSYNC_BITS</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01485">sms_debug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01712">sms_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;{</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = 0, p;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] + 2;               <span class="comment">/* total message length excluding checksum */</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;   <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; p++) {             <span class="comment">/* compute checksum */</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      c += h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[p];</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;   }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>] = 0 - <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;                   <span class="comment">/* actually, (256 - (c &amp; 0fxx)) &amp; 0xff) */</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#aec1ab10167ae5ed9af8793c90c10c475">sms_debug</a>(<a class="code" href="../../d7/d81/app__sms_8c.html#af85a8c6a09856dbb3bc88c829432db58">DIR_TX</a>, h);</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">framenumber</a>++;                       <span class="comment">/* Proto 2 */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">obytep</a> = 0;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">obitp</a> = 0;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2) {                 <span class="comment">/* Proto 2: */</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">oseizure</a> = 300;                  <span class="comment">/* 300bits (or more ?) */</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = 0;                       <span class="comment">/* Seizure starts with  space (0) */</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] == 0x7F) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a> = 8 * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a>;    <span class="comment">/* initial message delay */</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a> = 400;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   } <span class="keywordflow">else</span> {                                <span class="comment">/* Proto 1: */</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">oseizure</a> = 0;                    <span class="comment">/* No seizure */</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">obyte</a> = 1;                       <span class="comment">/* send mark (&#39;1&#39;) at the beginning */</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="comment">/* Change the initial message delay. BT requires 300ms,</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">       * but for others this might be way too much and the phone</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">       * could time out. XXX make it configurable.</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] == 0x93) {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a> = 8 * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">opause_0</a>;    <span class="comment">/* initial message delay */</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">opause</a> = 200;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   <span class="comment">/* Note - setting osync triggers the generator */</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#ae0ea1fb3f3d1fdc8111f0c54d71afb1c">OSYNC_BITS</a>;                  <span class="comment">/* 80 sync bits */</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a> = len + 1;                    <span class="comment">/* bytes to send (including checksum) */</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;}</div><div class="ttc" id="structsms__s_html_a07d0d1d8e847071c2d9e766749c03da3"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a07d0d1d8e847071c2d9e766749c03da3">sms_s::opause_0</a></div><div class="ttdeci">int opause_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00273">app_sms.c:273</a></div></div>
<div class="ttc" id="structsms__s_html_a299a3166d8ff58de5a5510b0715c552c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">sms_s::obyten</a></div><div class="ttdeci">unsigned char obyten</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00248">app_sms.c:248</a></div></div>
<div class="ttc" id="structsms__s_html_aebe123f864a95e87c1178e3c295aba49"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aebe123f864a95e87c1178e3c295aba49">sms_s::obitp</a></div><div class="ttdeci">unsigned char obitp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00245">app_sms.c:245</a></div></div>
<div class="ttc" id="app__sms_8c_html_aec1ab10167ae5ed9af8793c90c10c475"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aec1ab10167ae5ed9af8793c90c10c475">sms_debug</a></div><div class="ttdeci">static void sms_debug(int dir, sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01485">app_sms.c:1485</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="structsms__s_html_a3fd2579a2aaf53083eb8d3d85094554c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">sms_s::osync</a></div><div class="ttdeci">unsigned char osync</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00246">app_sms.c:246</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_ae0ea1fb3f3d1fdc8111f0c54d71afb1c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ae0ea1fb3f3d1fdc8111f0c54d71afb1c">OSYNC_BITS</a></div><div class="ttdeci">#define OSYNC_BITS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00152">app_sms.c:152</a></div></div>
<div class="ttc" id="structsms__s_html_a91573120b8594c3c1581a187c1abbca3"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a91573120b8594c3c1581a187c1abbca3">sms_s::obyte</a></div><div class="ttdeci">unsigned char obyte</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00243">app_sms.c:243</a></div></div>
<div class="ttc" id="structsms__s_html_a68ed7cd4df73b8c9bf4b23d948d1e638"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">sms_s::framenumber</a></div><div class="ttdeci">int framenumber</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00276">app_sms.c:276</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="app__sms_8c_html_af85a8c6a09856dbb3bc88c829432db58"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#af85a8c6a09856dbb3bc88c829432db58">DIR_TX</a></div><div class="ttdeci">#define DIR_TX</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01484">app_sms.c:1484</a></div></div>
<div class="ttc" id="structsms__s_html_a8fa429a43fa2c62a852096b184fbcdc4"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8fa429a43fa2c62a852096b184fbcdc4">sms_s::obytep</a></div><div class="ttdeci">unsigned char obytep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00247">app_sms.c:247</a></div></div>
<div class="ttc" id="structsms__s_html_a8468bed3bf799ea150212c167133e6ef"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8468bed3bf799ea150212c167133e6ef">sms_s::oseizure</a></div><div class="ttdeci">int oseizure</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00275">app_sms.c:275</a></div></div>
<div class="ttc" id="structsms__s_html_a600d3882475c4c4c8e0855a8516562aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a600d3882475c4c4c8e0855a8516562aa">sms_s::opause</a></div><div class="ttdeci">unsigned int opause</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00244">app_sms.c:244</a></div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aacb45147ec48b5972784c3cf3086d147"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb45147ec48b5972784c3cf3086d147">&#9670;&nbsp;</a></span>sms_nextoutgoing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_nextoutgoing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>find and fill in next message, or send a REL if none waiting </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">1442</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00154">ast_config_AST_SPOOL_DIR</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02231">ast_mkdir()</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">d</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00225">sms_s::queue</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01102">readdirqueue()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00221">sms_s::sent_rel</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">sms_compose1()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01213">sms_compose2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01343">sms_messagerx2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;{</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   <span class="keywordtype">char</span> fn[100 + NAME_MAX] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;   DIR *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;   <span class="keywordtype">char</span> more = 0;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> = *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a> = <span class="charliteral">&#39;\0&#39;</span>;                 <span class="comment">/* clear destinations */</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = 0;                              <span class="comment">/* outgoing message */</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   snprintf(fn, <span class="keyword">sizeof</span>(fn), <span class="stringliteral">&quot;%s/sms/%s&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a> ? <span class="stringliteral">&quot;mttx&quot;</span> : <span class="stringliteral">&quot;motx&quot;</span>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a>(fn, 0777);                    <span class="comment">/* ensure it exists */</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   d = opendir(fn);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;   <span class="keywordflow">if</span> (d) {</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keyword">struct </span>dirent *f = <a class="code" href="../../d7/d81/app__sms_8c.html#abe8206bb9c2adf04e478cd8e01bd5a94">readdirqueue</a>(d, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>);</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">if</span> (f) {</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;         snprintf(fn + strlen(fn), <span class="keyword">sizeof</span>(fn) - strlen(fn), <span class="stringliteral">&quot;/%s&quot;</span>, f-&gt;d_name);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#a35be9014d402309539c591ab37a4e7c4">sms_readfile</a>(h, fn);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#abe8206bb9c2adf04e478cd8e01bd5a94">readdirqueue</a>(d, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>)) {</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            more = 1;                   <span class="comment">/* more to send */</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         }</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      closedir(d);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;   }</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> || *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>) {                 <span class="comment">/* message to send */</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2) {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#a4cea080950ce2066ed4987ee16fcb8d5">sms_compose2</a>(h, more);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#a184a0ba43954b42a5db9a1b1a4854ccb">sms_compose1</a>(h, more);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      }</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   } <span class="keywordflow">else</span> {                                <span class="comment">/* no message */</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> == 2) {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x17;              <span class="comment">/* SMS_REL */</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x94;              <span class="comment">/* SMS_REL */</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 0;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a71328052bedc6cdb2e064d6bca5b64a0">sent_rel</a> = 1;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      }</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;   }</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a47041feede8f04106f4d6221af763e9d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a></div><div class="ttdeci">static void sms_messagetx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01561">app_sms.c:1561</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
<div class="ttc" id="app__sms_8c_html_a184a0ba43954b42a5db9a1b1a4854ccb"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a184a0ba43954b42a5db9a1b1a4854ccb">sms_compose1</a></div><div class="ttdeci">static void sms_compose1(sms_t *h, int more)</div><div class="ttdoc">compose a message for protocol 1 </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01400">app_sms.c:1400</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="app__sms_8c_html_a35be9014d402309539c591ab37a4e7c4"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a35be9014d402309539c591ab37a4e7c4">sms_readfile</a></div><div class="ttdeci">static void sms_readfile(sms_t *h, char *fn)</div><div class="ttdoc">parse and delete a file </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00827">app_sms.c:827</a></div></div>
<div class="ttc" id="app__sms_8c_html_abe8206bb9c2adf04e478cd8e01bd5a94"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#abe8206bb9c2adf04e478cd8e01bd5a94">readdirqueue</a></div><div class="ttdeci">static struct dirent * readdirqueue(DIR *d, char *queue)</div><div class="ttdoc">read dir skipping dot files... </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01102">app_sms.c:1102</a></div></div>
<div class="ttc" id="app__sms_8c_html_a4cea080950ce2066ed4987ee16fcb8d5"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a4cea080950ce2066ed4987ee16fcb8d5">sms_compose2</a></div><div class="ttdeci">static void sms_compose2(sms_t *h, int more)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01213">app_sms.c:1213</a></div></div>
<div class="ttc" id="structsms__s_html_ae029547c37a01a171c894cefb942743f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">sms_s::queue</a></div><div class="ttdeci">char queue[30]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00225">app_sms.c:225</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="paths_8h_html_a95c5b4ffe620dc96d1ea9311b35c4d4f"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a></div><div class="ttdeci">const char * ast_config_AST_SPOOL_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00154">options.c:154</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structsms__s_html_a71328052bedc6cdb2e064d6bca5b64a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a71328052bedc6cdb2e064d6bca5b64a0">sms_s::sent_rel</a></div><div class="ttdeci">unsigned char sent_rel</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00221">app_sms.c:221</a></div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
<div class="ttc" id="utils_8h_html_a7c38859ed90e96df2b0a0fdf843769d0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a></div><div class="ttdeci">int ast_mkdir(const char *path, int mode)</div><div class="ttdoc">Recursively create directory path. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02231">main/utils.c:2231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1cc2166cf9b6a4496caf3bb1d11cb6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1cc2166cf9b6a4496caf3bb1d11cb6e">&#9670;&nbsp;</a></span>sms_process()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">signed short *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Process an incoming frame, trying to detect the carrier and decode the message. The two frequencies are 1300 and 2100 Hz. The decoder detects the amplitude of the signal over the last few samples, filtering the absolute values with a lowpass filter. If the magnitude (h-&gt;imag) is large enough, multiply the signal by the two carriers, and compute the amplitudes m0 and m1. Record the current sample as '0' or '1' depending on which one is greater. The last 3 bits are stored in h-&gt;ibith, with the count of '1' bits in h-&gt;ibitt. XXX the rest is to be determined. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01712">1712</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/dc2/f2c_8h_source.html#l00195">abs</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00220">sms_s::err</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00276">sms_s::framenumber</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00219">sms_s::hangup</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00262">sms_s::ibitc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00269">sms_s::ibith</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00261">sms_s::ibitl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00264">sms_s::ibitn</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00270">sms_s::ibitt</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00267">sms_s::ibytec</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00266">sms_s::ibytep</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00265">sms_s::ibytev</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00255">sms_s::idle</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00268">sms_s::ierr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00256">sms_s::imag</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00251">sms_s::imc0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00251">sms_s::imc1</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00251">sms_s::ims0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00251">sms_s::ims1</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00250">sms_s::imsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00259">sms_s::ipc0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00260">sms_s::ipc1</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00263">sms_s::iphasep</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00257">sms_s::ips0</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00258">sms_s::ips1</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00248">sms_s::obyten</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00249">sms_s::omsg</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00246">sms_s::osync</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00274">sms_s::protocol</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00221">sms_s::sent_rel</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01503">sms_messagerx()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01561">sms_messagetx()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00132">wave</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;{</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">    * Ignore incoming audio while a packet is being transmitted,</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">    * the protocol is half-duplex.</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">    * Unfortunately this means that if the outbound and incoming</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">    * transmission overlap (which is an error condition anyways),</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">    * we may miss some data and this makes debugging harder.</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">obyten</a> || h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">osync</a>) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;   }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   <span class="keywordflow">for</span> ( ; samples-- ; data++) {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> m0, m1;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(*data) &gt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">imag</a>) {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">imag</a> = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(*data);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">imag</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">imag</a> * 7 / 8;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      }</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">imag</a> &lt;= 500) {               <span class="comment">/* below [arbitrary] threahold: lost carrier */</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad68b3622d25bbc56f730bedd0214405f">idle</a>++ == 80000) {       <span class="comment">/* nothing happening */</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No data, hanging up\n&quot;</span>);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">hangup</a> = 1;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a> = 1;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;         }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a>) {                  <span class="comment">/* error */</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Error %d, hanging up\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a>);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="comment">/* Protocol 1 */</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">err</a> = 1;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[0] = 0x92;          <span class="comment">/* error */</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[1] = 1;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">omsg</a>[2] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a>;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <a class="code" href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a>(h);           <span class="comment">/* send error */</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;         }</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a> = 0;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad68b3622d25bbc56f730bedd0214405f">idle</a> = 0;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="comment">/* multiply signal by the two carriers. */</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad7828ea9fc6b6265334a5eb61a564b00">ims0</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad7828ea9fc6b6265334a5eb61a564b00">ims0</a> * 6 + *data * <a class="code" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a30b0b8cecb7293bd35f9f2b6f8de16c6">ips0</a>]) / 7;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a15f6e9f44eaba4de3b697b74886b3ea4">imc0</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a15f6e9f44eaba4de3b697b74886b3ea4">imc0</a> * 6 + *data * <a class="code" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">ipc0</a>]) / 7;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a6ef929fe1fcd221a71fdedffb986414e">ims1</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a6ef929fe1fcd221a71fdedffb986414e">ims1</a> * 6 + *data * <a class="code" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#acf0933f5bc0ccfc7dbd8b7bfe867629f">ips1</a>]) / 7;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1a29b56b3352d6832f4ba42f3f3138fb">imc1</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1a29b56b3352d6832f4ba42f3f3138fb">imc1</a> * 6 + *data * <a class="code" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">ipc1</a>]) / 7;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="comment">/* compute the amplitudes */</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      m0 = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad7828ea9fc6b6265334a5eb61a564b00">ims0</a> * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ad7828ea9fc6b6265334a5eb61a564b00">ims0</a> + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a15f6e9f44eaba4de3b697b74886b3ea4">imc0</a> * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a15f6e9f44eaba4de3b697b74886b3ea4">imc0</a>;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      m1 = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a6ef929fe1fcd221a71fdedffb986414e">ims1</a> * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a6ef929fe1fcd221a71fdedffb986414e">ims1</a> + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1a29b56b3352d6832f4ba42f3f3138fb">imc1</a> * h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1a29b56b3352d6832f4ba42f3f3138fb">imc1</a>;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="comment">/* advance the sin/cos pointers */</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a30b0b8cecb7293bd35f9f2b6f8de16c6">ips0</a> += 21) &gt;= 80) {</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a30b0b8cecb7293bd35f9f2b6f8de16c6">ips0</a> -= 80;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">ipc0</a> += 21) &gt;= 80) {</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">ipc0</a> -= 80;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      }</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#acf0933f5bc0ccfc7dbd8b7bfe867629f">ips1</a> += 13) &gt;= 80) {</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#acf0933f5bc0ccfc7dbd8b7bfe867629f">ips1</a> -= 80;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      }</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordflow">if</span> ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">ipc1</a> += 13) &gt;= 80) {</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">ipc1</a> -= 80;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="comment">/* set new bit to 1 or 0 depending on which value is stronger */</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a17932b980ed0450a7cdb1ab8ea145cfc">ibith</a> &lt;&lt;= 1;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">if</span> (m1 &gt; m0) {</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a17932b980ed0450a7cdb1ab8ea145cfc">ibith</a> |= 1;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      }</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a17932b980ed0450a7cdb1ab8ea145cfc">ibith</a> &amp; 8) {</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0d992c1c927311c7a080f721f4d87f28">ibitt</a>--;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      }</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a17932b980ed0450a7cdb1ab8ea145cfc">ibith</a> &amp; 1) {</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0d992c1c927311c7a080f721f4d87f28">ibitt</a>++;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      }</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      bit = ((h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0d992c1c927311c7a080f721f4d87f28">ibitt</a> &gt; 1) ? 1 : 0);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keywordflow">if</span> (bit != h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a9213f0f8b45857a26cbd8234deeec54b">ibitl</a>) {</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a596bd4e14c0c7e431e4224d2740fad17">ibitc</a> = 1;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a596bd4e14c0c7e431e4224d2740fad17">ibitc</a>++;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a9213f0f8b45857a26cbd8234deeec54b">ibitl</a> = bit;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keywordflow">if</span> (!h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a596bd4e14c0c7e431e4224d2740fad17">ibitc</a> == 4 &amp;&amp; !bit) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> = 1;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8c9d26644b469879cc24afd0bcb6dc8f">iphasep</a> = 0;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      }</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">if</span> (bit &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a596bd4e14c0c7e431e4224d2740fad17">ibitc</a> == 200) {       <span class="comment">/* sync, restart message */</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;         <span class="comment">/* Protocol 2: empty connection ready (I am master) */</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">framenumber</a> &lt; 0 &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a> &gt;= 160 &amp;&amp; !memcmp(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>, <span class="stringliteral">&quot;UUUUUUUUUUUUUUUUUUUU&quot;</span>, 20)) {</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">framenumber</a> = 1;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;SMS protocol 2 detected\n&quot;</span>);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">protocol</a> = 2;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[0] = 0xff;          <span class="comment">/* special message (fake) */</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[2] = 0x00;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a> = 0;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <a class="code" href="../../d7/d81/app__sms_8c.html#a24b70dbd9b6b663969974c877a202d61">sms_messagerx</a>(h);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;         }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a> = 0;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      }</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a>) {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;         h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8c9d26644b469879cc24afd0bcb6dc8f">iphasep</a> += 12;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8c9d26644b469879cc24afd0bcb6dc8f">iphasep</a> &gt;= 80) {         <span class="comment">/* next bit */</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8c9d26644b469879cc24afd0bcb6dc8f">iphasep</a> -= 80;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a>++ == 9) {      <span class="comment">/* end of byte */</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;               <span class="keywordflow">if</span> (!bit) {             <span class="comment">/* bad stop bit */</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                  <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a71328052bedc6cdb2e064d6bca5b64a0">sent_rel</a>) {</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">hangup</a> = 1;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                     <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bad stop bit\n&quot;</span>);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = 0xFF;     <span class="comment">/* unknown error */</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                  }</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                  <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> &lt; <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>)) {</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a>] = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a84557faba63a8f3240f1c8cde8a4d690">ibytev</a>;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a> += h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a84557faba63a8f3240f1c8cde8a4d690">ibytev</a>;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a>++;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> == <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>)) {</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                     <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;msg too large\n&quot;</span>);</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = 2;    <span class="comment">/* bad message length */</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                  }</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                  <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> &gt; 1 &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">ibytep</a> == 3 + h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">imsg</a>[1] &amp;&amp; !h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a>) {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                     <span class="keywordflow">if</span> (!h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">ibytec</a>) {</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                        <a class="code" href="../../d7/d81/app__sms_8c.html#a24b70dbd9b6b663969974c877a202d61">sms_messagerx</a>(h);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;bad checksum\n&quot;</span>);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">ierr</a> = 1; <span class="comment">/* bad checksum */</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                     }</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                  }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;               }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">ibitn</a> = 0;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            }</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a84557faba63a8f3240f1c8cde8a4d690">ibytev</a> = (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a84557faba63a8f3240f1c8cde8a4d690">ibytev</a> &gt;&gt; 1) + (bit ? 0x80 : 0);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;         }</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   }</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a24b70dbd9b6b663969974c877a202d61"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a24b70dbd9b6b663969974c877a202d61">sms_messagerx</a></div><div class="ttdeci">static void sms_messagerx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01503">app_sms.c:1503</a></div></div>
<div class="ttc" id="app__sms_8c_html_a47041feede8f04106f4d6221af763e9d"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a47041feede8f04106f4d6221af763e9d">sms_messagetx</a></div><div class="ttdeci">static void sms_messagetx(sms_t *h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01561">app_sms.c:1561</a></div></div>
<div class="ttc" id="structsms__s_html_ada449bf15f71bb79ab0e662561c78706"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ada449bf15f71bb79ab0e662561c78706">sms_s::hangup</a></div><div class="ttdeci">unsigned char hangup</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00219">app_sms.c:219</a></div></div>
<div class="ttc" id="structsms__s_html_a60ee36698e956201dc2fd920eacf25fe"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a60ee36698e956201dc2fd920eacf25fe">sms_s::ipc1</a></div><div class="ttdeci">unsigned char ipc1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00260">app_sms.c:260</a></div></div>
<div class="ttc" id="structsms__s_html_a299a3166d8ff58de5a5510b0715c552c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a299a3166d8ff58de5a5510b0715c552c">sms_s::obyten</a></div><div class="ttdeci">unsigned char obyten</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00248">app_sms.c:248</a></div></div>
<div class="ttc" id="structsms__s_html_adb1bd77faccb1c8198882df8475b5979"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adb1bd77faccb1c8198882df8475b5979">sms_s::ipc0</a></div><div class="ttdeci">unsigned char ipc0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00259">app_sms.c:259</a></div></div>
<div class="ttc" id="structsms__s_html_a9213f0f8b45857a26cbd8234deeec54b"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a9213f0f8b45857a26cbd8234deeec54b">sms_s::ibitl</a></div><div class="ttdeci">unsigned char ibitl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00261">app_sms.c:261</a></div></div>
<div class="ttc" id="structsms__s_html_a3130aa304b0c5b6b85bf740f27eeaac7"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3130aa304b0c5b6b85bf740f27eeaac7">sms_s::ibytep</a></div><div class="ttdeci">unsigned char ibytep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00266">app_sms.c:266</a></div></div>
<div class="ttc" id="structsms__s_html_a3fd2579a2aaf53083eb8d3d85094554c"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3fd2579a2aaf53083eb8d3d85094554c">sms_s::osync</a></div><div class="ttdeci">unsigned char osync</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00246">app_sms.c:246</a></div></div>
<div class="ttc" id="structsms__s_html_ab2a8421a184a36fdb85c4fb515ee54f8"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab2a8421a184a36fdb85c4fb515ee54f8">sms_s::imsg</a></div><div class="ttdeci">unsigned char imsg[250]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00250">app_sms.c:250</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structsms__s_html_ad68b3622d25bbc56f730bedd0214405f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ad68b3622d25bbc56f730bedd0214405f">sms_s::idle</a></div><div class="ttdeci">unsigned int idle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00255">app_sms.c:255</a></div></div>
<div class="ttc" id="structsms__s_html_a15f6e9f44eaba4de3b697b74886b3ea4"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a15f6e9f44eaba4de3b697b74886b3ea4">sms_s::imc0</a></div><div class="ttdeci">signed long long imc0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00251">app_sms.c:251</a></div></div>
<div class="ttc" id="structsms__s_html_a2363e944aac6fa90443ce57f8a70c78a"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2363e944aac6fa90443ce57f8a70c78a">sms_s::omsg</a></div><div class="ttdeci">unsigned char omsg[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00249">app_sms.c:249</a></div></div>
<div class="ttc" id="structsms__s_html_a84557faba63a8f3240f1c8cde8a4d690"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a84557faba63a8f3240f1c8cde8a4d690">sms_s::ibytev</a></div><div class="ttdeci">unsigned char ibytev</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00265">app_sms.c:265</a></div></div>
<div class="ttc" id="structsms__s_html_a0d992c1c927311c7a080f721f4d87f28"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0d992c1c927311c7a080f721f4d87f28">sms_s::ibitt</a></div><div class="ttdeci">unsigned char ibitt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00270">app_sms.c:270</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsms__s_html_a30b0b8cecb7293bd35f9f2b6f8de16c6"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a30b0b8cecb7293bd35f9f2b6f8de16c6">sms_s::ips0</a></div><div class="ttdeci">unsigned char ips0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00257">app_sms.c:257</a></div></div>
<div class="ttc" id="app__sms_8c_html_abe867fed599c026df3020fca010dafdd"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a></div><div class="ttdeci">static const signed short wave[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00132">app_sms.c:132</a></div></div>
<div class="ttc" id="structsms__s_html_a1a29b56b3352d6832f4ba42f3f3138fb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1a29b56b3352d6832f4ba42f3f3138fb">sms_s::imc1</a></div><div class="ttdeci">signed long long imc1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00251">app_sms.c:251</a></div></div>
<div class="ttc" id="structsms__s_html_aef3956e134f50849c6e9f0da45e39302"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aef3956e134f50849c6e9f0da45e39302">sms_s::imag</a></div><div class="ttdeci">unsigned short imag</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00256">app_sms.c:256</a></div></div>
<div class="ttc" id="structsms__s_html_a68ed7cd4df73b8c9bf4b23d948d1e638"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a68ed7cd4df73b8c9bf4b23d948d1e638">sms_s::framenumber</a></div><div class="ttdeci">int framenumber</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00276">app_sms.c:276</a></div></div>
<div class="ttc" id="structsms__s_html_ac78f4035f45f1aa49feb4182b1867a5b"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac78f4035f45f1aa49feb4182b1867a5b">sms_s::ierr</a></div><div class="ttdeci">unsigned char ierr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00268">app_sms.c:268</a></div></div>
<div class="ttc" id="structsms__s_html_a596bd4e14c0c7e431e4224d2740fad17"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a596bd4e14c0c7e431e4224d2740fad17">sms_s::ibitc</a></div><div class="ttdeci">unsigned char ibitc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00262">app_sms.c:262</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="structsms__s_html_a157434392012e4ce1590980a31f692ac"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a157434392012e4ce1590980a31f692ac">sms_s::err</a></div><div class="ttdeci">unsigned char err</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00220">app_sms.c:220</a></div></div>
<div class="ttc" id="structsms__s_html_a8d3b48d2e2b2b6c045f807e327bf70f1"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8d3b48d2e2b2b6c045f807e327bf70f1">sms_s::ibytec</a></div><div class="ttdeci">unsigned char ibytec</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00267">app_sms.c:267</a></div></div>
<div class="ttc" id="f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00195">f2c.h:195</a></div></div>
<div class="ttc" id="structsms__s_html_a17932b980ed0450a7cdb1ab8ea145cfc"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a17932b980ed0450a7cdb1ab8ea145cfc">sms_s::ibith</a></div><div class="ttdeci">unsigned char ibith</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00269">app_sms.c:269</a></div></div>
<div class="ttc" id="structsms__s_html_acf0933f5bc0ccfc7dbd8b7bfe867629f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#acf0933f5bc0ccfc7dbd8b7bfe867629f">sms_s::ips1</a></div><div class="ttdeci">unsigned char ips1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00258">app_sms.c:258</a></div></div>
<div class="ttc" id="structsms__s_html_a71328052bedc6cdb2e064d6bca5b64a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a71328052bedc6cdb2e064d6bca5b64a0">sms_s::sent_rel</a></div><div class="ttdeci">unsigned char sent_rel</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00221">app_sms.c:221</a></div></div>
<div class="ttc" id="structsms__s_html_a8c9d26644b469879cc24afd0bcb6dc8f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a8c9d26644b469879cc24afd0bcb6dc8f">sms_s::iphasep</a></div><div class="ttdeci">unsigned char iphasep</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00263">app_sms.c:263</a></div></div>
<div class="ttc" id="structsms__s_html_ad7828ea9fc6b6265334a5eb61a564b00"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ad7828ea9fc6b6265334a5eb61a564b00">sms_s::ims0</a></div><div class="ttdeci">signed long long ims0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00251">app_sms.c:251</a></div></div>
<div class="ttc" id="structsms__s_html_ab30e8d7e05ae904d3248e0d51255c005"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab30e8d7e05ae904d3248e0d51255c005">sms_s::protocol</a></div><div class="ttdeci">int protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00274">app_sms.c:274</a></div></div>
<div class="ttc" id="structsms__s_html_a3db9d3dbeac51ea5edbb3829ce02c4ef"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a3db9d3dbeac51ea5edbb3829ce02c4ef">sms_s::ibitn</a></div><div class="ttdeci">unsigned char ibitn</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00264">app_sms.c:264</a></div></div>
<div class="ttc" id="structsms__s_html_a6ef929fe1fcd221a71fdedffb986414e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a6ef929fe1fcd221a71fdedffb986414e">sms_s::ims1</a></div><div class="ttdeci">signed long long ims1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00251">app_sms.c:251</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35be9014d402309539c591ab37a4e7c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35be9014d402309539c591ab37a4e7c4">&#9670;&nbsp;</a></span>sms_readfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_readfile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parse and delete a file </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">827</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l02357">ast_mktime()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">d</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00230">sms_s::dcs</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00283">is16bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00281">is7bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00282">is8bit</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00288">numcpy()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00485">packsms16()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00446">packsms8()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00229">sms_s::pid</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00236">sms_s::rp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../df/d44/app__meetme_8c.html#abd5465a13e11fe1c52a5a0f7b0b0812e">S</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00215">SMSLEN</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00234">sms_s::srr</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00038">ast_tm::tm_hour</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00044">ast_tm::tm_isdst</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00039">ast_tm::tm_mday</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00037">ast_tm::tm_min</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00040">ast_tm::tm_mon</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00036">ast_tm::tm_sec</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00041">ast_tm::tm_year</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00239">sms_s::udh</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00235">sms_s::udhi</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00277">sms_s::udtxt</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00315">utf8decode()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00237">sms_s::vp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01442">sms_nextoutgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="keywordtype">char</span> line[1000];</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   FILE *s;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordtype">char</span> dcsset = 0;                        <span class="comment">/* if DSC set */</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Sending %s\n&quot;</span>, fn);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a> = *h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a> = 0;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = -1;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = 0xF1;                          <span class="comment">/* normal messages class 1 */</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   s = fopen(fn, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">if</span> (unlink(fn)) {                   <span class="comment">/* concurrent access, we lost */</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         fclose(s);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">while</span> (fgets (line, <span class="keyword">sizeof</span>(line), s)) {   <span class="comment">/* process line in file */</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;         <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         <span class="keywordtype">void</span> *pp = &amp;p;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         <span class="keywordflow">for</span> (p = line; *p &amp;&amp; *p != <span class="charliteral">&#39;\n&#39;</span> &amp;&amp; *p != <span class="charliteral">&#39;\r&#39;</span>; p++);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;         *p = 0;                         <span class="comment">/* strip eoln */</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         p = line;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         <span class="keywordflow">if</span> (!*p || *p == <span class="charliteral">&#39;;&#39;</span>) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">continue</span>;                   <span class="comment">/* blank line or comment, ignore */</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;         <span class="keywordflow">while</span> (isalnum(*p)) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            *p = tolower (*p);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            p++;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         <span class="keywordflow">while</span> (isspace (*p)) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            *p++ = 0;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;=&#39;</span>) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            *p++ = 0;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;ud&quot;</span>)) {  <span class="comment">/* parse message (UTF-8) */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;               <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> o = 0;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;               memcpy(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aaa5504977ac9f7302b9632878eb455e5">udtxt</a>, p, <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>); <span class="comment">/* for protocol 2 */</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;               <span class="keywordflow">while</span> (*p &amp;&amp; o &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[o++] = <a class="code" href="../../d7/d81/app__sms_8c.html#a375cda00ad33985349625ad6f8ae70ef">utf8decode</a>(pp);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;               }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = o;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;               <span class="keywordflow">if</span> (*p) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;UD too long in %s\n&quot;</span>, fn);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;               }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;               <span class="keywordflow">while</span> (isspace (*p)) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                  p++;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;               }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;               <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;oa&quot;</span>) &amp;&amp; strlen(p) &lt; <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>)) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                  <a class="code" href="../../d7/d81/app__sms_8c.html#a660b5407faba61b0835356de97c78a0c">numcpy</a> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>, p);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;da&quot;</span>) &amp;&amp; strlen(p) &lt; <span class="keyword">sizeof</span>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>)) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                  <a class="code" href="../../d7/d81/app__sms_8c.html#a660b5407faba61b0835356de97c78a0c">numcpy</a> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>, p);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;pid&quot;</span>)) {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a> = atoi(p);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;dcs&quot;</span>)) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = atoi(p);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                  dcsset = 1;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;mr&quot;</span>)) {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> = atoi(p);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;srr&quot;</span>)) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a> = (atoi(p) ? 1 : 0);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;vp&quot;</span>)) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a> = atoi(p);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;rp&quot;</span>)) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a> = (atoi(p) ? 1 : 0);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;scts&quot;</span>)) {    <span class="comment">/* get date/time */</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                  <span class="keywordtype">int</span> Y, m, <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, H, M, <a class="code" href="../../df/d44/app__meetme_8c.html#abd5465a13e11fe1c52a5a0f7b0b0812e">S</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                  <span class="comment">/* XXX Why aren&#39;t we using ast_strptime here? */</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                  <span class="keywordflow">if</span> (sscanf(p, <span class="stringliteral">&quot;%4d-%2d-%2dT%2d:%2d:%2d&quot;</span>, &amp;Y, &amp;m, &amp;d, &amp;H, &amp;M, &amp;S) == 6) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                     <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> t = { 0, };</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">tm_year</a> = Y - 1900;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a> = m - 1;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">tm_mday</a> = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">tm_hour</a> = H;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">tm_min</a> = M;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a18df301c1a10c8d493da86ce5c2aea78">tm_sec</a> = <a class="code" href="../../df/d44/app__meetme_8c.html#abd5465a13e11fe1c52a5a0f7b0b0812e">S</a>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                     t.<a class="code" href="../../d5/d84/structast__tm.html#a7d102a87f898878ebf37ebd87504e099">tm_isdst</a> = -1;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a>(&amp;t, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                     <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>.tv_sec == 0) {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                        <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bad date/timein %s: %s&quot;</span>, fn, p);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                     }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                  }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot parse in %s: %s=%si\n&quot;</span>, fn, line, p);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;               }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;#&#39;</span>) {                   <span class="comment">/* raw hex format */</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            *p++ = 0;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;#&#39;</span>) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;               p++;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;               <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;ud&quot;</span>)) {        <span class="comment">/* user data */</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                  <span class="keywordtype">int</span> o = 0;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                  <span class="keywordflow">while</span> (*p &amp;&amp; o &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                     <span class="keywordflow">if</span> (isxdigit(*p) &amp;&amp; isxdigit(p[1]) &amp;&amp; isxdigit(p[2]) &amp;&amp; isxdigit(p[3])) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[o++] =</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                           (((isalpha(*p) ? 9 : 0) + (*p &amp; 0xF)) &lt;&lt; 12) +</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                           (((isalpha(p[1]) ? 9 : 0) + (p[1] &amp; 0xF)) &lt;&lt; 8) +</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                           (((isalpha(p[2]) ? 9 : 0) + (p[2] &amp; 0xF)) &lt;&lt; 4) + ((isalpha(p[3]) ? 9 : 0) + (p[3] &amp; 0xF));</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        p += 4;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                     } <span class="keywordflow">else</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                  }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                  h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = o;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                  <span class="keywordflow">if</span> (*p)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                     <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;UD too long / invalid UCS-2 hex in %s\n&quot;</span>, fn);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;               } <span class="keywordflow">else</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Only ud can use ## format, %s\n&quot;</span>, fn);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;ud&quot;</span>)) {       <span class="comment">/* user data */</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;               <span class="keywordtype">int</span> o = 0;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;               <span class="keywordflow">while</span> (*p &amp;&amp; o &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                  <span class="keywordflow">if</span> (isxdigit(*p) &amp;&amp; isxdigit(p[1])) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[o++] = (((isalpha(*p) ? 9 : 0) + (*p &amp; 0xF)) &lt;&lt; 4) + ((isalpha(p[1]) ? 9 : 0) + (p[1] &amp; 0xF));</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                     p += 2;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                  }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;               }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> = o;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;               <span class="keywordflow">if</span> (*p) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;UD too long / invalid UCS-1 hex in %s\n&quot;</span>, fn);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;               }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(line, <span class="stringliteral">&quot;udh&quot;</span>)) {      <span class="comment">/* user data header */</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;               <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> o = 0;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a> = 1;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;               <span class="keywordflow">while</span> (*p &amp;&amp; o &lt; <a class="code" href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a>) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                  <span class="keywordflow">if</span> (isxdigit(*p) &amp;&amp; isxdigit(p[1])) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                     h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>[o] = (((isalpha(*p) ? 9 : 0) + (*p &amp; 0xF)) &lt;&lt; 4) + ((isalpha(p[1]) ? 9 : 0) + (p[1] &amp; 0xF));</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                     o++;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                     p += 2;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                  }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;               }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a> = o;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;               <span class="keywordflow">if</span> (*p) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;UDH too long / invalid hex in %s\n&quot;</span>, fn);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;               }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Only ud and udh can use # format, %s\n&quot;</span>, fn);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot parse in %s: %s\n&quot;</span>, fn, line);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;         }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      fclose(s);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">if</span> (!dcsset &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid UTF-8 message even for UCS-2 (%s)\n&quot;</span>, fn);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;               h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = 0x08;          <span class="comment">/* default to 16 bit */</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Sending in 16 bit format(%s)\n&quot;</span>, fn);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> = 0xF5;              <span class="comment">/* default to 8 bit */</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Sending in 8 bit format(%s)\n&quot;</span>, fn);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 7 bit GSM data %s\n&quot;</span>, fn);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 8 bit data %s\n&quot;</span>, fn);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a8bdd552aa3abf01b520c87815e1c2b24">is16bit</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>) &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a>(0, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>) &lt; 0) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid 16 bit data %s\n&quot;</span>, fn);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a39743cbea53fca38237f049acd4cb834"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a></div><div class="ttdeci">#define is7bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00281">app_sms.c:281</a></div></div>
<div class="ttc" id="structsms__s_html_aed8d77b45e82e228b7c993a844228e53"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">sms_s::vp</a></div><div class="ttdeci">unsigned int vp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00237">app_sms.c:237</a></div></div>
<div class="ttc" id="app__sms_8c_html_a375cda00ad33985349625ad6f8ae70ef"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a375cda00ad33985349625ad6f8ae70ef">utf8decode</a></div><div class="ttdeci">static long utf8decode(unsigned char **pp)</div><div class="ttdoc">Reads next UCS character from NUL terminated UTF-8 string and advance pointer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00315">app_sms.c:315</a></div></div>
<div class="ttc" id="app__sms_8c_html_a92bf696f8279259f5741564c2c2b2af2"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a92bf696f8279259f5741564c2c2b2af2">SMSLEN</a></div><div class="ttdeci">#define SMSLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00215">app_sms.c:215</a></div></div>
<div class="ttc" id="structsms__s_html_a74432ad1d458c890a5f136080c831d57"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">sms_s::udhl</a></div><div class="ttdeci">int udhl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00233">app_sms.c:233</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="app__meetme_8c_html_abd5465a13e11fe1c52a5a0f7b0b0812e"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#abd5465a13e11fe1c52a5a0f7b0b0812e">S</a></div><div class="ttdeci">#define S(e)</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__tm_html_a994c4f4519ba57e186580d21cc86f9e5"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">ast_tm::tm_year</a></div><div class="ttdeci">int tm_year</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00041">localtime.h:41</a></div></div>
<div class="ttc" id="structsms__s_html_a50b93d20a60c5ca8290725dff70be020"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">sms_s::udhi</a></div><div class="ttdeci">unsigned char udhi</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00235">app_sms.c:235</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="app__sms_8c_html_a77ab80a9e6251174378df1f59b5dbc44"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a77ab80a9e6251174378df1f59b5dbc44">packsms16</a></div><div class="ttdeci">static int packsms16(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00485">app_sms.c:485</a></div></div>
<div class="ttc" id="structast__tm_html_ada983deda100b604bee5716512453658"><div class="ttname"><a href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">ast_tm::tm_mon</a></div><div class="ttdeci">int tm_mon</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00040">localtime.h:40</a></div></div>
<div class="ttc" id="structsms__s_html_a0f7adeccf32fc4c52946d5d20b34c1cd"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">sms_s::srr</a></div><div class="ttdeci">unsigned char srr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00234">app_sms.c:234</a></div></div>
<div class="ttc" id="structast__tm_html_a02048604d30b880033311cf542d63f92"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">ast_tm::tm_mday</a></div><div class="ttdeci">int tm_mday</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00039">localtime.h:39</a></div></div>
<div class="ttc" id="structsms__s_html_aa04ad9c90e68d8a6f92b612f798db482"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">sms_s::rp</a></div><div class="ttdeci">unsigned char rp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00236">app_sms.c:236</a></div></div>
<div class="ttc" id="app__sms_8c_html_a8bdd552aa3abf01b520c87815e1c2b24"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a8bdd552aa3abf01b520c87815e1c2b24">is16bit</a></div><div class="ttdeci">#define is16bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00283">app_sms.c:283</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="structsms__s_html_aaa5504977ac9f7302b9632878eb455e5"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aaa5504977ac9f7302b9632878eb455e5">sms_s::udtxt</a></div><div class="ttdeci">char udtxt[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00277">app_sms.c:277</a></div></div>
<div class="ttc" id="structast__tm_html_a4d171061df9e012fcfbd1172b8440d5f"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">ast_tm::tm_hour</a></div><div class="ttdeci">int tm_hour</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00038">localtime.h:38</a></div></div>
<div class="ttc" id="structast__tm_html_a18df301c1a10c8d493da86ce5c2aea78"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a18df301c1a10c8d493da86ce5c2aea78">ast_tm::tm_sec</a></div><div class="ttdeci">int tm_sec</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00036">localtime.h:36</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="app__sms_8c_html_a172d0c2bb9c8a56df817acb5ce7bfe3c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a172d0c2bb9c8a56df817acb5ce7bfe3c">packsms7</a></div><div class="ttdeci">static int packsms7(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00369">app_sms.c:369</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a1f0cc56d7098ac627c3a2ac4bd94b6d9"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">sms_s::dcs</a></div><div class="ttdeci">unsigned char dcs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00230">app_sms.c:230</a></div></div>
<div class="ttc" id="localtime_8h_html_ae0843e4dbbd1fed36d2676dda58e0c44"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a></div><div class="ttdeci">struct timeval ast_mktime(struct ast_tm *const tmp, const char *zone)</div><div class="ttdoc">Timezone-independent version of mktime(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02357">localtime.c:2357</a></div></div>
<div class="ttc" id="structast__tm_html_a7d102a87f898878ebf37ebd87504e099"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a7d102a87f898878ebf37ebd87504e099">ast_tm::tm_isdst</a></div><div class="ttdeci">int tm_isdst</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00044">localtime.h:44</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa3645875887568a20059ae86c7a66f74"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa3645875887568a20059ae86c7a66f74">packsms8</a></div><div class="ttdeci">static int packsms8(unsigned char *o, int udhl, unsigned char *udh, int udl, unsigned short *ud)</div><div class="ttdoc">takes a binary header (udhl bytes at udh) and UCS-2 message (udl characters at ud) and packs in to o ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00446">app_sms.c:446</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="app__sms_8c_html_a660b5407faba61b0835356de97c78a0c"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a660b5407faba61b0835356de97c78a0c">numcpy</a></div><div class="ttdeci">static void numcpy(char *d, char *s)</div><div class="ttdoc">copy number, skipping non digits apart from leading + </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00288">app_sms.c:288</a></div></div>
<div class="ttc" id="app__sms_8c_html_a5f533f0d22e8b3eac586398fbae67636"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a></div><div class="ttdeci">#define is8bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00282">app_sms.c:282</a></div></div>
<div class="ttc" id="structsms__s_html_a2c7d9a176d66d466f3e8c54fd519460e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">sms_s::pid</a></div><div class="ttdeci">unsigned char pid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00229">app_sms.c:229</a></div></div>
<div class="ttc" id="structast__tm_html_a987fa9280fe4cd6c6b8f77409f1c1504"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">ast_tm::tm_min</a></div><div class="ttdeci">int tm_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00037">localtime.h:37</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
<div class="ttc" id="structsms__s_html_a37cf044b446d0c9825730351ae1be8a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">sms_s::udh</a></div><div class="ttdeci">unsigned char udh[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00239">app_sms.c:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0fd8690c8108023eafe2da490478f56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0fd8690c8108023eafe2da490478f56">&#9670;&nbsp;</a></span>sms_release()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_release </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01689">1689</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;{</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   <span class="keywordflow">return</span>;  <span class="comment">/* nothing to do here. */</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="af45fa5279582c213474672cf0684d219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af45fa5279582c213474672cf0684d219">&#9670;&nbsp;</a></span>sms_writefile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sms_writefile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d81/app__sms_8c.html#a03faa096cd1695c08d2134dc6ae7d1fe">sms_t</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>white a received text message to a file </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">998</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00154">ast_config_AST_SPOOL_DIR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02231">ast_mkdir()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00108">ast_tvzero()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00227">sms_s::da</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00230">sms_s::dcs</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00303">isodate()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00231">sms_s::mr</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00226">sms_s::oa</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00229">sms_s::pid</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00225">sms_s::queue</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00236">sms_s::rp</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00223">sms_s::rx</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00228">sms_s::scts</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00120">seq</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00222">sms_s::smsc</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00234">sms_s::srr</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00239">sms_s::udh</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00235">sms_s::udhi</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00233">sms_s::udhl</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00232">sms_s::udl</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00237">sms_s::vp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">sms_handleincoming()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01262">sms_handleincoming_proto2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;{</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="keywordtype">char</span> fn[200] = <span class="stringliteral">&quot;&quot;</span>, fn2[200] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[30];</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   FILE *o;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#a4e7b3508884147c7991a68361ac781a2">ast_tvzero</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>)) {</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   snprintf(fn, <span class="keyword">sizeof</span>(fn), <span class="stringliteral">&quot;%s/sms/%s&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">smsc</a> ? h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> ? <span class="stringliteral">&quot;morx&quot;</span> : <span class="stringliteral">&quot;mttx&quot;</span> : h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">rx</a> ? <span class="stringliteral">&quot;mtrx&quot;</span> : <span class="stringliteral">&quot;motx&quot;</span>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a>(fn, 0777);                    <span class="comment">/* ensure it exists */</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(fn2, fn, <span class="keyword">sizeof</span>(fn2));</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   snprintf(fn2 + strlen(fn2), <span class="keyword">sizeof</span>(fn2) - strlen(fn2), <span class="stringliteral">&quot;/%s.%s-%u&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">queue</a>, <a class="code" href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>.tv_sec, buf, <span class="keyword">sizeof</span>(buf)), <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a>++);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   snprintf(fn + strlen(fn), <span class="keyword">sizeof</span>(fn) - strlen(fn), <span class="stringliteral">&quot;/.%s&quot;</span>, fn2 + strlen(fn) + 1);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <span class="keywordflow">if</span> ((o = fopen(fn, <span class="stringliteral">&quot;w&quot;</span>)) == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      fprintf(o, <span class="stringliteral">&quot;oa=%s\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">oa</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="keywordflow">if</span> (*h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>) {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      fprintf(o, <span class="stringliteral">&quot;da=%s\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">da</a>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">udhi</a>) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      fprintf(o, <span class="stringliteral">&quot;udh#&quot;</span>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">udhl</a>; p++) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;         fprintf(o, <span class="stringliteral">&quot;%02hhX&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">udh</a>[p]);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      fprintf(o, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p] &gt;= <span class="charliteral">&#39; &#39;</span>; p++);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordflow">if</span> (p &lt; h-&gt;udl) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;         fputc(<span class="charliteral">&#39;;&#39;</span>, o);                  <span class="comment">/* cannot use ud=, but include as a comment for human readable */</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      fprintf(o, <span class="stringliteral">&quot;ud=&quot;</span>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>; p++) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> v = h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p];</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         <span class="keywordflow">if</span> (v &lt; 32) {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            fputc(191, o);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v &lt; 0x80) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            fputc(v, o);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v &lt; 0x800) {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            fputc(0xC0 + (v &gt;&gt; 6), o);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            fputc(0x80 + (v &amp; 0x3F), o);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            fputc(0xE0 + (v &gt;&gt; 12), o);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            fputc(0x80 + ((v &gt;&gt; 6) &amp; 0x3F), o);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            fputc(0x80 + (v &amp; 0x3F), o);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      fprintf(o, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p] &gt;= <span class="charliteral">&#39; &#39;</span>; p++);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">if</span> (p &lt; h-&gt;udl) {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a> &amp;&amp; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p] &lt; 0x100; p++);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;         <span class="keywordflow">if</span> (p == h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>) {              <span class="comment">/* can write in ucs-1 hex */</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            fprintf(o, <span class="stringliteral">&quot;ud#&quot;</span>);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>; p++) {</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;               fprintf(o, <span class="stringliteral">&quot;%02hhX&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p]);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            fprintf(o, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         } <span class="keywordflow">else</span> {                        <span class="comment">/* write in UCS-2 */</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            fprintf(o, <span class="stringliteral">&quot;ud##&quot;</span>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordflow">for</span> (p = 0; p &lt; h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">udl</a>; p++) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;               fprintf(o, <span class="stringliteral">&quot;%04X&quot;</span>, (<span class="keywordtype">unsigned</span>)h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">ud</a>[p]);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            fprintf(o, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   }</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>.tv_sec) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordtype">char</span> datebuf[30];</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      fprintf(o, <span class="stringliteral">&quot;scts=%s\n&quot;</span>, <a class="code" href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a>(h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">scts</a>.tv_sec, datebuf, <span class="keyword">sizeof</span>(datebuf)));</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a>) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      fprintf(o, <span class="stringliteral">&quot;pid=%d\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">pid</a>);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a> != 0xF1) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      fprintf(o, <span class="stringliteral">&quot;dcs=%d\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">dcs</a>);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a>) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      fprintf(o, <span class="stringliteral">&quot;vp=%u\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">vp</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">srr</a>) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      fprintf(o, <span class="stringliteral">&quot;srr=1\n&quot;</span>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a> &gt;= 0) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      fprintf(o, <span class="stringliteral">&quot;mr=%d\n&quot;</span>, h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">mr</a>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <span class="keywordflow">if</span> (h-&gt;<a class="code" href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">rp</a>) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      fprintf(o, <span class="stringliteral">&quot;rp=1\n&quot;</span>);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   fclose(o);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   <span class="keywordflow">if</span> (rename(fn, fn2)) {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      unlink(fn);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Received to %s\n&quot;</span>, fn2);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div><div class="ttc" id="structsms__s_html_aed8d77b45e82e228b7c993a844228e53"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aed8d77b45e82e228b7c993a844228e53">sms_s::vp</a></div><div class="ttdeci">unsigned int vp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00237">app_sms.c:237</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structsms__s_html_a74432ad1d458c890a5f136080c831d57"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a74432ad1d458c890a5f136080c831d57">sms_s::udhl</a></div><div class="ttdeci">int udhl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00233">app_sms.c:233</a></div></div>
<div class="ttc" id="structsms__s_html_adae482bcbee5489cc0717323eb521082"><div class="ttname"><a href="../../d6/de0/structsms__s.html#adae482bcbee5489cc0717323eb521082">sms_s::rx</a></div><div class="ttdeci">unsigned char rx</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00223">app_sms.c:223</a></div></div>
<div class="ttc" id="time_8h_html_a4e7b3508884147c7991a68361ac781a2"><div class="ttname"><a href="../../de/df7/time_8h.html#a4e7b3508884147c7991a68361ac781a2">ast_tvzero</a></div><div class="ttdeci">int ast_tvzero(const struct timeval t)</div><div class="ttdoc">Returns true if the argument is 0,0. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00108">time.h:108</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structsms__s_html_a50b93d20a60c5ca8290725dff70be020"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a50b93d20a60c5ca8290725dff70be020">sms_s::udhi</a></div><div class="ttdeci">unsigned char udhi</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00235">app_sms.c:235</a></div></div>
<div class="ttc" id="structsms__s_html_a508fcb3b8587a645768074435743d2f2"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a508fcb3b8587a645768074435743d2f2">sms_s::scts</a></div><div class="ttdeci">struct timeval scts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00228">app_sms.c:228</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structsms__s_html_ae029547c37a01a171c894cefb942743f"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ae029547c37a01a171c894cefb942743f">sms_s::queue</a></div><div class="ttdeci">char queue[30]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00225">app_sms.c:225</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa82dbf6bb6292091b6f9ac19cc841428"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa82dbf6bb6292091b6f9ac19cc841428">isodate</a></div><div class="ttdeci">static char * isodate(time_t t, char *buf, int len)</div><div class="ttdoc">static, return a date/time in ISO format </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00303">app_sms.c:303</a></div></div>
<div class="ttc" id="structsms__s_html_a0f7adeccf32fc4c52946d5d20b34c1cd"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a0f7adeccf32fc4c52946d5d20b34c1cd">sms_s::srr</a></div><div class="ttdeci">unsigned char srr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00234">app_sms.c:234</a></div></div>
<div class="ttc" id="structsms__s_html_ac407ce793f99be51a1804050b3565deb"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ac407ce793f99be51a1804050b3565deb">sms_s::smsc</a></div><div class="ttdeci">unsigned char smsc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00222">app_sms.c:222</a></div></div>
<div class="ttc" id="structsms__s_html_aa04ad9c90e68d8a6f92b612f798db482"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aa04ad9c90e68d8a6f92b612f798db482">sms_s::rp</a></div><div class="ttdeci">unsigned char rp</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00236">app_sms.c:236</a></div></div>
<div class="ttc" id="structsms__s_html_aff5fb37156142d0ad278675d2900d335"><div class="ttname"><a href="../../d6/de0/structsms__s.html#aff5fb37156142d0ad278675d2900d335">sms_s::ud</a></div><div class="ttdeci">unsigned short ud[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00238">app_sms.c:238</a></div></div>
<div class="ttc" id="structsms__s_html_a423cb59610482ae25dcd3df51afdde25"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a423cb59610482ae25dcd3df51afdde25">sms_s::mr</a></div><div class="ttdeci">short mr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00231">app_sms.c:231</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="paths_8h_html_a95c5b4ffe620dc96d1ea9311b35c4d4f"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a95c5b4ffe620dc96d1ea9311b35c4d4f">ast_config_AST_SPOOL_DIR</a></div><div class="ttdeci">const char * ast_config_AST_SPOOL_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00154">options.c:154</a></div></div>
<div class="ttc" id="structsms__s_html_ab1209480aaab84c2ae9759e9c1d412aa"><div class="ttname"><a href="../../d6/de0/structsms__s.html#ab1209480aaab84c2ae9759e9c1d412aa">sms_s::udl</a></div><div class="ttdeci">int udl</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00232">app_sms.c:232</a></div></div>
<div class="ttc" id="app__sms_8c_html_a8514112da88a5d13451aaf8c9b064017"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a></div><div class="ttdeci">static volatile unsigned int seq</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00120">app_sms.c:120</a></div></div>
<div class="ttc" id="structsms__s_html_a2474e717dcd2fd71d03e63cf76965c86"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2474e717dcd2fd71d03e63cf76965c86">sms_s::da</a></div><div class="ttdeci">char da[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00227">app_sms.c:227</a></div></div>
<div class="ttc" id="structsms__s_html_a1f0cc56d7098ac627c3a2ac4bd94b6d9"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a1f0cc56d7098ac627c3a2ac4bd94b6d9">sms_s::dcs</a></div><div class="ttdeci">unsigned char dcs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00230">app_sms.c:230</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structsms__s_html_a32a2774c5e456ab25f26d45cc145e882"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a32a2774c5e456ab25f26d45cc145e882">sms_s::oa</a></div><div class="ttdeci">char oa[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00226">app_sms.c:226</a></div></div>
<div class="ttc" id="structsms__s_html_a2c7d9a176d66d466f3e8c54fd519460e"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a2c7d9a176d66d466f3e8c54fd519460e">sms_s::pid</a></div><div class="ttdeci">unsigned char pid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00229">app_sms.c:229</a></div></div>
<div class="ttc" id="utils_8h_html_a7c38859ed90e96df2b0a0fdf843769d0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a></div><div class="ttdeci">int ast_mkdir(const char *path, int mode)</div><div class="ttdoc">Recursively create directory path. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02231">main/utils.c:2231</a></div></div>
<div class="ttc" id="structsms__s_html_a37cf044b446d0c9825730351ae1be8a0"><div class="ttname"><a href="../../d6/de0/structsms__s.html#a37cf044b446d0c9825730351ae1be8a0">sms_s::udh</a></div><div class="ttdeci">unsigned char udh[SMSLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00239">app_sms.c:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02078">2078</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00124">app</a>, and <a class="el" href="../../dd/d16/pbx__app_8c_source.html#l00392">ast_unregister_application()</a>.</p>
<div class="fragment"><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;{</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(<a class="code" href="../../d7/d81/app__sms_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>);</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a9e5f57131367eff409b9e0bd7b31aa1a"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a></div><div class="ttdeci">static char * app</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00124">app_sms.c:124</a></div></div>
<div class="ttc" id="module_8h_html_ad2ca15621101154f29748cf1dac3c3cf"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a></div><div class="ttdeci">int ast_unregister_application(const char *app)</div><div class="ttdoc">Unregister an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00392">pbx_app.c:392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad38c7ea91c75338009d7ef07df937ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad38c7ea91c75338009d7ef07df937ee9">&#9670;&nbsp;</a></span>unpackaddress()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char unpackaddress </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpack an address from i, return byte length, unpack to o </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00728">728</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">sms_handleincoming()</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = i[0], p;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="keywordflow">if</span> (i[1] == 0x91) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      *o++ = <span class="charliteral">&#39;+&#39;</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keywordflow">for</span> (p = 0; p &lt; l; p++) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">if</span> (p &amp; 1) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;         *o++ = (i[2 + p / 2] &gt;&gt; 4) + <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         *o++ = (i[2 + p / 2] &amp; 0xF) + <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   *o = 0;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">return</span> (l + 5) / 2;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a7c221ca909fed50cb51bd59b0855bc68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c221ca909fed50cb51bd59b0855bc68">&#9670;&nbsp;</a></span>unpackdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct timeval unpackdate </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpack a date and return </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00579">579</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/df8/localtime_8c_source.html#l02357">ast_mktime()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00038">ast_tm::tm_hour</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00044">ast_tm::tm_isdst</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00039">ast_tm::tm_mday</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00037">ast_tm::tm_min</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00040">ast_tm::tm_mon</a>, <a class="el" href="../../d5/deb/localtime_8h_source.html#l00036">ast_tm::tm_sec</a>, and <a class="el" href="../../d5/deb/localtime_8h_source.html#l00041">ast_tm::tm_year</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">sms_handleincoming()</a>.</p>
<div class="fragment"><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;{</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> t;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   t.<a class="code" href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">tm_year</a> = 100 + (i[0] &amp; 0xF) * 10 + (i[0] &gt;&gt; 4);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   t.tm_mon = (i[1] &amp; 0xF) * 10 + (i[1] &gt;&gt; 4) - 1;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   t.tm_mday = (i[2] &amp; 0xF) * 10 + (i[2] &gt;&gt; 4);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   t.tm_hour = (i[3] &amp; 0xF) * 10 + (i[3] &gt;&gt; 4);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   t.tm_min = (i[4] &amp; 0xF) * 10 + (i[4] &gt;&gt; 4);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   t.tm_sec = (i[5] &amp; 0xF) * 10 + (i[5] &gt;&gt; 4);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   t.tm_isdst = 0;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">if</span> (i[6] &amp; 0x08) {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      t.tm_min += 15 * ((i[6] &amp; 0x7) * 10 + (i[6] &gt;&gt; 4));</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      t.tm_min -= 15 * ((i[6] &amp; 0x7) * 10 + (i[6] &gt;&gt; 4));</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a>(&amp;t, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__tm_html_a994c4f4519ba57e186580d21cc86f9e5"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">ast_tm::tm_year</a></div><div class="ttdeci">int tm_year</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00041">localtime.h:41</a></div></div>
<div class="ttc" id="localtime_8h_html_ae0843e4dbbd1fed36d2676dda58e0c44"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae0843e4dbbd1fed36d2676dda58e0c44">ast_mktime</a></div><div class="ttdeci">struct timeval ast_mktime(struct ast_tm *const tmp, const char *zone)</div><div class="ttdoc">Timezone-independent version of mktime(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02357">localtime.c:2357</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ec2365c36d7af29acf3bdaad02b082a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ec2365c36d7af29acf3bdaad02b082a">&#9670;&nbsp;</a></span>unpacksms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unpacksms </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>dcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>udhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>general unpack - starts with length byte (octet or septet) and returns number of bytes used, inc length </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">712</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00281">is7bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00282">is8bit</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00684">unpacksms16()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00602">unpacksms7()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00658">unpacksms8()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01112">sms_handleincoming()</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordtype">int</span> l = *i++;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a>(dcs)) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#aa65901d23702596493c076cac99112f0">unpacksms7</a>(i, l, udh, udhl, ud, udl, udhi);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      l = (l * 7 + 7) / 8;                <span class="comment">/* adjust length to return */</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a>(dcs)) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#a6b1ce90cce234e2c4dc75da9046c21b5">unpacksms8</a>(i, l, udh, udhl, ud, udl, udhi);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      l += l % 2;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <a class="code" href="../../d7/d81/app__sms_8c.html#ab53eb989ad561eab70f9002277d99703">unpacksms16</a>(i, l, udh, udhl, ud, udl, udhi);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   <span class="keywordflow">return</span> l + 1;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a39743cbea53fca38237f049acd4cb834"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a39743cbea53fca38237f049acd4cb834">is7bit</a></div><div class="ttdeci">#define is7bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00281">app_sms.c:281</a></div></div>
<div class="ttc" id="app__sms_8c_html_a6b1ce90cce234e2c4dc75da9046c21b5"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a6b1ce90cce234e2c4dc75da9046c21b5">unpacksms8</a></div><div class="ttdeci">static void unpacksms8(unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</div><div class="ttdoc">unpacks bytes (8 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00658">app_sms.c:658</a></div></div>
<div class="ttc" id="app__sms_8c_html_ab53eb989ad561eab70f9002277d99703"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ab53eb989ad561eab70f9002277d99703">unpacksms16</a></div><div class="ttdeci">static void unpacksms16(unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</div><div class="ttdoc">unpacks bytes (16 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00684">app_sms.c:684</a></div></div>
<div class="ttc" id="app__sms_8c_html_aa65901d23702596493c076cac99112f0"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#aa65901d23702596493c076cac99112f0">unpacksms7</a></div><div class="ttdeci">static void unpacksms7(unsigned char *i, unsigned char l, unsigned char *udh, int *udhl, unsigned short *ud, int *udl, char udhi)</div><div class="ttdoc">unpacks bytes (7 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00602">app_sms.c:602</a></div></div>
<div class="ttc" id="app__sms_8c_html_a5f533f0d22e8b3eac586398fbae67636"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a5f533f0d22e8b3eac586398fbae67636">is8bit</a></div><div class="ttdeci">#define is8bit(dcs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00282">app_sms.c:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab53eb989ad561eab70f9002277d99703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab53eb989ad561eab70f9002277d99703">&#9670;&nbsp;</a></span>unpacksms16()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unpacksms16 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>udhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpacks bytes (16 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00684">684</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *o = ud;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   *udhl = 0;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordflow">if</span> (udhi) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordtype">int</span> n = *i;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      *udhl = n;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;         i++;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         l--;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;         <span class="keywordflow">while</span> (l &amp;&amp; n) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            l--;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            n--;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            *udh++ = *i++;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;         }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">while</span> (l--) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordtype">int</span> v = *i++;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordflow">if</span> (l &amp;&amp; l--) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;         v = (v &lt;&lt; 8) + *i++;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      *o++ = v;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   *udl = (o - ud);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="aa65901d23702596493c076cac99112f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa65901d23702596493c076cac99112f0">&#9670;&nbsp;</a></span>unpacksms7()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unpacksms7 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>udhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpacks bytes (7 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00602">602</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">b</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00191">defaultalphabet</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00204">escapes</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a> = 0, p = 0;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *o = ud;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   *udhl = 0;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">if</span> (udhi &amp;&amp; l) {                        <span class="comment">/* header */</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordtype">int</span> h = i[p];</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      *udhl = h;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">if</span> (h) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;         b = 1;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         p++;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         l--;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         <span class="keywordflow">while</span> (h-- &amp;&amp; l) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            *udh++ = i[p++];</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            b += 8;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">while</span> (b &gt;= 7) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;               b -= 7;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;               l--;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;               <span class="keywordflow">if</span> (!l) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;               }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;         }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;         <span class="comment">/* adjust for fill, septets */</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;         <span class="keywordflow">if</span> (b) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            b = 7 - <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            l--;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;         }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="keywordflow">while</span> (l--) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> v;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">if</span> (b &lt; 2) {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         v = ((i[p] &gt;&gt; <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>) &amp; 0x7F);       <span class="comment">/* everything in one byte */</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         v = ((((i[p] &gt;&gt; <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>) + (i[p + 1] &lt;&lt; (8 - b)))) &amp; 0x7F);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      b += 7;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">if</span> (b &gt;= 8) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         b -= 8;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         p++;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="comment">/* 0x00A0 is the encoding of ESC (27) in defaultalphabet */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">if</span> (o &gt; ud &amp;&amp; o[-1] == 0x00A0 &amp;&amp; <a class="code" href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a>[v]) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         o[-1] = <a class="code" href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a>[v];</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         *o++ = <a class="code" href="../../d7/d81/app__sms_8c.html#a34ddced579016642f988389bc44752c0">defaultalphabet</a>[v];</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   *udl = (o - ud);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="ttc" id="app__sms_8c_html_a34ddced579016642f988389bc44752c0"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a34ddced579016642f988389bc44752c0">defaultalphabet</a></div><div class="ttdeci">static const unsigned short defaultalphabet[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00191">app_sms.c:191</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="app__sms_8c_html_a70ca3c30c6f517d2f8ebd04edae4d892"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a70ca3c30c6f517d2f8ebd04edae4d892">escapes</a></div><div class="ttdeci">static const unsigned short escapes[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00204">app_sms.c:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b1ce90cce234e2c4dc75da9046c21b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1ce90cce234e2c4dc75da9046c21b5">&#9670;&nbsp;</a></span>unpacksms8()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unpacksms8 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>udh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>udl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>udhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpacks bytes (8 bit encoding) at i, len l septets, and places in udh and ud setting udhl and udl. udh not used if udhi not set. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00658">658</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00238">sms_s::ud</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00712">unpacksms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *o = ud;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   *udhl = 0;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordflow">if</span> (udhi) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordtype">int</span> n = *i;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      *udhl = n;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;         i++;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         l--;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;         <span class="keywordflow">while</span> (l &amp;&amp; n) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            l--;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            n--;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            *udh++ = *i++;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">while</span> (l--) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      *o++ = *i++;                        <span class="comment">/* not to UTF-8 as explicitly 8 bit coding in DCS */</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   *udl = (o - ud);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a375cda00ad33985349625ad6f8ae70ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a375cda00ad33985349625ad6f8ae70ef">&#9670;&nbsp;</a></span>utf8decode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long utf8decode </td>
          <td>(</td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>pp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads next UCS character from NUL terminated UTF-8 string and advance pointer. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00315">315</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00827">sms_readfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = *pp;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">if</span> (!*p) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">return</span> 0;                           <span class="comment">/* null termination of string */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   (*pp)++;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xC0) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">return</span> *p;                          <span class="comment">/* ascii or continuation character */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xE0) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (*p &lt; 0xC2 || (p[1] &amp; 0xC0) != 0x80) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <span class="keywordflow">return</span> *p;                      <span class="comment">/* not valid UTF-8 */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      (*pp)++;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">return</span> ((*p &amp; 0x1F) &lt;&lt; 6) + (p[1] &amp; 0x3F);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xF0) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">if</span> ((*p == 0xE0 &amp;&amp; p[1] &lt; 0xA0) || (p[1] &amp; 0xC0) != 0x80 || (p[2] &amp; 0xC0) != 0x80) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         <span class="keywordflow">return</span> *p;                      <span class="comment">/* not valid UTF-8 */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      (*pp) += 2;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">return</span> ((*p &amp; 0x0F) &lt;&lt; 12) + ((p[1] &amp; 0x3F) &lt;&lt; 6) + (p[2] &amp; 0x3F);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xF8) {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">if</span> ((*p == 0xF0 &amp;&amp; p[1] &lt; 0x90) || (p[1] &amp; 0xC0) != 0x80 || (p[2] &amp; 0xC0) != 0x80 || (p[3] &amp; 0xC0) != 0x80) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         <span class="keywordflow">return</span> *p;                      <span class="comment">/* not valid UTF-8 */</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      (*pp) += 3;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">return</span> ((*p &amp; 0x07) &lt;&lt; 18) + ((p[1] &amp; 0x3F) &lt;&lt; 12) + ((p[2] &amp; 0x3F) &lt;&lt; 6) + (p[3] &amp; 0x3F);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xFC) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> ((*p == 0xF8 &amp;&amp; p[1] &lt; 0x88) || (p[1] &amp; 0xC0) != 0x80 || (p[2] &amp; 0xC0) != 0x80 || (p[3] &amp; 0xC0) != 0x80</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         || (p[4] &amp; 0xC0) != 0x80) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         <span class="keywordflow">return</span> *p;                      <span class="comment">/* not valid UTF-8 */</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      (*pp) += 4;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">return</span> ((*p &amp; 0x03) &lt;&lt; 24) + ((p[1] &amp; 0x3F) &lt;&lt; 18) + ((p[2] &amp; 0x3F) &lt;&lt; 12) + ((p[3] &amp; 0x3F) &lt;&lt; 6) + (p[4] &amp; 0x3F);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">if</span> (*p &lt; 0xFE) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">if</span> ((*p == 0xFC &amp;&amp; p[1] &lt; 0x84) || (p[1] &amp; 0xC0) != 0x80 || (p[2] &amp; 0xC0) != 0x80 || (p[3] &amp; 0xC0) != 0x80</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;         || (p[4] &amp; 0xC0) != 0x80 || (p[5] &amp; 0xC0) != 0x80) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         <span class="keywordflow">return</span> *p;                      <span class="comment">/* not valid UTF-8 */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      (*pp) += 5;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">return</span> ((*p &amp; 0x01) &lt;&lt; 30) + ((p[1] &amp; 0x3F) &lt;&lt; 24) + ((p[2] &amp; 0x3F) &lt;&lt; 18) + ((p[3] &amp; 0x3F) &lt;&lt; 12) + ((p[4] &amp; 0x3F) &lt;&lt; 6) + (p[5] &amp; 0x3F);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="keywordflow">return</span> *p;                              <span class="comment">/* not sensible */</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9e5f57131367eff409b9e0bd7b31aa1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e5f57131367eff409b9e0bd7b31aa1a">&#9670;&nbsp;</a></span>app</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* app = &quot;SMS&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00124">124</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">load_module()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02078">unload_module()</a>.</p>

</div>
</div>
<a id="a34ddced579016642f988389bc44752c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34ddced579016642f988389bc44752c0">&#9670;&nbsp;</a></span>defaultalphabet</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned short defaultalphabet[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00191">191</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00602">unpacksms7()</a>.</p>

</div>
</div>
<a id="a70ca3c30c6f517d2f8ebd04edae4d892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ca3c30c6f517d2f8ebd04edae4d892">&#9670;&nbsp;</a></span>escapes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned short escapes[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00204">204</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00369">packsms7()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00602">unpacksms7()</a>.</p>

</div>
</div>
<a id="ad0345d4821606480fcb0e28327340660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0345d4821606480fcb0e28327340660">&#9670;&nbsp;</a></span>log_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char log_file[255]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00122">122</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">load_module()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00774">sms_log()</a>.</p>

</div>
</div>
<a id="a0e5e2d705fb17b7f583cd711a5d47467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e5e2d705fb17b7f583cd711a5d47467">&#9670;&nbsp;</a></span>message_ref</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile unsigned char message_ref</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00119">119</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01400">sms_compose1()</a>.</p>

</div>
</div>
<a id="a8514112da88a5d13451aaf8c9b064017"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8514112da88a5d13451aaf8c9b064017">&#9670;&nbsp;</a></span>seq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile unsigned int seq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00120">120</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dce/udptl_8c_source.html#l01161">ast_udptl_write()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l04633">parsing()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l05644">process_dtmf_cisco()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l03403">rtp_learning_rtp_seq_update()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l03386">rtp_learning_seq_init()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l00959">send_client()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l01538">send_retransmit()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00998">sms_writefile()</a>, and <a class="el" href="../../d2/dce/udptl_8c_source.html#l00621">udptl_build_packet()</a>.</p>

</div>
</div>
<a id="ad4f9cbcaee3a56eb068a387e9e6600e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f9cbcaee3a56eb068a387e9e6600e2">&#9670;&nbsp;</a></span>sms_options</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d2/d8d/structast__app__option.html">ast_app_option</a> sms_options[128] = { [ 's' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6d9f8a190a30fdff2d003fe406ab23f9">OPTION_BE_SMSC</a> }, [ '<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a078a4fe6b4252bcd185df43f051ecd53">OPTION_ANSWER</a> }, [ 't' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a6a8237166dcc5e4ec9cf6671b91d8dd4">OPTION_TWO</a> }, [ 'r' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a0b148357a99551d297160a7b98600695">OPTION_SRR</a> }, [ 'o' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a8a74ad47b1edfb9e69bfa73516388781">OPTION_DCS</a> }, [ 'n' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a48905cc0c9b02bd1d7b47d3684ed2b70">OPTIONS_NO_LOG</a> }, [ 'p' ] = { .<a class="el" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = <a class="el" href="../../d7/d81/app__sms_8c.html#aababa9181261edb84572cc841b406377a72c537a2238414194f4b6f309e3a668e">OPTION_PAUSE</a> , .arg_index = <a class="el" href="../../d7/d81/app__sms_8c.html#a30018397b8c531631257fc773ce07f27a00c83650e6758ad93ede9f7db2dbf567">OPTION_ARG_PAUSE</a> + 1 }, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01879">1879</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>.</p>

</div>
</div>
<a id="a1905c14fd0a53bc591a77d9bb4d029ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1905c14fd0a53bc591a77d9bb4d029ca">&#9670;&nbsp;</a></span>smsgen</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d2a/structast__generator.html">ast_generator</a> smsgen</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .alloc = <a class="code" href="../../d7/d81/app__sms_8c.html#a44ab7b172d33e28647b2383346814b9f">sms_alloc</a>,</div><div class="line">   .release = <a class="code" href="../../d7/d81/app__sms_8c.html#ab0fd8690c8108023eafe2da490478f56">sms_release</a>,</div><div class="line">   .generate = <a class="code" href="../../d7/d81/app__sms_8c.html#afda4211248e1b0e0083be7bd80a7d4b0">sms_generate</a>,</div><div class="line">}</div><div class="ttc" id="app__sms_8c_html_afda4211248e1b0e0083be7bd80a7d4b0"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#afda4211248e1b0e0083be7bd80a7d4b0">sms_generate</a></div><div class="ttdeci">static int sms_generate(struct ast_channel *chan, void *data, int len, int samples)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01604">app_sms.c:1604</a></div></div>
<div class="ttc" id="app__sms_8c_html_ab0fd8690c8108023eafe2da490478f56"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#ab0fd8690c8108023eafe2da490478f56">sms_release</a></div><div class="ttdeci">static void sms_release(struct ast_channel *chan, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01689">app_sms.c:1689</a></div></div>
<div class="ttc" id="app__sms_8c_html_a44ab7b172d33e28647b2383346814b9f"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a44ab7b172d33e28647b2383346814b9f">sms_alloc</a></div><div class="ttdeci">static void * sms_alloc(struct ast_channel *chan, void *sms_t_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l01684">app_sms.c:1684</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01694">1694</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

</div>
</div>
<a id="abe867fed599c026df3020fca010dafdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe867fed599c026df3020fca010dafdd">&#9670;&nbsp;</a></span>wave</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const signed short wave[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00132">132</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l02083">load_module()</a>, and <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01712">sms_process()</a>.</p>

</div>
</div>
<a id="a1c6c81d0dd59e7e04ac232639a5db460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6c81d0dd59e7e04ac232639a5db460">&#9670;&nbsp;</a></span>wave_out</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d7/d81/app__sms_8c.html#a4008af70ba477f60e932df6815dac38d">output_t</a>* wave_out = <a class="el" href="../../d7/d81/app__sms_8c.html#abe867fed599c026df3020fca010dafdd">wave</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d81/app__sms_8c_source.html#l00148">148</a> of file <a class="el" href="../../d7/d81/app__sms_8c_source.html">app_sms.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01604">sms_generate()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:44:40 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
