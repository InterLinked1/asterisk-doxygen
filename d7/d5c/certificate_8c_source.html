<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: certificate.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li><li class="navelem"><a class="el" href="../../dir_6fb64193830d7315e1f37c3715592869.html">res_stir_shaken</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">certificate.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d7/d5c/certificate_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 2020, Sangoma Technologies Corporation</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Kevin Harwell &lt;kharwell@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d25/sorcery_8h.html">asterisk/sorcery.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df9/stir__shaken_8h.html">stir_shaken.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dc9/certificate_8h.html">certificate.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/db7/res__stir__shaken_8h.html">asterisk/res_stir_shaken.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">   30</a></span>&#160;<span class="preprocessor">#define CONFIG_TYPE &quot;certificate&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="../../db/df6/structstir__shaken__certificate.html">   32</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a0e85270ccb77c71eb8f9693642c46daf">SORCERY_OBJECT</a>(details);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">      /*! Path to a directory containing certificates */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>);<span class="comment"></span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">      /*! URL to the public certificate */</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">public_cert_url</a>);<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">      /*! The caller ID number associated with the certificate */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>);<span class="comment"></span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">      /*! The attestation level for this certificate */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">attestation</a>);</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">   43</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">   /*! The private key for the certificate */</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">   45</a></span>&#160;   EVP_PKEY *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;};</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a824e6be6bfec18044cb85c898faa1d99">   48</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *<a class="code" href="../../d7/d5c/certificate_8c.html#a824e6be6bfec18044cb85c898faa1d99">stir_shaken_certificate_get</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>(), <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a059a4becf2b78415165ccb3859a41d75">   53</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d7/d5c/certificate_8c.html#a059a4becf2b78415165ccb3859a41d75">stir_shaken_certificate_get_all</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>(), <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a4fb7cd285fd9f7ec17911a9756c13dbe">   59</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a4fb7cd285fd9f7ec17911a9756c13dbe">stir_shaken_certificate_destructor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   EVP_PKEY_free(cfg-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(cfg);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a6978056e8b04565253b48b8c0bf950d1">   67</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d5c/certificate_8c.html#a6978056e8b04565253b48b8c0bf950d1">stir_shaken_certificate_alloc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   cfg = <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(*cfg), <a class="code" href="../../d7/d5c/certificate_8c.html#a4fb7cd285fd9f7ec17911a9756c13dbe">stir_shaken_certificate_destructor</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="keywordflow">if</span> (!cfg) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(cfg, 512)) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, -1);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">return</span> cfg;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#aa9bafe5c8b2d20b9c5e6c6efa80ed708">   84</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *<a class="code" href="../../d7/d5c/certificate_8c.html#aa9bafe5c8b2d20b9c5e6c6efa80ed708">stir_shaken_certificate_get_by_caller_id_number</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> fields = {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      .<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;caller_id_number&quot;</span>,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      .value = <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      .next = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   };</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>(),</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="stringliteral">&quot;certificate&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a3d078c1c29a9125b57ce97990ffa0fc0">AST_RETRIEVE_FLAG_DEFAULT</a>, &amp;fields);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#ae437a20aa1556158c535fb0b7f449075">   96</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d5c/certificate_8c.html#ae437a20aa1556158c535fb0b7f449075">stir_shaken_certificate_get_public_cert_url</a>(<span class="keyword">struct</span> <a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordflow">return</span> cert ? cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">public_cert_url</a> : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#ae042e2240ade59250ee5546826319fb0">  101</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d5c/certificate_8c.html#ae042e2240ade59250ee5546826319fb0">stir_shaken_certificate_get_attestation</a>(<span class="keyword">struct</span> <a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">return</span> cert ? cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">attestation</a> : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#a28cc4806921d29dfa628d5693f7fff03">  106</a></span>&#160;EVP_PKEY *<a class="code" href="../../d7/d5c/certificate_8c.html#a28cc4806921d29dfa628d5693f7fff03">stir_shaken_certificate_get_private_key</a>(<span class="keyword">struct</span> <a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">return</span> cert ? cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a> : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#adce14ddf5821878204f8ddad611aa080">  111</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#adce14ddf5821878204f8ddad611aa080">stir_shaken_certificate_apply</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   EVP_PKEY *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert = obj;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>)) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Caller ID must be present\n&quot;</span>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">attestation</a>)) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Attestation must be present\n&quot;</span>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   private_key = <a class="code" href="../../d5/d58/stir__shaken_8c.html#a1793b4d90aa04d4646b65595428e544e">stir_shaken_read_key</a>(cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>, 1);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keywordflow">if</span> (!private_key) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a> = <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a378dd4555c2860a0ca8ad6f08f644a45">  136</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d5c/certificate_8c.html#a378dd4555c2860a0ca8ad6f08f644a45">stir_shaken_certificate_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordflow">switch</span>(cmd) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;stir_shaken show certificate&quot;</span>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="stringliteral">&quot;Usage: stir_shaken show certificate &lt;id&gt;\n&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         <span class="stringliteral">&quot;       Show the certificate stir/shaken settings for a given id\n&quot;</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 3) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/d58/stir__shaken_8c.html#a72cedac6e0ac6bd3d4bf5077dad6bcca">stir_shaken_tab_complete_name</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#a059a4becf2b78415165ccb3859a41d75">stir_shaken_certificate_get_all</a>());</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   cfg = <a class="code" href="../../d7/d5c/certificate_8c.html#a824e6be6bfec18044cb85c898faa1d99">stir_shaken_certificate_get</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="../../d5/d58/stir__shaken_8c.html#a44fb0d5d9e38e5ee75f149c5e5cf8913">stir_shaken_cli_show</a>(cfg, a, 0);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cfg);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a09aded83d120e6dc16bb26408d796b55">  166</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d5c/certificate_8c.html#a09aded83d120e6dc16bb26408d796b55">stir_shaken_certificate_show_all</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordflow">switch</span>(cmd) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;stir_shaken show certificates&quot;</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="stringliteral">&quot;Usage: stir_shaken show certificates\n&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <span class="stringliteral">&quot;       Show all configured certificates for stir/shaken\n&quot;</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   container = <a class="code" href="../../d7/d5c/certificate_8c.html#a059a4becf2b78415165ccb3859a41d75">stir_shaken_certificate_get_all</a>();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">if</span> (!container || <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(container) == 0) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;No stir/shaken certificates found\n&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(container);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(container, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d5/d58/stir__shaken_8c.html#a44fb0d5d9e38e5ee75f149c5e5cf8913">stir_shaken_cli_show</a>, a);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(container, -1);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a6a7cdcec4be9f13ac18790fbf9a7c8dd">  198</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../d7/d5c/certificate_8c.html#a6a7cdcec4be9f13ac18790fbf9a7c8dd">stir_shaken_certificate_cli</a>[] = {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d7/d5c/certificate_8c.html#a378dd4555c2860a0ca8ad6f08f644a45">stir_shaken_certificate_show</a>, <span class="stringliteral">&quot;Show stir/shaken certificate configuration by id&quot;</span>),</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d7/d5c/certificate_8c.html#a09aded83d120e6dc16bb26408d796b55">stir_shaken_certificate_show_all</a>, <span class="stringliteral">&quot;Show all stir/shaken certificate configurations&quot;</span>),</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;};</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a0c889716e5ee01d21cb3ddfa11d9133e">  203</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a0c889716e5ee01d21cb3ddfa11d9133e">on_load_path</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/de0/structaco__option.html">aco_option</a> *opt, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <span class="keyword">struct </span>stat statbuf;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="keywordflow">if</span> (stat(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;statbuf)) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stir/shaken - path &#39;%s&#39; not found\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="keywordflow">if</span> (!S_ISREG(statbuf.st_mode)) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stir/shaken - path &#39;%s&#39; is not a file\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cfg, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a5578fced8ddb305c0236b2a5f3861ce0">  221</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a5578fced8ddb305c0236b2a5f3861ce0">path_to_str</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> intptr_t *<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, <span class="keywordtype">char</span> **<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   *buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(cfg-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a370aed06e8bc8664f29197483749925f">  230</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a370aed06e8bc8664f29197483749925f">on_load_public_cert_url</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/de0/structaco__option.html">aco_option</a> *opt, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;http&quot;</span>)) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stir/shaken - public_cert_url scheme must be &#39;http[s]&#39;\n&quot;</span>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cfg, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">public_cert_url</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#abe6d14eaaa3c1747d71e3724f2df77af">  242</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#abe6d14eaaa3c1747d71e3724f2df77af">public_cert_url_to_str</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> intptr_t *<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, <span class="keywordtype">char</span> **<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   *buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(cfg-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">public_cert_url</a>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a96095168745937de27f1656b4d1da226">  251</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a96095168745937de27f1656b4d1da226">on_load_attestation</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/de0/structaco__option.html">aco_option</a> *opt, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">if</span> (strcmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;A&quot;</span>) &amp;&amp; strcmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;B&quot;</span>) &amp;&amp; strcmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;C&quot;</span>)) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stir/shaken - attestation level must be A, B, or C (object=%s)\n&quot;</span>,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(cfg));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cfg, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">attestation</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a6ace7912b293c397519151a2aa7b9912">  264</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a6ace7912b293c397519151a2aa7b9912">attestation_to_str</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> intptr_t *<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, <span class="keywordtype">char</span> **<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cfg = obj;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   *buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(cfg-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">attestation</a>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">/* Name for test certificaate */</span></div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a59e0a1f28d2b48e5b2be7deaa63d75ed">  276</a></span>&#160;<span class="preprocessor">#define TEST_CONFIG_NAME &quot;test_stir_shaken_certificate&quot;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/* The public key URL to use for the test certificate */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#ab6a8e7a9ef393f08923ef144b2aebecb">  278</a></span>&#160;<span class="preprocessor">#define TEST_CONFIG_URL &quot;http://testing123&quot;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a6fab1594baa8578558d39ff300caa1b7">  280</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a6fab1594baa8578558d39ff300caa1b7">test_stir_shaken_cleanup_cert</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   sorcery = <a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   cert = <a class="code" href="../../d7/d5c/certificate_8c.html#aa9bafe5c8b2d20b9c5e6c6efa80ed708">stir_shaken_certificate_get_by_caller_id_number</a>(caller_id_number);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordflow">if</span> (!cert) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   res = <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(sorcery, cert);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cert);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to delete sorcery object with caller ID &quot;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         <span class="stringliteral">&quot;&#39;%s&#39;\n&quot;</span>, caller_id_number);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   res = <a class="code" href="../../d8/d25/sorcery_8h.html#a950f39ae83b03909656bb463447d32ae">ast_sorcery_remove_wizard_mapping</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;memory&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="../../d7/d5c/certificate_8c.html#a53e2bd141ee7921dc54a795c3d93061b">  306</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a53e2bd141ee7921dc54a795c3d93061b">test_stir_shaken_create_cert</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *file_path)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a> *cert;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   EVP_PKEY *<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   sorcery = <a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   res = <a class="code" href="../../d8/d25/sorcery_8h.html#a25cb7de57f83a51ee7a7d993db65e05f">ast_sorcery_insert_wizard_mapping</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;memory&quot;</span>, <span class="stringliteral">&quot;testing&quot;</span>, 0, 0);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to insert STIR/SHAKEN test certificate mapping\n&quot;</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   cert = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#a59e0a1f28d2b48e5b2be7deaa63d75ed">TEST_CONFIG_NAME</a>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <span class="keywordflow">if</span> (!cert) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to allocate test certificate\n&quot;</span>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cert, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>, file_path);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cert, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">public_cert_url</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#ab6a8e7a9ef393f08923ef144b2aebecb">TEST_CONFIG_URL</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cert, caller_id_number, caller_id_number);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   private_key = <a class="code" href="../../d5/d58/stir__shaken_8c.html#a1793b4d90aa04d4646b65595428e544e">stir_shaken_read_key</a>(cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>, 1);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (!private_key) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to read test key from %s\n&quot;</span>, cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">path</a>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <a class="code" href="../../d7/d5c/certificate_8c.html#a6fab1594baa8578558d39ff300caa1b7">test_stir_shaken_cleanup_cert</a>(caller_id_number);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   cert-&gt;<a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a> = <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">private_key</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(sorcery, cert);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* TEST_FRAMEWORK */</span><span class="preprocessor"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#a2130c8ad2b3cd26e4c85ed9f12de6a81">  347</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#a2130c8ad2b3cd26e4c85ed9f12de6a81">stir_shaken_certificate_unload</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(stir_shaken_certificate_cli,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(stir_shaken_certificate_cli));</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="../../d0/dc9/certificate_8h.html#aee0ed972bcbd3eb2e5fea92c73a2d9d2">  355</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/d5c/certificate_8c.html#aee0ed972bcbd3eb2e5fea92c73a2d9d2">stir_shaken_certificate_load</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d88/structast__sorcery.html">ast_sorcery</a> *<a class="code" href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a> = <a class="code" href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a>();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;config&quot;</span>, <span class="stringliteral">&quot;stir_shaken.conf,criteria=type=certificate&quot;</span>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#a6978056e8b04565253b48b8c0bf950d1">stir_shaken_certificate_alloc</a>,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;         <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#adce14ddf5821878204f8ddad611aa080">stir_shaken_certificate_apply</a>)) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stir/shaken - failed to register &#39;%s&#39; sorcery object\n&quot;</span>, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a>, 0, 0);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;path&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="../../d7/d5c/certificate_8c.html#a0c889716e5ee01d21cb3ddfa11d9133e">on_load_path</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#a5578fced8ddb305c0236b2a5f3861ce0">path_to_str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;public_cert_url&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="../../d7/d5c/certificate_8c.html#a370aed06e8bc8664f29197483749925f">on_load_public_cert_url</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#abe6d14eaaa3c1747d71e3724f2df77af">public_cert_url_to_str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;attestation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="../../d7/d5c/certificate_8c.html#a96095168745937de27f1656b4d1da226">on_load_attestation</a>, <a class="code" href="../../d7/d5c/certificate_8c.html#a6ace7912b293c397519151a2aa7b9912">attestation_to_str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(sorcery, <a class="code" href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a>, <span class="stringliteral">&quot;caller_id_number&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a>, <a class="code" href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">caller_id_number</a>));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(stir_shaken_certificate_cli,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(stir_shaken_certificate_cli));</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div><div class="ttc" id="certificate_8c_html_a0c889716e5ee01d21cb3ddfa11d9133e"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a0c889716e5ee01d21cb3ddfa11d9133e">on_load_path</a></div><div class="ttdeci">static int on_load_path(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00203">certificate.c:203</a></div></div>
<div class="ttc" id="certificate_8c_html_a09aded83d120e6dc16bb26408d796b55"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a09aded83d120e6dc16bb26408d796b55">stir_shaken_certificate_show_all</a></div><div class="ttdeci">static char * stir_shaken_certificate_show_all(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00166">certificate.c:166</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="sorcery_8h_html_a950f39ae83b03909656bb463447d32ae"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a950f39ae83b03909656bb463447d32ae">ast_sorcery_remove_wizard_mapping</a></div><div class="ttdeci">#define ast_sorcery_remove_wizard_mapping(sorcery, type, name)</div><div class="ttdoc">Remove an object wizard mapping. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00758">sorcery.h:758</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="structstir__shaken__certificate_html_a07d95241106215864f6a574e3a208b52"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#a07d95241106215864f6a574e3a208b52">stir_shaken_certificate::private_key</a></div><div class="ttdeci">EVP_PKEY * private_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00045">certificate.c:45</a></div></div>
<div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="certificate_8c_html_af473f30a75e796ae9658719f1be86249"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#af473f30a75e796ae9658719f1be86249">CONFIG_TYPE</a></div><div class="ttdeci">#define CONFIG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00030">certificate.c:30</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="certificate_8h_html"><div class="ttname"><a href="../../d0/dc9/certificate_8h.html">certificate.h</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="certificate_8c_html_a370aed06e8bc8664f29197483749925f"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a370aed06e8bc8664f29197483749925f">on_load_public_cert_url</a></div><div class="ttdeci">static int on_load_public_cert_url(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00230">certificate.c:230</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html_a0e85270ccb77c71eb8f9693642c46daf"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#a0e85270ccb77c71eb8f9693642c46daf">stir_shaken_certificate::SORCERY_OBJECT</a></div><div class="ttdeci">SORCERY_OBJECT(details)</div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="stir__shaken_8c_html_a1793b4d90aa04d4646b65595428e544e"><div class="ttname"><a href="../../d5/d58/stir__shaken_8c.html#a1793b4d90aa04d4646b65595428e544e">stir_shaken_read_key</a></div><div class="ttdeci">EVP_PKEY * stir_shaken_read_key(const char *path, int priv)</div><div class="ttdoc">Reads the public (or private) key from the specified path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d58/stir__shaken_8c_source.html#l00089">stir_shaken.c:89</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a></div><div class="ttdoc">Perform no matching, return all objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00123">sorcery.h:123</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="structast__sorcery_html"><div class="ttname"><a href="../../d2/d88/structast__sorcery.html">ast_sorcery</a></div><div class="ttdoc">Full structure for sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00230">sorcery.c:230</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a></div><div class="ttdoc">Type for a default handler that should do nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00399">config_options.h:399</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="stringfields_8h_html_a061580e89c55282a7140fa3fdfd52b6d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a></div><div class="ttdeci">#define AST_DECLARE_STRING_FIELDS(field_list)</div><div class="ttdoc">Declare the fields needed in a structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00337">stringfields.h:337</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a></div><div class="ttdoc">Return all matching objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00120">sorcery.h:120</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="test__func__file_8c_html_a7df83d295429a2562396f1ec127a46c0"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a></div><div class="ttdeci">const char * args</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00046">test_func_file.c:46</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a25cb7de57f83a51ee7a7d993db65e05f"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a25cb7de57f83a51ee7a7d993db65e05f">ast_sorcery_insert_wizard_mapping</a></div><div class="ttdeci">#define ast_sorcery_insert_wizard_mapping(sorcery, type, name, data, caching, position)</div><div class="ttdoc">Insert an additional object wizard mapping at a specific position in the wizard list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00563">sorcery.h:563</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="certificate_8c_html_a6978056e8b04565253b48b8c0bf950d1"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a6978056e8b04565253b48b8c0bf950d1">stir_shaken_certificate_alloc</a></div><div class="ttdeci">static void * stir_shaken_certificate_alloc(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00067">certificate.c:67</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html_a5288e040582129ce51caa718674a6266"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#a5288e040582129ce51caa718674a6266">stir_shaken_certificate::attestation</a></div><div class="ttdeci">const ast_string_field attestation</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00043">certificate.c:43</a></div></div>
<div class="ttc" id="certificate_8c_html_ae042e2240ade59250ee5546826319fb0"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#ae042e2240ade59250ee5546826319fb0">stir_shaken_certificate_get_attestation</a></div><div class="ttdeci">const char * stir_shaken_certificate_get_attestation(struct stir_shaken_certificate *cert)</div><div class="ttdoc">Get the attestation level associated with a certificate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00101">certificate.c:101</a></div></div>
<div class="ttc" id="certificate_8c_html_a4fb7cd285fd9f7ec17911a9756c13dbe"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a4fb7cd285fd9f7ec17911a9756c13dbe">stir_shaken_certificate_destructor</a></div><div class="ttdeci">static void stir_shaken_certificate_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00059">certificate.c:59</a></div></div>
<div class="ttc" id="stir__shaken_8c_html_a72cedac6e0ac6bd3d4bf5077dad6bcca"><div class="ttname"><a href="../../d5/d58/stir__shaken_8c.html#a72cedac6e0ac6bd3d4bf5077dad6bcca">stir_shaken_tab_complete_name</a></div><div class="ttdeci">char * stir_shaken_tab_complete_name(const char *word, struct ao2_container *container)</div><div class="ttdoc">Tab completion for name matching with STIR/SHAKEN CLI commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d58/stir__shaken_8c_source.html#l00066">stir_shaken.c:66</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="certificate_8c_html_aee0ed972bcbd3eb2e5fea92c73a2d9d2"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#aee0ed972bcbd3eb2e5fea92c73a2d9d2">stir_shaken_certificate_load</a></div><div class="ttdeci">int stir_shaken_certificate_load(void)</div><div class="ttdoc">Load time initialization for the stir/shaken &amp;#39;certificate&amp;#39; configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00355">certificate.c:355</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="certificate_8c_html_abe6d14eaaa3c1747d71e3724f2df77af"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#abe6d14eaaa3c1747d71e3724f2df77af">public_cert_url_to_str</a></div><div class="ttdeci">static int public_cert_url_to_str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00242">certificate.c:242</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html">stir_shaken_certificate</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00032">certificate.c:32</a></div></div>
<div class="ttc" id="stringfields_8h_html_a51b5729220efb7cda4393ed35ecdfea2"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a></div><div class="ttdeci">#define AST_STRING_FIELD(name)</div><div class="ttdoc">Declare a string field. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00299">stringfields.h:299</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="certificate_8c_html_a2130c8ad2b3cd26e4c85ed9f12de6a81"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a2130c8ad2b3cd26e4c85ed9f12de6a81">stir_shaken_certificate_unload</a></div><div class="ttdeci">int stir_shaken_certificate_unload(void)</div><div class="ttdoc">Unload time cleanup for the stir/shaken &amp;#39;certificate&amp;#39; configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00347">certificate.c:347</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="res__fax_8c_html_a7ea220e4d14b05876af4430e9832ce47"><div class="ttname"><a href="../../d0/d60/res__fax_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a></div><div class="ttdeci">struct ao2_container * container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d60/res__fax_8c_source.html#l00502">res_fax.c:502</a></div></div>
<div class="ttc" id="stir__shaken_8c_html_a44fb0d5d9e38e5ee75f149c5e5cf8913"><div class="ttname"><a href="../../d5/d58/stir__shaken_8c.html#a44fb0d5d9e38e5ee75f149c5e5cf8913">stir_shaken_cli_show</a></div><div class="ttdeci">int stir_shaken_cli_show(void *obj, void *arg, int flags)</div><div class="ttdoc">Output configuration settings to the Asterisk CLI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d58/stir__shaken_8c_source.html#l00035">stir_shaken.c:35</a></div></div>
<div class="ttc" id="certificate_8c_html_a6a7cdcec4be9f13ac18790fbf9a7c8dd"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a6a7cdcec4be9f13ac18790fbf9a7c8dd">stir_shaken_certificate_cli</a></div><div class="ttdeci">static struct ast_cli_entry stir_shaken_certificate_cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00198">certificate.c:198</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a3d078c1c29a9125b57ce97990ffa0fc0"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a3d078c1c29a9125b57ce97990ffa0fc0">AST_RETRIEVE_FLAG_DEFAULT</a></div><div class="ttdoc">Default retrieval flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00117">sorcery.h:117</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="certificate_8c_html_a53e2bd141ee7921dc54a795c3d93061b"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a53e2bd141ee7921dc54a795c3d93061b">test_stir_shaken_create_cert</a></div><div class="ttdeci">int test_stir_shaken_create_cert(const char *caller_id_number, const char *file_path)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00306">certificate.c:306</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="stir__shaken_8h_html"><div class="ttname"><a href="../../de/df9/stir__shaken_8h.html">stir_shaken.h</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="certificate_8c_html_aa9bafe5c8b2d20b9c5e6c6efa80ed708"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#aa9bafe5c8b2d20b9c5e6c6efa80ed708">stir_shaken_certificate_get_by_caller_id_number</a></div><div class="ttdeci">struct stir_shaken_certificate * stir_shaken_certificate_get_by_caller_id_number(const char *caller_id_number)</div><div class="ttdoc">Get a STIR/SHAKEN certificate by caller ID number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00084">certificate.c:84</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="certificate_8c_html_a6fab1594baa8578558d39ff300caa1b7"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a6fab1594baa8578558d39ff300caa1b7">test_stir_shaken_cleanup_cert</a></div><div class="ttdeci">int test_stir_shaken_cleanup_cert(const char *caller_id_number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00280">certificate.c:280</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="certificate_8c_html_a59e0a1f28d2b48e5b2be7deaa63d75ed"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a59e0a1f28d2b48e5b2be7deaa63d75ed">TEST_CONFIG_NAME</a></div><div class="ttdeci">#define TEST_CONFIG_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00276">certificate.c:276</a></div></div>
<div class="ttc" id="certificate_8c_html_a824e6be6bfec18044cb85c898faa1d99"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a824e6be6bfec18044cb85c898faa1d99">stir_shaken_certificate_get</a></div><div class="ttdeci">static struct stir_shaken_certificate * stir_shaken_certificate_get(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00048">certificate.c:48</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="certificate_8c_html_a059a4becf2b78415165ccb3859a41d75"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a059a4becf2b78415165ccb3859a41d75">stir_shaken_certificate_get_all</a></div><div class="ttdeci">static struct ao2_container * stir_shaken_certificate_get_all(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00053">certificate.c:53</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="res__stir__shaken_8h_html"><div class="ttname"><a href="../../d2/db7/res__stir__shaken_8h.html">res_stir_shaken.h</a></div></div>
<div class="ttc" id="res__stir__shaken_8h_html_aa8f002c5950334305845b5b4944d38ce"><div class="ttname"><a href="../../d2/db7/res__stir__shaken_8h.html#aa8f002c5950334305845b5b4944d38ce">ast_stir_shaken_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_stir_shaken_sorcery(void)</div><div class="ttdoc">Retrieve the stir/shaken sorcery context. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/res__stir__shaken_8c_source.html#l00173">res_stir_shaken.c:173</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="structaco__option_html"><div class="ttname"><a href="../../db/de0/structaco__option.html">aco_option</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00062">config_options.c:62</a></div></div>
<div class="ttc" id="certificate_8c_html_ab6a8e7a9ef393f08923ef144b2aebecb"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#ab6a8e7a9ef393f08923ef144b2aebecb">TEST_CONFIG_URL</a></div><div class="ttdeci">#define TEST_CONFIG_URL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00278">certificate.c:278</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html_a088c6953d178d0cd9e65cb0455adab7e"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#a088c6953d178d0cd9e65cb0455adab7e">stir_shaken_certificate::caller_id_number</a></div><div class="ttdeci">const ast_string_field caller_id_number</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00043">certificate.c:43</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html_ac16dc3472bcb8ad00aab24c6e902c5b9"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#ac16dc3472bcb8ad00aab24c6e902c5b9">stir_shaken_certificate::public_cert_url</a></div><div class="ttdeci">const ast_string_field public_cert_url</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00043">certificate.c:43</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="sorcery_8h_html_aaa9cd237841a70862001f580b23212c9"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_fields(const struct ast_sorcery *sorcery, const char *type, unsigned int flags, struct ast_variable *fields)</div><div class="ttdoc">Retrieve an object or multiple objects using specific fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01897">sorcery.c:1897</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="certificate_8c_html_a5578fced8ddb305c0236b2a5f3861ce0"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a5578fced8ddb305c0236b2a5f3861ce0">path_to_str</a></div><div class="ttdeci">static int path_to_str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00221">certificate.c:221</a></div></div>
<div class="ttc" id="res__pjsip__phoneprov__provider_8c_html_a95eb520bdb1abcd2a70b1432d3ecbf4c"><div class="ttname"><a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c.html#a95eb520bdb1abcd2a70b1432d3ecbf4c">sorcery</a></div><div class="ttdeci">static struct ast_sorcery * sorcery</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dbc/res__pjsip__phoneprov__provider_8c_source.html#l00126">res_pjsip_phoneprov_provider.c:126</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="certificate_8c_html_a28cc4806921d29dfa628d5693f7fff03"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a28cc4806921d29dfa628d5693f7fff03">stir_shaken_certificate_get_private_key</a></div><div class="ttdeci">EVP_PKEY * stir_shaken_certificate_get_private_key(struct stir_shaken_certificate *cert)</div><div class="ttdoc">Get the private key associated with a certificate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00106">certificate.c:106</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="strings_8h_html_ac51fa66c90ce950b248c9ff3e8c4e453"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a></div><div class="ttdeci">static int force_inline attribute_pure ast_begins_with(const char *str, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00094">strings.h:94</a></div></div>
<div class="ttc" id="certificate_8c_html_adce14ddf5821878204f8ddad611aa080"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#adce14ddf5821878204f8ddad611aa080">stir_shaken_certificate_apply</a></div><div class="ttdeci">static int stir_shaken_certificate_apply(const struct ast_sorcery *sorcery, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00111">certificate.c:111</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="structstir__shaken__certificate_html_aaeae1324cdfad45634df796a27bb37ac"><div class="ttname"><a href="../../db/df6/structstir__shaken__certificate.html#aaeae1324cdfad45634df796a27bb37ac">stir_shaken_certificate::path</a></div><div class="ttdeci">const ast_string_field path</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00043">certificate.c:43</a></div></div>
<div class="ttc" id="certificate_8c_html_a378dd4555c2860a0ca8ad6f08f644a45"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a378dd4555c2860a0ca8ad6f08f644a45">stir_shaken_certificate_show</a></div><div class="ttdeci">static char * stir_shaken_certificate_show(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00136">certificate.c:136</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="certificate_8c_html_a6ace7912b293c397519151a2aa7b9912"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a6ace7912b293c397519151a2aa7b9912">attestation_to_str</a></div><div class="ttdeci">static int attestation_to_str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00264">certificate.c:264</a></div></div>
<div class="ttc" id="certificate_8c_html_a96095168745937de27f1656b4d1da226"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#a96095168745937de27f1656b4d1da226">on_load_attestation</a></div><div class="ttdeci">static int on_load_attestation(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00251">certificate.c:251</a></div></div>
<div class="ttc" id="certificate_8c_html_ae437a20aa1556158c535fb0b7f449075"><div class="ttname"><a href="../../d7/d5c/certificate_8c.html#ae437a20aa1556158c535fb0b7f449075">stir_shaken_certificate_get_public_cert_url</a></div><div class="ttdeci">const char * stir_shaken_certificate_get_public_cert_url(struct stir_shaken_certificate *cert)</div><div class="ttdoc">Get the public key URL associated with a certificate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/certificate_8c_source.html#l00096">certificate.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html">sorcery.h</a></div><div class="ttdoc">Sorcery Data Access Layer API. </div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:43:12 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
