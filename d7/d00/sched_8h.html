<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: sched.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sched.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Scheduler Routines (derived from cheops)  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d91/sched_8h__dep__incl.png" border="0" usemap="#sched_8hdep" alt=""/></div>
<map name="sched_8hdep" id="sched_8hdep">
<area shape="rect" id="node2" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="2350,87,2407,114"/>
<area shape="rect" id="node5" href="../../d3/d45/chan__ooh323_8h.html" title="chan_ooh323.h" alt="" coords="23,169,143,196"/>
<area shape="rect" id="node18" href="../../d5/dff/chan__iax2_8c.html" title="Implementation of Inter&#45;Asterisk eXchange Version 2 as specified in RFC 5456. " alt="" coords="1109,244,1206,271"/>
<area shape="rect" id="node19" href="../../d0/dd6/chan__mgcp_8c.html" title="Implementation of Media Gateway Control Protocol. " alt="" coords="672,244,779,271"/>
<area shape="rect" id="node20" href="../../d7/d9b/chan__misdn_8c.html" title="the chan_misdn channel driver for Asterisk " alt="" coords="1645,244,1755,271"/>
<area shape="rect" id="node21" href="../../d4/d28/channel_8c.html" title="Channel Management. " alt="" coords="3585,244,3668,271"/>
<area shape="rect" id="node25" href="../../dc/df2/cdr_8c.html" title="Call Detail Record API. " alt="" coords="4073,244,4125,271"/>
<area shape="rect" id="node27" href="../../de/da4/chan__motif_8c.html" title="Motif Jingle Channel Driver. " alt="" coords="281,169,383,196"/>
<area shape="rect" id="node28" href="../../d5/dfe/chan__sip_8c.html" title="Implementation of Session Initiation Protocol. " alt="" coords="167,169,257,196"/>
<area shape="rect" id="node29" href="../../d0/d80/chan__skinny_8c.html" title="Implementation of the Skinny protocol. " alt="" coords="627,169,736,196"/>
<area shape="rect" id="node30" href="../../d5/d03/asterisk_8c.html" title="Top level source file for Asterisk &#45; the Open Source PBX. Implementation of PBX core functions and CL..." alt="" coords="760,169,843,196"/>
<area shape="rect" id="node31" href="../../d5/d66/autoservice_8c.html" title="Automatic channel service routines. " alt="" coords="3664,169,3771,196"/>
<area shape="rect" id="node32" href="../../d6/d13/file_8c.html" title="Generic File Format Support. " alt="" coords="3795,169,3845,196"/>
<area shape="rect" id="node33" href="../../da/dbe/rtp__engine_8c.html" title="Pluggable RTP Architecture. " alt="" coords="867,169,968,196"/>
<area shape="rect" id="node34" href="../../d1/dc0/pbx__dundi_8c.html" title="Distributed Universal Number Discovery (DUNDi) " alt="" coords="3869,169,3968,196"/>
<area shape="rect" id="node35" href="../../d8/d48/pbx__loopback_8c.html" title="Loopback PBX Module. " alt="" coords="3992,169,4112,196"/>
<area shape="rect" id="node36" href="../../d2/d2c/pbx__realtime_8c.html" title="Realtime PBX Module. " alt="" coords="4137,169,4253,196"/>
<area shape="rect" id="node37" href="../../d7/dc3/res__calendar_8c.html" title="Calendaring API. " alt="" coords="4277,169,4392,196"/>
<area shape="rect" id="node38" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="479,87,582,114"/>
<area shape="rect" id="node39" href="../../d5/d82/res__pjsip__sdp__rtp_8c.html" title="SIP SDP media stream handling. " alt="" coords="459,169,603,196"/>
<area shape="rect" id="node40" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="179,87,245,114"/>
<area shape="rect" id="node41" href="../../dc/d00/dns__core_8c.html" title="Core DNS Functionality. " alt="" coords="4109,87,4200,114"/>
<area shape="rect" id="node42" href="../../d8/dad/dns__recurring_8c.html" title="DNS Recurring Query Support. " alt="" coords="4224,87,4344,114"/>
<area shape="rect" id="node43" href="../../d0/d5d/dnsmgr_8c.html" title="Background DNS update manager. " alt="" coords="4369,87,4450,114"/>
<area shape="rect" id="node44" href="../../d3/d10/image_8c.html" title="Image Management. " alt="" coords="4474,87,4547,114"/>
<area shape="rect" id="node45" href="../../db/dbe/sched_8c.html" title="Scheduler Routines (from cheops&#45;NG) " alt="" coords="4571,87,4642,114"/>
<area shape="rect" id="node46" href="../../de/d43/translate_8c.html" title="Translate via the use of pseudo channels. " alt="" coords="4667,87,4757,114"/>
<area shape="rect" id="node47" href="../../d8/dca/res__pjsip__pubsub_8c.html" title="res_pjsip_pubsub.c" alt="" coords="4782,87,4925,114"/>
<area shape="rect" id="node48" href="../../d7/d30/res__sorcery__memory__cache_8c.html" title="Sorcery Memory Cache Object Wizard. " alt="" coords="4949,80,5107,121"/>
<area shape="rect" id="node49" href="../../db/dd3/res__stun__monitor_8c.html" title="STUN Network Monitor. " alt="" coords="5131,87,5275,114"/>
<area shape="rect" id="node50" href="../../d7/df9/test__sched_8c.html" title="ast_sched performance test module " alt="" coords="5299,87,5402,114"/>
<area shape="rect" id="node3" href="../../d0/db6/app__mysql_8c.html" title="MYSQL dialplan application. " alt="" coords="2099,169,2202,196"/>
<area shape="rect" id="node4" href="../../d3/d51/chan__mobile_8c.html" title="Bluetooth Mobile Device channel driver. " alt="" coords="2227,169,2341,196"/>
<area shape="rect" id="node6" href="../../d2/dae/ooh323cDriver_8c.html" title="ooh323cDriver.c" alt="" coords="2667,169,2792,196"/>
<area shape="rect" id="node7" href="../../db/d62/app__adsiprog_8c.html" title="Program Asterisk ADSI Scripts into phone. " alt="" coords="2817,169,2935,196"/>
<area shape="rect" id="node8" href="../../de/d11/app__agent__pool_8c.html" title="Call center agent pool. " alt="" coords="2959,169,3094,196"/>
<area shape="rect" id="node9" href="../../dc/d5c/app__alarmreceiver_8c.html" title="Central Station Alarm receiver for Ademco Contact ID. " alt="" coords="3118,169,3269,196"/>
<area shape="rect" id="node10" href="../../d2/d48/app__amd_8c.html" title="Answering machine detection. " alt="" coords="3293,169,3387,196"/>
<area shape="rect" id="node11" href="../../d0/df4/app__attended__transfer_8c.html" title="Attended transfer by caller channel. " alt="" coords="3411,169,3589,196"/>
<area shape="rect" id="node12" href="../../d6/d0f/app__authenticate_8c.html" title="Execute arbitrary authenticate commands. " alt="" coords="1195,169,1341,196"/>
<area shape="rect" id="node13" href="../../d7/d7c/app__blind__transfer_8c.html" title="Blind transfer by caller channel. " alt="" coords="1365,169,1515,196"/>
<area shape="rect" id="node14" href="../../de/d47/features_8h.html" title="Call Parking and Pickup API Includes code and algorithms from the Zapata library. ..." alt="" coords="1801,169,1887,196"/>
<area shape="rect" id="node15" href="../../dc/d22/app__bridgewait_8c.html" title="Application to place the channel into a holding Bridge. " alt="" coords="1779,244,1909,271"/>
<area shape="rect" id="node16" href="../../d7/d1b/app__channelredirect_8c.html" title="ChannelRedirect application. " alt="" coords="2023,244,2185,271"/>
<area shape="rect" id="node17" href="../../dc/d04/app__chanspy_8c.html" title="ChanSpy: Listen in on any channel. " alt="" coords="2287,244,2401,271"/>
<area shape="rect" id="node22" href="../../d2/d43/app__chanisavail_8c.html" title="Check if Channel is Available. " alt="" coords="1539,169,1674,196"/>
<area shape="rect" id="node23" href="../../d0/dcf/app__confbridge_8c.html" title="Conference Bridge application. " alt="" coords="2464,244,2595,271"/>
<area shape="rect" id="node24" href="../../dc/d4e/stasis__bridges_8h.html" title="stasis_bridges.h" alt="" coords="2517,169,2643,196"/>
<area shape="rect" id="node26" href="../../d6/dde/app__controlplayback_8c.html" title="Trivial application to control playback of a sound file. " alt="" coords="1911,169,2075,196"/>
</map>
</div>
</div>
<p><a href="../../d7/d00/sched_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d39/structast__cb__names.html">ast_cb_names</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8dd97314cf269a1f6387a7e04d3d9144"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a8dd97314cf269a1f6387a7e04d3d9144">ast_sched_add_object</a>(obj,  con,  when,  callback)&#160;&#160;&#160;<a class="el" href="../../db/dbe/sched_8c.html#a0961e40d4f9ade2362804118a56cb494">ast_sched_add</a>((con),(when),(callback), <a class="el" href="../../d6/d7e/astobj_8h.html#ab9c2c3dae8dc0cd67210b5e03b3b7d6e">ASTOBJ_REF</a>((obj)))</td></tr>
<tr class="memdesc:a8dd97314cf269a1f6387a7e04d3d9144"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience macro for objects and reference (add)  <a href="#a8dd97314cf269a1f6387a7e04d3d9144">More...</a><br /></td></tr>
<tr class="separator:a8dd97314cf269a1f6387a7e04d3d9144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a74d5602663e650bf5c5849d260a761"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a6a74d5602663e650bf5c5849d260a761">AST_SCHED_CB</a>(<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)&#160;&#160;&#160;((<a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>)(<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>))</td></tr>
<tr class="separator:a6a74d5602663e650bf5c5849d260a761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25647782014f8dc012994efcd1b81d32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32">AST_SCHED_DEL</a>(<a class="el" href="../../d0/da0/structsched.html">sched</a>,  <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a25647782014f8dc012994efcd1b81d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a scheduler entry.  <a href="#a25647782014f8dc012994efcd1b81d32">More...</a><br /></td></tr>
<tr class="separator:a25647782014f8dc012994efcd1b81d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd72f8ebc171a71262c76e2c44ba204"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a4fd72f8ebc171a71262c76e2c44ba204">AST_SCHED_DEL_ACCESSOR</a>(<a class="el" href="../../d0/da0/structsched.html">sched</a>,  obj,  getter,  setter)</td></tr>
<tr class="separator:a4fd72f8ebc171a71262c76e2c44ba204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72eddb165b369a7b2963b2bc451548a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#ab72eddb165b369a7b2963b2bc451548a">ast_sched_del_object</a>(obj,  destructor,  con,  <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:ab72eddb165b369a7b2963b2bc451548a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience macro for objects and reference (del)  <a href="#ab72eddb165b369a7b2963b2bc451548a">More...</a><br /></td></tr>
<tr class="separator:ab72eddb165b369a7b2963b2bc451548a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d804569b31559a8a70baa8f4b69828"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#aa7d804569b31559a8a70baa8f4b69828">AST_SCHED_DEL_SPINLOCK</a>(<a class="el" href="../../d0/da0/structsched.html">sched</a>,  <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  <a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>)</td></tr>
<tr class="memdesc:aa7d804569b31559a8a70baa8f4b69828"><td class="mdescLeft">&#160;</td><td class="mdescRight">schedule task to get deleted releasing the lock between attempts  <a href="#aa7d804569b31559a8a70baa8f4b69828">More...</a><br /></td></tr>
<tr class="separator:aa7d804569b31559a8a70baa8f4b69828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e2d4283c11790a27a0f899dab00e93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a11e2d4283c11790a27a0f899dab00e93">AST_SCHED_DEL_UNREF</a>(<a class="el" href="../../d0/da0/structsched.html">sched</a>,  <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  refcall)</td></tr>
<tr class="memdesc:a11e2d4283c11790a27a0f899dab00e93"><td class="mdescLeft">&#160;</td><td class="mdescRight">schedule task to get deleted and call unref function  <a href="#a11e2d4283c11790a27a0f899dab00e93">More...</a><br /></td></tr>
<tr class="separator:a11e2d4283c11790a27a0f899dab00e93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3482be3590d695edd576355379040d62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a3482be3590d695edd576355379040d62">AST_SCHED_REPLACE</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  <a class="el" href="../../d0/da0/structsched.html">sched</a>,  when,  callback,  data)&#160;&#160;&#160;<a class="el" href="../../d7/d00/sched_8h.html#a8fa3e1748a3d4c853da0aac32c97b39b">AST_SCHED_REPLACE_VARIABLE</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, <a class="el" href="../../d0/da0/structsched.html">sched</a>, when, callback, data, 0)</td></tr>
<tr class="separator:a3482be3590d695edd576355379040d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9174d10a79bd233b8498a11201f681"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a2a9174d10a79bd233b8498a11201f681">AST_SCHED_REPLACE_UNREF</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  <a class="el" href="../../d0/da0/structsched.html">sched</a>,  when,  callback,  data,  unrefcall,  addfailcall,  refcall)&#160;&#160;&#160;<a class="el" href="../../d7/d00/sched_8h.html#a5e19d067be27b20ccf96200834cf246d">AST_SCHED_REPLACE_VARIABLE_UNREF</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, <a class="el" href="../../d0/da0/structsched.html">sched</a>, when, callback, data, 0, unrefcall, addfailcall, refcall)</td></tr>
<tr class="separator:a2a9174d10a79bd233b8498a11201f681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa3e1748a3d4c853da0aac32c97b39b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a8fa3e1748a3d4c853da0aac32c97b39b">AST_SCHED_REPLACE_VARIABLE</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  <a class="el" href="../../d0/da0/structsched.html">sched</a>,  when,  callback,  data,  variable)</td></tr>
<tr class="separator:a8fa3e1748a3d4c853da0aac32c97b39b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e19d067be27b20ccf96200834cf246d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a5e19d067be27b20ccf96200834cf246d">AST_SCHED_REPLACE_VARIABLE_UNREF</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>,  <a class="el" href="../../d0/da0/structsched.html">sched</a>,  when,  callback,  data,  variable,  unrefcall,  addfailcall,  refcall)</td></tr>
<tr class="separator:a5e19d067be27b20ccf96200834cf246d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae9f272c016f465e567c9178180ada899"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>) (const void *data)</td></tr>
<tr class="memdesc:ae9f272c016f465e567c9178180ada899"><td class="mdescLeft">&#160;</td><td class="mdescRight">scheduler callback  <a href="#ae9f272c016f465e567c9178180ada899">More...</a><br /></td></tr>
<tr class="separator:ae9f272c016f465e567c9178180ada899"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a43dcf8be6b2ed7f96f3867fbcb4082"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int when, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> callback, const void *data) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:a7a43dcf8be6b2ed7f96f3867fbcb4082"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a scheduled event.  <a href="#a7a43dcf8be6b2ed7f96f3867fbcb4082">More...</a><br /></td></tr>
<tr class="separator:a7a43dcf8be6b2ed7f96f3867fbcb4082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec2ba936e662f6b9353fc0172e9fcec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#adec2ba936e662f6b9353fc0172e9fcec">ast_sched_add_variable</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int when, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> callback, const void *data, int variable) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:adec2ba936e662f6b9353fc0172e9fcec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a scheduled event with rescheduling support.  <a href="#adec2ba936e662f6b9353fc0172e9fcec">More...</a><br /></td></tr>
<tr class="separator:adec2ba936e662f6b9353fc0172e9fcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b3b10dfdd49d3b156f0bb4e9506500"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a40b3b10dfdd49d3b156f0bb4e9506500">ast_sched_clean_by_callback</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> <a class="el" href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a>, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> <a class="el" href="../../d2/d80/res__stasis_8c.html#aa73f2f36d051d273518d5396e86e1822">cleanup_cb</a>)</td></tr>
<tr class="memdesc:a40b3b10dfdd49d3b156f0bb4e9506500"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean all scheduled events with matching callback.  <a href="#a40b3b10dfdd49d3b156f0bb4e9506500">More...</a><br /></td></tr>
<tr class="separator:a40b3b10dfdd49d3b156f0bb4e9506500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5baecc149aeabdbef9b3ed6780c1c4a6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a5baecc149aeabdbef9b3ed6780c1c4a6">ast_sched_context_create</a> (void)</td></tr>
<tr class="memdesc:a5baecc149aeabdbef9b3ed6780c1c4a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a scheduler context.  <a href="#a5baecc149aeabdbef9b3ed6780c1c4a6">More...</a><br /></td></tr>
<tr class="separator:a5baecc149aeabdbef9b3ed6780c1c4a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862f869d056628b38e09042f21b54413"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>)</td></tr>
<tr class="memdesc:a862f869d056628b38e09042f21b54413"><td class="mdescLeft">&#160;</td><td class="mdescRight">destroys a schedule context  <a href="#a862f869d056628b38e09042f21b54413">More...</a><br /></td></tr>
<tr class="separator:a862f869d056628b38e09042f21b54413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a093634fe17bd0ac4eb6f518aa0782e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a3a093634fe17bd0ac4eb6f518aa0782e">ast_sched_del</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:a3a093634fe17bd0ac4eb6f518aa0782e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a scheduled event.  <a href="#a3a093634fe17bd0ac4eb6f518aa0782e">More...</a><br /></td></tr>
<tr class="separator:a3a093634fe17bd0ac4eb6f518aa0782e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7827352d0f87d6df0049912c15448e2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a7827352d0f87d6df0049912c15448e2a">ast_sched_dump</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con)</td></tr>
<tr class="memdesc:a7827352d0f87d6df0049912c15448e2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dumps the scheduler contents.  <a href="#a7827352d0f87d6df0049912c15448e2a">More...</a><br /></td></tr>
<tr class="separator:a7827352d0f87d6df0049912c15448e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f46c3db8abda32fb9f5f783eb53827e"><td class="memItemLeft" align="right" valign="top">const void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a2f46c3db8abda32fb9f5f783eb53827e">ast_sched_find_data</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a2f46c3db8abda32fb9f5f783eb53827e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a sched structure and return the data field associated with it.  <a href="#a2f46c3db8abda32fb9f5f783eb53827e">More...</a><br /></td></tr>
<tr class="separator:a2f46c3db8abda32fb9f5f783eb53827e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72889c63a1bd5df6f1daca42a0f8332e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a72889c63a1bd5df6f1daca42a0f8332e">ast_sched_replace</a> (int old_id, struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int when, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> callback, const void *data) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:a72889c63a1bd5df6f1daca42a0f8332e"><td class="mdescLeft">&#160;</td><td class="mdescRight">replace a scheduler entry  <a href="#a72889c63a1bd5df6f1daca42a0f8332e">More...</a><br /></td></tr>
<tr class="separator:a72889c63a1bd5df6f1daca42a0f8332e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb7b7b0a3ee9d5e833b9cf4ab8d0265b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#afb7b7b0a3ee9d5e833b9cf4ab8d0265b">ast_sched_replace_variable</a> (int old_id, struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int when, <a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a> callback, const void *data, int variable) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:afb7b7b0a3ee9d5e833b9cf4ab8d0265b"><td class="mdescLeft">&#160;</td><td class="mdescRight">replace a scheduler entry  <a href="#afb7b7b0a3ee9d5e833b9cf4ab8d0265b">More...</a><br /></td></tr>
<tr class="separator:afb7b7b0a3ee9d5e833b9cf4ab8d0265b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe0cbf010ee7dffd13ab20b0a59c234"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a3fe0cbf010ee7dffd13ab20b0a59c234">ast_sched_report</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, struct <a class="el" href="../../da/d39/structast__cb__names.html">ast_cb_names</a> *cbnames)</td></tr>
<tr class="memdesc:a3fe0cbf010ee7dffd13ab20b0a59c234"><td class="mdescLeft">&#160;</td><td class="mdescRight">Show statics on what it is in the schedule queue.  <a href="#a3fe0cbf010ee7dffd13ab20b0a59c234">More...</a><br /></td></tr>
<tr class="separator:a3fe0cbf010ee7dffd13ab20b0a59c234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c3d54f142eee0bad110fbb825c0787"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#aa9c3d54f142eee0bad110fbb825c0787">ast_sched_runq</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con)</td></tr>
<tr class="memdesc:aa9c3d54f142eee0bad110fbb825c0787"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the queue.  <a href="#aa9c3d54f142eee0bad110fbb825c0787">More...</a><br /></td></tr>
<tr class="separator:aa9c3d54f142eee0bad110fbb825c0787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae97d1549b62cfbfc78bd92efe48005"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a8ae97d1549b62cfbfc78bd92efe48005">ast_sched_start_thread</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con)</td></tr>
<tr class="memdesc:a8ae97d1549b62cfbfc78bd92efe48005"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start a thread for processing scheduler entries.  <a href="#a8ae97d1549b62cfbfc78bd92efe48005">More...</a><br /></td></tr>
<tr class="separator:a8ae97d1549b62cfbfc78bd92efe48005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13fcd6652b8dcafae35c2fa35e80a8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#af13fcd6652b8dcafae35c2fa35e80a8d">ast_sched_wait</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:af13fcd6652b8dcafae35c2fa35e80a8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines number of seconds until the next outstanding event to take place.  <a href="#af13fcd6652b8dcafae35c2fa35e80a8d">More...</a><br /></td></tr>
<tr class="separator:af13fcd6652b8dcafae35c2fa35e80a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abeb1df2ba7501f933a23dddad0f9cb"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d00/sched_8h.html#a4abeb1df2ba7501f933a23dddad0f9cb">ast_sched_when</a> (struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *con, int <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a4abeb1df2ba7501f933a23dddad0f9cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of seconds before an event takes place.  <a href="#a4abeb1df2ba7501f933a23dddad0f9cb">More...</a><br /></td></tr>
<tr class="separator:a4abeb1df2ba7501f933a23dddad0f9cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Scheduler Routines (derived from cheops) </p>

<p class="definition">Definition in file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8dd97314cf269a1f6387a7e04d3d9144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dd97314cf269a1f6387a7e04d3d9144">&#9670;&nbsp;</a></span>ast_sched_add_object</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_sched_add_object</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">obj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">con, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../db/dbe/sched_8c.html#a0961e40d4f9ade2362804118a56cb494">ast_sched_add</a>((con),(when),(callback), <a class="el" href="../../d6/d7e/astobj_8h.html#ab9c2c3dae8dc0cd67210b5e03b3b7d6e">ASTOBJ_REF</a>((obj)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convenience macro for objects and reference (add) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00343">343</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<a id="a6a74d5602663e650bf5c5849d260a761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a74d5602663e650bf5c5849d260a761">&#9670;&nbsp;</a></span>AST_SCHED_CB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_CB</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>)(<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00176">176</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<a id="a25647782014f8dc012994efcd1b81d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25647782014f8dc012994efcd1b81d32">&#9670;&nbsp;</a></span>AST_SCHED_DEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_DEL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a scheduler entry. </p>
<p>This is a loop construct to ensure that the scheduled task get deleted. The idea is that if we loop attempting to remove the scheduled task, then whatever callback had been running will complete and reinsert the task into the scheduler.</p>
<p>Since macro expansion essentially works like pass-by-name parameter passing, this macro will still work correctly even if the id of the task to delete changes. This holds as long as the name of the id which could change is passed to the macro and not a copy of the value of the id. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00046">46</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l02021">ack_trans()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l04048">ast_rtp_destroy()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l08755">ast_rtp_stop()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00557">ast_sched_replace()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00512">ast_sched_replace_variable()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l04016">build_gateway()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l12794">build_peer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l13399">delete_users()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03194">destroy_packet()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l02010">destroy_packets()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04382">destroy_peer()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03203">destroy_trans()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00302">dnsmgr_start_refresh()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00450">do_reload()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l01721">esc_entry_destructor()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l01586">handle_command_response()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l28382">handle_sip_publish_remove()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l02077">iax2_delete_from_sched()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l02088">iax2_destroy_helper()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l02130">iax2_frame_free()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l12367">iax2_poke_peer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l02333">make_trunk()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l03669">mgcpsock_read()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03614">misdn_tasks_remove()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04565">qualify_peer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l04359">realtime_peer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l08948">reg_source_db()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l01925">sip_cc_agent_stop_offer_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l02235">sip_cc_monitor_cancel_available_timer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l10083">socket_process_helper()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l03825">start_batch_mode()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02252">stream_stop()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l08879">unlink_peer()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09002">update_registry()</a>.</p>

</div>
</div>
<a id="a4fd72f8ebc171a71262c76e2c44ba204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd72f8ebc171a71262c76e2c44ba204">&#9670;&nbsp;</a></span>AST_SCHED_DEL_ACCESSOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_DEL_ACCESSOR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">obj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">getter, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">setter&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00059">59</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00357">filestream_close()</a>.</p>

</div>
</div>
<a id="ab72eddb165b369a7b2963b2bc451548a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72eddb165b369a7b2963b2bc451548a">&#9670;&nbsp;</a></span>ast_sched_del_object</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_sched_del_object</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">obj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">destructor, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">con, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convenience macro for objects and reference (del) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00349">349</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<a id="aa7d804569b31559a8a70baa8f4b69828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d804569b31559a8a70baa8f4b69828">&#9670;&nbsp;</a></span>AST_SCHED_DEL_SPINLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_DEL_SPINLOCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>schedule task to get deleted releasing the lock between attempts </p>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00098">98</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<a id="a11e2d4283c11790a27a0f899dab00e93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e2d4283c11790a27a0f899dab00e93">&#9670;&nbsp;</a></span>AST_SCHED_DEL_UNREF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_DEL_UNREF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refcall&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>schedule task to get deleted and call unref function </p>
<p>Only calls unref function if the delete succeeded.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32" title="Remove a scheduler entry. ">AST_SCHED_DEL</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00080">80</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l32459">__cleanup_registration()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l14935">__shutdown_mwi_subscription()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l14967">__start_mwi_subscription()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16060">__start_register_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l15923">__start_reregister_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l26126">__start_t38_abort_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04773">__stop_provisional_keepalive()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16040">__stop_register_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l23836">__stop_reinvite_retry()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l07176">__stop_reinviteid()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04241">__stop_retrans_pkt()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l26106">__stop_t38_abort_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04724">__update_provisional_keepalive_full()</a>, <a class="el" href="../../d8/dad/dns__recurring_8c_source.html#l00138">ast_dns_resolve_recurring_cancel()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l08755">ast_rtp_stop()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l31631">build_peer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04443">do_cancel_destroy()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l03308">do_dialog_unlink_sched_items()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30190">do_stop_session_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l24006">handle_response_invite()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16961">parse_register_contact()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l03209">peer_sched_cleanup()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l00554">remove_all_from_cache()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l02762">rtcp_debug_test_addr()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l00648">schedule_cache_expiration()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30583">sip_poke_peer()</a>, and <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l21705">sip_unregister()</a>.</p>

</div>
</div>
<a id="a3482be3590d695edd576355379040d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3482be3590d695edd576355379040d62">&#9670;&nbsp;</a></span>AST_SCHED_REPLACE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_REPLACE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d7/d00/sched_8h.html#a8fa3e1748a3d4c853da0aac32c97b39b">AST_SCHED_REPLACE_VARIABLE</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, <a class="el" href="../../d0/da0/structsched.html">sched</a>, when, callback, data, 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00125">125</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dc3/res__calendar_8c_source.html#l00954">schedule_calendar_event()</a>.</p>

</div>
</div>
<a id="a2a9174d10a79bd233b8498a11201f681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a9174d10a79bd233b8498a11201f681">&#9670;&nbsp;</a></span>AST_SCHED_REPLACE_UNREF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_REPLACE_UNREF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">unrefcall, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">addfailcall, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refcall&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d7/d00/sched_8h.html#a5e19d067be27b20ccf96200834cf246d">AST_SCHED_REPLACE_VARIABLE_UNREF</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, <a class="el" href="../../d0/da0/structsched.html">sched</a>, when, callback, data, 0, unrefcall, addfailcall, refcall)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00150">150</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l31631">build_peer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l24962">handle_response_peerpoke()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l28354">handle_sip_publish_modify()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l28326">handle_sip_publish_refresh()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03326">pubsub_on_rx_publish_request()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l05685">realtime_peer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16743">reg_source_db()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l06445">sip_call()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l34275">sip_keepalive_all_peers()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l34242">sip_poke_all_peers()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30523">sip_poke_noanswer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30583">sip_poke_peer()</a>, and <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30469">sip_send_keepalive()</a>.</p>

</div>
</div>
<a id="a8fa3e1748a3d4c853da0aac32c97b39b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa3e1748a3d4c853da0aac32c97b39b">&#9670;&nbsp;</a></span>AST_SCHED_REPLACE_VARIABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_REPLACE_VARIABLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">variable&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00114">114</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<a id="a5e19d067be27b20ccf96200834cf246d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e19d067be27b20ccf96200834cf246d">&#9670;&nbsp;</a></span>AST_SCHED_REPLACE_VARIABLE_UNREF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_SCHED_REPLACE_VARIABLE_UNREF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d0/da0/structsched.html">sched</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">variable, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">unrefcall, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">addfailcall, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refcall&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>Not currently used in the source? </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00132">132</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ae9f272c016f465e567c9178180ada899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f272c016f465e567c9178180ada899">&#9670;&nbsp;</a></span>ast_sched_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ast_sched_cb) (const void *data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scheduler callback </p>
<p>A scheduler callback takes a pointer with callback data and</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the callback should not be rescheduled </td></tr>
    <tr><td class="paramname">non-zero</td><td>if the callback should be scheduled again </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d00/sched_8h_source.html#l00175">175</a> of file <a class="el" href="../../d7/d00/sched_8h_source.html">sched.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7a43dcf8be6b2ed7f96f3867fbcb4082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a43dcf8be6b2ed7f96f3867fbcb4082">&#9670;&nbsp;</a></span>ast_sched_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>when</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a scheduled event. </p>
<p>Schedule an event to take place at some point in the future. callback will be called with data as the argument, when milliseconds into the future (approximately)</p>
<p>If callback returns 0, no further events will be re-scheduled</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Scheduler context to add </td></tr>
    <tr><td class="paramname">when</td><td>how many milliseconds to wait for event to occur </td></tr>
    <tr><td class="paramname">callback</td><td>function to call when the amount of time expires </td></tr>
    <tr><td class="paramname">data</td><td>data to pass to the callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a schedule item ID on success, -1 on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">565</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/dbe/sched_8c_source.html#l00524">ast_sched_add_variable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04484">__sip_scheddestroy()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l14967">__start_mwi_subscription()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16060">__start_register_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l15923">__start_reregister_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30226">__start_session_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l26126">__start_t38_abort_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04724">__update_provisional_keepalive_full()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00914">ast_readaudio_callback()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00977">ast_readvideo_callback()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l07200">ast_rtp_interpret()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00557">ast_sched_replace()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00415">ast_sip_schedule_task()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00107">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04628">build_peer()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02703">cc_generic_agent_start_offer_timer()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01519">cc_generic_monitor_request_cc()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l32489">cleanup_registration()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l01790">create_esc_entry()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l03367">dialog_unlink_all()</a>, <a class="el" href="../../d8/dad/dns__recurring_8c_source.html#l00071">dns_query_recurring_resolution_callback()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04531">do_register()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03413">dundi_discover()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03503">dundi_query()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03308">dundi_send()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00265">handle_cli_sched_bench()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l01586">handle_command_response()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l06198">handle_keepalive_message()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l24006">handle_response_invite()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l05300">iax2_hangup()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l05462">iax2_key_rotate()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01687">iax2_sched_add()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l00970">mbl_call()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l01098">memory_cache_stale_update_full()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l01126">memory_cache_stale_update_object()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00699">mgcp_postrequest()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l17587">network_change_stasis_cb()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16961">parse_register_contact()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04588">populate_addr()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l03437">precache_trans()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04565">qualify_peer()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l02762">rtcp_debug_test_addr()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l07087">rtp_instance_parse_transport_wide_cc()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l04891">rtp_raw_write()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l08575">rtp_red_init()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00080">run_task()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l23802">sched_check_pendings()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l00648">schedule_cache_expiration()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02512">schedule_notification()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l14952">shutdown_mwi_subscription()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04464">sip_cancel_destroy()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l01915">sip_cc_agent_start_offer_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l02102">sip_cc_monitor_request_cc()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l07197">sip_hangup()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04514">sip_scheddestroy_full()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l02029">skinny_sched_add()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l07520">skinny_session()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l14989">start_mwi_subscription()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16080">start_register_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l15945">start_reregister_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30265">start_session_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l26144">start_t38_abort_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04783">stop_provisional_keepalive()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16050">stop_register_timeout()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l23846">stop_reinvite_retry()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l07186">stop_reinviteid()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04251">stop_retrans_pkt()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l30213">stop_session_timer()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l26116">stop_t38_abort_timer()</a>, and <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04762">update_provisional_keepalive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/dbe/sched_8c.html#ac0c642b8b24755e7a14eb81cc306d8cf">ast_sched_add_variable</a>(con, <a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, <a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>, <a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>, 0);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div><div class="ttc" id="sched_8c_html_ac0c642b8b24755e7a14eb81cc306d8cf"><div class="ttname"><a href="../../db/dbe/sched_8c.html#ac0c642b8b24755e7a14eb81cc306d8cf">ast_sched_add_variable</a></div><div class="ttdeci">int ast_sched_add_variable(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data, int variable)</div><div class="ttdoc">Schedule callback(data) to happen when ms into the future. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00524">sched.c:524</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adec2ba936e662f6b9353fc0172e9fcec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adec2ba936e662f6b9353fc0172e9fcec">&#9670;&nbsp;</a></span>ast_sched_add_variable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_add_variable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>when</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a scheduled event with rescheduling support. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Scheduler context to add </td></tr>
    <tr><td class="paramname">when</td><td>how many milliseconds to wait for event to occur </td></tr>
    <tr><td class="paramname">callback</td><td>function to call when the amount of time expires </td></tr>
    <tr><td class="paramname">data</td><td>data to pass to the callback </td></tr>
    <tr><td class="paramname">variable</td><td>If true, the result value of callback function will be used for rescheduling</td></tr>
  </table>
  </dd>
</dl>
<p>Schedule an event to take place at some point in the future. Callback will be called with data as the argument, when milliseconds into the future (approximately)</p>
<p>If callback returns 0, no further events will be re-scheduled</p>
<dl class="section return"><dt>Returns</dt><dd>Returns a schedule item ID on success, -1 on failure</dd></dl>
<p>Adds a scheduled event with rescheduling support. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00524">524</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00712">ast_sched_dump()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00226">ast_tv()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00092">sched::callback</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00105">sched_thread::cond</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00091">sched::data</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00036">DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00100">sched::deleted</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00111">ast_sched_context::eventcnt</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00072">sched_id::id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00089">sched::resched</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00378">sched_alloc()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00079">sched::sched_id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00488">sched_settime()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00116">ast_sched_context::sched_thread</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00458">schedule()</a>, <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00090">sched::variable</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00080">sched::when</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l04275">__sip_reliable_xmit()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03591">_misdn_tasks_add_variable()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00512">ast_sched_replace_variable()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00302">dnsmgr_start_refresh()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00450">do_reload()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01165">global_loaded()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00210">monitored_transport_state_callback()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l03825">start_batch_mode()</a>, and <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00233">stun_start_monitor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;ast_sched_add()\n&quot;</span>));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="keywordflow">if</span> ((tmp = <a class="code" href="../../db/dbe/sched_8c.html#a5a35b1069a5d52dc0917dc4e2b4e6d56">sched_alloc</a>(con))) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">eventcnt</a>++;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a> = <a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a> = <a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#a778ab73c44615a00697f70c5adcb058b">resched</a> = <a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">variable</a> = <a class="code" href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">variable</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a> = <a class="code" href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a>(0, 0);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">deleted</a> = 0;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#a73a5b22ec6c9948e4b8575453fdb1ca6">sched_settime</a>(&amp;tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, <a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#af8ecda7e1fff722c5db4e846f9655f6d">schedule</a>(con, tmp);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      res = tmp-&gt;<a class="code" href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched_id</a>-&gt;<a class="code" href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#ifdef DUMP_SCHEDULER</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">/* Dump contents of the context while we have the lock so nothing gets screwed up by accident. */</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a7827352d0f87d6df0049912c15448e2a">ast_sched_dump</a>(con);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a>-&gt;<a class="code" href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div><div class="ttc" id="sched_8c_html_a5a35b1069a5d52dc0917dc4e2b4e6d56"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a5a35b1069a5d52dc0917dc4e2b4e6d56">sched_alloc</a></div><div class="ttdeci">static struct sched * sched_alloc(struct ast_sched_context *con)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00378">sched.c:378</a></div></div>
<div class="ttc" id="structsched_html_aa1c771eb863a70914d679a423d35d016"><div class="ttname"><a href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">sched::deleted</a></div><div class="ttdeci">unsigned int deleted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00100">sched.c:100</a></div></div>
<div class="ttc" id="structsched_html_a93dd3716ed95f47290226a31c91530e2"><div class="ttname"><a href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched::sched_id</a></div><div class="ttdeci">struct sched_id * sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00079">sched.c:79</a></div></div>
<div class="ttc" id="structast__sched__context_html_a749ecaa5dfc98e211e17735e072c49d2"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">ast_sched_context::sched_thread</a></div><div class="ttdeci">struct sched_thread * sched_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00116">sched.c:116</a></div></div>
<div class="ttc" id="sched_8c_html_a73a5b22ec6c9948e4b8575453fdb1ca6"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a73a5b22ec6c9948e4b8575453fdb1ca6">sched_settime</a></div><div class="ttdeci">static void sched_settime(struct timeval *t, int when)</div><div class="ttdoc">given the last event *tv and the offset in milliseconds &amp;#39;when&amp;#39;, computes the next value...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00488">sched.c:488</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="structsched_html_a778ab73c44615a00697f70c5adcb058b"><div class="ttname"><a href="../../d0/da0/structsched.html#a778ab73c44615a00697f70c5adcb058b">sched::resched</a></div><div class="ttdeci">int resched</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00089">sched.c:89</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="sched_8c_html_af8ecda7e1fff722c5db4e846f9655f6d"><div class="ttname"><a href="../../db/dbe/sched_8c.html#af8ecda7e1fff722c5db4e846f9655f6d">schedule</a></div><div class="ttdeci">static void schedule(struct ast_sched_context *con, struct sched *s)</div><div class="ttdoc">Take a sched structure and put it in the queue, such that the soonest event is first in the list...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00458">sched.c:458</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="sched_8c_html_a7827352d0f87d6df0049912c15448e2a"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a7827352d0f87d6df0049912c15448e2a">ast_sched_dump</a></div><div class="ttdeci">void ast_sched_dump(struct ast_sched_context *con)</div><div class="ttdoc">Dump the contents of the scheduler to LOG_DEBUG. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00712">sched.c:712</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structsched__thread_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">sched_thread::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00105">sched.c:105</a></div></div>
<div class="ttc" id="structast__sched__context_html_a2d5621366e555704664f39180c7a758c"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">ast_sched_context::eventcnt</a></div><div class="ttdeci">unsigned int eventcnt</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00111">sched.c:111</a></div></div>
<div class="ttc" id="time_8h_html_aebf04439f206cc509472ce4b6da48a5a"><div class="ttname"><a href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a></div><div class="ttdeci">struct timeval ast_tv(ast_time_t sec, ast_suseconds_t usec)</div><div class="ttdoc">Returns a timeval from sec, usec. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00226">time.h:226</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="sched_8c_html_a8a979668ecb044c9ac0e5017107f1d52"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a></div><div class="ttdeci">#define DEBUG(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00036">sched.c:36</a></div></div>
<div class="ttc" id="structsched_html_ac2bb0fc1fabbeabad94c3b726bd708bc"><div class="ttname"><a href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">sched::variable</a></div><div class="ttdeci">int variable</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00090">sched.c:90</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
<div class="ttc" id="structsched__id_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">sched_id::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00072">sched.c:72</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40b3b10dfdd49d3b156f0bb4e9506500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b3b10dfdd49d3b156f0bb4e9506500">&#9670;&nbsp;</a></span>ast_sched_clean_by_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sched_clean_by_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>cleanup_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean all scheduled events with matching callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Scheduler Context </td></tr>
    <tr><td class="paramname">match</td><td>Callback to match </td></tr>
    <tr><td class="paramname">cleanup_cb</td><td>Callback to run</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The return of cleanup_cb is ignored. No events are rescheduled. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00407">407</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d29/heap_8c_source.html#l00267">ast_heap_peek()</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00251">ast_heap_remove()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00092">sched::callback</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00309">cleanup_cb()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00091">sched::data</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00358">sched_release()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14601">__unload_module()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00410">ast_sip_destroy_transport_management()</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01165">global_loaded()</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keywordtype">int</span> i = 1;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *current;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">while</span> ((current = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, i))) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a> != <a class="code" href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a>) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         i++;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <a class="code" href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, current);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <a class="code" href="../../d2/d80/res__stasis_8c.html#aa73f2f36d051d273518d5396e86e1822">cleanup_cb</a>(current-&gt;<a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a>(con, current);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a7dd0190efe1c61151a9dbab078bdb263"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a></div><div class="ttdeci">static int match(struct ast_sockaddr *addr, unsigned short callno, unsigned short dcallno, const struct chan_iax2_pvt *cur, int check_dcallno)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l02315">chan_iax2.c:2315</a></div></div>
<div class="ttc" id="res__stasis_8c_html_aa73f2f36d051d273518d5396e86e1822"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#aa73f2f36d051d273518d5396e86e1822">cleanup_cb</a></div><div class="ttdeci">static int cleanup_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00309">res_stasis.c:309</a></div></div>
<div class="ttc" id="sched_8c_html_a9734f4bd9944c04f548c5edd870268e6"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a></div><div class="ttdeci">static void sched_release(struct ast_sched_context *con, struct sched *tmp)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00358">sched.c:358</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="heap_8h_html_ac68d03b30bb0adc489ccd67a11873b59"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a></div><div class="ttdeci">void * ast_heap_remove(struct ast_heap *h, void *elm)</div><div class="ttdoc">Remove a specific element from a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00251">heap.c:251</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5baecc149aeabdbef9b3ed6780c1c4a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5baecc149aeabdbef9b3ed6780c1c4a6">&#9670;&nbsp;</a></span>ast_sched_context_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a>* ast_sched_context_create </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a scheduler context. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns a malloc'd sched_context structure, NULL on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00236">236</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../da/ddb/heap_8h_source.html#l00102">ast_heap_create</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00680">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00184">ast_mutex_init</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00269">ast_sched_context_destroy()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00111">ast_sched_context::eventcnt</a>, <a class="el" href="../../d7/de8/structast__sched__context.html#a78d9fe5bb0acbf180cc3f3f0597ec69d">ast_sched_context::id_queue</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00223">sched_time_cmp()</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d28/channel_8c_source.html#l00739">__ast_channel_alloc_ap()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01260">ast_sip_initialize_distributor()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00614">ast_sip_initialize_scheduler()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00372">ast_sip_initialize_transport_management()</a>, <a class="el" href="../../df/d98/test__res__rtp_8c_source.html#l00133">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00614">dns_core_init()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00265">handle_cli_sched_bench()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04653">load_module()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03554">misdn_tasks_init()</a>, and <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00233">stun_start_monitor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">if</span> (!(tmp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp)))) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;tmp-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   tmp-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">eventcnt</a> = 1;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;tmp-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a78d9fe5bb0acbf180cc3f3f0597ec69d">id_queue</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">if</span> (!(tmp-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a> = <a class="code" href="../../da/ddb/heap_8h.html#a42b42e04887dbc86276e590141147f63">ast_heap_create</a>(8, <a class="code" href="../../db/dbe/sched_8c.html#ab0e33256f4ce7d5ac842a0e29a1105a2">sched_time_cmp</a>,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;         offsetof(<span class="keyword">struct</span> <a class="code" href="../../d0/da0/structsched.html">sched</a>, __heap_index)))) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#ad1233b7dcb5f27724defeccca913a226">ast_sched_context_destroy</a>(tmp);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="sched_8c_html_ab0e33256f4ce7d5ac842a0e29a1105a2"><div class="ttname"><a href="../../db/dbe/sched_8c.html#ab0e33256f4ce7d5ac842a0e29a1105a2">sched_time_cmp</a></div><div class="ttdeci">static int sched_time_cmp(void *va, void *vb)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00223">sched.c:223</a></div></div>
<div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="sched_8c_html_ad1233b7dcb5f27724defeccca913a226"><div class="ttname"><a href="../../db/dbe/sched_8c.html#ad1233b7dcb5f27724defeccca913a226">ast_sched_context_destroy</a></div><div class="ttdeci">void ast_sched_context_destroy(struct ast_sched_context *con)</div><div class="ttdoc">destroys a schedule context </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00269">sched.c:269</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sched__context_html"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html">ast_sched_context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00109">sched.c:109</a></div></div>
<div class="ttc" id="structast__sched__context_html_a78d9fe5bb0acbf180cc3f3f0597ec69d"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a78d9fe5bb0acbf180cc3f3f0597ec69d">ast_sched_context::id_queue</a></div><div class="ttdeci">struct ast_sched_context::@417 id_queue</div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="heap_8h_html_a42b42e04887dbc86276e590141147f63"><div class="ttname"><a href="../../da/ddb/heap_8h.html#a42b42e04887dbc86276e590141147f63">ast_heap_create</a></div><div class="ttdeci">#define ast_heap_create(init_height, cmp_fn, index_offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l00102">heap.h:102</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="structast__sched__context_html_a2d5621366e555704664f39180c7a758c"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">ast_sched_context::eventcnt</a></div><div class="ttdeci">unsigned int eventcnt</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00111">sched.c:111</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a862f869d056628b38e09042f21b54413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862f869d056628b38e09042f21b54413">&#9670;&nbsp;</a></span>ast_sched_context_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sched_context_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>destroys a schedule context </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Context to free </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00269">269</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00146">ast_heap_destroy()</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00262">ast_heap_pop()</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00186">ast_mutex_destroy</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d7/de8/structast__sched__context.html#a78d9fe5bb0acbf180cc3f3f0597ec69d">ast_sched_context::id_queue</a>, <a class="el" href="../../d1/dab/structsched__id.html#a44cb5c74b50fb939e70a56d5f07d4e2e">sched_id::list</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00258">sched_free()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00116">ast_sched_context::sched_thread</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00173">sched_thread_destroy()</a>, and <a class="el" href="../../d7/de8/structast__sched__context.html#a26c25075f858ba186d313cf229211650">ast_sched_context::schedc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14601">__unload_module()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02192">ast_channel_destructor()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02548">ast_hangup()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00236">ast_sched_context_create()</a>, <a class="el" href="../../df/d98/test__res__rtp_8c_source.html#l00046">ast_sched_context_destroy_wrapper()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01334">ast_sip_destroy_distributor()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00642">ast_sip_destroy_scheduler()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00410">ast_sip_destroy_transport_management()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00614">ast_sip_initialize_scheduler()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00372">ast_sip_initialize_transport_management()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00107">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04385">cdr_engine_shutdown()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00606">dns_shutdown()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00265">handle_cli_sched_bench()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14828">load_module()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04480">mbl_load_device()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03574">misdn_tasks_destroy()</a>, <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00233">stun_start_monitor()</a>, <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00209">stun_stop_monitor()</a>, and <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04623">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *s;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dab/structsched__id.html">sched_id</a> *sid;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a38faaa195e38aef4c33481ac36541d64">sched_thread_destroy</a>(con);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   con-&gt;sched_thread = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;lock);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef SCHED_MAX_CACHE</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordflow">while</span> ((s = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;con-&gt;schedc, <a class="code" href="../../d1/dab/structsched__id.html#a44cb5c74b50fb939e70a56d5f07d4e2e">list</a>))) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#a38d2b3fe1e83f34023178e933e352c25">sched_free</a>(s);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">if</span> (con-&gt;sched_heap) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">while</span> ((s = <a class="code" href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a>(con-&gt;sched_heap))) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         <a class="code" href="../../db/dbe/sched_8c.html#a38d2b3fe1e83f34023178e933e352c25">sched_free</a>(s);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="../../da/ddb/heap_8h.html#a66d0a4a9d9e08e704abc44c856407bb8">ast_heap_destroy</a>(con-&gt;sched_heap);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      con-&gt;sched_heap = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">while</span> ((sid = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;con-&gt;id_queue, <a class="code" href="../../d1/dab/structsched__id.html#a44cb5c74b50fb939e70a56d5f07d4e2e">list</a>))) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sid);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;lock);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;con-&gt;lock);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(con);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div><div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="heap_8h_html_a66d0a4a9d9e08e704abc44c856407bb8"><div class="ttname"><a href="../../da/ddb/heap_8h.html#a66d0a4a9d9e08e704abc44c856407bb8">ast_heap_destroy</a></div><div class="ttdeci">struct ast_heap * ast_heap_destroy(struct ast_heap *h)</div><div class="ttdoc">Destroy a max heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00146">heap.c:146</a></div></div>
<div class="ttc" id="structsched__id_html"><div class="ttname"><a href="../../d1/dab/structsched__id.html">sched_id</a></div><div class="ttdoc">Scheduler ID holder. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00070">sched.c:70</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="sched_8c_html_a38faaa195e38aef4c33481ac36541d64"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a38faaa195e38aef4c33481ac36541d64">sched_thread_destroy</a></div><div class="ttdeci">static void sched_thread_destroy(struct ast_sched_context *con)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00173">sched.c:173</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="heap_8h_html_ad56625488a481df852f0b13d58b15a93"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a></div><div class="ttdeci">void * ast_heap_pop(struct ast_heap *h)</div><div class="ttdoc">Pop the max element off of the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00262">heap.c:262</a></div></div>
<div class="ttc" id="structsched__id_html_a44cb5c74b50fb939e70a56d5f07d4e2e"><div class="ttname"><a href="../../d1/dab/structsched__id.html#a44cb5c74b50fb939e70a56d5f07d4e2e">sched_id::list</a></div><div class="ttdeci">struct sched_id::@414 list</div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="sched_8c_html_a38d2b3fe1e83f34023178e933e352c25"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a38d2b3fe1e83f34023178e933e352c25">sched_free</a></div><div class="ttdeci">static void sched_free(struct sched *task)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00258">sched.c:258</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a093634fe17bd0ac4eb6f518aa0782e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a093634fe17bd0ac4eb6f518aa0782e">&#9670;&nbsp;</a></span>ast_sched_del()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_del </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a scheduled event. </p>
<p>Remove this event from being run. A procedure should not remove its own event, but return 0 instead. In most cases, you should not call this routine directly, but use the <a class="el" href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32" title="Remove a scheduler entry. ">AST_SCHED_DEL()</a> macro instead (especially if you don't intend to do something different when it returns failure).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>scheduling context to delete item from </td></tr>
    <tr><td class="paramname">id</td><td>ID of the scheduled item to delete</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, -1 on failure</dd></dl>
<p>Deletes a scheduled event. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00610">610</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00203">ast_cond_wait</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00251">ast_heap_remove()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d22/logger_8c_source.html#l02158">ast_log_backtrace()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00712">ast_sched_dump()</a>, <a class="el" href="../../dc/d7d/threadstorage_8h_source.html#l00197">ast_threadstorage_get()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00092">sched::callback</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00098">sched::cond</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00105">sched_thread::cond</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00118">ast_sched_context::currently_executing</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00036">DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00100">sched::deleted</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00120">ast_sched_context::executing_thread_id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00072">sched_id::id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00058">last_del_id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00570">sched_find()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00079">sched::sched_id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00358">sched_release()</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00116">ast_sched_context::sched_thread</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l08303">ast_rtp_prop_set()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l08755">ast_rtp_stop()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00191">ast_sip_sched_task_cancel()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00107">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02722">cc_generic_agent_stop_offer_timer()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01651">cc_generic_monitor_cancel_available_timer()</a>, <a class="el" href="../../d7/dc3/res__calendar_8c_source.html#l00626">destroy_event()</a>, <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00265">handle_cli_sched_bench()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l06198">handle_keepalive_message()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l02258">skinny_register()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l02022">skinny_sched_del()</a>, and <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l07466">skinny_session_cleanup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *s = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordtype">int</span> *last_id = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../db/dbe/sched_8c.html#a280fdbc5360ba15bf5630765d5d06eb2">last_del_id</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;ast_sched_del(%d)\n&quot;</span>, <span class="keywordtype">id</span>));</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; 0) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   s = <a class="code" href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a>(con, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, s)) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,<span class="stringliteral">&quot;sched entry %d not in the sched heap?\n&quot;</span>, s-&gt;<a class="code" href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched_id</a>-&gt;<a class="code" href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a>(con, s);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a> &amp;&amp; (<span class="keywordtype">id</span> == con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a>-&gt;<a class="code" href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched_id</a>-&gt;<a class="code" href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>)) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a770d0c970dd51cbca2e72b48a46d50d6">executing_thread_id</a> == pthread_self()) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="comment">/* The scheduled callback is trying to delete itself.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">          * Not good as that is a deadlock. */</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="stringliteral">&quot;BUG! Trying to delete sched %d from within the callback %p.  &quot;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="stringliteral">&quot;Ignoring so we don&#39;t deadlock\n&quot;</span>,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordtype">id</span>, con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a>-&gt;<a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#af6cb0aae475369edb487c5c0ea2af02a">ast_log_backtrace</a>();</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         <span class="comment">/* We&#39;ll return -1 below because s is NULL.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">          * The caller will rightly assume that the unscheduling failed. */</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         s = con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         s-&gt;<a class="code" href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">deleted</a> = 1;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         <span class="comment">/* Wait for executing task to complete so that the caller of</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">          * ast_sched_del() does not free memory out from under the task. */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;         <span class="keywordflow">while</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a> &amp;&amp; (<span class="keywordtype">id</span> == con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a>-&gt;<a class="code" href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched_id</a>-&gt;<a class="code" href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>)) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;s-&gt;<a class="code" href="../../d0/da0/structsched.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, &amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;         }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="comment">/* Do not sched_release() here because ast_sched_runq() will do it */</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#ifdef DUMP_SCHEDULER</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <span class="comment">/* Dump contents of the context while we have the lock so nothing gets screwed up by accident. */</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a7827352d0f87d6df0049912c15448e2a">ast_sched_dump</a>(con);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a>) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a>-&gt;<a class="code" href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordflow">if</span> (!s &amp;&amp; *last_id != <span class="keywordtype">id</span>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Attempted to delete nonexistent schedule entry %d!\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="comment">/* Removing nonexistent schedule entry shouldn&#39;t trigger assert (it was enabled in DEV_MODE);</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">       * because in many places entries is deleted without having valid id. */</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      *last_id = <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;}</div><div class="ttc" id="sched_8c_html_a280fdbc5360ba15bf5630765d5d06eb2"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a280fdbc5360ba15bf5630765d5d06eb2">last_del_id</a></div><div class="ttdeci">static struct ast_threadstorage last_del_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00058">sched.c:58</a></div></div>
<div class="ttc" id="structsched_html_aa1c771eb863a70914d679a423d35d016"><div class="ttname"><a href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">sched::deleted</a></div><div class="ttdeci">unsigned int deleted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00100">sched.c:100</a></div></div>
<div class="ttc" id="structsched_html_a93dd3716ed95f47290226a31c91530e2"><div class="ttname"><a href="../../d0/da0/structsched.html#a93dd3716ed95f47290226a31c91530e2">sched::sched_id</a></div><div class="ttdeci">struct sched_id * sched_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00079">sched.c:79</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__sched__context_html_a749ecaa5dfc98e211e17735e072c49d2"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">ast_sched_context::sched_thread</a></div><div class="ttdeci">struct sched_thread * sched_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00116">sched.c:116</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="logger_8h_html_af6cb0aae475369edb487c5c0ea2af02a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#af6cb0aae475369edb487c5c0ea2af02a">ast_log_backtrace</a></div><div class="ttdeci">void ast_log_backtrace(void)</div><div class="ttdoc">Log a backtrace of the current thread&amp;#39;s execution stack to the Asterisk log. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l02158">logger.c:2158</a></div></div>
<div class="ttc" id="structast__sched__context_html_a770d0c970dd51cbca2e72b48a46d50d6"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a770d0c970dd51cbca2e72b48a46d50d6">ast_sched_context::executing_thread_id</a></div><div class="ttdeci">pthread_t executing_thread_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00120">sched.c:120</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sched_8c_html_a7dc4eeb65fd9839673694aad94c4e58a"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a></div><div class="ttdeci">static struct sched * sched_find(struct ast_sched_context *con, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00570">sched.c:570</a></div></div>
<div class="ttc" id="sched_8c_html_a9734f4bd9944c04f548c5edd870268e6"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a></div><div class="ttdeci">static void sched_release(struct ast_sched_context *con, struct sched *tmp)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00358">sched.c:358</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="sched_8c_html_a7827352d0f87d6df0049912c15448e2a"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a7827352d0f87d6df0049912c15448e2a">ast_sched_dump</a></div><div class="ttdeci">void ast_sched_dump(struct ast_sched_context *con)</div><div class="ttdoc">Dump the contents of the scheduler to LOG_DEBUG. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00712">sched.c:712</a></div></div>
<div class="ttc" id="structast__sched__context_html_ac9d11754cea7df5643c4fccab82bf045"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">ast_sched_context::currently_executing</a></div><div class="ttdeci">struct sched * currently_executing</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00118">sched.c:118</a></div></div>
<div class="ttc" id="structsched__thread_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">sched_thread::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00105">sched.c:105</a></div></div>
<div class="ttc" id="heap_8h_html_ac68d03b30bb0adc489ccd67a11873b59"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a></div><div class="ttdeci">void * ast_heap_remove(struct ast_heap *h, void *elm)</div><div class="ttdoc">Remove a specific element from a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00251">heap.c:251</a></div></div>
<div class="ttc" id="structsched_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d0/da0/structsched.html#a1c7181c39f99ee801943a0d0aa9872b9">sched::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00098">sched.c:98</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="sched_8c_html_a8a979668ecb044c9ac0e5017107f1d52"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a></div><div class="ttdeci">#define DEBUG(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00036">sched.c:36</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
<div class="ttc" id="structsched__id_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../d1/dab/structsched__id.html#a7441ef0865bcb3db9b8064dd7375c1ea">sched_id::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00072">sched.c:72</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7827352d0f87d6df0049912c15448e2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7827352d0f87d6df0049912c15448e2a">&#9670;&nbsp;</a></span>ast_sched_dump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sched_dump </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dumps the scheduler contents. </p>
<p>Debugging: Dump the contents of the scheduler to stderr</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Context to dump</td></tr>
  </table>
  </dd>
</dl>
<p>Dumps the scheduler contents. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00712">712</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d29/heap_8c_source.html#l00267">ast_heap_peek()</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00276">ast_heap_size()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l02298">ast_tvsub()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00441">DEBUG_ATLEAST</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00111">ast_sched_context::eventcnt</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00112">ast_sched_context::highwater</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00241">LOG_DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00124">ast_sched_context::schedccnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/dbe/sched_8c_source.html#l00524">ast_sched_add_variable()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00610">ast_sched_del()</a>, <a class="el" href="../../d7/dc3/res__calendar_8c_source.html#l01690">handle_dump_sched()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l34384">sip_do_reload()</a>, and <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35708">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *q;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="keyword">struct </span>timeval when;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordtype">size_t</span> heap_size;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(1)) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   when = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#ifdef SCHED_MAX_CACHE</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Asterisk Schedule Dump (%zu in Q, %u Total, %u Cache, %u high-water)\n&quot;</span>,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>), con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">eventcnt</a> - 1, con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a252186d8bb2e81ccf2c7f8456ae3b19c">schedccnt</a>, con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac5028ea4f5c5ef2ef4d037ef54dd0942">highwater</a>);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Asterisk Schedule Dump (%zu in Q, %u Total, %u high-water)\n&quot;</span>,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>), con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">eventcnt</a> - 1, con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac5028ea4f5c5ef2ef4d037ef54dd0942">highwater</a>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;=============================================================\n&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;|ID    Callback          Data              Time  (sec:ms)   |\n&quot;</span>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;+-----+-----------------+-----------------+-----------------+\n&quot;</span>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   heap_size = <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">for</span> (x = 1; x &lt;= heap_size; x++) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keyword">struct </span>timeval delta;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      q = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, x);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      delta = <a class="code" href="../../de/df7/time_8h.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a>(q-&gt;when, when);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;|%.4d | %-15p | %-15p | %.6ld : %.6ld |\n&quot;</span>,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;         q-&gt;sched_id-&gt;id,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;         q-&gt;callback,</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;         q-&gt;data,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;         (<span class="keywordtype">long</span>)delta.tv_sec,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         (<span class="keywordtype">long</span> <span class="keywordtype">int</span>)delta.tv_usec);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;=============================================================\n&quot;</span>);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="logger_8h_html_a6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00241">logger.h:241</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sched__context_html_a252186d8bb2e81ccf2c7f8456ae3b19c"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a252186d8bb2e81ccf2c7f8456ae3b19c">ast_sched_context::schedccnt</a></div><div class="ttdeci">unsigned int schedccnt</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00124">sched.c:124</a></div></div>
<div class="ttc" id="structast__sched__context_html_a2d5621366e555704664f39180c7a758c"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a2d5621366e555704664f39180c7a758c">ast_sched_context::eventcnt</a></div><div class="ttdeci">unsigned int eventcnt</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00111">sched.c:111</a></div></div>
<div class="ttc" id="heap_8h_html_abb3efaa08e2b1e9423bbbd5e3d9d2acc"><div class="ttname"><a href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a></div><div class="ttdeci">size_t ast_heap_size(struct ast_heap *h)</div><div class="ttdoc">Get the current size of a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00276">heap.c:276</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="time_8h_html_aa13b651c18bc6004cab21ac041d44dd8"><div class="ttname"><a href="../../de/df7/time_8h.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a></div><div class="ttdeci">struct timeval ast_tvsub(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the difference of two timevals a - b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02298">extconf.c:2298</a></div></div>
<div class="ttc" id="structast__sched__context_html_ac5028ea4f5c5ef2ef4d037ef54dd0942"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#ac5028ea4f5c5ef2ef4d037ef54dd0942">ast_sched_context::highwater</a></div><div class="ttdeci">unsigned int highwater</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00112">sched.c:112</a></div></div>
<div class="ttc" id="logger_8h_html_a33f6031de4ab6d1406465a7a3ee18e86"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a></div><div class="ttdeci">#define DEBUG_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00441">logger.h:441</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f46c3db8abda32fb9f5f783eb53827e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f46c3db8abda32fb9f5f783eb53827e">&#9670;&nbsp;</a></span>ast_sched_find_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const void* ast_sched_find_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find a sched structure and return the data field associated with it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>scheduling context in which to search fro the matching id </td></tr>
    <tr><td class="paramname">id</td><td>ID of the scheduled item to find </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the data field from the matching sched struct if found; else return NULL if not found.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00587">587</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00091">sched::data</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00570">sched_find()</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *s;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   s = <a class="code" href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a>(con, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      data = s-&gt;<a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div><div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sched_8c_html_a7dc4eeb65fd9839673694aad94c4e58a"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a></div><div class="ttdeci">static struct sched * sched_find(struct ast_sched_context *con, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00570">sched.c:570</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72889c63a1bd5df6f1daca42a0f8332e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72889c63a1bd5df6f1daca42a0f8332e">&#9670;&nbsp;</a></span>ast_sched_replace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_replace </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>when</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>replace a scheduler entry </p>
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000018">Deprecated:</a></b></dt><dd>You should use the <a class="el" href="../../d7/d00/sched_8h.html#a3482be3590d695edd576355379040d62">AST_SCHED_REPLACE()</a> macro instead.</dd></dl>
<p>This deletes the scheduler entry for old_id if it exists, and then calls ast_sched_add to create a new entry. A negative old_id will be ignored.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>failure </td></tr>
    <tr><td class="paramname">otherwise,returns</td><td>scheduled item ID </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00557">557</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, and <a class="el" href="../../d7/d00/sched_8h_source.html#l00046">AST_SCHED_DEL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01681">iax2_sched_replace()</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;{</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">if</span> (old_id &gt; -1) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32">AST_SCHED_DEL</a>(con, old_id);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/dbe/sched_8c.html#a0961e40d4f9ade2362804118a56cb494">ast_sched_add</a>(con, <a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, <a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>, <a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div><div class="ttc" id="sched_8c_html_a0961e40d4f9ade2362804118a56cb494"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a0961e40d4f9ade2362804118a56cb494">ast_sched_add</a></div><div class="ttdeci">int ast_sched_add(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data)</div><div class="ttdoc">Adds a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00565">sched.c:565</a></div></div>
<div class="ttc" id="sched_8h_html_a25647782014f8dc012994efcd1b81d32"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32">AST_SCHED_DEL</a></div><div class="ttdeci">#define AST_SCHED_DEL(sched, id)</div><div class="ttdoc">Remove a scheduler entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00046">sched.h:46</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb7b7b0a3ee9d5e833b9cf4ab8d0265b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb7b7b0a3ee9d5e833b9cf4ab8d0265b">&#9670;&nbsp;</a></span>ast_sched_replace_variable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_replace_variable </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>when</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d00/sched_8h.html#ae9f272c016f465e567c9178180ada899">ast_sched_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>replace a scheduler entry </p>
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000019">Deprecated:</a></b></dt><dd>You should use the <a class="el" href="../../d7/d00/sched_8h.html#a8fa3e1748a3d4c853da0aac32c97b39b">AST_SCHED_REPLACE_VARIABLE()</a> macro instead.</dd></dl>
<p>This deletes the scheduler entry for old_id if it exists, and then calls ast_sched_add to create a new entry. A negative old_id will be ignored.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>failure </td></tr>
    <tr><td class="paramname">otherwise,returns</td><td>scheduled item ID </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00512">512</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/dbe/sched_8c_source.html#l00524">ast_sched_add_variable()</a>, and <a class="el" href="../../d7/d00/sched_8h_source.html#l00046">AST_SCHED_DEL</a>.</p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">/* 0 means the schedule item is new; do not delete */</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordflow">if</span> (old_id &gt; 0) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32">AST_SCHED_DEL</a>(con, old_id);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/dbe/sched_8c.html#ac0c642b8b24755e7a14eb81cc306d8cf">ast_sched_add_variable</a>(con, <a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, <a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>, <a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>, <a class="code" href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">variable</a>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="ttc" id="sched_8c_html_ac0c642b8b24755e7a14eb81cc306d8cf"><div class="ttname"><a href="../../db/dbe/sched_8c.html#ac0c642b8b24755e7a14eb81cc306d8cf">ast_sched_add_variable</a></div><div class="ttdeci">int ast_sched_add_variable(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data, int variable)</div><div class="ttdoc">Schedule callback(data) to happen when ms into the future. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00524">sched.c:524</a></div></div>
<div class="ttc" id="sched_8h_html_a25647782014f8dc012994efcd1b81d32"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a25647782014f8dc012994efcd1b81d32">AST_SCHED_DEL</a></div><div class="ttdeci">#define AST_SCHED_DEL(sched, id)</div><div class="ttdoc">Remove a scheduler entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00046">sched.h:46</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structsched_html_ac2bb0fc1fabbeabad94c3b726bd708bc"><div class="ttname"><a href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">sched::variable</a></div><div class="ttdeci">int variable</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00090">sched.c:90</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3fe0cbf010ee7dffd13ab20b0a59c234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fe0cbf010ee7dffd13ab20b0a59c234">&#9670;&nbsp;</a></span>ast_sched_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sched_report </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d39/structast__cb__names.html">ast_cb_names</a> *&#160;</td>
          <td class="paramname"><em>cbnames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Show statics on what it is in the schedule queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Schedule context to check </td></tr>
    <tr><td class="paramname">buf</td><td>dynamic string to store report </td></tr>
    <tr><td class="paramname">cbnames</td><td>to check against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00674">674</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d29/heap_8c_source.html#l00267">ast_heap_peek()</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00276">ast_heap_size()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00092">sched::callback</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00192">ast_cb_names::cblist</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00112">ast_sched_context::highwater</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00191">ast_cb_names::list</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00190">ast_cb_names::numassocs</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l21591">sip_show_sched()</a>.</p>
<div class="fragment"><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;{</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keywordtype">int</span> i, x;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *cur;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="keywordtype">int</span> countlist[cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">numassocs</a> + 1];</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="keywordtype">size_t</span> heap_size;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   memset(countlist, 0, <span class="keyword">sizeof</span>(countlist));</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(buf, 0, <span class="stringliteral">&quot; Highwater = %u\n schedcnt = %zu\n&quot;</span>, con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac5028ea4f5c5ef2ef4d037ef54dd0942">highwater</a>, <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>));</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   heap_size = <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordflow">for</span> (x = 1; x &lt;= heap_size; x++) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      cur = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, x);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">/* match the callback to the cblist */</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">numassocs</a>; i++) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a> == cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#af025691779591d8068d64284c296d552">cblist</a>[i]) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">if</span> (i &lt; cbnames-&gt;numassocs) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;         countlist[i]++;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;         countlist[cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">numassocs</a>]++;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">numassocs</a>; i++) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;    %s : %d\n&quot;</span>, cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#a804ee4e1914df6e9534db1f6604f88ab">list</a>[i], countlist[i]);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buf, 0, <span class="stringliteral">&quot;   &lt;unknown&gt; : %d\n&quot;</span>, countlist[cbnames-&gt;<a class="code" href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">numassocs</a>]);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div><div class="ttc" id="structast__cb__names_html_a804ee4e1914df6e9534db1f6604f88ab"><div class="ttname"><a href="../../da/d39/structast__cb__names.html#a804ee4e1914df6e9534db1f6604f88ab">ast_cb_names::list</a></div><div class="ttdeci">char * list[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00191">sched.h:191</a></div></div>
<div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="structast__cb__names_html_af025691779591d8068d64284c296d552"><div class="ttname"><a href="../../da/d39/structast__cb__names.html#af025691779591d8068d64284c296d552">ast_cb_names::cblist</a></div><div class="ttdeci">ast_sched_cb cblist[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00192">sched.h:192</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structast__cb__names_html_add023ad2040e9f2ec08390700aa1b556"><div class="ttname"><a href="../../da/d39/structast__cb__names.html#add023ad2040e9f2ec08390700aa1b556">ast_cb_names::numassocs</a></div><div class="ttdeci">int numassocs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00190">sched.h:190</a></div></div>
<div class="ttc" id="heap_8h_html_abb3efaa08e2b1e9423bbbd5e3d9d2acc"><div class="ttname"><a href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a></div><div class="ttdeci">size_t ast_heap_size(struct ast_heap *h)</div><div class="ttdoc">Get the current size of a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00276">heap.c:276</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="structast__sched__context_html_ac5028ea4f5c5ef2ef4d037ef54dd0942"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#ac5028ea4f5c5ef2ef4d037ef54dd0942">ast_sched_context::highwater</a></div><div class="ttdeci">unsigned int highwater</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00112">sched.c:112</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9c3d54f142eee0bad110fbb825c0787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c3d54f142eee0bad110fbb825c0787">&#9670;&nbsp;</a></span>ast_sched_runq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_runq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the queue. </p>
<p>Run the queue, executing all callbacks which need to be performed at this time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Scheduling context to run </td></tr>
    <tr><td class="paramname">con</td><td>context to act upon</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the number of events processed.</dd></dl>
<p>Runs the queue. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00755">755</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00267">ast_heap_peek()</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00262">ast_heap_pop()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00226">ast_tv()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l02283">ast_tvadd()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00128">ast_tvcmp()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00092">sched::callback</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00098">sched::cond</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00118">ast_sched_context::currently_executing</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00091">sched::data</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00036">DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00100">sched::deleted</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00120">ast_sched_context::executing_thread_id</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00089">sched::resched</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00358">sched_release()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00488">sched_settime()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00458">schedule()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00090">sched::variable</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00080">sched::when</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00107">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l03903">do_cdr()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l03818">do_monitor()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04119">do_monitor_headset()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00261">do_refresh()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l03556">handle_speechrecognize()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03528">misdn_tasks_thread_func()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l02194">network_thread()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l04683">reload_config()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00132">sched_run()</a>, <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00700">speech_background()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35708">unload_module()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l00644">wait_for_winner()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>
<div class="fragment"><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *current;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="keyword">struct </span>timeval when;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="keywordtype">int</span> numevents;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;ast_sched_runq()\n&quot;</span>));</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   when = <a class="code" href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a>(0, 1000));</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">for</span> (numevents = 0; (current = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, 1)); numevents++) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">/* schedule all events which are going to expire within 1ms.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">       * We only care about millisecond accuracy anyway, so this will</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">       * help us get more than one event at one time if they are very</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">       * close together.</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#a6daa33e2052acd094bb63e78aba29733">ast_tvcmp</a>(current-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, when) != -1) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      current = <a class="code" href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">       * At this point, the schedule queue is still intact.  We</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">       * have removed the first event and the rest is still there,</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">       * so it&#39;s permissible for the callback to add new events, but</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">       * trying to delete itself won&#39;t work because it isn&#39;t in</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">       * the schedule queue.  If that&#39;s what it wants to do, it</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">       * should return 0.</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a> = current;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a770d0c970dd51cbca2e72b48a46d50d6">executing_thread_id</a> = pthread_self();</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      res = current-&gt;<a class="code" href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">callback</a>(current-&gt;<a class="code" href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">data</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">currently_executing</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;current-&gt;<a class="code" href="../../d0/da0/structsched.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">if</span> (res &amp;&amp; !current-&gt;<a class="code" href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">deleted</a>) {</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">          * If they return non-zero, we should schedule them to be</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">          * run again.</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;         <a class="code" href="../../db/dbe/sched_8c.html#a73a5b22ec6c9948e4b8575453fdb1ca6">sched_settime</a>(&amp;current-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, current-&gt;<a class="code" href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">variable</a> ? res : current-&gt;<a class="code" href="../../d0/da0/structsched.html#a778ab73c44615a00697f70c5adcb058b">resched</a>);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;         <a class="code" href="../../db/dbe/sched_8c.html#af8ecda7e1fff722c5db4e846f9655f6d">schedule</a>(con, current);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         <span class="comment">/* No longer needed, so release it */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         <a class="code" href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a>(con, current);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   <span class="keywordflow">return</span> numevents;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;}</div><div class="ttc" id="structsched_html_aa1c771eb863a70914d679a423d35d016"><div class="ttname"><a href="../../d0/da0/structsched.html#aa1c771eb863a70914d679a423d35d016">sched::deleted</a></div><div class="ttdeci">unsigned int deleted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00100">sched.c:100</a></div></div>
<div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="sched_8c_html_a73a5b22ec6c9948e4b8575453fdb1ca6"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a73a5b22ec6c9948e4b8575453fdb1ca6">sched_settime</a></div><div class="ttdeci">static void sched_settime(struct timeval *t, int when)</div><div class="ttdoc">given the last event *tv and the offset in milliseconds &amp;#39;when&amp;#39;, computes the next value...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00488">sched.c:488</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="heap_8h_html_ad56625488a481df852f0b13d58b15a93"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a></div><div class="ttdeci">void * ast_heap_pop(struct ast_heap *h)</div><div class="ttdoc">Pop the max element off of the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00262">heap.c:262</a></div></div>
<div class="ttc" id="structsched_html_a778ab73c44615a00697f70c5adcb058b"><div class="ttname"><a href="../../d0/da0/structsched.html#a778ab73c44615a00697f70c5adcb058b">sched::resched</a></div><div class="ttdeci">int resched</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00089">sched.c:89</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structast__sched__context_html_a770d0c970dd51cbca2e72b48a46d50d6"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a770d0c970dd51cbca2e72b48a46d50d6">ast_sched_context::executing_thread_id</a></div><div class="ttdeci">pthread_t executing_thread_id</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00120">sched.c:120</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="sched_8c_html_af8ecda7e1fff722c5db4e846f9655f6d"><div class="ttname"><a href="../../db/dbe/sched_8c.html#af8ecda7e1fff722c5db4e846f9655f6d">schedule</a></div><div class="ttdeci">static void schedule(struct ast_sched_context *con, struct sched *s)</div><div class="ttdoc">Take a sched structure and put it in the queue, such that the soonest event is first in the list...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00458">sched.c:458</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="sched_8c_html_a9734f4bd9944c04f548c5edd870268e6"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a9734f4bd9944c04f548c5edd870268e6">sched_release</a></div><div class="ttdeci">static void sched_release(struct ast_sched_context *con, struct sched *tmp)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00358">sched.c:358</a></div></div>
<div class="ttc" id="time_8h_html_a6daa33e2052acd094bb63e78aba29733"><div class="ttname"><a href="../../de/df7/time_8h.html#a6daa33e2052acd094bb63e78aba29733">ast_tvcmp</a></div><div class="ttdeci">int ast_tvcmp(struct timeval _a, struct timeval _b)</div><div class="ttdoc">Compres two struct timeval instances returning -1, 0, 1 if the first arg is smaller, equal or greater to the second. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00128">time.h:128</a></div></div>
<div class="ttc" id="time_8h_html_a97e1bb8fbd7a103212789e87e7ed6073"><div class="ttname"><a href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a></div><div class="ttdeci">struct timeval ast_tvadd(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the sum of two timevals a + b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02283">extconf.c:2283</a></div></div>
<div class="ttc" id="structsched_html_a0d49d74db4c035719c3867723cf7e779"><div class="ttname"><a href="../../d0/da0/structsched.html#a0d49d74db4c035719c3867723cf7e779">sched::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00091">sched.c:91</a></div></div>
<div class="ttc" id="structast__sched__context_html_ac9d11754cea7df5643c4fccab82bf045"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#ac9d11754cea7df5643c4fccab82bf045">ast_sched_context::currently_executing</a></div><div class="ttdeci">struct sched * currently_executing</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00118">sched.c:118</a></div></div>
<div class="ttc" id="structsched_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d0/da0/structsched.html#a1c7181c39f99ee801943a0d0aa9872b9">sched::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00098">sched.c:98</a></div></div>
<div class="ttc" id="time_8h_html_aebf04439f206cc509472ce4b6da48a5a"><div class="ttname"><a href="../../de/df7/time_8h.html#aebf04439f206cc509472ce4b6da48a5a">ast_tv</a></div><div class="ttdeci">struct timeval ast_tv(ast_time_t sec, ast_suseconds_t usec)</div><div class="ttdoc">Returns a timeval from sec, usec. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00226">time.h:226</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="sched_8c_html_a8a979668ecb044c9ac0e5017107f1d52"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a></div><div class="ttdeci">#define DEBUG(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00036">sched.c:36</a></div></div>
<div class="ttc" id="structsched_html_ac2bb0fc1fabbeabad94c3b726bd708bc"><div class="ttname"><a href="../../d0/da0/structsched.html#ac2bb0fc1fabbeabad94c3b726bd708bc">sched::variable</a></div><div class="ttdeci">int variable</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00090">sched.c:90</a></div></div>
<div class="ttc" id="structsched_html_ac58274e87a13e59fcd66d9de81261800"><div class="ttname"><a href="../../d0/da0/structsched.html#ac58274e87a13e59fcd66d9de81261800">sched::callback</a></div><div class="ttdeci">ast_sched_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00092">sched.c:92</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ae97d1549b62cfbfc78bd92efe48005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ae97d1549b62cfbfc78bd92efe48005">&#9670;&nbsp;</a></span>ast_sched_start_thread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_start_thread </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start a thread for processing scheduler entries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>the scheduler context this thread will manage</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">non-zero</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00195">195</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00199">ast_cond_init</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00567">ast_pthread_create_background</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00066">AST_PTHREADT_NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00105">sched_thread::cond</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00132">sched_run()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00116">ast_sched_context::sched_thread</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00173">sched_thread_destroy()</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00104">sched_thread::thread</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01260">ast_sip_initialize_distributor()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00614">ast_sip_initialize_scheduler()</a>, <a class="el" href="../../da/db9/pjsip__transport__management_8c_source.html#l00372">ast_sip_initialize_transport_management()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00614">dns_core_init()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04653">load_module()</a>, and <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00233">stun_start_monitor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/ddd/structsched__thread.html">sched_thread</a> *st;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordflow">if</span> (con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Thread already started on this scheduler context\n&quot;</span>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keywordflow">if</span> (!(st = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*st)))) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;st-&gt;<a class="code" href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   st-&gt;<a class="code" href="../../d7/ddd/structsched__thread.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">sched_thread</a> = st;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a595e2f8aa398f4bd21e381c3211235fe">ast_pthread_create_background</a>(&amp;st-&gt;<a class="code" href="../../d7/ddd/structsched__thread.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../db/dbe/sched_8c.html#a451b6df83f02452a51f3c5c637f2e514">sched_run</a>, con)) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create scheduler thread\n&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="../../db/dbe/sched_8c.html#a38faaa195e38aef4c33481ac36541d64">sched_thread_destroy</a>(con);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div><div class="ttc" id="structsched__thread_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../d7/ddd/structsched__thread.html#a01f75a9ad916f63a94e06a27635ba278">sched_thread::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00104">sched.c:104</a></div></div>
<div class="ttc" id="sched_8c_html_a451b6df83f02452a51f3c5c637f2e514"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a451b6df83f02452a51f3c5c637f2e514">sched_run</a></div><div class="ttdeci">static void * sched_run(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00132">sched.c:132</a></div></div>
<div class="ttc" id="structast__sched__context_html_a749ecaa5dfc98e211e17735e072c49d2"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#a749ecaa5dfc98e211e17735e072c49d2">ast_sched_context::sched_thread</a></div><div class="ttdeci">struct sched_thread * sched_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00116">sched.c:116</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="sched_8c_html_a38faaa195e38aef4c33481ac36541d64"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a38faaa195e38aef4c33481ac36541d64">sched_thread_destroy</a></div><div class="ttdeci">static void sched_thread_destroy(struct ast_sched_context *con)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00173">sched.c:173</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a595e2f8aa398f4bd21e381c3211235fe"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a595e2f8aa398f4bd21e381c3211235fe">ast_pthread_create_background</a></div><div class="ttdeci">#define ast_pthread_create_background(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00567">utils.h:567</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="lock_8h_html_a6009440c7a72f8e2e3b1ec97641ad160"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a></div><div class="ttdeci">#define AST_PTHREADT_NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00066">lock.h:66</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structsched__thread_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d7/ddd/structsched__thread.html#a1c7181c39f99ee801943a0d0aa9872b9">sched_thread::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00105">sched.c:105</a></div></div>
<div class="ttc" id="structsched__thread_html"><div class="ttname"><a href="../../d7/ddd/structsched__thread.html">sched_thread</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00103">sched.c:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af13fcd6652b8dcafae35c2fa35e80a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13fcd6652b8dcafae35c2fa35e80a8d">&#9670;&nbsp;</a></span>ast_sched_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sched_wait </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines number of seconds until the next outstanding event to take place. </p>
<p>Determine the number of seconds until the next outstanding event should take place, and return the number of milliseconds until it needs to be run. This value is perfect for passing to the poll call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>context to act upon</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns "-1" if there is nothing there are no scheduled events (and thus the poll should not timeout)</dd></dl>
<p>Determines number of seconds until the next outstanding event to take place. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00431">431</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/d29/heap_8c_source.html#l00267">ast_heap_peek()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00098">ast_tvdiff_ms()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00036">DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00115">ast_sched_context::sched_heap</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00080">sched::when</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/df9/test__sched_8c_source.html#l00107">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l03903">do_cdr()</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l03818">do_monitor()</a>, <a class="el" href="../../d3/d51/chan__mobile_8c_source.html#l04119">do_monitor_headset()</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00261">do_refresh()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l03556">handle_speechrecognize()</a>, <a class="el" href="../../d7/d9b/chan__misdn_8c_source.html#l03528">misdn_tasks_thread_func()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l02194">network_thread()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00132">sched_run()</a>, <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00700">speech_background()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l00644">wait_for_winner()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordtype">int</span> ms;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *s;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;ast_sched_wait()\n&quot;</span>));</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="keywordflow">if</span> ((s = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">sched_heap</a>, 1))) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      ms = <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(s-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>, <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>());</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (ms &lt; 0) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         ms = 0;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      ms = -1;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">return</span> ms;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="structast__sched__context_html_afb2936780a5abba63b413db727f6d566"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#afb2936780a5abba63b413db727f6d566">ast_sched_context::sched_heap</a></div><div class="ttdeci">struct ast_heap * sched_heap</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00115">sched.c:115</a></div></div>
<div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="sched_8c_html_a8a979668ecb044c9ac0e5017107f1d52"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a></div><div class="ttdeci">#define DEBUG(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00036">sched.c:36</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4abeb1df2ba7501f933a23dddad0f9cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4abeb1df2ba7501f933a23dddad0f9cb">&#9670;&nbsp;</a></span>ast_sched_when()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ast_sched_when </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of seconds before an event takes place. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>Context to use </td></tr>
    <tr><td class="paramname">id</td><td>Id to dump </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/dbe/sched_8c_source.html#l00814">814</a> of file <a class="el" href="../../db/dbe/sched_8c_source.html">sched.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00036">DEBUG</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00110">ast_sched_context::lock</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00570">sched_find()</a>, and <a class="el" href="../../db/dbe/sched_8c_source.html#l00080">sched::when</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l21181">_sip_show_peer()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04145">handle_cli_status()</a>, and <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l16961">parse_register_contact()</a>.</p>
<div class="fragment"><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;{</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da0/structsched.html">sched</a> *s;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <span class="keywordtype">long</span> secs = -1;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <a class="code" href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;ast_sched_when()\n&quot;</span>));</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   s = <a class="code" href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a>(con, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      secs = s-&gt;<a class="code" href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">when</a>.tv_sec - now.tv_sec;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;con-&gt;<a class="code" href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="keywordflow">return</span> secs;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div><div class="ttc" id="structsched_html"><div class="ttname"><a href="../../d0/da0/structsched.html">sched</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00076">sched.c:76</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="sched_8c_html_a7dc4eeb65fd9839673694aad94c4e58a"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a7dc4eeb65fd9839673694aad94c4e58a">sched_find</a></div><div class="ttdeci">static struct sched * sched_find(struct ast_sched_context *con, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00570">sched.c:570</a></div></div>
<div class="ttc" id="structsched_html_a9c0783ff5b989460d3d42460fd182f67"><div class="ttname"><a href="../../d0/da0/structsched.html#a9c0783ff5b989460d3d42460fd182f67">sched::when</a></div><div class="ttdeci">struct timeval when</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00080">sched.c:80</a></div></div>
<div class="ttc" id="structast__sched__context_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html#adf04f66344e3fb0a6f6a69bf39d19902">ast_sched_context::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00110">sched.c:110</a></div></div>
<div class="ttc" id="sched_8c_html_a8a979668ecb044c9ac0e5017107f1d52"><div class="ttname"><a href="../../db/dbe/sched_8c.html#a8a979668ecb044c9ac0e5017107f1d52">DEBUG</a></div><div class="ttdeci">#define DEBUG(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00036">sched.c:36</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:45 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
