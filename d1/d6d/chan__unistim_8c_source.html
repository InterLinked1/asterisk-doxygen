<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: chan_unistim.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_9662a6a166de1dda18179da17db0f05a.html">channels</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">chan_unistim.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d6d/chan__unistim_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * UNISTIM channel driver for asterisk</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Copyright (C) 2005 - 2007, Cedric Hans</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Cedric Hans &lt;cedric.hans@mlkj.net&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Asterisk 1.4 patch by Peter Be</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * \file</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * \brief chan_unistim channel driver for Asterisk</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * \author Cedric Hans &lt;cedric.hans@mlkj.net&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * Unistim (Unified Networks IP Stimulus) channel driver</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * for Nortel i2002, i2004 and i2050</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * \ingroup channel_drivers</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   &lt;support_level&gt;extended&lt;/support_level&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#if defined(__CYGWIN__) || defined(__NetBSD__)</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * cygwin headers are partly inconsistent. struct iovec is defined in sys/uio.h</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * which is not included by default by sys/socket.h - in_pktinfo is defined in</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * w32api/ws2tcpip.h but this probably has compatibility problems with sys/socket.h</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * So for the time being we simply disable HAVE_PKTINFO when building under cygwin.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *    This should be done in some common header, but for now this is the only file</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * using iovec and in_pktinfo so it suffices to apply the fix here.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#ifdef HAVE_PKTINFO</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#undef HAVE_PKTINFO</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* __CYGWIN__ || __NetBSD__ */</span><span class="preprocessor"></span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/df2/paths_8h.html">asterisk/paths.h</a>&quot;</span>   <span class="comment">/* ast_config_AST_LOG_DIR used in (too ?) many places */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d94/network_8h.html">asterisk/network.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7b/channel_8h.html">asterisk/channel.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html">asterisk/config.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dde/rtp__engine_8h.html">asterisk/rtp_engine.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d1e/unaligned_8h.html">asterisk/unaligned.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/df1/netsock2_8h.html">asterisk/netsock2.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d59/acl_8h.html">asterisk/acl.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/callerid_8h.html">asterisk/callerid.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html">asterisk/app.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d33/mwi_8h.html">asterisk/mwi.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d07/musiconhold_8h.html">asterisk/musiconhold.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/da3/causes_8h.html">asterisk/causes.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d0f/indications_8h.html">asterisk/indications.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dbc/pickup_8h.html">asterisk/pickup.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da5/astobj2_8h.html">asterisk/astobj2.h</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d4a/astdb_8h.html">asterisk/astdb.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html">asterisk/features_config.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d56/bridge_8h.html">asterisk/bridge.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d4a/stasis__channels_8h.html">asterisk/stasis_channels.h</a>&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d1c/format__cache_8h.html">asterisk/format_cache.h</a>&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a777f3eee179c21b6e4093e98b720bd8e">   83</a></span>&#160;<span class="preprocessor">#define DEFAULTCONTEXT    &quot;default&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a51f7454e597b6aeff9686f0551866219">   84</a></span>&#160;<span class="preprocessor">#define DEFAULTCALLERID  &quot;Unknown&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8c8112dd258fef6c1ac58343f42aa3db">   85</a></span>&#160;<span class="preprocessor">#define DEFAULTCALLERNAME       &quot; &quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae64dbc971c1418bf50d13f390b26c20c">   86</a></span>&#160;<span class="preprocessor">#define DEFAULTHEIGHT    3</span></div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">   87</a></span>&#160;<span class="preprocessor">#define USTM_LOG_DIR     &quot;unistimHistory&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad4e1b5f816e1bbf143f8920cd2d11cd8">   88</a></span>&#160;<span class="preprocessor">#define USTM_LANG_DIR       &quot;unistimLang&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/*! Size of the transmit buffer */</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7244ab798f58214294b580ca0bb48552">   91</a></span>&#160;<span class="preprocessor">#define MAX_BUF_SIZE     64</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">/*! Number of slots for the transmit queue */</span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">   93</a></span>&#160;<span class="preprocessor">#define MAX_BUF_NUMBER    150</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/*! Number of digits displayed on screen */</span></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad5c32877bf1a61ac2c2c05ca90b41a15">   95</a></span>&#160;<span class="preprocessor">#define MAX_SCREEN_NUMBER   15</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/*! Length of month label size */</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a06aab1370b612f1b03d2e55f8a33c0f1">   97</a></span>&#160;<span class="preprocessor">#define MONTH_LABEL_SIZE 3</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">/*! Try x times before removing the phone */</span></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aab4f7f5bd236a41e188c6b46e9b1d535">   99</a></span>&#160;<span class="preprocessor">#define NB_MAX_RETRANSMIT       8</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/*! Nb of milliseconds waited when no events are scheduled */</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5a69b56bd6aaac508e7be719b487a804">  101</a></span>&#160;<span class="preprocessor">#define IDLE_WAIT        1000</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/*! Wait x milliseconds before resending a packet */</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">  103</a></span>&#160;<span class="preprocessor">#define RETRANSMIT_TIMER   2000</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/*! How often the mailbox is checked for new messages */</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2935cf6fc27803112f358fd6da9d13ae">  105</a></span>&#160;<span class="preprocessor">#define TIMER_MWI        5000</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">/*! Timeout value for entered number being dialed */</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab0650a3e8232535ccd26d28b9957bc6c">  107</a></span>&#160;<span class="preprocessor">#define DEFAULT_INTERDIGIT_TIMER 4000</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/*! Not used */</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a833a6a7242f366ed7edcc08c0a415639">  110</a></span>&#160;<span class="preprocessor">#define DEFAULT_CODEC      0x00</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a72adc862c84ef019effe055d5f12d9c6">  111</a></span>&#160;<span class="preprocessor">#define SIZE_PAGE        4096</span></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a59d73f6a31546fd8a60b6e3939ba747c">  112</a></span>&#160;<span class="preprocessor">#define DEVICE_NAME_LEN  16</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8c9568e97903db39b211a5fef52cf39d">  113</a></span>&#160;<span class="preprocessor">#define AST_CONFIG_MAX_PATH     255</span></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">  114</a></span>&#160;<span class="preprocessor">#define MAX_ENTRY_LOG      30</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">  116</a></span>&#160;<span class="preprocessor">#define SUB_REAL     0</span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">  117</a></span>&#160;<span class="preprocessor">#define SUB_RING                1</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">  118</a></span>&#160;<span class="preprocessor">#define SUB_THREEWAY            2</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae374c5efe870e75570cae4630fd44954">  120</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae374c5efe870e75570cae4630fd44954">global_cap</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479d">  122</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479d">autoprovision</a> {</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">  123</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">AUTOPROVISIONING_NO</a> = 0,</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12">  124</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12">AUTOPROVISIONING_YES</a>,</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">  125</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;};</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8">  128</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8">autoprov_extn</a> {<span class="comment"></span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">   /*! Do not create an extension into the default dialplan */</span></div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">  130</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">EXTENSION_NONE</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">   /*! Prompt user for an extension number and register it */</span></div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">  132</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>,<span class="comment"></span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">   /*! Register an extension with the line=&gt; value */</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd">  134</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd">EXTENSION_LINE</a>,<span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">   /*! Used with AUTOPROVISIONING_TN */</span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">  136</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;};</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">  138</a></span>&#160;<span class="preprocessor">#define OUTPUT_HANDSET    0xC0</span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">  139</a></span>&#160;<span class="preprocessor">#define OUTPUT_HEADPHONE   0xC1</span></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">  140</a></span>&#160;<span class="preprocessor">#define OUTPUT_SPEAKER    0xC2</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a29058a32cb27a6c7e8eec1a99dfb8ecc">  142</a></span>&#160;<span class="preprocessor">#define VOLUME_LOW         0x01</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa30bc97cb7b0b5dc8f53986da75558e2">  143</a></span>&#160;<span class="preprocessor">#define VOLUME_LOW_SPEAKER      0x03</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#adc2c9ed685ffde62c026c2a9afa7dcef">  144</a></span>&#160;<span class="preprocessor">#define VOLUME_NORMAL      0x02</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad06d85ecc2dbce66c689219c5b29f667">  145</a></span>&#160;<span class="preprocessor">#define VOLUME_INSANELY_LOUD    0x07</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">  147</a></span>&#160;<span class="preprocessor">#define MUTE_OFF     0x00</span></div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">  148</a></span>&#160;<span class="preprocessor">#define MUTE_ON       0xFF</span></div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a109d3bab32b2bea03e2bafd9ab87b00f">  149</a></span>&#160;<span class="preprocessor">#define MUTE_ON_DISCRET  0xCE</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">  151</a></span>&#160;<span class="preprocessor">#define LED_BAR_OFF        0x00 </span><span class="comment">/* bar off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a94a931f0f31df959b9f33a5f294dc99f">  152</a></span>&#160;<span class="preprocessor">#define LED_BAR_ON         0x01 </span><span class="comment">/* bar on */</span><span class="preprocessor"></span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae5a638bfbff824b2a3acdd2f33db417e">  153</a></span>&#160;<span class="preprocessor">#define LED_BAR_P2         0x02 </span><span class="comment">/* bar 1s on/1s */</span><span class="preprocessor"></span></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad154d74f960b02e5382e994a5604d208">  154</a></span>&#160;<span class="preprocessor">#define LED_BAR_P3         0x03 </span><span class="comment">/* bar 2.5s on/0.5s off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af4c854b76ab58af071350b8ca775898b">  155</a></span>&#160;<span class="preprocessor">#define LED_BAR_P4         0x04 </span><span class="comment">/* bar 0.6s on/0.3s off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8452e1b6a2391592fdd61dafc34f1201">  156</a></span>&#160;<span class="preprocessor">#define LED_BAR_P5         0x05 </span><span class="comment">/* bar 0.5s on/0.5s off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7cc8c9f9ca34c564c11e8aa6dd9ef1b6">  157</a></span>&#160;<span class="preprocessor">#define LED_BAR_P6         0x06 </span><span class="comment">/* bar 2s on/0.5s off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4afc6ea844ee9e47f8f4740ff5a88b76">  158</a></span>&#160;<span class="preprocessor">#define LED_BAR_P7         0x07 </span><span class="comment">/* bar off */</span><span class="preprocessor"></span></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">  159</a></span>&#160;<span class="preprocessor">#define LED_SPEAKER_OFF       0x08</span></div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a48717a695a6adae245071375c4b0408f">  160</a></span>&#160;<span class="preprocessor">#define LED_SPEAKER_ON        0x09</span></div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">  161</a></span>&#160;<span class="preprocessor">#define LED_HEADPHONE_OFF     0x010</span></div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4e0473d5c56ec814c90ce680847e960c">  162</a></span>&#160;<span class="preprocessor">#define LED_HEADPHONE_ON      0x011</span></div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a741a9726b536ff19cd1c974464da4d28">  163</a></span>&#160;<span class="preprocessor">#define LED_MUTE_OFF       0x018</span></div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a321595f065c4787f1bd0828b348ac4f5">  164</a></span>&#160;<span class="preprocessor">#define LED_MUTE_ON        0x019</span></div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a55919ab1578e89f5a00fe27593b8a1e5">  165</a></span>&#160;<span class="preprocessor">#define LED_MUTE_BLINK        0x1A</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">  167</a></span>&#160;<span class="preprocessor">#define SIZE_HEADER       6</span></div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a097fc3021da243a78e87c7cd12bb6a8d">  168</a></span>&#160;<span class="preprocessor">#define SIZE_MAC_ADDR      17</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">  169</a></span>&#160;<span class="preprocessor">#define TEXT_LENGTH_MAX  24</span></div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">  170</a></span>&#160;<span class="preprocessor">#define TEXT_LINE0         0x00</span></div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">  171</a></span>&#160;<span class="preprocessor">#define TEXT_LINE1         0x20</span></div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">  172</a></span>&#160;<span class="preprocessor">#define TEXT_LINE2         0x40</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">  173</a></span>&#160;<span class="preprocessor">#define TEXT_NORMAL       0x05</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3119d68a678e50384f92a0021dec136f">  174</a></span>&#160;<span class="preprocessor">#define TEXT_INVERSE     0x25</span></div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a36cc0c8c725c461d6f25bd52cb56f3db">  175</a></span>&#160;<span class="preprocessor">#define STATUS_LENGTH_MAX       28</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">  177</a></span>&#160;<span class="preprocessor">#define FAV_ICON_NONE         0x00</span></div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a22395c4b2d13ce2b6d38da499b3c163e">  178</a></span>&#160;<span class="preprocessor">#define FAV_ICON_ONHOOK_BLACK    0x20</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae21cc9bab85d7814109cc064f9646615">  179</a></span>&#160;<span class="preprocessor">#define FAV_ICON_ONHOOK_WHITE    0x21</span></div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4e999210eafaaa2ac9c550866ec34d2b">  180</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_ONHOOK_BLACK   0x22</span></div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a53dbe001ee80d35548add7dfa57b58f9">  181</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_ONHOOK_WHITE   0x23</span></div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">  182</a></span>&#160;<span class="preprocessor">#define FAV_ICON_OFFHOOK_BLACK     0x24</span></div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0755c89e60593825bf306716d69670cf">  183</a></span>&#160;<span class="preprocessor">#define FAV_ICON_OFFHOOK_WHITE     0x25</span></div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab7a1662ad66c828762decbf7beaebf01">  184</a></span>&#160;<span class="preprocessor">#define FAV_ICON_ONHOLD_BLACK    0x26</span></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af2cad083c5eae85c6fd39ebf2ee87fe7">  185</a></span>&#160;<span class="preprocessor">#define FAV_ICON_ONHOLD_WHITE    0x27</span></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa2849c9d8d410fd9a4c1c8ccd7cb1565">  186</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_OFFHOOK_BLACK  0x28</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0af39b8d6881effead3360bc39c6bdf8">  187</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_OFFHOOK_WHITE  0x29</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a877c878794c4d6ad265f3c6e94fecc1d">  188</a></span>&#160;<span class="preprocessor">#define FAV_ICON_PHONE_BLACK      0x2A</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7baaba91a34fd9650b13f0a798033fc7">  189</a></span>&#160;<span class="preprocessor">#define FAV_ICON_PHONE_WHITE      0x2B</span></div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5c438e031784d5c35d517872b5f6db64">  190</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_ONHOLD_BLACK   0x2C</span></div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac34993c1725db05a9f6af99afe77ade7">  191</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SPEAKER_ONHOLD_WHITE   0x2D</span></div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a69e634f5869dfcb04320125526a7769d">  192</a></span>&#160;<span class="preprocessor">#define FAV_ICON_HEADPHONES        0x2E</span></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab628eb33db043ed9fde8deca41fab802">  193</a></span>&#160;<span class="preprocessor">#define FAV_ICON_HEADPHONES_ONHOLD      0x2F</span></div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a089f883410820c0dc9c48f43b9e9d6f3">  194</a></span>&#160;<span class="preprocessor">#define FAV_ICON_HOME         0x30</span></div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aaf901db756d9282791225461673a01ad">  195</a></span>&#160;<span class="preprocessor">#define FAV_ICON_CITY         0x31</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3a4ac2b1b9cd94f383cdbe01da74acbc">  196</a></span>&#160;<span class="preprocessor">#define FAV_ICON_SHARP       0x32</span></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8528363c5ed897a3f4ddfcaf990090a6">  197</a></span>&#160;<span class="preprocessor">#define FAV_ICON_PAGER       0x33</span></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8711751e9c6743e11a3862de504cf65a">  198</a></span>&#160;<span class="preprocessor">#define FAV_ICON_CALL_CENTER      0x34</span></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6ac2ce16635fd0b40ad63a700a7b19bb">  199</a></span>&#160;<span class="preprocessor">#define FAV_ICON_FAX        0x35</span></div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab89d7b99513abc2c022d908ac14d6bc8">  200</a></span>&#160;<span class="preprocessor">#define FAV_ICON_MAILBOX      0x36</span></div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a77054ec039b7ddcce41bbd752cb54cd8">  201</a></span>&#160;<span class="preprocessor">#define FAV_ICON_REFLECT      0x37</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa02cd4d8d793756df6a959ca5265a556">  202</a></span>&#160;<span class="preprocessor">#define FAV_ICON_COMPUTER         0x38</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5975bb76d29e9c6a37e0006dca9a7d04">  203</a></span>&#160;<span class="preprocessor">#define FAV_ICON_FORWARD      0x39</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6fe8044cbccf10c0c082798de88b7641">  204</a></span>&#160;<span class="preprocessor">#define FAV_ICON_LOCKED     0x3A</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad14db994ce65f38096708d87b7663d8e">  205</a></span>&#160;<span class="preprocessor">#define FAV_ICON_TRASH       0x3B</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa201d269e2f63fda86d083ce54634aba">  206</a></span>&#160;<span class="preprocessor">#define FAV_ICON_INBOX       0x3C</span></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8a3a4f6003a1810e6ef885b2435e764d">  207</a></span>&#160;<span class="preprocessor">#define FAV_ICON_OUTBOX     0x3D</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#adb60956948cfb9b74e5df5331625ff29">  208</a></span>&#160;<span class="preprocessor">#define FAV_ICON_MEETING      0x3E</span></div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad037403eaadf0c4e114608730f0c3d26">  209</a></span>&#160;<span class="preprocessor">#define FAV_ICON_BOX        0x3F</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa453a7434dac6cfa107bddf8d253e7ac">  211</a></span>&#160;<span class="preprocessor">#define FAV_BLINK_FAST       0x20</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a279e2c56f8e7d134934fae508d620cc5">  212</a></span>&#160;<span class="preprocessor">#define FAV_BLINK_SLOW       0x40</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acf057faabb89a493df21ee8102d79076">  214</a></span>&#160;<span class="preprocessor">#define FAV_MAX_LENGTH       0x0A</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">  216</a></span>&#160;<span class="preprocessor">#define FAVNUM                    6</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0ce9df795a9c80e6bd83ed8935c80999">  217</a></span>&#160;<span class="preprocessor">#define EXPNUM                    24</span></div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">  218</a></span>&#160;<span class="preprocessor">#define FAV_LINE_ICON         FAV_ICON_ONHOOK_BLACK</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">  220</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a>(<span class="keywordtype">char</span> *unused, ...)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">/*! \brief Global jitterbuffer configuration - by default, jb is disabled</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"> *  \note Values shown here match the defaults shown in unistim.conf.sample */</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2d8d5920e90ccbad7832926becdadb29">  227</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dba/structast__jb__conf.html">ast_jb_conf</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a> =</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   .<a class="code" href="../../d7/dba/structast__jb__conf.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = 0,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   .max_size = 200,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   .resync_threshold = 1000,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   .impl = <span class="stringliteral">&quot;fixed&quot;</span>,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   .target_extra = 40,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;};</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">  235</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dba/structast__jb__conf.html">ast_jb_conf</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">/* #define DUMP_PACKET 1 */</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/* #define DEBUG_TIMER ast_verbose */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">  241</a></span>&#160;<span class="preprocessor">#define DEBUG_TIMER dummy</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/*! Enable verbose output. can also be set with the CLI */</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">  243</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a> = 0;</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">  244</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a>;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">  245</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479d">autoprovision</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">AUTOPROVISIONING_NO</a>;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">  246</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a>;</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">  247</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> = -1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a25a9305efab3b493ca2519562fcec3d5">  250</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25a9305efab3b493ca2519562fcec3d5">tos</a>;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1ecad4a80d0e6f5b8ec6ab4c44021d18">  251</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ecad4a80d0e6f5b8ec6ab4c44021d18">tos_audio</a>;</div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae91dad65f553f7afebe4af507803bc7f">  252</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a>;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3e2114722f6cb731593296a831290a7d">  253</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e2114722f6cb731593296a831290a7d">cos_audio</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;} <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a> = { 0, 0, 0, 0 };</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abda48311b6abe5a4dd8b6904ddde0a6d">  256</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d5/d55/structio__context.html">io_context</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abda48311b6abe5a4dd8b6904ddde0a6d">io</a>;</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a361b448e9abcfc301602a2573a662d3c">  257</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/de8/structast__sched__context.html">ast_sched_context</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a361b448e9abcfc301602a2573a662d3c">sched</a>;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">  258</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span>sockaddr_in <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a> = { 0, };</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">  259</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>; <span class="comment">/*! Receive buffer address */</span></div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">  260</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a> = 0;</div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">  261</a></span>&#160;<a class="code" href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*! This is the thread for the monitor which checks for input on the channels</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> * which are not currently in use.  */</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">  265</a></span>&#160;<span class="keyword">static</span> pthread_t <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">/*! Protect the monitoring thread, so only one process can kill or start it, and not</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *    when it&#39;s doing something critical. */</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">  269</a></span>&#160;<a class="code" href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);<span class="comment"></span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">/*! Protect the session list */</span></div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">  271</a></span>&#160;<a class="code" href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);<span class="comment"></span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">/*! Protect the device list */</span></div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">  273</a></span>&#160;<a class="code" href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ad">  275</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ad">phone_state</a> {</div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">  276</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a>,</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">  277</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>,</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">  278</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>,</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">  279</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>,</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">  280</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>,</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">  281</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a>,</div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">  282</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>,</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">  283</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a>,</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">  284</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a>,</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">  285</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>,</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">  286</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">STATE_CLEANING</a>,</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">  287</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">STATE_HISTORY</a></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;};</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693d">  290</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693d">handset_state</a> {</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">  291</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>,</div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">  292</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a>,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;};</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810">  295</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810">phone_key</a> {</div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">  296</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a> = 0x40,</div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a35bcc2bc85513df4f3897a9d64a9c51c">  297</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a35bcc2bc85513df4f3897a9d64a9c51c">KEY_1</a> = 0x41,</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2333d7c312aa98622c41e74c5d13e8de">  298</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2333d7c312aa98622c41e74c5d13e8de">KEY_2</a> = 0x42,</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aef054680a9be7da17d196e15aec894f8">  299</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aef054680a9be7da17d196e15aec894f8">KEY_3</a> = 0x43,</div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae9f20352b4ef69ae68b9ff44abadfd79">  300</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae9f20352b4ef69ae68b9ff44abadfd79">KEY_4</a> = 0x44,</div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aed864c0209ba46546ba112f6c36e0cc4">  301</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aed864c0209ba46546ba112f6c36e0cc4">KEY_5</a> = 0x45,</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2fe7fe99bcb0fd90bf4234be9e4ce5be">  302</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2fe7fe99bcb0fd90bf4234be9e4ce5be">KEY_6</a> = 0x46,</div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae78c88108d428cb8066e7a056195f489">  303</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae78c88108d428cb8066e7a056195f489">KEY_7</a> = 0x47,</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aab8917d426f9be27c95c0d3810006d7b">  304</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aab8917d426f9be27c95c0d3810006d7b">KEY_8</a> = 0x48,</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611">  305</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611">KEY_9</a> = 0x49,</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb">  306</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb">KEY_STAR</a> = 0x4a,</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">  307</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a> = 0x4b,</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">  308</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">KEY_UP</a> = 0x4c,</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">  309</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a> = 0x4d,</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6504370d9c6391e1a9da6a1a529b089d">  310</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6504370d9c6391e1a9da6a1a529b089d">KEY_RIGHT</a> = 0x4e,</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a612120b69c7dfd46086db7aaebdbcf65">  311</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a612120b69c7dfd46086db7aaebdbcf65">KEY_LEFT</a> = 0x4f,</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a06f07386f6a7b104969cefd3cdfd6201">  312</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a06f07386f6a7b104969cefd3cdfd6201">KEY_QUIT</a> = 0x50,</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ab6b8f3f14db11e378b2d11e2008ff791">  313</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ab6b8f3f14db11e378b2d11e2008ff791">KEY_COPY</a> = 0x51,</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">  314</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a> = 0x54,</div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">  315</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a> = 0x55,</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">  316</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a> = 0x56,</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">  317</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a> = 0x57,</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac4e3446f25095a6b0a6b29b275c675fb">  318</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac4e3446f25095a6b0a6b29b275c675fb">KEY_ONHOLD</a> = 0x5b,</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">  319</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a> = 0x5c,</div><div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aae15e6350cf0c536de2b3968941cb082">  320</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aae15e6350cf0c536de2b3968941cb082">KEY_MUTE</a> = 0x5d,</div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">  321</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a> = 0x5e,</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">  322</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a> = 0x5f,</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">  323</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a> = 0x60,</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">  324</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a> = 0x61,</div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">  325</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a> = 0x62,</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">  326</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a> = 0x63,</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">  327</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a> = 0x64,</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">  328</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a> = 0x65,</div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a5f2a6eb4fd018338d14d258623ed851c">  329</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a5f2a6eb4fd018338d14d258623ed851c">KEY_COMPUTR</a> = 0x7b,</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a867e7c497d29cd4f8f55a9011924469a">  330</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a867e7c497d29cd4f8f55a9011924469a">KEY_CONF</a> = 0x7c,</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082">  331</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082">KEY_SNDHIST</a> = 0x7d,</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031">  332</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031">KEY_RCVHIST</a> = 0x7e,</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a000510e0819e5e505b7b5abb53c7b4a5">  333</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a000510e0819e5e505b7b5abb53c7b4a5">KEY_INDEX</a> = 0x7f</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;};</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971">  336</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971">charset</a> {</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a6590815d4822784877fe529852565e7b">  337</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a6590815d4822784877fe529852565e7b">LANG_DEFAULT</a>,</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">  338</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">ISO_8859_1</a>,</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971af9312dd529fbb0d5abbd726b34d3f927">  339</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971af9312dd529fbb0d5abbd726b34d3f927">ISO_8859_2</a>,</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a330a758072a52c7ab6307cd9b87d4939">  340</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a330a758072a52c7ab6307cd9b87d4939">ISO_8859_4</a>,</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7">  341</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7">ISO_8859_5</a>,</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971ac5f9a649f6ce46a04ab887c56930ebee">  342</a></span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971ac5f9a649f6ce46a04ab887c56930ebee">ISO_2022_JP</a>,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;};</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">  345</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[] = { 697,  770,  852,  941 };</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">  346</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[] = { 1209, 1336, 1477, 1633 };</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="../../d7/d43/structwsabuf.html">  348</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d7/d43/structwsabuf.html">wsabuf</a> {</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">  349</a></span>&#160;   u_long <a class="code" href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">len</a>;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">  350</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;};</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html">  353</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> {</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">  354</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">  355</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>;      <span class="comment">/*! SUB_REAL, SUB_RING or SUB_THREEWAY */</span></div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">  356</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>; <span class="comment">/*! Asterisk channel used by the subchannel */</span></div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">  357</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;  <span class="comment">/*! Unistim line */</span></div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">  358</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> *<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>; <span class="comment">/*! RTP handle */</span></div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">  359</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>;         <span class="comment">/*! Softkey assigned */</span></div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">  360</a></span>&#160;   pthread_t <a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a>;    <span class="comment">/*! unistim_ss thread handle */</span></div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">  361</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a>;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">  362</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a>;         <span class="comment">/*! this subchannel holds someone */</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">  363</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a>;</div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">  364</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a>;</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">  365</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a>;             <span class="comment">/*!&lt; Music on hold in progress */</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="../../d0/dfe/structunistim__subchannel.html#a0ba5d8c9bed2aa7bbd05bc8b91ea556d">  366</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a>) list;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;};</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> * \todo Convert to stringfields</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html">  372</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> {</div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#adf04f66344e3fb0a6f6a69bf39d19902">  373</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d2/dbf/structunistim__line.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;</div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">  374</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>[80]; <span class="comment">/*! Like 200 */</span></div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">  375</a></span>&#160;   <span class="keywordtype">char</span> fullname[101]; <span class="comment">/*! Like USTM/200\@black */</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a78d4847658b695383d849efd12399b38">  376</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]; <span class="comment">/*! Extension where to start */</span></div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">  377</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]; <span class="comment">/*! CallerID Number */</span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">  378</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]; <span class="comment">/*! Mailbox for MWI */</span></div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#abc34958c9b03014779727e5ca61b93e5">  379</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#abc34958c9b03014779727e5ca61b93e5">musicclass</a>[<a class="code" href="../../d5/d7b/channel_8h.html#afb2ae2e53d6676f3ca44a98aa3f92a2c">MAX_MUSICCLASS</a>]; <span class="comment">/*! MusicOnHold class */</span></div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#af0f007b48a9c8cf0629428bd0483e0d1">  380</a></span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a641d81d0c5c8df99d43eff69aede3bfd">ast_group_t</a> <a class="code" href="../../d2/dbf/structunistim__line.html#af0f007b48a9c8cf0629428bd0483e0d1">callgroup</a>; <span class="comment">/*! Call group */</span></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#abc0651bcec68410023c036b7d8ec4d11">  381</a></span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a641d81d0c5c8df99d43eff69aede3bfd">ast_group_t</a> <a class="code" href="../../d2/dbf/structunistim__line.html#abc0651bcec68410023c036b7d8ec4d11">pickupgroup</a>; <span class="comment">/*! Pickup group */</span></div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#adfee50d07a98645d4d20b896ce03785a">  382</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d5/dff/chan__iax2_8c.html#adfee50d07a98645d4d20b896ce03785a">accountcode</a>[<a class="code" href="../../d5/d7b/channel_8h.html#aa5a0589e78ac9e010524872ca0a3cf49">AST_MAX_ACCOUNT_CODE</a>]; <span class="comment">/*! Account code (for billing) */</span></div><div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#ad2cfb0f821c065261382a9298bb5a16b">  383</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d2/dbf/structunistim__line.html#ad2cfb0f821c065261382a9298bb5a16b">amaflags</a>; <span class="comment">/*! AMA flags (for billing) */</span></div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">  384</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>; <span class="comment">/*! Codec supported */</span></div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">  385</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>[<a class="code" href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a>]; <span class="comment">/*! Parkinglot */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a1642c75e17632468d17bbf36f8c1e092">  386</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *<a class="code" href="../../d2/dbf/structunistim__line.html#a1642c75e17632468d17bbf36f8c1e092">next</a>;</div><div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">  387</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a>) list;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;};</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> * \brief A device containing one or more lines</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html">  394</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> {</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">  395</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">  396</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a>;        <span class="comment">/*!&lt; state of the receiver (see ReceiverState) */</span></div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">  397</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>;    <span class="comment">/*!&lt; size of the phone number */</span></div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">  398</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]; <span class="comment">/*!&lt; Context to start in */</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">  399</a></span>&#160;   <span class="keywordtype">char</span> phone_number[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];    <span class="comment">/*!&lt; the phone number entered by the user */</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">  400</a></span>&#160;   <span class="keywordtype">char</span> redial_number[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];  <span class="comment">/*!&lt; the last phone number entered by the user */</span></div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">  401</a></span>&#160;   <span class="keywordtype">char</span> <span class="keywordtype">id</span>[18];             <span class="comment">/*!&lt; mac address of the current phone in ascii */</span></div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">  402</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59d73f6a31546fd8a60b6e3939ba747c">DEVICE_NAME_LEN</a>];     <span class="comment">/*!&lt; name of the device */</span></div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ad3af117a28948d46d18d787129016d7e">  403</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#ad3af117a28948d46d18d787129016d7e">hasexp</a>;                          <span class="comment">/*!&lt; if device have expansion connected */</span></div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a48b276b04c93ca4b9625e4e6cfdf69fd">  404</a></span>&#160;   <span class="keywordtype">char</span> expsoftkeylabel[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0ce9df795a9c80e6bd83ed8935c80999">EXPNUM</a>][11];       <span class="comment">/*!&lt; soft key label */</span></div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">  405</a></span>&#160;   <span class="keywordtype">char</span> softkeylabel[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>][11];       <span class="comment">/*!&lt; soft key label */</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">  406</a></span>&#160;   <span class="keywordtype">char</span> softkeynumber[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>][<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];      <span class="comment">/*!&lt; number dialed when the soft key is pressed */</span></div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">  407</a></span>&#160;   <span class="keywordtype">char</span> softkeyicon[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>];      <span class="comment">/*!&lt; icon number */</span></div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">  408</a></span>&#160;   <span class="keywordtype">char</span> softkeydevice[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>][16];      <span class="comment">/*!&lt; name of the device monitored */</span></div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">  409</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *ssub[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>];</div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">  410</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *sline[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>];</div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">  411</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>];   <span class="comment">/*!&lt; pointer to the device monitored by this soft key */</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">  412</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#adf416dc058363e2fd5750c77e2d78bee">language</a>[<a class="code" href="../../d5/d7b/channel_8h.html#a9238c3318ae8d3bea2cbbe1d1e459eb7">MAX_LANGUAGE</a>];    <span class="comment">/*!&lt; Language for asterisk sounds */</span></div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">  413</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a>;                   <span class="comment">/*!&lt; The number of lines the phone can display */</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">  414</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">maintext0</a>[25];          <span class="comment">/*!&lt; when the phone is idle, display this string on line 0 */</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">  415</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>[25];          <span class="comment">/*!&lt; when the phone is idle, display this string on line 1 */</span></div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">  416</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">maintext2</a>[25];          <span class="comment">/*!&lt; when the phone is idle, display this string on line 2 */</span></div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">  417</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>[13];    <span class="comment">/*!&lt; title (text before date/time) */</span></div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">  418</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">datetimeformat</a>;     <span class="comment">/*!&lt; format used for displaying time/date */</span></div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">  419</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a>;           <span class="comment">/*!&lt; contrast */</span></div><div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">  420</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/dc0/pbx__dundi_8c.html#a03e72b5f331070bc01418a74af199eb9">country</a>[3];        <span class="comment">/*!&lt; country used for dial tone frequency */</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">  421</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d77/structast__tone__zone.html">ast_tone_zone</a> *<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>;         <span class="comment">/*!&lt; Tone zone for res_indications (ring, busy, congestion) */</span></div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a3c8138b16b5ca041bbbdc88e8316cba8">  422</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a>;       <span class="comment">/*!&lt; Ring volume */</span></div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aebc7c191314640b1006cd0f461a819fe">  423</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a>;         <span class="comment">/*!&lt; Ring melody */</span></div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a5292df700ff59a61858e21147a5fc7b6">  424</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a5292df700ff59a61858e21147a5fc7b6">cwvolume</a>;         <span class="comment">/*!&lt; Ring volume on call waiting */</span></div><div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aab68eaa12f597d4212c56694bb4ee020">  425</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#aab68eaa12f597d4212c56694bb4ee020">cwstyle</a>;        <span class="comment">/*!&lt; Ring melody on call waiting */</span></div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">  426</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">interdigit_timer</a>;      <span class="comment">/*!&lt; Interdigit timer for dialing number by timeout */</span></div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">  427</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a>;    <span class="comment">/*!&lt; DTMF playback duration */</span></div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">  428</a></span>&#160;   time_t <a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a>;     <span class="comment">/*!&lt; Timer used for dial by timeout */</span></div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">  429</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">rtp_port</a>;           <span class="comment">/*!&lt; RTP port used by the phone */</span></div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">  430</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a>;          <span class="comment">/*!&lt; Select the unistim data used to establish a RTP session */</span></div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a7ef42aa41fc6f1f39c513ceb034fe467">  431</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a7ef42aa41fc6f1f39c513ceb034fe467">status_method</a>;            <span class="comment">/*!&lt; Select the unistim packet used for sending status text */</span></div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">  432</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a>;            <span class="comment">/*!&lt; The current codec used to make calls */</span></div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">  433</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a>;        <span class="comment">/*!&lt; Number of call unanswered */</span></div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">  434</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">callhistory</a>;        <span class="comment">/*!&lt; Allowed to record call history */</span></div><div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a89ee76cd9909e38095ff9c5acf4df9db">  435</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a89ee76cd9909e38095ff9c5acf4df9db">sharp_dial</a>;          <span class="comment">/*!&lt; Execute Dial on &#39;#&#39; or not */</span></div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">  436</a></span>&#160;   <span class="keywordtype">char</span> lst_cid[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>];  <span class="comment">/*!&lt; Last callerID received */</span></div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ae1869e7c6a5d9af9022043731b551f3b">  437</a></span>&#160;   <span class="keywordtype">char</span> lst_cnm[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>];  <span class="comment">/*!&lt; Last callername recevied */</span></div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">  438</a></span>&#160;   <span class="keywordtype">char</span> call_forward[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];   <span class="comment">/*!&lt; Forward number */</span></div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">  439</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>;               <span class="comment">/*!&lt; Handset, headphone or speaker */</span></div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">  440</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">previous_output</a>;     <span class="comment">/*!&lt; Previous output */</span></div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">  441</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>;               <span class="comment">/*!&lt; Default volume */</span></div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">  442</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>;                           <span class="comment">/*!&lt; softkey selected */</span></div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">  443</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a>;            <span class="comment">/*!&lt; Microphone mode (audio tx) */</span></div><div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">  444</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a>;                                                   <span class="comment">/*! Used by MWI */</span></div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a8e02569adc3b742182f7c3249433237e">  445</a></span>&#160;   time_t <a class="code" href="../../d1/d66/structunistim__device.html#a8e02569adc3b742182f7c3249433237e">nextmsgcheck</a>;                                            <span class="comment">/*! Used by MWI */</span></div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ada540a5f25f7302dc1a3d17ccfa59b10">  446</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d66/structunistim__device.html#ada540a5f25f7302dc1a3d17ccfa59b10">nat</a>;             <span class="comment">/*!&lt; Used by the obscure ast_rtp_setnat */</span></div><div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">  447</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8">autoprov_extn</a> <a class="code" href="../../d0/d5a/structextension.html">extension</a>;   <span class="comment">/*!&lt; See ifdef EXTENSION for valid values */</span></div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">  448</a></span>&#160;   <span class="keywordtype">char</span> extension_number[11];      <span class="comment">/*!&lt; Extension number entered by the user */</span></div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">  449</a></span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">to_delete</a>;         <span class="comment">/*!&lt; Used in reload */</span></div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">  450</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/da1/structast__silence__generator.html">ast_silence_generator</a> *<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a>;</div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a18cca7613ac4f9c9b71785eae8c7441c">  451</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#acdb4f56da6b3071d02dcce20072852b0">AST_LIST_HEAD</a>(,<a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a>) subs; <span class="comment">/*!&lt; pointer to our current connection, channel... */</span></div><div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#acc8bbd31a510895d0da44a8f8c558c47">  452</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#acdb4f56da6b3071d02dcce20072852b0">AST_LIST_HEAD</a>(,<a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a>) <a class="code" href="../../d0/d80/chan__skinny_8c.html#af19bea0fea4bb4d017667827fe7b4970">lines</a>;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">  453</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d1d/structast__ha.html">ast_ha</a> *<a class="code" href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>;</div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">  454</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>;</div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">  455</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;} *<a class="code" href="../../dd/d5e/structdevices.html">devices</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html">  458</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> {</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">  459</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">  460</a></span>&#160;   <span class="keyword">struct </span>sockaddr_in sin;  <span class="comment">/*!&lt; IP address of the phone */</span></div><div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">  461</a></span>&#160;   <span class="keyword">struct </span>sockaddr_in sout;   <span class="comment">/*!&lt; IP address of server */</span></div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">  462</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;             <span class="comment">/*!&lt; time-out in ticks : resend packet if no ack was received before the timeout occured */</span></div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">  463</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a>;       <span class="comment">/*!&lt; sequence number for the next packet (when we receive a request) */</span></div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">  464</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>;      <span class="comment">/*!&lt; sequence number for the next packet (when we send a request) */</span></div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">  465</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>;    <span class="comment">/*!&lt; sequence number of the last ACK received */</span></div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">  466</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">tick_next_ping</a>;   <span class="comment">/*!&lt; time for the next ping */</span></div><div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">  467</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>;  <span class="comment">/*!&lt; number of a free slot */</span></div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a8879dd3a62f9fa2a85475b40587c3d77">  468</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a8879dd3a62f9fa2a85475b40587c3d77">nb_retransmit</a>;            <span class="comment">/*!&lt; number of retransmition */</span></div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">  469</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>;                 <span class="comment">/*!&lt; state of the phone (see phone_state) */</span></div><div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">  470</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>;     <span class="comment">/*!&lt; size of the buffer used to enter datas */</span></div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">  471</a></span>&#160;   <span class="keywordtype">char</span> buff_entry[16];     <span class="comment">/*!&lt; Buffer for temporary datas */</span></div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">  472</a></span>&#160;   <span class="keywordtype">char</span> macaddr[18];           <span class="comment">/*!&lt; mac address of the phone (not always available) */</span></div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a9ccf05acd1a39a2adc192e7453f69176">  473</a></span>&#160;   <span class="keywordtype">char</span> firmware[8];           <span class="comment">/*!&lt; firmware of the phone (not always available) */</span></div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">  474</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d43/structwsabuf.html">wsabuf</a> wsabufsend[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">MAX_BUF_NUMBER</a>];      <span class="comment">/*!&lt; Size of each paquet stored in the buffer array &amp; pointer to this buffer */</span></div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#a036407d71bff31da6c9b17ff9ff859c5">  475</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">MAX_BUF_NUMBER</a>][<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>];   <span class="comment">/*!&lt; Buffer array used to keep the lastest non-acked paquets */</span></div><div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">  476</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>;</div><div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">  477</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;} *<a class="code" href="../../d3/d0a/structsessions.html">sessions</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">/*! Store on screen phone menu item (label and handler function) */</span></div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="../../d3/df2/structunistim__menu__item.html">  481</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d3/df2/structunistim__menu__item.html">unistim_menu_item</a> {</div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="../../d3/df2/structunistim__menu__item.html#acf60de4c64d60c1b9449c056bc6bfcf7">  482</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d3/df2/structunistim__menu__item.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a>;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="../../d3/df2/structunistim__menu__item.html#a89f234133d3efe315836311cbf21c64b">  483</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/df2/structunistim__menu__item.html#a89f234133d3efe315836311cbf21c64b">state</a>;</div><div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="../../d3/df2/structunistim__menu__item.html#a96e1128adcd23704d9a18ad461119d85">  484</a></span>&#160;   void (*handle_option)(<span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;};</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">/*! Language item for currently existed translations */</span></div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="../../d1/d7e/structunistim__languages.html">  488</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d1/d7e/structunistim__languages.html">unistim_languages</a> {</div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="../../d1/d7e/structunistim__languages.html#acf60de4c64d60c1b9449c056bc6bfcf7">  489</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d1/d7e/structunistim__languages.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a>;</div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">  490</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">lang_short</a>;</div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">  491</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>;</div><div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">  492</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;};</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"> * \page Unistim datagram formats</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"> * Format of datagrams :</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"> * bytes 0 &amp; 1 : ffff for discovery packet, 0000 for everything else</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"> * byte 2 : sequence number (high part)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"> * byte 3 : sequence number (low part)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"> * byte 4 : 2 = ask question or send info, 1 = answer or ACK, 0 = retransmit request</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"> * byte 5 : direction, 1 = server to phone, 2 = phone to server arguments</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">  506</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">packet_rcv_discovery</a>[] =</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   { 0xff, 0xff, 0xff, 0xff, 0x02, 0x02, 0xff, 0xff, 0xff, 0xff, 0x9e, 0x03, 0x08 };</div><div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">  508</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>[] =</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   { 0x00, 0x00, <span class="comment">/*Initial Seq (2 bytes) */</span> 0x00, 0x00, 0x00, 0x01 };</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac763429f724ac4b2b2fb568e466001b3">  511</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac763429f724ac4b2b2fb568e466001b3">packet_recv_firm_version</a>[] =</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x9a, 0x0a, 0x02 };</div><div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a326ac5a010e5287349fb860ac6accc1b">  513</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a326ac5a010e5287349fb860ac6accc1b">packet_recv_it_type</a>[] =</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x9a, 0x04, 0x03 };</div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a01bd47c216c3d26eb96d07bc03b468bd">  515</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a01bd47c216c3d26eb96d07bc03b468bd">packet_recv_pressed_key</a>[] =</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x99, 0x04, 0x00 };</div><div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9b3644f4591bdac1f9302794b6211fb6">  517</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b3644f4591bdac1f9302794b6211fb6">packet_recv_pick_up</a>[] =</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x99, 0x03, 0x04 };</div><div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a88e009e2bd5d179615c0a6384db004fc">  519</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a88e009e2bd5d179615c0a6384db004fc">packet_recv_hangup</a>[] =</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x99, 0x03, 0x03 };</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae8c0cf3a8ca2a0b39e99e47ea59ceaa1">  521</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae8c0cf3a8ca2a0b39e99e47ea59ceaa1">packet_recv_r2</a>[] = { 0x00, 0x00, 0x00, 0x13, 0x96, 0x03, 0x03 };</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">/*! Expansion module (i2004 KEM) */</span></div><div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#afbdf3717d9b2c10cb2b20f77f8fdb797">  524</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbdf3717d9b2c10cb2b20f77f8fdb797">packet_recv_expansion_pressed_key</a>[] =</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   { 0x00, 0x00, 0x00, 0x13, 0x89, 0x04, 0x59 };</div><div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">  526</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">packet_send_expansion_next</a>[] = { 0x09, 0x03, 0x17 };</div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">  527</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">packet_send_expansion_icon</a>[] = { 0x09, 0x06, 0x59, 0x05, <span class="comment">/*pos */</span> 0x47, <span class="comment">/*icon */</span> 0x20 };      <span class="comment">/* display an icon in front of the text zone */</span></div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">  528</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">packet_send_expansion_text</a>[] = { 0x09, 0x0f, 0x57, 0x19, <span class="comment">/*pos */</span> 0x47, <span class="comment">/*text */</span> 0x20,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 <span class="comment">/*end_text */</span> };</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/*! TransportAdapter */</span></div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0fca4819ce3044be21fb24b818ae0b30">  533</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fca4819ce3044be21fb24b818ae0b30">packet_recv_resume_connection_with_server</a>[] =</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   { 0xff, 0xff, 0xff, 0xff, 0x9e, 0x03, 0x08 };</div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aded82877394efd5636b1b14ad4ba757e">  535</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aded82877394efd5636b1b14ad4ba757e">packet_recv_mac_addr</a>[] =</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   { 0xff, 0xff, 0xff, 0xff, 0x9a, 0x0d, 0x07 <span class="comment">/*MacAddr */</span>  };</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">  538</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">packet_send_date_time3</a>[] =</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   { 0x11, 0x09, 0x02, 0x02, <span class="comment">/*Month */</span> 0x05, <span class="comment">/*Day */</span> 0x06, <span class="comment">/*Hour */</span> 0x07,</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">/*Minutes */</span> 0x08, 0x32</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;};</div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">  542</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">packet_send_date_time</a>[] =</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   { 0x11, 0x09, 0x02, 0x0a, <span class="comment">/*Month */</span> 0x05, <span class="comment">/*Day */</span> 0x06, <span class="comment">/*Hour */</span> 0x07, <span class="comment">/*Minutes */</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;0x08, 0x32, 0x17, 0x04, 0x24, 0x07, 0x19,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   0x04, 0x07, 0x00, 0x19, 0x05, 0x09, 0x3e, 0x0f, 0x16, 0x05, 0x00, 0x80, 0x00, 0x1e,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      0x05, 0x12, 0x00, 0x78</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;};</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">  549</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">packet_send_no_ring</a>[] =</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   { 0x16, 0x04, 0x1a, 0x00, 0x16, 0x04, 0x11, 0x00 };</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">  551</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">packet_send_s4</a>[] =</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   { 0x16, 0x04, 0x1a, 0x00, 0x16, 0x04, 0x11, 0x00, 0x16, 0x06, 0x32, 0xdf, 0x00, 0xff,</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;0x16, 0x05, 0x1c, 0x00, 0x00, 0x17, 0x05,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   0x0b, 0x00, 0x00, 0x19, 0x04, 0x00, 0x00, 0x19, 0x04, 0x00, 0x08, 0x19, 0x04, 0x00,</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      0x10, 0x19, 0x04, 0x00, 0x18, 0x16, 0x05,</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   0x31, 0x00, 0x00, 0x16, 0x05, 0x04, 0x00, 0x00</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;};</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">  558</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">packet_send_call</a>[] =</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   { 0x16, 0x04, 0x1a, 0x00, 0x16, 0x04, 0x11, 0x00, 0x16, 0x06, 0x32, 0xdf,</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   0x00, 0xff, 0x16, 0x05, 0x1c, 0x00, 0x00, 0x16, 0x0a, 0x38, 0x00, 0x12, 0xca, 0x03,</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      0xc0, 0xc3, 0xc5, 0x16, 0x16, 0x30, 0x00,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   0x00, <span class="comment">/*codec */</span> 0x12, 0x12, <span class="comment">/* frames per packet */</span> 0x01, 0x5c, 0x00, <span class="comment">/*port RTP */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      0x0f, 0xa0, <span class="comment">/* port RTCP */</span> 0x9c, 0x41,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="comment">/*port RTP */</span> 0x0f, 0xa0, <span class="comment">/* port RTCP */</span> 0x9c, 0x41, <span class="comment">/* IP Address */</span> 0x0a, 0x01,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      0x16, 0x66</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;};</div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">  567</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">packet_send_stream_based_tone_off</a>[] =</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   { 0x16, 0x05, 0x1c, 0x00, 0x00 };</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">  570</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">packet_send_mute</a>[] = { 0x16, 0x05, 0x04, 0x00, 0x00 };</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#ifdef NOT_USED</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> packet_send_CloseAudioStreamRX[] = { 0x16, 0x05, 0x31, 0x00, 0xff };</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> packet_send_CloseAudioStreamTX[] = { 0x16, 0x05, 0x31, 0xff, 0x00 };</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">  575</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">packet_send_stream_based_tone_on</a>[] =</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   { 0x16, 0x06, 0x1b, 0x00, 0x00, 0x05 };</div><div class="line"><a name="l00577"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">  577</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">packet_send_stream_based_tone_single_freq</a>[] =</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   { 0x16, 0x06, 0x1d, 0x00, 0x01, 0xb8 };</div><div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">  579</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">packet_send_stream_based_tone_dual_freq</a>[] =</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   { 0x16, 0x08, 0x1d, 0x00, 0x01, 0xb8, 0x01, 0x5e };</div><div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">  581</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">packet_send_select_output</a>[] =</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   { 0x16, 0x06, 0x32, 0xc0, 0x01, 0x00 };</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">  584</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">packet_send_ring</a>[] =</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   { 0x16, 0x06, 0x32, 0xdf, 0x00, 0xff, 0x16, 0x05, 0x1c, 0x00, 0x00, 0x16,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   0x04, 0x1a, 0x01, 0x16, 0x05, 0x12, 0x13 <span class="comment">/* Ring type 10 to 17 */</span> , 0x18, 0x16, 0x04, 0x18,     <span class="comment">/* volume 00, 10, 20... */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   0x20, 0x16, 0x04, 0x10, 0x00</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;};</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">//static const unsigned char packet_send_end_call[] =</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">// { 0x16, 0x06, 0x32, 0xdf, 0x00, 0xff, 0x16, 0x05, 0x31, 0x00, 0x00, /* Headset LED off */ 0x19, 0x04, 0x00,</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">//0x10, /* Mute LED off */ 0x19, 0x04, 0x00, 0x18,/* Stream unmute */ 0x16, 0x05, 0x04, 0x00, 0x00, /* Query RTCP */ 0x16, 0x04, 0x37, 0x10 };</span></div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">  592</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">packet_send_end_call</a>[] =</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   { 0x16, 0x06, 0x32, 0xdf, 0x00, 0xff, 0x16, 0x05, 0x31, 0x00, 0x00, <span class="comment">/* Query RTCP */</span> 0x16, 0x04, 0x37, 0x10 };</div><div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">  594</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">packet_send_s9</a>[] =</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   { 0x16, 0x06, 0x32, 0xdf, 0x00, 0xff, 0x19, 0x04, 0x00, 0x10, 0x16, 0x05, 0x1c, 0x00,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;0x00 };</div><div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">  597</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">packet_send_rtp_packet_size</a>[] =</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   { 0x16, 0x08, 0x38, 0x00, 0x00, 0xe0, 0x00, 0xa0 };</div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">  599</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">packet_send_jitter_buffer_conf</a>[] =</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   { 0x16, 0x0e, 0x3a, 0x00, <span class="comment">/* jitter */</span> 0x02, <span class="comment">/* high water mark */</span> 0x04, 0x00, 0x00,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">/* early packet resync 2 bytes */</span> 0x3e, 0x80,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   0x00, 0x00, <span class="comment">/* late packet resync 2 bytes */</span> 0x3e, 0x80</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;};</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">/* Duration in ms div 2 (0x20 = 64ms, 0x08 = 16ms)</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">static unsigned char packet_send_StreamBasedToneCad[] =</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  { 0x16, 0x0a, 0x1e, 0x00, duration on  0x0a, duration off  0x0d, duration on 0x0a, duration off 0x0d, duration on 0x0a, duration off 0x2b }; */</span></div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">  608</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">packet_send_open_audio_stream_rx</a>[] =</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   { 0x16, 0x1a, 0x30, 0x00, 0xff, <span class="comment">/* Codec */</span> 0x00, 0x00, 0x01, 0x00, 0xb8, 0xb8, 0x0e,</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;0x0e, 0x01, <span class="comment">/* Port */</span> 0x14, 0x50, 0x00,</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   0x00, <span class="comment">/* Port */</span> 0x14, 0x50, 0x00, 0x00, <span class="comment">/* Dest IP */</span> 0x0a, 0x93, 0x69, 0x05</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;};</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">  613</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">packet_send_open_audio_stream_tx</a>[] =</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   { 0x16, 0x1a, 0x30, 0xff, 0x00, 0x00, <span class="comment">/* Codec */</span> 0x00, 0x01, 0x00, 0xb8, 0xb8, 0x0e,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;0x0e, 0x01, <span class="comment">/* Local port */</span> 0x14, 0x50,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   0x00, 0x00, <span class="comment">/* Rmt Port */</span> 0x14, 0x50, 0x00, 0x00, <span class="comment">/* Dest IP */</span> 0x0a, 0x93, 0x69, 0x05</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;};</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad13a5fa92094321a806cf334e9f77073">  619</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad13a5fa92094321a806cf334e9f77073">packet_send_open_audio_stream_rx3</a>[] =</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   { 0x16, 0x1a, 0x30, 0x00, 0xff, <span class="comment">/* Codec */</span> 0x00, 0x00, 0x02, 0x01, 0xb8, 0xb8, 0x06,</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;0x06, 0x81, <span class="comment">/* RTP Port */</span> 0x14, 0x50,</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">/* RTCP Port */</span> 0x14,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   0x51, <span class="comment">/* RTP Port */</span> 0x14, 0x50, <span class="comment">/* RTCP Port */</span> 0x00, 0x00, <span class="comment">/* Dest IP */</span> 0x0a, 0x93,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      0x69, 0x05</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;};</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9a202389ce76e2c9a3a6ec4883bacb6e">  626</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9a202389ce76e2c9a3a6ec4883bacb6e">packet_send_open_audio_stream_tx3</a>[] =</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   { 0x16, 0x1a, 0x30, 0xff, 0x00, 0x00, <span class="comment">/* Codec */</span> 0x00, 0x02, 0x01, 0xb8, 0xb8, 0x06,</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;0x06, 0x81, <span class="comment">/* RTP Local port */</span> 0x14, 0x50,</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">/* RTCP Port */</span> 0x00, 0x00, <span class="comment">/* RTP Rmt Port */</span> 0x14, 0x50, <span class="comment">/* RTCP Port */</span> 0x00, 0x00,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">/* Dest IP */</span> 0x0a, 0x93, 0x69, 0x05</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;};</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">  633</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">packet_send_arrow</a>[] = { 0x17, 0x04, 0x04, 0x00 };</div><div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">  634</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">packet_send_blink_cursor</a>[] = { 0x17, 0x04, 0x10, 0x86 };</div><div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">  635</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">packet_send_date_time2</a>[] = { 0x17, 0x04, 0x17, 0x3d, 0x11, 0x09, 0x02, 0x0a, <span class="comment">/*Month */</span> 0x05,   <span class="comment">/*Day */</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   0x06, <span class="comment">/*Hour */</span> 0x07, <span class="comment">/*Minutes */</span> 0x08, 0x32</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;};</div><div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">  638</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">packet_send_Contrast</a>[] =</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   { 0x17, 0x04, 0x24, <span class="comment">/*Contrast */</span> 0x08 };</div><div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">  640</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">packet_send_start_timer</a>[] =</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   { 0x17, 0x05, 0x0b, <span class="comment">/*Timer option*/</span>0x05, <span class="comment">/* Timer ID */</span>0x00, 0x17, 0x08, 0x16,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="comment">/* Text */</span> <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="charliteral">&#39;m&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;r&#39;</span> };</div><div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">  643</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">packet_send_stop_timer</a>[] = { 0x17, 0x05, 0x0b, 0x02, 0x00 };</div><div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">  644</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">packet_send_icon</a>[] = { 0x17, 0x05, 0x14, <span class="comment">/*pos */</span> 0x00, <span class="comment">/*icon */</span> 0x25 };      <span class="comment">/* display an icon in front of the text zone */</span></div><div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">  645</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>[] = { 0x17, 0x06, 0x0f, 0x30, 0x07, 0x07 };</div><div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">  646</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">packet_send_set_pos_cursor</a>[] =</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   { 0x17, 0x06, 0x10, 0x81, 0x04, <span class="comment">/*pos */</span> 0x20 };</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acde558b15bc96c402f0c8d6c618048bf">  649</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acde558b15bc96c402f0c8d6c618048bf">monthlabels</a>[] =</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   { <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;n&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;b&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;r&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;r&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;y&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;u&#39;</span>, <span class="charliteral">&#39;n&#39;</span>,</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;u&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;u&#39;</span>, <span class="charliteral">&#39;g&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;c&#39;</span>, <span class="charliteral">&#39;t&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;o&#39;</span>, <span class="charliteral">&#39;v&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;c&#39;</span> };</div><div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">  652</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">packet_send_monthlabels_download</a>[] =</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  { 0x17, 0x0a, 0x15, <span class="comment">/* Month (3 char) */</span> <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, 0x20 };</div><div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">  654</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">packet_send_favorite</a>[] =</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   { 0x17, 0x0f, 0x19, 0x10, <span class="comment">/*pos */</span> 0x01, <span class="comment">/*name */</span> 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;0x20, 0x20, 0x20, 0x20, <span class="comment">/*end_name */</span> 0x19,</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   0x05, 0x0f, <span class="comment">/*pos */</span> 0x01, <span class="comment">/*icone */</span> 0x00</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;};</div><div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">  659</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">packet_send_title</a>[] =</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   { 0x17, 0x10, 0x19, 0x02, <span class="comment">/*text */</span> 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;0x20, 0x20, 0x20, 0x20 <span class="comment">/*end_text */</span>  };</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">  662</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">packet_send_text</a>[] =</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   { 0x17, 0x1e, 0x1b, 0x04, <span class="comment">/*pos */</span> 0x00, <span class="comment">/*inverse */</span> 0x25, <span class="comment">/*text */</span> 0x20, 0x20,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="comment">/*end_text */</span> 0x17, 0x04, 0x10, 0x87</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;};</div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">  668</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">packet_send_status</a>[] =</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   { 0x17, 0x20, 0x19, 0x08, <span class="comment">/*text */</span> 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20    <span class="comment">/*end_text */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;};</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">  673</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">packet_send_status2</a>[] =</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   { 0x17, 0x0b, 0x19, <span class="comment">/* pos [08|28|48|68] */</span> 0x00, <span class="comment">/* text */</span> 0x20, 0x20, 0x20, 0x20,</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;0x20, 0x20, 0x20 <span class="comment">/* end_text */</span>  };</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">/* Multiple character set support */</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">/* ISO-8859-1 - Western European) */</span></div><div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad4a61b324f2b83bb3abddb8a49e84251">  679</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a61b324f2b83bb3abddb8a49e84251">packet_send_charset_iso_8859_1</a>[] =</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   { 0x17, 0x08, 0x21, 0x1b, 0x2d, 0x41, 0x1b, 0x00 };</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">/* ISO-8859-2 - Central European) */</span></div><div class="line"><a name="l00682"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a977571324fa31e1c1c049f7b6e23cbd4">  682</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a977571324fa31e1c1c049f7b6e23cbd4">packet_send_charset_iso_8859_2</a>[] =</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   { 0x17, 0x08, 0x21, 0x1b, 0x2d, 0x42, 0x1b, 0x00 };</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/* ISO-8859-4 - Baltic) */</span></div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a95e87aaaae8e8f48324d3ec9c7824aab">  685</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a95e87aaaae8e8f48324d3ec9c7824aab">packet_send_charset_iso_8859_4</a>[] =</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   { 0x17, 0x08, 0x21, 0x1b, 0x2d, 0x44, 0x1b, 0x00 };</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">/* ISO 8859-5 - cyrilic */</span></div><div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7f8d93f20c2e85b18cb72b434d51082e">  688</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7f8d93f20c2e85b18cb72b434d51082e">packet_send_charset_iso_8859_5</a>[] =</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   { 0x17, 0x08, 0x21, 0x1b, 0x2d, 0x4c, 0x1b, 0x00 };</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">/* Japaneese (ISO-2022-JP ?) */</span></div><div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3f335e3e51c36b21ee50335da3dd29fa">  691</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f335e3e51c36b21ee50335da3dd29fa">packet_send_charset_iso_2022_jp</a>[] =</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   { 0x17, 0x08, 0x21, 0x1b, 0x29, 0x49, 0x1b, 0x7e };</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">  694</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">packet_send_led_update</a>[] = { 0x19, 0x04, 0x00, 0x00 };</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">  696</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">packet_send_query_basic_manager_04</a>[] = { 0x1a, 0x04, 0x01, 0x04 };</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">  697</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">packet_send_query_mac_address</a>[] = { 0x1a, 0x04, 0x01, 0x08 };</div><div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">  698</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">packet_send_query_basic_manager_10</a>[] = { 0x1a, 0x04, 0x01, 0x10 };</div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">  699</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">packet_send_S1</a>[] = { 0x1a, 0x07, 0x07, 0x00, 0x00, 0x00, 0x13 };</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">  701</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a>[] =</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   { 0x1e, 0x05, 0x12, 0x00, <span class="comment">/*Watchdog timer */</span> 0x78 };</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">  704</a></span>&#160;<span class="preprocessor">#define BUFFSEND unsigned char buffsend[64] = { 0x00, 0x00, 0xaa, 0xbb, 0x02, 0x01 }</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a71535bf985a1a06d548fd73a0a0ec32c">  706</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71535bf985a1a06d548fd73a0a0ec32c">tdesc</a>[] = <span class="stringliteral">&quot;UNISTIM Channel Driver&quot;</span>;</div><div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">  707</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">channel_type</a>[] = <span class="stringliteral">&quot;USTM&quot;</span>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">/*! Protos */</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> *assignedids, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *requestor);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5655629994fdc7d0d29a850c209b96f2">load_module</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011">reload_config</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa202d63f744ac6fc728ee8ea937e4d7b">unistim_request</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> *assignedids, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *requestor,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *dest, <span class="keywordtype">int</span> *cause);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a148deb9252a1f8568bbf1338d320c879">unistim_call</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">const</span> <span class="keywordtype">char</span> *dest, <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77c91d8d323c7e0d4d9b170f05bb732c">unistim_hangup</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae81cba0110cb56a82ebd9b1bc3d6f396">unistim_answer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2accd5119ec27e18e50be3af305cf42e">unistim_read</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7de71b5fc170bcc10f3d1c44da09f3c2">unistim_write</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae6520d9b6a2dcd9dafdee9af3732039a">unistim_indicate</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">int</span> ind, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="keywordtype">size_t</span> <a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad68c0963a805ff4107528fe6ebbc2b59">unistim_fixup</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *oldchan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *newchan);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4621bc4d2e56c21790efc3debe949b83">unistim_senddigit_begin</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69f342be6241cf144b32186890bb5e61">unistim_senddigit_end</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> duration);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5daefc58bff9275e962b82ddf0cb72a">unistim_sendtext</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8">write_entry_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, FILE * f, <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>,</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordtype">char</span> *line1);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keywordtype">char</span> *callerid);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6aa58a7eefc67ad27b485fe141c3a605">  736</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d85/structast__channel__tech.html">ast_channel_tech</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6aa58a7eefc67ad27b485fe141c3a605">unistim_tech</a> = {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   .<a class="code" href="../../d4/d85/structast__channel__tech.html#a8ff938fb2f815be425fd2859a21e6d61">type</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">channel_type</a>,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   .description = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71535bf985a1a06d548fd73a0a0ec32c">tdesc</a>,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   .properties = <a class="code" href="../../d5/d7b/channel_8h.html#aa62371d642974c67a0c0efa77d54fcbda54130226ec87f80c48ee98aa5cc9168c">AST_CHAN_TP_WANTSJITTER</a> | <a class="code" href="../../d5/d7b/channel_8h.html#aa62371d642974c67a0c0efa77d54fcbdafb2c9cea57f7fc8e0350ed6f60cbb892">AST_CHAN_TP_CREATESJITTER</a>,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   .requester = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa202d63f744ac6fc728ee8ea937e4d7b">unistim_request</a>,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   .call = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a148deb9252a1f8568bbf1338d320c879">unistim_call</a>,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   .hangup = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77c91d8d323c7e0d4d9b170f05bb732c">unistim_hangup</a>,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   .answer = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae81cba0110cb56a82ebd9b1bc3d6f396">unistim_answer</a>,</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   .read = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2accd5119ec27e18e50be3af305cf42e">unistim_read</a>,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   .write = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7de71b5fc170bcc10f3d1c44da09f3c2">unistim_write</a>,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   .indicate = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae6520d9b6a2dcd9dafdee9af3732039a">unistim_indicate</a>,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   .fixup = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad68c0963a805ff4107528fe6ebbc2b59">unistim_fixup</a>,</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   .send_digit_begin = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4621bc4d2e56c21790efc3debe949b83">unistim_senddigit_begin</a>,</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   .send_digit_end = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69f342be6241cf144b32186890bb5e61">unistim_senddigit_end</a>,</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   .send_text = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5daefc58bff9275e962b82ddf0cb72a">unistim_sendtext</a>,</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;};</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3">send_start_rtp</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2025e985d45bb3084dfced90b9eea58">key_favorite</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *, <span class="keywordtype">char</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2040931156dab409503688b41fe3ae4c">handle_select_codec</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c">handle_select_language</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>*);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36">unistim_free_sub</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abb13848a88adf2dd2e8d706a38daf915">  764</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d3/df2/structunistim__menu__item.html">unistim_menu_item</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abb13848a88adf2dd2e8d706a38daf915">options_menu</a>[] =</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   {<span class="stringliteral">&quot;Change codec&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2040931156dab409503688b41fe3ae4c">handle_select_codec</a>},</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   {<span class="stringliteral">&quot;Language&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c">handle_select_language</a>},</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   {<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;};</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa9672f73c65f1ae19f3c04bd1e7cfc24">  771</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d7e/structunistim__languages.html">unistim_languages</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa9672f73c65f1ae19f3c04bd1e7cfc24">options_languages</a>[] =</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;{</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   {<span class="stringliteral">&quot;English&quot;</span>, <span class="stringliteral">&quot;en&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">ISO_8859_1</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   {<span class="stringliteral">&quot;French&quot;</span>, <span class="stringliteral">&quot;fr&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">ISO_8859_1</a>, NULL},</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   {<span class="stringliteral">&quot;Russian&quot;</span>, <span class="stringliteral">&quot;ru&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7">ISO_8859_5</a>, NULL},</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   {<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, NULL}</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;};</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa80c74c9a7415712e0143bb382a8ae53">  779</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa80c74c9a7415712e0143bb382a8ae53">ustm_strcopy</a>[1024];</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="../../df/dc9/structustm__lang__entry.html">  781</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> {</div><div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">  782</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a>;</div><div class="line"><a name="l00783"></a><span class="lineno"><a class="line" href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">  783</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">str_trans</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;};</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a64756880a43b742a7d4e4e63bce9ade8">  786</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a64756880a43b742a7d4e4e63bce9ade8">lang_hash_fn</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dba/structast__jb__conf.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;{</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = obj;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(entry-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9638a2ee84abf17fcc8ba8e884790de5">  792</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9638a2ee84abf17fcc8ba8e884790de5">lang_cmp_fn</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../d7/dba/structast__jb__conf.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> *entry1 = obj;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> *entry2 = arg;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="keywordflow">return</span> (!strcmp(entry1-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a>, entry2-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a>)) ? (<a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>) : 0;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;}</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">  800</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;{</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> *lang_entry;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a> le_search;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d7e/structunistim__languages.html">unistim_languages</a> *lang = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      lang = &amp;options_languages[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)];</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <span class="keywordflow">if</span> (!lang) {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   <span class="comment">/* Check if specified language exists */</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <span class="keywordflow">if</span> (!lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a>) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[1024], *p, *p_orig = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *p_trans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      FILE *f;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, 8,</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a64756880a43b742a7d4e4e63bce9ade8">lang_hash_fn</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9638a2ee84abf17fcc8ba8e884790de5">lang_cmp_fn</a>);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keywordflow">if</span> (!lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a>) {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate container for translation!\n&quot;</span>);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%s/%s/%s.po&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#ab6e1cd3d774ab1b31836a8777d3a812d">ast_config_AST_VAR_DIR</a>,</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4e1b5f816e1bbf143f8920cd2d11cd8">USTM_LANG_DIR</a>, lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">lang_short</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      f = fopen(tmp, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;There is no translation file for &#39;%s&#39;\n&quot;</span>, lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">lang_short</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keywordflow">while</span> (fgets(tmp, <span class="keyword">sizeof</span>(tmp), f)) {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;         <span class="keywordflow">if</span> (!(p = strchr(tmp, <span class="charliteral">&#39;\n&#39;</span>))) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Too long line found in language file - truncated!\n&quot;</span>);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;         }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;         *p = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         <span class="keywordflow">if</span> (!(p = strchr(tmp, <span class="charliteral">&#39;&quot;&#39;</span>))) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;         }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         <span class="keywordflow">if</span> (tmp == strstr(tmp, <span class="stringliteral">&quot;msgid&quot;</span>)) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            p_orig = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(p + 1);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            p = strchr(p_orig, <span class="charliteral">&#39;&quot;&#39;</span>);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmp == strstr(tmp, <span class="stringliteral">&quot;msgstr&quot;</span>)) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            p_trans = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(p + 1);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            p = strchr(p_trans, <span class="charliteral">&#39;&quot;&#39;</span>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         *p = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         <span class="keywordflow">if</span> (!p_trans || !p_orig) {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;         }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(p_trans)) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(p_trans);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(p_orig);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            p_trans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            p_orig = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         <span class="keywordflow">if</span> (!(lang_entry = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*lang_entry), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            fclose(f);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;         }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;         lang_entry-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">str_trans</a> = p_trans;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;         lang_entry-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a> = p_orig;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a>, lang_entry);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;         p_trans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;         p_orig = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      fclose(f);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   le_search.<a class="code" href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">str_orig</a> = <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">if</span> ((lang_entry = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(lang-&gt;<a class="code" href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">trans</a>, &amp;le_search, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>))) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      size = strlen(lang_entry-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">str_trans</a>)+1;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="keywordflow">if</span> (size &gt; 1024) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;         size = 1024;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      memcpy(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa80c74c9a7415712e0143bb382a8ae53">ustm_strcopy</a>, lang_entry-&gt;<a class="code" href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">str_trans</a>, size);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(lang_entry, -1);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa80c74c9a7415712e0143bb382a8ae53">ustm_strcopy</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">  889</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *sz_msg)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;{</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="comment">/* Display the error message */</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s : (%d) %s\n&quot;</span>, sz_msg, <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">  895</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   <span class="keywordflow">return</span> (now.tv_sec * 1000) + (now.tv_usec / 1000);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;}</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">/* Send data to a phone without retransmit nor buffering */</span></div><div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">  903</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<span class="keywordtype">int</span> size, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data, <span class="keyword">struct</span> sockaddr_in *addr_to,</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;             <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in *addr_ourip)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;{</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef HAVE_PKTINFO</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keyword">struct </span>iovec msg_iov;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keyword">struct </span>msghdr msg;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="keywordtype">char</span> buffer[CMSG_SPACE(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_pktinfo))];</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keyword">struct </span>cmsghdr *ip_msg = (<span class="keyword">struct </span>cmsghdr *) buffer;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keyword">struct </span>in_pktinfo *pki = (<span class="keyword">struct </span>in_pktinfo *) CMSG_DATA(ip_msg);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <span class="comment">/* cast this to a non-const pointer, since the sendmsg() API</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    * does not provide read-only and write-only flavors of the</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">    * structures used for its arguments, but in this case we know</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    * the data will not be modified</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   msg_iov.iov_base = (<span class="keywordtype">char</span> *) data;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   msg_iov.iov_len = size;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   msg.msg_name = addr_to;  <span class="comment">/* optional address */</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   msg.msg_namelen = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sockaddr_in);   <span class="comment">/* size of address */</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;   msg.msg_iov = &amp;msg_iov;  <span class="comment">/* scatter/gather array */</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;   msg.msg_iovlen = 1;          <span class="comment">/* # elements in msg_iov */</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   msg.msg_control = ip_msg;       <span class="comment">/* ancillary data */</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   msg.msg_controllen = <span class="keyword">sizeof</span>(buffer);    <span class="comment">/* ancillary data buffer len */</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   msg.msg_flags = 0;            <span class="comment">/* flags on received message */</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   ip_msg-&gt;cmsg_len = CMSG_LEN(<span class="keyword">sizeof</span>(*pki));</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   ip_msg-&gt;cmsg_level = IPPROTO_IP;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   ip_msg-&gt;cmsg_type = IP_PKTINFO;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   pki-&gt;ipi_ifindex = 0;      <span class="comment">/* Interface index, 0 = use interface specified in routing table */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   pki-&gt;ipi_spec_dst.s_addr = addr_ourip-&gt;sin_addr.s_addr; <span class="comment">/* Local address */</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <span class="comment">/* pki-&gt;ipi_addr = ;   Header Destination address - ignored by kernel */</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor">#ifdef DUMP_PACKET</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;\n**&gt; From %s sending %d bytes to %s ***\n&quot;</span>,</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;               <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr_ourip-&gt;sin_addr), (<span class="keywordtype">int</span>) size,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;               <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr_to-&gt;sin_addr));</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">for</span> (tmp = 0; tmp &lt; size; tmp++)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;%02hhx &quot;</span>, data[tmp]);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;\n******************************************\n&quot;</span>);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">if</span> (sendmsg(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, &amp;msg, 0) == -1) {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Error sending datas&quot;</span>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordflow">if</span> (sendto(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, data, size, 0, (<span class="keyword">struct</span> sockaddr *) addr_to, <span class="keyword">sizeof</span>(*addr_to))</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      == -1)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Error sending datas&quot;</span>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">  959</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<span class="keywordtype">int</span> size, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;{</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tick;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="keywordtype">int</span> buf_pos;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a> = ntohs(++pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   buf_pos = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="keywordflow">if</span> (buf_pos &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">MAX_BUF_NUMBER</a>) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error : send queue overflow\n&quot;</span>);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   memcpy((<span class="keywordtype">void</span> *)data + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), (<span class="keywordtype">void</span> *)&amp;seq, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>));</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[buf_pos].<a class="code" href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">len</a> = size;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   memcpy(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[buf_pos].<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a>, data, size);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   tick = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>();</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = tick + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">/*#ifdef DUMP_PACKET */</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending datas with seq #0x%04x Using slot #%d :\n&quot;</span>, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>, buf_pos);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">/*#endif */</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[buf_pos].<a class="code" href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">len</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[buf_pos].<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a>, &amp;(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>),</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;              &amp;(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>));</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>++;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a809cffe22b7ff73ee3e2c064a2f3ced7">  991</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a809cffe22b7ff73ee3e2c064a2f3ced7">send_ping</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;{</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending ping\n&quot;</span>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">tick_next_ping</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>() + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a>));</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a>), buffsend, pte);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a965a6de0f60b8b10a4e41cf36b608761"> 1002</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a965a6de0f60b8b10a4e41cf36b608761">get_to_address</a>(<span class="keywordtype">int</span> fd, <span class="keyword">struct</span> sockaddr_in *toAddr)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;{</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="preprocessor">#ifdef HAVE_PKTINFO</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <span class="keywordtype">int</span> err;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <span class="keywordtype">char</span> cmbuf[0x100];</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   <span class="keyword">struct </span>cmsghdr *cmsg;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <span class="keyword">struct </span>sockaddr_in peeraddr;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <span class="keyword">struct </span>in_addr addr;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keyword">struct </span>msghdr mh = {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      .msg_name = &amp;peeraddr,</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      .msg_namelen = <span class="keyword">sizeof</span>(peeraddr),</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      .msg_control = cmbuf,</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      .msg_controllen = <span class="keyword">sizeof</span>(cmbuf),</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   };</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   memset(&amp;addr, 0, <span class="keyword">sizeof</span>(addr));</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   <span class="comment">/* Get info about the incoming packet */</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   err = recvmsg(fd, &amp;mh, MSG_PEEK);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="keywordflow">if</span> (err == -1) {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;recvmsg returned an error: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">return</span> err;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   <span class="keywordflow">for</span>(cmsg = CMSG_FIRSTHDR(&amp;mh);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      cmsg != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      cmsg = CMSG_NXTHDR(&amp;mh, cmsg))</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;       <span class="keywordflow">if</span> (cmsg-&gt;cmsg_level == IPPROTO_IP &amp;&amp; cmsg-&gt;cmsg_type == IP_PKTINFO) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;         <span class="keyword">struct </span>in_pktinfo *pkt = (<span class="keyword">struct </span>in_pktinfo*)CMSG_DATA(cmsg);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         addr = pkt-&gt;ipi_addr;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;message received on address %s\n&quot;</span>, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr));</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   memcpy(&amp;toAddr-&gt;sin_addr, &amp;addr, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr));</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   memcpy(toAddr, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>, <span class="keyword">sizeof</span>(*toAddr));</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">/* Allocate memory &amp; initialize structures for a new phone */</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">/* addr_from : ip address of the phone */</span></div><div class="line"><a name="l01046"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a33363b0e7457c82cb0aef3b8c10cad5e"> 1046</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a33363b0e7457c82cb0aef3b8c10cad5e">create_client</a>(<span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in *addr_from)</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;{</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <span class="keywordflow">if</span> (!(s = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*s))))</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   memcpy(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>, addr_from, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a965a6de0f60b8b10a4e41cf36b608761">get_to_address</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, &amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>) &lt; 0) {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(s);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>.sin_family = AF_INET;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Creating a new entry for the phone from %s received via server ip %s\n&quot;</span>,</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr_from-&gt;sin_addr), <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>.sin_addr));</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   <a class="code" href="../../d3/d0a/structsessions.html">sessions</a> = s;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>() + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">tick_next_ping</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>() + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   <span class="comment">/* Initialize struct wsabuf  */</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   <span class="keywordflow">for</span> (tmp = 0; tmp &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">MAX_BUF_NUMBER</a>; tmp++) {</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>].<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a> = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a036407d71bff31da6c9b17ff9ff859c5">buf</a>[<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>];</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <span class="keywordflow">return</span> s;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;}</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5df5b980ae3a08f9219065c5ef191060"> 1080</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5df5b980ae3a08f9219065c5ef191060">send_end_call</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;{</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending end call\n&quot;</span>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">packet_send_end_call</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">packet_send_end_call</a>));</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">packet_send_end_call</a>), buffsend, pte);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;}</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a08ef43771b971334bcabfe77438e1ad1"> 1090</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08ef43771b971334bcabfe77438e1ad1">set_ping_timer</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;{</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tick = 0;  <span class="comment">/* XXX what is this for, anyways */</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">tick_next_ping</a>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;tick = %u next ping at %u tick\n&quot;</span>, tick, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;}</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">/* Checking if our send queue is empty,</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"> * if true, setting up a timer for keepalive */</span></div><div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2eab34a419da2f1d9e240df755bb62ce"> 1101</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2eab34a419da2f1d9e240df755bb62ce">check_send_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;{</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   <span class="comment">/* Check if our send queue contained only one element */</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a> == 1) {</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Our single packet was ACKed.\n&quot;</span>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>--;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08ef43771b971334bcabfe77438e1ad1">set_ping_timer</a>(pte);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   <span class="comment">/* Check if this ACK catch up our latest packet */</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> + 1 == pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a> + 1) {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Our send queue is completely ACKed.\n&quot;</span>);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a> = 0;    <span class="comment">/* Purge the send queue */</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08ef43771b971334bcabfe77438e1ad1">set_ping_timer</a>(pte);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   }</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;We still have packets in our send queue\n&quot;</span>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;   }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;}</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5"> 1127</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;{</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending start timer\n&quot;</span>);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;   }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">packet_send_start_timer</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">packet_send_start_timer</a>));</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">packet_send_start_timer</a>), buffsend, pte);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;}</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c"> 1137</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;{</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending stop timer\n&quot;</span>);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">packet_send_stop_timer</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">packet_send_stop_timer</a>));</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">packet_send_stop_timer</a>), buffsend, pte);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8"> 1147</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;{</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending icon pos %d with status 0x%02hhx\n&quot;</span>, pos, status);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   }</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">packet_send_icon</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">packet_send_icon</a>));</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   buffsend[9] = pos;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   buffsend[10] = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">packet_send_icon</a>), buffsend, pte);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#add89efe611110e5f6d6fee7d45e1b5ca"> 1159</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add89efe611110e5f6d6fee7d45e1b5ca">send_expansion_next</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;{</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">packet_send_expansion_next</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">packet_send_expansion_next</a>));</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">packet_send_expansion_next</a>), buffsend, pte);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;}</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acf94e9fb1c35ce01e175e7d1d6d8a6b6"> 1167</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acf94e9fb1c35ce01e175e7d1d6d8a6b6">send_expansion_icon</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;{</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending expansion icon pos %d with status 0x%02hhx\n&quot;</span>, pos, status);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">packet_send_expansion_icon</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">packet_send_expansion_icon</a>));</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   buffsend[10] = pos;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;   buffsend[11] = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">packet_send_expansion_icon</a>), buffsend, pte);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">/* inverse : TEXT_INVERSE : yes, TEXT_NORMAL  : no */</span></div><div class="line"><a name="l01180"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a67b115665a4da0af45e82c9643c14f22"> 1180</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a67b115665a4da0af45e82c9643c14f22">send_expansion_text</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;{</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;[expansion] Asked to display NULL text (pos %d)\n&quot;</span>, pos);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;   }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;[expansion] Sending text at pos %d\n&quot;</span>, pos);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">packet_send_expansion_text</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">packet_send_expansion_text</a>));</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;   buffsend[10] = pos;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   i = strlen(text);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   <span class="keywordflow">if</span> (i &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>) {</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      i = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   memcpy(buffsend + 11, text, i);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">packet_send_expansion_text</a>), buffsend, pte);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;}</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8"> 1201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, uint16_t tone1, uint16_t tone2)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;{</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   <span class="keywordflow">if</span> (!tone1) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Stream Based Tone Off\n&quot;</span>);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">packet_send_stream_based_tone_off</a>,</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">packet_send_stream_based_tone_off</a>));</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">packet_send_stream_based_tone_off</a>), buffsend, pte);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;   }</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <span class="comment">/* Since most of the world use a continuous tone, it&#39;s useless</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">      if (unistimdebug)</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">      ast_verb(0, &quot;Sending Stream Based Tone Cadence Download\n&quot;);</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">      memcpy (buffsend + SIZE_HEADER, packet_send_StreamBasedToneCad, sizeof (packet_send_StreamBasedToneCad));</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">      send_client (SIZE_HEADER + sizeof (packet_send_StreamBasedToneCad), buffsend, pte); */</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Stream Based Tone Frequency Component List Download %d %d\n&quot;</span>, tone1, tone2);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   tone1 *= 8;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="keywordflow">if</span> (!tone2) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">packet_send_stream_based_tone_single_freq</a>,</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">packet_send_stream_based_tone_single_freq</a>));</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[10], htons(tone1));</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">packet_send_stream_based_tone_single_freq</a>), buffsend,</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;               pte);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      tone2 *= 8;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">packet_send_stream_based_tone_dual_freq</a>,</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">packet_send_stream_based_tone_dual_freq</a>));</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[10], htons(tone1));</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[12], htons(tone2));</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">packet_send_stream_based_tone_dual_freq</a>), buffsend,</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;               pte);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Stream Based Tone On\n&quot;</span>);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">packet_send_stream_based_tone_on</a>,</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">packet_send_stream_based_tone_on</a>));</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">packet_send_stream_based_tone_on</a>), buffsend, pte);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;}</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/* Positions for favorites</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"> |--------------------|</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment"> |  5          2    | &lt;-- not on screen in i2002</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"> |  4          1    |</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment"> |  3          0    |</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"> KEM Positions</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment"> |--------------------|</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"> |  12            24   |</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment"> |  11            23   |</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"> |  10            22   |</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"> |  9          21   |</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"> |  8          20   |</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"> |  7          19   |</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"> |  6          18   |</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment"> |  5          17   |</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment"> |  4          16   |</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment"> |  3          15   |</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"> |  2          14   |</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment"> |  1          13   |</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">/* status (icons) : 00 = nothing, 2x/3x = see parser.h, 4x/5x = blink fast, 6x/7x = blink slow */</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f"> 1273</a></span>&#160;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte,</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;{</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending favorite pos %d with status 0x%02hhx\n&quot;</span>, pos, status);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">packet_send_favorite</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">packet_send_favorite</a>));</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   buffsend[10] = pos;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   buffsend[24] = pos;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   buffsend[25] = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   i = strlen(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(text, pte));</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordflow">if</span> (i &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acf057faabb89a493df21ee8102d79076">FAV_MAX_LENGTH</a>) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      i = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acf057faabb89a493df21ee8102d79076">FAV_MAX_LENGTH</a>;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acf057faabb89a493df21ee8102d79076">FAV_MAX_LENGTH</a> + 1, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(text, pte), i);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">packet_send_favorite</a>), buffsend, pte);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979"> 1294</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte) {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(pos, status, pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[pos]);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;}</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8f0bdf522fe97f4a4196207da4c5e9d1"> 1299</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8f0bdf522fe97f4a4196207da4c5e9d1">send_favorite_selected</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte) {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> != -1) {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>, status, pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>]);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;}</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abd716cc271a9fefb0d4f1a9679bc5fb3"> 1306</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abd716cc271a9fefb0d4f1a9679bc5fb3">send_expansion_short</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte) {</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acf94e9fb1c35ce01e175e7d1d6d8a6b6">send_expansion_icon</a>(pos, status, pte);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a67b115665a4da0af45e82c9643c14f22">send_expansion_text</a>(pos, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a48b276b04c93ca4b9625e4e6cfdf69fd">expsoftkeylabel</a>[pos], pte));</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add89efe611110e5f6d6fee7d45e1b5ca">send_expansion_next</a>(pte);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7"> 1313</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a>* <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> num)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;{</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="keywordflow">if</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1 &amp;&amp; num % 3 == 2) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c"> 1321</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i = 0;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   <span class="keywordtype">char</span> data[256];</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *line;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   line = <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Refreshing all favorite\n&quot;</span>);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i];</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i)) {</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      }</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[i], <span class="stringliteral">&quot;DND&quot;</span>) &amp;&amp; line) {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../de/d4a/astdb_8h.html#a6ab91701fa0db9fad7759fe42a581c17">ast_db_get</a>(<span class="stringliteral">&quot;DND&quot;</span>, line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, data, <span class="keyword">sizeof</span>(data))) {</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            status = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a53dbe001ee80d35548add7dfa57b58f9">FAV_ICON_SPEAKER_ONHOOK_WHITE</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;         }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(i, status, pte);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;   }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad3af117a28948d46d18d787129016d7e">hasexp</a>) {</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0ce9df795a9c80e6bd83ed8935c80999">EXPNUM</a>; i++) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abd716cc271a9fefb0d4f1a9679bc5fb3">send_expansion_short</a>(i, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>, pte);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;   }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982"> 1352</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982">is_key_favorite</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keywordtype">int</span> fav)</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;{</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;   <span class="keywordflow">if</span> ((fav &lt; 0) || (fav &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>)) {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;   }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[fav]) {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[fav][0] == <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   }</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;}</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004"> 1366</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keywordtype">int</span> fav)</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <span class="keywordflow">if</span> ((fav &lt; 0) || (fav &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>)) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <span class="keywordflow">if</span> (!d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[fav]) {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   }</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982">is_key_favorite</a>(d, fav)) {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;}</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a96a53bd4ae7f1c907e2d6e2e361492ae"> 1380</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96a53bd4ae7f1c907e2d6e2e361492ae">get_active_softkey</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;{</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   <span class="keywordflow">return</span> pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;}</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a"> 1385</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;{</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>)) {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = -1;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   }</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> != -1 &amp;&amp; pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> != i) {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i)) {</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i]) {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      }</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i)) {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         <span class="keywordflow">if</span> (name &amp;&amp; strcmp(name, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[i]-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Found softkey %d for device %s\n&quot;</span>, i, name);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;         }</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         <span class="keywordflow">return</span> i;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;   }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">/* Change the status for this phone (pte) and update for each phones where pte is bookmarked</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> * use FAV_ICON_*_BLACK constant in status parameters */</span></div><div class="line"><a name="l01418"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de"> 1418</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;{</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;   <span class="comment">/* Update the current phone line softkey icon */</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">STATE_CLEANING</a>) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordtype">int</span> softkeylinepos = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96a53bd4ae7f1c907e2d6e2e361492ae">get_active_softkey</a>(pte);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">if</span> (softkeylinepos != -1) {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(softkeylinepos, status, pte);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;   }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;   <span class="comment">/* Notify other phones if we&#39;re in their bookmark */</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>[i] == pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {  <span class="comment">/* It&#39;s us ? */</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i] != status) {      <span class="comment">/* Avoid resending the same icon */</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;               d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i] = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;               <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(i, status + 1, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[i]);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;               }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            }</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;         }</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;   }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;}</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341"> 1445</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341">register_extension</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;{</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *line;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   line = <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Trying to register extension &#39;%s&#39; into context &#39;%s&#39; to %s\n&quot;</span>,</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>,</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;               line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;   }</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/de0/pbx_8h.html#a07176e8d314eb68b3b50279fafa11390">ast_add_extension</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, 0,</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Dial&quot;</span>,</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                      line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>, 0, <span class="stringliteral">&quot;Unistim&quot;</span>);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af809a5a3654f9c22d7a6c0447ac7c914"> 1459</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af809a5a3654f9c22d7a6c0447ac7c914">unregister_extension</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;{</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Trying to unregister extension &#39;%s&#39; context &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/de0/pbx_8h.html#a721c6ba091102f155a586e09b2a526bf">ast_context_remove_extension</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>,</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                              pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, 1, <span class="stringliteral">&quot;Unistim&quot;</span>);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">/* Free memory allocated for a phone */</span></div><div class="line"><a name="l01470"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa73a3666fca776852c23de09da246f94"> 1470</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa73a3666fca776852c23de09da246f94">close_client</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s)</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;{</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *cur, *prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   cur = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   <span class="comment">/* Looking for the session in the linked chain */</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   <span class="keywordflow">while</span> (cur) {</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">if</span> (cur == s) {</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      }</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      prev = cur;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      cur = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;   }</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;   <span class="keywordflow">if</span> (cur) {                 <span class="comment">/* Session found ? */</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {         <span class="comment">/* This session was registered ? */</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;         s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">STATE_CLEANING</a>;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;close_client session %p device %p\n&quot;</span>, s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;         }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, list) {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {       <span class="comment">/* Call in progress ? */</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Aborting call\n&quot;</span>);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;               }</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d4/da3/causes_8h.html#a9e3ffd481d41079a4ed1700464c9a42a">AST_CAUSE_NETWORK_OUT_OF_ORDER</a>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Released sub %u of channel %s@%s\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;               }</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36">unistim_free_sub</a>(sub);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            }</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;         }</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>)) {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af809a5a3654f9c22d7a6c0447ac7c914">unregister_extension</a>(s);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;         }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;         cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Freeing an unregistered client\n&quot;</span>);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;         }</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      }</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="keywordflow">if</span> (prev) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;         prev-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a> = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;         <a class="code" href="../../d3/d0a/structsessions.html">sessions</a> = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(s);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Trying to delete non-existent session %p?\n&quot;</span>, s);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;   }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;}</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/* Return 1 if the session chained link was modified */</span></div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9f0fd974c1b1884f2745b93d7a658659"> 1538</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9f0fd974c1b1884f2745b93d7a658659">send_retransmit</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;{</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   <span class="keywordflow">if</span> (++pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8879dd3a62f9fa2a85475b40587c3d77">nb_retransmit</a> &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab4f7f5bd236a41e188c6b46e9b1d535">NB_MAX_RETRANSMIT</a>) {</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Too many retransmit - freeing client\n&quot;</span>);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      }</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa73a3666fca776852c23de09da246f94">close_client</a>(pte);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;   }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>() + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   <span class="keywordflow">for</span> (i = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a> - (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a> - pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;       i &lt; pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>; i++) {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">if</span> (i &lt; 0) {</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;               <span class="stringliteral">&quot;Asked to retransmit an ACKed slot ! last_buf_available=%d, seq_server = #0x%04x last_seq_ack = #0x%04x\n&quot;</span>,</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a>, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      }</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *sbuf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *) pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[i].<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a>;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a>;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;         <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a> = ntohs(sbuf[1]);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Retransmit slot #%d (seq=#0x%04x), last ack was #0x%04x\n&quot;</span>, i,</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                  (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a>, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[i].<a class="code" href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">len</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">wsabufsend</a>[i].<a class="code" href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">buf</a>, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>,</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                 &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;   }</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;}</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">/* inverse : TEXT_INVERSE : yes, TEXT_NORMAL  : no */</span></div><div class="line"><a name="l01578"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291"> 1578</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> inverse, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;{</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Asked to display NULL text (pos %d, inverse flag %d)\n&quot;</span>, pos, inverse);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;   }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> &amp;&amp; pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1 &amp;&amp; pos != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;   }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending text at pos %d, inverse flag %d\n&quot;</span>, pos, inverse);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   }</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">packet_send_text</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">packet_send_text</a>));</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   buffsend[10] = pos;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   buffsend[11] = inverse;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   i = strlen(text);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   <span class="keywordflow">if</span> (i &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>) {</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      i = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   }</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   memcpy(buffsend + 12, text, i);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">packet_send_text</a>), buffsend, pte);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;}</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412"> 1604</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;{</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending status text\n&quot;</span>);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   }</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a7ef42aa41fc6f1f39c513ceb034fe467">status_method</a> == 1) {  <span class="comment">/* For new firmware and i2050 soft phone */</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;         <span class="keywordtype">int</span> n = strlen(text);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;         <span class="comment">/* Must send individual button separately */</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;         <span class="keywordtype">int</span> j;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;         <span class="keywordflow">for</span> (i = 0, j = 0; i &lt; 4; i++, j += 7) {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordtype">int</span> pos = 0x08 + (i * 0x20);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">packet_send_status2</a>,</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                  <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">packet_send_status2</a>));</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            buffsend[9] = pos;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            memcpy(buffsend + 10, (j &lt; n) ? (text + j) : <span class="stringliteral">&quot;       &quot;</span>, 7);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">packet_send_status2</a>), buffsend, pte);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;         }</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      }</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   }</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">packet_send_status</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">packet_send_status</a>));</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   i = strlen(text);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;   <span class="keywordflow">if</span> (i &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36cc0c8c725c461d6f25bd52cb56f3db">STATUS_LENGTH_MAX</a>) {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      i = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36cc0c8c725c461d6f25bd52cb56f3db">STATUS_LENGTH_MAX</a>;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;   }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;   memcpy(buffsend + 10, text, i);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">packet_send_status</a>), buffsend, pte);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;}</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b"> 1639</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> led)</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;{</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending led_update (%x)\n&quot;</span>, (<span class="keywordtype">unsigned</span>)led);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;   }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">packet_send_led_update</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">packet_send_led_update</a>));</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   buffsend[9] = led;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">packet_send_led_update</a>), buffsend, pte);</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a52c437bdbf19718602604e80422c841e"> 1650</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a52c437bdbf19718602604e80422c841e">send_mute</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a>)</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;{</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">   0x00 = unmute TX, 0x01 = mute TX</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">   0x20 = unmute RX, 0x21 = mute RX</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending mute packet (%x)\n&quot;</span>, (<span class="keywordtype">unsigned</span>)mute);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;   }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">packet_send_mute</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">packet_send_mute</a>));</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;   buffsend[9] = <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a>;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">packet_send_mute</a>), buffsend, pte);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;}</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">/* output = OUTPUT_HANDSET, OUTPUT_HEADPHONE or OUTPUT_SPEAKER</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment"> * volume = VOLUME_LOW, VOLUME_NORMAL, VOLUME_INSANELY_LOUD</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment"> * mute = MUTE_OFF, MUTE_ON */</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l01670"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5"> 1670</a></span>&#160;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> output, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/d4c/structvolume.html">volume</a>,</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;             <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a>)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;{</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <span class="keywordtype">int</span> mute_icon = -1;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending select output packet output=%x volume=%x mute=%x\n&quot;</span>,</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;         (<span class="keywordtype">unsigned</span>)output, (<span class="keywordtype">unsigned</span>)volume, (<span class="keywordtype">unsigned</span>)mute);</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   }</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">packet_send_select_output</a>,</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">packet_send_select_output</a>));</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   buffsend[9] = output;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="keywordflow">if</span> (output == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a> &amp;&amp; volume == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29058a32cb27a6c7e8eec1a99dfb8ecc">VOLUME_LOW</a>) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      volume = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa30bc97cb7b0b5dc8f53986da75558e2">VOLUME_LOW_SPEAKER</a>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;   }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;   buffsend[10] = volume;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   <span class="keywordflow">if</span> (mute == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a109d3bab32b2bea03e2bafd9ab87b00f">MUTE_ON_DISCRET</a>) {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      buffsend[11] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      buffsend[11] = <a class="code" href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a>;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   }</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">packet_send_select_output</a>), buffsend, pte);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   <span class="keywordflow">if</span> (output == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>) {</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      mute_icon = (mute == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>) ? <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7a1662ad66c828762decbf7beaebf01">FAV_ICON_ONHOLD_BLACK</a> : <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a>);</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a>);</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (output == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>) {</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      mute_icon = (mute == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>)? <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab628eb33db043ed9fde8deca41fab802">FAV_ICON_HEADPHONES_ONHOLD</a> : <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69e634f5869dfcb04320125526a7769d">FAV_ICON_HEADPHONES</a>;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a>);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e0473d5c56ec814c90ce680847e960c">LED_HEADPHONE_ON</a>);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (output == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>) {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a48717a695a6adae245071375c4b0408f">LED_SPEAKER_ON</a>);</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a>);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a>) {</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;         mute_icon = (mute == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>)? <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5c438e031784d5c35d517872b5f6db64">FAV_ICON_SPEAKER_ONHOLD_BLACK</a> : <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e999210eafaaa2ac9c550866ec34d2b">FAV_ICON_SPEAKER_ONHOOK_BLACK</a>;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;         mute_icon = (mute == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>)? <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5c438e031784d5c35d517872b5f6db64">FAV_ICON_SPEAKER_ONHOLD_BLACK</a> : <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa2849c9d8d410fd9a4c1c8ccd7cb1565">FAV_ICON_SPEAKER_OFFHOOK_BLACK</a>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      }</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid output (%d)\n&quot;</span>, output);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;   }</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;   <span class="keywordflow">if</span> (mute_icon != -1) {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(pte, mute_icon);</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;   }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   <span class="keywordflow">if</span> (output != pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>) {</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">previous_output</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;   }</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> = output;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;}</div><div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1cc482381672ad23b589814decda5779"> 1719</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1cc482381672ad23b589814decda5779">send_ring</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">signed</span> <span class="keywordtype">char</span> <a class="code" href="../../da/d4c/structvolume.html">volume</a>, <span class="keywordtype">signed</span> <span class="keywordtype">char</span> style)</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;{</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending ring packet\n&quot;</span>);</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">packet_send_ring</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">packet_send_ring</a>));</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   buffsend[24] = style + 0x10;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   buffsend[29] = volume * 0x10;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">packet_send_ring</a>), buffsend, pte);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;}</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div><div class="line"><a name="l01731"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e"> 1731</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;{</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending no ring packet\n&quot;</span>);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   }</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">packet_send_no_ring</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">packet_send_no_ring</a>));</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">packet_send_no_ring</a>), buffsend, pte);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;}</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73"> 1741</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73">send_texttitle</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;{</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending title text\n&quot;</span>);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   }</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">packet_send_title</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">packet_send_title</a>));</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;   i = strlen(text);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;   <span class="keywordflow">if</span> (i &gt; 12) {</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      i = 12;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   }</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   memcpy(buffsend + 10, text, i);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">packet_send_title</a>), buffsend, pte);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;}</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3e69e3bafe7f929bdbc5ff930d50f8b0"> 1757</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e69e3bafe7f929bdbc5ff930d50f8b0">send_idle_clock</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;{</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;}</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad77b08a22116d7b099d6598b10e5cbd2"> 1762</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77b08a22116d7b099d6598b10e5cbd2">send_month_labels</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">int</span> month)</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;{</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;   <span class="keywordtype">char</span> month_name[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06aab1370b612f1b03d2e55f8a33c0f1">MONTH_LABEL_SIZE</a> + 1];</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;   <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;           <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Month Labels\n&quot;</span>);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;   }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;   month_name[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06aab1370b612f1b03d2e55f8a33c0f1">MONTH_LABEL_SIZE</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">packet_send_monthlabels_download</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">packet_send_monthlabels_download</a>));</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;   <span class="keywordflow">while</span> (i &lt; 2) {</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      memcpy(month_name, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acde558b15bc96c402f0c8d6c618048bf">monthlabels</a>[month * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06aab1370b612f1b03d2e55f8a33c0f1">MONTH_LABEL_SIZE</a>], MONTH_LABEL_SIZE);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + 3 + i*MONTH_LABEL_SIZE, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(month_name, pte), MONTH_LABEL_SIZE);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,<span class="stringliteral">&quot;%s\n&quot;</span>, month_name);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(month_name, pte));</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      month = (month + 1)%12;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      i++;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">packet_send_monthlabels_download</a>), buffsend, pte);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;}</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a546d1d18e6b4db23aa313bb0a77bac18"> 1784</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a546d1d18e6b4db23aa313bb0a77bac18">send_date_time</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;{</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> atm = { 0, };</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Time &amp; Date\n&quot;</span>);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">packet_send_date_time</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">packet_send_date_time</a>));</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;atm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   buffsend[10] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a> + 1;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;   buffsend[11] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">tm_mday</a>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;   buffsend[12] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">tm_hour</a>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   buffsend[13] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">tm_min</a>;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">packet_send_date_time</a>), buffsend, pte);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77b08a22116d7b099d6598b10e5cbd2">send_month_labels</a>(pte, atm.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a>);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;}</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6e7d55014285a51d55da36f86028b736"> 1803</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6e7d55014285a51d55da36f86028b736">send_date_time2</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;{</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> atm = { 0, };</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Time &amp; Date #2\n&quot;</span>);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;   }</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">packet_send_date_time2</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">packet_send_date_time2</a>));</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;atm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      buffsend[9] = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">datetimeformat</a>;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      buffsend[9] = 61;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   }</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   buffsend[14] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a> + 1;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   buffsend[15] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">tm_mday</a>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;   buffsend[16] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">tm_hour</a>;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   buffsend[17] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">tm_min</a>;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">packet_send_date_time2</a>), buffsend, pte);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab5b17b5e0773ae87d486823b7505da1b"> 1826</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5b17b5e0773ae87d486823b7505da1b">send_date_time3</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;{</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> atm = { 0, };</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Time &amp; Date #3\n&quot;</span>);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   }</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">packet_send_date_time3</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">packet_send_date_time3</a>));</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;atm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;   buffsend[10] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a> + 1;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   buffsend[11] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">tm_mday</a>;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;   buffsend[12] = (<span class="keywordtype">unsigned</span> char) atm.<a class="code" href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">tm_hour</a>;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   buffsend[13] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) atm.<a class="code" href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">tm_min</a>;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">packet_send_date_time3</a>), buffsend, pte);</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9"> 1844</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;{</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending set blink\n&quot;</span>);</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">packet_send_blink_cursor</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">packet_send_blink_cursor</a>));</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">packet_send_blink_cursor</a>), buffsend, pte);</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;}</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">/* pos : 0xab (a=0/2/4 = line ; b = row) */</span></div><div class="line"><a name="l01856"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348"> 1856</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos)</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;{</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending set cursor position\n&quot;</span>);</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   }</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">packet_send_set_pos_cursor</a>,</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">packet_send_set_pos_cursor</a>));</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   buffsend[11] = pos;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">packet_send_set_pos_cursor</a>), buffsend, pte);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;}</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99"> 1869</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971">charset</a>)</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;{</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* packet_send_charset;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   <span class="keywordtype">int</span> packet_size;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending set default charset\n&quot;</span>);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;   <span class="keywordflow">if</span> (charset == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a6590815d4822784877fe529852565e7b">LANG_DEFAULT</a>) {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      charset = options_languages[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)].<a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;   }</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;   <span class="keywordflow">switch</span> (charset) {</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971af9312dd529fbb0d5abbd726b34d3f927">ISO_8859_2</a>:</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      packet_send_charset = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a977571324fa31e1c1c049f7b6e23cbd4">packet_send_charset_iso_8859_2</a>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      packet_size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a977571324fa31e1c1c049f7b6e23cbd4">packet_send_charset_iso_8859_2</a>);</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a330a758072a52c7ab6307cd9b87d4939">ISO_8859_4</a>:</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      packet_send_charset = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a95e87aaaae8e8f48324d3ec9c7824aab">packet_send_charset_iso_8859_4</a>;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      packet_size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a95e87aaaae8e8f48324d3ec9c7824aab">packet_send_charset_iso_8859_4</a>);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7">ISO_8859_5</a>:</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      packet_send_charset = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7f8d93f20c2e85b18cb72b434d51082e">packet_send_charset_iso_8859_5</a>;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      packet_size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7f8d93f20c2e85b18cb72b434d51082e">packet_send_charset_iso_8859_5</a>);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971ac5f9a649f6ce46a04ab887c56930ebee">ISO_2022_JP</a>:</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      packet_send_charset = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f335e3e51c36b21ee50335da3dd29fa">packet_send_charset_iso_2022_jp</a>;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      packet_size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f335e3e51c36b21ee50335da3dd29fa">packet_send_charset_iso_2022_jp</a>);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">ISO_8859_1</a>:</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      packet_send_charset = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a61b324f2b83bb3abddb8a49e84251">packet_send_charset_iso_8859_1</a>;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      packet_size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a61b324f2b83bb3abddb8a49e84251">packet_send_charset_iso_8859_1</a>);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, packet_send_charset, packet_size);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + packet_size, buffsend, pte);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;}</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div><div class="line"><a name="l01907"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#adfddefd9aad65eccfcb25444e02a0e73"> 1907</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adfddefd9aad65eccfcb25444e02a0e73">rcv_resume_connection_with_server</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;{</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;ResumeConnectionWithServer received\n&quot;</span>);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending packet_send_query_mac_address\n&quot;</span>);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">packet_send_query_mac_address</a>,</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">packet_send_query_mac_address</a>));</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">packet_send_query_mac_address</a>), buffsend, pte);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa5da8becb21e619d6156d74e898af2b4"> 1920</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5da8becb21e619d6156d74e898af2b4">unistim_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s)</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;{</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">macaddr</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>)) {</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;         <span class="comment">/* XXX Deal with IP authentication */</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;         s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a> = s;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a833a6a7242f366ed7edcc08c0a415639">DEFAULT_CODEC</a>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      }</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   }</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;   <span class="keywordflow">if</span> (!d) {</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;   }</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;}</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2926c60feddaf16066ce69f3a0a90d76"> 1947</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2926c60feddaf16066ce69f3a0a90d76">unistim_line_copy</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *dst, <span class="keyword">struct</span> <a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *src)</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;{</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = src-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;   memcpy(dst, src, <span class="keyword">sizeof</span>(*dst)); <span class="comment">/* this over writes the cap ptr, so we have to reset it */</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;   src-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a> = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(src-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, dst-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;}</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div><div class="line"><a name="l01955"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#add4816b578cc4c9c34f35f5e0d216acb"> 1955</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4816b578cc4c9c34f35f5e0d216acb">unistim_line_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l)</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;{</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;   <span class="keywordflow">if</span> (!l) {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;   }</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, -1);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(l);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;}</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div><div class="line"><a name="l01965"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#accecc036574242b46fa0ae6bee663712"> 1965</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#accecc036574242b46fa0ae6bee663712">unistim_line_alloc</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;{</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   <span class="keywordflow">if</span> (!(l = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*l)))) {</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;   }</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   <span class="keywordflow">if</span> (!(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a> = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>))) {</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(l);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;   }</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   <span class="keywordflow">return</span> l;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;}</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div><div class="line"><a name="l01979"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36"> 1979</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36">unistim_free_sub</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Released sub %u of channel %s@%s\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;}</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e"> 1988</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keywordtype">int</span> x)</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;{</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;   <span class="keywordflow">if</span> (!(sub = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*sub)))) {</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   }</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Allocating UNISTIM subchannel #%d on %s ptr=%p\n&quot;</span>, x, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, sub);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   }</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = x;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>);</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;}</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8"> 2007</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;{</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *s;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, s, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>) {</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      }</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keywordflow">if</span> (s != sub) {</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36">unistim_free_sub</a>(sub);</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;   }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;}</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aba890d62815801e923269e0bf18117d5"> 2027</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aba890d62815801e923269e0bf18117d5">subtype_tostr</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;{</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>:</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;REAL&quot;</span>;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>:</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;RINGING&quot;</span>;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>:</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;THREEWAY&quot;</span>;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;}</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38"> 2040</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;{</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a>:</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;INIT&quot;</span>;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>:</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;AUTHDENY&quot;</span>;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>:</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;MAINPAGE&quot;</span>;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>:</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;EXTENSION&quot;</span>;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>:</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;DIALPAGE&quot;</span>;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a>:</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;RINGING&quot;</span>;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>:</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;CALL&quot;</span>;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a>:</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;SELECTOPTION&quot;</span>;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a>:</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;SELECTCODEC&quot;</span>;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>:</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;SELECTLANGUAGE&quot;</span>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">STATE_CLEANING</a>:</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;CLEARING&quot;</span>;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">STATE_HISTORY</a>:</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;HISTORY&quot;</span>;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div><div class="line"><a name="l02071"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad8955045150b25a87aff07813dc383ae"> 2071</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad8955045150b25a87aff07813dc383ae">rcv_mac_addr</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;{</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>, i = 0;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   <span class="keywordtype">char</span> addrmac[19];</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;   <span class="keywordflow">for</span> (tmp = 15; tmp &lt; 15 + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>; tmp++) {</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      sprintf(&amp;addrmac[i], <span class="stringliteral">&quot;%02hhx&quot;</span>, buf[tmp]);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      i += 2;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;   }</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;MAC Address received: %s\n&quot;</span>, addrmac);</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;   }</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;   strcpy(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">macaddr</a>, addrmac);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   res = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5da8becb21e619d6156d74e898af2b4">unistim_register</a>(pte);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a>) {</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">AUTOPROVISIONING_NO</a>:</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No entry found for this phone : %s\n&quot;</span>, addrmac);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12">AUTOPROVISIONING_YES</a>:</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;         {</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *newd = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *newl = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *l = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;New phone, autoprovisioning on\n&quot;</span>);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            }</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <span class="comment">/* First : locate the [template] section */</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;               <span class="keywordflow">if</span> (strcasecmp(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, <span class="stringliteral">&quot;template&quot;</span>)) {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                  d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;               }</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;               <span class="comment">/* Found, cloning this entry */</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;               <span class="keywordflow">if</span> (!(newd = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*newd)))) {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                  <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                  <span class="keywordflow">return</span>;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;               }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;               memcpy(newd, d, <span class="keyword">sizeof</span>(*newd));</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;               <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;newd-&gt;lock);</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;               newd-&gt;lines.first = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;               newd-&gt;lines.last = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>) {</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                  <span class="keywordflow">if</span> (!(newl = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#accecc036574242b46fa0ae6bee663712">unistim_line_alloc</a>())) {</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                  }</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2926c60feddaf16066ce69f3a0a90d76">unistim_line_copy</a>(l, newl);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                  newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a> = newd;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                  <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, l-&gt;name, <span class="keyword">sizeof</span>(newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>));</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                  snprintf(newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>, <span class="keyword">sizeof</span>(newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>), <span class="stringliteral">&quot;USTM/%s@%s&quot;</span>,</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                         newl-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, newd-&gt;name);</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                  snprintf(l-&gt;name, <span class="keyword">sizeof</span>(l-&gt;name), <span class="stringliteral">&quot;%d&quot;</span>, atoi(l-&gt;name) + 1);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;newd-&gt;lines);</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;newd-&gt;lines, newl, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>);</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;newd-&gt;lines);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;               }</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;               <span class="keywordflow">if</span> (!newl) {</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(newd);</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                  <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;               }</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;               <span class="comment">/* Ok, now updating some fields */</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(newd-&gt;id, addrmac, <span class="keyword">sizeof</span>(newd-&gt;id));</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(newd-&gt;name, addrmac, <span class="keyword">sizeof</span>(newd-&gt;name));</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;               <span class="keywordflow">if</span> (newd-&gt;extension == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">EXTENSION_NONE</a>) {</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                  newd-&gt;extension = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;               }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;               newd-&gt;receiver_state = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;               newd-&gt;session = pte;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;               newd-&gt;language[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;               newd-&gt;to_delete = -1;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;               newd-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> = newd;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;               <span class="comment">/* Go to the end of the linked chain */</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;               <span class="keywordflow">while</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>) {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                  d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;               }</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;               d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a> = newd;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;               d = newd;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            }</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            <span class="keywordflow">if</span> (!d) {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No entry [template] found in unistim.conf\n&quot;</span>);</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            }</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;         }</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a>:</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Internal error : unknown autoprovisioning value = %u\n&quot;</span>,</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a>);</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      }</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;   }</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>) {</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *line;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Device &#39;%s&#39; successfuly registered\n&quot;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>) {</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;         <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Subchannel lost sice reboot. Hanged channel may apear!\n&quot;</span>);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub);</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;         }</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      }</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      <span class="keywordflow">switch</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a>) {</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">EXTENSION_NONE</a>:</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>:</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;         <span class="comment">/* Checking if we already have an extension number */</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>)) {</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            <span class="comment">/* Yes, because of a phone reboot. We don&#39;t ask again for the TN */</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341">register_extension</a>(pte)) {</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            }</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;         }</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd">EXTENSION_LINE</a>:</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;         line = <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                     <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>));</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341">register_extension</a>(pte)) {</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;         }</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>:</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;         <span class="comment">/* If we are here, it&#39;s because of a phone reboot */</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Internal error, extension value unknown : %u\n&quot;</span>,</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;               pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a>);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      }</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;   }</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>) {</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>) {</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      }</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;   }</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;\nSending S1\n&quot;</span>);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;   }</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;   memcpy(buffsend + SIZE_HEADER, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">packet_send_S1</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">packet_send_S1</a>));</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(SIZE_HEADER + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">packet_send_S1</a>), buffsend, pte);</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending query_basic_manager_04\n&quot;</span>);</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   }</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;   memcpy(buffsend + SIZE_HEADER, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">packet_send_query_basic_manager_04</a>,</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">packet_send_query_basic_manager_04</a>));</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(SIZE_HEADER + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">packet_send_query_basic_manager_04</a>), buffsend, pte);</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending query_basic_manager_10\n&quot;</span>);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;   }</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;   memcpy(buffsend + SIZE_HEADER, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">packet_send_query_basic_manager_10</a>,</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">packet_send_query_basic_manager_10</a>));</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(SIZE_HEADER + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">packet_send_query_basic_manager_10</a>), buffsend, pte);</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a546d1d18e6b4db23aa313bb0a77bac18">send_date_time</a>(pte);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;}</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div><div class="line"><a name="l02260"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8"> 2260</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8">write_entry_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, FILE * f, <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, <span class="keywordtype">char</span> *line1)</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;{</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;   <span class="keywordflow">if</span> (fwrite(&amp;c, 1, 1, f) != 1) {</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write history log header.&quot;</span>);</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   }</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <span class="keywordflow">if</span> (fwrite(line1, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, f) != 1) {</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write history entry - date.&quot;</span>);</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;   }</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;   <span class="keywordflow">if</span> (fwrite(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, f) != 1) {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write history entry - callerid.&quot;</span>);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;   }</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <span class="keywordflow">if</span> (fwrite(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1869e7c6a5d9af9022043731b551f3b">lst_cnm</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, f) != 1) {</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write history entry - callername.&quot;</span>);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;}</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e"> 2281</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e">write_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> way, <span class="keywordtype">char</span> ismissed)</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;{</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8c9568e97903db39b211a5fef52cf39d">AST_CONFIG_MAX_PATH</a>], tmp2[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8c9568e97903db39b211a5fef52cf39d">AST_CONFIG_MAX_PATH</a>];</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;   <span class="keywordtype">char</span> line1[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> + 1];</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;   <span class="keywordtype">char</span> count = 0, *histbuf;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   FILE *f, *f2;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> atm = { 0, };</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;   }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">callhistory</a>) {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;   <span class="keywordflow">if</span> (strchr(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, <span class="charliteral">&#39;/&#39;</span>) || (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>[0] == <span class="charliteral">&#39;.&#39;</span>)) {</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Account code &#39;%s&#39; insecure for writing file\n&quot;</span>,</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">USTM_LOG_DIR</a>);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a>(tmp, 0770)) {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create directory for history\n&quot;</span>);</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;   }</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;now, &amp;atm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;   <span class="keywordflow">if</span> (ismissed) {</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keywordflow">if</span> (way == <span class="charliteral">&#39;i&#39;</span>) {</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp2, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Miss&quot;</span>, pte), <span class="keyword">sizeof</span>(tmp2));</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp2, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Fail&quot;</span>, pte), <span class="keyword">sizeof</span>(tmp2));</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      }</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp2, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Answ&quot;</span>, pte), <span class="keyword">sizeof</span>(tmp2));</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;   }</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   snprintf(line1, <span class="keyword">sizeof</span>(line1), <span class="stringliteral">&quot;%04d/%02d/%02d %02d:%02d:%02d %s&quot;</span>,</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;          atm.<a class="code" href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">tm_year</a> + 1900, atm.<a class="code" href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">tm_mon</a> + 1, atm.<a class="code" href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">tm_mday</a>, atm.<a class="code" href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">tm_hour</a>,</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          atm.<a class="code" href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">tm_min</a>, atm.<a class="code" href="../../d5/d84/structast__tm.html#a18df301c1a10c8d493da86ce5c2aea78">tm_sec</a>, tmp2);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;   snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%s/%s/%s-%c.csv&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a>,</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;          <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">USTM_LOG_DIR</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, way);</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;   <span class="keywordflow">if</span> ((f = fopen(tmp, <span class="stringliteral">&quot;r&quot;</span>))) {</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="keyword">struct </span>stat bufstat;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keywordflow">if</span> (stat(tmp, &amp;bufstat)) {</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to stat history log.&quot;</span>);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;         fclose(f);</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      }</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      size = 1 + (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a> * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> * 3);</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keywordflow">if</span> (bufstat.st_size != size) {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;               <span class="stringliteral">&quot;History file %s has an incorrect size (%d instead of %d). It will be replaced by a new one.&quot;</span>,</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;               tmp, (<span class="keywordtype">int</span>) bufstat.st_size, size);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;         fclose(f);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;         f = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;         count = 1;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   }</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   <span class="comment">/* If we can&#39;t open the log file, we create a brand new one */</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;   <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = 1;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != ENOENT) &amp;&amp; (count == 0)) {</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to open history log.&quot;</span>);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      }</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      f = fopen(tmp, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      <span class="keywordflow">if</span> (!f) {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to create history log.&quot;</span>);</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      }</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8">write_entry_history</a>(pte, f, c, line1)) {</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;         fclose(f);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      }</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      memset(line1, <span class="charliteral">&#39; &#39;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      <span class="keywordflow">for</span> (i = 3; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a> * 3; i++) {</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;         <span class="keywordflow">if</span> (fwrite(line1, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, f) != 1) {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write history entry - stuffing.&quot;</span>);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            fclose(f);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;         }</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      }</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keywordflow">if</span> (fclose(f)) {</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to close history - creation.&quot;</span>);</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      }</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   <span class="comment">/* We can open the log file, we create a temporary one, we add our entry and copy the rest */</span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   <span class="keywordflow">if</span> (fread(&amp;count, 1, 1, f) != 1) {</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to read history header.&quot;</span>);</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      fclose(f);</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   }</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   <span class="keywordflow">if</span> (count &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>) {</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid count in history header of %s (%d max %d)\n&quot;</span>, tmp,</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            count, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>);</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      fclose(f);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   }</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   snprintf(tmp2, <span class="keyword">sizeof</span>(tmp2), <span class="stringliteral">&quot;%s/%s/%s-%c.csv.tmp&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a>,</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;          <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">USTM_LOG_DIR</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, way);</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;   <span class="keywordflow">if</span> (!(f2 = fopen(tmp2, <span class="stringliteral">&quot;w&quot;</span>))) {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to create temporary history log.&quot;</span>);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      fclose(f);</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;   }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <span class="keywordflow">if</span> (++count &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>) {</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      count = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;   }</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8">write_entry_history</a>(pte, f2, count, line1)) {</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      fclose(f);</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      fclose(f2);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;   }</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;   size = (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a> - 1) * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> * 3;</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;   <span class="keywordflow">if</span> (!(histbuf = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(size))) {</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      fclose(f);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      fclose(f2);</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;   <span class="keywordflow">if</span> (fread(histbuf, size, 1, f) != 1) {</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(histbuf);</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      fclose(f);</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      fclose(f2);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to read previous history entries.&quot;</span>);</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;   }</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   <span class="keywordflow">if</span> (fwrite(histbuf, size, 1, f2) != 1) {</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(histbuf);</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      fclose(f);</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      fclose(f2);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to write previous history entries.&quot;</span>);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(histbuf);</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;   <span class="keywordflow">if</span> (fclose(f)) {</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to close history log.&quot;</span>);</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   }</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <span class="keywordflow">if</span> (fclose(f2)) {</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to close temporary history log.&quot;</span>);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   }</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;   <span class="keywordflow">if</span> (unlink(tmp)) {</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to remove old history log.&quot;</span>);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;   }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;   <span class="keywordflow">if</span> (rename(tmp2, tmp)) {</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to rename new history log.&quot;</span>);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   }</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;}</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a624e9f7955f757d82cbc79553a1c8865"> 2440</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a624e9f7955f757d82cbc79553a1c8865">attempt_transfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *p1, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *p2)</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;{</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, chana, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, chanb, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;   <span class="keywordflow">if</span> (!p1-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> || !p2-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Transfer attempted without dual ownership?\n&quot;</span>);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   }</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;   chana = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(p1-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;   chanb = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(p2-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d4/d56/bridge_8h.html#aec45146e91e4d8bc2a7d2cf083c4dac0">ast_bridge_transfer_attended</a>(chana, chanb)) {</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>:</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Transfer failed. Invalid bridge setup\n&quot;</span>);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a>:</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Transfer not permitted\n&quot;</span>);</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>:</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Transfer encountered internal error\n&quot;</span>);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>:</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   }</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;   <span class="comment">/* Control only reaches this point if transfer has failed */</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae90da1877e143b996d202d4c88a9c862">ast_softhangup_nolock</a>(chana, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a>);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae90da1877e143b996d202d4c88a9c862">ast_softhangup_nolock</a>(chanb, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a>);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455"> 2472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keywordtype">char</span> *callerid)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;   <span class="keywordtype">char</span> *data;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;   <span class="keywordflow">if</span> (type) {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      data = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1869e7c6a5d9af9022043731b551f3b">lst_cnm</a>;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      data = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   }</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   <span class="comment">/* This is very nearly strncpy(), except that the remaining buffer</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">    * is padded with &#39; &#39;, instead of &#39;\0&#39; */</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;   memset(data, <span class="charliteral">&#39; &#39;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;   size = strlen(callerid);</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;   <span class="keywordflow">if</span> (size &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>) {</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      size = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;   }</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;   memcpy(data, callerid, size);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;}</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div><div class="line"><a name="l02493"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef"> 2493</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a>* <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *device, <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;{</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>) {</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == type) {</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      }</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   }</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;}</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div><div class="line"><a name="l02511"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac0a38da3415792f925843ac9dc50e86d"> 2511</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a>* <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac0a38da3415792f925843ac9dc50e86d">get_sub_holding</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *device, <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a>)</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;{</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>) {</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      }</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == type &amp;&amp; sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a> == holding) {</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      }</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   }</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;}</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div><div class="line"><a name="l02529"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#adc081386f3fc6b3a00b036928e688937"> 2529</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adc081386f3fc6b3a00b036928e688937">sub_start_silence</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;{</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <span class="comment">/* Silence our channel */</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a>) {</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a> =</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a2a2e0ff24c57491a877cac39cb670024">ast_channel_start_silence_generator</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to start a silence generator.\n&quot;</span>);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Starting silence generator\n&quot;</span>);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      }</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   }</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;}</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div><div class="line"><a name="l02544"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5"> 2544</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5">sub_stop_silence</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;{</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   <span class="comment">/* Stop the silence generator */</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a>) {</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Stopping silence generator\n&quot;</span>);</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a6643cbe766a051d2d06750ab5b3e933d">ast_channel_stop_silence_generator</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a>);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Trying to stop silence generator on a null channel!\n&quot;</span>);</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      }</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">silence_generator</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;   }</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;}</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;</div><div class="line"><a name="l02560"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31"> 2560</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;{</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;   }</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 1;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a> = 1;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab7a1662ad66c828762decbf7beaebf01">FAV_ICON_ONHOLD_BLACK</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a279e2c56f8e7d134934fae508d620cc5">FAV_BLINK_SLOW</a>, pte);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>);</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a>(pte);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab2e0a6897707b1102ad453ea0963999f">ast_queue_hold</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   }</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;}</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div><div class="line"><a name="l02576"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a246466696bf607e23312e5378f332b3c"> 2576</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a246466696bf607e23312e5378f332b3c">sub_unhold</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;{</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *sub_real;</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   sub_real = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;   <span class="keywordflow">if</span> (sub_real) {</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;       <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub_real);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;   }</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 0;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a> = 0;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a>, pte);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a>(pte);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3">send_start_rtp</a>(sub);</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      }</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;   }</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;}</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;</div><div class="line"><a name="l02599"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051"> 2599</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;{</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, *sub_transf;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   sub_transf = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a>(pte);</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Close call without sub\n&quot;</span>);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;   }</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, pte);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a> = 1;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <span class="keywordflow">if</span> (sub_transf) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;         sub_transf-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a> = 1;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a624e9f7955f757d82cbc79553a1c8865">attempt_transfer</a>(sub, sub_transf) &lt; 0) {</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;attempt_transfer failed.\n&quot;</span>);</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;         }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a30bcf0418189567bc84ff32034f79f28">ast_queue_hangup</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      }</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      <span class="keywordflow">if</span> (sub_transf) {</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;         <span class="keywordflow">if</span> (sub_transf-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a>(sub_transf-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;threeway sub without owner\n&quot;</span>);</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;         }</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;USTM(%s@%s-%d) channel already destroyed\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                  pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      }</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(pte, 0, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(pte, 1, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e">write_history</a>(pte, <span class="charliteral">&#39;o&#39;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a>);</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;}</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div><div class="line"><a name="l02641"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad99329ea1d90e83ad194250726f07947"> 2641</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad99329ea1d90e83ad194250726f07947">ignore_call</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;{</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(pte);</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;}</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div><div class="line"><a name="l02647"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae478d437699e68f3bb150c2c531ff551"> 2647</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae478d437699e68f3bb150c2c531ff551">discard_call</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;{</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a>* <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>);</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;       <span class="keywordflow">return</span>;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   }</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;}</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a049e610f9af2278aea2b20bc74725429"> 2659</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a049e610f9af2278aea2b20bc74725429">unistim_ss</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;{</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s = l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;   <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;   }</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Starting switch on &#39;%s@%s-%d&#39; to %s\n&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a018b7a29cef2d62074dc46e9aaad0d1a">ast_channel_exten_set</a>(chan, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   <a class="code" href="../../d9/d95/channelstate_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448">ast_setstate</a>(chan, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a10482c2bc6340e09ed02b00bc0e3f433">AST_STATE_RING</a>);</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>,</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;               <span class="keyword">sizeof</span>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>));</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;   res = <a class="code" href="../../db/de0/pbx_8h.html#a44b6406c9220f7f2b610ac712369f405">ast_pbx_run</a>(chan);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;PBX exited non-zero\n&quot;</span>);</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(s, 1000, 0);</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;   }</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;}</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div><div class="line"><a name="l02685"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1d6cb4c6b51d44ec70be9f6e722ccf99"> 2685</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d6cb4c6b51d44ec70be9f6e722ccf99">find_rtp_port</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *s)</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;{</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   <span class="keywordtype">int</span> rtp_start = s-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">rtp_port</a>;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> us_tmp;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;   <span class="keyword">struct </span>sockaddr_in us = { 0, };</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;s-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;s-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, list) {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      }</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;         <a class="code" href="../../d5/dde/rtp__engine_8h.html#a5665ad0c5abe3c26005c39d6a3680fa1">ast_rtp_instance_get_remote_address</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, &amp;us_tmp);</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;         <a class="code" href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a>(&amp;us_tmp, &amp;us);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;         <span class="keywordflow">if</span> (htons(us.sin_port)) {</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            rtp_start = htons(us.sin_port) + 1;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;         }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      }</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;   }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;s-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;   <span class="keywordflow">return</span> rtp_start;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;}</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3"> 2710</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3">send_start_rtp</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;{</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   <span class="keywordtype">int</span> codec;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;   <span class="keyword">struct </span>sockaddr_in public = { 0, };</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;   <span class="keyword">struct </span>sockaddr_in us = { 0, };</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;   <span class="keyword">struct </span>sockaddr_in sin = { 0, };</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> us_tmp;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> sin_tmp;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#a80baeff1bd121c3168ede2a955e9b3a2">ast_rtp_instance_get_local_address</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, &amp;us_tmp);</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a>(&amp;us_tmp, &amp;us);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#a5665ad0c5abe3c26005c39d6a3680fa1">ast_rtp_instance_get_remote_address</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, &amp;sin_tmp);</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a>(&amp;sin_tmp, &amp;sin);</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   <span class="comment">/* Setting up RTP of the phone */</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>.sin_family == 0) {  <span class="comment">/* NAT IP override ?   */</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      memcpy(&amp;<span class="keyword">public</span>, &amp;us, <span class="keyword">sizeof</span>(<span class="keyword">public</span>));   <span class="comment">/* No defined, using IP from recvmsg  */</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      memcpy(&amp;<span class="keyword">public</span>, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>, <span class="keyword">sizeof</span>(<span class="keyword">public</span>));    <span class="comment">/* override  */</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;   }</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;RTP started : Our IP/port is : %s:%hd with codec %s\n&quot;</span>,</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;          <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(us.sin_addr),</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;          htons(us.sin_port), <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)));</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Starting phone RTP stack. Our public IP is %s\n&quot;</span>,</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;               <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;   }</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;   pte = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   codec = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a8631c44e7160622bcbdc6aea8b449e5f">ast_rtp_codecs_payload_code_tx</a>(<a class="code" href="../../d5/dde/rtp__engine_8h.html#a0376aa2503a185437fab8cb0b7d674fb">ast_rtp_instance_get_codecs</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>),</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      1, <a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), 0);</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) ||</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>)) {</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending packet_send_rtp_packet_size for codec %d\n&quot;</span>, codec);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      }</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">packet_send_rtp_packet_size</a>,</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">packet_send_rtp_packet_size</a>));</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      buffsend[10] = (int) codec &amp; 0xffffffffLL;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">packet_send_rtp_packet_size</a>), buffsend, pte);</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;   }</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Jitter Buffer Parameters Configuration\n&quot;</span>);</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;   }</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">packet_send_jitter_buffer_conf</a>,</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;         <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">packet_send_jitter_buffer_conf</a>));</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">packet_send_jitter_buffer_conf</a>), buffsend, pte);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> != 0) {</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      uint16_t rtcpsin_port = ntohs(us.sin_port) + 1; <span class="comment">/* RTCP port is RTP + 1 */</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending OpenAudioStreamTX using method #%d\n&quot;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a>);</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      }</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> == 3) {</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;         memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9a202389ce76e2c9a3a6ec4883bacb6e">packet_send_open_audio_stream_tx3</a>,</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;               <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9a202389ce76e2c9a3a6ec4883bacb6e">packet_send_open_audio_stream_tx3</a>));</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">packet_send_open_audio_stream_tx</a>,</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;               <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">packet_send_open_audio_stream_tx</a>));</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      }</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> != 2) {</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;         memcpy(buffsend + 28, &amp;<span class="keyword">public</span>.sin_addr, <span class="keyword">sizeof</span>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[20], sin.sin_port);</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[22], htons(rtcpsin_port));</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[24], us.sin_port);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[26], htons(rtcpsin_port));</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;         memcpy(buffsend + 23, &amp;<span class="keyword">public</span>.sin_addr, <span class="keyword">sizeof</span>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[15], sin.sin_port);</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[19], us.sin_port);</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      }</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      buffsend[11] = codec; <span class="comment">/* rx */</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      buffsend[12] = codec; <span class="comment">/* tx */</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">packet_send_open_audio_stream_tx</a>), buffsend, pte);</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending OpenAudioStreamRX\n&quot;</span>);</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      }</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> == 3) {</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;         memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad13a5fa92094321a806cf334e9f77073">packet_send_open_audio_stream_rx3</a>,</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;               <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad13a5fa92094321a806cf334e9f77073">packet_send_open_audio_stream_rx3</a>));</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;         memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">packet_send_open_audio_stream_rx</a>,</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;               <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">packet_send_open_audio_stream_rx</a>));</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      }</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> != 2) {</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;         memcpy(buffsend + 28, &amp;<span class="keyword">public</span>.sin_addr, <span class="keyword">sizeof</span>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[20], sin.sin_port);</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[22], htons(rtcpsin_port));</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[24], us.sin_port);</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[26], htons(rtcpsin_port));</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;         memcpy(buffsend + 23, &amp;<span class="keyword">public</span>.sin_addr, <span class="keyword">sizeof</span>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[15], sin.sin_port);</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;         <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[19], us.sin_port);</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      }</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      buffsend[11] = codec; <span class="comment">/* rx */</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      buffsend[12] = codec; <span class="comment">/* tx */</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">packet_send_open_audio_stream_rx</a>), buffsend, pte);</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      uint16_t rtcpsin_port = htons(us.sin_port) + 1; <span class="comment">/* RTCP port is RTP + 1 */</span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending packet_send_call default method\n&quot;</span>);</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      }</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">packet_send_call</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">packet_send_call</a>));</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      memcpy(buffsend + 53, &amp;<span class="keyword">public</span>.sin_addr, <span class="keyword">sizeof</span>(<span class="keyword">public</span>.sin_addr));</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      <span class="comment">/* Destination port when sending RTP */</span></div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[49], us.sin_port);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="comment">/* Destination port when sending RTCP */</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[51], htons(rtcpsin_port));</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      <span class="comment">/* Codec */</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      buffsend[40] = codec;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      buffsend[41] = codec;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;         buffsend[42] = 1;       <span class="comment">/* 1 = 20ms (160 bytes), 2 = 40ms (320 bytes) */</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;         buffsend[42] = 1;       <span class="comment">/* 1 = 20ms (160 bytes), 2 = 40ms (320 bytes) */</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#a771306b3301213eb2f0a409d3d0f42df">ast_format_g723</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;         buffsend[42] = 2;       <span class="comment">/* 1 = 30ms (24 bytes), 2 = 60 ms (48 bytes) */</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../db/d1c/format__cache_8h.html#ae4848b177c158d817294f2b0b447f66e">ast_format_g729</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>) {</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;         buffsend[42] = 2;       <span class="comment">/* 1 = 10ms (10 bytes), 2 = 20ms (20 bytes) */</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unsupported codec %s!\n&quot;</span>,</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)));</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      }</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="comment">/* Source port for transmit RTP and Destination port for receiving RTP */</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[45], sin.sin_port);</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <a class="code" href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a>(&amp;buffsend[47], htons(rtcpsin_port));</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">packet_send_call</a>), buffsend, pte);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   }</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;</div><div class="line"><a name="l02847"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4e6e7d24b225c0a6823401b9cfaca82f"> 2847</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e6e7d24b225c0a6823401b9cfaca82f">start_rtp</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;{</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   <span class="keyword">struct </span>sockaddr_in sin = { 0, };</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   <span class="keyword">struct </span>sockaddr_in sout = { 0, };</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> sin_tmp;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> sout_tmp;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;   <span class="comment">/* Sanity checks */</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;start_rtp with a null subchannel !\n&quot;</span>);</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;   }</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>) {</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;start_rtp with a null line!\n&quot;</span>);</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   }</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>) {</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;start_rtp with a null device!\n&quot;</span>);</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;   }</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;start_rtp with a null session!\n&quot;</span>);</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   }</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;start_rtp with a null asterisk channel!\n&quot;</span>);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   }</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;   sout = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;   <span class="comment">/* Allocate the RTP */</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Starting RTP. Bind on %s\n&quot;</span>, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(sout.sin_addr));</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   }</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#ad68264a6784dc22570eda3cb447307f8">ast_sockaddr_from_sin</a>(&amp;sout_tmp, &amp;sout);</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a> = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a012b2ab9fad02a5fbf9e457a69020ade">ast_rtp_instance_new</a>(<span class="stringliteral">&quot;asterisk&quot;</span>, sched, &amp;sout_tmp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create RTP session: %s binaddr=%s\n&quot;</span>,</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;            strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>), <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(sout.sin_addr));</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;   }</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#a77f59605d15d7dfc53e0df12352b8235">ast_rtp_instance_set_prop</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, <a class="code" href="../../d5/dde/rtp__engine_8h.html#a9ff41b61938f3d4dc4c82db103e7914ca9f63c95936712cfd6ec65555f1a27053">AST_RTP_PROPERTY_RTCP</a>, 1);</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#ab88c871dd5c164b7a0a6af5e7e12d16f">ast_rtp_instance_set_channel_id</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>));</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, <a class="code" href="../../d5/dde/rtp__engine_8h.html#aee3ef7f9e53a34e743c3a95c9ca95fb4">ast_rtp_instance_fd</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 0));</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 1, <a class="code" href="../../d5/dde/rtp__engine_8h.html#aee3ef7f9e53a34e743c3a95c9ca95fb4">ast_rtp_instance_fd</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 1));</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#ab71294e675bc01eb29e9fd13b3839759">ast_rtp_instance_set_qos</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.tos_audio, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.cos_audio, <span class="stringliteral">&quot;UNISTIM RTP&quot;</span>);</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#a77f59605d15d7dfc53e0df12352b8235">ast_rtp_instance_set_prop</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, <a class="code" href="../../d5/dde/rtp__engine_8h.html#a9ff41b61938f3d4dc4c82db103e7914ca0f994311315c8d856b8298bc22f7e007">AST_RTP_PROPERTY_NAT</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ada540a5f25f7302dc1a3d17ccfa59b10">nat</a>);</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;   <span class="comment">/* Create the RTP connection */</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;   sin.sin_family = AF_INET;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;   <span class="comment">/* Setting up RTP for our side */</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;   memcpy(&amp;sin.sin_addr, &amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr,</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;         <span class="keyword">sizeof</span>(sin.sin_addr));</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;   sin.sin_port = htons(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d6cb4c6b51d44ec70be9f6e722ccf99">find_rtp_port</a>(sub));</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#ad68264a6784dc22570eda3cb447307f8">ast_sockaddr_from_sin</a>(&amp;sin_tmp, &amp;sin);</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#a90c48c7f24206e8822bf520dae0a2478">ast_rtp_instance_set_remote_address</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, &amp;sin_tmp);</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3c/format__cap_8h.html#a4fadd3c35438f866e29eddc68283bce6">ast_format_cap_iscompatible_format</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), <a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a>) {</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *tmpfmt;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      tmpfmt = <a class="code" href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), 0);</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;            <span class="stringliteral">&quot;Our read/writeformat has been changed to something incompatible: %s, using %s best codec from %s\n&quot;</span>,</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)),</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;            <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(tmpfmt),</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), &amp;cap_buf));</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab3786cbbff7a03241fc75dafa0c8a1c1">ast_channel_set_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, tmpfmt);</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#afac6d7d115c1edfe3ad8a8c7fa5d59d1">ast_channel_set_writeformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, tmpfmt);</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tmpfmt, -1);</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;   }</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3">send_start_rtp</a>(sub);</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;}</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2c2b35e63a93d06b439b6179f0d9742e"> 2924</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c2b35e63a93d06b439b6179f0d9742e">send_dial_tone</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;{</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dab/structast__tone__zone__sound.html">ast_tone_zone_sound</a> *ts = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d40/structast__tone__zone__part.html">ast_tone_zone_part</a> tone_data;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;   <span class="keywordtype">char</span> *s = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   <span class="keywordtype">char</span> *ind;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   <span class="keywordflow">if</span> ((ts = <a class="code" href="../../d2/d0f/indications_8h.html#a516be2823557000dcd4be685a44d1d09">ast_get_indication_tone</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>, <span class="stringliteral">&quot;dial&quot;</span>))) {</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      ind = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(ts-&gt;<a class="code" href="../../d5/dab/structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      s = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;ind, <span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <a class="code" href="../../d2/d0f/indications_8h.html#a5bd91799d8e718f389e20acc253c5158">ast_tone_zone_part_parse</a>(s, &amp;tone_data);</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, tone_data.<a class="code" href="../../dc/d40/structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, tone_data.<a class="code" href="../../dc/d40/structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>);</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Country code found (%s), freq1=%u freq2=%u\n&quot;</span>,</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                     pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>-&gt;<a class="code" href="../../dd/d77/structast__tone__zone.html#a69f4a4df64289ee342ff49d3fe0ce82e">country</a>, tone_data.<a class="code" href="../../dc/d40/structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, tone_data.<a class="code" href="../../dc/d40/structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>);</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      }</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      ts = <a class="code" href="../../d2/d0f/indications_8h.html#a8b52ace68f21c0ac24414f038471647d">ast_tone_zone_sound_unref</a>(ts);</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   }</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;}</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div><div class="line"><a name="l02944"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348"> 2944</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;{</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> + 1];</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp_number = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Number:&quot;</span>, pte);</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;   <span class="keywordtype">int</span> line, tmp_copy, offset = 0, i;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;   <span class="keywordflow">if</span>  (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad5c32877bf1a61ac2c2c05ca90b41a15">MAX_SCREEN_NUMBER</a>) {</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      offset = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> - <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad5c32877bf1a61ac2c2c05ca90b41a15">MAX_SCREEN_NUMBER</a> - 1;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      <span class="keywordflow">if</span> (offset &gt; strlen(tmp_number)) {</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;         offset = strlen(tmp_number);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      }</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      tmp_copy = strlen(tmp_number) - offset + 1;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      <span class="keywordflow">if</span> (tmp_copy &gt; <span class="keyword">sizeof</span>(tmp)) {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;         tmp_copy = <span class="keyword">sizeof</span>(<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      }</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      memcpy(tmp, tmp_number + offset, tmp_copy);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp, tmp_number, <span class="keyword">sizeof</span>(tmp));</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;   }</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;   offset = (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>) ? (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> - <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> +1) : 0;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>) {</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      memcpy(tmp + strlen(tmp), pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a> + offset, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> - offset + 1);</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;   }</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;   offset = strlen(tmp);</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   <span class="keywordflow">for</span> (i = strlen(tmp); i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>; i++) {</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      tmp[i] = <span class="charliteral">&#39;.&#39;</span>;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;   }</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;   tmp[i] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   line = (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) ? <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a> : <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(line, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (line + offset));</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;}</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div><div class="line"><a name="l02983"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e"> 2983</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;{</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[0] == -1) {</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Enter forward&quot;</span>, pte));</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Fwd    Cancel BackSp Erase&quot;</span>, pte));</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[1] != 0) {</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a> + 1,</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                     <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>));</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a>(pte);</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      }</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>) &amp;&amp;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;         (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>)) {</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      }</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c2b35e63a93d06b439b6179f0d9742e">send_dial_tone</a>(pte);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> &gt; 1) {</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Enter the number to dial&quot;</span>, pte));</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;and press Call&quot;</span>, pte));</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Call          BackSp Erase&quot;</span>, pte));</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Call   Redial BackSp Erase&quot;</span>, pte));</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      }</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   }</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> = 0;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>[0] = 0;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a>(pte);</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a877c878794c4d6ad265f3c6e94fecc1d">FAV_ICON_PHONE_BLACK</a>);</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>, pte);</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a> = -1;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;}</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;</div><div class="line"><a name="l03028"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29"> 3028</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29">swap_subs</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>)</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;{</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> *rtp;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;   <span class="keywordtype">int</span> fds;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Swapping %p and %p\n&quot;</span>, a, b);</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;   }</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   <span class="keywordflow">if</span> ((!a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) || (!b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)) {</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;            <span class="stringliteral">&quot;Attempted to swap subchannels with a null owner : sub #%p=%p sub #%p=%p\n&quot;</span>,</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;            a, a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, b, b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;   }</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;   rtp = a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;   a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a> = b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a> = rtp;</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;   fds = <a class="code" href="../../d5/d7b/channel_8h.html#a8e5cf0a066beee895cfd9048e4abdbb3">ast_channel_fd</a>(a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, <a class="code" href="../../d5/d7b/channel_8h.html#a8e5cf0a066beee895cfd9048e4abdbb3">ast_channel_fd</a>(b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0));</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, fds);</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;   fds = <a class="code" href="../../d5/d7b/channel_8h.html#a8e5cf0a066beee895cfd9048e4abdbb3">ast_channel_fd</a>(a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 1);</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(a-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 1, <a class="code" href="../../d5/d7b/channel_8h.html#a8e5cf0a066beee895cfd9048e4abdbb3">ast_channel_fd</a>(b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 1));</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(b-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 1, fds);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;}</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment">/* Step 1 : Music On Hold for peer, Dialing screen for us */</span></div><div class="line"><a name="l03056"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a07b2e6cad22cbdbd0e3313c6a2e7a65f"> 3056</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a07b2e6cad22cbdbd0e3313c6a2e7a65f">transfer_call_step1</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;{</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> <span class="comment">/*, *sub_trans */</span>;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;   <span class="comment">/* sub_trans = get_sub(d, SUB_THREEWAY); */</span></div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   <span class="keywordflow">if</span> (!sub || !sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to find subchannel for music on hold\n&quot;</span>);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;   }</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   <span class="comment">/* Start music on hold if appropriate */</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a>) {</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Transfer with peer already listening music on hold\n&quot;</span>);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab2e0a6897707b1102ad453ea0963999f">ast_queue_hold</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#abc34958c9b03014779727e5ca61b93e5">musicclass</a>);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 1;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;   }</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adc081386f3fc6b3a00b036928e688937">sub_start_silence</a>(pte, sub);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;}</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;</div><div class="line"><a name="l03080"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab462e9e6f851205e3ba46e2af970cff8"> 3080</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab462e9e6f851205e3ba46e2af970cff8">transfer_cancel_step2</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;{</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, *sub_trans;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   sub_trans = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <span class="keywordflow">if</span> (!sub || !sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to find subchannel for music on hold\n&quot;</span>);</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   }</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;   <span class="keywordflow">if</span> (sub_trans) {</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Transfer canceled, hangup our threeway channel\n&quot;</span>);</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      }</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29">swap_subs</a>(sub, sub_trans);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a>(sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;         sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 0;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;         sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Canceling a threeway channel without owner\n&quot;</span>);</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      }</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   }</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;}</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="comment">/* From phone to PBX */</span></div><div class="line"><a name="l03111"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad"> 3111</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s)</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;{</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;   <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      <span class="comment">/* If sub for threway call created than we use transfer behaviuor */</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *sub_trans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      sub_trans = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      <span class="keywordflow">if</span> (sub_trans) {</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t transfer while active subchannel exists!\n&quot;</span>);</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      }</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to find subchannel with music on hold\n&quot;</span>);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      }</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      sub_trans = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordflow">if</span> (!sub_trans) {</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to allocate three-way subchannel\n&quot;</span>);</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      }</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a> = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5">sub_stop_silence</a>(s, sub);</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(s, 0, 0);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <span class="comment">/* Make new channel */</span></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;      c = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a>(sub_trans, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="keywordflow">if</span> (!c) {</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot allocate new structure on channel %p\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      }</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      <span class="comment">/* Swap things around between the three-way and real call */</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29">swap_subs</a>(sub, sub_trans);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Calling (pre-transfer)&quot;</span>, s));</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dialing...&quot;</span>, s));</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      }</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;TransfrCancel&quot;</span>, s));</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a049e610f9af2278aea2b20bc74725429">unistim_ss</a>, c)) {</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to start simple switch on channel %p\n&quot;</span>, c);</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(c);</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      }</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Started three way call on channel %p (%s) subchan %u\n&quot;</span>,</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;             sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), sub_trans-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>);</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;      }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   }</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   softkey = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a>(s, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;   <span class="keywordflow">if</span> (softkey == -1) {</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Have no avail softkey for calling\n&quot;</span>);</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   }</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   <span class="keywordflow">if</span> (sub) { <span class="comment">/* have already call assigned */</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(s, sub); <span class="comment">/* Need to put on hold */</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   }</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;   <span class="keywordflow">if</span> (!(sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>))) {</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to allocate subchannel!\n&quot;</span>);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   }</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a> = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[softkey];</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[softkey] = <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> = softkey;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Using softkey %d, line %p\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>);</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;   }</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a>, s);</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = -1;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {            <span class="comment">/* A call is already in progress ? */</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6f/structast__features__pickup__config.html">ast_features_pickup_config</a> *, pickup_cfg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *pickupexten;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      c = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a>(sub, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);   <span class="comment">/* No, starting a new one */</span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) { <span class="comment">/* Need to start RTP before calling ast_pbx_run */</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e6e7d24b225c0a6823401b9cfaca82f">start_rtp</a>(sub);</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      }</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(c);</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;         pickup_cfg = <a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#ad9d12b10a3d0c3bca1d0b033bc139dab">ast_get_chan_features_pickup_config</a>(c);</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;         <span class="keywordflow">if</span> (!pickup_cfg) {</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to retrieve pickup configuration options. Unable to detect call pickup extension\n&quot;</span>);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            pickupexten = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;            pickupexten = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(pickup_cfg-&gt;pickupexten);</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;         }</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(c);</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      }</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      <span class="keywordflow">if</span> (c &amp;&amp; !strcmp(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pickupexten)) {</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Try to pickup in unistim_new\n&quot;</span>);</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;         }</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a>(s);</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dd/dbc/pickup_8h.html#a4890be42c2add5f52028705d6bc02201">ast_pickup_call</a>(c)) {</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Nothing to pick up\n&quot;</span>);</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(c, <a class="code" href="../../d4/da3/causes_8h.html#a9900b24b261c275bb54631f16d4d38cc">AST_CAUSE_CALL_REJECTED</a>);</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(c, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;         }</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(c);</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;         c = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(s, 0, 0); <span class="comment">/* Dialing empty number should also stop dial tone */</span></div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;         <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;            <span class="keywordflow">if</span> (strlen(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>) &gt; 0) {</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Calling...&quot;</span>, s));</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            }</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Calling :&quot;</span>, s));</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>);</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dialing...&quot;</span>, s));</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;         }</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;                     Hangup&quot;</span>, s));</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;         <span class="comment">/* start switch */</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a049e610f9af2278aea2b20bc74725429">unistim_ss</a>, c)) {</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create switch thread\n&quot;</span>);</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">ss_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a>(c, <a class="code" href="../../d4/da3/causes_8h.html#a02b3785262e0be6843e8e9d235d8d78d">AST_CAUSE_SWITCH_CONGESTION</a>);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;         }</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create channel for %s@%s\n&quot;</span>,</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;               sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Current sub [%s] already has owner\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>));</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;   }</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;}</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">/* From PBX to phone */</span></div><div class="line"><a name="l03262"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e"> 3262</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s)</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;{</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;   s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(s);</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>); <span class="comment">/* Put other SUB_REAL call on hold */</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No ringing lines on: %s\n&quot;</span>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;   <span class="comment">/* Change icons for all ringing keys */</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i]) { <span class="comment">/* No sub assigned - skip */</span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      }</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i]-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>) {</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i]);</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      }</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] != sub) {</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      }</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> == i) { <span class="comment">/* If softkey assigned at this moment - do not erase */</span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      }</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> &lt; 0) { <span class="comment">/* If softkey not defined - first one used */</span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> = i;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      }</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(i, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, s);</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;   }</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> &lt; 0) {</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can not assign softkey for incoming call on: %s\n&quot;</span>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;   }</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a>, s);</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a> = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>];</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Handle Call Incoming for %s@%s\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;               s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;   }</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e6e7d24b225c0a6823401b9cfaca82f">start_rtp</a>(sub);</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create channel for %s@%s\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;   }</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a60f9d2b0ab8b7a839902313321163b28">ast_queue_control</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>);</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;   }</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;is on-line&quot;</span>, s));</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a>(s);</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;   <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>) &amp;&amp;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>)) {</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(s, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;   }</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e">write_history</a>(s, <span class="charliteral">&#39;i&#39;</span>, 0);</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;}</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;</div><div class="line"><a name="l03329"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa3e60bae9ed59bd4a6501181ccc3976b"> 3329</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa3e60bae9ed59bd4a6501181ccc3976b">send_dtmf_tone</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>)</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;{</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;   <span class="keywordtype">int</span> row, col;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Phone Play Digit %c\n&quot;</span>, digit);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;   }</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> &gt; 0) {</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      row = (digit - <span class="charliteral">&#39;1&#39;</span>) % 3;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      col = (digit - <span class="charliteral">&#39;1&#39;</span> - row) / 3;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      <span class="keywordflow">if</span> (digit &gt;= <span class="charliteral">&#39;1&#39;</span> &amp;&amp; digit &lt;=<span class="charliteral">&#39;9&#39;</span>) {</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[row], <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[col]);</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; digit &lt;= <span class="charliteral">&#39;D&#39;</span>) {</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[digit-<span class="charliteral">&#39;A&#39;</span>], <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[3]);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit == <span class="charliteral">&#39;*&#39;</span>) {</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[3], <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[0]);</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit == <span class="charliteral">&#39;0&#39;</span>) {</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[3], <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[1]);</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit == <span class="charliteral">&#39;#&#39;</span>) {</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a>[3], <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a>[2]);</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 500, 2000);</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      }</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   }</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;}</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;</div><div class="line"><a name="l03356"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#afa3f233589259f41033dc33fb22abe08"> 3356</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afa3f233589259f41033dc33fb22abe08">unistim_do_senddigit</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>)</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;{</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { .<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>, .subclass.integer = <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>, .src = <span class="stringliteral">&quot;unistim&quot;</span> };</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <span class="keywordflow">if</span> (!sub || !sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> || sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a>) {</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to find subchannel in dtmf senddigit\n&quot;</span>);</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;   }</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;   <span class="comment">/* Send DTMF indication _before_ playing sounds */</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, &amp;f);</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> &gt; 0) {</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Send Digit %c (%i ms)\n&quot;</span>, digit, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a>);</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      }</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa3e60bae9ed59bd4a6501181ccc3976b">send_dtmf_tone</a>(pte, digit);</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;      usleep(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> * 1000);  <span class="comment">/* XXX Less than perfect, blocking an important thread is not a good idea */</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;   }</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;}</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;</div><div class="line"><a name="l03380"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26"> 3380</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;{</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;   <span class="keywordtype">int</span> keynum = keycode - <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, *sub_key = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac0a38da3415792f925843ac9dc50e86d">get_sub_holding</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>, 0);</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;   <span class="comment">/* Make an action on selected favorite key */</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[keynum]) { <span class="comment">/* Key have no assigned call */</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac0a38da3415792f925843ac9dc50e86d">get_sub_holding</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>, 0);</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8f0bdf522fe97f4a4196207da4c5e9d1">send_favorite_selected</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, pte);</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, keynum)) {</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Handle line w/o sub - dialpage\n&quot;</span>);</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;         }</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = keynum;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub); <span class="comment">/* Put active call on hold */</span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a>(pte);</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982">is_key_favorite</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, keynum)) {</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;         <span class="comment">/* Put active call on hold in handle_call_outgoing function, after preparation and</span></div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;<span class="comment">          checking if lines available for calling */</span></div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Handle favorite w/o sub - dialing\n&quot;</span>);</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;         }</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;         <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>) &amp;&amp;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>)) {</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;         }</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2025e985d45bb3084dfced90b9eea58">key_favorite</a>(pte, keycode);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      }</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      sub_key = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[keynum];</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <span class="comment">/* Favicon have assigned sub, activate it and put current on hold */</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      <span class="keywordflow">if</span> (sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a> &amp;&amp; !sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a>) {</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub_key);</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a> &amp;&amp; sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a>) {</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;         <span class="comment">/* We are going to unhold line (we should put active line on hold, of any) */</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>){</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;         }</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub);</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(pte, sub_key);</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a246466696bf607e23312e5378f332b3c">sub_unhold</a>(pte, sub_key);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>) {</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub);</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;         sub_key-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> = keynum;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(pte);</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      }</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   }</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;}</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;</div><div class="line"><a name="l03435"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2b40c67e67a8ef07ce7f6313dea02336"> 3435</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2b40c67e67a8ef07ce7f6313dea02336">key_call</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;{</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *sub_3way = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   }</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   <span class="keywordflow">if</span> ((keycode &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a>) &amp;&amp; (keycode &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a>)) {</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a>) {</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;         keycode = <span class="charliteral">&#39;#&#39;</span>;</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb">KEY_STAR</a>) {</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;         keycode = <span class="charliteral">&#39;*&#39;</span>;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;         keycode -= 0x10;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      }</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afa3f233589259f41033dc33fb22abe08">unistim_do_senddigit</a>(pte, keycode);</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   }</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> &amp;&amp; <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) == <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;         <span class="keywordflow">if</span> (sub_3way) {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a>(pte);</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;         }</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;      }</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>:</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      <span class="keywordflow">if</span> (sub_3way) {</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab462e9e6f851205e3ba46e2af970cff8">transfer_cancel_step2</a>(pte);</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) == <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a07b2e6cad22cbdbd0e3313c6a2e7a65f">transfer_call_step1</a>(pte);</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      }</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;      <span class="keywordflow">if</span> (!sub_3way) {</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a>(pte);</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;      }</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>:</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a>:</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a>:</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a>:</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a>:</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a>:</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a>(pte, keycode);</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a>:</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>) {</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      }</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a>:</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>)</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">previous_output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>,</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac4e3446f25095a6b0a6b29b275c675fb">KEY_ONHOLD</a>:</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;         <span class="keywordflow">if</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>]) {</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            sub = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>];</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;         }</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;      }</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a>) {</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a246466696bf607e23312e5378f332b3c">sub_unhold</a>(pte, sub);</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a>(pte, sub);</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;      }</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;   }</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;}</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;</div><div class="line"><a name="l03515"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0363a49deb6cb1314fd3e46d8c6ae475"> 3515</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0363a49deb6cb1314fd3e46d8c6ae475">key_ringing</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;{</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>:</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a>:</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a>:</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a>:</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a>:</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a>:</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a>(pte, keycode);</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>:</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad99329ea1d90e83ad194250726f07947">ignore_call</a>(pte);</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae478d437699e68f3bb150c2c531ff551">discard_call</a>(pte);</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a>:</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>;</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(pte);</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a>:</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>;</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(pte);</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(pte);</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;   }</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;}</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;</div><div class="line"><a name="l03548"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac2025e985d45bb3084dfced90b9eea58"> 3548</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac2025e985d45bb3084dfced90b9eea58">key_favorite</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;{</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;   <span class="keywordtype">int</span> fav = keycode - <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>;</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982">is_key_favorite</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, fav)) {</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;It&#39;s not a favorite key\n&quot;</span>);</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;   }</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[fav],</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;               <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>));</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(pte);</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;}</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;</div><div class="line"><a name="l03561"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#abcff19481dd82016ca078857bc0b6260"> 3561</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abcff19481dd82016ca078857bc0b6260">key_dial_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;{</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a> = 0;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;   <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>) {</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> &lt;= 1) {</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;         keycode = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>;</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> -= 2;</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;         keycode = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>] + 0x10;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;      }</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;   }</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;   <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a> &amp;&amp; pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a89ee76cd9909e38095ff9c5acf4df9db">sharp_dial</a> == 1) {</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      keycode = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>;</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;   }</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;   <span class="keywordflow">if</span> ((keycode &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a>) &amp;&amp; (keycode &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a>)) {</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;      <span class="keywordtype">int</span> i = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> == 0) {</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      }</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a>) {</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;         keycode = <span class="charliteral">&#39;#&#39;</span>;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb">KEY_STAR</a>) {</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;         keycode = <span class="charliteral">&#39;*&#39;</span>;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;         keycode -= 0x10;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      }</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>[i] = keycode;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a>++;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>[i + 1] = 0;</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a>(pte);</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;         !<a class="code" href="../../db/de0/pbx_8h.html#ac359af75b9494f50904583d2168a7577">ast_matchmore_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;         keycode = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">interdigit_timer</a>) {</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>() + pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">interdigit_timer</a>;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;         }</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      }</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;   }</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;   <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>) {</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">size_phone_number</a> = 0;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a>(pte);</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;   }</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[0] == -1) {</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>) {</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>,</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                     <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>));</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>) || (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>)) {</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a>);</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a>);</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      }</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;   }</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>:</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      }</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>,</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                  <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>));</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(pte);</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <span class="keywordflow">if</span> (sub &amp;&amp; sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5">sub_stop_silence</a>(pte, sub);</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 0;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>;</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, pte));</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(pte, sub);</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a>);</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a>);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      }</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>:</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a>:</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a>:</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a>:</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a>:</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a>:</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8f0bdf522fe97f4a4196207da4c5e9d1">send_favorite_selected</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, pte);</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = -1;</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a>(pte, keycode);</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a>:</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>) {</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a>) {</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">previous_output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>,</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;         }</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      }</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a>:</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>) {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a>) {</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;         }</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;      }</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;   }</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;}</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;</div><div class="line"><a name="l03687"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3"> 3687</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3">handle_select_option</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;{</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[128];</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a>) {</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a>;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 1;</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] = 0; <span class="comment">/* Position in menu */</span></div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;   }</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;   snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%d. %s&quot;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] + 1, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(options_menu[(<span class="keywordtype">int</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d3/df2/structunistim__menu__item.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a>, pte));</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Select               Cancel&quot;</span>, pte));</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;}</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;</div><div class="line"><a name="l03702"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a34bc024bcf888167e8df34925870f57d"> 3702</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a34bc024bcf888167e8df34925870f57d">key_select_option</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;{</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a>:</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]++;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      <span class="keywordflow">if</span> (options_menu[(<span class="keywordtype">int</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d3/df2/structunistim__menu__item.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]--;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      }</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">KEY_UP</a>:</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] &gt; 0) {</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]--;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      }</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;      options_menu[(int)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d3/df2/structunistim__menu__item.html#a96e1128adcd23704d9a18ad461119d85">handle_option</a>(pte);</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;   }</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3">handle_select_option</a>(pte);</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;}</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;</div><div class="line"><a name="l03729"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2"> 3729</a></span>&#160;<span class="preprocessor">#define SELECTCODEC_START_ENTRY_POS 15</span></div><div class="line"><a name="l03730"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a63f253fc88f7a833b7c516a14f788e3b"> 3730</a></span>&#160;<span class="preprocessor">#define SELECTCODEC_MAX_LENGTH 2</span></div><div class="line"><a name="l03731"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ace2fdc6c958af19b0108853e7de26ee8"> 3731</a></span>&#160;<span class="preprocessor">#define SELECTCODEC_MSG &quot;Codec number : ..&quot;</span></div><div class="line"><a name="l03732"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2040931156dab409503688b41fe3ae4c"> 3732</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2040931156dab409503688b41fe3ae4c">handle_select_codec</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;{</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[30], <a class="code" href="../../db/d09/func__realtime_8c.html#a13d23fea305bed9188c360e245c5c9f1">buf2</a>[6];</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a>;</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Using codec&quot;</span>, pte), <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;   snprintf(buf2, <span class="keyword">sizeof</span>(buf2), <span class="stringliteral">&quot; %d&quot;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a>);</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;   strcat(buf, buf2);</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;   strcat(buf, <span class="stringliteral">&quot; (G711u=0,&quot;</span>);</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, buf);</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <span class="stringliteral">&quot;G723=4,G711a=8,G729A=18)&quot;</span>);</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3119d68a678e50384f92a0021dec136f">TEXT_INVERSE</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace2fdc6c958af19b0108853e7de26ee8">SELECTCODEC_MSG</a>);</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a>);</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 0;</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Select BackSp Erase  Cancel&quot;</span>, pte));</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;}</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;</div><div class="line"><a name="l03752"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a42b607e49465ac5e3e4c2c9abf302b09"> 3752</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42b607e49465ac5e3e4c2c9abf302b09">key_select_codec</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;{</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;   <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>) {</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> &lt;= 1) {</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;         keycode = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> -= 2;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;         keycode = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>] + 0x10;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      }</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;   }</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;   <span class="keywordflow">if</span> ((keycode &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a>) &amp;&amp; (keycode &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611">KEY_9</a>)) {</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keywordtype">char</span> tmpbuf[] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace2fdc6c958af19b0108853e7de26ee8">SELECTCODEC_MSG</a>;</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a63f253fc88f7a833b7c516a14f788e3b">SELECTCODEC_MAX_LENGTH</a>) {</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      }</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="keywordflow">while</span> (i &lt; pte-&gt;size_buff_entry) {</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;         tmpbuf[i + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a>] = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[i];</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;         i++;</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      }</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      tmpbuf[i + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a>] = keycode - 0x10;</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[i] = keycode - 0x10;</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>++;</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3119d68a678e50384f92a0021dec136f">TEXT_INVERSE</a>, pte, tmpbuf);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte,</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a> + 1 + i));</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;   }</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> == 1) {</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a> = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] - 48;</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> == 2) {</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a> =</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;            ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] - 48) * 10) + (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[1] - 48);</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      }</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>:</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 0;</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3119d68a678e50384f92a0021dec136f">TEXT_INVERSE</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace2fdc6c958af19b0108853e7de26ee8">SELECTCODEC_MSG</a>);</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a>);</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;   }</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;}</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;</div><div class="line"><a name="l03807"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9"> 3807</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* lang)</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;{</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;   <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;   <span class="keywordflow">while</span> (options_languages[i].lang_short != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      <span class="keywordflow">if</span>(!strcmp(options_languages[i].lang_short, lang)) {</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;         <span class="keywordflow">return</span> i;</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      }</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      i++;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;   }</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;}</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;</div><div class="line"><a name="l03819"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c"> 3819</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c">handle_select_language</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;{</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;   <span class="keywordtype">char</span> tmp_language[40];</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d7e/structunistim__languages.html">unistim_languages</a> lang;</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>) {</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 1;</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>);</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;   }</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;   lang = options_languages[(int)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]];</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp_language, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, <span class="keyword">sizeof</span>(tmp_language));</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, lang.<a class="code" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">lang_short</a>, <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>));</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(pte, lang.<a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>);</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(lang.<a class="code" href="../../d1/d7e/structunistim__languages.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a>, pte));</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, tmp_language, <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>));</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   lang = options_languages[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)];</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(pte, lang.<a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>);</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Select               Cancel&quot;</span>, pte));</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;}</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03842"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2002af10b2c9101d2e4c5bbb38c7a506"> 3842</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2002af10b2c9101d2e4c5bbb38c7a506">key_select_language</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;{</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a>:</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]++;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      <span class="keywordflow">if</span> (options_languages[(<span class="keywordtype">int</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d1/d7e/structunistim__languages.html#acf60de4c64d60c1b9449c056bc6bfcf7">label</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]--;</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      }</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">KEY_UP</a>:</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] &gt; 0) {</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]--;</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      }</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, options_languages[(<span class="keywordtype">int</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">lang_short</a>, <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>));</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(pte, options_languages[(<span class="keywordtype">int</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0]].<a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a>(pte);</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3">handle_select_option</a>(pte);</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;   }</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c">handle_select_language</a>(pte);</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;}</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;</div><div class="line"><a name="l03873"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247"> 3873</a></span>&#160;<span class="preprocessor">#define SELECTEXTENSION_START_ENTRY_POS 0</span></div><div class="line"><a name="l03874"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a45563b70b6151b79c2b1442ea66843e0"> 3874</a></span>&#160;<span class="preprocessor">#define SELECTEXTENSION_MAX_LENGTH 10</span></div><div class="line"><a name="l03875"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a8b52e57503dad7f054703e44d27c992b"> 3875</a></span>&#160;<span class="preprocessor">#define SELECTEXTENSION_MSG &quot;..........&quot;</span></div><div class="line"><a name="l03876"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30"> 3876</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;{</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>;</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Please enter a Terminal&quot;</span>, pte));</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Number (TN) :&quot;</span>, pte));</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8b52e57503dad7f054703e44d27c992b">SELECTEXTENSION_MSG</a>);</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a>);</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Enter  BackSpcErase&quot;</span>, pte));</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 0;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;}</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;</div><div class="line"><a name="l03890"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa6a59af432901323fefcc549eb69a614"> 3890</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa6a59af432901323fefcc549eb69a614">key_select_extension</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;{</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;   <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>) {</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> &lt;= 1) {</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;         keycode = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> -= 2;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;         keycode = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>] + 0x10;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      }</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;   }</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;   <span class="keywordflow">if</span> ((keycode &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a>) &amp;&amp; (keycode &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611">KEY_9</a>)) {</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="keywordtype">char</span> tmpbuf[] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8b52e57503dad7f054703e44d27c992b">SELECTEXTENSION_MSG</a>;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a45563b70b6151b79c2b1442ea66843e0">SELECTEXTENSION_MAX_LENGTH</a>) {</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      }</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <span class="keywordflow">while</span> (i &lt; pte-&gt;size_buff_entry) {</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;         tmpbuf[i + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a>] = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[i];</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;         i++;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      }</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      tmpbuf[i + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a>] = keycode - 0x10;</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[i] = keycode - 0x10;</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>++;</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmpbuf);</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a> + 1 + i));</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;   }</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> &lt; 1) {</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;      }</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a>) {</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;         <span class="comment">/* First step : looking for this TN in our device list */</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;         d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;         <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;            <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>[0] == <span class="charliteral">&#39;T&#39;</span>) {  <span class="comment">/* It&#39;s a TN device ? */</span></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;               <span class="comment">/* It&#39;s the TN we&#39;re looking for ? */</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;               <span class="keywordflow">if</span> (!strcmp((d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>) + 1, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>)) {</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                  pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a> = pte;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">codec_number</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a833a6a7242f366ed7edcc08c0a415639">DEFAULT_CODEC</a>;</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>;</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                  strcpy(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">macaddr</a>);</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                  pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>[0] = <span class="charliteral">&#39;T&#39;</span>;</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                  pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>;</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;                  <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>) + 1,</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                              pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> + 1);</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                  <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a>(pte);</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                  <span class="keywordflow">return</span>;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;               }</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;            }</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;            d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;         }</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Invalid Terminal Number.&quot;</span>, pte));</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Please try again :&quot;</span>, pte));</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a> +</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                 pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>));</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>,</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                     pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> + 1);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341">register_extension</a>(pte)) {</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Invalid extension.&quot;</span>, pte));</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Please try again :&quot;</span>, pte));</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> +</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                                 <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a> +</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                 pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a>));</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;         } <span class="keywordflow">else</span></div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      }</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>:</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 0;</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8b52e57503dad7f054703e44d27c992b">SELECTEXTENSION_MSG</a>);</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a>(pte);</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a>);</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;   }</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;}</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a45bfef5770afc080deaaf92890e1bf25"> 3984</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a45bfef5770afc080deaaf92890e1bf25">show_entry_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, FILE ** f)</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;{</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;   <span class="keywordtype">char</span> line[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> + 1], <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36cc0c8c725c461d6f25bd52cb56f3db">STATUS_LENGTH_MAX</a> + 1], func1[10], func2[10],</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;      func3[10];</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;   <span class="comment">/* Display date/time and call status */</span></div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;   <span class="keywordflow">if</span> (fread(line, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, *f) != 1) {</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Can&#39;t read history date entry&quot;</span>);</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      fclose(*f);</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;   }</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;   line[<span class="keyword">sizeof</span>(line) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] == 1) {</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      }</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;   }</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;   <span class="comment">/* Display number */</span></div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;   <span class="keywordflow">if</span> (fread(line, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, *f) != 1) {</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Can&#39;t read callerid entry&quot;</span>);</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      fclose(*f);</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;   }</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;   line[<span class="keyword">sizeof</span>(line) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>, line, <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>));</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>);</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] == 2) {</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      }</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;   }</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;   <span class="comment">/* Display name */</span></div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;   <span class="keywordflow">if</span> (fread(line, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, 1, *f) != 1) {</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Can&#39;t read callername entry&quot;</span>);</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      fclose(*f);</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;   }</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;   line[<span class="keyword">sizeof</span>(line) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] == 3) {</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      }</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, line);</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;        }</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;   fclose(*f);</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;   snprintf(line, <span class="keyword">sizeof</span>(line), <span class="stringliteral">&quot;%s %03d/%03d&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Call&quot;</span>, pte), pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2],</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;          pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[1]);</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73">send_texttitle</a>(pte, line);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] == 1) {</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func1, <span class="stringliteral">&quot;       &quot;</span>, <span class="keyword">sizeof</span>(func1));</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func1, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Prev   &quot;</span>, pte), <span class="keyword">sizeof</span>(func1));</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;   }</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] &gt;= pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[1]) {</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func2, <span class="stringliteral">&quot;       &quot;</span>, <span class="keyword">sizeof</span>(func2));</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func2, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Next   &quot;</span>, pte), <span class="keyword">sizeof</span>(func2));</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;   }</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;   <span class="keywordflow">if</span> (strlen(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>)) {</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func3, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Redial &quot;</span>, pte), <span class="keyword">sizeof</span>(func3));</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(func3, <span class="stringliteral">&quot;       &quot;</span>, <span class="keyword">sizeof</span>(func3));</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;   }</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   snprintf(status, <span class="keyword">sizeof</span>(status), <span class="stringliteral">&quot;%s%s%s%s&quot;</span>, func1, func2, func3, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Cancel&quot;</span>, pte));</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, status);</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;}</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;</div><div class="line"><a name="l04058"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a639c46654c74d21720538aaada34cbbb"> 4058</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a639c46654c74d21720538aaada34cbbb">open_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> way, FILE ** f)</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;{</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8c9568e97903db39b211a5fef52cf39d">AST_CONFIG_MAX_PATH</a>];</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;   <span class="keywordtype">char</span> count;</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;   snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%s/%s/%s-%c.csv&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a>,</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;          <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">USTM_LOG_DIR</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, way);</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;   *f = fopen(tmp, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;   <span class="keywordflow">if</span> (!*f) {</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to open history file&quot;</span>);</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;   }</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;   <span class="keywordflow">if</span> (fread(&amp;count, 1, 1, *f) != 1) {</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to read history header - display.&quot;</span>);</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;      fclose(*f);</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      *f = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;   }</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;   <span class="keywordflow">if</span> (count &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>) {</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid count in history header of %s (%d max %d)\n&quot;</span>, tmp,</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            count, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a>);</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      fclose(*f);</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      *f = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;   }</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;   <span class="keywordflow">return</span> count;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;}</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div><div class="line"><a name="l04086"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f"> 4086</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> way)</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;{</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;   FILE *f;</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;   <span class="keywordtype">char</span> count;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;   }</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;   <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">callhistory</a>) {</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   }</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;   count = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a639c46654c74d21720538aaada34cbbb">open_history</a>(pte, way, &amp;f);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;   <span class="keywordflow">if</span> (!count) {</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   }</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] = way;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[1] = count;</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] = 1;</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] = 1;</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a45bfef5770afc080deaaf92890e1bf25">show_entry_history</a>(pte, &amp;f);</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">STATE_HISTORY</a>;</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;}</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;</div><div class="line"><a name="l04109"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906"> 4109</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;{</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   <span class="keywordtype">char</span> tmpbuf[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> + 1];</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>) &amp;&amp;</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>))) {</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a>(pte);</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;   }</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>;</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;   pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a> = -1;</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a>(pte); <span class="comment">/* case of holding call */</span></div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a109d3bab32b2bea03e2bafd9ab87b00f">MUTE_ON_DISCRET</a>);</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a>);</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a>);</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>)) {</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;         <span class="keywordtype">char</span> tmp_field[100];</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;         snprintf(tmp_field, <span class="keyword">sizeof</span>(tmp_field), <span class="stringliteral">&quot;%s %s&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Fwd to:&quot;</span>, pte), pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>);</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp_field);</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Call forwarded to :&quot;</span>, pte));</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      }</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77054ec039b7ddcce41bbd752cb54cd8">FAV_ICON_REFLECT</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a279e2c56f8e7d134934fae508d620cc5">FAV_BLINK_SLOW</a>, pte);</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial          NoFwd  &quot;</span>, pte));</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial   Redial NoFwd  &quot;</span>, pte));</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;      }</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>) || (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>)) {</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial          Fwd    Unregis&quot;</span>, pte));</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial   Redial Fwd    Unregis&quot;</span>, pte));</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;         }</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial          Fwd    Pickup&quot;</span>, pte));</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Dial   Redial Fwd    Pickup&quot;</span>, pte));</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;         }</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      }</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>);</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> == 0) {</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6e7d55014285a51d55da36f86028b736">send_date_time2</a>(pte);</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3e69e3bafe7f929bdbc5ff930d50f8b0">send_idle_clock</a>(pte);</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;         <span class="keywordflow">if</span> (strlen(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">maintext0</a>)) {</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">maintext0</a>, pte));</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;         }</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> == 1) {</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;            text = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;unanswered call&quot;</span>, pte);</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;            text = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;unanswered calls&quot;</span>, pte);</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;         }</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;         snprintf(tmpbuf, <span class="keyword">sizeof</span>(tmpbuf), <span class="stringliteral">&quot;%d %s&quot;</span>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a>, text);</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmpbuf);</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8711751e9c6743e11a3862de504cf65a">FAV_ICON_CALL_CENTER</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a279e2c56f8e7d134934fae508d620cc5">FAV_BLINK_SLOW</a>, pte);</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      }</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;   }</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> &gt; 1) {</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">maintext2</a>)) {</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;         strcpy(tmpbuf, <span class="stringliteral">&quot;IP : &quot;</span>);</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;         strcat(tmpbuf, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmpbuf);</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">maintext2</a>, pte));</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      }</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;   }</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73">send_texttitle</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, pte));</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>);</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;}</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;</div><div class="line"><a name="l04191"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a63fdc8d21b4335d99984468ceb5d187b"> 4191</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a63fdc8d21b4335d99984468ceb5d187b">key_main_page</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;{</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a>) {</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>, pte);</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   }</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;   <span class="keywordflow">if</span> ((keycode &gt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a>) &amp;&amp; (keycode &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a>)) {</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abcff19481dd82016ca078857bc0b6260">key_dial_page</a>(pte, keycode);</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;   }</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a>(pte, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>:</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>)) {</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      }</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>) &amp;&amp;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;         (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>)) {</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;      }</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>,</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                  <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>));</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(pte);</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>:</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>)) {</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;         <span class="comment">/* Cancel call forwarding */</span></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;         memmove(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a> + 1, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>,</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;               <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>) - 1);</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>, pte);</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>;   <span class="comment">/* Seems to be reseted somewhere */</span></div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      }</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>[0] = -1;</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>) {</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af809a5a3654f9c22d7a6c0447ac7c914">unregister_extension</a>(pte);</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a>(pte);</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>) {</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;         strcpy(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>);</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">size_buff_entry</a> = 0;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a>(pte);</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">/* Pickup function */</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;         <span class="comment">/* XXX Is there a way to get a specific channel here? */</span></div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6f/structast__features__pickup__config.html">ast_features_pickup_config</a> *, pickup_cfg,</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;               <a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#ad9d12b10a3d0c3bca1d0b033bc139dab">ast_get_chan_features_pickup_config</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;         <span class="keywordflow">if</span> (!pickup_cfg) {</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to retrieve pickup configuration options. Unable to detect call pickup extension\n&quot;</span>);</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;         }</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = -1;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>, pickup_cfg-&gt;pickupexten,</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                  <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">phone_number</a>));</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(pte);</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                }</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a>:</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a>:</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a>:</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a>:</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a>:</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a>:</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a>(pte, keycode);</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a867e7c497d29cd4f8f55a9011924469a">KEY_CONF</a>:</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3">handle_select_option</a>(pte);</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a>:</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a>:</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082">KEY_SNDHIST</a>:</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a>(pte, <span class="charliteral">&#39;o&#39;</span>);</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031">KEY_RCVHIST</a>:</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a>(pte, <span class="charliteral">&#39;i&#39;</span>);</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;   }</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;}</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div><div class="line"><a name="l04294"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a30270c1b689ffac87839e3e04fb96dd1"> 4294</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a30270c1b689ffac87839e3e04fb96dd1">key_history</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keywordtype">char</span> keycode)</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;{</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;   FILE *f;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;   <span class="keywordtype">char</span> count;</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;   <span class="keywordtype">long</span> offset;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = 0;</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;   <span class="keywordflow">switch</span> (keycode) {</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a612120b69c7dfd46086db7aaebdbcf65">KEY_LEFT</a>:</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] &lt;= 1) {</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;         }</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3]--;</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;         flag = 1;</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      }</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">KEY_UP</a>:</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a>:</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] &lt;= 1) {</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      }</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2]--;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;      flag = 1;</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6504370d9c6391e1a9da6a1a529b089d">KEY_RIGHT</a>:</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3] == 3) {</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;         }</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[3]++;</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;         flag = 1;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      }</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a>:</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>:</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] &gt;= pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[1]) {</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      }</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2]++;</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;      flag = 1;</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a>:</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>)) {</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      }</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">lst_cid</a>,</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;                  <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">redial_number</a>));</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a63fdc8d21b4335d99984468ceb5d187b">key_main_page</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a>);</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a>:</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a>:</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082">KEY_SNDHIST</a>:</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] == <span class="charliteral">&#39;i&#39;</span>) {</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a>(pte, <span class="charliteral">&#39;o&#39;</span>);</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      }</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031">KEY_RCVHIST</a>:</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0] == <span class="charliteral">&#39;i&#39;</span>) {</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a>(pte, <span class="charliteral">&#39;i&#39;</span>);</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      }</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;   }</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;   <span class="keywordflow">if</span> (flag) {</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;      count = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a639c46654c74d21720538aaada34cbbb">open_history</a>(pte, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[0], &amp;f);</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      <span class="keywordflow">if</span> (!count) {</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;      }</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      offset = ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">buff_entry</a>[2] - 1) * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> * 3);</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;      <span class="keywordflow">if</span> (fseek(f, offset, SEEK_CUR)) {</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a>(<span class="stringliteral">&quot;Unable to seek history entry.&quot;</span>);</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;         fclose(f);</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;      }</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a45bfef5770afc080deaaf92890e1bf25">show_entry_history</a>(pte, &amp;f);</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;   }</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;}</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;</div><div class="line"><a name="l04381"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a11bb530f154228629c597a16a0dca5e9"> 4381</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a11bb530f154228629c597a16a0dca5e9">init_phone_step2</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;{</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending S4\n&quot;</span>);</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;   }</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">packet_send_s4</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">packet_send_s4</a>));</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">packet_send_s4</a>), buffsend, pte);</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6e7d55014285a51d55da36f86028b736">send_date_time2</a>(pte);</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5b17b5e0773ae87d486823b7505da1b">send_date_time3</a>(pte);</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending S7\n&quot;</span>);</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;   }</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>));</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>), buffsend, pte);</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending Contrast\n&quot;</span>);</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;   }</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">packet_send_Contrast</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">packet_send_Contrast</a>));</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      buffsend[9] = pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a>;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;   }</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">packet_send_Contrast</a>), buffsend, pte);</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending S9\n&quot;</span>);</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;   }</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">packet_send_s9</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">packet_send_s9</a>));</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">packet_send_s9</a>), buffsend, pte);</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(pte);</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending S7\n&quot;</span>);</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;   }</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>));</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a>), buffsend, pte);</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a809cffe22b7ff73ee3e2c064a2f3ced7">send_ping</a>(pte);</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending init language\n&quot;</span>);</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;   }</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(pte, options_languages[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)].<a class="code" href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">encoding</a>);</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;   }</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>) {</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a>) {</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a>(pte);</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;         <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;         <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[30];</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;         <span class="keywordflow">for</span> (i = 1; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(i, 0, pte, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;         }</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Phone is not registered&quot;</span>, pte));</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;in unistim.conf&quot;</span>, pte));</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;         strcpy(tmp, <span class="stringliteral">&quot;MAC = &quot;</span>);</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;         strcat(tmp, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">macaddr</a>);</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(pte, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73">send_texttitle</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;UNISTIM for*&quot;</span>, pte));</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;      }</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;   }</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a>(pte);</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Sending arrow\n&quot;</span>);</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;   }</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">packet_send_arrow</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">packet_send_arrow</a>));</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">packet_send_arrow</a>), buffsend, pte);</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;}</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="comment">/* Toggles the state of microphone muting */</span></div><div class="line"><a name="l04457"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac9e723e843d88f75a6a6fb2b556cdf6c"> 4457</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9e723e843d88f75a6a6fb2b556cdf6c">microphone_mute_toggle</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;{</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>) {</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>;</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a321595f065c4787f1bd0828b348ac4f5">LED_MUTE_ON</a>);</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a>) {</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a741a9726b536ff19cd1c974464da4d28">LED_MUTE_OFF</a>);</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;   }</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a52c437bdbf19718602604e80422c841e">send_mute</a>(pte, (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> &amp; 0x01));</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;}</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;</div><div class="line"><a name="l04469"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a640be959dd0a4166b7032c88737444f8"> 4469</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a640be959dd0a4166b7032c88737444f8">process_request</a>(<span class="keywordtype">int</span> size, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte)</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;{</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;   <span class="keywordtype">char</span> tmpbuf[255];</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;   <span class="keywordflow">if</span> (memcmp</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      (buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fca4819ce3044be21fb24b818ae0b30">packet_recv_resume_connection_with_server</a>,</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;       <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fca4819ce3044be21fb24b818ae0b30">packet_recv_resume_connection_with_server</a>)) == 0) {</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#adfddefd9aad65eccfcb25444e02a0e73">rcv_resume_connection_with_server</a>(pte);</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;   }</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac763429f724ac4b2b2fb568e466001b3">packet_recv_firm_version</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac763429f724ac4b2b2fb568e466001b3">packet_recv_firm_version</a>)) == 0) {</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      buf[size] = 0;</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Got the firmware version : &#39;%s&#39;\n&quot;</span>, buf + 13);</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;      }</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9ccf05acd1a39a2adc192e7453f69176">firmware</a>, (<span class="keywordtype">char</span> *) (buf + 13), <span class="keyword">sizeof</span>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9ccf05acd1a39a2adc192e7453f69176">firmware</a>));</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a11bb530f154228629c597a16a0dca5e9">init_phone_step2</a>(pte);</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;   }</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a326ac5a010e5287349fb860ac6accc1b">packet_recv_it_type</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a326ac5a010e5287349fb860ac6accc1b">packet_recv_it_type</a>)) == 0) {</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = buf[13];</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Got the equipment type: &#39;%d&#39;\n&quot;</span>, type);</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      }</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;      <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      <span class="keywordflow">case</span> 0x03: <span class="comment">/* i2002 */</span></div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> = 1;</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;         }</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;      }</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;   }</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aded82877394efd5636b1b14ad4ba757e">packet_recv_mac_addr</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aded82877394efd5636b1b14ad4ba757e">packet_recv_mac_addr</a>)) == 0) {</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad8955045150b25a87aff07813dc383ae">rcv_mac_addr</a>(pte, buf);</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;   }</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae8c0cf3a8ca2a0b39e99e47ea59ceaa1">packet_recv_r2</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae8c0cf3a8ca2a0b39e99e47ea59ceaa1">packet_recv_r2</a>)) == 0) {</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;R2 received\n&quot;</span>);</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;      }</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;   }</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;   <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>) {</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Request not authorized in this state\n&quot;</span>);</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      }</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;   }</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;   <span class="keywordflow">if</span> (!memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbdf3717d9b2c10cb2b20f77f8fdb797">packet_recv_expansion_pressed_key</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbdf3717d9b2c10cb2b20f77f8fdb797">packet_recv_expansion_pressed_key</a>))) {</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      <span class="keywordtype">char</span> keycode = buf[13];</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Expansion key pressed: keycode = 0x%02hhx - current state: %s\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)keycode,</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>));</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      }</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;   }</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;   <span class="keywordflow">if</span> (!memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a01bd47c216c3d26eb96d07bc03b468bd">packet_recv_pressed_key</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a01bd47c216c3d26eb96d07bc03b468bd">packet_recv_pressed_key</a>))) {</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      <span class="keywordtype">char</span> keycode = buf[13];</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Key pressed: keycode = 0x%02hhx - current state: %s\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)keycode,</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>));</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      }</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <span class="keywordflow">if</span> (keycode == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aae15e6350cf0c536de2b3968941cb082">KEY_MUTE</a>) {</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9e723e843d88f75a6a6fb2b556cdf6c">microphone_mute_toggle</a>(pte);</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      }</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;      <span class="keywordflow">switch</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>) {</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a>:</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;No keys allowed in the init state\n&quot;</span>);</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;         }</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a>:</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;No keys allowed in authdeny state\n&quot;</span>);</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;         }</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>:</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a63fdc8d21b4335d99984468ceb5d187b">key_main_page</a>(pte, keycode);</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>:</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abcff19481dd82016ca078857bc0b6260">key_dial_page</a>(pte, keycode);</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a>:</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0363a49deb6cb1314fd3e46d8c6ae475">key_ringing</a>(pte, keycode);</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>:</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2b40c67e67a8ef07ce7f6313dea02336">key_call</a>(pte, keycode);</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>:</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa6a59af432901323fefcc549eb69a614">key_select_extension</a>(pte, keycode);</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a>:</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a34bc024bcf888167e8df34925870f57d">key_select_option</a>(pte, keycode);</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a>:</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a42b607e49465ac5e3e4c2c9abf302b09">key_select_codec</a>(pte, keycode);</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a>:</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2002af10b2c9101d2e4c5bbb38c7a506">key_select_language</a>(pte, keycode);</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">STATE_HISTORY</a>:</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a30270c1b689ffac87839e3e04fb96dd1">key_history</a>(pte, keycode);</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Key : Unknown state\n&quot;</span>);</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;      }</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;   }</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b3644f4591bdac1f9302794b6211fb6">packet_recv_pick_up</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b3644f4591bdac1f9302794b6211fb6">packet_recv_pick_up</a>)) == 0) {</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Handset off hook, current state: %s\n&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>));</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;      }</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;      <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {         <span class="comment">/* We are not yet registered (asking for a TN in AUTOPROVISIONING_TN) */</span></div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;      }</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a>;</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>) {</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      }</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a>) {</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a>(pte);</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>) || (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>)) {</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>) { <span class="comment">/* We must have a TN before calling */</span></div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a>(pte, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a>(pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>, pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>);</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a>(pte);</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;      }</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;   }</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;   <span class="keywordflow">if</span> (memcmp(buf + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a88e009e2bd5d179615c0a6384db004fc">packet_recv_hangup</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a88e009e2bd5d179615c0a6384db004fc">packet_recv_hangup</a>)) == 0) {</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Handset on hook, current state: %s\n&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>));</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      }</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      }</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">receiver_state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a>;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>) {</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a>) {</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a>(pte);</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;         }</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a>) {</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a> = 0;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(pte);</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;      }</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;   }</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;   strcpy(tmpbuf, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;   strcat(tmpbuf, <span class="stringliteral">&quot; Unknown request packet\n&quot;</span>);</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s&quot;</span>, tmpbuf);</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;   }</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;}</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;</div><div class="line"><a name="l04633"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a"> 4633</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a>(<span class="keywordtype">int</span> size, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte,</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;   <span class="keyword">struct</span> sockaddr_in *addr_from)</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;{</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *sbuf = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *) buf;</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a>;</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;   <span class="keywordtype">char</span> tmpbuf[255];</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;   strcpy(tmpbuf, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr_from-&gt;sin_addr));</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;   <span class="keywordflow">if</span> (size &lt; 10) {</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;      <span class="keywordflow">if</span> (size == 0) {</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s Read error\n&quot;</span>, tmpbuf);</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Packet too short - ignoring\n&quot;</span>, tmpbuf);</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      }</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;   }</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;   <span class="keywordflow">if</span> (sbuf[0] == 0xffff) {   <span class="comment">/* Starting with 0xffff ? */</span><span class="comment">/* Yes, discovery packet ? */</span></div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;      <span class="keywordflow">if</span> (size != <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">packet_rcv_discovery</a>)) {</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Invalid size of a discovery packet\n&quot;</span>, tmpbuf);</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;         <span class="keywordflow">if</span> (memcmp(buf, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">packet_rcv_discovery</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">packet_rcv_discovery</a>)) == 0) {</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Discovery packet received - Sending Discovery ACK\n&quot;</span>);</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;            }</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;            <span class="keywordflow">if</span> (pte) {        <span class="comment">/* A session was already active for this IP ? */</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;               <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a>) { <span class="comment">/* Yes, but it&#39;s a dupe */</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Duplicated Discovery packet\n&quot;</span>);</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;                  }</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>),</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                             <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>, addr_from, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;                  pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a> = (short) 0x0000; <span class="comment">/* reset sequence number */</span></div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;               } <span class="keywordflow">else</span> { <span class="comment">/* No, probably a reboot, phone side */</span></div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa73a3666fca776852c23de09da246f94">close_client</a>(pte);       <span class="comment">/* Cleanup the previous session */</span></div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a33363b0e7457c82cb0aef3b8c10cad5e">create_client</a>(addr_from)) {</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                     <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>),</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                                <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>, addr_from, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                  }</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;               }</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;               <span class="comment">/* Creating new entry in our phone list */</span></div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;               <span class="keywordflow">if</span> ((pte = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a33363b0e7457c82cb0aef3b8c10cad5e">create_client</a>(addr_from))) {</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>),</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                             <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a>, addr_from, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;               }</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;            }</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;         }</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Invalid discovery packet\n&quot;</span>, tmpbuf);</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;      }</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   }</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   <span class="keywordflow">if</span> (!pte) {</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;%s Not a discovery packet from an unknown source : ignoring\n&quot;</span>, tmpbuf);</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;      }</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;   }</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;   <span class="keywordflow">if</span> (sbuf[0] != 0) {          <span class="comment">/* Starting with something else than 0x0000 ? */</span></div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Unknown packet received - ignoring\n&quot;</span>);</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;   }</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;   <span class="keywordflow">if</span> (buf[5] != 2) {</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Wrong direction : got 0x%02hhx expected 0x02\n&quot;</span>, tmpbuf, buf[5]);</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;   }</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   seq = ntohs(sbuf[1]);</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;   <span class="keywordflow">if</span> (buf[4] == 1) {</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;ACK received for packet #0x%04x\n&quot;</span>, (<span class="keywordtype">unsigned</span>)seq);</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      }</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8879dd3a62f9fa2a85475b40587c3d77">nb_retransmit</a> = 0;</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="keywordflow">if</span> ((pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>) + 1 == seq) {</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>++;</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2eab34a419da2f1d9e240df755bb62ce">check_send_queue</a>(pte);</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;      }</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> &gt; seq) {</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;         <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> == 0xffff) {</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;ACK at 0xffff, restarting counter.\n&quot;</span>);</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;            pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> = 0;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                  <span class="stringliteral">&quot;%s Warning : ACK received for an already ACKed packet : #0x%04x we are at #0x%04x\n&quot;</span>,</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                  tmpbuf, (<span class="keywordtype">unsigned</span>)seq, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;         }</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      }</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a> &lt; seq) {</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;               <span class="stringliteral">&quot;%s Error : ACK received for a non-existent packet : #0x%04x\n&quot;</span>,</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;               tmpbuf, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>);</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      }</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;%s ACK gap : Received ACK #0x%04x, previous was #0x%04x\n&quot;</span>,</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;                  tmpbuf, (<span class="keywordtype">unsigned</span>)seq, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;      }</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> = <a class="code" href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a>;</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2eab34a419da2f1d9e240df755bb62ce">check_send_queue</a>(pte);</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;   }</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;   <span class="keywordflow">if</span> (buf[4] == 2) {</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Request received\n&quot;</span>);</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      }</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a> == seq) {</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;         <span class="comment">/* Send ACK */</span></div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;         buf[4] = 1;</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;         buf[5] = 1;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, buf, addr_from, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;         pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a>++;</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a640be959dd0a4166b7032c88737444f8">process_request</a>(size, buf, pte);</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      }</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a> &gt; seq) {</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;               <span class="stringliteral">&quot;%s Warning : received a retransmitted packet : #0x%04x (we are at #0x%04x)\n&quot;</span>,</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;               tmpbuf, (<span class="keywordtype">unsigned</span>)seq, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a>);</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;         <span class="comment">/* BUG ? pte-&gt;device-&gt;seq_phone = seq; */</span></div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;         <span class="comment">/* Send ACK */</span></div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;         buf[4] = 1;</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;         buf[5] = 1;</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, buf, addr_from, &amp;pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">sout</a>);</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;      }</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;            <span class="stringliteral">&quot;%s Warning : we lost a packet : received #0x%04x (we are at #0x%04x)\n&quot;</span>,</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;            tmpbuf, (<span class="keywordtype">unsigned</span>)seq, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">seq_phone</a>);</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;   }</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;   <span class="keywordflow">if</span> (buf[4] == 0) {</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Retransmit request for packet #0x%04x\n&quot;</span>, tmpbuf, (<span class="keywordtype">unsigned</span>)seq);</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a> &gt; seq) {</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;               <span class="stringliteral">&quot;%s Error : received a request for an already ACKed packet : #0x%04x\n&quot;</span>,</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;               tmpbuf, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">last_seq_ack</a>);</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;      }</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a> &lt; seq) {</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;               <span class="stringliteral">&quot;%s Error : received a request for a non-existent packet : #0x%04x\n&quot;</span>,</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;               tmpbuf, (<span class="keywordtype">unsigned</span>)pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">seq_server</a>);</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      }</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9f0fd974c1b1884f2745b93d7a658659">send_retransmit</a>(pte);</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;   }</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s Unknown request : got 0x%02hhx expected 0x00,0x01 or 0x02\n&quot;</span>, tmpbuf, buf[4]);</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;}</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;</div><div class="line"><a name="l04794"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc"> 4794</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast)</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;{</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;   <span class="keywordflow">if</span> (!ast) {</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unistim callback function called with a null channel\n&quot;</span>);</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;   }</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast)) {</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unistim callback function called without a tech_pvt\n&quot;</span>);</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;   }</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;   sub = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>) {</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unistim callback function called without a line\n&quot;</span>);</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;   }</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>) {</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unistim callback function called without a device\n&quot;</span>);</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;   }</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unistim callback function called without a session\n&quot;</span>);</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;   }</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>;</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;}</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;</div><div class="line"><a name="l04825"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3"> 4825</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;{</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;   <span class="keywordtype">char</span> *cidname_str;</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;   <span class="keywordtype">char</span> *cidnum_str;</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;   }</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>) {</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;         cidnum_str = <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;         cidnum_str = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a51f7454e597b6aeff9686f0551866219">DEFAULTCALLERID</a>;</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      }</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(pte, 0, cidnum_str);</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <span class="keywordflow">if</span> (strlen(cidnum_str) == 0) {</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;         cidnum_str = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a51f7454e597b6aeff9686f0551866219">DEFAULTCALLERID</a>;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;      }</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>) {</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;         cidname_str = <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;         cidname_str = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8c8112dd258fef6c1ac58343f42aa3db">DEFAULTCALLERNAME</a>;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      }</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a>(pte, 1, cidname_str);</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <span class="keywordflow">if</span> (strlen(cidname_str) == 0) {</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;         cidname_str = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8c8112dd258fef6c1ac58343f42aa3db">DEFAULTCALLERNAME</a>;</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      }</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;         <span class="keywordtype">char</span> tmpstr[256];</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;         snprintf(tmpstr, <span class="keyword">sizeof</span>(tmpstr), <span class="stringliteral">&quot;%s %s&quot;</span>, cidnum_str, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(cidname_str, pte));</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmpstr);</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, cidname_str);</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(cidnum_str, pte));</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      }</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;   }</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;}</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;<span class="comment">/*--- unistim_call: Initiate UNISTIM call from PBX ---*/</span></div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;<span class="comment">/*      used from the dial() application      */</span></div><div class="line"><a name="l04867"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a148deb9252a1f8568bbf1338d320c879"> 4867</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a148deb9252a1f8568bbf1338d320c879">unistim_call</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">const</span> <span class="keywordtype">char</span> *dest, <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>)</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;{</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;   <span class="keywordtype">int</span> res = 0, i;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, *sub_real;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> ringstyle, ringvolume;</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;   session = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Device not registered, cannot call %s\n&quot;</span>, dest);</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;   }</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;   sub = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;   sub_real = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>) &amp;&amp; (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660addb60fd97b55a4aea24f992e30fe3c84">AST_STATE_RESERVED</a>)) {</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;unistim_call called on %s, neither down nor reserved\n&quot;</span>,</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(ast));</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;   }</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;unistim_call(%s)\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(ast));</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;   }</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;   session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a>;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(session, sub);</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(ast))) { <span class="comment">/* Send ring only if no call forward, otherwise short ring will apear */</span></div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, session, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;is calling you.&quot;</span>, session));</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(session, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Accept        Ignore Hangup&quot;</span>, session));</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <span class="keywordflow">if</span> (sub_real) {</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;         ringstyle = session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aab68eaa12f597d4212c56694bb4ee020">cwstyle</a>;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;         ringvolume = session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a5292df700ff59a61858e21147a5fc7b6">cwvolume</a>;</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;         ringstyle = (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a> == -1) ? session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a> : sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a>;</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;         ringvolume = (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a> == -1) ? session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a> : sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a>;</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      }</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1cc482381672ad23b589814decda5779">send_ring</a>(session, ringvolume, ringstyle);</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a>(session, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e999210eafaaa2ac9c550866ec34d2b">FAV_ICON_SPEAKER_ONHOOK_BLACK</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa453a7434dac6cfa107bddf8d253e7ac">FAV_BLINK_FAST</a>);</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="comment">/* Send call identification to all */</span></div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i)) {</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;         }</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i]) {</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;         }</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i) &amp;&amp; !strcmp(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[i]-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Found softkey %d for line %s\n&quot;</span>, i, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;            }</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(i, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4e999210eafaaa2ac9c550866ec34d2b">FAV_ICON_SPEAKER_ONHOOK_BLACK</a> + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa453a7434dac6cfa107bddf8d253e7ac">FAV_BLINK_FAST</a>, session);</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;            session-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] = <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;         }</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;      }</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;   }</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;   <a class="code" href="../../d9/d95/channelstate_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448">ast_setstate</a>(ast, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a5bf03bd84f434acaeefdacb0096e1baa">AST_STATE_RINGING</a>);</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a60f9d2b0ab8b7a839902313321163b28">ast_queue_control</a>(ast, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;}</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;</div><div class="line"><a name="l04927"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170"> 4927</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>) {</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a>(ast, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a>(sub, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a> = 0;</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Destroying RTP session\n&quot;</span>);</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;      }</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;      <a class="code" href="../../d5/dde/rtp__engine_8h.html#a3978338bfe35df207f003782e428fb0c">ast_rtp_instance_stop</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>);</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;      <a class="code" href="../../d5/dde/rtp__engine_8h.html#a0bfe6336fe7deb78148a84aef2732c7a">ast_rtp_instance_destroy</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>);</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;      sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;   }</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;}</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="comment">/*--- unistim_hangup: Hangup UNISTIM call */</span></div><div class="line"><a name="l04945"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a77c91d8d323c7e0d4d9b170f05bb732c"> 4945</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77c91d8d323c7e0d4d9b170f05bb732c">unistim_hangup</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast)</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;{</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *sub_real = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *sub_trans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;   <span class="keywordtype">int</span> i,end_call = 1;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;   s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;   sub = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;   l = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;   d = l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>;</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;   <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Asked to hangup channel not connected\n&quot;</span>);</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a>(ast, sub);</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;   }</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;unistim_hangup(%s) on %s@%s (STATE_%s)\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(ast), l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>));</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;   }</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;   sub_trans = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;   sub_real = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;   <span class="keywordflow">if</span> (sub_trans &amp;&amp; (sub_trans-&gt;owner) &amp;&amp; (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>)) { <span class="comment">/* 3rd party busy or congested and transfer_cancel_step2 does not called */</span></div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Threeway call disconnected, switching to real call\n&quot;</span>);</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      }</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a>(sub_trans-&gt;owner);</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      sub_trans-&gt;moh = 0;</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;      sub_trans-&gt;subtype = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>;</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29">swap_subs</a>(sub_trans, sub);</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(s, sub_trans);</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a>(ast, sub);</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;   }</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;   <span class="keywordflow">if</span> (sub_real &amp;&amp; (sub_real-&gt;owner) &amp;&amp; (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>) &amp;&amp; (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>)) { <span class="comment">/* 3way call cancelled by softkey pressed */</span></div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Real call disconnected, stay in call\n&quot;</span>);</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      }</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(s, sub_real);</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a>(ast, sub);</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;   }</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>) {</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5">sub_stop_silence</a>(s, sub);</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>) {</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(s);</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, i)) {</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;         }</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] != sub) {</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;            <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) { <span class="comment">/* Found other subchannel active other than hangup&#39;ed one */</span></div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;               end_call = 0;</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;            }</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;         }</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a>(d, i) &amp;&amp; !strcmp(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[i]-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(i, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, s);</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;         }</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      }</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;   }</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;   <span class="keywordflow">if</span> (end_call) {</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5df5b980ae3a08f9219065c5ef191060">send_end_call</a>(s); <span class="comment">/* Send end call packet only if ending active call, in other way sound should be loosed */</span></div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;   }</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">moh</a> = 0;</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> &gt;= 0) {</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>, s);</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;   }</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;   <span class="comment">/* Delete assign sub to softkey */</span></div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;      <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] == sub) {</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;      }</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;   }</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;   <span class="comment">/*refresh_all_favorite(s); */</span> <span class="comment">/* TODO: Update favicons in case of DND keys */</span></div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a> &amp;&amp; sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>) {</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a>(s);</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(ast) != <a class="code" href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a>) {</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a>++;</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e">write_history</a>(s, <span class="charliteral">&#39;i&#39;</span>, 1);</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      }</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      <span class="keywordflow">if</span> (!sub_real) {</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a>(s);</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">/* hangup on a ringing line: reset status to reflect that we&#39;re still on an active call */</span></div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;            s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a>;</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(s, sub_real);</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;is on-line&quot;</span>, s));</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a>, s);</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      }</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;   }</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a> &amp;&amp; sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>) {</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a>(s);</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;   }</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> = -1;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a>(ast, sub);</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;}</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;<span class="comment">/*--- unistim_answer: Answer UNISTIM call */</span></div><div class="line"><a name="l05054"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae81cba0110cb56a82ebd9b1bc3d6f396"> 5054</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae81cba0110cb56a82ebd9b1bc3d6f396">unistim_answer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast)</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;{</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;   s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;   <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;unistim_answer on a disconnected device ?\n&quot;</span>);</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;   }</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;   sub = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;   l = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;   d = l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>;</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;unistim_answer(%s) on %s@%s-%d\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(ast), l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;               l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>);</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;   }</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;is now on-line&quot;</span>, s));</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>)) {</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Transf Cancel&quot;</span>, s));</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a>(s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;       Transf        Hangup&quot;</span>, s));</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;   }</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a>(s);</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>)</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;      <a class="code" href="../../d9/d95/channelstate_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448">ast_setstate</a>(ast, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>);</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;}</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="comment">/*--- unistimsock_read: Read data from UNISTIM socket ---*/</span></div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;<span class="comment">/*    Successful messages is connected to UNISTIM call and forwarded to parsing() */</span></div><div class="line"><a name="l05089"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a813aeea6a30d10c1b157bd726952e0e3"> 5089</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a813aeea6a30d10c1b157bd726952e0e3">unistimsock_read</a>(<span class="keywordtype">int</span> *<span class="keywordtype">id</span>, <span class="keywordtype">int</span> fd, <span class="keywordtype">short</span> <a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>, <span class="keywordtype">void</span> *<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#a1229bdedff51a0fc453b7c482cd8dd49">ignore</a>)</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;{</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;   <span class="keyword">struct </span>sockaddr_in addr_from = { 0, };</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *cur = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = 0;</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;   <span class="keywordtype">int</span> dw_num_bytes_rcvd;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size_addr_from;</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="preprocessor">#ifdef DUMP_PACKET</span></div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;   <span class="keywordtype">int</span> dw_num_bytes_rcvdd;</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;   size_addr_from = <span class="keyword">sizeof</span>(addr_from);</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;   dw_num_bytes_rcvd =</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      recvfrom(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a72adc862c84ef019effe055d5f12d9c6">SIZE_PAGE</a>, 0, (<span class="keyword">struct</span> sockaddr *) &amp;addr_from,</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;             &amp;size_addr_from);</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;   <span class="keywordflow">if</span> (dw_num_bytes_rcvd == -1) {</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EAGAIN) {</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;UNISTIM: Received packet with bad UDP checksum\n&quot;</span>);</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != ECONNREFUSED) {</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Recv error %d (%s)\n&quot;</span>, <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      }</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;   }</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;   <span class="comment">/* Looking in the phone list if we already have a registration for him */</span></div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;   cur = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;   <span class="keywordflow">while</span> (cur) {</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr.s_addr == addr_from.sin_addr.s_addr) {</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;         found = 1;</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      }</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      tmp++;</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      cur = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;   }</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;<span class="preprocessor">#ifdef DUMP_PACKET</span></div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>)</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;\n*** Dump %d bytes from %s - phone_table[%d] ***\n&quot;</span>,</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;               dw_num_bytes_rcvd, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(addr_from.sin_addr), tmp);</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;   <span class="keywordflow">for</span> (dw_num_bytes_rcvdd = 0; dw_num_bytes_rcvdd &lt; dw_num_bytes_rcvd;</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;       dw_num_bytes_rcvdd++)</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;%02hhx &quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>[dw_num_bytes_rcvdd]);</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;\n******************************************\n&quot;</span>);</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;   <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Received a packet from an unknown source\n&quot;</span>);</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      }</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a>(dw_num_bytes_rcvd, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (<span class="keyword">struct</span> sockaddr_in *) &amp;addr_from);</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a>(dw_num_bytes_rcvd, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>, cur, (<span class="keyword">struct</span> sockaddr_in *) &amp;addr_from);</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;   }</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;}</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;</div><div class="line"><a name="l05149"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4ea7ea5c6c34d6069e7863dc11e1841b"> 5149</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4ea7ea5c6c34d6069e7863dc11e1841b">unistim_rtp_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast,</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;{</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;   <span class="comment">/* Retrieve audio/etc from channel.  Assumes sub-&gt;lock is already held. */</span></div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *f;</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;   <span class="keywordflow">if</span> (!ast) {</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Channel NULL while reading\n&quot;</span>);</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a>;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;   }</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;RTP handle NULL while reading on subchannel %u\n&quot;</span>,</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;            sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>);</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a>;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;   }</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a3e3e7e66e65ad9cdba2299e36b13e173">ast_channel_fdno</a>(ast)) {</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;   <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      f = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a8e272a4ee35206ff8c4c0384b9e3f592">ast_rtp_instance_read</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 0);     <span class="comment">/* RTP Audio */</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;   <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;      f = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a8e272a4ee35206ff8c4c0384b9e3f592">ast_rtp_instance_read</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 1);    <span class="comment">/* RTCP Control Channel */</span></div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      f = &amp;<a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a>;</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;   }</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;      <span class="comment">/* We already hold the channel lock */</span></div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3c/format__cap_8h.html#a4fadd3c35438f866e29eddc68283bce6">ast_format_cap_iscompatible_format</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a>) {</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *caps;</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                  <span class="stringliteral">&quot;Oooh, format changed from %s to %s\n&quot;</span>,</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                  <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), &amp;cap_buf),</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                  <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>));</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;            caps = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;            <span class="keywordflow">if</span> (caps) {</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;               <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(caps, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, 0);</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a3c9c29fb2bc2b715fee335c1ffa50449">ast_channel_nativeformats_set</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, caps);</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caps, -1);</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;            }</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a9107a83365cbf327cc0d12cb0dbd28d8">ast_set_read_format</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>));</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>));</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;         }</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      }</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;   }</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;   <span class="keywordflow">return</span> f;</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;}</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;</div><div class="line"><a name="l05204"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2accd5119ec27e18e50be3af305cf42e"> 5204</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2accd5119ec27e18e50be3af305cf42e">unistim_read</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast)</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;{</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *fr;</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;   fr = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4ea7ea5c6c34d6069e7863dc11e1841b">unistim_rtp_read</a>(ast, sub);</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;   <span class="keywordflow">return</span> fr;</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;}</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;</div><div class="line"><a name="l05216"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7de71b5fc170bcc10f3d1c44da09f3c2"> 5216</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7de71b5fc170bcc10f3d1c44da09f3c2">unistim_write</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame)</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;{</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;   <span class="keywordflow">if</span> (frame-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      <span class="keywordflow">if</span> (frame-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a6c9398ee8989239124295d096a87bf32">AST_FRAME_IMAGE</a>) {</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t send %u type frames with unistim_write\n&quot;</span>,</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;               frame-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>);</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;      }</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3c/format__cap_8h.html#a4fadd3c35438f866e29eddc68283bce6">ast_format_cap_iscompatible_format</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(ast), frame-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a>) {</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;               <span class="stringliteral">&quot;Asked to transmit frame type %s, while native formats is %s (read/write = (%s/%s)\n&quot;</span>,</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;               <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(frame-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>),</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;               <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(ast), &amp;cap_buf),</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;               <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(ast)),</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;               <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(ast)));</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      }</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;   }</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;   <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;         res = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a87cb097a21ab7712c27aa9e3b3a1ef69">ast_rtp_instance_write</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, frame);</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      }</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;   }</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;}</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;</div><div class="line"><a name="l05254"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad68c0963a805ff4107528fe6ebbc2b59"> 5254</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad68c0963a805ff4107528fe6ebbc2b59">unistim_fixup</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *oldchan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *newchan)</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;{</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *p = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(newchan);</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l = p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;New owner for channel USTM/%s@%s-%u is %s\n&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;         l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(newchan));</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;   <span class="keywordflow">if</span> (p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> != oldchan) {</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;old channel wasn&#39;t %s (%p) but was %s (%p)\n&quot;</span>,</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(oldchan), oldchan, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;   }</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a>(p, newchan);</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;p-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;}</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;</div><div class="line"><a name="l05279"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a240fa2ebaa98bd76495b1cefde05660a"> 5279</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a240fa2ebaa98bd76495b1cefde05660a">control2str</a>(<span class="keywordtype">int</span> ind)</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;{</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;   <span class="keywordflow">switch</span> (ind) {</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>:</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Other end has hungup&quot;</span>;</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a00675bfb8c64b2be86297fe4cba51fa2">AST_CONTROL_RING</a>:</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Local ring&quot;</span>;</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Remote end is ringing&quot;</span>;</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>:</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Remote end has answered&quot;</span>;</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Remote end is busy&quot;</span>;</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5a24176e8066b727463907da4903bb8e">AST_CONTROL_TAKEOFFHOOK</a>:</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Make it go off hook&quot;</span>;</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755">AST_CONTROL_OFFHOOK</a>:</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Line is off hook&quot;</span>;</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Congestion (circuits busy)&quot;</span>;</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a>:</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Flash hook&quot;</span>;</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a195b2c39c09113953814aa800dd06e7f">AST_CONTROL_WINK</a>:</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Wink&quot;</span>;</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac4106406e269667ff84ee49e0a634f94">AST_CONTROL_OPTION</a>:</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Set a low-level option&quot;</span>;</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aacb7ddf1a95fa544fdecada68213f3c7">AST_CONTROL_RADIO_KEY</a>:</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Key Radio&quot;</span>;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a34ac3ccebc219c59daa7eb0275fcd54d">AST_CONTROL_RADIO_UNKEY</a>:</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Un-Key Radio&quot;</span>;</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>:</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Remote end changed&quot;</span>;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8">AST_CONTROL_SRCCHANGE</a>:</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;RTP source updated&quot;</span>;</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a>:</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Source of media changed&quot;</span>;</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;   <span class="keywordflow">case</span> -1:</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stop tone&quot;</span>;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;   }</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;}</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;</div><div class="line"><a name="l05320"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b"> 5320</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b">in_band_indication</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d77/structast__tone__zone.html">ast_tone_zone</a> *<a class="code" href="../../dd/d22/cdr__pgsql_8c.html#afcc6d32094cfa01ee935b17325f48d4b">tz</a>,</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *indication)</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;{</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dab/structast__tone__zone__sound.html">ast_tone_zone_sound</a> *ts = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;   <span class="keywordflow">if</span> ((ts = <a class="code" href="../../d2/d0f/indications_8h.html#a516be2823557000dcd4be685a44d1d09">ast_get_indication_tone</a>(tz, indication))) {</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;      <a class="code" href="../../d2/d0f/indications_8h.html#a544e8a1dd4a986b00754103dda6a7d3b">ast_playtones_start</a>(ast, 0, ts-&gt;<a class="code" href="../../d5/dab/structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>, 1);</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;      ts = <a class="code" href="../../d2/d0f/indications_8h.html#a8b52ace68f21c0ac24414f038471647d">ast_tone_zone_sound_unref</a>(ts);</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to get indication tone for %s\n&quot;</span>, indication);</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   }</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;}</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;</div><div class="line"><a name="l05333"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ae6520d9b6a2dcd9dafdee9af3732039a"> 5333</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae6520d9b6a2dcd9dafdee9af3732039a">unistim_indicate</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">int</span> ind, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d5/dab/structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>, <span class="keywordtype">size_t</span> datalen)</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;{</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Asked to indicate &#39;%s&#39; (%d) condition on channel %s\n&quot;</span>,</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a240fa2ebaa98bd76495b1cefde05660a">control2str</a>(ind), ind, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(ast));</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;   }</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;   s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;   <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;   }</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;   sub = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(ast);</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;   l = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;   <span class="keywordflow">switch</span> (ind) {</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Ringing...&quot;</span>, s));</div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b">in_band_indication</a>(ast, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>, <span class="stringliteral">&quot;ring&quot;</span>);</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;         s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = -1;</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;      }</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a> = 1;</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Busy&quot;</span>, s));</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b">in_band_indication</a>(ast, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>, <span class="stringliteral">&quot;busy&quot;</span>);</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;         s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = -1;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;      }</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af3bdb353330f1908e9558180b5bb9e16">AST_CONTROL_INCOMPLETE</a>:</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      <span class="comment">/* Overlapped dialing is not currently supported for UNIStim.  Treat an indication</span></div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="comment">       * of incomplete as congestion</span></div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(ast) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;         sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a> = 1;</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, s, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Congestion&quot;</span>, s));</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b">in_band_indication</a>(ast, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>, <span class="stringliteral">&quot;congestion&quot;</span>);</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;         s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = -1;</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;      }</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a>:</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a>(ast, data, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a>:</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(ast);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a1a461c5e737ed6ed7c8cb0f78557a6fd">AST_CONTROL_PROGRESS</a>:</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a>:</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a50b7fe33bba67b74dd7b746539e81000">AST_CONTROL_PROCEEDING</a>:</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee">AST_CONTROL_UPDATE_RTP_PEER</a>:</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;   <span class="keywordflow">case</span> -1:</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;      <a class="code" href="../../d2/d0f/indications_8h.html#a9d5be069b7060d326a213f5d60b8dc77">ast_playtones_stop</a>(ast);</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;      s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">missed_call</a> = 0;</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>:</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Connected party is now %s &lt;%s&gt;\n&quot;</span>,</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(ast)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(ast)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>.str, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(ast)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(ast)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>) {</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a>(s, sub);</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;      }</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8">AST_CONTROL_SRCCHANGE</a>:</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;         <a class="code" href="../../d5/dde/rtp__engine_8h.html#adcb4a92a7c8fd3bcde19ecc417a3e8a3">ast_rtp_instance_change_source</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>);</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;      }</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Don&#39;t know how to indicate condition %d\n&quot;</span>, ind);</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;      <span class="comment">/* fallthrough */</span></div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a>:</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af699fa9e173afdd4c1fea90ee892330e">AST_CONTROL_MASQUERADE_NOTIFY</a>:</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;   }</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;}</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;</div><div class="line"><a name="l05421"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a0fdd8e9ba003ce056acde0f1d4d8fef4"> 5421</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fdd8e9ba003ce056acde0f1d4d8fef4">find_subchannel_by_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *dest)</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;{</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;   <span class="keywordtype">char</span> line[256];</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;   <span class="keywordtype">char</span> *at;</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;   <span class="keywordtype">char</span> *device;</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(line, dest, <span class="keyword">sizeof</span>(line));</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;   at = strchr(line, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;   <span class="keywordflow">if</span> (!at) {</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Device &#39;%s&#39; has no @ (at) sign!\n&quot;</span>, dest);</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;   }</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;   *at = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;   at++;</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;   device = at;</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;   d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;   at = strchr(device, <span class="charliteral">&#39;/&#39;</span>);       <span class="comment">/* Extra options ? */</span></div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;   <span class="keywordflow">if</span> (at) {</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      *at = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;   }</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, device)) {</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Found device: %s\n&quot;</span>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;         }</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;         <span class="comment">/* Found the device */</span></div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">list</a>) {</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;            <span class="comment">/* Search for the right line */</span></div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, line)) {</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Found line: %s\n&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;               }</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;               sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;               <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                  sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;               }</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;               <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;                  <span class="comment">/* Allocate additional channel if asterisk channel already here */</span></div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;                  sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>);</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;                  sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">holding</a> = 1;</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;               }</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;               sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a> = -1;</div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;               sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a> = -1;</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;               <span class="keywordflow">if</span> (at) {       <span class="comment">/* Other options ? */</span></div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;                  at++;   <span class="comment">/* Skip slash */</span></div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;                  <span class="keywordflow">if</span> (*at == <span class="charliteral">&#39;r&#39;</span>) {       <span class="comment">/* distinctive ring */</span></div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;                     at++;</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;                     <span class="keywordflow">if</span> ((*at &lt; <span class="charliteral">&#39;0&#39;</span>) || (*at &gt; <span class="charliteral">&#39;7&#39;</span>)) { <span class="comment">/* ring style */</span></div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;                        <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid ring selection (%s)&quot;</span>, at);</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;                        <span class="keywordtype">signed</span> <span class="keywordtype">char</span> ring_volume = -1;</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;                        <span class="keywordtype">signed</span> <span class="keywordtype">char</span> ring_style = *at - <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;                        at++;</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;                        <span class="keywordflow">if</span> ((*at &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (*at &lt;= <span class="charliteral">&#39;3&#39;</span>)) {      <span class="comment">/* ring volume */</span></div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;                           ring_volume = *at - <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;                        }</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;                           <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Distinctive ring: style #%d volume %d\n&quot;</span>,</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;                               ring_style, ring_volume);</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;                        }</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;                        sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a> = ring_volume;</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;                        sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a> = ring_style;</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;                     }</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;                  }</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;               }</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;               sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a> = l;</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;            }</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;         }</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;         <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;         }</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;      }</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;   }</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;   <span class="comment">/* Device not found */</span></div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;}</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;</div><div class="line"><a name="l05509"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4621bc4d2e56c21790efc3debe949b83"> 5509</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4621bc4d2e56c21790efc3debe949b83">unistim_senddigit_begin</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>)</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;{</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;   <span class="keywordflow">if</span> (!pte) {</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;   }</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa3e60bae9ed59bd4a6501181ccc3976b">send_dtmf_tone</a>(pte, digit);</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;}</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;</div><div class="line"><a name="l05519"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a69f342be6241cf144b32186890bb5e61"> 5519</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69f342be6241cf144b32186890bb5e61">unistim_senddigit_end</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> duration)</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;{</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;   <span class="keywordflow">if</span> (!pte) {</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;   }</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Send Digit off %c (duration %d)\n&quot;</span>, digit, duration);</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;   }</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a>(pte, 0, 0);</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;}</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment">/*--- unistim_sendtext: Display a text on the phone screen ---*/</span></div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;<span class="comment">/*      Called from PBX core text message functions */</span></div><div class="line"><a name="l05536"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab5daefc58bff9275e962b82ddf0cb72a"> 5536</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab5daefc58bff9275e962b82ddf0cb72a">unistim_sendtext</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *ast, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;{</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *pte = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a>(ast);</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> + 1];</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;unistim_sendtext called\n&quot;</span>);</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;   }</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;unistim_sendtext called with a null text\n&quot;</span>);</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;   }</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;   <span class="keywordflow">if</span> (!pte) {</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;   }</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;   size = strlen(text);</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;   <span class="keywordflow">if</span> (text[0] == <span class="charliteral">&#39;@&#39;</span>) {</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;      <span class="keywordtype">int</span> pos = 0, i = 1, tok = 0, sz = 0;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <span class="keywordtype">char</span> label[11];</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d6/d49/structnumber.html">number</a>[16];</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;      <span class="keywordtype">char</span> icon = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;      <span class="keywordtype">char</span> cur = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;      memset(label, 0, 11);</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      memset(number, 0, 16);</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;      <span class="keywordflow">while</span> (text[i]) {</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;         cur = text[i++];</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;         <span class="keywordflow">switch</span> (tok) {</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;         <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;            <span class="keywordflow">if</span> ((cur &lt; <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (cur &gt; <span class="charliteral">&#39;5&#39;</span>)) {</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                     <span class="stringliteral">&quot;sendtext failed : position must be a number beetween 0 and 5\n&quot;</span>);</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;            }</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;            pos = cur - <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;            tok = 1;</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;         <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;            <span class="keywordflow">if</span> (cur != <span class="charliteral">&#39;@&#39;</span>) {</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;sendtext failed : invalid position\n&quot;</span>);</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;            }</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;            tok = 2;</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;         <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;            <span class="keywordflow">if</span> ((cur &lt; <span class="charliteral">&#39;3&#39;</span>) &amp;&amp; (cur &gt; <span class="charliteral">&#39;6&#39;</span>)) {</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;                     <span class="stringliteral">&quot;sendtext failed : icon must be a number beetween 32 and 63 (first digit invalid)\n&quot;</span>);</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;            }</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;            icon = (cur - <span class="charliteral">&#39;0&#39;</span>) * 10;</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;            tok = 3;</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;         <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;            <span class="keywordflow">if</span> ((cur &lt; <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (cur &gt; <span class="charliteral">&#39;9&#39;</span>)) {</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;                     <span class="stringliteral">&quot;sendtext failed : icon must be a number beetween 32 and 63 (second digit invalid)\n&quot;</span>);</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;            }</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;            icon += (cur - <span class="charliteral">&#39;0&#39;</span>);</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;            tok = 4;</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;         <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;            <span class="keywordflow">if</span> (cur != <span class="charliteral">&#39;@&#39;</span>) {</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;                     <span class="stringliteral">&quot;sendtext failed : icon must be a number beetween 32 and 63 (too many digits)\n&quot;</span>);</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;            }</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;            tok = 5;</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;         <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;            <span class="keywordflow">if</span> (cur == <span class="charliteral">&#39;@&#39;</span>) {</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;               tok = 6;</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;               sz = 0;</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;            }</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;            <span class="keywordflow">if</span> (sz &gt; 10) {</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;            }</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;            label[sz] = cur;</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;            sz++;</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;         <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;            <span class="keywordflow">if</span> (sz &gt; 15) {</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;                     <span class="stringliteral">&quot;sendtext failed : extension too long = %d (15 car max)\n&quot;</span>,</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;                     sz);</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;            }</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;            number[sz] = cur;</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;            sz++;</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;         }</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;      }</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      <span class="keywordflow">if</span> (tok != 6) {</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;sendtext failed : incomplet command\n&quot;</span>);</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      }</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      <span class="keywordflow">if</span> (!pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;sendtext failed : no device ?\n&quot;</span>);</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      }</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      strcpy(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[pos], label);</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;      strcpy(pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[pos], number);</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[pos] = icon;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a>(pos, icon, pte, label);</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;   }</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;   <span class="keywordflow">if</span> (size &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> * 2) {</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      <span class="keywordflow">if</span> (pte-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> == 1) {</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, text);</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a>(<span class="stringliteral">&quot;Message :&quot;</span>, pte));</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, text);</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      }</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;      <span class="keywordflow">if</span> (size &lt;= <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>) {</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;      }</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      memcpy(tmp, text + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>);</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      tmp[<span class="keyword">sizeof</span>(<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;   }</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, text);</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;   memcpy(tmp, text + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>);</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;   tmp[<span class="keyword">sizeof</span>(<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;   memcpy(tmp, text + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a> * 2, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a>);</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;   tmp[<span class="keyword">sizeof</span>(<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a>, pte, tmp);</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;}</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;<span class="comment">/*--- unistim_send_mwi_to_peer: Send message waiting indication ---*/</span></div><div class="line"><a name="l05675"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aaba29834ad7f3e8f828262ffe6ce62a9"> 5675</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaba29834ad7f3e8f828262ffe6ce62a9">unistim_send_mwi_to_peer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *peer, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tick)</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;{</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;   <span class="keywordtype">int</span> <span class="keyword">new</span>;</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#ab3da17290725793258020b83f56e4df6">stasis_cache_get</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a>(), <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a>(), peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>);</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;   <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d6/d45/structast__mwi__state.html">ast_mwi_state</a> *mwi_state = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;      <span class="keyword">new</span> = mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga70de9f16a229e2c5bf1a973372949d3e">new_msgs</a>;</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/* Fall back on checking the mailbox directly */</span></div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;      <span class="keyword">new</span> = <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a76b4d3927cacd1bcd5da9ca8fe375cb6">ast_app_has_voicemail</a>(peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;   }</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;MWI Status for mailbox %s is %d, lastmsgsent:%d\n&quot;</span>,</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;      peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, <span class="keyword">new</span>, peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a>);</div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;   peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8e02569adc3b742182f7c3249433237e">nextmsgcheck</a> = tick + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2935cf6fc27803112f358fd6da9d13ae">TIMER_MWI</a>;</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;   <span class="comment">/* Return now if it&#39;s the same thing we told them last time */</span></div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;   <span class="keywordflow">if</span> ((peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> != <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a>) || (<span class="keyword">new</span> == peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a>)) {</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;   }</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;   peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">lastmsgssent</a> = <span class="keyword">new</span>;</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a>(peer-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>, (<span class="keyword">new</span> &gt; 0)?<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a94a931f0f31df959b9f33a5f294dc99f">LED_BAR_ON</a>:<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a>);</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;}</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;<span class="comment">/*--- unistim_new: Initiate a call in the UNISTIM channel */</span></div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;<span class="comment">/*      called from unistim_request (calls from the pbx ) */</span></div><div class="line"><a name="l05704"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be"> 5704</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> *assignedids, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *requestor)</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;{</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *caps;</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *tmpfmt;</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;subchannel null in unistim_new\n&quot;</span>);</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;   }</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>) {</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;no line for subchannel %p\n&quot;</span>, sub);</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;   }</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;   caps = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;   <span class="keywordflow">if</span> (!caps) {</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;   }</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;   l = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>;</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;   tmp = <a class="code" href="../../d5/d7b/channel_8h.html#a2f18aafad0442206e71033ac6676dbb5">ast_channel_alloc</a>(1, state, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#adfee50d07a98645d4d20b896ce03785a">accountcode</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a78d4847658b695383d849efd12399b38">exten</a>,</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;      l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, assignedids, requestor, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ad2cfb0f821c065261382a9298bb5a16b">amaflags</a>, <span class="stringliteral">&quot;USTM/%s@%s-%p&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, sub);</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;unistim_new sub=%u (%p) chan=%p line=%s\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>, sub, tmp, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;   }</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;   <span class="keywordflow">if</span> (!tmp) {</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to allocate channel structure\n&quot;</span>);</div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caps, -1);</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;   }</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf195fcf1686408b5e52ad76996653cea">ast_channel_stage_snapshot</a>(tmp);</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>)) {</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(caps, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(caps, global_cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;   }</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a3c9c29fb2bc2b715fee335c1ffa50449">ast_channel_nativeformats_set</a>(tmp, caps);</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caps, -1);</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;   tmpfmt = <a class="code" href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(tmp), 0);</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *native_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *global_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Best codec = %s from nativeformats %s (line cap=%s global=%s)\n&quot;</span>,</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;         <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(tmpfmt),</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;         <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(tmp), &amp;native_buf),</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;         <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, &amp;cap_buf),</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;         <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(global_cap, &amp;global_buf));</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;   }</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;   <span class="keywordflow">if</span> ((sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) &amp;&amp; (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == 0)) {</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;New unistim channel with a previous rtp handle ?\n&quot;</span>);</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      }</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(tmp, 0, <a class="code" href="../../d5/dde/rtp__engine_8h.html#aee3ef7f9e53a34e743c3a95c9ca95fb4">ast_rtp_instance_fd</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 0));</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(tmp, 1, <a class="code" href="../../d5/dde/rtp__engine_8h.html#aee3ef7f9e53a34e743c3a95c9ca95fb4">ast_rtp_instance_fd</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, 1));</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;   }</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;      <a class="code" href="../../dc/d14/abstract__jb_8h.html#a0981c84ac90dd79bc2a0fdd90aa6efba">ast_jb_configure</a>(tmp, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>);</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;   }</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;<span class="comment">/*      tmp-&gt;type = type; */</span></div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;   <a class="code" href="../../d9/d95/channelstate_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448">ast_setstate</a>(tmp, state);</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;   <span class="keywordflow">if</span> (state == <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a10482c2bc6340e09ed02b00bc0e3f433">AST_STATE_RING</a>) {</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a0c25448e9c6e2630a8a9cc96b7482cfe">ast_channel_rings_set</a>(tmp, 1);</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;   }</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aed40a28831fcb5791cd63c1b8761d659">ast_channel_adsicpe_set</a>(tmp, <a class="code" href="../../d5/d7b/channel_8h.html#a828f537544a2ad2352c56c078390a0bda5f0673b46cfdba3094393b3fbce084ff">AST_ADSI_UNAVAILABLE</a>);</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#afac6d7d115c1edfe3ad8a8c7fa5d59d1">ast_channel_set_writeformat</a>(tmp, tmpfmt);</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa2df58e77751b741b6891afe210b5b8c">ast_channel_set_rawwriteformat</a>(tmp, tmpfmt);</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab3786cbbff7a03241fc75dafa0c8a1c1">ast_channel_set_readformat</a>(tmp, tmpfmt);</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a921a2d48faa9ed99a59d33e7aefa7888">ast_channel_set_rawreadformat</a>(tmp, tmpfmt);</div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tmpfmt, -1);</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a>(tmp, sub);</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af0566a4937a5bb1323825e4ef89c0e5a">ast_channel_tech_set</a>(tmp, &amp;unistim_tech);</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)) {</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;      ast_channel_language_set(tmp, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>);</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;   }</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a>(sub, tmp);</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a28b9e8444e0f9b495cc1b10628b816e8">ast_update_use_count</a>();</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a9824ec754695fd10c2ad3ca929afba34">ast_channel_callgroup_set</a>(tmp, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#af0f007b48a9c8cf0629428bd0483e0d1">callgroup</a>);</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae9542942f37422e284dd5c8a3fa7c7b6">ast_channel_pickupgroup_set</a>(tmp, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#abc0651bcec68410023c036b7d8ec4d11">pickupgroup</a>);</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;   ast_channel_call_forward_set(tmp, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">call_forward</a>);</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>)) {</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, *loc, *instr;</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;      instr = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>);</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;      <span class="keywordflow">if</span> (instr) {</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;         <a class="code" href="../../de/d47/callerid_8h.html#a39e03ca4e8df3a1d2c75e888d76201df">ast_callerid_parse</a>(instr, &amp;name, &amp;loc);</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> = 1;</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str);</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(loc);</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> = 1;</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<span class="keywordtype">id</span>.name.str);</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(name);</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(instr);</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;      }</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;   }</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae56cab679c0cda6436b930bc74297895">ast_channel_priority_set</a>(tmp, 1);</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga920b9d3e484257c7e593452a8e36d8d4">ast_channel_stage_snapshot_done</a>(tmp);</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(tmp);</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;   <span class="keywordflow">if</span> (state != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>) {</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Starting pbx in unistim_new\n&quot;</span>);</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      }</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/de0/pbx_8h.html#a9a937fbb3b5f4e68880a9c5714a29ce5">ast_pbx_start</a>(tmp)) {</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to start PBX on %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(tmp));</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(tmp);</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;         tmp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;      }</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;   }</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;}</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;</div><div class="line"><a name="l05827"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d"> 5827</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;{</div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = chan;</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;   <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;      <a class="code" href="../../d5/dde/rtp__engine_8h.html#ab88c871dd5c164b7a0a6af5e7e12d16f">ast_rtp_instance_set_channel_id</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;   }</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;}</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;</div><div class="line"><a name="l05835"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a02d8db6086b4a18353b82ebcad631ff6"> 5835</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a02d8db6086b4a18353b82ebcad631ff6">do_monitor</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;{</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *cur = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dw_timeout = 0;</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tick;</div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;   <span class="keywordtype">int</span> reloading;</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;   <span class="comment">/* Add an I/O event to our UDP socket */</span></div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> &gt; -1) {</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;      <a class="code" href="../../dc/dac/io_8h.html#aa250c3f6541dc5734deb966d6821da7a">ast_io_add</a>(io, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a813aeea6a30d10c1b157bd726952e0e3">unistimsock_read</a>, <a class="code" href="../../dc/dac/io_8h.html#a0d9e01f215782a343a1b71b5be362080">AST_IO_IN</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;   }</div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;   <span class="comment">/* This thread monitors our UDP socket and timers */</span></div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;      <span class="comment">/* This loop is executed at least every IDLE_WAITus (1s) or every time a packet is received */</span></div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;      <span class="comment">/* Looking for the smallest time-out value */</span></div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;      tick = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a>();</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;      dw_timeout = UINT_MAX;</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;      cur = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;checking timeout for session %p with tick = %u\n&quot;</span>, cur, tick);</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;      <span class="keywordflow">while</span> (cur) {</div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;checking timeout for session %p timeout = %u\n&quot;</span>, cur,</div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;                  cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);</div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;         <span class="comment">/* Check if we have miss something */</span></div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;         <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> &lt;= tick) {</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;Event for session %p\n&quot;</span>, cur);</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            <span class="comment">/* If the queue is empty, send a ping */</span></div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;            <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">last_buf_available</a> == 0) {</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a809cffe22b7ff73ee3e2c064a2f3ced7">send_ping</a>(cur);</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9f0fd974c1b1884f2745b93d7a658659">send_retransmit</a>(cur)) {</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;The chained link was modified, restarting...\n&quot;</span>);</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;                  cur = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;                  dw_timeout = UINT_MAX;</div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;               }</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;            }</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;         }</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;         <span class="keywordflow">if</span> (dw_timeout &gt; cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> - tick) {</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;            dw_timeout = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> - tick;</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;         }</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;         <span class="comment">/* Checking if the phone is logged on for a new MWI */</span></div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;         <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>) {</div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;               <span class="keywordflow">if</span> ((!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>)) &amp;&amp; (tick &gt;= l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8e02569adc3b742182f7c3249433237e">nextmsgcheck</a>)) {</div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;Checking mailbox for MWI\n&quot;</span>);</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;                  <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aaba29834ad7f3e8f828262ffe6ce62a9">unistim_send_mwi_to_peer</a>(l, tick);</div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;               }</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;            }</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;            <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a> &amp;&amp; tick &gt;= cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a>) {</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a>(cur);</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;               cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">nextdial</a> = 0;</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;            }</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;         }</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;         cur = cur-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;      }</div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a>(<span class="stringliteral">&quot;Waiting for %dus\n&quot;</span>, dw_timeout);</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;      res = dw_timeout;</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;      <span class="comment">/* We should not wait more than IDLE_WAIT */</span></div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;      <span class="keywordflow">if</span> ((res &lt; 0) || (res &gt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5a69b56bd6aaac508e7be719b487a804">IDLE_WAIT</a>)) {</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;         res = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5a69b56bd6aaac508e7be719b487a804">IDLE_WAIT</a>;</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;      }</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;      <span class="comment">/* Wait for UDP messages for a maximum of res us */</span></div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;      res = <a class="code" href="../../dc/dac/io_8h.html#a6f1abe730a5606b88c8f415f53b784bc">ast_io_wait</a>(io, res);     <span class="comment">/* This function will call unistimsock_read if a packet is received */</span></div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;      <span class="comment">/* Check for a reload request */</span></div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a>);</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;      reloading = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a>;</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a> = 0;</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a>);</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;      <span class="keywordflow">if</span> (reloading) {</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Reloading unistim.conf...\n&quot;</span>);</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011">reload_config</a>();</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;      }</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;      pthread_testcancel();</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;   }</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;   <span class="comment">/* Never reached */</span></div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;}</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;<span class="comment">/*--- restart_monitor: Start the channel monitor thread ---*/</span></div><div class="line"><a name="l05921"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c"> 5921</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c">restart_monitor</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;{</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;   pthread_attr_t attr;</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;   <span class="comment">/* If we&#39;re supposed to be stopped -- stay stopped */</span></div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> == <a class="code" href="../../dd/d42/lock_8h.html#a873a83eb8196323194aac2bea23d794e">AST_PTHREADT_STOP</a>) {</div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;   }</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>)) {</div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to lock monitor\n&quot;</span>);</div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;   }</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> == pthread_self()) {</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot kill myself\n&quot;</span>);</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;   }</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>) {</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;      <span class="comment">/* Wake up the thread */</span></div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;      pthread_kill(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a>, SIGURG);</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;      pthread_attr_init(&amp;attr);</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;      pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;      <span class="comment">/* Start a new monitor */</span></div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a>, &amp;attr, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a02d8db6086b4a18353b82ebcad631ff6">do_monitor</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0) {</div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to start monitor thread.\n&quot;</span>);</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;      }</div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;   }</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;}</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;<span class="comment">/*--- unistim_request: PBX interface function ---*/</span></div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;<span class="comment">/* UNISTIM calls initiated by the PBX arrive here */</span></div><div class="line"><a name="l05956"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa202d63f744ac6fc728ee8ea937e4d7b"> 5956</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa202d63f744ac6fc728ee8ea937e4d7b">unistim_request</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> *assignedids, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *requestor, <span class="keyword">const</span> <span class="keywordtype">char</span> *dest,</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;                                 <span class="keywordtype">int</span> *cause)</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;{</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, *sub_ring, *sub_trans;</div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *tmpc = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[256];</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d0/d3c/format__cap_8h.html#a9c9b87b5062c057862aa7d4237db2780">ast_format_cap_iscompatible</a>(cap, global_cap))) {</div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *global_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;            <span class="stringliteral">&quot;Asked to get a channel of unsupported format %s while capability is %s\n&quot;</span>,</div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;            <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(cap, &amp;cap_buf),</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;            <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(global_cap, &amp;global_buf));</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;   }</div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;</div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp, dest, <span class="keyword">sizeof</span>(tmp));</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(tmp)) {</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Unistim channels require a device\n&quot;</span>);</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;   }</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fdd8e9ba003ce056acde0f1d4d8fef4">find_subchannel_by_name</a>(tmp);</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No available lines on: %s\n&quot;</span>, dest);</div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;      *cause = <a class="code" href="../../d4/da3/causes_8h.html#a0a35518d7b448a53da368cf57f354fba">AST_CAUSE_CONGESTION</a>;</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;   }</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;   d = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>;</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;   sub_ring = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>);</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;   sub_trans = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a>(d, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>);</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;   <span class="comment">/* Another request already in progress */</span></div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;   <span class="keywordflow">if</span> (!d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;      *cause = <a class="code" href="../../d4/da3/causes_8h.html#a0a35518d7b448a53da368cf57f354fba">AST_CAUSE_CONGESTION</a>;</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;   }</div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;   <span class="keywordflow">if</span> (sub_ring || sub_trans) {</div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Can&#39;t create channel, request already in progress: Busy!\n&quot;</span>);</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;      }</div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;      *cause = <a class="code" href="../../d4/da3/causes_8h.html#ae009c193522491f7de7ea28b23f20868">AST_CAUSE_BUSY</a>;</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;   }</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a>) {</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Can&#39;t create channel, user on dialpage: Busy!\n&quot;</span>);</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;      }</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;      *cause = <a class="code" href="../../d4/da3/causes_8h.html#ae009c193522491f7de7ea28b23f20868">AST_CAUSE_BUSY</a>;</div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;   }</div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;</div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>) == -1) {</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Can&#39;t create channel for line %s, all lines busy\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;      }</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a>(d, sub);</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;      *cause = <a class="code" href="../../d4/da3/causes_8h.html#ae009c193522491f7de7ea28b23f20868">AST_CAUSE_BUSY</a>;</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;   }</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a>;</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;   sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a> = -1;</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;   tmpc = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a>(sub, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>, assignedids, requestor);</div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;   <span class="keywordflow">if</span> (!tmpc) {</div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to make channel for &#39;%s&#39;\n&quot;</span>, tmp);</div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;   }</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;unistim_request owner = %p\n&quot;</span>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;   }</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c">restart_monitor</a>();</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;   <span class="comment">/* and finish */</span></div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;   <span class="keywordflow">return</span> tmpc;</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;}</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;</div><div class="line"><a name="l06035"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a9ebdbdde6bd9f2fb35b6fcfef31a784d"> 6035</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ebdbdde6bd9f2fb35b6fcfef31a784d">unistim_show_info</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;{</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *device = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *line;</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cap_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;unistim show info&quot;</span>;</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;         <span class="stringliteral">&quot;Usage: unistim show info\n&quot;</span></div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;         <span class="stringliteral">&quot;       Dump internal structures.\n\n&quot;</span></div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;         <span class="stringliteral">&quot;       device\n&quot;</span></div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;         <span class="stringliteral">&quot;       -&gt;line\n&quot;</span></div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;         <span class="stringliteral">&quot;       --&gt;sub\n&quot;</span></div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;         <span class="stringliteral">&quot;       ==&gt;key\n&quot;</span>;</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* no completion */</span></div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;   }</div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6">args</a>) {</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;   }</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Dumping internal structures:\n&quot;</span>);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;   <span class="keywordflow">while</span> (device) {</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\nname=%s id=%s ha=%p sess=%p device=%p selected=%d height=%d\n&quot;</span>,</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;            device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>,</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;            device, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a>);</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>,line,list) {</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,</div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;               <span class="stringliteral">&quot;-&gt;name=%s fullname=%s exten=%s callid=%s cap=%s line=%p\n&quot;</span>,</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;               line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>, line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a78d4847658b695383d849efd12399b38">exten</a>, line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>,</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;               <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(line-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, &amp;cap_buf), line);</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;      }</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, list) {</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;         <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;         }</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;               <span class="stringliteral">&quot;--&gt;subtype=%s chan=%p rtp=%p line=%p alreadygone=%d softkey=%d\n&quot;</span>,</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aba890d62815801e923269e0bf18117d5">subtype_tostr</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a>), sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>,</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;               sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">alreadygone</a>, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">softkey</a>);</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;      }</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; i++) {</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a>(device, i)) {</div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;         }</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;==&gt; %d. dev=%s icon=%#-4x label=%-10s number=%-5s sub=%p line=%p\n&quot;</span>,</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;            i, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>[i], (<span class="keywordtype">unsigned</span>)device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i], device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[i], device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[i],</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;            device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>[i], device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[i]);</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;      }</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;      device = device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;   }</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\nSessions:\n&quot;</span>);</div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;   s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;   <span class="keywordflow">while</span> (s) {</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,</div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;            <span class="stringliteral">&quot;sin=%s timeout=%d state=%s macaddr=%s device=%p session=%p\n&quot;</span>,</div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;            <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr), s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">state</a>), s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">macaddr</a>,</div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;            s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>, s);</div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;      s = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;   }</div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;}</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;</div><div class="line"><a name="l06117"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a30564a003a7c639fbd349f7895382c5c"> 6117</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a30564a003a7c639fbd349f7895382c5c">unistim_show_devices</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;{</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *device = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;unistim show devices&quot;</span>;</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;         <span class="stringliteral">&quot;Usage: unistim show devices\n&quot;</span></div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;         <span class="stringliteral">&quot;       Lists all known Unistim devices.\n&quot;</span>;</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* no completion */</span></div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;   }</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6">args</a>)</div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%-20.20s %-20.20s %-15.15s %-15.15s %s\n&quot;</span>, <span class="stringliteral">&quot;Name/username&quot;</span>, <span class="stringliteral">&quot;MAC&quot;</span>, <span class="stringliteral">&quot;Host&quot;</span>, <span class="stringliteral">&quot;Firmware&quot;</span>, <span class="stringliteral">&quot;Status&quot;</span>);</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;   <span class="keywordflow">while</span> (device) {</div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%-20.20s %-20.20s %-15.15s %-15.15s %s\n&quot;</span>,</div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;         device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>,</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;         (!device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) ? <span class="stringliteral">&quot;(Unspecified)&quot;</span> : <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr),</div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;         (!device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) ? <span class="stringliteral">&quot;(Unspecified)&quot;</span> : device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#a9ccf05acd1a39a2adc192e7453f69176">firmware</a>,</div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;         (!device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) ? <span class="stringliteral">&quot;UNKNOWN&quot;</span> : <span class="stringliteral">&quot;OK&quot;</span>);</div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;      device = device-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;   }</div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;</div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;}</div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;</div><div class="line"><a name="l06150"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ac9110f159ddaa6bb7217e2a353e5d7bd"> 6150</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9110f159ddaa6bb7217e2a353e5d7bd">unistim_sp</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;{</div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a>;</div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;   <span class="keywordtype">int</span> i, j = 0, <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, cc;</div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[256];</div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;</div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;unistim send packet&quot;</span>;</div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;         <span class="stringliteral">&quot;Usage: unistim send packet USTM/line@name hexa\n&quot;</span></div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;         <span class="stringliteral">&quot;       unistim send packet USTM/1000@hans 19040004\n&quot;</span>;</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;</div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* no completion */</span></div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;   }</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 5) {</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;   }</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;   <span class="keywordflow">if</span> (strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]) &lt; 9) {</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;   }</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;   <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4]);</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> % 2) {</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;   }</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3] + 5, <span class="keyword">sizeof</span>(tmp));</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;   sub = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0fdd8e9ba003ce056acde0f1d4d8fef4">find_subchannel_by_name</a>(tmp);</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Can&#39;t find &#39;%s&#39;\n&quot;</span>, tmp);</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;   }</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;&#39;%s&#39; is not connected\n&quot;</span>, tmp);</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;   }</div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Sending &#39;%s&#39; to %s (%p)\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], tmp, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>);</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++) {</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;      c = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4][i];</div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;      <span class="keywordflow">if</span> (c &gt;= <span class="charliteral">&#39;a&#39;</span>) {</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;         c -= <span class="charliteral">&#39;a&#39;</span> - 10;</div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;         c -= <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;      }</div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;      i++;</div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;      cc = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4][i];</div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;      <span class="keywordflow">if</span> (cc &gt;= <span class="charliteral">&#39;a&#39;</span>) {</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;         cc -= <span class="charliteral">&#39;a&#39;</span> - 10;</div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;         cc -= <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;      }</div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;      tmp[j++] = (c &lt;&lt; 4) | cc;</div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;   }</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;   memcpy(buffsend + <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a>, tmp, j);</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a> + j, buffsend, sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">parent</a>-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>);</div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;}</div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;</div><div class="line"><a name="l06212"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a69071ab84db291a5902bafa8ecd14c21"> 6212</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69071ab84db291a5902bafa8ecd14c21">unistim_do_debug</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;{</div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;unistim set debug {on|off}&quot;</span>;</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;         <span class="stringliteral">&quot;Usage: unistim set debug\n&quot;</span></div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;         <span class="stringliteral">&quot;       Display debug messages.\n&quot;</span>;</div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;</div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* no completion */</span></div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;   }</div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;</div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6">args</a>) {</div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;   }</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;on&quot;</span>)) {</div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a> = 1;</div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;UNISTIM Debugging Enabled\n&quot;</span>);</div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;off&quot;</span>)) {</div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a> = 0;</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;UNISTIM Debugging Disabled\n&quot;</span>);</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;   }</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;}</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;<span class="comment">/*! \brief --- unistim_reload: Force reload of module from cli ---</span></div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;<span class="comment"> * Runs in the asterisk main thread, so don&#39;t do anything useful</span></div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;<span class="comment"> * but setting a flag and waiting for do_monitor to do the job</span></div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;<span class="comment"> * in our thread */</span></div><div class="line"><a name="l06245"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a96847821359361addde051ee7c098b38"> 6245</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96847821359361addde051ee7c098b38">unistim_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;{</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;unistim reload&quot;</span>;</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;         <span class="stringliteral">&quot;Usage: unistim reload\n&quot;</span></div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;         <span class="stringliteral">&quot;       Reloads UNISTIM configuration from unistim.conf\n&quot;</span>;</div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;</div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* no completion */</span></div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;   }</div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;</div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;   <span class="keywordflow">if</span> (e &amp;&amp; a &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6">args</a>) {</div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;   }</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a>();</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;</div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;}</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;</div><div class="line"><a name="l06267"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a43be34b406b2eb1b302d6007ccbc8380"> 6267</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a43be34b406b2eb1b302d6007ccbc8380">unistim_cli</a>[] = {</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a96847821359361addde051ee7c098b38">unistim_reload</a>, <span class="stringliteral">&quot;Reload UNISTIM configuration&quot;</span>),</div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9ebdbdde6bd9f2fb35b6fcfef31a784d">unistim_show_info</a>, <span class="stringliteral">&quot;Show UNISTIM info&quot;</span>),</div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a30564a003a7c639fbd349f7895382c5c">unistim_show_devices</a>, <span class="stringliteral">&quot;Show UNISTIM devices&quot;</span>),</div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9110f159ddaa6bb7217e2a353e5d7bd">unistim_sp</a>, <span class="stringliteral">&quot;Send packet (for reverse engineering)&quot;</span>),</div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a69071ab84db291a5902bafa8ecd14c21">unistim_do_debug</a>, <span class="stringliteral">&quot;Toggle UNITSTIM debugging&quot;</span>),</div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;};</div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;</div><div class="line"><a name="l06275"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d"> 6275</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(<span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">int</span> maxlen)</div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;{</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(src);</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;   <span class="keywordflow">if</span> (!len) {</div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;   }</div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;   <span class="keywordflow">if</span> ((len &gt; 1) &amp;&amp; src[0] == <span class="charliteral">&#39;\&quot;&#39;</span>) {</div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;      <span class="comment">/* This is a quoted string */</span></div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;      src++;</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;      <span class="comment">/* Don&#39;t take more than what&#39;s there */</span></div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;      len--;</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;      <span class="keywordflow">if</span> (maxlen &gt; len - 1) {</div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;         maxlen = len - 1;</div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;      }</div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;      memcpy(out, src, maxlen);</div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;      ((<span class="keywordtype">char</span> *) out)[maxlen] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;      memcpy(out, src, maxlen);</div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;   }</div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;}</div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;</div><div class="line"><a name="l06297"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad0e16ee388b0afd41516a4ff34258059"> 6297</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad0e16ee388b0afd41516a4ff34258059">parse_bookmark</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>)</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;{</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;   <span class="keywordtype">char</span> line[256];</div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;   <span class="keywordtype">char</span> *at;</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d6/d49/structnumber.html">number</a>;</div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;   <span class="keywordtype">char</span> *icon;</div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;   <span class="keywordtype">int</span> p;</div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(text);</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;</div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(line, text, <span class="keyword">sizeof</span>(line));</div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;   <span class="comment">/* Position specified ? */</span></div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;   <span class="keywordflow">if</span> ((len &gt; 2) &amp;&amp; (line[1] == <span class="charliteral">&#39;@&#39;</span>)) {</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;      p = line[0];</div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;      <span class="keywordflow">if</span> ((p &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (p &lt;= <span class="charliteral">&#39;5&#39;</span>)) {</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;         p -= <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;               <span class="stringliteral">&quot;Invalid position for bookmark : must be between 0 and 5\n&quot;</span>);</div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      }</div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;      <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p] != 0) {</div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid position %d for bookmark : already used:\n&quot;</span>, p);</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;      }</div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      memmove(line, line + 2, <span class="keyword">sizeof</span>(line) - 2);</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;      <span class="comment">/* No position specified, looking for a free slot */</span></div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;      <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a>; p++) {</div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;         <span class="keywordflow">if</span> (!d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p]) {</div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;         }</div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;      }</div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;      <span class="keywordflow">if</span> (p == FAVNUM) {</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No more free bookmark position\n&quot;</span>);</div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;      }</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;   }</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;   at = strchr(line, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;   <span class="keywordflow">if</span> (!at) {</div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bookmark entry &#39;%s&#39; has no @ (at) sign!\n&quot;</span>, text);</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;   }</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;   *at = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;   at++;</div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;   number = at;</div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;   at = strchr(at, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(number)) {</div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bookmark entry &#39;%s&#39; has no number\n&quot;</span>, text);</div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;   }</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(line)) {</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bookmark entry &#39;%s&#39; has no description\n&quot;</span>, text);</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;   }</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;   at = strchr(number, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;   <span class="keywordflow">if</span> (!at) {</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3a4ac2b1b9cd94f383cdbe01da74acbc">FAV_ICON_SHARP</a>;     <span class="comment">/* default icon */</span></div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;      *at = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;      at++;</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;      icon = at;</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(icon)) {</div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bookmark entry &#39;%s&#39; has no icon value\n&quot;</span>, text);</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;      }</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;      <span class="keywordflow">if</span> (strncmp(icon, <span class="stringliteral">&quot;USTM/&quot;</span>, 5)) {</div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p] = atoi(icon);</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p] = 1;</div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>[p], icon + 5, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>[p]));</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;      }</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;   }</div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[p], line, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[p]));</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[p], number, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[p]));</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;New bookmark at pos %d label=&#39;%s&#39; number=&#39;%s&#39; icon=%#x\n&quot;</span>,</div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;               p, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[p], d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>[p], (<span class="keywordtype">unsigned</span>)d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[p]);</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;   }</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;}</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;<span class="comment">/* Looking for dynamic icons entries in bookmarks */</span></div><div class="line"><a name="l06380"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#aa8b299f82f6bd3e2ed26d27b933c850f"> 6380</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8b299f82f6bd3e2ed26d27b933c850f">finish_bookmark</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;{</div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i] == 1) {   <span class="comment">/* Something for us */</span></div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *d2 = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;            <span class="keywordflow">while</span> (d2) {</div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;               <span class="keywordflow">if</span> (!strcmp(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>[i], d2-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>)) {</div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>[i] = d2;</div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[i] = 0;</div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;               }</div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;               d2 = d2-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;            }</div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;            <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>[i] == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Bookmark entry with device %s not found\n&quot;</span>,</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;                     d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>[i]);</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;            }</div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;         }</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;      }</div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;   }</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;}</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;</div><div class="line"><a name="l06408"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a3f60196e91f7079534a0d85a5c98fbc4"> 6408</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f60196e91f7079534a0d85a5c98fbc4">find_line_by_number</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d85/structval.html">val</a>) {</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l, *ret = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>) {</div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;      <span class="keywordflow">if</span> (!strcmp(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, val)) {</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;         ret = l;</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;      }</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;   }</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;}</div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;</div><div class="line"><a name="l06422"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a51d886f21273033c5d95f4c56da83a99"> 6422</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a51d886f21273033c5d95f4c56da83a99">delete_device</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>)</div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;{</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l;</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;Removing device &#39;%s&#39;\n&quot;</span>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;   }</div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>, sub, list){</div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a>) {</div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;         <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                  <span class="stringliteral">&quot;Device &#39;%s&#39; was not deleted : a call is in progress. Try again later.\n&quot;</span>,</div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;         }</div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;      }</div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;      <span class="keywordflow">if</span> (sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">subtype</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a>) {</div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;               <span class="stringliteral">&quot;Device &#39;%s&#39; with threeway call subchannels allocated, aborting.\n&quot;</span>,</div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;               d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;      }</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub);</div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;   }</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">subs</a>);</div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;</div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;</div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, list){</div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4816b578cc4c9c34f35f5e0d216acb">unistim_line_destroy</a>(l);</div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;   }</div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/d0a/structsessions.html">sessions</a> == d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;         <a class="code" href="../../d3/d0a/structsessions.html">sessions</a> = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;         s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;         <span class="keywordflow">while</span> (s) {</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;            <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a> == d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>) {</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;               s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a> = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;            }</div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;            s = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;         }</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;      }</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">session</a>);</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;   }</div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d5e/structdevices.html">devices</a> == d) {</div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;      <a class="code" href="../../dd/d5e/structdevices.html">devices</a> = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *d2 = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;      <span class="keywordflow">while</span> (d2) {</div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;         <span class="keywordflow">if</span> (d2-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a> == d) {</div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;            d2-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a> = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;         }</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;         d2 = d2-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;      }</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;   }</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>) {</div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a> = <a class="code" href="../../d2/d0f/indications_8h.html#ae4e735983064b7fe22ffc0fc046d700e">ast_tone_zone_unref</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>);</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;   }</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d);</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;}</div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;</div><div class="line"><a name="l06501"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a022c8b359343442c50dc1961abb09364"> 6501</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a022c8b359343442c50dc1961abb09364">build_device</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *cat, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v)</div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;{</div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dbf/structunistim__line.html">unistim_line</a> *l = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *lt = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;   <span class="keywordtype">int</span> create = 1;</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;   <span class="keywordtype">int</span> nbsoftkey, <a class="code" href="../../d1/d22/logger_8c.html#a2057dec53731af6bb6881015b58936ba">dateformat</a>, timeformat, callhistory, sharpdial, linecnt;</div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;   <span class="keywordtype">char</span> linelabel[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];</div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;   <span class="keywordtype">signed</span> <span class="keywordtype">char</span> ringvolume, ringstyle, cwvolume, cwstyle;</div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;   <span class="comment">/* First, we need to know if we already have this name in our list */</span></div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;   <span class="comment">/* Get a lock for the device chained list */</span></div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;   d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;      <span class="keywordflow">if</span> (!strcmp(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, cat)) {</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;         <span class="comment">/* Yep, we alreay have this one */</span></div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> &lt; 0) {</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;            <span class="comment">/* It&#39;s a dupe */</span></div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Duplicate entry found (%s), ignoring.\n&quot;</span>, cat);</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;         }</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;         <span class="comment">/* we&#39;re reloading right now */</span></div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;         create = 0;</div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;      }</div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;   }</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;   <span class="keywordflow">if</span> (!(lt = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*lt)))) {</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;   }</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;   <span class="keywordflow">if</span> (create) {</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;      <span class="keywordflow">if</span> (!(d = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*d)))) {</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;      }</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, cat, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>));</div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a777f3eee179c21b6e4093e98b720bd8e">DEFAULTCONTEXT</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>));</div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> = -1;</div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">output</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>;</div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">previous_output</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a>;</div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">volume</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a29058a32cb27a6c7e8eec1a99dfb8ecc">VOLUME_LOW</a>;</div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">microphone</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a>;</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ae64dbc971c1418bf50d13f390b26c20c">DEFAULTHEIGHT</a>;</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = -1;</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">interdigit_timer</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0650a3e8232535ccd26d28b9957bc6c">DEFAULT_INTERDIGIT_TIMER</a>;</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;      <span class="comment">/* Delete existing line information */</span></div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>){</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>);</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#add4816b578cc4c9c34f35f5e0d216acb">unistim_line_destroy</a>(l);</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;      }</div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;</div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;      <span class="comment">/* reset bookmarks */</span></div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>));</div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">softkeynumber</a>));</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>));</div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">softkeydevice</a>));</div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">ssub</a>));</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>));</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;      memset(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>, 0, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">sp</a>));</div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;   }</div><div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;   linelabel[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;   dateformat = 1;</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;   timeformat = 1;</div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;   ringvolume = 2;</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;   cwvolume = 1;</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;   callhistory = 1;</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;   sharpdial = 0;</div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;   ringstyle = 3;</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;   cwstyle = 2;</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;   nbsoftkey = 0;</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;   linecnt = 0;</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> = 0;</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;   <span class="keywordflow">while</span> (v) {</div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;rtp_port&quot;</span>)) {</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">rtp_port</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;rtp_method&quot;</span>)) {</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">rtp_method</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;status_method&quot;</span>)) {</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a7ef42aa41fc6f1f39c513ceb034fe467">status_method</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;device&quot;</span>)) {</div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>));</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tn&quot;</span>)) {</div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>));</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;permit&quot;</span>) || !strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;deny&quot;</span>)) {</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;         <span class="keywordtype">int</span> acl_error = 0;</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a> = <a class="code" href="../../d5/d59/acl_8h.html#ae839a9c2465be4e9a560dda668a65b9b">ast_append_ha</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>, &amp;acl_error);</div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;         <span class="keywordflow">if</span> (acl_error) {</div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid ACL &#39;%s&#39; specified for device &#39;%s&#39; on line %d. Deleting device\n&quot;</span>,</div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;                  v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a51d886f21273033c5d95f4c56da83a99">delete_device</a>(d);</div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;         }</div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;context&quot;</span>)) {</div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">context</a>));</div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;maintext0&quot;</span>)) {</div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">maintext0</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">maintext0</a>) - 1);</div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;maintext1&quot;</span>)) {</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>) - 1);</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;maintext2&quot;</span>)) {</div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">maintext2</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">maintext2</a>) - 1);</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;titledefault&quot;</span>)) {</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>) - 1);</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dateformat&quot;</span>)) {</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;         dateformat = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;timeformat&quot;</span>)) {</div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;         timeformat = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;contrast&quot;</span>)) {</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;         <span class="keywordflow">if</span> ((d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> &lt; 0) || (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> &gt; 15)) {</div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;contrast must be beetween 0 and 15\n&quot;</span>);</div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> = 8;</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;         }</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;nat&quot;</span>)) {</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ada540a5f25f7302dc1a3d17ccfa59b10">nat</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;hasexp&quot;</span>)) {</div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad3af117a28948d46d18d787129016d7e">hasexp</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ringvolume&quot;</span>)) {</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;         ringvolume = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ringstyle&quot;</span>)) {</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;         ringstyle = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;cwvolume&quot;</span>)) {</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;         cwvolume = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;cwstyle&quot;</span>)) {</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;         cwstyle = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;callhistory&quot;</span>)) {</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;         callhistory = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sharpdial&quot;</span>)) {</div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;         sharpdial = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>) ? 1 : 0;</div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;interdigit_timer&quot;</span>)) {</div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">interdigit_timer</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;dtmf_duration&quot;</span>)) {</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> &gt; 150) {</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">dtmfduration</a> = 150;</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;         }</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;callerid&quot;</span>)) {</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;asreceived&quot;</span>)) {</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;            lt-&gt;cid_num[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(lt-&gt;cid_num, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(lt-&gt;cid_num));</div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;         }</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;language&quot;</span>)) {</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>));</div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;country&quot;</span>)) {</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">country</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">country</a>));</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;accountcode&quot;</span>)) {</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(lt-&gt;accountcode, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(lt-&gt;accountcode));</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;amaflags&quot;</span>)) {</div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;         <span class="keywordtype">int</span> y;</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;         y = <a class="code" href="../../d5/d7b/channel_8h.html#acd7d6e4cf3615bf47af84d2e3e47c302">ast_channel_string2amaflag</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;         <span class="keywordflow">if</span> (y &lt; 0) {</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid AMA flags: %s at line %d\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>,</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;                  v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;            lt-&gt;amaflags = y;</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;         }</div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;musiconhold&quot;</span>)) {</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(lt-&gt;musicclass, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(lt-&gt;musicclass));</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;callgroup&quot;</span>)) {</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;         lt-&gt;callgroup = <a class="code" href="../../d5/d7b/channel_8h.html#aee83e23058d0a4111fda1f506cbda107">ast_get_group</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;pickupgroup&quot;</span>)) {</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;         lt-&gt;pickupgroup = <a class="code" href="../../d5/d7b/channel_8h.html#aee83e23058d0a4111fda1f506cbda107">ast_get_group</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;mailbox&quot;</span>)) {</div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(lt-&gt;mailbox, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(lt-&gt;mailbox));</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;parkinglot&quot;</span>)) {</div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(lt-&gt;parkinglot, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(lt-&gt;parkinglot));</div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;linelabel&quot;</span>)) {</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a>(linelabel, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(linelabel) - 1);</div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;extension&quot;</span>)) {</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;none&quot;</span>)) {</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">EXTENSION_NONE</a>;</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;ask&quot;</span>)) {</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a>;</div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;line&quot;</span>)) {</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd">EXTENSION_LINE</a>;</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown extension option.\n&quot;</span>);</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;         }</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;bookmark&quot;</span>)) {</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;         <span class="keywordflow">if</span> (nbsoftkey &gt; 5) {</div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;                  <span class="stringliteral">&quot;More than 6 softkeys defined. Ignoring new entries.\n&quot;</span>);</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad0e16ee388b0afd41516a4ff34258059">parse_bookmark</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, d)) {</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;               nbsoftkey++;</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;            }</div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;         }</div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;line&quot;</span>)) {</div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(linelabel);</div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;         <span class="keywordtype">int</span> create_line = 0;</div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;</div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;         l = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a3f60196e91f7079534a0d85a5c98fbc4">find_line_by_number</a>(d, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;         <span class="keywordflow">if</span> (!l) { <span class="comment">/* If line still not exists */</span></div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;            <span class="keywordflow">if</span> (!(l = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#accecc036574242b46fa0ae6bee663712">unistim_line_alloc</a>())) {</div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d);</div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(lt);</div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;               <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;            }</div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;            lt-&gt;cap = l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>;</div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;            memcpy(l, lt, <span class="keyword">sizeof</span>(*l));</div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;            create_line = 1;</div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;         }</div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">to_delete</a> = 0;</div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;</div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;         <span class="comment">/* Set softkey info for new line*/</span></div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">sline</a>[nbsoftkey] = l;</div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[nbsoftkey] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>;</div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;         <span class="keywordflow">if</span> (!len) {       <span class="comment">/* label is undefined ? */</span></div><div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[nbsoftkey], v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[nbsoftkey]));</div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;            <span class="keywordtype">int</span> softkeylinepos = 0;</div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;            <span class="keywordflow">if</span> ((len &gt; 2) &amp;&amp; (linelabel[1] == <span class="charliteral">&#39;@&#39;</span>)) {</div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;               softkeylinepos = linelabel[0];</div><div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;               <span class="keywordflow">if</span> ((softkeylinepos &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (softkeylinepos &lt;= <span class="charliteral">&#39;5&#39;</span>)) {</div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;                  softkeylinepos -= <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;                  d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[nbsoftkey] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a>;</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;                        <span class="stringliteral">&quot;Invalid position for linelabel : must be between 0 and 5\n&quot;</span>);</div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;               }</div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[softkeylinepos], linelabel + 2,</div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;                           <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[softkeylinepos]));</div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;               d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">softkeyicon</a>[softkeylinepos] = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a>;</div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[nbsoftkey], linelabel,</div><div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;                           <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">softkeylabel</a>[nbsoftkey]));</div><div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;            }</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;         }</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;         nbsoftkey++;</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;</div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;         <span class="keywordflow">if</span> (create_line) {</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>));</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;            snprintf(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>, <span class="keyword">sizeof</span>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">fullname</a>), <span class="stringliteral">&quot;USTM/%s@%s&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>)) {</div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Setting mailbox &#39;%s&#39; on %s@%s\n&quot;</span>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;               }</div><div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;            }</div><div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;            <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, global_cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;            l-&gt;<a class="code" href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">parent</a> = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;            linecnt++;</div><div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>, l, <a class="code" href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">list</a>);</div><div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">lines</a>);</div><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;         }</div><div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;height&quot;</span>)) {</div><div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;         <span class="comment">/* Allow the user to lower the expected display lines on the phone</span></div><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;<span class="comment">          * For example the Nortel i2001 and i2002 only have one ! */</span></div><div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">height</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Don&#39;t know keyword &#39;%s&#39; at line %d\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,</div><div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;               v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;      v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>;</div><div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;   }</div><div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(lt);</div><div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;   <span class="keywordflow">if</span> (linecnt == 0) {</div><div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;An Unistim device must have at least one line!\n&quot;</span>);</div><div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d);</div><div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;   }</div><div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a3c8138b16b5ca041bbbdc88e8316cba8">ringvolume</a> = ringvolume;</div><div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aebc7c191314640b1006cd0f461a819fe">ringstyle</a> = ringstyle;</div><div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a5292df700ff59a61858e21147a5fc7b6">cwvolume</a> = cwvolume;</div><div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aab68eaa12f597d4212c56694bb4ee020">cwstyle</a> = cwstyle;</div><div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">callhistory</a> = callhistory;</div><div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a89ee76cd9909e38095ff9c5acf4df9db">sharp_dial</a> = sharpdial;</div><div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a> = <a class="code" href="../../d2/d0f/indications_8h.html#a52513ad3507d90dc2baf7cfec7b201a7">ast_get_indication_zone</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">country</a>);</div><div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;   <span class="keywordflow">if</span> ((d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">country</a>)) {</div><div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Country &#39;%s&#39; was not found in indications.conf\n&quot;</span>,</div><div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">country</a>);</div><div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;   }</div><div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">datetimeformat</a> = 48 + (dateformat * 4);</div><div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;   d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">datetimeformat</a> += timeformat;</div><div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> == <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a>) &amp;&amp;</div><div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;      (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>))) {</div><div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">extension</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a>;</div><div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>)) {</div><div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;               <span class="stringliteral">&quot;tn= and device= can&#39;t be used together. Ignoring device= entry\n&quot;</span>);</div><div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;      }</div><div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>[0] = <span class="charliteral">&#39;T&#39;</span>;       <span class="comment">/* magic : this is a tn entry */</span></div><div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>((d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>) + 1, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>, <span class="keyword">sizeof</span>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>) - 1);</div><div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">extension_number</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>)) {</div><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;      <span class="keywordflow">if</span> (strcmp(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>, <span class="stringliteral">&quot;template&quot;</span>)) {</div><div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;You must specify the mac address with device=\n&quot;</span>);</div><div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>) {</div><div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;            d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a> = <a class="code" href="../../d2/d0f/indications_8h.html#ae4e735983064b7fe22ffc0fc046d700e">ast_tone_zone_unref</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">tz</a>);</div><div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;         }</div><div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d);</div><div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;         strcpy(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">id</a>, <span class="stringliteral">&quot;000000000000&quot;</span>);</div><div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;      }</div><div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;   }</div><div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;   <span class="keywordflow">if</span> (!d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">rtp_port</a>) {</div><div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">rtp_port</a> = 10000;</div><div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;   }</div><div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;   <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> == -1) {</div><div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">contrast</a> = 8;</div><div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;   }</div><div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>)) {</div><div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;      strcpy(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">maintext1</a>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;   }</div><div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>)) {</div><div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> tm = { 0, };</div><div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;      <span class="keyword">struct </span>timeval cur_time = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;</div><div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;cur_time, &amp;tm, 0)) == 0 || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>)) {</div><div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error in ast_localtime()\n&quot;</span>);</div><div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, <span class="stringliteral">&quot;UNISTIM for*&quot;</span>, 12);</div><div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;         <span class="keywordflow">if</span> (strlen(tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>) &lt; 4) {</div><div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;            strcpy(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, <span class="stringliteral">&quot;TimeZone &quot;</span>);</div><div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;            strcat(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>);</div><div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strlen(tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>) &lt; 9) {</div><div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;            strcpy(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, <span class="stringliteral">&quot;TZ &quot;</span>);</div><div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;            strcat(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>);</div><div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">titledefault</a>, tm.<a class="code" href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">tm_zone</a>, 12);</div><div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;         }</div><div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;      }</div><div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;   }</div><div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;   <span class="comment">/* Update the chained link if it&#39;s a new device */</span></div><div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;   <span class="keywordflow">if</span> (create) {</div><div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;      d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;      <a class="code" href="../../dd/d5e/structdevices.html">devices</a> = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Added device &#39;%s&#39;\n&quot;</span>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Device &#39;%s&#39; reloaded\n&quot;</span>, d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">name</a>);</div><div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;   }</div><div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;}</div><div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;</div><div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;<span class="comment">/*--- reload_config: Re-read unistim.conf config file ---*/</span></div><div class="line"><a name="l06846"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011"> 6846</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011">reload_config</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;{</div><div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d2b/structast__hostent.html">ast_hostent</a> ahp;</div><div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;   <span class="keyword">struct </span>hostent *<a class="code" href="../../d0/d80/chan__skinny_8c.html#aa0f575fa3882aa394cc287edba645a35">hp</a>;</div><div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;   <span class="keyword">struct </span>sockaddr_in bindaddr = { 0, };</div><div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = <span class="stringliteral">&quot;unistim.conf&quot;</span>;</div><div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;   <span class="keywordtype">char</span> *cat;</div><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d66/structunistim__device.html">unistim_device</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a>;</div><div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> reuseFlag = 1;</div><div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dc9/structunistimsession.html">unistimsession</a> *s;</div><div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { 0, };</div><div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;</div><div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;   cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(config, config_flags);</div><div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;   <span class="comment">/* We *must* have a config file otherwise stop immediately */</span></div><div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;   <span class="keywordflow">if</span> (!cfg) {</div><div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to load config %s\n&quot;</span>, config);</div><div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Config file %s is in an invalid format.  Aborting.\n&quot;</span>, config);</div><div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;   }</div><div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;</div><div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;   <span class="comment">/* Copy the default jb config over global_jbconf */</span></div><div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;   memcpy(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, &amp;default_jbconf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d7/dba/structast__jb__conf.html">ast_jb_conf</a>));</div><div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;</div><div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> = 120;</div><div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a> = 0;</div><div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;   v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>);</div><div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;   <span class="keywordflow">while</span> (v) {</div><div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;      <span class="comment">/* handle jb conf */</span></div><div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d14/abstract__jb_8h.html#ae50ad081bd2ae6b58bcfc4687916c586">ast_jb_read_conf</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>)) {</div><div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;      }</div><div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;keepalive&quot;</span>)) {</div><div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;port&quot;</span>)) {</div><div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a> = atoi(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tos&quot;</span>)) {</div><div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d59/acl_8h.html#a49d1eefe77636e2a63ad013afa0fc3b5">ast_str2tos</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.tos)) {</div><div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;                            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid tos value at line %d, refer to QoS documentation\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;         }</div><div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tos_audio&quot;</span>)) {</div><div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d59/acl_8h.html#a49d1eefe77636e2a63ad013afa0fc3b5">ast_str2tos</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.tos_audio)) {</div><div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;                            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid tos_audio value at line %d, refer to QoS documentation\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;         }</div><div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;cos&quot;</span>)) {</div><div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d59/acl_8h.html#ad364a9241e15fc0dbec0ffcb88f64671">ast_str2cos</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.cos)) {</div><div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;                            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid cos value at line %d, refer to QoS documentation\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;         }</div><div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;cos_audio&quot;</span>)) {</div><div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d59/acl_8h.html#ad364a9241e15fc0dbec0ffcb88f64671">ast_str2cos</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.cos_audio)) {</div><div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;                            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid cos_audio value at line %d, refer to QoS documentation\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;         }</div><div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;debug&quot;</span>)) {</div><div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;no&quot;</span>)) {</div><div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a> = 0;</div><div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a> = 1;</div><div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;         }</div><div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;autoprovisioning&quot;</span>)) {</div><div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;no&quot;</span>)) {</div><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">AUTOPROVISIONING_NO</a>;</div><div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12">AUTOPROVISIONING_YES</a>;</div><div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;tn&quot;</span>)) {</div><div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a>;</div><div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown autoprovisioning option.\n&quot;</span>);</div><div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;         }</div><div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;public_ip&quot;</span>)) {</div><div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>)) {</div><div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;            <span class="keywordflow">if</span> (!(hp = <a class="code" href="../../d5/d60/utils_8h.html#ad3b63ee1041593219ef0765b28d70442">ast_gethostbyname</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;ahp))) {</div><div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid address: %s\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;               memcpy(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>.sin_addr, hp-&gt;h_addr, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>.sin_addr));</div><div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;               <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>.sin_family = AF_INET;</div><div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;            }</div><div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;         }</div><div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;      }</div><div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;      v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>;</div><div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;   }</div><div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> &lt; 10) ||</div><div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;      (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> &gt;</div><div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;       255 - (((<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab4f7f5bd236a41e188c6b46e9b1d535">NB_MAX_RETRANSMIT</a> + 1) * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a>) / 1000))) {</div><div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;keepalive is invalid in %s\n&quot;</span>, config);</div><div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;   }</div><div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a>[4] =</div><div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> + (((<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab4f7f5bd236a41e188c6b46e9b1d535">NB_MAX_RETRANSMIT</a> + 1) * <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a>) / 1000);</div><div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a> &lt; 1) || (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a> &gt; 65535)) {</div><div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;port is not set or invalid in %s\n&quot;</span>, config);</div><div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;   }</div><div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a> *= 1000;</div><div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;</div><div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;   d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;      <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">to_delete</a> &gt;= 0) {</div><div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;         d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">to_delete</a> = 1;</div><div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;      }</div><div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;   }</div><div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;   <span class="comment">/* load the device sections */</span></div><div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;   cat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;   <span class="keywordflow">while</span> (cat) {</div><div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;      <span class="keywordflow">if</span> (strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>)) {</div><div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;         d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a022c8b359343442c50dc1961abb09364">build_device</a>(cat, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, cat));</div><div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;      }</div><div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;      cat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, cat);</div><div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;   }</div><div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;   d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;   <span class="keywordflow">while</span> (d) {</div><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;      <span class="keywordflow">if</span> (d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">to_delete</a>) {</div><div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a51d886f21273033c5d95f4c56da83a99">delete_device</a>(d);</div><div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;         d = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a>;</div><div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;      }</div><div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;      d = d-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">next</a>;</div><div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;   }</div><div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aa8b299f82f6bd3e2ed26d27b933c850f">finish_bookmark</a>();</div><div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a>);</div><div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;   s = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a>;</div><div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;   <span class="keywordflow">while</span> (s) {</div><div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>) {</div><div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;         <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a>(s);</div><div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)) {</div><div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d1/d7e/structunistim__languages.html">unistim_languages</a> lang;</div><div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;            lang = options_languages[<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a>(s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">device</a>-&gt;<a class="code" href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">language</a>)];</div><div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;            <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a>(s, lang.encoding);</div><div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;         }</div><div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;      }</div><div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;      s = s-&gt;<a class="code" href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">next</a>;</div><div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;   }</div><div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a>);</div><div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;   <span class="comment">/* We don&#39;t recreate a socket when reloading (locks would be necessary). */</span></div><div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> &gt; -1) {</div><div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;   }</div><div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;   bindaddr.sin_addr.s_addr = INADDR_ANY;</div><div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;   bindaddr.sin_port = htons(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a>);</div><div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;   bindaddr.sin_family = AF_INET;</div><div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> = socket(AF_INET, SOCK_DGRAM, 0);</div><div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> &lt; 0) {</div><div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create UNISTIM socket: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;   }</div><div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;<span class="preprocessor">#ifdef HAVE_PKTINFO</span></div><div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;   {</div><div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> pktinfoFlag = 1;</div><div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;      setsockopt(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, IPPROTO_IP, IP_PKTINFO, &amp;pktinfoFlag,</div><div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;               <span class="keyword">sizeof</span>(pktinfoFlag));</div><div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;   }</div><div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a>.sin_family == 0) {</div><div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;            <span class="stringliteral">&quot;Your OS does not support IP_PKTINFO, you must set public_ip.\n&quot;</span>);</div><div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> = -1;</div><div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;   }</div><div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;   setsockopt(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, SOL_SOCKET, SO_REUSEADDR, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) &amp;reuseFlag,</div><div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;            <span class="keyword">sizeof</span>(reuseFlag));</div><div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;   <span class="keywordflow">if</span> (bind(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, (<span class="keyword">struct</span> sockaddr *) &amp;bindaddr, <span class="keyword">sizeof</span>(bindaddr)) &lt; 0) {</div><div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to bind to %s:%d: %s\n&quot;</span>,</div><div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;            <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(bindaddr.sin_addr), htons(bindaddr.sin_port),</div><div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;            strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;      close(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>);</div><div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> = -1;</div><div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;UNISTIM Listening on %s:%d\n&quot;</span>, <a class="code" href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a>(bindaddr.sin_addr), htons(bindaddr.sin_port));</div><div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#a9e06776a6cd2ae9f2780a445053a6864">ast_set_qos</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.tos, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a>.cos, <span class="stringliteral">&quot;UNISTIM&quot;</span>);</div><div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;   }</div><div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;}</div><div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;</div><div class="line"><a name="l07030"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af45200c89ff7be35391af577dab9dbe4"> 7030</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054c">ast_rtp_glue_result</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af45200c89ff7be35391af577dab9dbe4">unistim_get_rtp_peer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> **instance)</div><div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;{</div><div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;</div><div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054ca6b70d26095905cd6bd5ddffc01d81843">AST_RTP_GLUE_RESULT_FORBID</a>;</div><div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;   }</div><div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054ca6b70d26095905cd6bd5ddffc01d81843">AST_RTP_GLUE_RESULT_FORBID</a>;</div><div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;   }</div><div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;</div><div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, +1);</div><div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;   *instance = sub-&gt;<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>;</div><div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;</div><div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054ca06df52d7b998aec9a879a1a53624c5e8">AST_RTP_GLUE_RESULT_LOCAL</a>;</div><div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;}</div><div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;</div><div class="line"><a name="l07047"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a7461823dcce8b29e21c0d33e5f0d7f8a"> 7047</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7461823dcce8b29e21c0d33e5f0d7f8a">unistim_set_rtp_peer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> *<a class="code" href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> *vrtp, <span class="keyword">struct</span> <a class="code" href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a> *trtp, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *<a class="code" href="../../d5/def/codec_8c.html#a26d06e92c695d54e16beb8070dc5461d">codecs</a>, <span class="keywordtype">int</span> nat_active)</div><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;{</div><div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;   <span class="keyword">struct </span>sockaddr_in them = { 0, };</div><div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;   <span class="keyword">struct </span>sockaddr_in us = { 0, };</div><div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;</div><div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;   <span class="keywordflow">if</span> (!rtp) {</div><div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;   }</div><div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;</div><div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;   sub = (<span class="keyword">struct </span><a class="code" href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a> *) <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No Private Structure, this is bad\n&quot;</span>);</div><div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;   }</div><div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;   {</div><div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> tmp;</div><div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;      <a class="code" href="../../d5/dde/rtp__engine_8h.html#a5665ad0c5abe3c26005c39d6a3680fa1">ast_rtp_instance_get_remote_address</a>(rtp, &amp;tmp);</div><div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a>(&amp;tmp, &amp;them);</div><div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;      <a class="code" href="../../d5/dde/rtp__engine_8h.html#a80baeff1bd121c3168ede2a955e9b3a2">ast_rtp_instance_get_local_address</a>(rtp, &amp;tmp);</div><div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a>(&amp;tmp, &amp;us);</div><div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;   }</div><div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;</div><div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;   <span class="comment">/* TODO: Set rtp on phone in case of direct rtp (not implemented) */</span></div><div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;</div><div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;}</div><div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;</div><div class="line"><a name="l07075"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#af47f9831ea4869f1785fcd8724552d68"> 7075</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/dc9/structast__rtp__glue.html">ast_rtp_glue</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af47f9831ea4869f1785fcd8724552d68">unistim_rtp_glue</a> = {</div><div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;   .<a class="code" href="../../d8/dc9/structast__rtp__glue.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">channel_type</a>,</div><div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;   .get_rtp_info = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af45200c89ff7be35391af577dab9dbe4">unistim_get_rtp_peer</a>,</div><div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;   .update_peer = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7461823dcce8b29e21c0d33e5f0d7f8a">unistim_set_rtp_peer</a>,</div><div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;};</div><div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;</div><div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;<span class="comment">/*--- load_module: PBX load module - initialization ---*/</span></div><div class="line"><a name="l07082"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a5655629994fdc7d0d29a850c209b96f2"> 7082</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5655629994fdc7d0d29a850c209b96f2">load_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;{</div><div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;</div><div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;   <span class="keywordflow">if</span> (!(global_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>))) {</div><div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;      <span class="keywordflow">goto</span> buff_failed;</div><div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;   }</div><div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;   <span class="keywordflow">if</span> (!(unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a> = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>))) {</div><div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;      <span class="keywordflow">goto</span> buff_failed;</div><div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;   }</div><div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;</div><div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(global_cap, <a class="code" href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a>, 0);</div><div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(global_cap, <a class="code" href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a>, 0);</div><div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a>(unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, global_cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>);</div><div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;</div><div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a72adc862c84ef019effe055d5f12d9c6">SIZE_PAGE</a>))) {</div><div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;      <span class="keywordflow">goto</span> buff_failed;</div><div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;   }</div><div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;</div><div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;   io = <a class="code" href="../../dc/dac/io_8h.html#a7d66d121ef63109c2f55188a38b8240f">io_context_create</a>();</div><div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;   <span class="keywordflow">if</span> (!io) {</div><div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to allocate IO context\n&quot;</span>);</div><div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;      <span class="keywordflow">goto</span> io_failed;</div><div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;   }</div><div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;</div><div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;   sched = <a class="code" href="../../d7/d00/sched_8h.html#a5baecc149aeabdbef9b3ed6780c1c4a6">ast_sched_context_create</a>();</div><div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;   <span class="keywordflow">if</span> (!sched) {</div><div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to allocate scheduler context\n&quot;</span>);</div><div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;      <span class="keywordflow">goto</span> sched_failed;</div><div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;   }</div><div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;</div><div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;   res = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011">reload_config</a>();</div><div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>, -1);</div><div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(global_cap, -1);</div><div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(sched);</div><div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;      <a class="code" href="../../dc/dac/io_8h.html#a5409251fbead35b5e59fe322e14446b9">io_context_destroy</a>(io);</div><div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;   }</div><div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;   <span class="comment">/* Make sure we can register our unistim channel type */</span></div><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#ab5f3776fda943e52820ceeee5835c1b4">ast_channel_register</a>(&amp;unistim_tech)) {</div><div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to register channel type &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">channel_type</a>);</div><div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;      <span class="keywordflow">goto</span> chanreg_failed;</div><div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;   }</div><div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;</div><div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#ac2fd3e9ee89436cbf6b2ac374bab711b">ast_rtp_glue_register</a>(&amp;unistim_rtp_glue);</div><div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;</div><div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(unistim_cli, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(unistim_cli));</div><div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;</div><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c">restart_monitor</a>();</div><div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;</div><div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;</div><div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;chanreg_failed:<span class="comment"></span></div><div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;<span class="comment">   /*! XXX \todo Leaking anything allocated by reload_config() ... */</span></div><div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;   <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(sched);</div><div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;   sched = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;sched_failed:</div><div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;   <a class="code" href="../../dc/dac/io_8h.html#a5409251fbead35b5e59fe322e14446b9">io_context_destroy</a>(io);</div><div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;   io = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;io_failed:</div><div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>);</div><div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;buff_failed:</div><div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(global_cap);</div><div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;   global_cap = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>);</div><div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;   unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;}</div><div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;</div><div class="line"><a name="l07153"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#ad09fa931f468002152a3cc2d5ce25eae"> 7153</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;{</div><div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;   <span class="comment">/* First, take us out of the channel loop */</span></div><div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;   <span class="keywordflow">if</span> (sched) {</div><div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a>(sched);</div><div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;   }</div><div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;</div><div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(unistim_cli, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(unistim_cli));</div><div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;</div><div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a53b708b7fc71dcbcd33acae0ad4d7ef8">ast_channel_unregister</a>(&amp;unistim_tech);</div><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(unistim_tech.<a class="code" href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">capabilities</a>);</div><div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;   <a class="code" href="../../d5/dde/rtp__engine_8h.html#afe951ef8ac0fe6aae0db42ce12bb3791">ast_rtp_glue_unregister</a>(&amp;unistim_rtp_glue);</div><div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;</div><div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);</div><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> &amp;&amp; (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a873a83eb8196323194aac2bea23d794e">AST_PTHREADT_STOP</a>) &amp;&amp; (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>)) {</div><div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;      pthread_cancel(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a>);</div><div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;      pthread_kill(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a>, SIGURG);</div><div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;      pthread_join(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;   }</div><div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a873a83eb8196323194aac2bea23d794e">AST_PTHREADT_STOP</a>;</div><div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a>);</div><div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;</div><div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>) {</div><div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a>);</div><div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;   }</div><div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a> &gt; -1) {</div><div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;      close(<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a>);</div><div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;   }</div><div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(global_cap, -1);</div><div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;</div><div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;}</div><div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;<span class="comment">/*! reload: Part of Asterisk module interface ---*/</span></div><div class="line"><a name="l07187"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23"> 7187</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;{</div><div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a>) {</div><div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(0, <span class="stringliteral">&quot;reload unistim\n&quot;</span>);</div><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;   }</div><div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a>);</div><div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a>) {</div><div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;      <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a> = 1;</div><div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;   }</div><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a>);</div><div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;</div><div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;   <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c">restart_monitor</a>();</div><div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;</div><div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;}</div><div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;</div><div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a>(<a class="code" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a>, <span class="stringliteral">&quot;UNISTIM Protocol (USTM)&quot;</span>,</div><div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;   .support_level = <a class="code" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a9f8870a5687abe3d9a6b0b3fbc89a800">AST_MODULE_SUPPORT_EXTENDED</a>,</div><div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;   .load = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a5655629994fdc7d0d29a850c209b96f2">load_module</a>,</div><div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;   .unload = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>,</div><div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;   .<a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a> = <a class="code" href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a>,</div><div class="line"><a name="l07208"></a><span class="lineno"><a class="line" href="../../d1/d6d/chan__unistim_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae"> 7208</a></span>&#160;);</div><div class="ttc" id="io_8h_html_a6f1abe730a5606b88c8f415f53b784bc"><div class="ttname"><a href="../../dc/dac/io_8h.html#a6f1abe730a5606b88c8f415f53b784bc">ast_io_wait</a></div><div class="ttdeci">int ast_io_wait(struct io_context *ioc, int howlong)</div><div class="ttdoc">Waits for IO. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/io_8c_source.html#l00278">io.c:278</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad8955045150b25a87aff07813dc383ae"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad8955045150b25a87aff07813dc383ae">rcv_mac_addr</a></div><div class="ttdeci">static void rcv_mac_addr(struct unistimsession *pte, const unsigned char *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02071">chan_unistim.c:2071</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8519293c1ec541f51ea03ef4602df2d3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8519293c1ec541f51ea03ef4602df2d3">packet_send_query_basic_manager_10</a></div><div class="ttdeci">static const unsigned char packet_send_query_basic_manager_10[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00698">chan_unistim.c:698</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aab0df6f9b19263e2a45ed03a8bef4a0d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aab0df6f9b19263e2a45ed03a8bef4a0d">channel_type</a></div><div class="ttdeci">static const char channel_type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00707">chan_unistim.c:707</a></div></div>
<div class="ttc" id="structast__tm_html_a15d27611abcf49f13cfa3784cdf999c3"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a15d27611abcf49f13cfa3784cdf999c3">ast_tm::tm_zone</a></div><div class="ttdeci">char * tm_zone</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00046">localtime.h:46</a></div></div>
<div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00293">include/asterisk/frame.h:293</a></div></div>
<div class="ttc" id="chan__skinny_8c_html_af19bea0fea4bb4d017667827fe7b4970"><div class="ttname"><a href="../../d0/d80/chan__skinny_8c.html#af19bea0fea4bb4d017667827fe7b4970">lines</a></div><div class="ttdeci">static struct lines lines</div></div>
<div class="ttc" id="structunistim__subchannel_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#adf04f66344e3fb0a6f6a69bf39d19902">unistim_subchannel::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00354">chan_unistim.c:354</a></div></div>
<div class="ttc" id="structunistim__device_html_ace5447dc144ab85050254f0d78d2fe94"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ace5447dc144ab85050254f0d78d2fe94">unistim_device::subs</a></div><div class="ttdeci">struct unistim_device::@152 subs</div></div>
<div class="ttc" id="chan__mgcp_8c_html_abc34958c9b03014779727e5ca61b93e5"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#abc34958c9b03014779727e5ca61b93e5">musicclass</a></div><div class="ttdeci">static char musicclass[MAX_MUSICCLASS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00162">chan_mgcp.c:162</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_adddfe4da28d79f8b17835e6fccb2796c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#adddfe4da28d79f8b17835e6fccb2796c">packet_send_select_output</a></div><div class="ttdeci">static const unsigned char packet_send_select_output[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00581">chan_unistim.c:581</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7933092404c611d3443bad7047ca895"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7933092404c611d3443bad7047ca895">packet_send_icon</a></div><div class="ttdeci">static const unsigned char packet_send_icon[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00644">chan_unistim.c:644</a></div></div>
<div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a9241175b397dfd032c4cadbc8c9c2d05">unistim_subchannel::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00356">chan_unistim.c:356</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a510246db3c41f725688d963b88609ffd">EXTENSION_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00134">chan_unistim.c:134</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a80602101a30208245e3c967e23960247"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a80602101a30208245e3c967e23960247">SELECTEXTENSION_START_ENTRY_POS</a></div><div class="ttdeci">#define SELECTEXTENSION_START_ENTRY_POS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03873">chan_unistim.c:3873</a></div></div>
<div class="ttc" id="structunistim__device_html_a82162415ab1c1e6d5ee85973d68b3655"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a82162415ab1c1e6d5ee85973d68b3655">unistim_device::call_forward</a></div><div class="ttdeci">char call_forward[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00438">chan_unistim.c:438</a></div></div>
<div class="ttc" id="channel_8h_html_a30bcf0418189567bc84ff32034f79f28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a30bcf0418189567bc84ff32034f79f28">ast_queue_hangup</a></div><div class="ttdeci">int ast_queue_hangup(struct ast_channel *chan)</div><div class="ttdoc">Queue a hangup frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01150">channel.c:1150</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a67b115665a4da0af45e82c9643c14f22"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a67b115665a4da0af45e82c9643c14f22">send_expansion_text</a></div><div class="ttdeci">static void send_expansion_text(unsigned char pos, struct unistimsession *pte, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01180">chan_unistim.c:1180</a></div></div>
<div class="ttc" id="channel_8h_html_a641d81d0c5c8df99d43eff69aede3bfd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a641d81d0c5c8df99d43eff69aede3bfd">ast_group_t</a></div><div class="ttdeci">unsigned long long ast_group_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00214">channel.h:214</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acf524fdb0c0819aeab7687d494921d8d">KEY_FAV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00324">chan_unistim.c:324</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2935cf6fc27803112f358fd6da9d13ae"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2935cf6fc27803112f358fd6da9d13ae">TIMER_MWI</a></div><div class="ttdeci">#define TIMER_MWI</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00105">chan_unistim.c:105</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2040931156dab409503688b41fe3ae4c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2040931156dab409503688b41fe3ae4c">handle_select_codec</a></div><div class="ttdeci">static void handle_select_codec(struct unistimsession *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03732">chan_unistim.c:3732</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae63227951567ea5e070447041e3a7af7"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae63227951567ea5e070447041e3a7af7">soft_key_visible</a></div><div class="ttdeci">static int soft_key_visible(struct unistim_device *d, unsigned char num)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01313">chan_unistim.c:1313</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810">phone_key</a></div><div class="ttdeci">phone_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00295">chan_unistim.c:295</a></div></div>
<div class="ttc" id="indications_8h_html"><div class="ttname"><a href="../../d2/d0f/indications_8h.html">indications.h</a></div><div class="ttdoc">Tone Indication Support. </div></div>
<div class="ttc" id="chan__unistim_8c_html_a69071ab84db291a5902bafa8ecd14c21"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a69071ab84db291a5902bafa8ecd14c21">unistim_do_debug</a></div><div class="ttdeci">static char * unistim_do_debug(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06212">chan_unistim.c:6212</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a06f0ecb2b503952072e22a499a26a73e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a06f0ecb2b503952072e22a499a26a73e">unistim_port</a></div><div class="ttdeci">static int unistim_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00244">chan_unistim.c:244</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_adfee50d07a98645d4d20b896ce03785a"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#adfee50d07a98645d4d20b896ce03785a">accountcode</a></div><div class="ttdeci">static char accountcode[AST_MAX_ACCOUNT_CODE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00428">chan_iax2.c:428</a></div></div>
<div class="ttc" id="channel_8h_html_ae9542942f37422e284dd5c8a3fa7c7b6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae9542942f37422e284dd5c8a3fa7c7b6">ast_channel_pickupgroup_set</a></div><div class="ttdeci">void ast_channel_pickupgroup_set(struct ast_channel *chan, ast_group_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01086">channel_internal_api.c:1086</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a835f0d932ba876dac6b1aade1c981e2e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a835f0d932ba876dac6b1aade1c981e2e">write_history</a></div><div class="ttdeci">static int write_history(struct unistimsession *pte, char way, char ismissed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02281">chan_unistim.c:2281</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa33cce292eae51d6fbf9d60285cb396a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa33cce292eae51d6fbf9d60285cb396a">packet_send_S1</a></div><div class="ttdeci">static const unsigned char packet_send_S1[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00699">chan_unistim.c:699</a></div></div>
<div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="pbx_8h_html_ac359af75b9494f50904583d2168a7577"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ac359af75b9494f50904583d2168a7577">ast_matchmore_extension</a></div><div class="ttdeci">int ast_matchmore_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Looks to see if adding anything to this extension might match something. (exists ^ canmatch) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04199">pbx.c:4199</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00036">format.h:36</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0781b09a40e165ce5f3716ff501f6f6a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0781b09a40e165ce5f3716ff501f6f6a">sessions</a></div><div class="ttdeci">static struct unistimsession * sessions</div></div>
<div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="structunistim__device_html_a6c6fcff68d6d8a436e52431790e22eed"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a6c6fcff68d6d8a436e52431790e22eed">unistim_device::sp</a></div><div class="ttdeci">struct unistim_device * sp[FAVNUM]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00411">chan_unistim.c:411</a></div></div>
<div class="ttc" id="structunistimsession_html_a9fe0531834aba09c8681ed0763143207"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a9fe0531834aba09c8681ed0763143207">unistimsession::sout</a></div><div class="ttdeci">struct sockaddr_in sout</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00461">chan_unistim.c:461</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adaa85e413624f491e48ca6e8e3217b1ff0">STATE_MAINPAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00278">chan_unistim.c:278</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a53dbe001ee80d35548add7dfa57b58f9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a53dbe001ee80d35548add7dfa57b58f9">FAV_ICON_SPEAKER_ONHOOK_WHITE</a></div><div class="ttdeci">#define FAV_ICON_SPEAKER_ONHOOK_WHITE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00181">chan_unistim.c:181</a></div></div>
<div class="ttc" id="musiconhold_8h_html"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html">musiconhold.h</a></div><div class="ttdoc">Music on hold handling. </div></div>
<div class="ttc" id="chan__unistim_8c_html_a1254a12dd409acedd439a0c2d1330c6f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1254a12dd409acedd439a0c2d1330c6f">show_history</a></div><div class="ttdeci">static void show_history(struct unistimsession *pte, char way)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04086">chan_unistim.c:4086</a></div></div>
<div class="ttc" id="structunistimsession_html"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html">unistimsession</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00458">chan_unistim.c:458</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_add89efe611110e5f6d6fee7d45e1b5ca"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#add89efe611110e5f6d6fee7d45e1b5ca">send_expansion_next</a></div><div class="ttdeci">static void send_expansion_next(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01159">chan_unistim.c:1159</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="format__cache_8h_html_a771306b3301213eb2f0a409d3d0f42df"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a771306b3301213eb2f0a409d3d0f42df">ast_format_g723</a></div><div class="ttdeci">struct ast_format * ast_format_g723</div><div class="ttdoc">Built-in cached g723.1 format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00151">format_cache.c:151</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1b5e2f13354755c557df91b2353c0c85">STATE_HISTORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00287">chan_unistim.c:287</a></div></div>
<div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a08260233e4bcb7cc34a5e951db2d640f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a08260233e4bcb7cc34a5e951db2d640f">send_client</a></div><div class="ttdeci">static void send_client(int size, const unsigned char *data, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00959">chan_unistim.c:959</a></div></div>
<div class="ttc" id="structunistim__line_html_a057f9d94dcb6db27d7a1907abafc75bf"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a057f9d94dcb6db27d7a1907abafc75bf">unistim_line::list</a></div><div class="ttdeci">struct unistim_line::@151 list</div></div>
<div class="ttc" id="structunistim__subchannel_html"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html">unistim_subchannel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00353">chan_unistim.c:353</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a9140a4e4d781264fa9469c52b1adae40"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a></div><div class="ttdeci">#define AST_LIST_LOCK(head)</div><div class="ttdoc">Locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00039">linkedlists.h:39</a></div></div>
<div class="ttc" id="structast__channel__tech_html_a8ff938fb2f815be425fd2859a21e6d61"><div class="ttname"><a href="../../d4/d85/structast__channel__tech.html#a8ff938fb2f815be425fd2859a21e6d61">ast_channel_tech::type</a></div><div class="ttdeci">const char *const type</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00630">channel.h:630</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a612120b69c7dfd46086db7aaebdbcf65"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a612120b69c7dfd46086db7aaebdbcf65">KEY_LEFT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00311">chan_unistim.c:311</a></div></div>
<div class="ttc" id="structunistim__device_html_a45112f06dde60bac6d67e949448592b8"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a45112f06dde60bac6d67e949448592b8">unistim_device::softkeylabel</a></div><div class="ttdeci">char softkeylabel[FAVNUM][11]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00405">chan_unistim.c:405</a></div></div>
<div class="ttc" id="stasis__channels_8h_html"><div class="ttname"><a href="../../d9/d4a/stasis__channels_8h.html">stasis_channels.h</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="linkedlists_8h_html_adf1959c5c03a3a706da97ad2f49617e5"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a></div><div class="ttdeci">#define AST_LIST_FIRST(head)</div><div class="ttdoc">Returns the first entry contained in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00420">linkedlists.h:420</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad68c0963a805ff4107528fe6ebbc2b59"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad68c0963a805ff4107528fe6ebbc2b59">unistim_fixup</a></div><div class="ttdeci">static int unistim_fixup(struct ast_channel *oldchan, struct ast_channel *newchan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05254">chan_unistim.c:5254</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a70554da5ceeca4add783501b96f542be">KEY_FAV2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00325">chan_unistim.c:325</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4ea7ea5c6c34d6069e7863dc11e1841b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4ea7ea5c6c34d6069e7863dc11e1841b">unistim_rtp_read</a></div><div class="ttdeci">static struct ast_frame * unistim_rtp_read(const struct ast_channel *ast, const struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05149">chan_unistim.c:5149</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01121">bridge.h:1121</a></div></div>
<div class="ttc" id="bridge_8h_html_aec45146e91e4d8bc2a7d2cf083c4dac0"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aec45146e91e4d8bc2a7d2cf083c4dac0">ast_bridge_transfer_attended</a></div><div class="ttdeci">enum ast_transfer_result ast_bridge_transfer_attended(struct ast_channel *to_transferee, struct ast_channel *to_transfer_target)</div><div class="ttdoc">Attended transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04729">bridge.c:4729</a></div></div>
<div class="ttc" id="linkedlists_8h_html_acdb4f56da6b3071d02dcce20072852b0"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#acdb4f56da6b3071d02dcce20072852b0">AST_LIST_HEAD</a></div><div class="ttdeci">#define AST_LIST_HEAD(name, type)</div><div class="ttdoc">Defines a structure to be used to hold a list of specified type. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00172">linkedlists.h:172</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_ad9d12b10a3d0c3bca1d0b033bc139dab"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#ad9d12b10a3d0c3bca1d0b033bc139dab">ast_get_chan_features_pickup_config</a></div><div class="ttdeci">struct ast_features_pickup_config * ast_get_chan_features_pickup_config(struct ast_channel *chan)</div><div class="ttdoc">Get the pickup configuration options for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d71/features__config_8c_source.html#l01193">features_config.c:1193</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b31bfcc769a5b5c31e13aa6d8a9a286"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a></div><div class="ttdeci">static char parkinglot[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00163">chan_mgcp.c:163</a></div></div>
<div class="ttc" id="channel_8h_html_a60f9d2b0ab8b7a839902313321163b28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a60f9d2b0ab8b7a839902313321163b28">ast_queue_control</a></div><div class="ttdeci">int ast_queue_control(struct ast_channel *chan, enum ast_control_frame_type control)</div><div class="ttdoc">Queue a control frame without payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01231">channel.c:1231</a></div></div>
<div class="ttc" id="structast__rtp__glue_html"><div class="ttname"><a href="../../d8/dc9/structast__rtp__glue.html">ast_rtp_glue</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00720">rtp_engine.h:720</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af711361aad877718459a14da47d9f8f2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af711361aad877718459a14da47d9f8f2">packet_send_stream_based_tone_off</a></div><div class="ttdeci">static const unsigned char packet_send_stream_based_tone_off[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00567">chan_unistim.c:567</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_adfddefd9aad65eccfcb25444e02a0e73"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#adfddefd9aad65eccfcb25444e02a0e73">rcv_resume_connection_with_server</a></div><div class="ttdeci">static void rcv_resume_connection_with_server(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01907">chan_unistim.c:1907</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_accecc036574242b46fa0ae6bee663712"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#accecc036574242b46fa0ae6bee663712">unistim_line_alloc</a></div><div class="ttdeci">static struct unistim_line * unistim_line_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01965">chan_unistim.c:1965</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00036">channelstate.h:36</a></div></div>
<div class="ttc" id="structunistim__device_html"><div class="ttname"><a href="../../d1/d66/structunistim__device.html">unistim_device</a></div><div class="ttdoc">A device containing one or more lines. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00394">chan_unistim.c:394</a></div></div>
<div class="ttc" id="structunistim__device_html_aa44ad53f82acd50c13c946e1cdfcdefa"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aa44ad53f82acd50c13c946e1cdfcdefa">unistim_device::name</a></div><div class="ttdeci">char name[DEVICE_NAME_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00402">chan_unistim.c:402</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00286">include/asterisk/frame.h:286</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_afbd6fc6e0ab3c1a04a518f19c21d4503"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#afbd6fc6e0ab3c1a04a518f19c21d4503">monitor_thread</a></div><div class="ttdeci">static pthread_t monitor_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00265">chan_unistim.c:265</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_ab88c871dd5c164b7a0a6af5e7e12d16f"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#ab88c871dd5c164b7a0a6af5e7e12d16f">ast_rtp_instance_set_channel_id</a></div><div class="ttdeci">void ast_rtp_instance_set_channel_id(struct ast_rtp_instance *instance, const char *uniqueid)</div><div class="ttdoc">Set the channel that owns this RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00553">rtp_engine.c:553</a></div></div>
<div class="ttc" id="structunistimsession_html_a9ccf05acd1a39a2adc192e7453f69176"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a9ccf05acd1a39a2adc192e7453f69176">unistimsession::firmware</a></div><div class="ttdeci">char firmware[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00473">chan_unistim.c:473</a></div></div>
<div class="ttc" id="indications_8h_html_ae4e735983064b7fe22ffc0fc046d700e"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#ae4e735983064b7fe22ffc0fc046d700e">ast_tone_zone_unref</a></div><div class="ttdeci">static struct ast_tone_zone * ast_tone_zone_unref(struct ast_tone_zone *tz)</div><div class="ttdoc">Release a reference to an ast_tone_zone. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00205">indications.h:205</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810acc090e31a648354ef64e37dbe16b20c8">KEY_LOUDSPK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00322">chan_unistim.c:322</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a2fe7fe99bcb0fd90bf4234be9e4ce5be"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2fe7fe99bcb0fd90bf4234be9e4ce5be">KEY_6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00302">chan_unistim.c:302</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da1012d4d28efb5b6b06b0cd8ad9aee104">AUTOPROVISIONING_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00123">chan_unistim.c:123</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa567e5ddc50bdfd0734f66263e255374">KEY_FAV4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00327">chan_unistim.c:327</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_add4816b578cc4c9c34f35f5e0d216acb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#add4816b578cc4c9c34f35f5e0d216acb">unistim_line_destroy</a></div><div class="ttdeci">static struct unistim_line * unistim_line_destroy(struct unistim_line *l)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01955">chan_unistim.c:1955</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acc157ecef0d132529d0e7429aa48d18f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acc157ecef0d132529d0e7429aa48d18f">TEXT_LINE2</a></div><div class="ttdeci">#define TEXT_LINE2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00172">chan_unistim.c:172</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8f0bdf522fe97f4a4196207da4c5e9d1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8f0bdf522fe97f4a4196207da4c5e9d1">send_favorite_selected</a></div><div class="ttdeci">static void send_favorite_selected(unsigned char status, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01299">chan_unistim.c:1299</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada98d2a2153b4ae0445fa0b114d65b94d9">STATE_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00276">chan_unistim.c:276</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a326ac5a010e5287349fb860ac6accc1b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a326ac5a010e5287349fb860ac6accc1b">packet_recv_it_type</a></div><div class="ttdeci">static const unsigned char packet_recv_it_type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00513">chan_unistim.c:513</a></div></div>
<div class="ttc" id="channel_8h_html_aa62371d642974c67a0c0efa77d54fcbda54130226ec87f80c48ee98aa5cc9168c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa62371d642974c67a0c0efa77d54fcbda54130226ec87f80c48ee98aa5cc9168c">AST_CHAN_TP_WANTSJITTER</a></div><div class="ttdoc">Channels have this property if they can accept input with jitter; i.e. most VoIP channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00961">channel.h:961</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2c2b35e63a93d06b439b6179f0d9742e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2c2b35e63a93d06b439b6179f0d9742e">send_dial_tone</a></div><div class="ttdeci">static void send_dial_tone(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02924">chan_unistim.c:2924</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_adcb4a92a7c8fd3bcde19ecc417a3e8a3"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#adcb4a92a7c8fd3bcde19ecc417a3e8a3">ast_rtp_instance_change_source</a></div><div class="ttdeci">void ast_rtp_instance_change_source(struct ast_rtp_instance *instance)</div><div class="ttdoc">Indicate a new source of audio has dropped in and the ssrc should change. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02160">rtp_engine.c:2160</a></div></div>
<div class="ttc" id="callerid_8h_html"><div class="ttname"><a href="../../de/d47/callerid_8h.html">callerid.h</a></div><div class="ttdoc">CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr...</div></div>
<div class="ttc" id="channel_8h_html_afac6d7d115c1edfe3ad8a8c7fa5d59d1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afac6d7d115c1edfe3ad8a8c7fa5d59d1">ast_channel_set_writeformat</a></div><div class="ttdeci">void ast_channel_set_writeformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00840">channel_internal_api.c:840</a></div></div>
<div class="ttc" id="structval_html"><div class="ttname"><a href="../../d5/d85/structval.html">val</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dd1/ast__expr2_8c_source.html#l00325">ast_expr2.c:325</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a34ac3ccebc219c59daa7eb0275fcd54d"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a34ac3ccebc219c59daa7eb0275fcd54d">AST_CONTROL_RADIO_UNKEY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00290">include/asterisk/frame.h:290</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a15f14c79302d692960e5e683c0df12be"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a15f14c79302d692960e5e683c0df12be">unistim_new</a></div><div class="ttdeci">static struct ast_channel * unistim_new(struct unistim_subchannel *sub, int state, const struct ast_assigned_ids *assignedids, const struct ast_channel *requestor)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05704">chan_unistim.c:5704</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1ce5877cbb337d3424768845cab6800b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1ce5877cbb337d3424768845cab6800b">packet_send_date_time2</a></div><div class="ttdeci">static const unsigned char packet_send_date_time2[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00635">chan_unistim.c:635</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab7a1662ad66c828762decbf7beaebf01"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab7a1662ad66c828762decbf7beaebf01">FAV_ICON_ONHOLD_BLACK</a></div><div class="ttdeci">#define FAV_ICON_ONHOLD_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00184">chan_unistim.c:184</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a2333d7c312aa98622c41e74c5d13e8de"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a2333d7c312aa98622c41e74c5d13e8de">KEY_2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00298">chan_unistim.c:298</a></div></div>
<div class="ttc" id="structast__party__connected__line_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_party_connected_line::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdoc">Connected party ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00459">channel.h:459</a></div></div>
<div class="ttc" id="structast__silence__generator_html"><div class="ttname"><a href="../../d9/da1/structast__silence__generator.html">ast_silence_generator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08262">channel.c:8262</a></div></div>
<div class="ttc" id="structunistim__device_html_ae1869e7c6a5d9af9022043731b551f3b"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ae1869e7c6a5d9af9022043731b551f3b">unistim_device::lst_cnm</a></div><div class="ttdeci">char lst_cnm[TEXT_LENGTH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00437">chan_unistim.c:437</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a8adb8595b8127cbea2118fada1ef8782"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a8adb8595b8127cbea2118fada1ef8782">unistim_subchannel::rtp</a></div><div class="ttdeci">struct ast_rtp_instance * rtp</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00358">chan_unistim.c:358</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af699fa9e173afdd4c1fea90ee892330e"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af699fa9e173afdd4c1fea90ee892330e">AST_CONTROL_MASQUERADE_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00311">include/asterisk/frame.h:311</a></div></div>
<div class="ttc" id="channel_8h_html_a3dc9d235c0e16ab0a6812b4aa6572cce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a></div><div class="ttdeci">void * ast_channel_tech_pvt(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00565">channel_internal_api.c:565</a></div></div>
<div class="ttc" id="module_8h_html_ab35bc4efd9f79706300965c9d36a0ce5a9f8870a5687abe3d9a6b0b3fbc89a800"><div class="ttname"><a href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a9f8870a5687abe3d9a6b0b3fbc89a800">AST_MODULE_SUPPORT_EXTENDED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00122">module.h:122</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a06c120d39f85da53bf481811f914e523"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a06c120d39f85da53bf481811f914e523">unistimsock</a></div><div class="ttdeci">static int unistimsock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00247">chan_unistim.c:247</a></div></div>
<div class="ttc" id="structunistim__languages_html_acf60de4c64d60c1b9449c056bc6bfcf7"><div class="ttname"><a href="../../d1/d7e/structunistim__languages.html#acf60de4c64d60c1b9449c056bc6bfcf7">unistim_languages::label</a></div><div class="ttdeci">char * label</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00489">chan_unistim.c:489</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da7770a98a9c9da66659f843b3d1e1f747">STATE_ONHOOK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00291">chan_unistim.c:291</a></div></div>
<div class="ttc" id="channel_8h_html_ab733a7825810b895a89b629e0ea89380"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a></div><div class="ttdeci">#define ast_channel_unref(c)</div><div class="ttdoc">Decrease channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02981">channel.h:2981</a></div></div>
<div class="ttc" id="structast__tone__zone_html_a69f4a4df64289ee342ff49d3fe0ce82e"><div class="ttname"><a href="../../dd/d77/structast__tone__zone.html#a69f4a4df64289ee342ff49d3fe0ce82e">ast_tone_zone::country</a></div><div class="ttdeci">char country[MAX_TONEZONE_COUNTRY]</div><div class="ttdoc">Country code that this set of tones is for. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00076">indications.h:76</a></div></div>
<div class="ttc" id="structunistim__device_html_a2753d7a63d89080ac6ddc8a964817426"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a2753d7a63d89080ac6ddc8a964817426">unistim_device::lines</a></div><div class="ttdeci">struct unistim_device::@153 lines</div></div>
<div class="ttc" id="structunistim__device_html_aa28416837e2efff22b7833fb184dcf36"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aa28416837e2efff22b7833fb184dcf36">unistim_device::callhistory</a></div><div class="ttdeci">int callhistory</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00434">chan_unistim.c:434</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2002af10b2c9101d2e4c5bbb38c7a506"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2002af10b2c9101d2e4c5bbb38c7a506">key_select_language</a></div><div class="ttdeci">static void key_select_language(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03842">chan_unistim.c:3842</a></div></div>
<div class="ttc" id="causes_8h_html_a02b3785262e0be6843e8e9d235d8d78d"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a02b3785262e0be6843e8e9d235d8d78d">AST_CAUSE_SWITCH_CONGESTION</a></div><div class="ttdeci">#define AST_CAUSE_SWITCH_CONGESTION</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00122">causes.h:122</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aef636ed2f3d33f4c7a1ba67eb7c4d052"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a></div><div class="ttdeci">struct ast_variable * ast_variable_browse(const struct ast_config *config, const char *category_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01216">extconf.c:1216</a></div></div>
<div class="ttc" id="channel_8h_html_afb2ae2e53d6676f3ca44a98aa3f92a2c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afb2ae2e53d6676f3ca44a98aa3f92a2c">MAX_MUSICCLASS</a></div><div class="ttdeci">#define MAX_MUSICCLASS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00174">channel.h:174</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9b2fd2e5fdc9e12babf5cfb81cbb9fff"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9b2fd2e5fdc9e12babf5cfb81cbb9fff">FAVNUM</a></div><div class="ttdeci">#define FAVNUM</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00216">chan_unistim.c:216</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a71af7b469e8ed05a3336e606e65ba982"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a71af7b469e8ed05a3336e606e65ba982">is_key_favorite</a></div><div class="ttdeci">static int is_key_favorite(struct unistim_device *d, int fav)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01352">chan_unistim.c:1352</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660a10482c2bc6340e09ed02b00bc0e3f433"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a10482c2bc6340e09ed02b00bc0e3f433">AST_STATE_RING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00040">channelstate.h:40</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6488431ff9431b61b22212d55d166a30"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6488431ff9431b61b22212d55d166a30">show_extension_page</a></div><div class="ttdeci">static void show_extension_page(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03876">chan_unistim.c:3876</a></div></div>
<div class="ttc" id="channel_8h_html_a53b708b7fc71dcbcd33acae0ad4d7ef8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a53b708b7fc71dcbcd33acae0ad4d7ef8">ast_channel_unregister</a></div><div class="ttdeci">void ast_channel_unregister(const struct ast_channel_tech *tech)</div><div class="ttdoc">Unregister a channel technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00570">channel.c:570</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab628eb33db043ed9fde8deca41fab802"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab628eb33db043ed9fde8deca41fab802">FAV_ICON_HEADPHONES_ONHOLD</a></div><div class="ttdeci">#define FAV_ICON_HEADPHONES_ONHOLD</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00193">chan_unistim.c:193</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3f60196e91f7079534a0d85a5c98fbc4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3f60196e91f7079534a0d85a5c98fbc4">find_line_by_number</a></div><div class="ttdeci">static struct unistim_line * find_line_by_number(struct unistim_device *d, const char *val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06408">chan_unistim.c:6408</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a23918a6e9fdc07ad97f86aabbd81c22d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a23918a6e9fdc07ad97f86aabbd81c22d">packet_send_s4</a></div><div class="ttdeci">static const unsigned char packet_send_s4[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00551">chan_unistim.c:551</a></div></div>
<div class="ttc" id="structast__rtp__instance_html"><div class="ttname"><a href="../../df/d7a/structast__rtp__instance.html">ast_rtp_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00189">rtp_engine.c:189</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="channel_8h_html_ae6b4b7ba458e88fdbb2df9f39d935337"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a></div><div class="ttdeci">void ast_channel_hangupcause_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00431">channel_internal_api.c:431</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa247c0dae53b137f706c4ac39abc3be8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa247c0dae53b137f706c4ac39abc3be8">TEXT_LINE1</a></div><div class="ttdeci">#define TEXT_LINE1</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00171">chan_unistim.c:171</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7fc6473ab80d2117f1bcb1359721fdce"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a></div><div class="ttdeci">struct stasis_cache * ast_mwi_state_cache(void)</div><div class="ttdoc">Backend cache for ast_mwi_topic_cached(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/mwi_8c_source.html#l00090">mwi.c:90</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a3c8138b16b5ca041bbbdc88e8316cba8"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a3c8138b16b5ca041bbbdc88e8316cba8">unistim_subchannel::ringvolume</a></div><div class="ttdeci">signed char ringvolume</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00363">chan_unistim.c:363</a></div></div>
<div class="ttc" id="channel_8h_html_aada21a9f55151c285a1537613ff9197a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a></div><div class="ttdeci">int ast_queue_unhold(struct ast_channel *chan)</div><div class="ttdoc">Queue an unhold frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01216">channel.c:1216</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_aebc7c191314640b1006cd0f461a819fe"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#aebc7c191314640b1006cd0f461a819fe">unistim_subchannel::ringstyle</a></div><div class="ttdeci">signed char ringstyle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00364">chan_unistim.c:364</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9c85033c8f4f4551e9efc18dc56c2aeb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9c85033c8f4f4551e9efc18dc56c2aeb">qos</a></div><div class="ttdeci">static struct @149 qos</div></div>
<div class="ttc" id="astobj2_8h_html_a2448088751e4d494d1981c7f4b84e8d0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a></div><div class="ttdeci">#define OBJ_POINTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01154">astobj2.h:1154</a></div></div>
<div class="ttc" id="causes_8h_html_a9e3ffd481d41079a4ed1700464c9a42a"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a9e3ffd481d41079a4ed1700464c9a42a">AST_CAUSE_NETWORK_OUT_OF_ORDER</a></div><div class="ttdeci">#define AST_CAUSE_NETWORK_OUT_OF_ORDER</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00120">causes.h:120</a></div></div>
<div class="ttc" id="channel_8h_html_aa2df58e77751b741b6891afe210b5b8c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa2df58e77751b741b6891afe210b5b8c">ast_channel_set_rawwriteformat</a></div><div class="ttdeci">void ast_channel_set_rawwriteformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00832">channel_internal_api.c:832</a></div></div>
<div class="ttc" id="structunistimsession_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a493b57f443cc38b3d3df9c1e584d9d82">unistimsession::timeout</a></div><div class="ttdeci">int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00462">chan_unistim.c:462</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2eab34a419da2f1d9e240df755bb62ce"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2eab34a419da2f1d9e240df755bb62ce">check_send_queue</a></div><div class="ttdeci">static void check_send_queue(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01101">chan_unistim.c:1101</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae3af1c4f9b493119f75f3b61c3d2f170"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae3af1c4f9b493119f75f3b61c3d2f170">unistim_hangup_clean</a></div><div class="ttdeci">static int unistim_hangup_clean(struct ast_channel *ast, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04927">chan_unistim.c:4927</a></div></div>
<div class="ttc" id="structunistim__languages_html_a08043667c624523da9700ed8ad20bf2f"><div class="ttname"><a href="../../d1/d7e/structunistim__languages.html#a08043667c624523da9700ed8ad20bf2f">unistim_languages::trans</a></div><div class="ttdeci">struct ao2_container * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00492">chan_unistim.c:492</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a0376aa2503a185437fab8cb0b7d674fb"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a0376aa2503a185437fab8cb0b7d674fb">ast_rtp_instance_get_codecs</a></div><div class="ttdeci">struct ast_rtp_codecs * ast_rtp_instance_get_codecs(struct ast_rtp_instance *instance)</div><div class="ttdoc">Get the codecs structure of an RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00727">rtp_engine.c:727</a></div></div>
<div class="ttc" id="pickup_8h_html"><div class="ttname"><a href="../../dd/dbc/pickup_8h.html">pickup.h</a></div><div class="ttdoc">Call Pickup API. </div></div>
<div class="ttc" id="structunistimsession_html_a591e1dca3822bba640c194577c61c423"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a591e1dca3822bba640c194577c61c423">unistimsession::wsabufsend</a></div><div class="ttdeci">struct wsabuf wsabufsend[MAX_BUF_NUMBER]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00474">chan_unistim.c:474</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac3c7d25e6c3a582b74ddae917f6b5199"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac3c7d25e6c3a582b74ddae917f6b5199">packet_send_Contrast</a></div><div class="ttdeci">static const unsigned char packet_send_Contrast[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00638">chan_unistim.c:638</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a733cf9316c73b8beb7a3b1310061cdb7">ISO_8859_5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00341">chan_unistim.c:341</a></div></div>
<div class="ttc" id="format__cache_8h_html_a568c3f5838b53c38f11996dbe5ff5785"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a568c3f5838b53c38f11996dbe5ff5785">ast_format_ulaw</a></div><div class="ttdeci">struct ast_format * ast_format_ulaw</div><div class="ttdoc">Built-in cached ulaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00086">format_cache.c:86</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693da4d711648d547d84c9ce0c14a5df17273">STATE_OFFHOOK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00292">chan_unistim.c:292</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a17e823ae936a612d65be1543b473ab0a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a17e823ae936a612d65be1543b473ab0a">SUB_RING</a></div><div class="ttdeci">#define SUB_RING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00117">chan_unistim.c:117</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9f0fd974c1b1884f2745b93d7a658659"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9f0fd974c1b1884f2745b93d7a658659">send_retransmit</a></div><div class="ttdeci">static int send_retransmit(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01538">chan_unistim.c:1538</a></div></div>
<div class="ttc" id="pbx_8h_html_a9a937fbb3b5f4e68880a9c5714a29ce5"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a9a937fbb3b5f4e68880a9c5714a29ce5">ast_pbx_start</a></div><div class="ttdeci">enum ast_pbx_result ast_pbx_start(struct ast_channel *c)</div><div class="ttdoc">Create a new thread and start the PBX. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04712">pbx.c:4712</a></div></div>
<div class="ttc" id="structunistimsession_html_a6f742c81222f1d69fa8312530503a62f"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a6f742c81222f1d69fa8312530503a62f">unistimsession::seq_server</a></div><div class="ttdeci">unsigned short seq_server</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00464">chan_unistim.c:464</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ab48cb9e1e612dd486b747ba1c5d68d01"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a></div><div class="ttdeci">#define AST_LIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00139">linkedlists.h:139</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ad"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ad">phone_state</a></div><div class="ttdeci">phone_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00275">chan_unistim.c:275</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a43be34b406b2eb1b302d6007ccbc8380"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a43be34b406b2eb1b302d6007ccbc8380">unistim_cli</a></div><div class="ttdeci">static struct ast_cli_entry unistim_cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06267">chan_unistim.c:6267</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1ecad4a80d0e6f5b8ec6ab4c44021d18"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1ecad4a80d0e6f5b8ec6ab4c44021d18">tos_audio</a></div><div class="ttdeci">unsigned int tos_audio</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00251">chan_unistim.c:251</a></div></div>
<div class="ttc" id="format__cap_8h_html_a035f4aa78f172a18311bfa15dd232c6f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a></div><div class="ttdeci">#define AST_FORMAT_CAP_NAMES_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00326">format_cap.h:326</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad9a9b333f708985c8c3a77ed0822ac73"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad9a9b333f708985c8c3a77ed0822ac73">packet_send_stream_based_tone_single_freq</a></div><div class="ttdeci">static const unsigned char packet_send_stream_based_tone_single_freq[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00577">chan_unistim.c:577</a></div></div>
<div class="ttc" id="structunistim__menu__item_html_a96e1128adcd23704d9a18ad461119d85"><div class="ttname"><a href="../../d3/df2/structunistim__menu__item.html#a96e1128adcd23704d9a18ad461119d85">unistim_menu_item::handle_option</a></div><div class="ttdeci">void(* handle_option)(struct unistimsession *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00484">chan_unistim.c:484</a></div></div>
<div class="ttc" id="structunistim__device_html_af994317f1fc09f89f90d7fc81da9ff48"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#af994317f1fc09f89f90d7fc81da9ff48">unistim_device::phone_number</a></div><div class="ttdeci">char phone_number[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00399">chan_unistim.c:399</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3e912030a73724116acc311b9e677a31"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3e912030a73724116acc311b9e677a31">sub_hold</a></div><div class="ttdeci">static void sub_hold(struct unistimsession *pte, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02560">chan_unistim.c:2560</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abc0ce15d00b4bfb69266c5fd016dc88c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abc0ce15d00b4bfb69266c5fd016dc88c">dummy</a></div><div class="ttdeci">static void dummy(char *unused,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00220">chan_unistim.c:220</a></div></div>
<div class="ttc" id="abstract__jb_8h_html_ae50ad081bd2ae6b58bcfc4687916c586"><div class="ttname"><a href="../../dc/d14/abstract__jb_8h.html#ae50ad081bd2ae6b58bcfc4687916c586">ast_jb_read_conf</a></div><div class="ttdeci">int ast_jb_read_conf(struct ast_jb_conf *conf, const char *varname, const char *value)</div><div class="ttdoc">Sets jitterbuffer configuration property. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d1d/abstract__jb_8c_source.html#l00545">abstract_jb.c:545</a></div></div>
<div class="ttc" id="structdevices_html"><div class="ttname"><a href="../../dd/d5e/structdevices.html">devices</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d51/chan__mobile_8c_source.html#l00172">chan_mobile.c:172</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa5dac55364a8c99b24ae10663ebfeaac"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa5dac55364a8c99b24ae10663ebfeaac">packet_send_monthlabels_download</a></div><div class="ttdeci">static unsigned char packet_send_monthlabels_download[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00652">chan_unistim.c:652</a></div></div>
<div class="ttc" id="structast__variable_html_a501b314f49b3a9ff6e7be599d94686ee"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">ast_variable::lineno</a></div><div class="ttdeci">int lineno</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00095">include/asterisk/config.h:95</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4d6715f8ca4081df6121ac5442da521b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4d6715f8ca4081df6121ac5442da521b">SUB_THREEWAY</a></div><div class="ttdeci">#define SUB_THREEWAY</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00118">chan_unistim.c:118</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a48717a695a6adae245071375c4b0408f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a48717a695a6adae245071375c4b0408f">LED_SPEAKER_ON</a></div><div class="ttdeci">#define LED_SPEAKER_ON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00160">chan_unistim.c:160</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1d37d4b120ac839e97a0ced5d31009ce">STATE_AUTHDENY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00277">chan_unistim.c:277</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a12e7932d3de8bedd659964d72737588b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a12e7932d3de8bedd659964d72737588b">in_band_indication</a></div><div class="ttdeci">static void in_band_indication(struct ast_channel *ast, const struct ast_tone_zone *tz, const char *indication)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05320">chan_unistim.c:5320</a></div></div>
<div class="ttc" id="structast__tone__zone__part_html"><div class="ttname"><a href="../../dc/d40/structast__tone__zone__part.html">ast_tone_zone_part</a></div><div class="ttdoc">A description of a part of a tone. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00109">indications.h:109</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="structunistim__device_html_ae1afa05d81e1d6cd8c9d15a2c7a1e086"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ae1afa05d81e1d6cd8c9d15a2c7a1e086">unistim_device::previous_output</a></div><div class="ttdeci">int previous_output</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00440">chan_unistim.c:440</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac950e07f77834c925d65a34f03dfb2f0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac950e07f77834c925d65a34f03dfb2f0">packet_send_stream_based_tone_dual_freq</a></div><div class="ttdeci">static const unsigned char packet_send_stream_based_tone_dual_freq[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00579">chan_unistim.c:579</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a9ff41b61938f3d4dc4c82db103e7914ca9f63c95936712cfd6ec65555f1a27053"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a9ff41b61938f3d4dc4c82db103e7914ca9f63c95936712cfd6ec65555f1a27053">AST_RTP_PROPERTY_RTCP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00123">rtp_engine.h:123</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3a4ac2b1b9cd94f383cdbe01da74acbc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3a4ac2b1b9cd94f383cdbe01da74acbc">FAV_ICON_SHARP</a></div><div class="ttdeci">#define FAV_ICON_SHARP</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00196">chan_unistim.c:196</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a00675bfb8c64b2be86297fe4cba51fa2"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a00675bfb8c64b2be86297fe4cba51fa2">AST_CONTROL_RING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00279">include/asterisk/frame.h:279</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a601382e2da6215882c129b43b3384611">KEY_9</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00305">chan_unistim.c:305</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abda48311b6abe5a4dd8b6904ddde0a6d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abda48311b6abe5a4dd8b6904ddde0a6d">io</a></div><div class="ttdeci">static struct io_context * io</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00256">chan_unistim.c:256</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8c9568e97903db39b211a5fef52cf39d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8c9568e97903db39b211a5fef52cf39d">AST_CONFIG_MAX_PATH</a></div><div class="ttdeci">#define AST_CONFIG_MAX_PATH</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00113">chan_unistim.c:113</a></div></div>
<div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660addb60fd97b55a4aea24f992e30fe3c84"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660addb60fd97b55a4aea24f992e30fe3c84">AST_STATE_RESERVED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00037">channelstate.h:37</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7244ab798f58214294b580ca0bb48552"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a></div><div class="ttdeci">#define MAX_BUF_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00091">chan_unistim.c:91</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4d823fd9d764742ffbdac232df32479d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479d">autoprovision</a></div><div class="ttdeci">autoprovision</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00122">chan_unistim.c:122</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ace1ebb3dad1caac7eb8b0c71f344d5de"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ace1ebb3dad1caac7eb8b0c71f344d5de">change_favorite_icon</a></div><div class="ttdeci">static void change_favorite_icon(struct unistimsession *pte, unsigned char status)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01418">chan_unistim.c:1418</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a022c8b359343442c50dc1961abb09364"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a022c8b359343442c50dc1961abb09364">build_device</a></div><div class="ttdeci">static struct unistim_device * build_device(const char *cat, const struct ast_variable *v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06501">chan_unistim.c:6501</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_ab71294e675bc01eb29e9fd13b3839759"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#ab71294e675bc01eb29e9fd13b3839759">ast_rtp_instance_set_qos</a></div><div class="ttdeci">int ast_rtp_instance_set_qos(struct ast_rtp_instance *instance, int tos, int cos, const char *desc)</div><div class="ttdoc">Set QoS parameters on an RTP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02169">rtp_engine.c:2169</a></div></div>
<div class="ttc" id="unaligned_8h_html_a31285bcf21169ef487fa4431931b38d2"><div class="ttname"><a href="../../d2/d1e/unaligned_8h.html#a31285bcf21169ef487fa4431931b38d2">put_unaligned_uint16</a></div><div class="ttdeci">static void put_unaligned_uint16(void *p, unsigned short datum)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1e/unaligned_8h_source.html#l00065">unaligned.h:65</a></div></div>
<div class="ttc" id="structunistimsession_html_a3437155bc5356002163fcb3dfbb9ccac"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a3437155bc5356002163fcb3dfbb9ccac">unistimsession::size_buff_entry</a></div><div class="ttdeci">int size_buff_entry</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00470">chan_unistim.c:470</a></div></div>
<div class="ttc" id="structunistim__device_html_acf2401a06e49ab4f8351e23db9475ffc"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#acf2401a06e49ab4f8351e23db9475ffc">unistim_device::dtmfduration</a></div><div class="ttdeci">int dtmfduration</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00427">chan_unistim.c:427</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af809a5a3654f9c22d7a6c0447ac7c914"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af809a5a3654f9c22d7a6c0447ac7c914">unregister_extension</a></div><div class="ttdeci">static int unregister_extension(const struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01459">chan_unistim.c:1459</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a87cb097a21ab7712c27aa9e3b3a1ef69"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a87cb097a21ab7712c27aa9e3b3a1ef69">ast_rtp_instance_write</a></div><div class="ttdeci">int ast_rtp_instance_write(struct ast_rtp_instance *instance, struct ast_frame *frame)</div><div class="ttdoc">Send a frame out over RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00568">rtp_engine.c:568</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6f7f7ebe5adee2e22264b0507ffc2a29"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6f7f7ebe5adee2e22264b0507ffc2a29">swap_subs</a></div><div class="ttdeci">static void swap_subs(struct unistim_subchannel *a, struct unistim_subchannel *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03028">chan_unistim.c:3028</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9b3644f4591bdac1f9302794b6211fb6"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9b3644f4591bdac1f9302794b6211fb6">packet_recv_pick_up</a></div><div class="ttdeci">static const unsigned char packet_recv_pick_up[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00517">chan_unistim.c:517</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a9aaa788d26a78c9d765cc565267ae1a9">KEY_SHARP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00307">chan_unistim.c:307</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_ac2fd3e9ee89436cbf6b2ac374bab711b"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#ac2fd3e9ee89436cbf6b2ac374bab711b">ast_rtp_glue_register</a></div><div class="ttdeci">#define ast_rtp_glue_register(glue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00847">rtp_engine.h:847</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae478d437699e68f3bb150c2c531ff551"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae478d437699e68f3bb150c2c531ff551">discard_call</a></div><div class="ttdeci">static void discard_call(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02647">chan_unistim.c:2647</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a809cffe22b7ff73ee3e2c064a2f3ced7"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a809cffe22b7ff73ee3e2c064a2f3ced7">send_ping</a></div><div class="ttdeci">static void send_ping(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00991">chan_unistim.c:991</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af2e70fd22ee852282816e216b146db8d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af2e70fd22ee852282816e216b146db8d">unquote</a></div><div class="ttdeci">static void unquote(char *out, const char *src, int maxlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06275">chan_unistim.c:6275</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa9672f73c65f1ae19f3c04bd1e7cfc24"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa9672f73c65f1ae19f3c04bd1e7cfc24">options_languages</a></div><div class="ttdeci">static struct unistim_languages options_languages[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00771">chan_unistim.c:771</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac0a38da3415792f925843ac9dc50e86d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac0a38da3415792f925843ac9dc50e86d">get_sub_holding</a></div><div class="ttdeci">static struct unistim_subchannel * get_sub_holding(struct unistim_device *device, int type, int holding)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02511">chan_unistim.c:2511</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad4a5e3b584955a132a74e6910bce5ecc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad4a5e3b584955a132a74e6910bce5ecc">DEBUG_TIMER</a></div><div class="ttdeci">#define DEBUG_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00241">chan_unistim.c:241</a></div></div>
<div class="ttc" id="io_8h_html_a0d9e01f215782a343a1b71b5be362080"><div class="ttname"><a href="../../dc/dac/io_8h.html#a0d9e01f215782a343a1b71b5be362080">AST_IO_IN</a></div><div class="ttdeci">#define AST_IO_IN</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dac/io_8h_source.html#l00034">io.h:34</a></div></div>
<div class="ttc" id="structunistim__device_html_a2cc43d5ab182da8739feab7963cd65c8"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a2cc43d5ab182da8739feab7963cd65c8">unistim_device::rtp_method</a></div><div class="ttdeci">int rtp_method</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00430">chan_unistim.c:430</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="structast__assigned__ids_html"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a></div><div class="ttdoc">Structure to pass both assignedid values to channel drivers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00605">channel.h:605</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8483db31a121409eaddfa592462b44a5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8483db31a121409eaddfa592462b44a5">send_select_output</a></div><div class="ttdeci">static void send_select_output(struct unistimsession *pte, unsigned char output, unsigned char volume, unsigned char mute)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01670">chan_unistim.c:1670</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a63fdc8d21b4335d99984468ceb5d187b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a63fdc8d21b4335d99984468ceb5d187b">key_main_page</a></div><div class="ttdeci">static void key_main_page(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04191">chan_unistim.c:4191</a></div></div>
<div class="ttc" id="channel_8h_html_a9824ec754695fd10c2ad3ca929afba34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9824ec754695fd10c2ad3ca929afba34">ast_channel_callgroup_set</a></div><div class="ttdeci">void ast_channel_callgroup_set(struct ast_channel *chan, ast_group_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01078">channel_internal_api.c:1078</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a></div><div class="ttdeci">ast_channel_state</div><div class="ttdoc">ast_channel states </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00035">channelstate.h:35</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01122">channel.h:1122</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="io_8h_html_aa250c3f6541dc5734deb966d6821da7a"><div class="ttname"><a href="../../dc/dac/io_8h.html#aa250c3f6541dc5734deb966d6821da7a">ast_io_add</a></div><div class="ttdeci">int * ast_io_add(struct io_context *ioc, int fd, ast_io_cb callback, short events, void *data)</div><div class="ttdoc">Adds an IO context. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/io_8c_source.html#l00162">io.c:162</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aaa8d6e83f71538ad80c9f2f00574f051"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aaa8d6e83f71538ad80c9f2f00574f051">close_call</a></div><div class="ttdeci">static void close_call(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02599">chan_unistim.c:2599</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a08ef43771b971334bcabfe77438e1ad1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a08ef43771b971334bcabfe77438e1ad1">set_ping_timer</a></div><div class="ttdeci">static void set_ping_timer(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01090">chan_unistim.c:1090</a></div></div>
<div class="ttc" id="app__adsiprog_8c_html_a1fcc0891a0631f9a9222fdf961bd79dc"><div class="ttname"><a href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a></div><div class="ttdeci">static const struct adsi_event events[]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/app__adsiprog_8c_source.html#l00085">app_adsiprog.c:85</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a07b2e6cad22cbdbd0e3313c6a2e7a65f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a07b2e6cad22cbdbd0e3313c6a2e7a65f">transfer_call_step1</a></div><div class="ttdeci">static void transfer_call_step1(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03056">chan_unistim.c:3056</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1d6cb4c6b51d44ec70be9f6e722ccf99"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1d6cb4c6b51d44ec70be9f6e722ccf99">find_rtp_port</a></div><div class="ttdeci">static int find_rtp_port(struct unistim_subchannel *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02685">chan_unistim.c:2685</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a5a24176e8066b727463907da4903bb8e"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5a24176e8066b727463907da4903bb8e">AST_CONTROL_TAKEOFFHOOK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00283">include/asterisk/frame.h:283</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971a6590815d4822784877fe529852565e7b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a6590815d4822784877fe529852565e7b">LANG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00337">chan_unistim.c:337</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="structunistim__device_html_a3c8138b16b5ca041bbbdc88e8316cba8"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a3c8138b16b5ca041bbbdc88e8316cba8">unistim_device::ringvolume</a></div><div class="ttdeci">signed char ringvolume</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00422">chan_unistim.c:422</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a39d8131e7248012121c287b7de506c19"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a39d8131e7248012121c287b7de506c19">BUFFSEND</a></div><div class="ttdeci">#define BUFFSEND</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00704">chan_unistim.c:704</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01117">bridge.h:1117</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9c4131133a2e6f82d9da0d64beeb0ebc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9c4131133a2e6f82d9da0d64beeb0ebc">packet_send_set_pos_cursor</a></div><div class="ttdeci">static const unsigned char packet_send_set_pos_cursor[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00646">chan_unistim.c:646</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structunistim__device_html_a567cadc00d180785d982d27dd01b89bf"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a567cadc00d180785d982d27dd01b89bf">unistim_device::receiver_state</a></div><div class="ttdeci">int receiver_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00396">chan_unistim.c:396</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6bd283d42dae281a26a38993d907b5f0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6bd283d42dae281a26a38993d907b5f0">packet_send_expansion_text</a></div><div class="ttdeci">static const unsigned char packet_send_expansion_text[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00528">chan_unistim.c:528</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5a69b56bd6aaac508e7be719b487a804"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5a69b56bd6aaac508e7be719b487a804">IDLE_WAIT</a></div><div class="ttdeci">#define IDLE_WAIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00101">chan_unistim.c:101</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2c58034bdc4233edd07f2fd18433c7b3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2c58034bdc4233edd07f2fd18433c7b3">send_callerid_screen</a></div><div class="ttdeci">static void send_callerid_screen(struct unistimsession *, struct unistim_subchannel *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04825">chan_unistim.c:4825</a></div></div>
<div class="ttc" id="func__realtime_8c_html_a13d23fea305bed9188c360e245c5c9f1"><div class="ttname"><a href="../../db/d09/func__realtime_8c.html#a13d23fea305bed9188c360e245c5c9f1">buf2</a></div><div class="ttdeci">static struct ast_threadstorage buf2</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d09/func__realtime_8c_source.html#l00179">func_realtime.c:179</a></div></div>
<div class="ttc" id="structunistim__device_html_a48b276b04c93ca4b9625e4e6cfdf69fd"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a48b276b04c93ca4b9625e4e6cfdf69fd">unistim_device::expsoftkeylabel</a></div><div class="ttdeci">char expsoftkeylabel[EXPNUM][11]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00404">chan_unistim.c:404</a></div></div>
<div class="ttc" id="structunistimsession_html_a036407d71bff31da6c9b17ff9ff859c5"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a036407d71bff31da6c9b17ff9ff859c5">unistimsession::buf</a></div><div class="ttdeci">unsigned char buf[MAX_BUF_NUMBER][MAX_BUF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00475">chan_unistim.c:475</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="format__cap_8h_html_aefb7d3623f4d8a582168e7aaf509459c"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a></div><div class="ttdeci">size_t ast_format_cap_count(const struct ast_format_cap *cap)</div><div class="ttdoc">Get the number of formats present within the capabilities structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00395">format_cap.c:395</a></div></div>
<div class="ttc" id="structunistim__line_html"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html">unistim_line</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00372">chan_unistim.c:372</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77fae14c7626fdff887aaa924a5693d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77fae14c7626fdff887aaa924a5693d">handset_state</a></div><div class="ttdeci">handset_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00290">chan_unistim.c:290</a></div></div>
<div class="ttc" id="structunistim__device_html_a1f29afe10c22e193f73efb8bf0dd5b15"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a1f29afe10c22e193f73efb8bf0dd5b15">unistim_device::softkeynumber</a></div><div class="ttdeci">char softkeynumber[FAVNUM][AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00406">chan_unistim.c:406</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada2d8bf579b460c48f6b537d8745c0da27">STATE_SELECTOPTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00283">chan_unistim.c:283</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac9e723e843d88f75a6a6fb2b556cdf6c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac9e723e843d88f75a6a6fb2b556cdf6c">microphone_mute_toggle</a></div><div class="ttdeci">static void microphone_mute_toggle(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04457">chan_unistim.c:4457</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">include/asterisk/frame.h:282</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a25a9305efab3b493ca2519562fcec3d5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a25a9305efab3b493ca2519562fcec3d5">tos</a></div><div class="ttdeci">unsigned int tos</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00250">chan_unistim.c:250</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a19b4c0453b60519ad48f6be8dd751e2a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a19b4c0453b60519ad48f6be8dd751e2a">packet_send_expansion_next</a></div><div class="ttdeci">static const unsigned char packet_send_expansion_next[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00526">chan_unistim.c:526</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a94a931f0f31df959b9f33a5f294dc99f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a94a931f0f31df959b9f33a5f294dc99f">LED_BAR_ON</a></div><div class="ttdeci">#define LED_BAR_ON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00152">chan_unistim.c:152</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="channel_8h_html_ab5f3776fda943e52820ceeee5835c1b4"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab5f3776fda943e52820ceeee5835c1b4">ast_channel_register</a></div><div class="ttdeci">int ast_channel_register(const struct ast_channel_tech *tech)</div><div class="ttdoc">Register a channel technology (a new channel driver) Called by a channel module to register the kind ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00539">channel.c:539</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7f8d93f20c2e85b18cb72b434d51082e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7f8d93f20c2e85b18cb72b434d51082e">packet_send_charset_iso_8859_5</a></div><div class="ttdeci">static const unsigned char packet_send_charset_iso_8859_5[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00688">chan_unistim.c:688</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3e2114722f6cb731593296a831290a7d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3e2114722f6cb731593296a831290a7d">cos_audio</a></div><div class="ttdeci">unsigned int cos_audio</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00253">chan_unistim.c:253</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a96f40075ef90a2d9b8d169b1d4261394"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a96f40075ef90a2d9b8d169b1d4261394">packet_send_stream_based_tone_on</a></div><div class="ttdeci">static const unsigned char packet_send_stream_based_tone_on[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00575">chan_unistim.c:575</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aee5475e98a8a690dd4f551cdbe3ac08c">KEY_FUNC2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00315">chan_unistim.c:315</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa73a3666fca776852c23de09da246f94"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa73a3666fca776852c23de09da246f94">close_client</a></div><div class="ttdeci">static void close_client(struct unistimsession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01470">chan_unistim.c:1470</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a624e9f7955f757d82cbc79553a1c8865"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a624e9f7955f757d82cbc79553a1c8865">attempt_transfer</a></div><div class="ttdeci">static int attempt_transfer(struct unistim_subchannel *p1, struct unistim_subchannel *p2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02440">chan_unistim.c:2440</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="acl_8h_html_a49d1eefe77636e2a63ad013afa0fc3b5"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a49d1eefe77636e2a63ad013afa0fc3b5">ast_str2tos</a></div><div class="ttdeci">int ast_str2tos(const char *value, unsigned int *tos)</div><div class="ttdoc">Convert a string to the appropriate TOS value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00967">acl.c:967</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a1e5e3d08eff5e2357e75c01e127e7922"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a></div><div class="ttdeci">char * ast_category_browse(struct ast_config *config, const char *prev_name)</div><div class="ttdoc">Browse categories. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l03328">extconf.c:3328</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a148deb9252a1f8568bbf1338d320c879"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a148deb9252a1f8568bbf1338d320c879">unistim_call</a></div><div class="ttdeci">static int unistim_call(struct ast_channel *ast, const char *dest, int timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04867">chan_unistim.c:4867</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a837370c44d13ebc322d16e3b5924d7d5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a837370c44d13ebc322d16e3b5924d7d5">MAX_BUF_NUMBER</a></div><div class="ttdeci">#define MAX_BUF_NUMBER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00093">chan_unistim.c:93</a></div></div>
<div class="ttc" id="indications_8h_html_a9d5be069b7060d326a213f5d60b8dc77"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a9d5be069b7060d326a213f5d60b8dc77">ast_playtones_stop</a></div><div class="ttdeci">void ast_playtones_stop(struct ast_channel *chan)</div><div class="ttdoc">Stop playing tones on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6e/indications_8c_source.html#l00393">indications.c:393</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_afd08a9fecc95afb5908348b79a50dbe7"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#afd08a9fecc95afb5908348b79a50dbe7">packet_send_query_mac_address</a></div><div class="ttdeci">static const unsigned char packet_send_query_mac_address[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00697">chan_unistim.c:697</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1ed152a52803941ba905e814b126abbb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1ed152a52803941ba905e814b126abbb">TEXT_NORMAL</a></div><div class="ttdeci">#define TEXT_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00173">chan_unistim.c:173</a></div></div>
<div class="ttc" id="structast__channel_html_a8f64897c7ccc5c13f276d1d07c4e7095"><div class="ttname"><a href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">ast_channel::data</a></div><div class="ttdeci">const char * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00083">channel_internal_api.c:83</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9b170f34e7f4b7d8ff7d19331d1fb6c9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9b170f34e7f4b7d8ff7d19331d1fb6c9">packet_send_led_update</a></div><div class="ttdeci">static const unsigned char packet_send_led_update[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00694">chan_unistim.c:694</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da67794cfd2c9e52d377357dda2873ac12">AUTOPROVISIONING_YES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00124">chan_unistim.c:124</a></div></div>
<div class="ttc" id="structunistim__device_html_aebc7c191314640b1006cd0f461a819fe"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aebc7c191314640b1006cd0f461a819fe">unistim_device::ringstyle</a></div><div class="ttdeci">signed char ringstyle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00423">chan_unistim.c:423</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab5b17b5e0773ae87d486823b7505da1b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab5b17b5e0773ae87d486823b7505da1b">send_date_time3</a></div><div class="ttdeci">static void send_date_time3(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01826">chan_unistim.c:1826</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9386c5251cb78c1a390424185f8e8cd5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9386c5251cb78c1a390424185f8e8cd5">packet_send_open_audio_stream_tx</a></div><div class="ttdeci">static const unsigned char packet_send_open_audio_stream_tx[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00613">chan_unistim.c:613</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a049e610f9af2278aea2b20bc74725429"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a049e610f9af2278aea2b20bc74725429">unistim_ss</a></div><div class="ttdeci">static void * unistim_ss(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02659">chan_unistim.c:2659</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="module_8h_html_a28b9e8444e0f9b495cc1b10628b816e8"><div class="ttname"><a href="../../d5/d16/module_8h.html#a28b9e8444e0f9b495cc1b10628b816e8">ast_update_use_count</a></div><div class="ttdeci">void ast_update_use_count(void)</div><div class="ttdoc">Notify when usecount has been changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l02528">loader.c:2528</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a248afd6c02044259a386f6b7aee922a2"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a></div><div class="ttdeci">#define AST_FRAME_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00139">include/asterisk/frame.h:139</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0a8b485ca6348c004fd0b27cfe04cd21"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0a8b485ca6348c004fd0b27cfe04cd21">ustmtext</a></div><div class="ttdeci">static const char * ustmtext(const char *str, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00800">chan_unistim.c:800</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac505cc920f4818debbff88aaca25210e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac505cc920f4818debbff88aaca25210e">LED_SPEAKER_OFF</a></div><div class="ttdeci">#define LED_SPEAKER_OFF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00159">chan_unistim.c:159</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a195b2c39c09113953814aa800dd06e7f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a195b2c39c09113953814aa800dd06e7f">AST_CONTROL_WINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00287">include/asterisk/frame.h:287</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2926c60feddaf16066ce69f3a0a90d76"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2926c60feddaf16066ce69f3a0a90d76">unistim_line_copy</a></div><div class="ttdeci">static void unistim_line_copy(struct unistim_line *dst, struct unistim_line *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01947">chan_unistim.c:1947</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a59fd33bf82488b0c557bebd98b84d5c6"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a59fd33bf82488b0c557bebd98b84d5c6">packet_send_S7</a></div><div class="ttdeci">static const unsigned char packet_send_S7[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00645">chan_unistim.c:645</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01123">bridge.h:1123</a></div></div>
<div class="ttc" id="musiconhold_8h_html_a52fead32f69533450f3c05b2e6960149"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a></div><div class="ttdeci">void ast_moh_stop(struct ast_channel *chan)</div><div class="ttdoc">Turn off music on hold on a given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07876">channel.c:7876</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a14de9b3d15732a22c6ca57b199f1fd7a">KEY_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00319">chan_unistim.c:319</a></div></div>
<div class="ttc" id="structast__sockaddr_html"><div class="ttname"><a href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a></div><div class="ttdoc">Socket address structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00097">netsock2.h:97</a></div></div>
<div class="ttc" id="channel_8h_html_af2f955678d93e76be4776d66154b5fdc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a></div><div class="ttdeci">const char * ast_channel_call_forward(const struct ast_channel *chan)</div></div>
<div class="ttc" id="chan__mgcp_8c_html_a29e973bd94bfbaf59d939bd1bc988c32"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a></div><div class="ttdeci">static char cid_num[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00164">chan_mgcp.c:164</a></div></div>
<div class="ttc" id="structunistim__device_html_a8e1a8bfdbd32d3f024137210eb30d420"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a8e1a8bfdbd32d3f024137210eb30d420">unistim_device::datetimeformat</a></div><div class="ttdeci">char datetimeformat</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00418">chan_unistim.c:418</a></div></div>
<div class="ttc" id="structunistim__device_html_adab4da51ba40d5a492becdceccccbfcd"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#adab4da51ba40d5a492becdceccccbfcd">unistim_device::selected</a></div><div class="ttdeci">int selected</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00442">chan_unistim.c:442</a></div></div>
<div class="ttc" id="structast__tm_html_a994c4f4519ba57e186580d21cc86f9e5"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a994c4f4519ba57e186580d21cc86f9e5">ast_tm::tm_year</a></div><div class="ttdeci">int tm_year</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00041">localtime.h:41</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2accd5119ec27e18e50be3af305cf42e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2accd5119ec27e18e50be3af305cf42e">unistim_read</a></div><div class="ttdeci">static struct ast_frame * unistim_read(struct ast_channel *ast)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05204">chan_unistim.c:5204</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aedf47ef4e08dbf80640c5a2bdd09d21f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aedf47ef4e08dbf80640c5a2bdd09d21f">packet_send_date_time</a></div><div class="ttdeci">static const unsigned char packet_send_date_time[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00542">chan_unistim.c:542</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adac118a9dc38baf92b6d73a438194b304e">STATE_SELECTLANGUAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00285">chan_unistim.c:285</a></div></div>
<div class="ttc" id="structast__rtp__glue_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d8/dc9/structast__rtp__glue.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_rtp_glue::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00722">rtp_engine.h:722</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a29e70fa1054d6893994c3d31be3b5453"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a29e70fa1054d6893994c3d31be3b5453">TEXT_LENGTH_MAX</a></div><div class="ttdeci">#define TEXT_LENGTH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00169">chan_unistim.c:169</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00310">include/asterisk/frame.h:310</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a8631c44e7160622bcbdc6aea8b449e5f"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a8631c44e7160622bcbdc6aea8b449e5f">ast_rtp_codecs_payload_code_tx</a></div><div class="ttdeci">int ast_rtp_codecs_payload_code_tx(struct ast_rtp_codecs *codecs, int asterisk_format, const struct ast_format *format, int code)</div><div class="ttdoc">Retrieve a tx mapped payload type based on whether it is an Asterisk format and the code...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l01928">rtp_engine.c:1928</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a02d8db6086b4a18353b82ebcad631ff6"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a02d8db6086b4a18353b82ebcad631ff6">do_monitor</a></div><div class="ttdeci">static void * do_monitor(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05835">chan_unistim.c:5835</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ade67981a8dbd8379c82b508b57ba7159"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ade67981a8dbd8379c82b508b57ba7159">sessionlock</a></div><div class="ttdeci">static ast_mutex_t sessionlock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00271">chan_unistim.c:271</a></div></div>
<div class="ttc" id="structunistimsession_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#adf04f66344e3fb0a6f6a69bf39d19902">unistimsession::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00459">chan_unistim.c:459</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1369ffba6deaa99b61390a748b0a9bbb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1369ffba6deaa99b61390a748b0a9bbb">packet_send_expansion_icon</a></div><div class="ttdeci">static const unsigned char packet_send_expansion_icon[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00527">chan_unistim.c:527</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5655629994fdc7d0d29a850c209b96f2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5655629994fdc7d0d29a850c209b96f2">load_module</a></div><div class="ttdeci">static int load_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07082">chan_unistim.c:7082</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad13a5fa92094321a806cf334e9f77073"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad13a5fa92094321a806cf334e9f77073">packet_send_open_audio_stream_rx3</a></div><div class="ttdeci">static const unsigned char packet_send_open_audio_stream_rx3[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00619">chan_unistim.c:619</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae81cba0110cb56a82ebd9b1bc3d6f396"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae81cba0110cb56a82ebd9b1bc3d6f396">unistim_answer</a></div><div class="ttdeci">static int unistim_answer(struct ast_channel *ast)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05054">chan_unistim.c:5054</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa5da8becb21e619d6156d74e898af2b4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa5da8becb21e619d6156d74e898af2b4">unistim_register</a></div><div class="ttdeci">static int unistim_register(struct unistimsession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01920">chan_unistim.c:1920</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="structast__tone__zone__part_html_afcc3b9b0ca817ffad0deffe043cbb2b2"><div class="ttname"><a href="../../dc/d40/structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">ast_tone_zone_part::freq1</a></div><div class="ttdeci">unsigned int freq1</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00110">indications.h:110</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a000510e0819e5e505b7b5abb53c7b4a5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a000510e0819e5e505b7b5abb53c7b4a5">KEY_INDEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00333">chan_unistim.c:333</a></div></div>
<div class="ttc" id="channel_8h_html_a9238c3318ae8d3bea2cbbe1d1e459eb7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9238c3318ae8d3bea2cbbe1d1e459eb7">MAX_LANGUAGE</a></div><div class="ttdeci">#define MAX_LANGUAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00173">channel.h:173</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a29128ae5c15a12dea5fe4f263ba6cec1"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a></div><div class="ttdeci">static int mute</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00144">chan_alsa.c:144</a></div></div>
<div class="ttc" id="pbx_8h_html_a721c6ba091102f155a586e09b2a526bf"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a721c6ba091102f155a586e09b2a526bf">ast_context_remove_extension</a></div><div class="ttdeci">int ast_context_remove_extension(const char *context, const char *extension, int priority, const char *registrar)</div><div class="ttdoc">Simply remove extension from context. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04952">pbx.c:4952</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a29058a32cb27a6c7e8eec1a99dfb8ecc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a29058a32cb27a6c7e8eec1a99dfb8ecc">VOLUME_LOW</a></div><div class="ttdeci">#define VOLUME_LOW</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00142">chan_unistim.c:142</a></div></div>
<div class="ttc" id="structunistimsession_html_a8d1a33a62c4d2e67626f59b72dbe8253"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a8d1a33a62c4d2e67626f59b72dbe8253">unistimsession::last_seq_ack</a></div><div class="ttdeci">unsigned short last_seq_ack</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00465">chan_unistim.c:465</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a50b7fe33bba67b74dd7b746539e81000"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a50b7fe33bba67b74dd7b746539e81000">AST_CONTROL_PROCEEDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00292">include/asterisk/frame.h:292</a></div></div>
<div class="ttc" id="structustm__lang__entry_html_aaf2e32d9c0398d3ffcc2895ebc4cbaaa"><div class="ttname"><a href="../../df/dc9/structustm__lang__entry.html#aaf2e32d9c0398d3ffcc2895ebc4cbaaa">ustm_lang_entry::str_orig</a></div><div class="ttdeci">const char * str_orig</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00782">chan_unistim.c:782</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1d738bf5ceeb7d7fba0347346335e9ab"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1d738bf5ceeb7d7fba0347346335e9ab">unistimdebug</a></div><div class="ttdeci">static int unistimdebug</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00243">chan_unistim.c:243</a></div></div>
<div class="ttc" id="channel_8h_html_a91e78b15da3244307ffd749fa85f4db7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91e78b15da3244307ffd749fa85f4db7">ast_queue_hangup_with_cause</a></div><div class="ttdeci">int ast_queue_hangup_with_cause(struct ast_channel *chan, int cause)</div><div class="ttdoc">Queue a hangup frame with hangupcause set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01166">channel.c:1166</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a69e634f5869dfcb04320125526a7769d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a69e634f5869dfcb04320125526a7769d">FAV_ICON_HEADPHONES</a></div><div class="ttdeci">#define FAV_ICON_HEADPHONES</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00192">chan_unistim.c:192</a></div></div>
<div class="ttc" id="structast__cli__entry_html_a1bd7a8575ca2650132d636d65dcda2f6"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6">ast_cli_entry::args</a></div><div class="ttdeci">int args</div><div class="ttdoc">This gets set in ast_cli_register() </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00185">cli.h:185</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a36cc0c8c725c461d6f25bd52cb56f3db"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a36cc0c8c725c461d6f25bd52cb56f3db">STATUS_LENGTH_MAX</a></div><div class="ttdeci">#define STATUS_LENGTH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00175">chan_unistim.c:175</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8e07f08200700b2f3bb9095acc2f46f5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8e07f08200700b2f3bb9095acc2f46f5">RETRANSMIT_TIMER</a></div><div class="ttdeci">#define RETRANSMIT_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00103">chan_unistim.c:103</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac9110f159ddaa6bb7217e2a353e5d7bd"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac9110f159ddaa6bb7217e2a353e5d7bd">unistim_sp</a></div><div class="ttdeci">static char * unistim_sp(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06150">chan_unistim.c:6150</a></div></div>
<div class="ttc" id="structunistimsession_html_a8879dd3a62f9fa2a85475b40587c3d77"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a8879dd3a62f9fa2a85475b40587c3d77">unistimsession::nb_retransmit</a></div><div class="ttdeci">int nb_retransmit</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00468">chan_unistim.c:468</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aafeb2af7a518e350bb22fe57849c323a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aafeb2af7a518e350bb22fe57849c323a">USTM_LOG_DIR</a></div><div class="ttdeci">#define USTM_LOG_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00087">chan_unistim.c:87</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a96847821359361addde051ee7c098b38"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a96847821359361addde051ee7c098b38">unistim_reload</a></div><div class="ttdeci">static char * unistim_reload(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc"> unistim_reload: Force reload of module from cli  Runs in the asterisk main thread, so don&amp;#39;t do anything useful but setting a flag and waiting for do_monitor to do the job in our thread </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06245">chan_unistim.c:6245</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4cb83d1ce92b4dfaa5761875a70741d9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4cb83d1ce92b4dfaa5761875a70741d9">send_blink_cursor</a></div><div class="ttdeci">static void send_blink_cursor(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01844">chan_unistim.c:1844</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0fdd8e9ba003ce056acde0f1d4d8fef4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0fdd8e9ba003ce056acde0f1d4d8fef4">find_subchannel_by_name</a></div><div class="ttdeci">static struct unistim_subchannel * find_subchannel_by_name(const char *dest)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05421">chan_unistim.c:5421</a></div></div>
<div class="ttc" id="channel_8h_html_aaced431562223538a94e0e69cf94151a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a></div><div class="ttdeci">struct ast_format * ast_channel_readformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00856">channel_internal_api.c:856</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a01d2de6d8fdd9fbd8a21e03797aef3d2">KEY_FAV0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00323">chan_unistim.c:323</a></div></div>
<div class="ttc" id="structunistim__device_html_a76a055a540e12c7206a5004afea1f66e"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a76a055a540e12c7206a5004afea1f66e">unistim_device::output</a></div><div class="ttdeci">int output</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00439">chan_unistim.c:439</a></div></div>
<div class="ttc" id="structunistimsession_html_aae0e280fef45e5fd968c73771f6cd2dd"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#aae0e280fef45e5fd968c73771f6cd2dd">unistimsession::device</a></div><div class="ttdeci">struct unistim_device * device</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00476">chan_unistim.c:476</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_acb87e1e2256c52e5361fc4b722e4d4af"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#acb87e1e2256c52e5361fc4b722e4d4af">unistim_subchannel::subtype</a></div><div class="ttdeci">unsigned int subtype</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00355">chan_unistim.c:355</a></div></div>
<div class="ttc" id="format__cap_8h_html_a4fadd3c35438f866e29eddc68283bce6"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a4fadd3c35438f866e29eddc68283bce6">ast_format_cap_iscompatible_format</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cap_iscompatible_format(const struct ast_format_cap *cap, const struct ast_format *format)</div><div class="ttdoc">Find if ast_format is within the capabilities of the ast_format_cap object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00583">format_cap.c:583</a></div></div>
<div class="ttc" id="structunistimsession_html_ac93c26023a1a401e98dab6d232f07158"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#ac93c26023a1a401e98dab6d232f07158">unistimsession::next</a></div><div class="ttdeci">struct unistimsession * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00477">chan_unistim.c:477</a></div></div>
<div class="ttc" id="channel_8h_html_af0566a4937a5bb1323825e4ef89c0e5a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af0566a4937a5bb1323825e4ef89c0e5a">ast_channel_tech_set</a></div><div class="ttdeci">void ast_channel_tech_set(struct ast_channel *chan, const struct ast_channel_tech *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00773">channel_internal_api.c:773</a></div></div>
<div class="ttc" id="structunistim__device_html_a6c6c2b6adbe74acc944bc0c55b16c8f4"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">unistim_device::ha</a></div><div class="ttdeci">struct ast_ha * ha</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00453">chan_unistim.c:453</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacfae17a2820f70b44071d7d42f17f755">STATE_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00281">chan_unistim.c:281</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aeda67011baba74e726403158a26732f8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aeda67011baba74e726403158a26732f8">send_icon</a></div><div class="ttdeci">static void send_icon(unsigned char pos, unsigned char status, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01147">chan_unistim.c:1147</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_add4d38fa22770d38c666f9b9361a1bee"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#add4d38fa22770d38c666f9b9361a1bee">dtmf_col</a></div><div class="ttdeci">static const float dtmf_col[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00346">chan_unistim.c:346</a></div></div>
<div class="ttc" id="structnumber_html"><div class="ttname"><a href="../../d6/d49/structnumber.html">number</a></div><div class="ttdoc">Number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d55/app__followme_8c_source.html#l00154">app_followme.c:154</a></div></div>
<div class="ttc" id="channel_8h_html_aa5a0589e78ac9e010524872ca0a3cf49"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa5a0589e78ac9e010524872ca0a3cf49">AST_MAX_ACCOUNT_CODE</a></div><div class="ttdeci">#define AST_MAX_ACCOUNT_CODE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00171">channel.h:171</a></div></div>
<div class="ttc" id="structunistim__line_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a3777dbae63a15da001b2baa317a25149">unistim_line::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00374">chan_unistim.c:374</a></div></div>
<div class="ttc" id="channel_8h_html_acd7d6e4cf3615bf47af84d2e3e47c302"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acd7d6e4cf3615bf47af84d2e3e47c302">ast_channel_string2amaflag</a></div><div class="ttdeci">enum ama_flags ast_channel_string2amaflag(const char *flag)</div><div class="ttdoc">Convert a string to a detail record AMA flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04405">channel.c:4405</a></div></div>
<div class="ttc" id="structast__ha_html"><div class="ttname"><a href="../../dc/d1d/structast__ha.html">ast_ha</a></div><div class="ttdoc">internal representation of ACL entries In principle user applications would have no need for this...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d59/acl_8h_source.html#l00051">acl.h:51</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a85976cf0d7ba128d7d133f7f599769a9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a85976cf0d7ba128d7d133f7f599769a9">find_language</a></div><div class="ttdeci">static int find_language(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03807">chan_unistim.c:3807</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab85624b64f9bff05f76a443477624c73"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab85624b64f9bff05f76a443477624c73">send_texttitle</a></div><div class="ttdeci">static void send_texttitle(struct unistimsession *pte, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01741">chan_unistim.c:1741</a></div></div>
<div class="ttc" id="structast__party__caller_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_party_caller::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdoc">Caller party ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00421">channel.h:421</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a71535bf985a1a06d548fd73a0a0ec32c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a71535bf985a1a06d548fd73a0a0ec32c">tdesc</a></div><div class="ttdeci">static const char tdesc[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00706">chan_unistim.c:706</a></div></div>
<div class="ttc" id="structunistim__line_html_a1642c75e17632468d17bbf36f8c1e092"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a1642c75e17632468d17bbf36f8c1e092">unistim_line::next</a></div><div class="ttdeci">struct unistim_line * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00386">chan_unistim.c:386</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html">config.h</a></div><div class="ttdoc">Configuration File Parser. </div></div>
<div class="ttc" id="chan__unistim_8c_html_ab0c30b61d9af4a85027d57c02fe1ea8c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab0c30b61d9af4a85027d57c02fe1ea8c">refresh_all_favorite</a></div><div class="ttdeci">static void refresh_all_favorite(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01321">chan_unistim.c:1321</a></div></div>
<div class="ttc" id="structunistim__device_html_a4c7bdf9f74d9bf00ff383bddac67c9e4"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a4c7bdf9f74d9bf00ff383bddac67c9e4">unistim_device::titledefault</a></div><div class="ttdeci">char titledefault[13]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00417">chan_unistim.c:417</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9ac27655594e117ad758f4aa394ff80d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9ac27655594e117ad758f4aa394ff80d">unistim_set_owner</a></div><div class="ttdeci">static void unistim_set_owner(struct unistim_subchannel *sub, struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05827">chan_unistim.c:5827</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5382d1448bfae4a2bc8a20fa4f24f3b8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5382d1448bfae4a2bc8a20fa4f24f3b8">send_tone</a></div><div class="ttdeci">static void send_tone(struct unistimsession *pte, uint16_t tone1, uint16_t tone2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01201">chan_unistim.c:1201</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a42682a7460b489b697d64f9dcb7c907c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a42682a7460b489b697d64f9dcb7c907c">handle_select_language</a></div><div class="ttdeci">static void handle_select_language(struct unistimsession *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03819">chan_unistim.c:3819</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3374c18c05582415bbed43be51d35fd8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3374c18c05582415bbed43be51d35fd8">MUTE_OFF</a></div><div class="ttdeci">#define MUTE_OFF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00147">chan_unistim.c:147</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b49cafa2a3d359a2e865992f551874a"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a></div><div class="ttdeci">static char mailbox[AST_MAX_MAILBOX_UNIQUEID]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">chan_mgcp.c:204</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4db69f10fcb9172b03e00bac243f76f9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4db69f10fcb9172b03e00bac243f76f9">devicelock</a></div><div class="ttdeci">static ast_mutex_t devicelock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00273">chan_unistim.c:273</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4e6e7d24b225c0a6823401b9cfaca82f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4e6e7d24b225c0a6823401b9cfaca82f">start_rtp</a></div><div class="ttdeci">static void start_rtp(struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02847">chan_unistim.c:2847</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac763429f724ac4b2b2fb568e466001b3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac763429f724ac4b2b2fb568e466001b3">packet_recv_firm_version</a></div><div class="ttdeci">static const unsigned char packet_recv_firm_version[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00511">chan_unistim.c:511</a></div></div>
<div class="ttc" id="structunistimsession_html_a88f1b5bf64a7d32bf2d0b39c8d0a459a"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a88f1b5bf64a7d32bf2d0b39c8d0a459a">unistimsession::macaddr</a></div><div class="ttdeci">char macaddr[18]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00472">chan_unistim.c:472</a></div></div>
<div class="ttc" id="structunistim__device_html_a410240f4147986ba91eb78b7512936d0"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a410240f4147986ba91eb78b7512936d0">unistim_device::id</a></div><div class="ttdeci">char id[18]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00401">chan_unistim.c:401</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structunistim__device_html_aab68eaa12f597d4212c56694bb4ee020"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aab68eaa12f597d4212c56694bb4ee020">unistim_device::cwstyle</a></div><div class="ttdeci">signed char cwstyle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00425">chan_unistim.c:425</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="unaligned_8h_html"><div class="ttname"><a href="../../d2/d1e/unaligned_8h.html">unaligned.h</a></div><div class="ttdoc">Handle unaligned data access. </div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6b30f8af6c880e1aca01b91aa13c6ff9">KEY_0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00296">chan_unistim.c:296</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html">features_config.h</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755">AST_CONTROL_OFFHOOK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00284">include/asterisk/frame.h:284</a></div></div>
<div class="ttc" id="structunistimsession_html_abe2b925661f49157337f807579739098"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#abe2b925661f49157337f807579739098">unistimsession::tick_next_ping</a></div><div class="ttdeci">unsigned long tick_next_ping</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00466">chan_unistim.c:466</a></div></div>
<div class="ttc" id="channel_8h_html_a921a2d48faa9ed99a59d33e7aefa7888"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a921a2d48faa9ed99a59d33e7aefa7888">ast_channel_set_rawreadformat</a></div><div class="ttdeci">void ast_channel_set_rawreadformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00828">channel_internal_api.c:828</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acf94e9fb1c35ce01e175e7d1d6d8a6b6"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acf94e9fb1c35ce01e175e7d1d6d8a6b6">send_expansion_icon</a></div><div class="ttdeci">static void send_expansion_icon(unsigned char pos, unsigned char status, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01167">chan_unistim.c:1167</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa8ae764dbb234dfed706721793809433"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa8ae764dbb234dfed706721793809433">packet_send_jitter_buffer_conf</a></div><div class="ttdeci">static const unsigned char packet_send_jitter_buffer_conf[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00599">chan_unistim.c:599</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a877c878794c4d6ad265f3c6e94fecc1d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a877c878794c4d6ad265f3c6e94fecc1d">FAV_ICON_PHONE_BLACK</a></div><div class="ttdeci">#define FAV_ICON_PHONE_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00188">chan_unistim.c:188</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a833a6a7242f366ed7edcc08c0a415639"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a833a6a7242f366ed7edcc08c0a415639">DEFAULT_CODEC</a></div><div class="ttdeci">#define DEFAULT_CODEC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00110">chan_unistim.c:110</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a3978338bfe35df207f003782e428fb0c"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a3978338bfe35df207f003782e428fb0c">ast_rtp_instance_stop</a></div><div class="ttdeci">void ast_rtp_instance_stop(struct ast_rtp_instance *instance)</div><div class="ttdoc">Stop an RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02183">rtp_engine.c:2183</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00297">include/asterisk/frame.h:297</a></div></div>
<div class="ttc" id="structunistim__line_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#adf04f66344e3fb0a6f6a69bf39d19902">unistim_line::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00373">chan_unistim.c:373</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0a07ddd6bbcf44485e01c14c96109482"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a></div><div class="ttdeci">#define ast_config_load(filename, flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">include/asterisk/config.h:179</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810ae78c88108d428cb8066e7a056195f489"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae78c88108d428cb8066e7a056195f489">KEY_7</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00303">chan_unistim.c:303</a></div></div>
<div class="ttc" id="structunistimsession_html_a951d1a9f973867c41fbffb436c178a14"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a951d1a9f973867c41fbffb436c178a14">unistimsession::last_buf_available</a></div><div class="ttdeci">int last_buf_available</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00467">chan_unistim.c:467</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aa9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00309">chan_unistim.c:309</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac9093522267b2f8744df6699f408d3b4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac9093522267b2f8744df6699f408d3b4">public_ip</a></div><div class="ttdeci">static struct sockaddr_in public_ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00258">chan_unistim.c:258</a></div></div>
<div class="ttc" id="format_8h_html_a738c58eca291b71de4422e95bff27400"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cmp(const struct ast_format *format1, const struct ast_format *format2)</div><div class="ttdoc">Compare two formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00201">format.c:201</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a279e2c56f8e7d134934fae508d620cc5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a279e2c56f8e7d134934fae508d620cc5">FAV_BLINK_SLOW</a></div><div class="ttdeci">#define FAV_BLINK_SLOW</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00212">chan_unistim.c:212</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa30bc97cb7b0b5dc8f53986da75558e2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa30bc97cb7b0b5dc8f53986da75558e2">VOLUME_LOW_SPEAKER</a></div><div class="ttdeci">#define VOLUME_LOW_SPEAKER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00143">chan_unistim.c:143</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00038">format.h:38</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aaae05236205e6e83071edbfd457e6065"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aaae05236205e6e83071edbfd457e6065">OUTPUT_HEADPHONE</a></div><div class="ttdeci">#define OUTPUT_HEADPHONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00139">chan_unistim.c:139</a></div></div>
<div class="ttc" id="structunistim__line_html_af0f007b48a9c8cf0629428bd0483e0d1"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#af0f007b48a9c8cf0629428bd0483e0d1">unistim_line::callgroup</a></div><div class="ttdeci">ast_group_t callgroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00380">chan_unistim.c:380</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a74cdd9d732e3e568d87084128ae306d8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a74cdd9d732e3e568d87084128ae306d8">packet_send_ring</a></div><div class="ttdeci">static const unsigned char packet_send_ring[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00584">chan_unistim.c:584</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0da9fdca102338feb1611735a8b6d48c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0da9fdca102338feb1611735a8b6d48c">packet_send_date_time3</a></div><div class="ttdeci">static const unsigned char packet_send_date_time3[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00538">chan_unistim.c:538</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a947428a24530c33b5b0dfe3a4e88e6fb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a947428a24530c33b5b0dfe3a4e88e6fb">OUTPUT_HANDSET</a></div><div class="ttdeci">#define OUTPUT_HANDSET</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00138">chan_unistim.c:138</a></div></div>
<div class="ttc" id="channel_8h_html"><div class="ttname"><a href="../../d5/d7b/channel_8h.html">channel.h</a></div><div class="ttdoc">General Asterisk PBX channel definitions. </div></div>
<div class="ttc" id="chan__unistim_8c_html_a59d73f6a31546fd8a60b6e3939ba747c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a59d73f6a31546fd8a60b6e3939ba747c">DEVICE_NAME_LEN</a></div><div class="ttdeci">#define DEVICE_NAME_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00112">chan_unistim.c:112</a></div></div>
<div class="ttc" id="channel_8h_html_a0c25448e9c6e2630a8a9cc96b7482cfe"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a0c25448e9c6e2630a8a9cc96b7482cfe">ast_channel_rings_set</a></div><div class="ttdeci">void ast_channel_rings_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00457">channel_internal_api.c:457</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3e69e3bafe7f929bdbc5ff930d50f8b0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3e69e3bafe7f929bdbc5ff930d50f8b0">send_idle_clock</a></div><div class="ttdeci">static void send_idle_clock(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01757">chan_unistim.c:1757</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a9ff41b61938f3d4dc4c82db103e7914ca0f994311315c8d856b8298bc22f7e007"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a9ff41b61938f3d4dc4c82db103e7914ca0f994311315c8d856b8298bc22f7e007">AST_RTP_PROPERTY_NAT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00115">rtp_engine.h:115</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa202d63f744ac6fc728ee8ea937e4d7b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa202d63f744ac6fc728ee8ea937e4d7b">unistim_request</a></div><div class="ttdeci">static struct ast_channel * unistim_request(const char *type, struct ast_format_cap *cap, const struct ast_assigned_ids *assignedids, const struct ast_channel *requestor, const char *dest, int *cause)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05956">chan_unistim.c:5956</a></div></div>
<div class="ttc" id="paths_8h_html"><div class="ttname"><a href="../../dd/df2/paths_8h.html">paths.h</a></div><div class="ttdoc">Asterisk file paths, configured in asterisk.conf. </div></div>
<div class="ttc" id="io_8h_html_a5409251fbead35b5e59fe322e14446b9"><div class="ttname"><a href="../../dc/dac/io_8h.html#a5409251fbead35b5e59fe322e14446b9">io_context_destroy</a></div><div class="ttdeci">void io_context_destroy(struct io_context *ioc)</div><div class="ttdoc">Destroys a context. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/io_8c_source.html#l00107">io.c:107</a></div></div>
<div class="ttc" id="netsock2_8h_html_ad68264a6784dc22570eda3cb447307f8"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#ad68264a6784dc22570eda3cb447307f8">ast_sockaddr_from_sin</a></div><div class="ttdeci">#define ast_sockaddr_from_sin(addr, sin)</div><div class="ttdoc">Converts a struct sockaddr_in to a struct ast_sockaddr. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00782">netsock2.h:782</a></div></div>
<div class="ttc" id="channel_8h_html_a9107a83365cbf327cc0d12cb0dbd28d8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9107a83365cbf327cc0d12cb0dbd28d8">ast_set_read_format</a></div><div class="ttdeci">int ast_set_read_format(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdoc">Sets read format on channel chan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05849">channel.c:5849</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structunistim__device_html_a20fe18096288ecc16a7fe0588e33bb5f"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a20fe18096288ecc16a7fe0588e33bb5f">unistim_device::to_delete</a></div><div class="ttdeci">signed char to_delete</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00449">chan_unistim.c:449</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a85a1013fb2939c26b2cf9f58d9358b76"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a85a1013fb2939c26b2cf9f58d9358b76">packet_send_stop_timer</a></div><div class="ttdeci">static const unsigned char packet_send_stop_timer[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00643">chan_unistim.c:643</a></div></div>
<div class="ttc" id="structast__tone__zone_html"><div class="ttname"><a href="../../dd/d77/structast__tone__zone.html">ast_tone_zone</a></div><div class="ttdoc">A set of tones for a given locale. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00074">indications.h:74</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a741a9726b536ff19cd1c974464da4d28"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a741a9726b536ff19cd1c974464da4d28">LED_MUTE_OFF</a></div><div class="ttdeci">#define LED_MUTE_OFF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00163">chan_unistim.c:163</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="channel_8h_html_a3c9c29fb2bc2b715fee335c1ffa50449"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3c9c29fb2bc2b715fee335c1ffa50449">ast_channel_nativeformats_set</a></div><div class="ttdeci">void ast_channel_nativeformats_set(struct ast_channel *chan, struct ast_format_cap *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00677">channel_internal_api.c:677</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8c8112dd258fef6c1ac58343f42aa3db"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8c8112dd258fef6c1ac58343f42aa3db">DEFAULTCALLERNAME</a></div><div class="ttdeci">#define DEFAULTCALLERNAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00085">chan_unistim.c:85</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4b3c8e741c771344c29ae89363504b99"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4b3c8e741c771344c29ae89363504b99">send_charset_update</a></div><div class="ttdeci">static void send_charset_update(struct unistimsession *pte, int charset)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01869">chan_unistim.c:1869</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga920b9d3e484257c7e593452a8e36d8d4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga920b9d3e484257c7e593452a8e36d8d4">ast_channel_stage_snapshot_done</a></div><div class="ttdeci">void ast_channel_stage_snapshot_done(struct ast_channel *chan)</div><div class="ttdoc">Clear flag to indicate channel snapshot is being staged, and publish snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01043">stasis_channels.c:1043</a></div></div>
<div class="ttc" id="channel_8h_html_a10f23f1907b804485f62973f66cd9aef"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a></div><div class="ttdeci">struct ast_party_connected_line * ast_channel_connected(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00892">channel_internal_api.c:892</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a51f7454e597b6aeff9686f0551866219"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a51f7454e597b6aeff9686f0551866219">DEFAULTCALLERID</a></div><div class="ttdeci">#define DEFAULTCALLERID</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00084">chan_unistim.c:84</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abed2be4cc4862534d9eeb3aa75f9e19a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abed2be4cc4862534d9eeb3aa75f9e19a">packet_send_favorite</a></div><div class="ttdeci">static const unsigned char packet_send_favorite[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00654">chan_unistim.c:654</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab0a267a38c194073f7bf6dc1c5b97011"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab0a267a38c194073f7bf6dc1c5b97011">reload_config</a></div><div class="ttdeci">static int reload_config(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06846">chan_unistim.c:6846</a></div></div>
<div class="ttc" id="lock_8h_html_a6009440c7a72f8e2e3b1ec97641ad160"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a></div><div class="ttdeci">#define AST_PTHREADT_NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00066">lock.h:66</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00031">codec.h:31</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab5e95f44b56357e008b9da5335b5495e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab5e95f44b56357e008b9da5335b5495e">unistim_alloc_sub</a></div><div class="ttdeci">static struct unistim_subchannel * unistim_alloc_sub(struct unistim_device *d, int x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01988">chan_unistim.c:1988</a></div></div>
<div class="ttc" id="causes_8h_html_aa71419a0c598e31312477c5a644e7440"><div class="ttname"><a href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a></div><div class="ttdeci">#define AST_CAUSE_ANSWERED_ELSEWHERE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00113">causes.h:113</a></div></div>
<div class="ttc" id="structunistim__device_html_ac371929886e58d7fafb79ad656d6e6ec"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ac371929886e58d7fafb79ad656d6e6ec">unistim_device::next</a></div><div class="ttdeci">struct unistim_device * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00455">chan_unistim.c:455</a></div></div>
<div class="ttc" id="acl_8h_html"><div class="ttname"><a href="../../d5/d59/acl_8h.html">acl.h</a></div><div class="ttdoc">Access Control of various sorts. </div></div>
<div class="ttc" id="chan__unistim_8c_html_aad7004f288ce5d6ec1af2b1241f26549"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aad7004f288ce5d6ec1af2b1241f26549">SIZE_HEADER</a></div><div class="ttdeci">#define SIZE_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00167">chan_unistim.c:167</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a06f07386f6a7b104969cefd3cdfd6201"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a06f07386f6a7b104969cefd3cdfd6201">KEY_QUIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00312">chan_unistim.c:312</a></div></div>
<div class="ttc" id="codec_8c_html_a26d06e92c695d54e16beb8070dc5461d"><div class="ttname"><a href="../../d5/def/codec_8c.html#a26d06e92c695d54e16beb8070dc5461d">codecs</a></div><div class="ttdeci">static struct ao2_container * codecs</div><div class="ttdoc">Registered codecs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00048">codec.c:48</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad09fa931f468002152a3cc2d5ce25eae"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a></div><div class="ttdeci">static int unload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07153">chan_unistim.c:7153</a></div></div>
<div class="ttc" id="astobj2_8h_html"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html">astobj2.h</a></div></div>
<div class="ttc" id="structio__context_html"><div class="ttname"><a href="../../d5/d55/structio__context.html">io_context</a></div><div class="ttdoc">Global IO variables are now in a struct in order to be made threadsafe. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/io_8c_source.html#l00071">io.c:71</a></div></div>
<div class="ttc" id="channel_8h_html_af4e59494f74ad9e0c50170d9e276ad31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a></div><div class="ttdeci">#define AST_MAX_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00135">channel.h:135</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a965a6de0f60b8b10a4e41cf36b608761"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a965a6de0f60b8b10a4e41cf36b608761">get_to_address</a></div><div class="ttdeci">static int get_to_address(int fd, struct sockaddr_in *toAddr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01002">chan_unistim.c:1002</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="causes_8h_html_af2235eb1c27925e4020ce286255d165f"><div class="ttname"><a href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a></div><div class="ttdeci">#define AST_CAUSE_NORMAL_CLEARING</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00105">causes.h:105</a></div></div>
<div class="ttc" id="structunistim__device_html_ac06af3847fd7f1ad0d33d1f9c29adc73"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ac06af3847fd7f1ad0d33d1f9c29adc73">unistim_device::session</a></div><div class="ttdeci">struct unistimsession * session</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00454">chan_unistim.c:454</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a6c9398ee8989239124295d096a87bf32"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a6c9398ee8989239124295d096a87bf32">AST_FRAME_IMAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00116">include/asterisk/frame.h:116</a></div></div>
<div class="ttc" id="structast__tm_html_ada983deda100b604bee5716512453658"><div class="ttname"><a href="../../d5/d84/structast__tm.html#ada983deda100b604bee5716512453658">ast_tm::tm_mon</a></div><div class="ttdeci">int tm_mon</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00040">localtime.h:40</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa6a59af432901323fefcc549eb69a614"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa6a59af432901323fefcc549eb69a614">key_select_extension</a></div><div class="ttdeci">static void key_select_extension(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03890">chan_unistim.c:3890</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aab4f7f5bd236a41e188c6b46e9b1d535"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aab4f7f5bd236a41e188c6b46e9b1d535">NB_MAX_RETRANSMIT</a></div><div class="ttdeci">#define NB_MAX_RETRANSMIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00099">chan_unistim.c:99</a></div></div>
<div class="ttc" id="structextension_html"><div class="ttname"><a href="../../d0/d5a/structextension.html">extension</a></div><div class="ttdoc">structure to hold extensions </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00287">res_phoneprov.c:287</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="channel_8h_html_ab3786cbbff7a03241fc75dafa0c8a1c1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab3786cbbff7a03241fc75dafa0c8a1c1">ast_channel_set_readformat</a></div><div class="ttdeci">void ast_channel_set_readformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00836">channel_internal_api.c:836</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2d8d5920e90ccbad7832926becdadb29"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a></div><div class="ttdeci">static struct ast_jb_conf default_jbconf</div><div class="ttdoc">Global jitterbuffer configuration - by default, jb is disabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00227">chan_unistim.c:227</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="structunistim__line_html_ac81f44f4f22dee90de5975cf8fa4641b"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#ac81f44f4f22dee90de5975cf8fa4641b">unistim_line::mailbox</a></div><div class="ttdeci">char mailbox[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00378">chan_unistim.c:378</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aee6fd6d642f3eb408898cc1992f9de93"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aee6fd6d642f3eb408898cc1992f9de93">FAV_ICON_NONE</a></div><div class="ttdeci">#define FAV_ICON_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00177">chan_unistim.c:177</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a7e4a1e2ba15fde8b1110631563d2c082">KEY_SNDHIST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00331">chan_unistim.c:331</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aaf76ed161526f803cb02a4595b5ee348"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aaf76ed161526f803cb02a4595b5ee348">show_phone_number</a></div><div class="ttdeci">static void show_phone_number(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02944">chan_unistim.c:2944</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a240fa2ebaa98bd76495b1cefde05660a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a240fa2ebaa98bd76495b1cefde05660a">control2str</a></div><div class="ttdeci">static char * control2str(int ind)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05279">chan_unistim.c:5279</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a345795611c252caa3f8b048920945a71"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a345795611c252caa3f8b048920945a71">unistim_keepalive</a></div><div class="ttdeci">static int unistim_keepalive</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00246">chan_unistim.c:246</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adeec5e592cce912fd10a66b80111b587">KEY_HEADPHN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00321">chan_unistim.c:321</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="indications_8h_html_a8b52ace68f21c0ac24414f038471647d"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a8b52ace68f21c0ac24414f038471647d">ast_tone_zone_sound_unref</a></div><div class="ttdeci">static struct ast_tone_zone_sound * ast_tone_zone_sound_unref(struct ast_tone_zone_sound *ts)</div><div class="ttdoc">Release a reference to an ast_tone_zone_sound. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00227">indications.h:227</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6835f3677979aab6bd641a8b9188a3e2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6835f3677979aab6bd641a8b9188a3e2">packet_send_query_basic_manager_04</a></div><div class="ttdeci">static const unsigned char packet_send_query_basic_manager_04[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00696">chan_unistim.c:696</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad4e1b5f816e1bbf143f8920cd2d11cd8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad4e1b5f816e1bbf143f8920cd2d11cd8">USTM_LANG_DIR</a></div><div class="ttdeci">#define USTM_LANG_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00088">chan_unistim.c:88</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5af8f4c54c37e8214ad15be324e14bde"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5af8f4c54c37e8214ad15be324e14bde">MAX_ENTRY_LOG</a></div><div class="ttdeci">#define MAX_ENTRY_LOG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00114">chan_unistim.c:114</a></div></div>
<div class="ttc" id="structunistim__menu__item_html_acf60de4c64d60c1b9449c056bc6bfcf7"><div class="ttname"><a href="../../d3/df2/structunistim__menu__item.html#acf60de4c64d60c1b9449c056bc6bfcf7">unistim_menu_item::label</a></div><div class="ttdeci">char * label</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00482">chan_unistim.c:482</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0b1e16219ab9f169233a59be2ccea59a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0b1e16219ab9f169233a59be2ccea59a">get_avail_softkey</a></div><div class="ttdeci">static int get_avail_softkey(struct unistimsession *pte, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01385">chan_unistim.c:1385</a></div></div>
<div class="ttc" id="structunistim__device_html_a8e02569adc3b742182f7c3249433237e"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a8e02569adc3b742182f7c3249433237e">unistim_device::nextmsgcheck</a></div><div class="ttdeci">time_t nextmsgcheck</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00445">chan_unistim.c:445</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a89cafe5556daf9e312fdfcc90091057e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a89cafe5556daf9e312fdfcc90091057e">handle_dial_page</a></div><div class="ttdeci">static void handle_dial_page(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02983">chan_unistim.c:2983</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_adf416dc058363e2fd5750c77e2d78bee"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#adf416dc058363e2fd5750c77e2d78bee">language</a></div><div class="ttdeci">static char language[MAX_LANGUAGE]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00117">chan_alsa.c:117</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab5daefc58bff9275e962b82ddf0cb72a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab5daefc58bff9275e962b82ddf0cb72a">unistim_sendtext</a></div><div class="ttdeci">static int unistim_sendtext(struct ast_channel *ast, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05536">chan_unistim.c:5536</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structunistim__device_html_a5292df700ff59a61858e21147a5fc7b6"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a5292df700ff59a61858e21147a5fc7b6">unistim_device::cwvolume</a></div><div class="ttdeci">signed char cwvolume</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00424">chan_unistim.c:424</a></div></div>
<div class="ttc" id="structast__sched__context_html"><div class="ttname"><a href="../../d7/de8/structast__sched__context.html">ast_sched_context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00109">sched.c:109</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abfa5303484ccd84c03150a1b69f072b2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abfa5303484ccd84c03150a1b69f072b2">TEXT_LINE0</a></div><div class="ttdeci">#define TEXT_LINE0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00170">chan_unistim.c:170</a></div></div>
<div class="ttc" id="channel_8h_html_abbdfb98077180544657b2d16c5d25f74"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a></div><div class="ttdeci">int ast_set_write_format(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdoc">Sets write format on channel chan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05890">channel.c:5890</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9a202389ce76e2c9a3a6ec4883bacb6e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9a202389ce76e2c9a3a6ec4883bacb6e">packet_send_open_audio_stream_tx3</a></div><div class="ttdeci">static const unsigned char packet_send_open_audio_stream_tx3[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00626">chan_unistim.c:626</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aeea3959d8ffd22e3b16a5a84ab5f8f36"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aeea3959d8ffd22e3b16a5a84ab5f8f36">unistim_free_sub</a></div><div class="ttdeci">static int unistim_free_sub(struct unistim_subchannel *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01979">chan_unistim.c:1979</a></div></div>
<div class="ttc" id="structunistim__device_html_af1f4196906994f097a6b1ac17212953e"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#af1f4196906994f097a6b1ac17212953e">unistim_device::maintext0</a></div><div class="ttdeci">char maintext0[25]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00414">chan_unistim.c:414</a></div></div>
<div class="ttc" id="channel_8h_html_aee83e23058d0a4111fda1f506cbda107"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aee83e23058d0a4111fda1f506cbda107">ast_get_group</a></div><div class="ttdeci">ast_group_t ast_get_group(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07718">channel.c:7718</a></div></div>
<div class="ttc" id="structast__tm_html_a02048604d30b880033311cf542d63f92"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a02048604d30b880033311cf542d63f92">ast_tm::tm_mday</a></div><div class="ttdeci">int tm_mday</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00039">localtime.h:39</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a321595f065c4787f1bd0828b348ac4f5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a321595f065c4787f1bd0828b348ac4f5">LED_MUTE_ON</a></div><div class="ttdeci">#define LED_MUTE_ON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00164">chan_unistim.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a592d9902de64351868e97b8e804a3e6f">KEY_FAV3</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00326">chan_unistim.c:326</a></div></div>
<div class="ttc" id="structunistim__device_html_a8d16678ec2b21278191c47d2c704e0a3"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a8d16678ec2b21278191c47d2c704e0a3">unistim_device::interdigit_timer</a></div><div class="ttdeci">int interdigit_timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00426">chan_unistim.c:426</a></div></div>
<div class="ttc" id="structunistim__device_html_ab262ee593568f2d4d4157ad105c3b98c"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ab262ee593568f2d4d4157ad105c3b98c">unistim_device::tz</a></div><div class="ttdeci">struct ast_tone_zone * tz</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00421">chan_unistim.c:421</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8ee52b2a38c165212d4e0beecf2a4740"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8ee52b2a38c165212d4e0beecf2a4740">FAV_LINE_ICON</a></div><div class="ttdeci">#define FAV_LINE_ICON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00218">chan_unistim.c:218</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77b08a22116d7b099d6598b10e5cbd2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77b08a22116d7b099d6598b10e5cbd2">send_month_labels</a></div><div class="ttdeci">static void send_month_labels(struct unistimsession *pte, int month)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01762">chan_unistim.c:1762</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a34bc024bcf888167e8df34925870f57d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a34bc024bcf888167e8df34925870f57d">key_select_option</a></div><div class="ttdeci">static void key_select_option(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03702">chan_unistim.c:3702</a></div></div>
<div class="ttc" id="pbx_8h_html_a64a5b8fdc919806135ad427aca9e71b7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a></div><div class="ttdeci">int ast_exists_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Determine whether an extension exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04179">pbx.c:4179</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9638a2ee84abf17fcc8ba8e884790de5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9638a2ee84abf17fcc8ba8e884790de5">lang_cmp_fn</a></div><div class="ttdeci">static int lang_cmp_fn(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00792">chan_unistim.c:792</a></div></div>
<div class="ttc" id="structunistim__device_html_ad3af117a28948d46d18d787129016d7e"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ad3af117a28948d46d18d787129016d7e">unistim_device::hasexp</a></div><div class="ttdeci">int hasexp</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00403">chan_unistim.c:403</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a4f2fb6c08b3697d011cf613c8b68054c"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054c">ast_rtp_glue_result</a></div><div class="ttdeci">ast_rtp_glue_result</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00158">rtp_engine.h:158</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6b8d4cf786254045eadadaa6709dc979"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6b8d4cf786254045eadadaa6709dc979">send_favorite_short</a></div><div class="ttdeci">static void send_favorite_short(unsigned char pos, unsigned char status, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01294">chan_unistim.c:1294</a></div></div>
<div class="ttc" id="channel_8h_html_ab2e0a6897707b1102ad453ea0963999f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab2e0a6897707b1102ad453ea0963999f">ast_queue_hold</a></div><div class="ttdeci">int ast_queue_hold(struct ast_channel *chan, const char *musicclass)</div><div class="ttdoc">Queue a hold frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01191">channel.c:1191</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5c438e031784d5c35d517872b5f6db64"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5c438e031784d5c35d517872b5f6db64">FAV_ICON_SPEAKER_ONHOLD_BLACK</a></div><div class="ttdeci">#define FAV_ICON_SPEAKER_ONHOLD_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00190">chan_unistim.c:190</a></div></div>
<div class="ttc" id="structast__channel__tech_html"><div class="ttname"><a href="../../d4/d85/structast__channel__tech.html">ast_channel_tech</a></div><div class="ttdoc">Structure to describe a channel &quot;technology&quot;, ie a channel driver See for examples: ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00629">channel.h:629</a></div></div>
<div class="ttc" id="structunistim__device_html_a7ef42aa41fc6f1f39c513ceb034fe467"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a7ef42aa41fc6f1f39c513ceb034fe467">unistim_device::status_method</a></div><div class="ttdeci">int status_method</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00431">chan_unistim.c:431</a></div></div>
<div class="ttc" id="channel_8h_html_aed40a28831fcb5791cd63c1b8761d659"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aed40a28831fcb5791cd63c1b8761d659">ast_channel_adsicpe_set</a></div><div class="ttdeci">void ast_channel_adsicpe_set(struct ast_channel *chan, enum ast_channel_adsicpe value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00785">channel_internal_api.c:785</a></div></div>
<div class="ttc" id="netsock2_8h_html"><div class="ttname"><a href="../../db/df1/netsock2_8h.html">netsock2.h</a></div><div class="ttdoc">Network socket handling. </div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="channel_8h_html_a6cbcba5661d55216968cde8fdf913c89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a></div><div class="ttdeci">int ast_queue_frame(struct ast_channel *chan, struct ast_frame *f)</div><div class="ttdoc">Queue one or more frames to a channel&amp;#39;s frame queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01139">channel.c:1139</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa453a7434dac6cfa107bddf8d253e7ac"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa453a7434dac6cfa107bddf8d253e7ac">FAV_BLINK_FAST</a></div><div class="ttdeci">#define FAV_BLINK_FAST</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00211">chan_unistim.c:211</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="structunistim__device_html_a41f7bf7629067d8d8078c208b2bfbf48"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a41f7bf7629067d8d8078c208b2bfbf48">unistim_device::extension</a></div><div class="ttdeci">enum autoprov_extn extension</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00447">chan_unistim.c:447</a></div></div>
<div class="ttc" id="structunistim__line_html_a29e973bd94bfbaf59d939bd1bc988c32"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a29e973bd94bfbaf59d939bd1bc988c32">unistim_line::cid_num</a></div><div class="ttdeci">char cid_num[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00377">chan_unistim.c:377</a></div></div>
<div class="ttc" id="structunistim__line_html_abc34958c9b03014779727e5ca61b93e5"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#abc34958c9b03014779727e5ca61b93e5">unistim_line::musicclass</a></div><div class="ttdeci">char musicclass[MAX_MUSICCLASS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00379">chan_unistim.c:379</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a33363b0e7457c82cb0aef3b8c10cad5e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a33363b0e7457c82cb0aef3b8c10cad5e">create_client</a></div><div class="ttdeci">static struct unistimsession * create_client(const struct sockaddr_in *addr_from)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01046">chan_unistim.c:1046</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4e999210eafaaa2ac9c550866ec34d2b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4e999210eafaaa2ac9c550866ec34d2b">FAV_ICON_SPEAKER_ONHOOK_BLACK</a></div><div class="ttdeci">#define FAV_ICON_SPEAKER_ONHOOK_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00180">chan_unistim.c:180</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_afa3f233589259f41033dc33fb22abe08"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#afa3f233589259f41033dc33fb22abe08">unistim_do_senddigit</a></div><div class="ttdeci">static int unistim_do_senddigit(struct unistimsession *pte, char digit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03356">chan_unistim.c:3356</a></div></div>
<div class="ttc" id="structunistim__device_html_a269c655be93d2495a99a671600cde604"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a269c655be93d2495a99a671600cde604">unistim_device::nextdial</a></div><div class="ttdeci">time_t nextdial</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00428">chan_unistim.c:428</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aadb439aa14359fe7f5799893683ef42c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aadb439aa14359fe7f5799893683ef42c">send_stop_timer</a></div><div class="ttdeci">static void send_stop_timer(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01137">chan_unistim.c:1137</a></div></div>
<div class="ttc" id="network_8h_html"><div class="ttname"><a href="../../d9/d94/network_8h.html">network.h</a></div><div class="ttdoc">Wrapper for network related headers, masking differences between various operating systems...</div></div>
<div class="ttc" id="chan__unistim_8c_html_ad99329ea1d90e83ad194250726f07947"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad99329ea1d90e83ad194250726f07947">ignore_call</a></div><div class="ttdeci">static void ignore_call(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02641">chan_unistim.c:2641</a></div></div>
<div class="ttc" id="sched_8h_html_a5baecc149aeabdbef9b3ed6780c1c4a6"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a5baecc149aeabdbef9b3ed6780c1c4a6">ast_sched_context_create</a></div><div class="ttdeci">struct ast_sched_context * ast_sched_context_create(void)</div><div class="ttdoc">Create a scheduler context. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00236">sched.c:236</a></div></div>
<div class="ttc" id="structunistim__device_html_a0f985ca51cc4b2f72f36199cfe03a7a7"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a0f985ca51cc4b2f72f36199cfe03a7a7">unistim_device::size_phone_number</a></div><div class="ttdeci">int size_phone_number</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00397">chan_unistim.c:397</a></div></div>
<div class="ttc" id="structvolume_html"><div class="ttname"><a href="../../da/d4c/structvolume.html">volume</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l00890">app_meetme.c:890</a></div></div>
<div class="ttc" id="channel_8h_html_a3e3e7e66e65ad9cdba2299e36b13e173"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3e3e7e66e65ad9cdba2299e36b13e173">ast_channel_fdno</a></div><div class="ttdeci">int ast_channel_fdno(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00419">channel_internal_api.c:419</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7e1a8838d8e2d004bd308050337a8f8f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7e1a8838d8e2d004bd308050337a8f8f">send_favorite</a></div><div class="ttdeci">static void send_favorite(unsigned char pos, unsigned char status, struct unistimsession *pte, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01273">chan_unistim.c:1273</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad7c4d05cfcec876d995f327336142f79"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad7c4d05cfcec876d995f327336142f79">packet_send_status2</a></div><div class="ttdeci">static const unsigned char packet_send_status2[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00673">chan_unistim.c:673</a></div></div>
<div class="ttc" id="channel_8h_html_a2a2e0ff24c57491a877cac39cb670024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2a2e0ff24c57491a877cac39cb670024">ast_channel_start_silence_generator</a></div><div class="ttdeci">struct ast_silence_generator * ast_channel_start_silence_generator(struct ast_channel *chan)</div><div class="ttdoc">Starts a silence generator on the given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08266">channel.c:8266</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abaabcb7f4349cc632dde3af5c6a5e1bd"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a></div><div class="ttdeci">static struct ast_jb_conf global_jbconf</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00235">chan_unistim.c:235</a></div></div>
<div class="ttc" id="structunistim__languages_html_ad1b45f33065aae3c757f56a692b25741"><div class="ttname"><a href="../../d1/d7e/structunistim__languages.html#ad1b45f33065aae3c757f56a692b25741">unistim_languages::encoding</a></div><div class="ttdeci">int encoding</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00491">chan_unistim.c:491</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aba890d62815801e923269e0bf18117d5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aba890d62815801e923269e0bf18117d5">subtype_tostr</a></div><div class="ttdeci">static const char * subtype_tostr(const int type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02027">chan_unistim.c:2027</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf195fcf1686408b5e52ad76996653cea"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf195fcf1686408b5e52ad76996653cea">ast_channel_stage_snapshot</a></div><div class="ttdeci">void ast_channel_stage_snapshot(struct ast_channel *chan)</div><div class="ttdoc">Set flag to indicate channel snapshot is being staged. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01038">stasis_channels.c:1038</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a0848a442d907968b211b97bc2bd88acd">KEY_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00308">chan_unistim.c:308</a></div></div>
<div class="ttc" id="structunistim__device_html_a6c3d685ebae8b4b771adcaf7662a943c"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a6c3d685ebae8b4b771adcaf7662a943c">unistim_device::missed_call</a></div><div class="ttdeci">int missed_call</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00433">chan_unistim.c:433</a></div></div>
<div class="ttc" id="structunistim__device_html_a029e41033707ddf7f357c648a3eeb204"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a029e41033707ddf7f357c648a3eeb204">unistim_device::lastmsgssent</a></div><div class="ttdeci">int lastmsgssent</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00444">chan_unistim.c:444</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structunistim__device_html_a49834b69ca36a0a62119bce86d92eb5b"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a49834b69ca36a0a62119bce86d92eb5b">unistim_device::country</a></div><div class="ttdeci">char country[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00420">chan_unistim.c:420</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3f335e3e51c36b21ee50335da3dd29fa"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3f335e3e51c36b21ee50335da3dd29fa">packet_send_charset_iso_2022_jp</a></div><div class="ttdeci">static const unsigned char packet_send_charset_iso_2022_jp[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00691">chan_unistim.c:691</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aab18ceec98810963aad50a106b4a1412"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aab18ceec98810963aad50a106b4a1412">send_text_status</a></div><div class="ttdeci">static void send_text_status(struct unistimsession *pte, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01604">chan_unistim.c:1604</a></div></div>
<div class="ttc" id="pickup_8h_html_a4890be42c2add5f52028705d6bc02201"><div class="ttname"><a href="../../dd/dbc/pickup_8h.html#a4890be42c2add5f52028705d6bc02201">ast_pickup_call</a></div><div class="ttdeci">int ast_pickup_call(struct ast_channel *chan)</div><div class="ttdoc">Pickup a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbf/pickup_8c_source.html#l00200">pickup.c:200</a></div></div>
<div class="ttc" id="strings_8h_html_a387a69b3871ca31061566a73f45d20f4"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a></div><div class="ttdeci">int attribute_pure ast_true(const char *val)</div><div class="ttdoc">Make sure something is true. Determine if a string containing a boolean value is &quot;true&quot;. This function checks to see whether a string passed to it is an indication of an &quot;true&quot; value. It checks to see if the string is &quot;yes&quot;, &quot;true&quot;, &quot;y&quot;, &quot;t&quot;, &quot;on&quot; or &quot;1&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01951">main/utils.c:1951</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a1e50ad2c3c4daa7a13a22482ec93524f">EXTENSION_ASK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00132">chan_unistim.c:132</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a777efd0e4ab66f2d2ae8bb6a3fbbec5e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a777efd0e4ab66f2d2ae8bb6a3fbbec5e">packet_send_call</a></div><div class="ttdeci">static const unsigned char packet_send_call[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00558">chan_unistim.c:558</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8711751e9c6743e11a3862de504cf65a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8711751e9c6743e11a3862de504cf65a">FAV_ICON_CALL_CENTER</a></div><div class="ttdeci">#define FAV_ICON_CALL_CENTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00198">chan_unistim.c:198</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a4f2fb6c08b3697d011cf613c8b68054ca6b70d26095905cd6bd5ddffc01d81843"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054ca6b70d26095905cd6bd5ddffc01d81843">AST_RTP_GLUE_RESULT_FORBID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00160">rtp_engine.h:160</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">include/asterisk/frame.h:278</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_afdfaa9c2d7a29ed1723f24a426d2dbd0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#afdfaa9c2d7a29ed1723f24a426d2dbd0">packet_send_no_ring</a></div><div class="ttdeci">static const unsigned char packet_send_no_ring[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00549">chan_unistim.c:549</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0fca4819ce3044be21fb24b818ae0b30"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0fca4819ce3044be21fb24b818ae0b30">packet_recv_resume_connection_with_server</a></div><div class="ttdeci">static const unsigned char packet_recv_resume_connection_with_server[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00533">chan_unistim.c:533</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a35bcc2bc85513df4f3897a9d64a9c51c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a35bcc2bc85513df4f3897a9d64a9c51c">KEY_1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00297">chan_unistim.c:297</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a88e009e2bd5d179615c0a6384db004fc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a88e009e2bd5d179615c0a6384db004fc">packet_recv_hangup</a></div><div class="ttdeci">static const unsigned char packet_recv_hangup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00519">chan_unistim.c:519</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aed864c0209ba46546ba112f6c36e0cc4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aed864c0209ba46546ba112f6c36e0cc4">KEY_5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00301">chan_unistim.c:301</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="structunistim__device_html_aed48ca0bcd2162fd4fd495873e2631f5"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aed48ca0bcd2162fd4fd495873e2631f5">unistim_device::volume</a></div><div class="ttdeci">int volume</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00441">chan_unistim.c:441</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab0650a3e8232535ccd26d28b9957bc6c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab0650a3e8232535ccd26d28b9957bc6c">DEFAULT_INTERDIGIT_TIMER</a></div><div class="ttdeci">#define DEFAULT_INTERDIGIT_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00107">chan_unistim.c:107</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a77351a5e3502d3a4f5eb0d1f7882a906"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a77351a5e3502d3a4f5eb0d1f7882a906">show_main_page</a></div><div class="ttdeci">static void show_main_page(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04109">chan_unistim.c:4109</a></div></div>
<div class="ttc" id="pbx__dundi_8c_html_a03e72b5f331070bc01418a74af199eb9"><div class="ttname"><a href="../../d1/dc0/pbx__dundi_8c.html#a03e72b5f331070bc01418a74af199eb9">country</a></div><div class="ttdeci">static char country[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc0/pbx__dundi_8c_source.html#l00205">pbx_dundi.c:205</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">include/asterisk/frame.h:299</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a01bd47c216c3d26eb96d07bc03b468bd"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a01bd47c216c3d26eb96d07bc03b468bd">packet_recv_pressed_key</a></div><div class="ttdeci">static const unsigned char packet_recv_pressed_key[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00515">chan_unistim.c:515</a></div></div>
<div class="ttc" id="netsock2_8h_html_a9e06776a6cd2ae9f2780a445053a6864"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#a9e06776a6cd2ae9f2780a445053a6864">ast_set_qos</a></div><div class="ttdeci">int ast_set_qos(int sockfd, int tos, int cos, const char *desc)</div><div class="ttdoc">Set type of service. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d27/netsock2_8c_source.html#l00621">netsock2.c:621</a></div></div>
<div class="ttc" id="cdr__pgsql_8c_html_afcc6d32094cfa01ee935b17325f48d4b"><div class="ttname"><a href="../../dd/d22/cdr__pgsql_8c.html#afcc6d32094cfa01ee935b17325f48d4b">tz</a></div><div class="ttdeci">static char * tz</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d22/cdr__pgsql_8c_source.html#l00075">cdr_pgsql.c:75</a></div></div>
<div class="ttc" id="indications_8h_html_a52513ad3507d90dc2baf7cfec7b201a7"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a52513ad3507d90dc2baf7cfec7b201a7">ast_get_indication_zone</a></div><div class="ttdeci">struct ast_tone_zone * ast_get_indication_zone(const char *country)</div><div class="ttdoc">locate ast_tone_zone </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6e/indications_8c_source.html#l00433">indications.c:433</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a90c48c7f24206e8822bf520dae0a2478"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a90c48c7f24206e8822bf520dae0a2478">ast_rtp_instance_set_remote_address</a></div><div class="ttdeci">#define ast_rtp_instance_set_remote_address(instance, address)</div><div class="ttdoc">Set the address of the remote endpoint that we are sending RTP to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l01080">rtp_engine.h:1080</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a30270c1b689ffac87839e3e04fb96dd1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a30270c1b689ffac87839e3e04fb96dd1">key_history</a></div><div class="ttdeci">static void key_history(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04294">chan_unistim.c:4294</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structunistim__device_html_aa60b06ad611940d587d4acece5bcf69d"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#aa60b06ad611940d587d4acece5bcf69d">unistim_device::softkeydevice</a></div><div class="ttdeci">char softkeydevice[FAVNUM][16]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00408">chan_unistim.c:408</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structast__tone__zone__sound_html"><div class="ttname"><a href="../../d5/dab/structast__tone__zone__sound.html">ast_tone_zone_sound</a></div><div class="ttdoc">Description of a tone. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00035">indications.h:35</a></div></div>
<div class="ttc" id="indications_8h_html_a516be2823557000dcd4be685a44d1d09"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a516be2823557000dcd4be685a44d1d09">ast_get_indication_tone</a></div><div class="ttdeci">struct ast_tone_zone_sound * ast_get_indication_tone(const struct ast_tone_zone *zone, const char *indication)</div><div class="ttdoc">Locate a tone zone sound. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6e/indications_8c_source.html#l00455">indications.c:455</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a6c3143c623872a85835381fbe02cddf5"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a6c3143c623872a85835381fbe02cddf5">unistim_subchannel::holding</a></div><div class="ttdeci">int holding</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00362">chan_unistim.c:362</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa2849c9d8d410fd9a4c1c8ccd7cb1565"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa2849c9d8d410fd9a4c1c8ccd7cb1565">FAV_ICON_SPEAKER_OFFHOOK_BLACK</a></div><div class="ttdeci">#define FAV_ICON_SPEAKER_OFFHOOK_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00186">chan_unistim.c:186</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab462e9e6f851205e3ba46e2af970cff8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab462e9e6f851205e3ba46e2af970cff8">transfer_cancel_step2</a></div><div class="ttdeci">static void transfer_cancel_step2(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03080">chan_unistim.c:3080</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a268173de7129a2bceb7423b4be3a8f38"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a268173de7129a2bceb7423b4be3a8f38">ptestate_tostr</a></div><div class="ttdeci">static const char * ptestate_tostr(const int type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02040">chan_unistim.c:2040</a></div></div>
<div class="ttc" id="structunistim__device_html_a8c8e94fbeeba8d5a1511d49cf7ae836d"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a8c8e94fbeeba8d5a1511d49cf7ae836d">unistim_device::sline</a></div><div class="ttdeci">struct unistim_line * sline[FAVNUM]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00410">chan_unistim.c:410</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_a1229bdedff51a0fc453b7c482cd8dd49"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#a1229bdedff51a0fc453b7c482cd8dd49">sip_to_pjsip.ignore</a></div><div class="ttdeci">def ignore(key=None, val=None, section=None, pjsip=None, nmapped=None, type='endpoint')</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l00048">sip_to_pjsip.py:48</a></div></div>
<div class="ttc" id="musiconhold_8h_html_a2acec01f2fddd8ca494d874003815cf7"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a></div><div class="ttdeci">int ast_moh_start(struct ast_channel *chan, const char *mclass, const char *interpclass)</div><div class="ttdoc">Turn on music on hold on a given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07866">channel.c:7866</a></div></div>
<div class="ttc" id="structunistim__device_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#adf04f66344e3fb0a6f6a69bf39d19902">unistim_device::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00395">chan_unistim.c:395</a></div></div>
<div class="ttc" id="structunistim__device_html_a18685fcdcda37514b79dbe909c9da752"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a18685fcdcda37514b79dbe909c9da752">unistim_device::softkeyicon</a></div><div class="ttdeci">char softkeyicon[FAVNUM]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00407">chan_unistim.c:407</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4d823fd9d764742ffbdac232df32479da5f7853229153b0f0699e1ff119906661">AUTOPROVISIONING_TN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00125">chan_unistim.c:125</a></div></div>
<div class="ttc" id="structunistim__device_html_a1793fe255c482750301ca7e5ea57874d"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a1793fe255c482750301ca7e5ea57874d">unistim_device::microphone</a></div><div class="ttdeci">int microphone</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00443">chan_unistim.c:443</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a41f239e905c4c87f8db6e0d85928a33a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a41f239e905c4c87f8db6e0d85928a33a">packet_send_s9</a></div><div class="ttdeci">static const unsigned char packet_send_s9[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00594">chan_unistim.c:594</a></div></div>
<div class="ttc" id="structunistim__languages_html_af1b909089d6b1b11154a7d53b6791aa8"><div class="ttname"><a href="../../d1/d7e/structunistim__languages.html#af1b909089d6b1b11154a7d53b6791aa8">unistim_languages::lang_short</a></div><div class="ttdeci">char * lang_short</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00490">chan_unistim.c:490</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa1237b035ece01878d5d56eb20e7a91a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa1237b035ece01878d5d56eb20e7a91a">packet_send_text</a></div><div class="ttdeci">static const unsigned char packet_send_text[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00662">chan_unistim.c:662</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad5c32877bf1a61ac2c2c05ca90b41a15"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad5c32877bf1a61ac2c2c05ca90b41a15">MAX_SCREEN_NUMBER</a></div><div class="ttdeci">#define MAX_SCREEN_NUMBER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00095">chan_unistim.c:95</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7461823dcce8b29e21c0d33e5f0d7f8a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7461823dcce8b29e21c0d33e5f0d7f8a">unistim_set_rtp_peer</a></div><div class="ttdeci">static int unistim_set_rtp_peer(struct ast_channel *chan, struct ast_rtp_instance *rtp, struct ast_rtp_instance *vrtp, struct ast_rtp_instance *trtp, const struct ast_format_cap *codecs, int nat_active)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07047">chan_unistim.c:7047</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac32e6227a132522cf2ec6805e2894ffb">KEY_STAR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00306">chan_unistim.c:306</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="structunistim__languages_html"><div class="ttname"><a href="../../d1/d7e/structunistim__languages.html">unistim_languages</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00488">chan_unistim.c:488</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a4f2fb6c08b3697d011cf613c8b68054ca06df52d7b998aec9a879a1a53624c5e8"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a4f2fb6c08b3697d011cf613c8b68054ca06df52d7b998aec9a879a1a53624c5e8">AST_RTP_GLUE_RESULT_LOCAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00164">rtp_engine.h:164</a></div></div>
<div class="ttc" id="format__cap_8h_html_a4dff925fc9e3bb805b926d18447eb3eb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a></div><div class="ttdeci">const char * ast_format_cap_get_names(const struct ast_format_cap *cap, struct ast_str **buf)</div><div class="ttdoc">Get the names of codecs of a set of formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00736">format_cap.c:736</a></div></div>
<div class="ttc" id="structunistim__device_html_ada540a5f25f7302dc1a3d17ccfa59b10"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ada540a5f25f7302dc1a3d17ccfa59b10">unistim_device::nat</a></div><div class="ttdeci">int nat</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00446">chan_unistim.c:446</a></div></div>
<div class="ttc" id="strings_8h_html_abe38193be148775f7559f8fff6e0c17e"><div class="ttname"><a href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a></div><div class="ttdeci">char * ast_trim_blanks(char *str)</div><div class="ttdoc">Trims trailing whitespace characters from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00182">strings.h:182</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9ad0498397174790a4979a7267d16b26"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9ad0498397174790a4979a7267d16b26">handle_key_fav</a></div><div class="ttdeci">static void handle_key_fav(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03380">chan_unistim.c:3380</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="paths_8h_html_aea5e16ca2517e2093fdfa0e7fd112f0f"><div class="ttname"><a href="../../dd/df2/paths_8h.html#aea5e16ca2517e2093fdfa0e7fd112f0f">ast_config_AST_LOG_DIR</a></div><div class="ttdeci">const char * ast_config_AST_LOG_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00159">options.c:159</a></div></div>
<div class="ttc" id="structunistim__device_html_ad12fc34ce789bce6c8a05d8a17138534"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ad12fc34ce789bce6c8a05d8a17138534">unistim_device::height</a></div><div class="ttdeci">int height</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00413">chan_unistim.c:413</a></div></div>
<div class="ttc" id="structast__channel__tech_html_a0f943c30fc292bd35c9619493661920f"><div class="ttname"><a href="../../d4/d85/structast__channel__tech.html#a0f943c30fc292bd35c9619493661920f">ast_channel_tech::capabilities</a></div><div class="ttdeci">struct ast_format_cap * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00633">channel.h:633</a></div></div>
<div class="ttc" id="channel_8h_html_ae90da1877e143b996d202d4c88a9c862"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae90da1877e143b996d202d4c88a9c862">ast_softhangup_nolock</a></div><div class="ttdeci">int ast_softhangup_nolock(struct ast_channel *chan, int reason)</div><div class="ttdoc">Softly hangup up a channel (no channel lock) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02463">channel.c:2463</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a387541001cb5a25515eb4b17f1d3a341"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a387541001cb5a25515eb4b17f1d3a341">register_extension</a></div><div class="ttdeci">static int register_extension(const struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01445">chan_unistim.c:1445</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a67508a613c8f337732e35d9367b43ae7"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a></div><div class="ttdeci">#define AST_LIST_ENTRY(type)</div><div class="ttdoc">Declare a forward link structure inside a list entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00409">linkedlists.h:409</a></div></div>
<div class="ttc" id="f2c_8h_html_abf5d144da384425ae6cb542ce6eec8d3"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a></div><div class="ttdeci">long int flag</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00083">f2c.h:83</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab7cd50b0f4b41c2bed466e3ebbc3d454"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab7cd50b0f4b41c2bed466e3ebbc3d454">packet_send_title</a></div><div class="ttdeci">static const unsigned char packet_send_title[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00659">chan_unistim.c:659</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660a5bf03bd84f434acaeefdacb0096e1baa"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660a5bf03bd84f434acaeefdacb0096e1baa">AST_STATE_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00041">channelstate.h:41</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a96a53bd4ae7f1c907e2d6e2e361492ae"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a96a53bd4ae7f1c907e2d6e2e361492ae">get_active_softkey</a></div><div class="ttdeci">static int get_active_softkey(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01380">chan_unistim.c:1380</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a64756880a43b742a7d4e4e63bce9ade8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a64756880a43b742a7d4e4e63bce9ade8">lang_hash_fn</a></div><div class="ttdeci">static int lang_hash_fn(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00786">chan_unistim.c:786</a></div></div>
<div class="ttc" id="structunistim__menu__item_html_a89f234133d3efe315836311cbf21c64b"><div class="ttname"><a href="../../d3/df2/structunistim__menu__item.html#a89f234133d3efe315836311cbf21c64b">unistim_menu_item::state</a></div><div class="ttdeci">int state</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00483">chan_unistim.c:483</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a639c46654c74d21720538aaada34cbbb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a639c46654c74d21720538aaada34cbbb">open_history</a></div><div class="ttdeci">static char open_history(struct unistimsession *pte, char way, FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04058">chan_unistim.c:4058</a></div></div>
<div class="ttc" id="structunistim__device_html_add1f67134a5e4820cc9142a97b0da05c"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#add1f67134a5e4820cc9142a97b0da05c">unistim_device::contrast</a></div><div class="ttdeci">signed char contrast</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00419">chan_unistim.c:419</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="structunistim__device_html_a220a701a1b2944d23d82fee7f170e324"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a220a701a1b2944d23d82fee7f170e324">unistim_device::codec_number</a></div><div class="ttdeci">char codec_number</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00432">chan_unistim.c:432</a></div></div>
<div class="ttc" id="channel_8h_html_a6643cbe766a051d2d06750ab5b3e933d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6643cbe766a051d2d06750ab5b3e933d">ast_channel_stop_silence_generator</a></div><div class="ttdeci">void ast_channel_stop_silence_generator(struct ast_channel *chan, struct ast_silence_generator *state)</div><div class="ttdoc">Stops a previously-started silence generator on the given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08312">channel.c:8312</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae94d64fb1037c796789a52c999c4d0fa"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae94d64fb1037c796789a52c999c4d0fa">dtmf_row</a></div><div class="ttdeci">static const int dtmf_row[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00345">chan_unistim.c:345</a></div></div>
<div class="ttc" id="channel_8h_html_abcf1aea85b924e9cd605040b86241e2a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a></div><div class="ttdeci">#define AST_MAX_CONTEXT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00136">channel.h:136</a></div></div>
<div class="ttc" id="network_8h_html_a5a735cb59e8a8ddd78078d396db7e106"><div class="ttname"><a href="../../d9/d94/network_8h.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a></div><div class="ttdeci">const char * ast_inet_ntoa(struct in_addr ia)</div><div class="ttdoc">thread-safe replacement for inet_ntoa(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l00782">main/utils.c:782</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aaba29834ad7f3e8f828262ffe6ce62a9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aaba29834ad7f3e8f828262ffe6ce62a9">unistim_send_mwi_to_peer</a></div><div class="ttdeci">static int unistim_send_mwi_to_peer(struct unistim_line *peer, unsigned int tick)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05675">chan_unistim.c:5675</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1c099ceb2aedf50c496a4f27b8b95dad"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1c099ceb2aedf50c496a4f27b8b95dad">handle_call_outgoing</a></div><div class="ttdeci">static void handle_call_outgoing(struct unistimsession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03111">chan_unistim.c:3111</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="utils_8h_html_a4781fd54a4ca8c7f0f8a32a6cce503c0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a></div><div class="ttdeci">#define ast_pthread_create(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00559">utils.h:559</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a32a08a969e328e667e70f8437dda445f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a32a08a969e328e667e70f8437dda445f">packet_send_end_call</a></div><div class="ttdeci">static const unsigned char packet_send_end_call[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00592">chan_unistim.c:592</a></div></div>
<div class="ttc" id="structwsabuf_html_af3e872c7aafad34920b7a57ed2363d92"><div class="ttname"><a href="../../d7/d43/structwsabuf.html#af3e872c7aafad34920b7a57ed2363d92">wsabuf::len</a></div><div class="ttdeci">u_long len</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00349">chan_unistim.c:349</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a30564a003a7c639fbd349f7895382c5c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a30564a003a7c639fbd349f7895382c5c">unistim_show_devices</a></div><div class="ttdeci">static char * unistim_show_devices(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06117">chan_unistim.c:6117</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a45563b70b6151b79c2b1442ea66843e0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a45563b70b6151b79c2b1442ea66843e0">SELECTEXTENSION_MAX_LENGTH</a></div><div class="ttdeci">#define SELECTEXTENSION_MAX_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03874">chan_unistim.c:3874</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac4106406e269667ff84ee49e0a634f94"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac4106406e269667ff84ee49e0a634f94">AST_CONTROL_OPTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00288">include/asterisk/frame.h:288</a></div></div>
<div class="ttc" id="acl_8h_html_ad364a9241e15fc0dbec0ffcb88f64671"><div class="ttname"><a href="../../d5/d59/acl_8h.html#ad364a9241e15fc0dbec0ffcb88f64671">ast_str2cos</a></div><div class="ttdeci">int ast_str2cos(const char *value, unsigned int *cos)</div><div class="ttdoc">Convert a string to the appropriate COS value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00953">acl.c:953</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a3c6963e58909346a8ef561dfcbbd9031">KEY_RCVHIST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00332">chan_unistim.c:332</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a06fa00d556617b9bae1053d2112f4732"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a06fa00d556617b9bae1053d2112f4732">unistim_subchannel::ss_thread</a></div><div class="ttdeci">pthread_t ss_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00360">chan_unistim.c:360</a></div></div>
<div class="ttc" id="channel_8h_html_a29557c4823f5e9c02519a01daf6a289c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a></div><div class="ttdeci">void ast_hangup(struct ast_channel *chan)</div><div class="ttdoc">Hang up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02548">channel.c:2548</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee">AST_CONTROL_UPDATE_RTP_PEER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00309">include/asterisk/frame.h:309</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa5ef22f987317a552af2f42d2d3d67d2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa5ef22f987317a552af2f42d2d3d67d2">packet_send_rtp_packet_size</a></div><div class="ttdeci">static const unsigned char packet_send_rtp_packet_size[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00597">chan_unistim.c:597</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae64dbc971c1418bf50d13f390b26c20c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae64dbc971c1418bf50d13f390b26c20c">DEFAULTHEIGHT</a></div><div class="ttdeci">#define DEFAULTHEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00086">chan_unistim.c:86</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_aee3ef7f9e53a34e743c3a95c9ca95fb4"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#aee3ef7f9e53a34e743c3a95c9ca95fb4">ast_rtp_instance_fd</a></div><div class="ttdeci">int ast_rtp_instance_fd(struct ast_rtp_instance *instance, int rtcp)</div><div class="ttdoc">Get the file descriptor for an RTP session (or RTCP) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02192">rtp_engine.c:2192</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971ac5f9a649f6ce46a04ab887c56930ebee"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971ac5f9a649f6ce46a04ab887c56930ebee">ISO_2022_JP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00342">chan_unistim.c:342</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_afbdf3717d9b2c10cb2b20f77f8fdb797"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#afbdf3717d9b2c10cb2b20f77f8fdb797">packet_recv_expansion_pressed_key</a></div><div class="ttdeci">static const unsigned char packet_recv_expansion_pressed_key[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00524">chan_unistim.c:524</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a36a5308ad8c28bc27b643dab70a466d3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a36a5308ad8c28bc27b643dab70a466d3">devices</a></div><div class="ttdeci">static struct unistim_device * devices</div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf226cf2d1a4dbbbf220521d58c05ac0f"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a></div><div class="ttdeci">struct stasis_message_type * ast_mwi_state_type(void)</div><div class="ttdoc">Get the Stasis Message Bus API message type for MWI messages. </div></div>
<div class="ttc" id="structunistimsession_html_ac7cbd331d33fcd5a6f81a257975e4cd5"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#ac7cbd331d33fcd5a6f81a257975e4cd5">unistimsession::sin</a></div><div class="ttdeci">struct sockaddr_in sin</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00460">chan_unistim.c:460</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a17a8fe722e3516fa9ec588d8c6d0999b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a17a8fe722e3516fa9ec588d8c6d0999b">send_led_update</a></div><div class="ttdeci">static void send_led_update(struct unistimsession *pte, unsigned char led)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01639">chan_unistim.c:1639</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad0e16ee388b0afd41516a4ff34258059"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad0e16ee388b0afd41516a4ff34258059">parse_bookmark</a></div><div class="ttdeci">static int parse_bookmark(const char *text, struct unistim_device *d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06297">chan_unistim.c:6297</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a77c91d8d323c7e0d4d9b170f05bb732c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a77c91d8d323c7e0d4d9b170f05bb732c">unistim_hangup</a></div><div class="ttdeci">static int unistim_hangup(struct ast_channel *ast)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04945">chan_unistim.c:4945</a></div></div>
<div class="ttc" id="structunistim__device_html_a84c6288d53aa6ff956fa95ffafd71b3f"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a84c6288d53aa6ff956fa95ffafd71b3f">unistim_device::lst_cid</a></div><div class="ttdeci">char lst_cid[TEXT_LENGTH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00436">chan_unistim.c:436</a></div></div>
<div class="ttc" id="structast__jb__conf_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../d7/dba/structast__jb__conf.html#ac92588540e8c1d014a08cd8a45462b19">ast_jb_conf::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdoc">Combination of the AST_JB_ENABLED, AST_JB_FORCED and AST_JB_LOG flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d14/abstract__jb_8h_source.html#l00072">abstract_jb.h:72</a></div></div>
<div class="ttc" id="astdb_8h_html_a6ab91701fa0db9fad7759fe42a581c17"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#a6ab91701fa0db9fad7759fe42a581c17">ast_db_get</a></div><div class="ttdeci">int ast_db_get(const char *family, const char *key, char *value, int valuelen)</div><div class="ttdoc">Get key value specified by family/key. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00412">main/db.c:412</a></div></div>
<div class="ttc" id="structast__tm_html_a4d171061df9e012fcfbd1172b8440d5f"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a4d171061df9e012fcfbd1172b8440d5f">ast_tm::tm_hour</a></div><div class="ttdeci">int tm_hour</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00038">localtime.h:38</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a1a461c5e737ed6ed7c8cb0f78557a6fd"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a1a461c5e737ed6ed7c8cb0f78557a6fd">AST_CONTROL_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00291">include/asterisk/frame.h:291</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971">charset</a></div><div class="ttdeci">charset</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00336">chan_unistim.c:336</a></div></div>
<div class="ttc" id="structunistimsession_html_a4a3bb3a4fe0958be847fba7ec397a44d"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a4a3bb3a4fe0958be847fba7ec397a44d">unistimsession::seq_phone</a></div><div class="ttdeci">unsigned short seq_phone</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00463">chan_unistim.c:463</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_afc2c56d6d91609b957e79eb996b703bd"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#afc2c56d6d91609b957e79eb996b703bd">unistim_subchannel::softkey</a></div><div class="ttdeci">int softkey</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00359">chan_unistim.c:359</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a95e87aaaae8e8f48324d3ec9c7824aab"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a95e87aaaae8e8f48324d3ec9c7824aab">packet_send_charset_iso_8859_4</a></div><div class="ttdeci">static const unsigned char packet_send_charset_iso_8859_4[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00685">chan_unistim.c:685</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a80baeff1bd121c3168ede2a955e9b3a2"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a80baeff1bd121c3168ede2a955e9b3a2">ast_rtp_instance_get_local_address</a></div><div class="ttdeci">void ast_rtp_instance_get_local_address(struct ast_rtp_instance *instance, struct ast_sockaddr *address)</div><div class="ttdoc">Get the local address that we are expecting RTP on. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00643">rtp_engine.c:643</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a0bfe6336fe7deb78148a84aef2732c7a"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a0bfe6336fe7deb78148a84aef2732c7a">ast_rtp_instance_destroy</a></div><div class="ttdeci">int ast_rtp_instance_destroy(struct ast_rtp_instance *instance)</div><div class="ttdoc">Destroy an RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00458">rtp_engine.c:458</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abadcd086ed6bda7b8c1d5bd0c022e5ef"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abadcd086ed6bda7b8c1d5bd0c022e5ef">get_sub</a></div><div class="ttdeci">static struct unistim_subchannel * get_sub(struct unistim_device *device, int type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02493">chan_unistim.c:2493</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a0584f8c82160925dbd9738fbe6917fc3">ISO_8859_1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00338">chan_unistim.c:338</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a76b4d3927cacd1bcd5da9ca8fe375cb6"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a76b4d3927cacd1bcd5da9ca8fe375cb6">ast_app_has_voicemail</a></div><div class="ttdeci">int ast_app_has_voicemail(const char *mailboxes, const char *folder)</div><div class="ttdoc">Determine if a given mailbox has any voicemail If folder is NULL, defaults to &quot;INBOX&quot;. If folder is &quot;INBOX&quot;, includes the number of messages in the &quot;Urgent&quot; folder. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l00655">main/app.c:655</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7036403a2cd21a45050ed56346403197"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7036403a2cd21a45050ed56346403197">unistim_reloading</a></div><div class="ttdeci">static int unistim_reloading</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00260">chan_unistim.c:260</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_addaa208b0ed785225e24490fb9f28a80"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a></div><div class="ttdeci">AST_MODULE_INFO(ASTERISK_GPL_KEY, AST_MODFLAG_GLOBAL_SYMBOLS|AST_MODFLAG_LOAD_ORDER, &quot;HTTP Phone Provisioning&quot;,.support_level=AST_MODULE_SUPPORT_EXTENDED,.load=load_module,.unload=unload_module,.reload=reload,.load_pri=AST_MODPRI_CHANNEL_DEPEND,.requires=&quot;http&quot;,)</div></div>
<div class="ttc" id="structunistim__line_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a78d4847658b695383d849efd12399b38">unistim_line::exten</a></div><div class="ttdeci">char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00376">chan_unistim.c:376</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0ce9df795a9c80e6bd83ed8935c80999"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0ce9df795a9c80e6bd83ed8935c80999">EXPNUM</a></div><div class="ttdeci">#define EXPNUM</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00217">chan_unistim.c:217</a></div></div>
<div class="ttc" id="structast__hostent_html"><div class="ttname"><a href="../../db/d2b/structast__hostent.html">ast_hostent</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00208">utils.h:208</a></div></div>
<div class="ttc" id="abstract__jb_8h_html_a0981c84ac90dd79bc2a0fdd90aa6efba"><div class="ttname"><a href="../../dc/d14/abstract__jb_8h.html#a0981c84ac90dd79bc2a0fdd90aa6efba">ast_jb_configure</a></div><div class="ttdeci">void ast_jb_configure(struct ast_channel *chan, const struct ast_jb_conf *conf)</div><div class="ttdoc">Configures a jitterbuffer on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d1d/abstract__jb_8c_source.html#l00593">abstract_jb.c:593</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3119d68a678e50384f92a0021dec136f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3119d68a678e50384f92a0021dec136f">TEXT_INVERSE</a></div><div class="ttdeci">#define TEXT_INVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00174">chan_unistim.c:174</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a31a1d6096182df0a096b7315145cc291"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a31a1d6096182df0a096b7315145cc291">send_text</a></div><div class="ttdeci">static void send_text(unsigned char pos, unsigned char inverse, struct unistimsession *pte, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01578">chan_unistim.c:1578</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a75eb49d485234d520aa49cc5a2957dc8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a75eb49d485234d520aa49cc5a2957dc8">unistim_unalloc_sub</a></div><div class="ttdeci">static int unistim_unalloc_sub(struct unistim_device *d, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02007">chan_unistim.c:2007</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6392501cc2f81118fc590c8a63fd27c8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6392501cc2f81118fc590c8a63fd27c8">write_entry_history</a></div><div class="ttdeci">static int write_entry_history(struct unistimsession *pte, FILE *f, char c, char *line1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02260">chan_unistim.c:2260</a></div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00315">module.h:315</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="channel_8h_html_a018b7a29cef2d62074dc46e9aaad0d1a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a018b7a29cef2d62074dc46e9aaad0d1a">ast_channel_exten_set</a></div><div class="ttdeci">void ast_channel_exten_set(struct ast_channel *chan, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00357">channel_internal_api.c:357</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae374c5efe870e75570cae4630fd44954"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae374c5efe870e75570cae4630fd44954">global_cap</a></div><div class="ttdeci">struct ast_format_cap * global_cap</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00120">chan_unistim.c:120</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7de71b5fc170bcc10f3d1c44da09f3c2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7de71b5fc170bcc10f3d1c44da09f3c2">unistim_write</a></div><div class="ttdeci">static int unistim_write(struct ast_channel *ast, struct ast_frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05216">chan_unistim.c:5216</a></div></div>
<div class="ttc" id="structunistim__device_html_a579ca8125bbf48d9ce8691d522f99933"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a579ca8125bbf48d9ce8691d522f99933">unistim_device::context</a></div><div class="ttdeci">char context[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00398">chan_unistim.c:398</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aab8917d426f9be27c95c0d3810006d7b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aab8917d426f9be27c95c0d3810006d7b">KEY_8</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00304">chan_unistim.c:304</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a465f12c0a040e49332228fb8eeeb767c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a465f12c0a040e49332228fb8eeeb767c">MUTE_ON</a></div><div class="ttdeci">#define MUTE_ON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00148">chan_unistim.c:148</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7451bd99b71f1ac7e8382f79ed94ce1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7451bd99b71f1ac7e8382f79ed94ce1">packet_send_blink_cursor</a></div><div class="ttdeci">static const unsigned char packet_send_blink_cursor[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00634">chan_unistim.c:634</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_af203379aca2fd704fe8d86a9445596b6"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a></div><div class="ttdeci">struct ast_frame ast_null_frame</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d55/main_2frame_8c_source.html#l00079">main/frame.c:79</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acde558b15bc96c402f0c8d6c618048bf"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acde558b15bc96c402f0c8d6c618048bf">monthlabels</a></div><div class="ttdeci">static unsigned char monthlabels[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00649">chan_unistim.c:649</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acf057faabb89a493df21ee8102d79076"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acf057faabb89a493df21ee8102d79076">FAV_MAX_LENGTH</a></div><div class="ttdeci">#define FAV_MAX_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00214">chan_unistim.c:214</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810ae9f20352b4ef69ae68b9ff44abadfd79"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ae9f20352b4ef69ae68b9ff44abadfd79">KEY_4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00300">chan_unistim.c:300</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3f9523eb1c7c6620e8a9fddde066c2ff"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3f9523eb1c7c6620e8a9fddde066c2ff">SUB_REAL</a></div><div class="ttdeci">#define SUB_REAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00116">chan_unistim.c:116</a></div></div>
<div class="ttc" id="structast__tm_html_a18df301c1a10c8d493da86ce5c2aea78"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a18df301c1a10c8d493da86ce5c2aea78">ast_tm::tm_sec</a></div><div class="ttdeci">int tm_sec</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00036">localtime.h:36</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a109d3bab32b2bea03e2bafd9ab87b00f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a109d3bab32b2bea03e2bafd9ab87b00f">MUTE_ON_DISCRET</a></div><div class="ttdeci">#define MUTE_ON_DISCRET</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00149">chan_unistim.c:149</a></div></div>
<div class="ttc" id="structunistimsession_html_a89f234133d3efe315836311cbf21c64b"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a89f234133d3efe315836311cbf21c64b">unistimsession::state</a></div><div class="ttdeci">int state</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00469">chan_unistim.c:469</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a3cdf29304021645e5025b9bbfaf83e78"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a3cdf29304021645e5025b9bbfaf83e78">packet_send_start_timer</a></div><div class="ttdeci">static const unsigned char packet_send_start_timer[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00640">chan_unistim.c:640</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="structunistim__line_html_abc0651bcec68410023c036b7d8ec4d11"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#abc0651bcec68410023c036b7d8ec4d11">unistim_line::pickupgroup</a></div><div class="ttdeci">ast_group_t pickupgroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00381">chan_unistim.c:381</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acc4156cb923a2043e4c0a7c45c579c4a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a></div><div class="ttdeci">static void parsing(int size, unsigned char *buf, struct unistimsession *pte, struct sockaddr_in *addr_from)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04633">chan_unistim.c:4633</a></div></div>
<div class="ttc" id="channel_8h_html_a8e5cf0a066beee895cfd9048e4abdbb3"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8e5cf0a066beee895cfd9048e4abdbb3">ast_channel_fd</a></div><div class="ttdeci">int ast_channel_fd(const struct ast_channel *chan, int which)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01186">channel_internal_api.c:1186</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a79418712af21d6935fa65350e152e8f4">KEY_FUNC3</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00316">chan_unistim.c:316</a></div></div>
<div class="ttc" id="app__sms_8c_html_a8514112da88a5d13451aaf8c9b064017"><div class="ttname"><a href="../../d7/d81/app__sms_8c.html#a8514112da88a5d13451aaf8c9b064017">seq</a></div><div class="ttdeci">static volatile unsigned int seq</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d81/app__sms_8c_source.html#l00120">app_sms.c:120</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2d6b548178350f2d113278c3150fce23"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2d6b548178350f2d113278c3150fce23">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07187">chan_unistim.c:7187</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a42b607e49465ac5e3e4c2c9abf302b09"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a42b607e49465ac5e3e4c2c9abf302b09">key_select_codec</a></div><div class="ttdeci">static void key_select_codec(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03752">chan_unistim.c:3752</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae16cf061d155708ac19b72aee92a268f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae16cf061d155708ac19b72aee92a268f">packet_send_open_audio_stream_rx</a></div><div class="ttdeci">static const unsigned char packet_send_open_audio_stream_rx[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00608">chan_unistim.c:608</a></div></div>
<div class="ttc" id="utils_8h_html_ad3b63ee1041593219ef0765b28d70442"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad3b63ee1041593219ef0765b28d70442">ast_gethostbyname</a></div><div class="ttdeci">struct hostent * ast_gethostbyname(const char *host, struct ast_hostent *hp)</div><div class="ttdoc">Thread-safe gethostbyname function to use in Asterisk. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l00197">main/utils.c:197</a></div></div>
<div class="ttc" id="logger_8c_html_a2057dec53731af6bb6881015b58936ba"><div class="ttname"><a href="../../d1/d22/logger_8c.html#a2057dec53731af6bb6881015b58936ba">dateformat</a></div><div class="ttdeci">static char dateformat[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l00079">logger.c:79</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a2b40c67e67a8ef07ce7f6313dea02336"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a2b40c67e67a8ef07ce7f6313dea02336">key_call</a></div><div class="ttdeci">static void key_call(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03435">chan_unistim.c:3435</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af3bdb353330f1908e9558180b5bb9e16"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af3bdb353330f1908e9558180b5bb9e16">AST_CONTROL_INCOMPLETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00307">include/asterisk/frame.h:307</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00294">include/asterisk/frame.h:294</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="chan__unistim_8c_html_aeb5646ddd3feaa9fb98fe61d2a2aa65e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aeb5646ddd3feaa9fb98fe61d2a2aa65e">send_no_ring</a></div><div class="ttdeci">static void send_no_ring(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01731">chan_unistim.c:1731</a></div></div>
<div class="ttc" id="structunistim__line_html_adfee50d07a98645d4d20b896ce03785a"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#adfee50d07a98645d4d20b896ce03785a">unistim_line::accountcode</a></div><div class="ttdeci">char accountcode[AST_MAX_ACCOUNT_CODE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00382">chan_unistim.c:382</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a48bc11919b2752df9d14ce89557cfb25"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_aed962e072d650da9b002d925dbe79893"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#aed962e072d650da9b002d925dbe79893">unistim_subchannel::list</a></div><div class="ttdeci">struct unistim_subchannel::@150 list</div></div>
<div class="ttc" id="chan__unistim_8c_html_ae09c27ec460e1e3c1a1c86888fbd1348"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae09c27ec460e1e3c1a1c86888fbd1348">send_cursor_pos</a></div><div class="ttdeci">static void send_cursor_pos(struct unistimsession *pte, unsigned char pos)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01856">chan_unistim.c:1856</a></div></div>
<div class="ttc" id="channel_8h_html_a6801c703e767d6f760c54c8b86a30024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a></div><div class="ttdeci">#define ast_channel_ref(c)</div><div class="ttdoc">Increase channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02970">channel.h:2970</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a246466696bf607e23312e5378f332b3c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a246466696bf607e23312e5378f332b3c">sub_unhold</a></div><div class="ttdeci">static void sub_unhold(struct unistimsession *pte, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02576">chan_unistim.c:2576</a></div></div>
<div class="ttc" id="pbx_8h_html_a07176e8d314eb68b3b50279fafa11390"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a07176e8d314eb68b3b50279fafa11390">ast_add_extension</a></div><div class="ttdeci">int ast_add_extension(const char *context, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)</div><div class="ttdoc">Add and extension to an extension context. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l06970">pbx.c:6970</a></div></div>
<div class="ttc" id="structunistim__device_html_a0bf1cd67e2f39c26efefe6123fc0064f"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a0bf1cd67e2f39c26efefe6123fc0064f">unistim_device::rtp_port</a></div><div class="ttdeci">int rtp_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00429">chan_unistim.c:429</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="channel_8h_html_aa04afa262d7e1b211ee32d17c949a275"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a></div><div class="ttdeci">int ast_channel_hangupcause(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00427">channel_internal_api.c:427</a></div></div>
<div class="ttc" id="structsessions_html"><div class="ttname"><a href="../../d3/d0a/structsessions.html">sessions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d80/chan__skinny_8c_source.html#l01630">chan_skinny.c:1630</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a640be959dd0a4166b7032c88737444f8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a640be959dd0a4166b7032c88737444f8">process_request</a></div><div class="ttdeci">static void process_request(int size, unsigned char *buf, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04469">chan_unistim.c:4469</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3c5734af16d0f6318dfa9358b7b34275">STATE_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00282">chan_unistim.c:282</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structunistim__line_html_a10d123cd8723d58ff76dfe4b26d3e92e"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a10d123cd8723d58ff76dfe4b26d3e92e">unistim_line::fullname</a></div><div class="ttdeci">char fullname[101]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00375">chan_unistim.c:375</a></div></div>
<div class="ttc" id="structunistimsession_html_a0dfd343489c25731be1f1d789ffb08e4"><div class="ttname"><a href="../../d9/dc9/structunistimsession.html#a0dfd343489c25731be1f1d789ffb08e4">unistimsession::buff_entry</a></div><div class="ttdeci">char buff_entry[16]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00471">chan_unistim.c:471</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_a8892ea4843b6a7e45d26d8e1ca0da0d5"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#a8892ea4843b6a7e45d26d8e1ca0da0d5">unistim_subchannel::parent</a></div><div class="ttdeci">struct unistim_line * parent</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00357">chan_unistim.c:357</a></div></div>
<div class="ttc" id="format__cache_8h_html_a95c058fe6adef68780f026d6aec2481c"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a95c058fe6adef68780f026d6aec2481c">ast_format_alaw</a></div><div class="ttdeci">struct ast_format * ast_format_alaw</div><div class="ttdoc">Built-in cached alaw format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00091">format_cache.c:91</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af30c10a8c6ed3d4649cfdc61e2029dc3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af30c10a8c6ed3d4649cfdc61e2029dc3">buff</a></div><div class="ttdeci">static unsigned char * buff</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00259">chan_unistim.c:259</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810ab6b8f3f14db11e378b2d11e2008ff791"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ab6b8f3f14db11e378b2d11e2008ff791">KEY_COPY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00313">chan_unistim.c:313</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a25704e7aba3b037d7e7766cb5b494ff1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a25704e7aba3b037d7e7766cb5b494ff1">autoprovisioning</a></div><div class="ttdeci">static enum autoprovision autoprovisioning</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00245">chan_unistim.c:245</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a867e7c497d29cd4f8f55a9011924469a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a867e7c497d29cd4f8f55a9011924469a">KEY_CONF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00330">chan_unistim.c:330</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac524b4f77b4c7d258f4584b6c1b375c2"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac524b4f77b4c7d258f4584b6c1b375c2">SELECTCODEC_START_ENTRY_POS</a></div><div class="ttdeci">#define SELECTCODEC_START_ENTRY_POS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03729">chan_unistim.c:3729</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971a330a758072a52c7ab6307cd9b87d4939"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971a330a758072a52c7ab6307cd9b87d4939">ISO_8859_4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00340">chan_unistim.c:340</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a51d886f21273033c5d95f4c56da83a99"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a51d886f21273033c5d95f4c56da83a99">delete_device</a></div><div class="ttdeci">static void delete_device(struct unistim_device *d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06422">chan_unistim.c:6422</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad4a61b324f2b83bb3abddb8a49e84251"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad4a61b324f2b83bb3abddb8a49e84251">packet_send_charset_iso_8859_1</a></div><div class="ttdeci">static const unsigned char packet_send_charset_iso_8859_1[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00679">chan_unistim.c:679</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga70de9f16a229e2c5bf1a973372949d3e"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga70de9f16a229e2c5bf1a973372949d3e">ast_mwi_state::new_msgs</a></div><div class="ttdeci">int new_msgs</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00461">mwi.h:461</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4e0473d5c56ec814c90ce680847e960c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4e0473d5c56ec814c90ce680847e960c">LED_HEADPHONE_ON</a></div><div class="ttdeci">#define LED_HEADPHONE_ON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00162">chan_unistim.c:162</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aceaa3c593882fb527b27ad426628e276"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aceaa3c593882fb527b27ad426628e276">OUTPUT_SPEAKER</a></div><div class="ttdeci">#define OUTPUT_SPEAKER</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00140">chan_unistim.c:140</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae91dad65f553f7afebe4af507803bc7f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a></div><div class="ttdeci">unsigned int cos</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00252">chan_unistim.c:252</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a546d1d18e6b4db23aa313bb0a77bac18"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a546d1d18e6b4db23aa313bb0a77bac18">send_date_time</a></div><div class="ttdeci">static void send_date_time(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01784">chan_unistim.c:1784</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_ac43993a73742eff145b861107a1afa0d"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#ac43993a73742eff145b861107a1afa0d">unistim_subchannel::alreadygone</a></div><div class="ttdeci">int alreadygone</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00361">chan_unistim.c:361</a></div></div>
<div class="ttc" id="channelstate_8h_html_ad9d8f7d9e228b5af98a7b40db9f06448"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448">ast_setstate</a></div><div class="ttdeci">int ast_setstate(struct ast_channel *chan, enum ast_channel_state)</div><div class="ttdoc">Change the state of a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07486">channel.c:7486</a></div></div>
<div class="ttc" id="structwsabuf_html"><div class="ttname"><a href="../../d7/d43/structwsabuf.html">wsabuf</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00348">chan_unistim.c:348</a></div></div>
<div class="ttc" id="mwi_8h_html"><div class="ttname"><a href="../../dc/d33/mwi_8h.html">mwi.h</a></div><div class="ttdoc">Asterisk MWI API. </div></div>
<div class="ttc" id="lock_8h_html_a873a83eb8196323194aac2bea23d794e"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873a83eb8196323194aac2bea23d794e">AST_PTHREADT_STOP</a></div><div class="ttdeci">#define AST_PTHREADT_STOP</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00067">lock.h:67</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_afe951ef8ac0fe6aae0db42ce12bb3791"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#afe951ef8ac0fe6aae0db42ce12bb3791">ast_rtp_glue_unregister</a></div><div class="ttdeci">int ast_rtp_glue_unregister(struct ast_rtp_glue *glue)</div><div class="ttdoc">Unregister RTP glue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00408">rtp_engine.c:408</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4adacd187e409eba74939518d1e64d2e0fca">STATE_DIALPAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00280">chan_unistim.c:280</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aef054680a9be7da17d196e15aec894f8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aef054680a9be7da17d196e15aec894f8">KEY_3</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00299">chan_unistim.c:299</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acbf345365a56bdff96f462e1d9b60596"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acbf345365a56bdff96f462e1d9b60596">packet_send_status</a></div><div class="ttdeci">static const unsigned char packet_send_status[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00668">chan_unistim.c:668</a></div></div>
<div class="ttc" id="channel_8h_html_a828f537544a2ad2352c56c078390a0bda5f0673b46cfdba3094393b3fbce084ff"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a828f537544a2ad2352c56c078390a0bda5f0673b46cfdba3094393b3fbce084ff">AST_ADSI_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00872">channel.h:872</a></div></div>
<div class="ttc" id="causes_8h_html_ae009c193522491f7de7ea28b23f20868"><div class="ttname"><a href="../../d4/da3/causes_8h.html#ae009c193522491f7de7ea28b23f20868">AST_CAUSE_BUSY</a></div><div class="ttdeci">#define AST_CAUSE_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00148">causes.h:148</a></div></div>
<div class="ttc" id="pbx_8h_html_a44b6406c9220f7f2b610ac712369f405"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a44b6406c9220f7f2b610ac712369f405">ast_pbx_run</a></div><div class="ttdeci">enum ast_pbx_result ast_pbx_run(struct ast_channel *c)</div><div class="ttdoc">Execute the PBX in the current thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04759">pbx.c:4759</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4443e3616648e4784e60b4ac516120de"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4443e3616648e4784e60b4ac516120de">LED_BAR_OFF</a></div><div class="ttdeci">#define LED_BAR_OFF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00151">chan_unistim.c:151</a></div></div>
<div class="ttc" id="structunistim__line_html_a9fd80e0c89c336ebbfba1e947cf3d030"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a9fd80e0c89c336ebbfba1e947cf3d030">unistim_line::parent</a></div><div class="ttdeci">struct unistim_device * parent</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00387">chan_unistim.c:387</a></div></div>
<div class="ttc" id="structunistim__subchannel_html_ad226523f7221cc038c057ba5207a7e99"><div class="ttname"><a href="../../d0/dfe/structunistim__subchannel.html#ad226523f7221cc038c057ba5207a7e99">unistim_subchannel::moh</a></div><div class="ttdeci">int moh</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00365">chan_unistim.c:365</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aded82877394efd5636b1b14ad4ba757e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aded82877394efd5636b1b14ad4ba757e">packet_recv_mac_addr</a></div><div class="ttdeci">static const unsigned char packet_recv_mac_addr[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00535">chan_unistim.c:535</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5302fdbddac0762763d860e214fc4d71"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5302fdbddac0762763d860e214fc4d71">packet_send_mute</a></div><div class="ttdeci">static const unsigned char packet_send_mute[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00570">chan_unistim.c:570</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="causes_8h_html"><div class="ttname"><a href="../../d4/da3/causes_8h.html">causes.h</a></div><div class="ttdoc">Internal Asterisk hangup causes. </div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada6076a269c179617f2440076b0a4e313d">STATE_SELECTCODEC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00284">chan_unistim.c:284</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a06aab1370b612f1b03d2e55f8a33c0f1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a06aab1370b612f1b03d2e55f8a33c0f1">MONTH_LABEL_SIZE</a></div><div class="ttdeci">#define MONTH_LABEL_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00097">chan_unistim.c:97</a></div></div>
<div class="ttc" id="structast__tone__zone__part_html_a2caf338cfc4f9537f35d90025cf3a94d"><div class="ttname"><a href="../../dc/d40/structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">ast_tone_zone_part::freq2</a></div><div class="ttdeci">unsigned int freq2</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00111">indications.h:111</a></div></div>
<div class="ttc" id="structunistim__device_html_a38c550109a2ced0487e2304cbdf7ab6a"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a38c550109a2ced0487e2304cbdf7ab6a">unistim_device::maintext1</a></div><div class="ttdeci">char maintext1[25]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00415">chan_unistim.c:415</a></div></div>
<div class="ttc" id="stasis_8h_html_ab3da17290725793258020b83f56e4df6"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ab3da17290725793258020b83f56e4df6">stasis_cache_get</a></div><div class="ttdeci">struct stasis_message * stasis_cache_get(struct stasis_cache *cache, struct stasis_message_type *type, const char *id)</div><div class="ttdoc">Retrieve an item from the cache for the ast_eid_default entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00686">stasis_cache.c:686</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a63f253fc88f7a833b7c516a14f788e3b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a63f253fc88f7a833b7c516a14f788e3b">SELECTCODEC_MAX_LENGTH</a></div><div class="ttdeci">#define SELECTCODEC_MAX_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03730">chan_unistim.c:3730</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ab9f1dcd085417b952ceef3cb15a6bfc5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ab9f1dcd085417b952ceef3cb15a6bfc5">send_start_timer</a></div><div class="ttdeci">static void send_start_timer(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01127">chan_unistim.c:1127</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a52c437bdbf19718602604e80422c841e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a52c437bdbf19718602604e80422c841e">send_mute</a></div><div class="ttdeci">static void send_mute(struct unistimsession *pte, unsigned char mute)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01650">chan_unistim.c:1650</a></div></div>
<div class="ttc" id="indications_8h_html_a544e8a1dd4a986b00754103dda6a7d3b"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a544e8a1dd4a986b00754103dda6a7d3b">ast_playtones_start</a></div><div class="ttdeci">int ast_playtones_start(struct ast_channel *chan, int vol, const char *tonelist, int interruptible)</div><div class="ttdoc">Start playing a list of tones on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6e/indications_8c_source.html#l00302">indications.c:302</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a08adb2a0d7a88a3e367a72c9db8bf0f3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a08adb2a0d7a88a3e367a72c9db8bf0f3">handle_select_option</a></div><div class="ttdeci">static void handle_select_option(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03687">chan_unistim.c:3687</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac2de392d5ed9c66002a3204e1cbfede3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac2de392d5ed9c66002a3204e1cbfede3">send_start_rtp</a></div><div class="ttdeci">static void send_start_rtp(struct unistim_subchannel *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02710">chan_unistim.c:2710</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa8b299f82f6bd3e2ed26d27b933c850f"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa8b299f82f6bd3e2ed26d27b933c850f">finish_bookmark</a></div><div class="ttdeci">static void finish_bookmark(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06380">chan_unistim.c:6380</a></div></div>
<div class="ttc" id="structwsabuf_html_ac8ed9b9edf72a0bbde1ba01f0c67ef73"><div class="ttname"><a href="../../d7/d43/structwsabuf.html#ac8ed9b9edf72a0bbde1ba01f0c67ef73">wsabuf::buf</a></div><div class="ttdeci">unsigned char * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00350">chan_unistim.c:350</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a638c469948e7f81ea847ab1b2b3441d5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a638c469948e7f81ea847ab1b2b3441d5">get_tick_count</a></div><div class="ttdeci">static unsigned int get_tick_count(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00895">chan_unistim.c:895</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="acl_8h_html_ae839a9c2465be4e9a560dda668a65b9b"><div class="ttname"><a href="../../d5/d59/acl_8h.html#ae839a9c2465be4e9a560dda668a65b9b">ast_append_ha</a></div><div class="ttdeci">struct ast_ha * ast_append_ha(const char *sense, const char *stuff, struct ast_ha *path, int *error)</div><div class="ttdoc">Add a new rule to a list of HAs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00713">acl.c:713</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="structunistim__device_html_adf416dc058363e2fd5750c77e2d78bee"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#adf416dc058363e2fd5750c77e2d78bee">unistim_device::language</a></div><div class="ttdeci">char language[MAX_LANGUAGE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00412">chan_unistim.c:412</a></div></div>
<div class="ttc" id="structast__tone__zone__sound_html_a8f64897c7ccc5c13f276d1d07c4e7095"><div class="ttname"><a href="../../d5/dab/structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095">ast_tone_zone_sound::data</a></div><div class="ttdeci">const char * data</div><div class="ttdoc">Description of a tone. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0f/indications_8h_source.html#l00052">indications.h:52</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a77f59605d15d7dfc53e0df12352b8235"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a77f59605d15d7dfc53e0df12352b8235">ast_rtp_instance_set_prop</a></div><div class="ttdeci">void ast_rtp_instance_set_prop(struct ast_rtp_instance *instance, enum ast_rtp_property property, int value)</div><div class="ttdoc">Set the value of an RTP instance property. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00705">rtp_engine.c:705</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a361b448e9abcfc301602a2573a662d3c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a361b448e9abcfc301602a2573a662d3c">sched</a></div><div class="ttdeci">static struct ast_sched_context * sched</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00257">chan_unistim.c:257</a></div></div>
<div class="ttc" id="structunistim__line_html_ad2cfb0f821c065261382a9298bb5a16b"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#ad2cfb0f821c065261382a9298bb5a16b">unistim_line::amaflags</a></div><div class="ttdeci">int amaflags</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00383">chan_unistim.c:383</a></div></div>
<div class="ttc" id="netsock2_8h_html_aa60da39edcabcec05ca9219c7b290395"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aa60da39edcabcec05ca9219c7b290395">ast_sockaddr_to_sin</a></div><div class="ttdeci">#define ast_sockaddr_to_sin(addr, sin)</div><div class="ttdoc">Converts a struct ast_sockaddr to a struct sockaddr_in. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00769">netsock2.h:769</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="chan__unistim_8c_html_a45bfef5770afc080deaaf92890e1bf25"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a45bfef5770afc080deaaf92890e1bf25">show_entry_history</a></div><div class="ttdeci">static void show_entry_history(struct unistimsession *pte, FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03984">chan_unistim.c:3984</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac2025e985d45bb3084dfced90b9eea58"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac2025e985d45bb3084dfced90b9eea58">key_favorite</a></div><div class="ttdeci">static void key_favorite(struct unistimsession *, char)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03548">chan_unistim.c:3548</a></div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a281cbb83c5f382a3866221c3748b1d79"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a281cbb83c5f382a3866221c3748b1d79">packet_send_arrow</a></div><div class="ttdeci">static const unsigned char packet_send_arrow[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00633">chan_unistim.c:633</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abb13848a88adf2dd2e8d706a38daf915"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abb13848a88adf2dd2e8d706a38daf915">options_menu</a></div><div class="ttdeci">static struct unistim_menu_item options_menu[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00764">chan_unistim.c:764</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae6520d9b6a2dcd9dafdee9af3732039a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae6520d9b6a2dcd9dafdee9af3732039a">unistim_indicate</a></div><div class="ttdeci">static int unistim_indicate(struct ast_channel *ast, int ind, const void *data, size_t datalen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05333">chan_unistim.c:5333</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="format__cap_8h_html_a70a1555431677c29824be37afa5112e2"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a70a1555431677c29824be37afa5112e2">ast_format_cap_append_from_cap</a></div><div class="ttdeci">int ast_format_cap_append_from_cap(struct ast_format_cap *dst, const struct ast_format_cap *src, enum ast_media_type type)</div><div class="ttdoc">Append the formats of provided type in src to dst. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00269">format_cap.c:269</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a14caba3ed0e617a4646b027b68b3708e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a14caba3ed0e617a4646b027b68b3708e">handle_call_incoming</a></div><div class="ttdeci">static void handle_call_incoming(struct unistimsession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03262">chan_unistim.c:3262</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="format__cache_8h_html_ae4848b177c158d817294f2b0b447f66e"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#ae4848b177c158d817294f2b0b447f66e">ast_format_g729</a></div><div class="ttdeci">struct ast_format * ast_format_g729</div><div class="ttdoc">Built-in cached g729 format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00156">format_cache.c:156</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8ae70b75be2ab4e0505302761648376081">EXTENSION_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00130">chan_unistim.c:130</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0363a49deb6cb1314fd3e46d8c6ae475"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0363a49deb6cb1314fd3e46d8c6ae475">key_ringing</a></div><div class="ttdeci">static void key_ringing(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03515">chan_unistim.c:3515</a></div></div>
<div class="ttc" id="structunistim__device_html_a89ee76cd9909e38095ff9c5acf4df9db"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a89ee76cd9909e38095ff9c5acf4df9db">unistim_device::sharp_dial</a></div><div class="ttdeci">int sharp_dial</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00435">chan_unistim.c:435</a></div></div>
<div class="ttc" id="format__cap_8h_html_a5d2c52e9d892cd7c6488563cf00ba9bc"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a></div><div class="ttdeci">struct ast_format * ast_format_cap_get_format(const struct ast_format_cap *cap, int position)</div><div class="ttdoc">Get the format at a specific index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00400">format_cap.c:400</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abcff19481dd82016ca078857bc0b6260"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abcff19481dd82016ca078857bc0b6260">key_dial_page</a></div><div class="ttdeci">static void key_dial_page(struct unistimsession *pte, char keycode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03561">chan_unistim.c:3561</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
<div class="ttc" id="channel_8h_html_a915f6bcc0c9f9a9c214fcb8a400c3063"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a></div><div class="ttdeci">void ast_channel_internal_fd_set(struct ast_channel *chan, int which, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01161">channel_internal_api.c:1161</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a7ffb58d863fe0d6a77039ac81fdef6b3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a7ffb58d863fe0d6a77039ac81fdef6b3">display_last_error</a></div><div class="ttdeci">static void display_last_error(const char *sz_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00889">chan_unistim.c:889</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acc8157f72204da2f8e38a12aaf065455"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acc8157f72204da2f8e38a12aaf065455">change_callerid</a></div><div class="ttdeci">static void change_callerid(struct unistimsession *pte, int type, char *callerid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02472">chan_unistim.c:2472</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ace2fdc6c958af19b0108853e7de26ee8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ace2fdc6c958af19b0108853e7de26ee8">SELECTCODEC_MSG</a></div><div class="ttdeci">#define SELECTCODEC_MSG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03731">chan_unistim.c:3731</a></div></div>
<div class="ttc" id="structunistim__device_html_a6afdb918ecc1cb84112cf094144eb9dc"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a6afdb918ecc1cb84112cf094144eb9dc">unistim_device::ssub</a></div><div class="ttdeci">struct unistim_subchannel * ssub[FAVNUM]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00409">chan_unistim.c:409</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a871f307693ba0c6c8be5ff92395f73b1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a871f307693ba0c6c8be5ff92395f73b1">packet_rcv_discovery</a></div><div class="ttdeci">static const unsigned char packet_rcv_discovery[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00506">chan_unistim.c:506</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aecdce85ccff7b14dda4c797acab92b7a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aecdce85ccff7b14dda4c797acab92b7a">LED_HEADPHONE_OFF</a></div><div class="ttdeci">#define LED_HEADPHONE_OFF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00161">chan_unistim.c:161</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a69f342be6241cf144b32186890bb5e61"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a69f342be6241cf144b32186890bb5e61">unistim_senddigit_end</a></div><div class="ttdeci">static int unistim_senddigit_end(struct ast_channel *ast, char digit, unsigned int duration)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05519">chan_unistim.c:5519</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a11bb530f154228629c597a16a0dca5e9"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a11bb530f154228629c597a16a0dca5e9">init_phone_step2</a></div><div class="ttdeci">static void init_phone_step2(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04381">chan_unistim.c:4381</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a83af94bb19a421cb25ca02d16fa5ba9c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a83af94bb19a421cb25ca02d16fa5ba9c">restart_monitor</a></div><div class="ttdeci">static int restart_monitor(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05921">chan_unistim.c:5921</a></div></div>
<div class="ttc" id="structast__mwi__state_html"><div class="ttname"><a href="../../d6/d45/structast__mwi__state.html">ast_mwi_state</a></div><div class="ttdoc">The structure that contains MWI state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00457">mwi.h:457</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a012b2ab9fad02a5fbf9e457a69020ade"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a012b2ab9fad02a5fbf9e457a69020ade">ast_rtp_instance_new</a></div><div class="ttdeci">struct ast_rtp_instance * ast_rtp_instance_new(const char *engine_name, struct ast_sched_context *sched, const struct ast_sockaddr *sa, void *data)</div><div class="ttdoc">Create a new RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00465">rtp_engine.c:465</a></div></div>
<div class="ttc" id="structunistim__line_html_a970f3be80cbd08a1591eb8588f3cd54b"><div class="ttname"><a href="../../d2/dbf/structunistim__line.html#a970f3be80cbd08a1591eb8588f3cd54b">unistim_line::cap</a></div><div class="ttdeci">struct ast_format_cap * cap</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00384">chan_unistim.c:384</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a0b022dd7a866ccba5d24bab3f786fabc"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a0b022dd7a866ccba5d24bab3f786fabc">channel_to_session</a></div><div class="ttdeci">static struct unistimsession * channel_to_session(struct ast_channel *ast)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04794">chan_unistim.c:4794</a></div></div>
<div class="ttc" id="module_8h_html_aba2c8d4be709a254658b21a834f8294a"><div class="ttname"><a href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a></div><div class="ttdeci">#define ASTERISK_GPL_KEY</div><div class="ttdoc">The text the key() function should return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00046">module.h:46</a></div></div>
<div class="ttc" id="causes_8h_html_a9900b24b261c275bb54631f16d4d38cc"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a9900b24b261c275bb54631f16d4d38cc">AST_CAUSE_CALL_REJECTED</a></div><div class="ttdeci">#define AST_CAUSE_CALL_REJECTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00110">causes.h:110</a></div></div>
<div class="ttc" id="channel_8h_html_ae56cab679c0cda6436b930bc74297895"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae56cab679c0cda6436b930bc74297895">ast_channel_priority_set</a></div><div class="ttdeci">void ast_channel_priority_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00448">channel_internal_api.c:448</a></div></div>
<div class="ttc" id="rtp__engine_8h_html"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html">rtp_engine.h</a></div><div class="ttdoc">Pluggable RTP Architecture. </div></div>
<div class="ttc" id="bridge_8h_html"><div class="ttname"><a href="../../d4/d56/bridge_8h.html">bridge.h</a></div><div class="ttdoc">Bridging API. </div></div>
<div class="ttc" id="channel_8h_html_a2f18aafad0442206e71033ac6676dbb5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2f18aafad0442206e71033ac6676dbb5">ast_channel_alloc</a></div><div class="ttdeci">#define ast_channel_alloc(needqueue, state, cid_num, cid_name, acctcode, exten, context, assignedids, requestor, amaflag,...)</div><div class="ttdoc">Create a channel structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01259">channel.h:1259</a></div></div>
<div class="ttc" id="structustm__lang__entry_html_a74b2827216c30bba125661851d7f6063"><div class="ttname"><a href="../../df/dc9/structustm__lang__entry.html#a74b2827216c30bba125661851d7f6063">ustm_lang_entry::str_trans</a></div><div class="ttdeci">const char * str_trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00783">chan_unistim.c:783</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="chan__unistim_8c_html_a5d2d62f6194d019e260ebc679258f004"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5d2d62f6194d019e260ebc679258f004">is_key_line</a></div><div class="ttdeci">static int is_key_line(struct unistim_device *d, int fav)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01366">chan_unistim.c:1366</a></div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
<div class="ttc" id="chan__skinny_8c_html_aa0f575fa3882aa394cc287edba645a35"><div class="ttname"><a href="../../d0/d80/chan__skinny_8c.html#aa0f575fa3882aa394cc287edba645a35">hp</a></div><div class="ttdeci">static struct hostent * hp</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d80/chan__skinny_8c_source.html#l01236">chan_skinny.c:1236</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a5df5b980ae3a08f9219065c5ef191060"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a5df5b980ae3a08f9219065c5ef191060">send_end_call</a></div><div class="ttdeci">static void send_end_call(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01080">chan_unistim.c:1080</a></div></div>
<div class="ttc" id="paths_8h_html_ab6e1cd3d774ab1b31836a8777d3a812d"><div class="ttname"><a href="../../dd/df2/paths_8h.html#ab6e1cd3d774ab1b31836a8777d3a812d">ast_config_AST_VAR_DIR</a></div><div class="ttdeci">const char * ast_config_AST_VAR_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00157">options.c:157</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8b52e57503dad7f054703e44d27c992b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8b52e57503dad7f054703e44d27c992b">SELECTEXTENSION_MSG</a></div><div class="ttdeci">#define SELECTEXTENSION_MSG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03875">chan_unistim.c:3875</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a77054ec039b7ddcce41bbd752cb54cd8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a77054ec039b7ddcce41bbd752cb54cd8">FAV_ICON_REFLECT</a></div><div class="ttdeci">#define FAV_ICON_REFLECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00201">chan_unistim.c:201</a></div></div>
<div class="ttc" id="astdb_8h_html"><div class="ttname"><a href="../../de/d4a/astdb_8h.html">astdb.h</a></div><div class="ttdoc">Persistant data storage (akin to *doze registry) </div></div>
<div class="ttc" id="rtp__engine_8h_html_a5665ad0c5abe3c26005c39d6a3680fa1"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a5665ad0c5abe3c26005c39d6a3680fa1">ast_rtp_instance_get_remote_address</a></div><div class="ttdeci">#define ast_rtp_instance_get_remote_address(instance, address)</div><div class="ttdoc">Get the address of the remote endpoint that we are sending RTP to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l01192">rtp_engine.h:1192</a></div></div>
<div class="ttc" id="channel_8h_html_a929b8b2cb36308e5cf4e51ed880bfcba"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a></div><div class="ttdeci">void ast_channel_tech_pvt_set(struct ast_channel *chan, void *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00569">channel_internal_api.c:569</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aacb7ddf1a95fa544fdecada68213f3c7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aacb7ddf1a95fa544fdecada68213f3c7">AST_CONTROL_RADIO_KEY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00289">include/asterisk/frame.h:289</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1834d156a27a20350dc83367937d9bc4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1834d156a27a20350dc83367937d9bc4">packet_send_discovery_ack</a></div><div class="ttdeci">static const unsigned char packet_send_discovery_ack[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00508">chan_unistim.c:508</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html">app.h</a></div><div class="ttdoc">Application convenience functions, designed to give consistent look and feel to Asterisk apps...</div></div>
<div class="ttc" id="chan__unistim_8c_html_a6e7d55014285a51d55da36f86028b736"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6e7d55014285a51d55da36f86028b736">send_date_time2</a></div><div class="ttdeci">static void send_date_time2(struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01803">chan_unistim.c:1803</a></div></div>
<div class="ttc" id="structustm__lang__entry_html"><div class="ttname"><a href="../../df/dc9/structustm__lang__entry.html">ustm_lang_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00781">chan_unistim.c:781</a></div></div>
<div class="ttc" id="structunistim__device_html_ab6f077aef95d5bb43bb6e41c0abb7743"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#ab6f077aef95d5bb43bb6e41c0abb7743">unistim_device::extension_number</a></div><div class="ttdeci">char extension_number[11]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00448">chan_unistim.c:448</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a8bd4accafd4e712317ed9a471738a971af9312dd529fbb0d5abbd726b34d3f927"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a8bd4accafd4e712317ed9a471738a971af9312dd529fbb0d5abbd726b34d3f927">ISO_8859_2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00339">chan_unistim.c:339</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a4621bc4d2e56c21790efc3debe949b83"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a4621bc4d2e56c21790efc3debe949b83">unistim_senddigit_begin</a></div><div class="ttdeci">static int unistim_senddigit_begin(struct ast_channel *ast, char digit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05509">chan_unistim.c:5509</a></div></div>
<div class="ttc" id="structast__jb__conf_html"><div class="ttname"><a href="../../d7/dba/structast__jb__conf.html">ast_jb_conf</a></div><div class="ttdoc">General jitterbuffer configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d14/abstract__jb_8h_source.html#l00069">abstract_jb.h:69</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810aae15e6350cf0c536de2b3968941cb082"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810aae15e6350cf0c536de2b3968941cb082">KEY_MUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00320">chan_unistim.c:320</a></div></div>
<div class="ttc" id="structunistim__device_html_a87c42de19812445fe260742dc3762669"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a87c42de19812445fe260742dc3762669">unistim_device::silence_generator</a></div><div class="ttdeci">struct ast_silence_generator * silence_generator</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00450">chan_unistim.c:450</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af45200c89ff7be35391af577dab9dbe4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af45200c89ff7be35391af577dab9dbe4">unistim_get_rtp_peer</a></div><div class="ttdeci">static enum ast_rtp_glue_result unistim_get_rtp_peer(struct ast_channel *chan, struct ast_rtp_instance **instance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07030">chan_unistim.c:7030</a></div></div>
<div class="ttc" id="sched_8h_html_a862f869d056628b38e09042f21b54413"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a862f869d056628b38e09042f21b54413">ast_sched_context_destroy</a></div><div class="ttdeci">void ast_sched_context_destroy(struct ast_sched_context *c)</div><div class="ttdoc">destroys a schedule context </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00269">sched.c:269</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa3e60bae9ed59bd4a6501181ccc3976b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa3e60bae9ed59bd4a6501181ccc3976b">send_dtmf_tone</a></div><div class="ttdeci">static int send_dtmf_tone(struct unistimsession *pte, char digit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l03329">chan_unistim.c:3329</a></div></div>
<div class="ttc" id="causes_8h_html_a0a35518d7b448a53da368cf57f354fba"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a0a35518d7b448a53da368cf57f354fba">AST_CAUSE_CONGESTION</a></div><div class="ttdeci">#define AST_CAUSE_CONGESTION</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00152">causes.h:152</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_abd716cc271a9fefb0d4f1a9679bc5fb3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#abd716cc271a9fefb0d4f1a9679bc5fb3">send_expansion_short</a></div><div class="ttdeci">static void send_expansion_short(unsigned char pos, unsigned char status, struct unistimsession *pte)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01306">chan_unistim.c:1306</a></div></div>
<div class="ttc" id="lock_8h_html_ac840092853644cea0a186efdc58985f5"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a></div><div class="ttdeci">#define AST_MUTEX_DEFINE_STATIC(mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00518">lock.h:518</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adb32f160a7cd6aba3a2f22c47a4919ae">KEY_FAV5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00328">chan_unistim.c:328</a></div></div>
<div class="ttc" id="indications_8h_html_a5bd91799d8e718f389e20acc253c5158"><div class="ttname"><a href="../../d2/d0f/indications_8h.html#a5bd91799d8e718f389e20acc253c5158">ast_tone_zone_part_parse</a></div><div class="ttdeci">int ast_tone_zone_part_parse(const char *s, struct ast_tone_zone_part *tone_data)</div><div class="ttdoc">Parse a tone part. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6e/indications_8c_source.html#l00245">indications.c:245</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1c1c0bab850dfe26207ce5946ce3f6a5"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1c1c0bab850dfe26207ce5946ce3f6a5">sub_stop_silence</a></div><div class="ttdeci">static void sub_stop_silence(struct unistimsession *pte, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02544">chan_unistim.c:2544</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">include/asterisk/frame.h:285</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a977571324fa31e1c1c049f7b6e23cbd4"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a977571324fa31e1c1c049f7b6e23cbd4">packet_send_charset_iso_8859_2</a></div><div class="ttdeci">static const unsigned char packet_send_charset_iso_8859_2[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00682">chan_unistim.c:682</a></div></div>
<div class="ttc" id="structast__tm_html_a987fa9280fe4cd6c6b8f77409f1c1504"><div class="ttname"><a href="../../d5/d84/structast__tm.html#a987fa9280fe4cd6c6b8f77409f1c1504">ast_tm::tm_min</a></div><div class="ttdeci">int tm_min</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00037">localtime.h:37</a></div></div>
<div class="ttc" id="structast__mutex__info_html"><div class="ttname"><a href="../../d8/dc5/structast__mutex__info.html">ast_mutex_info</a></div><div class="ttdoc">Structure for mutex and tracking information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00135">lock.h:135</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810adf5414980ef63b19bec7d6a1fe2b615a">KEY_FUNC1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00314">chan_unistim.c:314</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a9ebdbdde6bd9f2fb35b6fcfef31a784d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a9ebdbdde6bd9f2fb35b6fcfef31a784d">unistim_show_info</a></div><div class="ttdeci">static char * unistim_show_info(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l06035">chan_unistim.c:6035</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_adc081386f3fc6b3a00b036928e688937"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#adc081386f3fc6b3a00b036928e688937">sub_start_silence</a></div><div class="ttdeci">static void sub_start_silence(struct unistimsession *pte, struct unistim_subchannel *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l02529">chan_unistim.c:2529</a></div></div>
<div class="ttc" id="structunistim__device_html_a2821edf21d42cbfb1126f7d134d091ef"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a2821edf21d42cbfb1126f7d134d091ef">unistim_device::redial_number</a></div><div class="ttdeci">char redial_number[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00400">chan_unistim.c:400</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a777f3eee179c21b6e4093e98b720bd8e"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a777f3eee179c21b6e4093e98b720bd8e">DEFAULTCONTEXT</a></div><div class="ttdeci">#define DEFAULTCONTEXT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00083">chan_unistim.c:83</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a72adc862c84ef019effe055d5f12d9c6"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a72adc862c84ef019effe055d5f12d9c6">SIZE_PAGE</a></div><div class="ttdeci">#define SIZE_PAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00111">chan_unistim.c:111</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a1cc482381672ad23b589814decda5779"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a1cc482381672ad23b589814decda5779">send_ring</a></div><div class="ttdeci">static void send_ring(struct unistimsession *pte, signed char volume, signed char style)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l01719">chan_unistim.c:1719</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a770835090a62ffba489c16c484b417da"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a770835090a62ffba489c16c484b417da">FAV_ICON_OFFHOOK_BLACK</a></div><div class="ttdeci">#define FAV_ICON_OFFHOOK_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00182">chan_unistim.c:182</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a923be8ed0cb9e8671c4a4438b61355e8"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8">autoprov_extn</a></div><div class="ttdeci">autoprov_extn</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00128">chan_unistim.c:128</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a8e272a4ee35206ff8c4c0384b9e3f592"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a8e272a4ee35206ff8c4c0384b9e3f592">ast_rtp_instance_read</a></div><div class="ttdeci">struct ast_frame * ast_rtp_instance_read(struct ast_rtp_instance *instance, int rtcp)</div><div class="ttdoc">Receive a frame over RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l00578">rtp_engine.c:578</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada1977972b61b0c59a293eac20d5bba00b">STATE_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00279">chan_unistim.c:279</a></div></div>
<div class="ttc" id="structunistim__menu__item_html"><div class="ttname"><a href="../../d3/df2/structunistim__menu__item.html">unistim_menu_item</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00481">chan_unistim.c:481</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a813aeea6a30d10c1b157bd726952e0e3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a813aeea6a30d10c1b157bd726952e0e3">unistimsock_read</a></div><div class="ttdeci">static int unistimsock_read(int *id, int fd, short events, void *ignore)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l05089">chan_unistim.c:5089</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a054bea4b6e8c64e1a50e075756692a55"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a054bea4b6e8c64e1a50e075756692a55">unistim_reload_lock</a></div><div class="ttdeci">static ast_mutex_t unistim_reload_lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00261">chan_unistim.c:261</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a6aa58a7eefc67ad27b485fe141c3a605"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a6aa58a7eefc67ad27b485fe141c3a605">unistim_tech</a></div><div class="ttdeci">static struct ast_channel_tech unistim_tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00736">chan_unistim.c:736</a></div></div>
<div class="ttc" id="format__cache_8h_html"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html">format_cache.h</a></div><div class="ttdoc">Media Format Cache API. </div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="structunistim__device_html_a15d84cbaa057337de28b941357fa3a3d"><div class="ttname"><a href="../../d1/d66/structunistim__device.html#a15d84cbaa057337de28b941357fa3a3d">unistim_device::maintext2</a></div><div class="ttdeci">char maintext2[25]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00416">chan_unistim.c:416</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aae4816e76bb1382481a5941ac7057bef"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aae4816e76bb1382481a5941ac7057bef">monlock</a></div><div class="ttdeci">static ast_mutex_t monlock</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00269">chan_unistim.c:269</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a923be8ed0cb9e8671c4a4438b61355e8a55fed7a1fe673203a534ce6822e2cb84">EXTENSION_TN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00136">chan_unistim.c:136</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa122fab794f6bb53d8a5514603a3c0f0"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa122fab794f6bb53d8a5514603a3c0f0">packet_send_ping</a></div><div class="ttdeci">static unsigned char packet_send_ping[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00701">chan_unistim.c:701</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a34c7494bbb0ecf644d4ad988cd9099ed">KEY_FUNC4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00317">chan_unistim.c:317</a></div></div>
<div class="ttc" id="structast__features__pickup__config_html"><div class="ttname"><a href="../../d2/d6f/structast__features__pickup__config.html">ast_features_pickup_config</a></div><div class="ttdoc">Configuration relating to call pickup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00137">include/asterisk/features_config.h:137</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01119">bridge.h:1119</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a6504370d9c6391e1a9da6a1a529b089d"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a6504370d9c6391e1a9da6a1a529b089d">KEY_RIGHT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00310">chan_unistim.c:310</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810a5f2a6eb4fd018338d14d258623ed851c"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810a5f2a6eb4fd018338d14d258623ed851c">KEY_COMPUTR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00329">chan_unistim.c:329</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ad77431a9a32bcda1415b79a4f710b4ada3828d60c6c62b58c8d4f8d85184762d3">STATE_CLEANING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00286">chan_unistim.c:286</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ae8c0cf3a8ca2a0b39e99e47ea59ceaa1"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ae8c0cf3a8ca2a0b39e99e47ea59ceaa1">packet_recv_r2</a></div><div class="ttdeci">static const unsigned char packet_recv_r2[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00521">chan_unistim.c:521</a></div></div>
<div class="ttc" id="utils_8h_html_a7c38859ed90e96df2b0a0fdf843769d0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a></div><div class="ttdeci">int ast_mkdir(const char *path, int mode)</div><div class="ttdoc">Recursively create directory path. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02231">main/utils.c:2231</a></div></div>
<div class="ttc" id="callerid_8h_html_a39e03ca4e8df3a1d2c75e888d76201df"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a39e03ca4e8df3a1d2c75e888d76201df">ast_callerid_parse</a></div><div class="ttdeci">int ast_callerid_parse(char *instr, char **name, char **location)</div><div class="ttdoc">Destructively parse inbuf into name and location (or number) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01008">callerid.c:1008</a></div></div>
<div class="ttc" id="channel_8h_html_aa62371d642974c67a0c0efa77d54fcbdafb2c9cea57f7fc8e0350ed6f60cbb892"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa62371d642974c67a0c0efa77d54fcbdafb2c9cea57f7fc8e0350ed6f60cbb892">AST_CHAN_TP_CREATESJITTER</a></div><div class="ttdoc">Channels have this property if they can create jitter; i.e. most VoIP channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00966">channel.h:966</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_ac7c590dfb884af4ae2c34f222fc0e810ac4e3446f25095a6b0a6b29b275c675fb"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#ac7c590dfb884af4ae2c34f222fc0e810ac4e3446f25095a6b0a6b29b275c675fb">KEY_ONHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00318">chan_unistim.c:318</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_aa80c74c9a7415712e0143bb382a8ae53"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#aa80c74c9a7415712e0143bb382a8ae53">ustm_strcopy</a></div><div class="ttdeci">static char ustm_strcopy[1024]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00779">chan_unistim.c:779</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_af47f9831ea4869f1785fcd8724552d68"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#af47f9831ea4869f1785fcd8724552d68">unistim_rtp_glue</a></div><div class="ttdeci">static struct ast_rtp_glue unistim_rtp_glue</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l07075">chan_unistim.c:7075</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8">AST_CONTROL_SRCCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00303">include/asterisk/frame.h:303</a></div></div>
<div class="ttc" id="io_8h_html_a7d66d121ef63109c2f55188a38b8240f"><div class="ttname"><a href="../../dc/dac/io_8h.html#a7d66d121ef63109c2f55188a38b8240f">io_context_create</a></div><div class="ttdeci">struct io_context * io_context_create(void)</div><div class="ttdoc">Creates a context Create a context for I/O operations Basically mallocs an IO structure and sets up s...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/io_8c_source.html#l00081">io.c:81</a></div></div>
<div class="ttc" id="format__cap_8h_html_a9c9b87b5062c057862aa7d4237db2780"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a9c9b87b5062c057862aa7d4237db2780">ast_format_cap_iscompatible</a></div><div class="ttdeci">int ast_format_cap_iscompatible(const struct ast_format_cap *cap1, const struct ast_format_cap *cap2)</div><div class="ttdoc">Determine if any joint capabilities exist between two capabilities structures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00655">format_cap.c:655</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_a49b1b1d539ed0d1c3ef35e72de1a5031"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#a49b1b1d539ed0d1c3ef35e72de1a5031">send_raw_client</a></div><div class="ttdeci">static void send_raw_client(int size, const unsigned char *data, struct sockaddr_in *addr_to, const struct sockaddr_in *addr_ourip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l00903">chan_unistim.c:903</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:43:36 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
