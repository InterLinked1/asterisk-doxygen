<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: taskprocessor.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">taskprocessor.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>An API for managing task processing threads that can be shared across modules.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d2d/taskprocessor_8h__dep__incl.png" border="0" usemap="#taskprocessor_8hdep" alt=""/></div>
<map name="taskprocessor_8hdep" id="taskprocessor_8hdep">
<area shape="rect" id="node2" href="../../d0/dcf/app__confbridge_8c.html" title="Conference Bridge application. " alt="" coords="5,87,136,114"/>
<area shape="rect" id="node3" href="../../da/dfb/app__queue_8c.html" title="True call queues with optional send URL on answer. " alt="" coords="160,87,264,114"/>
<area shape="rect" id="node4" href="../../dc/df4/app__voicemail_8c.html" title="Comedian Mail &#45; Voicemail System. " alt="" coords="289,87,413,114"/>
<area shape="rect" id="node5" href="../../d5/dff/chan__iax2_8c.html" title="Implementation of Inter&#45;Asterisk eXchange Version 2 as specified in RFC 5456. " alt="" coords="437,87,534,114"/>
<area shape="rect" id="node6" href="../../d0/d29/chan__pjsip_8c.html" title="PSJIP SIP Channel Driver. " alt="" coords="558,87,658,114"/>
<area shape="rect" id="node7" href="../../d3/d5a/ccss_8c.html" title="Call Completion Supplementary Services implementation. " alt="" coords="683,87,744,114"/>
<area shape="rect" id="node8" href="../../dc/df2/cdr_8c.html" title="Call Detail Record API. " alt="" coords="769,87,821,114"/>
<area shape="rect" id="node9" href="../../da/dc9/cel_8c.html" title="Channel Event Logging API. " alt="" coords="845,87,896,114"/>
<area shape="rect" id="node10" href="../../df/d3a/dns__system__resolver_8c.html" title="The default DNS resolver for Asterisk. " alt="" coords="921,87,1087,114"/>
<area shape="rect" id="node11" href="../../d0/deb/event_8c.html" title="Internal generic event system. " alt="" coords="1112,87,1181,114"/>
<area shape="rect" id="node12" href="../../d4/d10/manager_8c.html" title="The Asterisk Management Interface &#45; AMI. " alt="" coords="1205,87,1296,114"/>
<area shape="rect" id="node13" href="../../d0/d6d/message_8c.html" title="Out&#45;of&#45;call text message support. " alt="" coords="1321,87,1413,114"/>
<area shape="rect" id="node14" href="../../db/d94/pbx_8c.html" title="Core PBX routines. " alt="" coords="1437,87,1493,114"/>
<area shape="rect" id="node15" href="../../d6/dd3/serializer_8c.html" title="serializer.c" alt="" coords="1518,87,1607,114"/>
<area shape="rect" id="node16" href="../../d7/d69/sorcery_8c.html" title="Sorcery Data Access Layer API. " alt="" coords="1631,87,1710,114"/>
<area shape="rect" id="node17" href="../../d0/df4/stasis_8c.html" title="Stasis Message Bus API. " alt="" coords="1734,87,1805,114"/>
<area shape="rect" id="node18" href="../../d4/deb/taskprocessor_8c.html" title="Maintain a container of uniquely&#45;named taskprocessor threads that can be shared across modules..." alt="" coords="1829,87,1952,114"/>
<area shape="rect" id="node19" href="../../d1/dc7/threadpool_8c.html" title="threadpool.c" alt="" coords="1977,87,2079,114"/>
<area shape="rect" id="node20" href="../../d1/da4/res__corosync_8c.html" title="res_corosync.c" alt="" coords="2104,87,2221,114"/>
<area shape="rect" id="node21" href="../../db/d43/res__hep_8c.html" title="Routines for integration with Homer using HEPv3. " alt="" coords="2246,87,2330,114"/>
<area shape="rect" id="node22" href="../../dd/dfd/config__global_8c.html" title="config_global.c" alt="" coords="2354,87,2470,114"/>
<area shape="rect" id="node23" href="../../d0/dad/location_8c.html" title="location.c" alt="" coords="2495,87,2577,114"/>
<area shape="rect" id="node24" href="../../d7/dad/pjsip__distributor_8c.html" title="pjsip_distributor.c" alt="" coords="2601,87,2735,114"/>
<area shape="rect" id="node25" href="../../df/dda/pjsip__options_8c.html" title="pjsip_options.c" alt="" coords="2759,87,2875,114"/>
<area shape="rect" id="node26" href="../../d4/d43/pjsip__resolver_8c.html" title="pjsip_resolver.c" alt="" coords="2899,87,3018,114"/>
<area shape="rect" id="node27" href="../../de/dfa/pjsip__scheduler_8c.html" title="res_pjsip Scheduler " alt="" coords="3041,87,3172,114"/>
<area shape="rect" id="node28" href="../../de/d96/res__pjsip_8c.html" title="res_pjsip.c" alt="" coords="3197,87,3286,114"/>
<area shape="rect" id="node29" href="../../d2/d3d/res__pjsip__exten__state_8c.html" title="res_pjsip_exten_state.c" alt="" coords="3310,87,3482,114"/>
<area shape="rect" id="node30" href="../../da/d83/res__pjsip__messaging_8c.html" title="res_pjsip_messaging.c" alt="" coords="3506,87,3673,114"/>
<area shape="rect" id="node31" href="../../d8/d25/res__pjsip__mwi_8c.html" title="res_pjsip_mwi.c" alt="" coords="3697,87,3818,114"/>
<area shape="rect" id="node32" href="../../df/d3a/res__pjsip__outbound__publish_8c.html" title="res_pjsip_outbound\l_publish.c" alt="" coords="3843,80,3989,121"/>
<area shape="rect" id="node33" href="../../d9/d96/res__pjsip__outbound__registration_8c.html" title="res_pjsip_outbound\l_registration.c" alt="" coords="4013,80,4160,121"/>
<area shape="rect" id="node34" href="../../d8/dca/res__pjsip__pubsub_8c.html" title="res_pjsip_pubsub.c" alt="" coords="4185,87,4327,114"/>
<area shape="rect" id="node35" href="../../d1/d75/res__pjsip__refer_8c.html" title="res_pjsip_refer.c" alt="" coords="4352,87,4477,114"/>
<area shape="rect" id="node36" href="../../d3/db0/res__pjsip__registrar_8c.html" title="res_pjsip_registrar.c" alt="" coords="4501,87,4651,114"/>
<area shape="rect" id="node37" href="../../d4/d92/res__pjsip__session_8c.html" title="res_pjsip_session.c" alt="" coords="4675,87,4819,114"/>
<area shape="rect" id="node38" href="../../d2/db8/res__pjsip__transport__websocket_8c.html" title="res_pjsip_transport\l_websocket.c" alt="" coords="4843,80,4987,121"/>
<area shape="rect" id="node39" href="../../dc/dce/test__res__pjsip__scheduler_8c.html" title="res_pjsip scheduler tests " alt="" coords="5011,87,5200,114"/>
<area shape="rect" id="node40" href="../../df/df7/test__taskprocessor_8c.html" title="taskprocessor unit tests " alt="" coords="5224,87,5379,114"/>
<area shape="rect" id="node41" href="../../de/dec/test__threadpool_8c.html" title="threadpool unit tests " alt="" coords="5403,87,5538,114"/>
</map>
</div>
</div>
<p><a href="../../d0/d1e/taskprocessor_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d01/structast__taskprocessor__listener__callbacks.html">ast_taskprocessor_listener_callbacks</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local data parameter.  <a href="../../dc/ded/structast__taskprocessor__local.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad4a3db2b08877779bd481a649318be7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ad4a3db2b08877779bd481a649318be7d">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:ad4a3db2b08877779bd481a649318be7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4c5a237767eb6db5b1db41ccdfc689"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a>&#160;&#160;&#160;70</td></tr>
<tr class="memdesc:adf4c5a237767eb6db5b1db41ccdfc689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suggested maximum taskprocessor name length (less null terminator).  <a href="#adf4c5a237767eb6db5b1db41ccdfc689">More...</a><br /></td></tr>
<tr class="separator:adf4c5a237767eb6db5b1db41ccdfc689"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a42ae78df3dc5106c133bf2f7b72080f7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7">ast_tps_options</a> { <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7ae248d04bb7a6b5e0906e4906af4ee35a">TPS_REF_DEFAULT</a> = 0, 
<a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a> = (1 &lt;&lt; 0)
 }<tr class="memdesc:a42ae78df3dc5106c133bf2f7b72080f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">ast_tps_options for specification of taskprocessor options  <a href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a42ae78df3dc5106c133bf2f7b72080f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a44bed16d2b07a7dc2bbb0134372acfb7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a44bed16d2b07a7dc2bbb0134372acfb7">ast_taskprocessor_alert_get</a> (void)</td></tr>
<tr class="memdesc:a44bed16d2b07a7dc2bbb0134372acfb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current taskprocessor high water alert count.  <a href="#a44bed16d2b07a7dc2bbb0134372acfb7">More...</a><br /></td></tr>
<tr class="separator:a44bed16d2b07a7dc2bbb0134372acfb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d9150df7126ae11064d38c755d0813"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ad4d9150df7126ae11064d38c755d0813">ast_taskprocessor_alert_set_levels</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps, long low_water, long high_water)</td></tr>
<tr class="memdesc:ad4d9150df7126ae11064d38c755d0813"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the high and low alert water marks of the given taskprocessor queue.  <a href="#ad4d9150df7126ae11064d38c755d0813">More...</a><br /></td></tr>
<tr class="separator:ad4d9150df7126ae11064d38c755d0813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab47623e207bf2cdd0edfa613d91894e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a> (char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, unsigned int size, const char *<a class="el" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>,...)</td></tr>
<tr class="memdesc:ab47623e207bf2cdd0edfa613d91894e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a taskprocessor name with a sequence number on the end.  <a href="#ab47623e207bf2cdd0edfa613d91894e5">More...</a><br /></td></tr>
<tr class="separator:ab47623e207bf2cdd0edfa613d91894e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79575eb73e817bd3afe77c87308e8be"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ab79575eb73e817bd3afe77c87308e8be">ast_taskprocessor_create_with_listener</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *<a class="el" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>)</td></tr>
<tr class="memdesc:ab79575eb73e817bd3afe77c87308e8be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a taskprocessor with a custom listener.  <a href="#ab79575eb73e817bd3afe77c87308e8be">More...</a><br /></td></tr>
<tr class="separator:ab79575eb73e817bd3afe77c87308e8be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9318e041c0564532581e864cda8f9426"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a9318e041c0564532581e864cda8f9426">ast_taskprocessor_execute</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a9318e041c0564532581e864cda8f9426"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pop a task off the taskprocessor and execute it.  <a href="#a9318e041c0564532581e864cda8f9426">More...</a><br /></td></tr>
<tr class="separator:a9318e041c0564532581e864cda8f9426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac999cc9523590a29dff6acbd9cad24a9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ac999cc9523590a29dff6acbd9cad24a9">ast_taskprocessor_get</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, enum <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7">ast_tps_options</a> create)</td></tr>
<tr class="memdesc:ac999cc9523590a29dff6acbd9cad24a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary.  <a href="#ac999cc9523590a29dff6acbd9cad24a9">More...</a><br /></td></tr>
<tr class="separator:ac999cc9523590a29dff6acbd9cad24a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee66f3c01dde2a5c3762c0f30581563"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#aaee66f3c01dde2a5c3762c0f30581563">ast_taskprocessor_get_subsystem_alert</a> (const char *subsystem)</td></tr>
<tr class="memdesc:aaee66f3c01dde2a5c3762c0f30581563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current taskprocessor high water alert count by sybsystem.  <a href="#aaee66f3c01dde2a5c3762c0f30581563">More...</a><br /></td></tr>
<tr class="separator:aaee66f3c01dde2a5c3762c0f30581563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f9fcdd63017df32ddb3b2601d1e223"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a37f9fcdd63017df32ddb3b2601d1e223">ast_taskprocessor_is_suspended</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a37f9fcdd63017df32ddb3b2601d1e223"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the task processor suspend status.  <a href="#a37f9fcdd63017df32ddb3b2601d1e223">More...</a><br /></td></tr>
<tr class="separator:a37f9fcdd63017df32ddb3b2601d1e223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a66670abd8be00ab53bd9125a57574f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a4a66670abd8be00ab53bd9125a57574f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Am I the given taskprocessor's current task.  <a href="#a4a66670abd8be00ab53bd9125a57574f">More...</a><br /></td></tr>
<tr class="separator:a4a66670abd8be00ab53bd9125a57574f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d5e40a1f7eac54dcad096b90d013bd"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#ad7d5e40a1f7eac54dcad096b90d013bd">ast_taskprocessor_listener_alloc</a> (const struct <a class="el" href="../../d0/d01/structast__taskprocessor__listener__callbacks.html">ast_taskprocessor_listener_callbacks</a> *callbacks, void *user_data)</td></tr>
<tr class="memdesc:ad7d5e40a1f7eac54dcad096b90d013bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a taskprocessor listener.  <a href="#ad7d5e40a1f7eac54dcad096b90d013bd">More...</a><br /></td></tr>
<tr class="separator:ad7d5e40a1f7eac54dcad096b90d013bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b19a24ebd6df46be8ab735226c7d6a3"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6b19a24ebd6df46be8ab735226c7d6a3">ast_taskprocessor_listener_get_tps</a> (const struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *<a class="el" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>)</td></tr>
<tr class="memdesc:a6b19a24ebd6df46be8ab735226c7d6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to the listener's taskprocessor.  <a href="#a6b19a24ebd6df46be8ab735226c7d6a3">More...</a><br /></td></tr>
<tr class="separator:a6b19a24ebd6df46be8ab735226c7d6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6906b13a7a37512e36dd1f5148589481"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6906b13a7a37512e36dd1f5148589481">ast_taskprocessor_listener_get_user_data</a> (const struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *<a class="el" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>)</td></tr>
<tr class="memdesc:a6906b13a7a37512e36dd1f5148589481"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the user data from the listener.  <a href="#a6906b13a7a37512e36dd1f5148589481">More...</a><br /></td></tr>
<tr class="separator:a6906b13a7a37512e36dd1f5148589481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6541086de52447afa994cbfcb792ec"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#aaa6541086de52447afa994cbfcb792ec">ast_taskprocessor_name</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:aaa6541086de52447afa994cbfcb792ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the name of the taskprocessor singleton.  <a href="#aaa6541086de52447afa994cbfcb792ec">More...</a><br /></td></tr>
<tr class="separator:aaa6541086de52447afa994cbfcb792ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0cc7cda2fe82f4c7df4dbdc57b1372"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6f0cc7cda2fe82f4c7df4dbdc57b1372">ast_taskprocessor_name_append</a> (char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, unsigned int size, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a6f0cc7cda2fe82f4c7df4dbdc57b1372"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append the next sequence number to the given string, and copy into the buffer.  <a href="#a6f0cc7cda2fe82f4c7df4dbdc57b1372">More...</a><br /></td></tr>
<tr class="separator:a6f0cc7cda2fe82f4c7df4dbdc57b1372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2508ba0a6b8f43ae6d3963f3189585"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6b2508ba0a6b8f43ae6d3963f3189585">ast_taskprocessor_push</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps, int(*task_exe)(void *datap), void *datap) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:a6b2508ba0a6b8f43ae6d3963f3189585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push a task into the specified taskprocessor queue and signal the taskprocessor thread.  <a href="#a6b2508ba0a6b8f43ae6d3963f3189585">More...</a><br /></td></tr>
<tr class="separator:a6b2508ba0a6b8f43ae6d3963f3189585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7049467cda8b796bff04ce8bba34b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6d7049467cda8b796bff04ce8bba34b5">ast_taskprocessor_push_local</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps, int(*task_exe)(struct <a class="el" href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a> *local), void *datap) <a class="el" href="../../d4/dd1/compiler_8h.html#ab3b3fbf14bd20f49a667b208fee6a07a">attribute_warn_unused_result</a></td></tr>
<tr class="memdesc:a6d7049467cda8b796bff04ce8bba34b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push a task into the specified taskprocessor queue and signal the taskprocessor thread.  <a href="#a6d7049467cda8b796bff04ce8bba34b5">More...</a><br /></td></tr>
<tr class="separator:a6d7049467cda8b796bff04ce8bba34b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d17cb910ea569aa91235d174c126f55"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6d17cb910ea569aa91235d174c126f55">ast_taskprocessor_seq_num</a> (void)</td></tr>
<tr class="memdesc:a6d17cb910ea569aa91235d174c126f55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the next sequence number to create a human friendly taskprocessor name.  <a href="#a6d17cb910ea569aa91235d174c126f55">More...</a><br /></td></tr>
<tr class="separator:a6d17cb910ea569aa91235d174c126f55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208c9f9b930e83c7bdb833c66f13d5e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a208c9f9b930e83c7bdb833c66f13d5e8">ast_taskprocessor_set_local</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps, void *local_data)</td></tr>
<tr class="memdesc:a208c9f9b930e83c7bdb833c66f13d5e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the local data associated with a taskprocessor.  <a href="#a208c9f9b930e83c7bdb833c66f13d5e8">More...</a><br /></td></tr>
<tr class="separator:a208c9f9b930e83c7bdb833c66f13d5e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d09062fb3c84cf1c84a04174deb2bf"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a83d09062fb3c84cf1c84a04174deb2bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current size of the taskprocessor queue.  <a href="#a83d09062fb3c84cf1c84a04174deb2bf">More...</a><br /></td></tr>
<tr class="separator:a83d09062fb3c84cf1c84a04174deb2bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea7131da6b62d2e9b5d91c5de529d6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#aeea7131da6b62d2e9b5d91c5de529d6c">ast_taskprocessor_suspend</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:aeea7131da6b62d2e9b5d91c5de529d6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate the taskprocessor is suspended.  <a href="#aeea7131da6b62d2e9b5d91c5de529d6c">More...</a><br /></td></tr>
<tr class="separator:aeea7131da6b62d2e9b5d91c5de529d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32492eb2480cb8c46ad669622cff8556"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a32492eb2480cb8c46ad669622cff8556"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unreference the specified taskprocessor and its reference count will decrement.  <a href="#a32492eb2480cb8c46ad669622cff8556">More...</a><br /></td></tr>
<tr class="separator:a32492eb2480cb8c46ad669622cff8556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8460a4b877658e3c2a6abbafcfa4c54c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/taskprocessor_8h.html#a8460a4b877658e3c2a6abbafcfa4c54c">ast_taskprocessor_unsuspend</a> (struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps)</td></tr>
<tr class="memdesc:a8460a4b877658e3c2a6abbafcfa4c54c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate the taskprocessor is unsuspended.  <a href="#a8460a4b877658e3c2a6abbafcfa4c54c">More...</a><br /></td></tr>
<tr class="separator:a8460a4b877658e3c2a6abbafcfa4c54c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An API for managing task processing threads that can be shared across modules. </p>
<dl class="section author"><dt>Author</dt><dd>Dwayne M. Hubbard <a href="#" onclick="location.href='mai'+'lto:'+'dhu'+'bb'+'ard'+'@d'+'igi'+'um'+'.co'+'m'; return false;">dhubb<span style="display: none;">.nosp@m.</span>ard@<span style="display: none;">.nosp@m.</span>digiu<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>A taskprocessor is a named object containing a task queue that serializes tasks pushed into it by [a] module(s) that reference the taskprocessor. A taskprocessor is created the first time its name is requested via the <a class="el" href="../../d0/d1e/taskprocessor_8h.html#ac999cc9523590a29dff6acbd9cad24a9" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary...">ast_taskprocessor_get()</a> function or the <a class="el" href="../../d0/d1e/taskprocessor_8h.html#ab79575eb73e817bd3afe77c87308e8be" title="Create a taskprocessor with a custom listener. ">ast_taskprocessor_create_with_listener()</a> function and destroyed when the taskprocessor reference count reaches zero. A taskprocessor also contains an accompanying listener that is notified when changes in the task queue occur.</dd></dl>
<p>A task is a wrapper around a task-handling function pointer and a data pointer. A task is pushed into a taskprocessor queue using the ast_taskprocessor_push(taskprocessor, taskhandler, taskdata) function and freed by the taskprocessor after the task handling function returns. A module releases its reference to a taskprocessor using the <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556" title="Unreference the specified taskprocessor and its reference count will decrement. ">ast_taskprocessor_unreference()</a> function which may result in the destruction of the taskprocessor if the taskprocessor's reference count reaches zero. When the taskprocessor's reference count reaches zero, its listener's shutdown() callback will be called. Any further attempts to execute tasks will be denied.</p>
<p>The taskprocessor listener has the flexibility of doling out tasks to best fit the module's needs. For instance, a taskprocessor listener may have a single dispatch thread that handles all tasks, or it may dispatch tasks to a thread pool.</p>
<p>There is a default taskprocessor listener that will be used if a taskprocessor is created without any explicit listener. This default listener runs tasks sequentially in a single thread. The listener will execute tasks as long as there are tasks to be processed. When the taskprocessor is shut down, the default listener will stop processing tasks and join its execution thread. </p>

<p class="definition">Definition in file <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">taskprocessor.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad4a3db2b08877779bd481a649318be7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a3db2b08877779bd481a649318be7d">&#9670;&nbsp;</a></span>AST_TASKPROCESSOR_HIGH_WATER_LEVEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_TASKPROCESSOR_HIGH_WATER_LEVEL&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default taskprocessor high water level alert trigger </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00063">63</a> of file <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">taskprocessor.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00983">__allocate_taskprocessor()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13680">actual_load_config()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02918">ast_res_pjsip_init_options_handling()</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00156">ast_serializer_pool_set_alerts()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l01366">ast_sip_initialize_sorcery_location()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01500">create_routes()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04522">load_module()</a>, and <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>.</p>

</div>
</div>
<a id="adf4c5a237767eb6db5b1db41ccdfc689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4c5a237767eb6db5b1db41ccdfc689">&#9670;&nbsp;</a></span>AST_TASKPROCESSOR_MAX_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_TASKPROCESSOR_MAX_NAME&#160;&#160;&#160;70</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Suggested maximum taskprocessor name length (less null terminator). </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00060">60</a> of file <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">taskprocessor.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01496">alloc_playback_chan()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00076">ast_serializer_pool_create()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d2/db8/res__pjsip__transport__websocket_8c_source.html#l00349">create_websocket_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01243">distributor_pool_setup()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00382">refer_progress_alloc()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00963">sip_options_aor_alloc()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01033">sip_outbound_publisher_alloc()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01314">sip_outbound_registration_state_alloc()</a>, and <a class="el" href="../../d7/d69/sorcery_8c_source.html#l00700">sorcery_object_type_alloc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a42ae78df3dc5106c133bf2f7b72080f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ae78df3dc5106c133bf2f7b72080f7">&#9670;&nbsp;</a></span>ast_tps_options</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7">ast_tps_options</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ast_tps_options for specification of taskprocessor options </p>
<p>Specify whether a taskprocessor should be created via <a class="el" href="../../d0/d1e/taskprocessor_8h.html#ac999cc9523590a29dff6acbd9cad24a9" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary...">ast_taskprocessor_get()</a> if the taskprocessor does not already exist. The default behavior is to create a taskprocessor if it does not already exist and provide its reference to the calling function. To only return a reference to a taskprocessor if and only if it exists, use the TPS_REF_IF_EXISTS option in <a class="el" href="../../d0/d1e/taskprocessor_8h.html#ac999cc9523590a29dff6acbd9cad24a9" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary...">ast_taskprocessor_get()</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a42ae78df3dc5106c133bf2f7b72080f7ae248d04bb7a6b5e0906e4906af4ee35a"></a>TPS_REF_DEFAULT&#160;</td><td class="fielddoc"><p>return a reference to a taskprocessor, create one if it does not exist </p>
</td></tr>
<tr><td class="fieldname"><a id="a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0"></a>TPS_REF_IF_EXISTS&#160;</td><td class="fielddoc"><p>return a reference to a taskprocessor ONLY if it already exists </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00073">73</a> of file <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">taskprocessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                     {<span class="comment"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">   /*! \brief return a reference to a taskprocessor, create one if it does not exist */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7ae248d04bb7a6b5e0906e4906af4ee35a">TPS_REF_DEFAULT</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">   /*! \brief return a reference to a taskprocessor ONLY if it already exists */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;};</div><div class="ttc" id="taskprocessor_8h_html_a42ae78df3dc5106c133bf2f7b72080f7ae248d04bb7a6b5e0906e4906af4ee35a"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7ae248d04bb7a6b5e0906e4906af4ee35a">TPS_REF_DEFAULT</a></div><div class="ttdoc">return a reference to a taskprocessor, create one if it does not exist </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00075">taskprocessor.h:75</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a></div><div class="ttdoc">return a reference to a taskprocessor ONLY if it already exists </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00077">taskprocessor.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a44bed16d2b07a7dc2bbb0134372acfb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44bed16d2b07a7dc2bbb0134372acfb7">&#9670;&nbsp;</a></span>ast_taskprocessor_alert_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ast_taskprocessor_alert_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current taskprocessor high water alert count. </p>
<dl class="section since"><dt>Since</dt><dd>13.10.0</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no taskprocessors are in high water alert. </td></tr>
    <tr><td class="paramname">non-zero</td><td>if some task processors are in high water alert. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00819">819</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00233">ast_rwlock_rdlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00232">ast_rwlock_unlock</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00779">tps_alert_count</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00782">tps_alert_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;{</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a7330ac9d36b05bad68b188c2dcfa42d7">ast_rwlock_rdlock</a>(&amp;<a class="code" href="../../d4/deb/taskprocessor_8c.html#afeeef0590292628c276ac75209f531c3">tps_alert_lock</a>);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   count = <a class="code" href="../../d4/deb/taskprocessor_8c.html#a4757bee5df8834ec0044fb999170a712">tps_alert_count</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac2920a1db37313ec46bd91dc83bf9c8a">ast_rwlock_unlock</a>(&amp;<a class="code" href="../../d4/deb/taskprocessor_8c.html#afeeef0590292628c276ac75209f531c3">tps_alert_lock</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">return</span> count;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="ttc" id="lock_8h_html_a7330ac9d36b05bad68b188c2dcfa42d7"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a7330ac9d36b05bad68b188c2dcfa42d7">ast_rwlock_rdlock</a></div><div class="ttdeci">#define ast_rwlock_rdlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00233">lock.h:233</a></div></div>
<div class="ttc" id="lock_8h_html_ac2920a1db37313ec46bd91dc83bf9c8a"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac2920a1db37313ec46bd91dc83bf9c8a">ast_rwlock_unlock</a></div><div class="ttdeci">#define ast_rwlock_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00232">lock.h:232</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_afeeef0590292628c276ac75209f531c3"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#afeeef0590292628c276ac75209f531c3">tps_alert_lock</a></div><div class="ttdeci">static ast_rwlock_t tps_alert_lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00782">taskprocessor.c:782</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a4757bee5df8834ec0044fb999170a712"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a4757bee5df8834ec0044fb999170a712">tps_alert_count</a></div><div class="ttdeci">static unsigned int tps_alert_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00779">taskprocessor.c:779</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4d9150df7126ae11064d38c755d0813"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d9150df7126ae11064d38c755d0813">&#9670;&nbsp;</a></span>ast_taskprocessor_alert_set_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_alert_set_levels </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>low_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>high_water</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the high and low alert water marks of the given taskprocessor queue. </p>
<dl class="section since"><dt>Since</dt><dd>13.10.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Taskprocessor to update queue water marks. </td></tr>
    <tr><td class="paramname">low_water</td><td>New queue low water mark. (-1 to set as 90% of high_water) </td></tr>
    <tr><td class="paramname">high_water</td><td>New queue high water mark.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error (water marks not changed). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00830">830</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00089">ast_taskprocessor::high_water_alert</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00794">tps_alert_add()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00078">ast_taskprocessor::tps_queue_high</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00076">ast_taskprocessor::tps_queue_low</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00074">ast_taskprocessor::tps_queue_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13680">actual_load_config()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02918">ast_res_pjsip_init_options_handling()</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00156">ast_serializer_pool_set_alerts()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01114">ast_sorcery_object_set_congestion_levels()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01013">stasis_subscription_set_congestion_limits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;{</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="keywordflow">if</span> (!tps || high_water &lt; 0 || high_water &lt; low_water) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="keywordflow">if</span> (low_water &lt; 0) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="comment">/* Set low water level to 90% of high water level */</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      low_water = (high_water * 9) / 10;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a281a55644ba8295d14b5ad5c5935b6cc">tps_queue_low</a> = low_water;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a7421fed4da8332ef256efdfdb61bb563">tps_queue_high</a> = high_water;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <span class="keywordflow">if</span> (tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a80e170193fe4d362e68c72e8deff70b4">high_water_alert</a>) {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">if</span> (!tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afe2dfc83eb5b460f39e9e5513023e74e">tps_queue_size</a> || tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afe2dfc83eb5b460f39e9e5513023e74e">tps_queue_size</a> &lt; low_water) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         <span class="comment">/* Update water mark alert immediately */</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a80e170193fe4d362e68c72e8deff70b4">high_water_alert</a> = 0;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         <a class="code" href="../../d4/deb/taskprocessor_8c.html#addc1eaecfa48679c5b0c4efb5bd45534">tps_alert_add</a>(tps, -1);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keywordflow">if</span> (high_water &lt; tps-&gt;tps_queue_size) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         <span class="comment">/* Update water mark alert immediately */</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a80e170193fe4d362e68c72e8deff70b4">high_water_alert</a> = 1;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         <a class="code" href="../../d4/deb/taskprocessor_8c.html#addc1eaecfa48679c5b0c4efb5bd45534">tps_alert_add</a>(tps, +1);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_a80e170193fe4d362e68c72e8deff70b4"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a80e170193fe4d362e68c72e8deff70b4">ast_taskprocessor::high_water_alert</a></div><div class="ttdeci">unsigned int high_water_alert</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00089">taskprocessor.c:89</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a7421fed4da8332ef256efdfdb61bb563"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a7421fed4da8332ef256efdfdb61bb563">ast_taskprocessor::tps_queue_high</a></div><div class="ttdeci">long tps_queue_high</div><div class="ttdoc">Taskprocessor high water alert trigger level. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00078">taskprocessor.c:78</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_addc1eaecfa48679c5b0c4efb5bd45534"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#addc1eaecfa48679c5b0c4efb5bd45534">tps_alert_add</a></div><div class="ttdeci">static void tps_alert_add(struct ast_taskprocessor *tps, int delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00794">taskprocessor.c:794</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a281a55644ba8295d14b5ad5c5935b6cc"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a281a55644ba8295d14b5ad5c5935b6cc">ast_taskprocessor::tps_queue_low</a></div><div class="ttdeci">long tps_queue_low</div><div class="ttdoc">Taskprocessor low water clear alert level. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00076">taskprocessor.c:76</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_afe2dfc83eb5b460f39e9e5513023e74e"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#afe2dfc83eb5b460f39e9e5513023e74e">ast_taskprocessor::tps_queue_size</a></div><div class="ttdeci">long tps_queue_size</div><div class="ttdoc">Taskprocessor current queue size. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00074">taskprocessor.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab47623e207bf2cdd0edfa613d91894e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab47623e207bf2cdd0edfa613d91894e5">&#9670;&nbsp;</a></span>ast_taskprocessor_build_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_taskprocessor_build_name </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a taskprocessor name with a sequence number on the end. </p>
<dl class="section since"><dt>Since</dt><dd>13.8.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Where to put the built taskprocessor name. </td></tr>
    <tr><td class="paramname">size</td><td>How large is buf including null terminator. </td></tr>
    <tr><td class="paramname">format</td><td>printf format to create the non-sequenced part of the name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The user supplied part of the taskprocessor name is truncated to allow the full sequence number to be appended within the supplied buffer size.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01295">1295</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01276">ast_taskprocessor_seq_num()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01283">SEQ_STR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01496">alloc_playback_chan()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01405">allocate_subscription_tree()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d2/db8/res__pjsip__transport__websocket_8c_source.html#l00349">create_websocket_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01243">distributor_pool_setup()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00382">refer_progress_alloc()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00963">sip_options_aor_alloc()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01033">sip_outbound_publisher_alloc()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01314">sip_outbound_registration_state_alloc()</a>, and <a class="el" href="../../d7/d69/sorcery_8c_source.html#l00700">sorcery_object_type_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   va_list ap;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   <span class="keywordtype">int</span> user_size;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a> &lt;= size);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   va_start(ap, <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   user_size = vsnprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size - (<a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a> - 1), <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, ap);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   va_end(ap);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <span class="keywordflow">if</span> (user_size &lt; 0) {</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">       * Wow!  We got an output error to a memory buffer.</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">       * Assume no user part of name written.</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      user_size = 0;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &lt; user_size + <a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a>) {</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="comment">/* Truncate user part of name to make sequence number fit. */</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      user_size = size - <a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <span class="comment">/* Append sequence number to end of user name. */</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   snprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> + user_size, <a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a>, <span class="stringliteral">&quot;-%08x&quot;</span>, <a class="code" href="../../d4/deb/taskprocessor_8c.html#a6d17cb910ea569aa91235d174c126f55">ast_taskprocessor_seq_num</a>());</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div><div class="ttc" id="taskprocessor_8c_html_a6d17cb910ea569aa91235d174c126f55"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a6d17cb910ea569aa91235d174c126f55">ast_taskprocessor_seq_num</a></div><div class="ttdeci">unsigned int ast_taskprocessor_seq_num(void)</div><div class="ttdoc">Get the next sequence number to create a human friendly taskprocessor name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01276">taskprocessor.c:1276</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_ad673ddccb6db4af7af1cb47b3e97ee39"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a></div><div class="ttdeci">#define SEQ_STR_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01283">taskprocessor.c:1283</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a98f5e70e98f6dc48e3c5ba316066d540"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a></div><div class="ttdeci">static snd_pcm_format_t format</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00102">chan_alsa.c:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab79575eb73e817bd3afe77c87308e8be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab79575eb73e817bd3afe77c87308e8be">&#9670;&nbsp;</a></span>ast_taskprocessor_create_with_listener()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_taskprocessor_create_with_listener </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *&#160;</td>
          <td class="paramname"><em>listener</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a taskprocessor with a custom listener. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0</dd></dl>
<p>Note that when a taskprocessor is created in this way, it does not create any threads to execute the tasks. This job is left up to the listener. The listener's start() callback will be called during this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the taskprocessor to create </td></tr>
    <tr><td class="paramname">listener</td><td>The listener for operations on this taskprocessor </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure  non-NULL success </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01083">1083</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00983">__allocate_taskprocessor()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01028">__start_taskprocessor()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00555">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00915">ast_threadpool_create()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01402">ast_threadpool_serializer_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;{</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *p;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps_singletons);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   p = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(tps_singletons, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <span class="keywordflow">if</span> (p) {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <a class="code" href="../../d4/deb/taskprocessor_8c.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(p);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   p = <a class="code" href="../../d4/deb/taskprocessor_8c.html#a2ef06a1672c6c7c3ac36cee03ab1a8ee">__allocate_taskprocessor</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, listener);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/deb/taskprocessor_8c.html#af1085e4adbfe31c0f31604b365543b84">__start_taskprocessor</a>(p);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_af1085e4adbfe31c0f31604b365543b84"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#af1085e4adbfe31c0f31604b365543b84">__start_taskprocessor</a></div><div class="ttdeci">static struct ast_taskprocessor * __start_taskprocessor(struct ast_taskprocessor *p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01028">taskprocessor.c:1028</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a2ef06a1672c6c7c3ac36cee03ab1a8ee"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a2ef06a1672c6c7c3ac36cee03ab1a8ee">__allocate_taskprocessor</a></div><div class="ttdeci">static struct ast_taskprocessor * __allocate_taskprocessor(const char *name, struct ast_taskprocessor_listener *listener)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00983">taskprocessor.c:983</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9318e041c0564532581e864cda8f9426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9318e041c0564532581e864cda8f9426">&#9670;&nbsp;</a></span>ast_taskprocessor_execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_execute </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pop a task off the taskprocessor and execute it. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>The taskprocessor from which to execute. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>There is no further work to be done. </td></tr>
    <tr><td class="paramname">1</td><td>Tasks still remain in the taskprocessor queue. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01212">1212</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00065">tps_taskprocessor_stats::_tasks_processed_count</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00066">AST_PTHREADT_NULL</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00900">ast_taskprocessor_size()</a>, <a class="el" href="../../d3/d60/structtps__task.html#acc9f473b491e7d8fb0a13f13924eaf88">tps_task::callback</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00112">ast_taskprocessor_listener::callbacks</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00224">ast_taskprocessor_local::data</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00054">tps_task::datap</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00104">ast_taskprocessor_listener_callbacks::emptied</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00050">tps_task::execute</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00051">tps_task::execute_local</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00085">ast_taskprocessor::executing</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00081">ast_taskprocessor::listener</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00072">ast_taskprocessor::local_data</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00222">ast_taskprocessor_local::local_data</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00063">tps_taskprocessor_stats::max_qsize</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00071">ast_taskprocessor::stats</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00083">ast_taskprocessor::thread</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00368">tps_task_free()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00886">tps_taskprocessor_pop()</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00057">tps_task::wants_local</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00555">AST_TEST_DEFINE()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00193">default_tps_processing_function()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01349">execute_tasks()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00362">threadpool_execute()</a>.</p>
<div class="fragment"><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;{</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a> local;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d60/structtps__task.html">tps_task</a> *t;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <span class="keywordtype">long</span> size;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   t = <a class="code" href="../../d4/deb/taskprocessor_8c.html#af989d4cac357f8adb289a4f7bf4374cb">tps_taskprocessor_pop</a>(tps);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   <span class="keywordflow">if</span> (!t) {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> = pthread_self();</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a2d2a856d77bc4c98d58bfa0266bbddd8">executing</a> = 1;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#a49dc5ea84d90d2fe8c7afac643cf40b1">wants_local</a>) {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      local.local_data = tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afac276564d7aa87eefe4fa4b0694001e">local_data</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      local.data = t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#aeb5cadc7793d3e5ed0c725dbb3c04491">datap</a>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#a49dc5ea84d90d2fe8c7afac643cf40b1">wants_local</a>) {</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#acc9f473b491e7d8fb0a13f13924eaf88">callback</a>.<a class="code" href="../../d3/d60/structtps__task.html#a459b9081279633ec1f0a1f81bd0d8f24">execute_local</a>(&amp;local);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#acc9f473b491e7d8fb0a13f13924eaf88">callback</a>.<a class="code" href="../../d3/d60/structtps__task.html#a3715a7cb3d54e5b93b7085312cb02878">execute</a>(t-&gt;<a class="code" href="../../d3/d60/structtps__task.html#aeb5cadc7793d3e5ed0c725dbb3c04491">datap</a>);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   }</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <a class="code" href="../../d4/deb/taskprocessor_8c.html#ab8f1469650cc0c4de3f74dc4ec515207">tps_task_free</a>(t);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   <span class="comment">/* We need to check size in the same critical section where we reset the</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">    * executing bit. Avoids a race condition where a task is pushed right</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">    * after we pop an empty stack.</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a2d2a856d77bc4c98d58bfa0266bbddd8">executing</a> = 0;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   size = <a class="code" href="../../d4/deb/taskprocessor_8c.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a>(tps);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;   <span class="comment">/* Update the stats */</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   ++tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#ad921b32ca4f51740507d2d8957116c61">stats</a>.<a class="code" href="../../db/d1c/structtps__taskprocessor__stats.html#acbba7f4a1f962091e9596c4eac481186">_tasks_processed_count</a>;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   <span class="comment">/* Include the task we just executed as part of the queue size. */</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="keywordflow">if</span> (size &gt;= tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#ad921b32ca4f51740507d2d8957116c61">stats</a>.<a class="code" href="../../db/d1c/structtps__taskprocessor__stats.html#a94e5638db41adecd198cf929e2990440">max_qsize</a>) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#ad921b32ca4f51740507d2d8957116c61">stats</a>.<a class="code" href="../../db/d1c/structtps__taskprocessor__stats.html#a94e5638db41adecd198cf929e2990440">max_qsize</a> = size + 1;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="comment">/* If we executed a task, check for the transition to empty */</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;   <span class="keywordflow">if</span> (size == 0 &amp;&amp; tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">listener</a>-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">callbacks</a>-&gt;<a class="code" href="../../d0/d01/structast__taskprocessor__listener__callbacks.html#a64d83267a2df9f4898f5bf8ef6afd4c6">emptied</a>) {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">listener</a>-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">callbacks</a>-&gt;<a class="code" href="../../d0/d01/structast__taskprocessor__listener__callbacks.html#a64d83267a2df9f4898f5bf8ef6afd4c6">emptied</a>(tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">listener</a>);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;   <span class="keywordflow">return</span> size &gt; 0;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;}</div><div class="ttc" id="structast__taskprocessor__listener_html_addf12c55d68372c220c81f61e800a6c6"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">ast_taskprocessor_listener::callbacks</a></div><div class="ttdeci">const struct ast_taskprocessor_listener_callbacks * callbacks</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00112">taskprocessor.c:112</a></div></div>
<div class="ttc" id="structast__taskprocessor__listener__callbacks_html_a64d83267a2df9f4898f5bf8ef6afd4c6"><div class="ttname"><a href="../../d0/d01/structast__taskprocessor__listener__callbacks.html#a64d83267a2df9f4898f5bf8ef6afd4c6">ast_taskprocessor_listener_callbacks::emptied</a></div><div class="ttdeci">void(* emptied)(struct ast_taskprocessor_listener *listener)</div><div class="ttdoc">Indicates the task processor has become empty. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00104">taskprocessor.h:104</a></div></div>
<div class="ttc" id="structtps__task_html_acc9f473b491e7d8fb0a13f13924eaf88"><div class="ttname"><a href="../../d3/d60/structtps__task.html#acc9f473b491e7d8fb0a13f13924eaf88">tps_task::callback</a></div><div class="ttdeci">union tps_task::@428 callback</div><div class="ttdoc">The execute() task callback function pointer. </div></div>
<div class="ttc" id="structast__taskprocessor_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a01f75a9ad916f63a94e06a27635ba278">ast_taskprocessor::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00083">taskprocessor.c:83</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a9dbaf508f8a891a7dfca0827ba489abc"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">ast_taskprocessor::listener</a></div><div class="ttdeci">struct ast_taskprocessor_listener * listener</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00081">taskprocessor.c:81</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_af989d4cac357f8adb289a4f7bf4374cb"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#af989d4cac357f8adb289a4f7bf4374cb">tps_taskprocessor_pop</a></div><div class="ttdeci">static struct tps_task * tps_taskprocessor_pop(struct ast_taskprocessor *tps)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00886">taskprocessor.c:886</a></div></div>
<div class="ttc" id="structtps__task_html_aeb5cadc7793d3e5ed0c725dbb3c04491"><div class="ttname"><a href="../../d3/d60/structtps__task.html#aeb5cadc7793d3e5ed0c725dbb3c04491">tps_task::datap</a></div><div class="ttdeci">void * datap</div><div class="ttdoc">The data pointer for the task execute() function. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00054">taskprocessor.c:54</a></div></div>
<div class="ttc" id="structtps__taskprocessor__stats_html_acbba7f4a1f962091e9596c4eac481186"><div class="ttname"><a href="../../db/d1c/structtps__taskprocessor__stats.html#acbba7f4a1f962091e9596c4eac481186">tps_taskprocessor_stats::_tasks_processed_count</a></div><div class="ttdeci">unsigned long _tasks_processed_count</div><div class="ttdoc">This is the current number of tasks processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00065">taskprocessor.c:65</a></div></div>
<div class="ttc" id="structtps__task_html_a459b9081279633ec1f0a1f81bd0d8f24"><div class="ttname"><a href="../../d3/d60/structtps__task.html#a459b9081279633ec1f0a1f81bd0d8f24">tps_task::execute_local</a></div><div class="ttdeci">int(* execute_local)(struct ast_taskprocessor_local *local)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00051">taskprocessor.c:51</a></div></div>
<div class="ttc" id="lock_8h_html_a6009440c7a72f8e2e3b1ec97641ad160"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a></div><div class="ttdeci">#define AST_PTHREADT_NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00066">lock.h:66</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a83d09062fb3c84cf1c84a04174deb2bf"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a></div><div class="ttdeci">long ast_taskprocessor_size(struct ast_taskprocessor *tps)</div><div class="ttdoc">Return the current size of the taskprocessor queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00900">taskprocessor.c:900</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a2d2a856d77bc4c98d58bfa0266bbddd8"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a2d2a856d77bc4c98d58bfa0266bbddd8">ast_taskprocessor::executing</a></div><div class="ttdeci">unsigned int executing</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00085">taskprocessor.c:85</a></div></div>
<div class="ttc" id="structast__taskprocessor__local_html"><div class="ttname"><a href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a></div><div class="ttdoc">Local data parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00220">taskprocessor.h:220</a></div></div>
<div class="ttc" id="structtps__task_html_a3715a7cb3d54e5b93b7085312cb02878"><div class="ttname"><a href="../../d3/d60/structtps__task.html#a3715a7cb3d54e5b93b7085312cb02878">tps_task::execute</a></div><div class="ttdeci">int(* execute)(void *datap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00050">taskprocessor.c:50</a></div></div>
<div class="ttc" id="structtps__task_html"><div class="ttname"><a href="../../d3/d60/structtps__task.html">tps_task</a></div><div class="ttdoc">tps_task structure is queued to a taskprocessor </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00047">taskprocessor.c:47</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_afac276564d7aa87eefe4fa4b0694001e"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#afac276564d7aa87eefe4fa4b0694001e">ast_taskprocessor::local_data</a></div><div class="ttdeci">void * local_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00072">taskprocessor.c:72</a></div></div>
<div class="ttc" id="structtps__task_html_a49dc5ea84d90d2fe8c7afac643cf40b1"><div class="ttname"><a href="../../d3/d60/structtps__task.html#a49dc5ea84d90d2fe8c7afac643cf40b1">tps_task::wants_local</a></div><div class="ttdeci">unsigned int wants_local</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00057">taskprocessor.c:57</a></div></div>
<div class="ttc" id="structtps__taskprocessor__stats_html_a94e5638db41adecd198cf929e2990440"><div class="ttname"><a href="../../db/d1c/structtps__taskprocessor__stats.html#a94e5638db41adecd198cf929e2990440">tps_taskprocessor_stats::max_qsize</a></div><div class="ttdeci">unsigned long max_qsize</div><div class="ttdoc">This is the maximum number of tasks queued at any one time. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00063">taskprocessor.c:63</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_ab8f1469650cc0c4de3f74dc4ec515207"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#ab8f1469650cc0c4de3f74dc4ec515207">tps_task_free</a></div><div class="ttdeci">static void * tps_task_free(struct tps_task *task)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00368">taskprocessor.c:368</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_ad921b32ca4f51740507d2d8957116c61"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#ad921b32ca4f51740507d2d8957116c61">ast_taskprocessor::stats</a></div><div class="ttdeci">struct tps_taskprocessor_stats stats</div><div class="ttdoc">Taskprocessor statistics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00071">taskprocessor.c:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac999cc9523590a29dff6acbd9cad24a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac999cc9523590a29dff6acbd9cad24a9">&#9670;&nbsp;</a></span>ast_taskprocessor_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_taskprocessor_get </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7">ast_tps_options</a>&#160;</td>
          <td class="paramname"><em>create</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary. </p>
<p>The default behavior of instantiating a taskprocessor if one does not already exist can be disabled by specifying the TPS_REF_IF_EXISTS ast_tps_options as the second argument to <a class="el" href="../../d0/d1e/taskprocessor_8h.html#ac999cc9523590a29dff6acbd9cad24a9" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary...">ast_taskprocessor_get()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the taskprocessor </td></tr>
    <tr><td class="paramname">create</td><td>Use 0 by default or specify TPS_REF_IF_EXISTS to return NULL if the taskprocessor does not already exist return A pointer to a reference counted taskprocessor under normal conditions, or NULL if the TPS_REF_IF_EXISTS reference type is specified and the taskprocessor does not exist </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01044">1044</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00983">__allocate_taskprocessor()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01028">__start_taskprocessor()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00930">ast_taskprocessor_listener_alloc()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00955">default_listener_pvt_alloc()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00173">default_listener_pvt_destroy()</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01476">listener()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, and <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00077">TPS_REF_IF_EXISTS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01496">alloc_playback_chan()</a>, <a class="el" href="../../df/d3a/dns__system__resolver_8c_source.html#l00243">ast_dns_system_resolver_init()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01730">ast_msg_init()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00132">AST_TEST_DEFINE()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00411">cli_tps_ping()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01329">cli_tps_reset_stats()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00112">find_request_serializer()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l15123">load_module()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14735">load_objects()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00404">threadpool_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;{</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *p;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *<a class="code" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbe/structdefault__taskprocessor__listener__pvt.html">default_taskprocessor_listener_pvt</a> *pvt;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;requesting a nameless taskprocessor!!!\n&quot;</span>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps_singletons);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   p = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(tps_singletons, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   <span class="keywordflow">if</span> (p || (create &amp; <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a>)) {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">/* calling function does not want a new taskprocessor to be created if it doesn&#39;t already exist */</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">return</span> p;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <span class="comment">/* Create a new taskprocessor. Start by creating a default listener */</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   pvt = <a class="code" href="../../d4/deb/taskprocessor_8c.html#a6314b05bebeaff91454d8ca7254472b8">default_listener_pvt_alloc</a>();</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <span class="keywordflow">if</span> (!pvt) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   listener = <a class="code" href="../../d4/deb/taskprocessor_8c.html#ad7d5e40a1f7eac54dcad096b90d013bd">ast_taskprocessor_listener_alloc</a>(&amp;<a class="code" href="../../d4/deb/taskprocessor_8c.html#aad81e8feb180e9e5030db0143968b794">default_listener_callbacks</a>, pvt);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   <span class="keywordflow">if</span> (!listener) {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <a class="code" href="../../d4/deb/taskprocessor_8c.html#af5ca68ce20aadfbc7e14071bf33a77ed">default_listener_pvt_destroy</a>(pvt);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   p = <a class="code" href="../../d4/deb/taskprocessor_8c.html#a2ef06a1672c6c7c3ac36cee03ab1a8ee">__allocate_taskprocessor</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, listener);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   p = <a class="code" href="../../d4/deb/taskprocessor_8c.html#af1085e4adbfe31c0f31604b365543b84">__start_taskprocessor</a>(p);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(listener, -1);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   <span class="keywordflow">return</span> p;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;}</div><div class="ttc" id="structast__taskprocessor__listener_html"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a></div><div class="ttdoc">A listener for taskprocessors. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00110">taskprocessor.c:110</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_af1085e4adbfe31c0f31604b365543b84"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#af1085e4adbfe31c0f31604b365543b84">__start_taskprocessor</a></div><div class="ttdeci">static struct ast_taskprocessor * __start_taskprocessor(struct ast_taskprocessor *p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01028">taskprocessor.c:1028</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="structdefault__taskprocessor__listener__pvt_html"><div class="ttname"><a href="../../db/dbe/structdefault__taskprocessor__listener__pvt.html">default_taskprocessor_listener_pvt</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00167">taskprocessor.c:167</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_ad7d5e40a1f7eac54dcad096b90d013bd"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#ad7d5e40a1f7eac54dcad096b90d013bd">ast_taskprocessor_listener_alloc</a></div><div class="ttdeci">struct ast_taskprocessor_listener * ast_taskprocessor_listener_alloc(const struct ast_taskprocessor_listener_callbacks *callbacks, void *user_data)</div><div class="ttdoc">Allocate a taskprocessor listener. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00930">taskprocessor.c:930</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="asterisk_8c_html_adc01bca6281492dfec5ae217cf32fc34"><div class="ttname"><a href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a></div><div class="ttdeci">static void * listener(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01476">asterisk.c:1476</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_af5ca68ce20aadfbc7e14071bf33a77ed"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#af5ca68ce20aadfbc7e14071bf33a77ed">default_listener_pvt_destroy</a></div><div class="ttdeci">static void default_listener_pvt_destroy(struct default_taskprocessor_listener_pvt *pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00173">taskprocessor.c:173</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a2ef06a1672c6c7c3ac36cee03ab1a8ee"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a2ef06a1672c6c7c3ac36cee03ab1a8ee">__allocate_taskprocessor</a></div><div class="ttdeci">static struct ast_taskprocessor * __allocate_taskprocessor(const char *name, struct ast_taskprocessor_listener *listener)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00983">taskprocessor.c:983</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a42ae78df3dc5106c133bf2f7b72080f7abe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a></div><div class="ttdoc">return a reference to a taskprocessor ONLY if it already exists </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00077">taskprocessor.h:77</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a6314b05bebeaff91454d8ca7254472b8"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a6314b05bebeaff91454d8ca7254472b8">default_listener_pvt_alloc</a></div><div class="ttdeci">static void * default_listener_pvt_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00955">taskprocessor.c:955</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_aad81e8feb180e9e5030db0143968b794"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#aad81e8feb180e9e5030db0143968b794">default_listener_callbacks</a></div><div class="ttdeci">static const struct ast_taskprocessor_listener_callbacks default_listener_callbacks</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00280">taskprocessor.c:280</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaee66f3c01dde2a5c3762c0f30581563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee66f3c01dde2a5c3762c0f30581563">&#9670;&nbsp;</a></span>ast_taskprocessor_get_subsystem_alert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ast_taskprocessor_get_subsystem_alert </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subsystem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current taskprocessor high water alert count by sybsystem. </p>
<dl class="section since"><dt>Since</dt><dd>13.26.0 </dd>
<dd>
16.3.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subsystem</td><td>The subsystem name</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no taskprocessors are in high water alert. </td></tr>
    <tr><td class="paramname">non-zero</td><td>if some task processors are in high water alert. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00637">637</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00124">subsystem_alert::alert_count</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00721">AST_VECTOR_GET_INDEX</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00880">AST_VECTOR_RW_RDLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00627">subsystem_match()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;{</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/da5/structsubsystem__alert.html">subsystem_alert</a> *alert;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a>(&amp;overloaded_subsystems);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   idx = <a class="code" href="../../d6/d68/vector_8h.html#a29d0c73e04da3effa371ce52848e4561">AST_VECTOR_GET_INDEX</a>(&amp;overloaded_subsystems, <a class="code" href="../../d9/da5/structsubsystem__alert.html#aefc476783822f8e838c9c0cdbeb24b25">subsystem</a>, <a class="code" href="../../d4/deb/taskprocessor_8c.html#afd693356739cff532d6b8184215ace77">subsystem_match</a>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordflow">if</span> (idx &gt;= 0) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      alert = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;overloaded_subsystems, idx);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      count = alert-&gt;<a class="code" href="../../d9/da5/structsubsystem__alert.html#a1a3f5878055eb265ef3444bde78f5f84">alert_count</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;overloaded_subsystems);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <span class="keywordflow">return</span> count;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="ttc" id="vector_8h_html_a29d0c73e04da3effa371ce52848e4561"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a29d0c73e04da3effa371ce52848e4561">AST_VECTOR_GET_INDEX</a></div><div class="ttdeci">#define AST_VECTOR_GET_INDEX(vec, value, cmp)</div><div class="ttdoc">Get the 1st index from a vector that matches the given comparison. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00721">vector.h:721</a></div></div>
<div class="ttc" id="structsubsystem__alert_html"><div class="ttname"><a href="../../d9/da5/structsubsystem__alert.html">subsystem_alert</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00123">taskprocessor.c:123</a></div></div>
<div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="structsubsystem__alert_html_aefc476783822f8e838c9c0cdbeb24b25"><div class="ttname"><a href="../../d9/da5/structsubsystem__alert.html#aefc476783822f8e838c9c0cdbeb24b25">subsystem_alert::subsystem</a></div><div class="ttdeci">char subsystem[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00125">taskprocessor.c:125</a></div></div>
<div class="ttc" id="vector_8h_html_ad414eae87431bad2a7fc4dffa9d06350"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_RDLOCK(vec)</div><div class="ttdoc">Obtain read lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00880">vector.h:880</a></div></div>
<div class="ttc" id="structsubsystem__alert_html_a1a3f5878055eb265ef3444bde78f5f84"><div class="ttname"><a href="../../d9/da5/structsubsystem__alert.html#a1a3f5878055eb265ef3444bde78f5f84">subsystem_alert::alert_count</a></div><div class="ttdeci">unsigned int alert_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00124">taskprocessor.c:124</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_afd693356739cff532d6b8184215ace77"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#afd693356739cff532d6b8184215ace77">subsystem_match</a></div><div class="ttdeci">static int subsystem_match(struct subsystem_alert *alert, const char *subsystem)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00627">taskprocessor.c:627</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37f9fcdd63017df32ddb3b2601d1e223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37f9fcdd63017df32ddb3b2601d1e223">&#9670;&nbsp;</a></span>ast_taskprocessor_is_suspended()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_is_suspended </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the task processor suspend status. </p>
<dl class="section since"><dt>Since</dt><dd>13.12.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Task processor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-zero</td><td>if the task processor is suspended </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01207">1207</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00091">ast_taskprocessor::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>.</p>
<div class="fragment"><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;{</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <span class="keywordflow">return</span> tps ? tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">suspended</a> : -1;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_a2862ffde11c780129862e5549415a6f6"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">ast_taskprocessor::suspended</a></div><div class="ttdeci">unsigned int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00091">taskprocessor.c:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a66670abd8be00ab53bd9125a57574f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a66670abd8be00ab53bd9125a57574f">&#9670;&nbsp;</a></span>ast_taskprocessor_is_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_is_task </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Am I the given taskprocessor's current task. </p>
<dl class="section since"><dt>Since</dt><dd>12.7.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Taskprocessor to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-zero</td><td>if current thread is the taskprocessor thread. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01266">1266</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00083">ast_taskprocessor::thread</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05218">ast_sip_push_task_wait_serializer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;{</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <span class="keywordtype">int</span> is_task;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   is_task = pthread_equal(tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, pthread_self());</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;   <span class="keywordflow">return</span> is_task;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a01f75a9ad916f63a94e06a27635ba278">ast_taskprocessor::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00083">taskprocessor.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7d5e40a1f7eac54dcad096b90d013bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d5e40a1f7eac54dcad096b90d013bd">&#9670;&nbsp;</a></span>ast_taskprocessor_listener_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a>* ast_taskprocessor_listener_alloc </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d01/structast__taskprocessor__listener__callbacks.html">ast_taskprocessor_listener_callbacks</a> *&#160;</td>
          <td class="paramname"><em>callbacks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a taskprocessor listener. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0</dd></dl>
<p>This will result in the listener being allocated with the specified callbacks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks</td><td>The callbacks to assign to the listener </td></tr>
    <tr><td class="paramname">user_data</td><td>The user data for the listener </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failure </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The newly allocated taskprocessor listener </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00930">930</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00112">ast_taskprocessor_listener::callbacks</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01476">listener()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00921">taskprocessor_listener_dtor()</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00116">ast_taskprocessor_listener::user_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01044">ast_taskprocessor_get()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00555">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00915">ast_threadpool_create()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01402">ast_threadpool_serializer_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;{</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *<a class="code" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   listener = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*listener), <a class="code" href="../../d4/deb/taskprocessor_8c.html#adae19da477b734d7470b3013a761fb9c">taskprocessor_listener_dtor</a>);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <span class="keywordflow">if</span> (!listener) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   listener-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">callbacks</a> = <a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">callbacks</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   listener-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#a0f53d287ac7c064d1a49d4bd93ca1cb9">user_data</a> = <a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#a0f53d287ac7c064d1a49d4bd93ca1cb9">user_data</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div><div class="ttc" id="structast__taskprocessor__listener_html"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a></div><div class="ttdoc">A listener for taskprocessors. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00110">taskprocessor.c:110</a></div></div>
<div class="ttc" id="structast__taskprocessor__listener_html_a0f53d287ac7c064d1a49d4bd93ca1cb9"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html#a0f53d287ac7c064d1a49d4bd93ca1cb9">ast_taskprocessor_listener::user_data</a></div><div class="ttdeci">void * user_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00116">taskprocessor.c:116</a></div></div>
<div class="ttc" id="structast__taskprocessor__listener_html_addf12c55d68372c220c81f61e800a6c6"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html#addf12c55d68372c220c81f61e800a6c6">ast_taskprocessor_listener::callbacks</a></div><div class="ttdeci">const struct ast_taskprocessor_listener_callbacks * callbacks</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00112">taskprocessor.c:112</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="asterisk_8c_html_adc01bca6281492dfec5ae217cf32fc34"><div class="ttname"><a href="../../d5/d03/asterisk_8c.html#adc01bca6281492dfec5ae217cf32fc34">listener</a></div><div class="ttdeci">static void * listener(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01476">asterisk.c:1476</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_adae19da477b734d7470b3013a761fb9c"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#adae19da477b734d7470b3013a761fb9c">taskprocessor_listener_dtor</a></div><div class="ttdeci">static void taskprocessor_listener_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00921">taskprocessor.c:921</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b19a24ebd6df46be8ab735226c7d6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b19a24ebd6df46be8ab735226c7d6a3">&#9670;&nbsp;</a></span>ast_taskprocessor_listener_get_tps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_taskprocessor_listener_get_tps </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *&#160;</td>
          <td class="paramname"><em>listener</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a reference to the listener's taskprocessor. </p>
<p>This will return the taskprocessor with its reference count increased. Release the reference to this object by using <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556" title="Unreference the specified taskprocessor and its reference count will decrement. ">ast_taskprocessor_unreference()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">listener</td><td>The listener that has the taskprocessor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The taskprocessor </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00944">944</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00114">ast_taskprocessor_listener::tps</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01363">serializer_task_pushed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;{</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(listener-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#a4c381cb1b5cf198fa3f260212e716c9a">tps</a>, +1);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <span class="keywordflow">return</span> listener-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#a4c381cb1b5cf198fa3f260212e716c9a">tps</a>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;}</div><div class="ttc" id="structast__taskprocessor__listener_html_a4c381cb1b5cf198fa3f260212e716c9a"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html#a4c381cb1b5cf198fa3f260212e716c9a">ast_taskprocessor_listener::tps</a></div><div class="ttdeci">struct ast_taskprocessor * tps</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00114">taskprocessor.c:114</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6906b13a7a37512e36dd1f5148589481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6906b13a7a37512e36dd1f5148589481">&#9670;&nbsp;</a></span>ast_taskprocessor_listener_get_user_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ast_taskprocessor_listener_get_user_data </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d52/structast__taskprocessor__listener.html">ast_taskprocessor_listener</a> *&#160;</td>
          <td class="paramname"><em>listener</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the user data from the listener. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">listener</td><td>The taskprocessor listener </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The listener's user data </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00950">950</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00116">ast_taskprocessor_listener::user_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01381">serializer_shutdown()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01363">serializer_task_pushed()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00480">test_emptied()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00489">test_shutdown()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00468">test_task_pushed()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00654">threadpool_tps_emptied()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00679">threadpool_tps_shutdown()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00610">threadpool_tps_task_pushed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;{</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="keywordflow">return</span> listener-&gt;<a class="code" href="../../d7/d52/structast__taskprocessor__listener.html#a0f53d287ac7c064d1a49d4bd93ca1cb9">user_data</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;}</div><div class="ttc" id="structast__taskprocessor__listener_html_a0f53d287ac7c064d1a49d4bd93ca1cb9"><div class="ttname"><a href="../../d7/d52/structast__taskprocessor__listener.html#a0f53d287ac7c064d1a49d4bd93ca1cb9">ast_taskprocessor_listener::user_data</a></div><div class="ttdeci">void * user_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00116">taskprocessor.c:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa6541086de52447afa994cbfcb792ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6541086de52447afa994cbfcb792ec">&#9670;&nbsp;</a></span>ast_taskprocessor_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_taskprocessor_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the name of the taskprocessor singleton. </p>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00906">906</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00097">ast_taskprocessor::name</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00156">ast_serializer_pool_set_alerts()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">ast_sip_get_distributor_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00524">grow()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00077">record_serializer()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00775">shrink()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l01240">sip_options_apply_aor_configuration()</a>, and <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02094">sip_options_contact_add_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;{</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keywordflow">if</span> (!tps) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;no taskprocessor specified!\n&quot;</span>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="keywordflow">return</span> tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afd3f693e384b1ee0a0c44d58351eb87d">name</a>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_afd3f693e384b1ee0a0c44d58351eb87d"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#afd3f693e384b1ee0a0c44d58351eb87d">ast_taskprocessor::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdoc">Friendly name of the taskprocessor. Subsystem is appended after the name&amp;#39;s NULL terminator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00097">taskprocessor.c:97</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f0cc7cda2fe82f4c7df4dbdc57b1372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f0cc7cda2fe82f4c7df4dbdc57b1372">&#9670;&nbsp;</a></span>ast_taskprocessor_name_append()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_taskprocessor_name_append </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append the next sequence number to the given string, and copy into the buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Where to copy the appended taskprocessor name. </td></tr>
    <tr><td class="paramname">size</td><td>How large is buf including null terminator. </td></tr>
    <tr><td class="paramname">name</td><td>A name to append the sequence number to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01285">1285</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01276">ast_taskprocessor_seq_num()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01283">SEQ_STR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00076">ast_serializer_pool_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordtype">int</span> final_size = strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) + <a class="code" href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a>;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(final_size &lt;= size);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   snprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, final_size, <span class="stringliteral">&quot;%s-%08x&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d4/deb/taskprocessor_8c.html#a6d17cb910ea569aa91235d174c126f55">ast_taskprocessor_seq_num</a>());</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div><div class="ttc" id="taskprocessor_8c_html_a6d17cb910ea569aa91235d174c126f55"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a6d17cb910ea569aa91235d174c126f55">ast_taskprocessor_seq_num</a></div><div class="ttdeci">unsigned int ast_taskprocessor_seq_num(void)</div><div class="ttdoc">Get the next sequence number to create a human friendly taskprocessor name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01276">taskprocessor.c:1276</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_ad673ddccb6db4af7af1cb47b3e97ee39"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#ad673ddccb6db4af7af1cb47b3e97ee39">SEQ_STR_SIZE</a></div><div class="ttdeci">#define SEQ_STR_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01283">taskprocessor.c:1283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b2508ba0a6b8f43ae6d3963f3189585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b2508ba0a6b8f43ae6d3963f3189585">&#9670;&nbsp;</a></span>ast_taskprocessor_push()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_push </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *datap)&#160;</td>
          <td class="paramname"><em>task_exe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>datap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push a task into the specified taskprocessor queue and signal the taskprocessor thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>The taskprocessor structure </td></tr>
    <tr><td class="paramname">task_exe</td><td>The task handling function to push into the taskprocessor queue </td></tr>
    <tr><td class="paramname">datap</td><td>The data to be used by the task handling function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01175">1175</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01139">taskprocessor_push()</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00326">tps_task_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04093">ast_cc_agent_status_response()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l03941">ast_cc_monitor_failed()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04051">ast_cc_monitor_party_b_free()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l03986">ast_cc_monitor_status_request()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04023">ast_cc_monitor_stop_ringing()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00958">ast_msg_queue()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02145">ast_sorcery_update()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00132">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00956">ast_threadpool_push()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00874">ast_threadpool_set_size()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02492">async_delete_name_rec()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02248">async_play_sound_helper()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l03328">cc_request_state_change()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00411">cli_tps_ping()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00250">default_listener_shutdown()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01173">destroy_conference_bridge()</a>, <a class="el" href="../../df/d3a/dns__system__resolver_8c_source.html#l00180">dns_system_resolver_resolve()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01484">generic_monitor_devstate_cb()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l04511">handle_cc_status()</a>, <a class="el" href="../../db/d43/res__hep_8c_source.html#l00581">hepv3_send_packet()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l04309">iax2_transmit()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13181">mwi_handle_subscribe()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13163">mwi_handle_unsubscribe()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01997">play_sound_helper()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01336">sorcery_object_load()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00256">threadpool_active_thread_idle()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00332">threadpool_idle_thread_dead()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00654">threadpool_tps_emptied()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00610">threadpool_tps_task_pushed()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00301">threadpool_zombie_thread_dead()</a>.</p>
<div class="fragment"><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/deb/taskprocessor_8c.html#a458f3e603669bc087d571e28c6b23424">taskprocessor_push</a>(tps, <a class="code" href="../../d4/deb/taskprocessor_8c.html#a1e47192322efd29dd1b30c9f1adc9f52">tps_task_alloc</a>(task_exe, datap));</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div><div class="ttc" id="taskprocessor_8c_html_a458f3e603669bc087d571e28c6b23424"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a458f3e603669bc087d571e28c6b23424">taskprocessor_push</a></div><div class="ttdeci">static int taskprocessor_push(struct ast_taskprocessor *tps, struct tps_task *t)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01139">taskprocessor.c:1139</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a1e47192322efd29dd1b30c9f1adc9f52"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a1e47192322efd29dd1b30c9f1adc9f52">tps_task_alloc</a></div><div class="ttdeci">static struct tps_task * tps_task_alloc(int(*task_exe)(void *datap), void *datap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00326">taskprocessor.c:326</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d7049467cda8b796bff04ce8bba34b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d7049467cda8b796bff04ce8bba34b5">&#9670;&nbsp;</a></span>ast_taskprocessor_push_local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_push_local </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(struct <a class="el" href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a> *local)&#160;</td>
          <td class="paramname"><em>task_exe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>datap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push a task into the specified taskprocessor queue and signal the taskprocessor thread. </p>
<p>The callback receives a <a class="el" href="../../dc/ded/structast__taskprocessor__local.html">ast_taskprocessor_local</a> struct, which contains both the provided <em>datap</em> pointer, and any local data set on the taskprocessor with <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a208c9f9b930e83c7bdb833c66f13d5e8" title="Sets the local data associated with a taskprocessor. ">ast_taskprocessor_set_local()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>The taskprocessor structure </td></tr>
    <tr><td class="paramname">task_exe</td><td>The task handling function to push into the taskprocessor queue </td></tr>
    <tr><td class="paramname">datap</td><td>The data to be used by the task handling function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12.0.0 </dd></dl>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00837">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01314">dispatch_message()</a>.</p>

</div>
</div>
<a id="a6d17cb910ea569aa91235d174c126f55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d17cb910ea569aa91235d174c126f55">&#9670;&nbsp;</a></span>ast_taskprocessor_seq_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ast_taskprocessor_seq_num </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the next sequence number to create a human friendly taskprocessor name. </p>
<dl class="section since"><dt>Since</dt><dd>13.8.0</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Sequence number for use in creating human friendly taskprocessor names. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01276">1276</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01295">ast_taskprocessor_build_name()</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01285">ast_taskprocessor_name_append()</a>.</p>
<div class="fragment"><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;{</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> seq_num;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;seq_num, +1);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;}</div><div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a208c9f9b930e83c7bdb833c66f13d5e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208c9f9b930e83c7bdb833c66f13d5e8">&#9670;&nbsp;</a></span>ast_taskprocessor_set_local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_taskprocessor_set_local </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>local_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the local data associated with a taskprocessor. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0</dd></dl>
<p>See <a class="el" href="../../d0/d1e/taskprocessor_8h.html#a6d7049467cda8b796bff04ce8bba34b5" title="Push a task into the specified taskprocessor queue and signal the taskprocessor thread. ">ast_taskprocessor_push_local()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Task processor. </td></tr>
    <tr><td class="paramname">local_data</td><td>Local data to associate with <em>tps</em>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01101">1101</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00072">ast_taskprocessor::local_data</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00602">SCOPED_AO2LOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00837">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>.</p>
<div class="fragment"><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;{</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, tps);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afac276564d7aa87eefe4fa4b0694001e">local_data</a> = local_data;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div><div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_afac276564d7aa87eefe4fa4b0694001e"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#afac276564d7aa87eefe4fa4b0694001e">ast_taskprocessor::local_data</a></div><div class="ttdeci">void * local_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00072">taskprocessor.c:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83d09062fb3c84cf1c84a04174deb2bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d09062fb3c84cf1c84a04174deb2bf">&#9670;&nbsp;</a></span>ast_taskprocessor_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ast_taskprocessor_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current size of the taskprocessor queue. </p>
<dl class="section since"><dt>Since</dt><dd>13.7.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00900">900</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00074">ast_taskprocessor::tps_queue_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00127">ast_serializer_pool_get()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01212">ast_taskprocessor_execute()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01437">ast_threadpool_queue_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;{</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   <span class="keywordflow">return</span> (tps) ? tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#afe2dfc83eb5b460f39e9e5513023e74e">tps_queue_size</a> : -1;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_afe2dfc83eb5b460f39e9e5513023e74e"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#afe2dfc83eb5b460f39e9e5513023e74e">ast_taskprocessor::tps_queue_size</a></div><div class="ttdeci">long tps_queue_size</div><div class="ttdoc">Taskprocessor current queue size. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00074">taskprocessor.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeea7131da6b62d2e9b5d91c5de529d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeea7131da6b62d2e9b5d91c5de529d6c">&#9670;&nbsp;</a></span>ast_taskprocessor_suspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_suspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate the taskprocessor is suspended. </p>
<dl class="section since"><dt>Since</dt><dd>13.12.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Task processor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01185">1185</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00091">ast_taskprocessor::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>, and <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;{</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;   <span class="keywordflow">if</span> (tps) {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 1;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;   }</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_a2862ffde11c780129862e5549415a6f6"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">ast_taskprocessor::suspended</a></div><div class="ttdeci">unsigned int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00091">taskprocessor.c:91</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a32492eb2480cb8c46ad669622cff8556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32492eb2480cb8c46ad669622cff8556">&#9670;&nbsp;</a></span>ast_taskprocessor_unreference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ast_taskprocessor_unreference </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unreference the specified taskprocessor and its reference count will decrement. </p>
<p>Taskprocessors use <a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> and will unlink from the taskprocessor singleton container and destroy themself when the taskprocessor reference count reaches zero. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>taskprocessor to unreference </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.6.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">1109</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01622">ao2_unlink_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00081">ast_taskprocessor::listener</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00915">listener_shutdown()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01028">__start_taskprocessor()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14601">__unload_module()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01689">ast_msg_shutdown()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l02835">ast_res_pjsip_cleanup_options_handling()</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00039">ast_serializer_pool_destroy()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01083">ast_taskprocessor_create_with_listener()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00132">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00965">ast_threadpool_shutdown()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00411">cli_tps_ping()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01329">cli_tps_reset_stats()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01363">cli_tps_reset_stats_all()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01173">destroy_conference_bridge()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00485">distributor()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01225">distributor_pool_shutdown()</a>, <a class="el" href="../../df/d3a/dns__system__resolver_8c_source.html#l00120">dns_system_resolver_destroy()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01349">execute_tasks()</a>, <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00170">exten_state_subscription_destructor()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00349">refer_progress_destroy()</a>, <a class="el" href="../../dc/dce/test__res__pjsip__scheduler_8c_source.html#l00102">scheduler()</a>, <a class="el" href="../../de/dfa/pjsip__scheduler_8c_source.html#l00399">schtd_dtor()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01363">serializer_task_pushed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../df/dda/pjsip__options_8c_source.html#l00941">sip_options_aor_dtor()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01015">sip_outbound_publisher_destroy()</a>, <a class="el" href="../../d9/d96/res__pjsip__outbound__registration_8c_source.html#l01297">sip_outbound_registration_client_state_destroy()</a>, <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00098">sip_resolve_destroy()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l00678">sorcery_object_type_destructor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00715">subscription_dtor()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01684">subscription_persistence_recreate()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01367">subscription_tree_destructor()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00539">tps_report_taskprocessor_list()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00742">tps_shutdown_thread()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00379">tps_taskprocessor_tab_complete()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l15050">unload_module()</a>, and <a class="el" href="../../d2/db8/res__pjsip__transport__websocket_8c_source.html#l00360">websocket_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="keywordflow">if</span> (!tps) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   <span class="comment">/* To prevent another thread from finding and getting a reference to this</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">    * taskprocessor we hold the singletons lock. If we didn&#39;t do this then</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">    * they may acquire it and find that the listener has been shut down.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps_singletons);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tps, -1) &gt; 3) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;   <span class="comment">/* If we&#39;re down to 3 references, then those must be:</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">    * 1. The reference we just got rid of</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">    * 2. The container</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">    * 3. The listener</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a>(tps_singletons, tps, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps_singletons);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <a class="code" href="../../d4/deb/taskprocessor_8c.html#a57a0544f529b470405be3c2d1c209bd8">listener_shutdown</a>(tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">listener</a>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a9dbaf508f8a891a7dfca0827ba489abc"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a9dbaf508f8a891a7dfca0827ba489abc">ast_taskprocessor::listener</a></div><div class="ttdeci">struct ast_taskprocessor_listener * listener</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00081">taskprocessor.c:81</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="taskprocessor_8c_html_a57a0544f529b470405be3c2d1c209bd8"><div class="ttname"><a href="../../d4/deb/taskprocessor_8c.html#a57a0544f529b470405be3c2d1c209bd8">listener_shutdown</a></div><div class="ttdeci">static void listener_shutdown(struct ast_taskprocessor_listener *listener)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00915">taskprocessor.c:915</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="astobj2_8h_html_a77df7775a2a8b6cbef307e211dbf045c"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a></div><div class="ttdeci">#define ao2_unlink_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01622">astobj2.h:1622</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8460a4b877658e3c2a6abbafcfa4c54c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8460a4b877658e3c2a6abbafcfa4c54c">&#9670;&nbsp;</a></span>ast_taskprocessor_unsuspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_taskprocessor_unsuspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td>
          <td class="paramname"><em>tps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate the taskprocessor is unsuspended. </p>
<dl class="section since"><dt>Since</dt><dd>13.12.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tps</td><td>Task processor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01196">1196</a> of file <a class="el" href="../../d4/deb/taskprocessor_8c_source.html">taskprocessor.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00091">ast_taskprocessor::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03200">ast_sip_session_unsuspend()</a>, and <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00180">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;{</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="keywordflow">if</span> (tps) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(tps);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      tps-&gt;<a class="code" href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 0;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(tps);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div><div class="ttc" id="structast__taskprocessor_html_a2862ffde11c780129862e5549415a6f6"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a2862ffde11c780129862e5549415a6f6">ast_taskprocessor::suspended</a></div><div class="ttdeci">unsigned int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00091">taskprocessor.c:91</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:52 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
